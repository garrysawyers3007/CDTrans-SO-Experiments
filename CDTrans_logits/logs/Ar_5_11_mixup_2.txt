2022-04-12 15:23:01,788 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits
2022-04-12 15:23:01,788 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Clipart_only_classifier/transformer_best_model.pth')
2022-04-12 15:23:01,788 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 15:23:01,788 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 15:23:01,788 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_only_classifier/transformer_best_model.pth
2022-04-12 15:23:14,721 reid_baseline.train INFO: start training
2022-04-12 15:26:17,399 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-12 15:28:17,216 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.986[s] Speed: 8.1[samples/s]
2022-04-12 15:29:25,147 reid_baseline.train INFO: normal accuracy 0.3411225658648339 4.169779300689697 
2022-04-12 15:29:26,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 15:29:26,155 reid_baseline.train INFO: Val Accuracy: 34.1% Mean Entropy: 417.0%
2022-04-12 15:29:49,566 reid_baseline.train INFO: normal accuracy 0.4907243816254417 4.1691131591796875 
2022-04-12 15:29:49,567 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 15:29:49,567 reid_baseline.train INFO: Train Accuracy: 49.1% Mean Entropy: 416.9%
2022-04-12 15:33:38,217 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.986, Acc: 0.722, Base Lr: 1.66e-03
2022-04-12 15:35:16,740 reid_baseline.train INFO: Epoch 2 done. Time per batch: 2.152[s] Speed: 7.4[samples/s]
2022-04-12 15:36:24,521 reid_baseline.train INFO: normal accuracy 0.3743413516609393 4.130287170410156 
2022-04-12 15:36:25,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 15:36:25,482 reid_baseline.train INFO: Val Accuracy: 37.4% Mean Entropy: 413.0%
2022-04-12 15:36:49,021 reid_baseline.train INFO: normal accuracy 0.5237043580683156 4.10853910446167 
2022-04-12 15:36:49,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 15:36:49,021 reid_baseline.train INFO: Train Accuracy: 52.4% Mean Entropy: 410.9%
2022-04-12 15:40:36,064 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-12 15:42:31,503 reid_baseline.train INFO: Epoch 3 done. Time per batch: 2.253[s] Speed: 7.1[samples/s]
2022-04-12 15:43:42,502 reid_baseline.train INFO: normal accuracy 0.41832760595647195 3.9074363708496094 
2022-04-12 15:43:43,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 15:43:43,588 reid_baseline.train INFO: Val Accuracy: 41.8% Mean Entropy: 390.7%
2022-04-12 15:44:07,190 reid_baseline.train INFO: normal accuracy 0.5559481743227326 3.7849905490875244 
2022-04-12 15:44:07,190 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 15:44:07,190 reid_baseline.train INFO: Train Accuracy: 55.6% Mean Entropy: 378.5%
2022-04-12 15:47:45,478 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-12 15:49:39,448 reid_baseline.train INFO: Epoch 4 done. Time per batch: 2.186[s] Speed: 7.3[samples/s]
2022-04-12 15:50:50,040 reid_baseline.train INFO: normal accuracy 0.47743413516609395 3.378908634185791 
2022-04-12 15:50:51,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 15:50:51,073 reid_baseline.train INFO: Val Accuracy: 47.7% Mean Entropy: 337.9%
2022-04-12 15:51:14,541 reid_baseline.train INFO: normal accuracy 0.6123380447585395 3.1328587532043457 
2022-04-12 15:51:14,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 15:51:14,541 reid_baseline.train INFO: Train Accuracy: 61.2% Mean Entropy: 313.3%
2022-04-12 15:55:02,079 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.856, Base Lr: 4.04e-03
2022-04-12 15:56:57,549 reid_baseline.train INFO: Epoch 5 done. Time per batch: 2.257[s] Speed: 7.1[samples/s]
2022-04-12 15:58:06,816 reid_baseline.train INFO: normal accuracy 0.5509736540664376 2.9417078495025635 
2022-04-12 15:58:07,794 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 15:58:07,795 reid_baseline.train INFO: Val Accuracy: 55.1% Mean Entropy: 294.2%
2022-04-12 15:58:30,089 reid_baseline.train INFO: normal accuracy 0.6777090694935218 2.611680746078491 
2022-04-12 15:58:30,090 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 15:58:30,090 reid_baseline.train INFO: Train Accuracy: 67.8% Mean Entropy: 261.2%
2022-04-12 16:02:21,832 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.647, Acc: 0.899, Base Lr: 4.83e-03
2022-04-12 16:04:18,147 reid_baseline.train INFO: Epoch 6 done. Time per batch: 2.290[s] Speed: 7.0[samples/s]
2022-04-12 16:05:26,765 reid_baseline.train INFO: normal accuracy 0.5816723940435281 2.664409875869751 
2022-04-12 16:05:27,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 16:05:27,848 reid_baseline.train INFO: Val Accuracy: 58.2% Mean Entropy: 266.4%
2022-04-12 16:05:51,365 reid_baseline.train INFO: normal accuracy 0.7114252061248527 2.296482801437378 
2022-04-12 16:05:51,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 16:05:51,365 reid_baseline.train INFO: Train Accuracy: 71.1% Mean Entropy: 229.6%
2022-04-12 16:09:34,280 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.448, Acc: 0.932, Base Lr: 5.62e-03
2022-04-12 16:11:23,390 reid_baseline.train INFO: Epoch 7 done. Time per batch: 2.183[s] Speed: 7.3[samples/s]
2022-04-12 16:12:32,941 reid_baseline.train INFO: normal accuracy 0.5956471935853379 2.4116156101226807 
2022-04-12 16:12:34,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 16:12:34,020 reid_baseline.train INFO: Val Accuracy: 59.6% Mean Entropy: 241.2%
2022-04-12 16:12:58,049 reid_baseline.train INFO: normal accuracy 0.7265901060070671 2.0401036739349365 
2022-04-12 16:12:58,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 16:12:58,050 reid_baseline.train INFO: Train Accuracy: 72.7% Mean Entropy: 204.0%
2022-04-12 16:16:45,904 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.949, Base Lr: 6.42e-03
2022-04-12 16:18:42,182 reid_baseline.train INFO: Epoch 8 done. Time per batch: 2.264[s] Speed: 7.1[samples/s]
2022-04-12 16:19:50,786 reid_baseline.train INFO: normal accuracy 0.5970217640320733 2.2997262477874756 
2022-04-12 16:19:51,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 16:19:51,728 reid_baseline.train INFO: Val Accuracy: 59.7% Mean Entropy: 230.0%
2022-04-12 16:20:16,299 reid_baseline.train INFO: normal accuracy 0.7318904593639576 1.8800427913665771 
2022-04-12 16:20:16,299 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 16:20:16,300 reid_baseline.train INFO: Train Accuracy: 73.2% Mean Entropy: 188.0%
2022-04-12 16:23:46,769 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.969, Base Lr: 7.21e-03
2022-04-12 16:25:43,601 reid_baseline.train INFO: Epoch 9 done. Time per batch: 2.153[s] Speed: 7.4[samples/s]
2022-04-12 16:26:52,391 reid_baseline.train INFO: normal accuracy 0.5986254295532646 2.1908347606658936 
2022-04-12 16:26:53,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 16:26:53,475 reid_baseline.train INFO: Val Accuracy: 59.9% Mean Entropy: 219.1%
2022-04-12 16:27:18,212 reid_baseline.train INFO: normal accuracy 0.7364546525323911 1.742235779762268 
2022-04-12 16:27:18,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 16:27:18,213 reid_baseline.train INFO: Train Accuracy: 73.6% Mean Entropy: 174.2%
2022-04-12 16:31:06,112 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.977, Base Lr: 4.01e-03
2022-04-12 16:32:53,288 reid_baseline.train INFO: Epoch 10 done. Time per batch: 2.204[s] Speed: 7.3[samples/s]
2022-04-12 16:34:11,039 reid_baseline.train INFO: normal accuracy 0.6050400916380297 2.190998077392578 
2022-04-12 16:34:11,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 16:34:11,042 reid_baseline.train INFO: Val Accuracy: 60.5% Mean Entropy: 219.1%
2022-04-12 16:34:36,670 reid_baseline.train INFO: normal accuracy 0.7420494699646644 1.7389616966247559 
2022-04-12 16:34:36,670 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 16:34:36,670 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 173.9%
2022-04-12 16:38:25,868 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.151, Acc: 0.984, Base Lr: 3.38e-03
2022-04-12 16:40:22,168 reid_baseline.train INFO: Epoch 11 done. Time per batch: 2.272[s] Speed: 7.0[samples/s]
2022-04-12 16:41:28,939 reid_baseline.train INFO: normal accuracy 0.602290950744559 2.156230926513672 
2022-04-12 16:41:29,920 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 16:41:29,920 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 215.6%
2022-04-12 16:41:53,525 reid_baseline.train INFO: normal accuracy 0.741166077738516 1.699965000152588 
2022-04-12 16:41:53,525 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 16:41:53,525 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 170.0%
2022-04-12 16:45:25,393 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.100, Acc: 0.987, Base Lr: 2.77e-03
2022-04-12 16:47:26,125 reid_baseline.train INFO: Epoch 12 done. Time per batch: 2.188[s] Speed: 7.3[samples/s]
2022-04-12 16:48:32,984 reid_baseline.train INFO: normal accuracy 0.6020618556701031 2.141608715057373 
2022-04-12 16:48:33,909 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 16:48:33,909 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 214.2%
2022-04-12 16:48:58,047 reid_baseline.train INFO: normal accuracy 0.7413133097762074 1.6765364408493042 
2022-04-12 16:48:58,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 16:48:58,048 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 167.7%
2022-04-12 16:52:46,391 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.092, Acc: 0.985, Base Lr: 2.20e-03
2022-04-12 16:54:43,595 reid_baseline.train INFO: Epoch 13 done. Time per batch: 2.273[s] Speed: 7.0[samples/s]
2022-04-12 16:55:53,606 reid_baseline.train INFO: normal accuracy 0.5995418098510882 2.101642370223999 
2022-04-12 16:55:54,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 16:55:54,642 reid_baseline.train INFO: Val Accuracy: 60.0% Mean Entropy: 210.2%
2022-04-12 16:56:16,607 reid_baseline.train INFO: normal accuracy 0.7399882214369847 1.628745436668396 
2022-04-12 16:56:16,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 16:56:16,607 reid_baseline.train INFO: Train Accuracy: 74.0% Mean Entropy: 162.9%
2022-04-12 17:00:02,892 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.062, Acc: 0.991, Base Lr: 1.66e-03
2022-04-12 17:01:58,830 reid_baseline.train INFO: Epoch 14 done. Time per batch: 2.251[s] Speed: 7.1[samples/s]
2022-04-12 17:03:09,032 reid_baseline.train INFO: normal accuracy 0.6006872852233677 2.079298257827759 
2022-04-12 17:03:10,010 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 17:03:10,011 reid_baseline.train INFO: Val Accuracy: 60.1% Mean Entropy: 207.9%
2022-04-12 17:03:33,382 reid_baseline.train INFO: normal accuracy 0.7407243816254417 1.6059048175811768 
2022-04-12 17:03:33,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 17:03:33,383 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 160.6%
2022-04-12 17:07:21,437 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.064, Acc: 0.991, Base Lr: 1.19e-03
2022-04-12 17:09:01,708 reid_baseline.train INFO: Epoch 15 done. Time per batch: 2.160[s] Speed: 7.4[samples/s]
2022-04-12 17:10:12,547 reid_baseline.train INFO: normal accuracy 0.6027491408934708 2.1313869953155518 
2022-04-12 17:10:12,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 17:10:12,548 reid_baseline.train INFO: Val Accuracy: 60.3% Mean Entropy: 213.1%
2022-04-12 17:10:35,844 reid_baseline.train INFO: normal accuracy 0.7420494699646644 1.6537818908691406 
2022-04-12 17:10:35,845 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 17:10:35,845 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 165.4%
2022-04-12 17:14:23,885 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.064, Acc: 0.993, Base Lr: 7.78e-04
2022-04-12 17:16:20,281 reid_baseline.train INFO: Epoch 16 done. Time per batch: 2.266[s] Speed: 7.1[samples/s]
2022-04-12 17:17:30,721 reid_baseline.train INFO: normal accuracy 0.6032073310423826 2.155200958251953 
2022-04-12 17:17:30,723 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 17:17:30,724 reid_baseline.train INFO: Val Accuracy: 60.3% Mean Entropy: 215.5%
2022-04-12 17:17:54,849 reid_baseline.train INFO: normal accuracy 0.7426383981154299 1.678938627243042 
2022-04-12 17:17:54,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 17:17:54,850 reid_baseline.train INFO: Train Accuracy: 74.3% Mean Entropy: 167.9%
2022-04-12 17:21:32,574 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.051, Acc: 0.988, Base Lr: 4.51e-04
2022-04-12 17:23:30,499 reid_baseline.train INFO: Epoch 17 done. Time per batch: 2.208[s] Speed: 7.2[samples/s]
2022-04-12 17:24:43,919 reid_baseline.train INFO: normal accuracy 0.6061855670103092 2.092921257019043 
2022-04-12 17:24:43,920 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 17:24:43,920 reid_baseline.train INFO: Val Accuracy: 60.6% Mean Entropy: 209.3%
2022-04-12 17:25:07,417 reid_baseline.train INFO: normal accuracy 0.7446996466431095 1.6151398420333862 
2022-04-12 17:25:07,418 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 17:25:07,418 reid_baseline.train INFO: Train Accuracy: 74.5% Mean Entropy: 161.5%
2022-04-12 17:28:53,539 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.062, Acc: 0.993, Base Lr: 2.11e-04
2022-04-12 17:30:49,069 reid_baseline.train INFO: Epoch 18 done. Time per batch: 2.248[s] Speed: 7.1[samples/s]
2022-04-12 17:31:56,824 reid_baseline.train INFO: normal accuracy 0.6032073310423826 2.0908265113830566 
2022-04-12 17:31:56,824 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 17:31:56,825 reid_baseline.train INFO: Val Accuracy: 60.3% Mean Entropy: 209.1%
2022-04-12 17:32:23,018 reid_baseline.train INFO: normal accuracy 0.7429328621908127 1.613162875175476 
2022-04-12 17:32:23,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 17:32:23,019 reid_baseline.train INFO: Train Accuracy: 74.3% Mean Entropy: 161.3%
2022-04-12 17:36:14,416 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.058, Acc: 0.992, Base Lr: 6.51e-05
2022-04-12 17:38:09,684 reid_baseline.train INFO: Epoch 19 done. Time per batch: 2.280[s] Speed: 7.0[samples/s]
2022-04-12 17:39:13,142 reid_baseline.train INFO: normal accuracy 0.6016036655211913 2.1070573329925537 
2022-04-12 17:39:13,142 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 17:39:13,143 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 210.7%
2022-04-12 17:39:37,105 reid_baseline.train INFO: normal accuracy 0.7417550058892816 1.6304223537445068 
2022-04-12 17:39:37,105 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 17:39:37,106 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 163.0%
2022-04-12 17:43:12,343 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.061, Acc: 0.989, Base Lr: 1.60e-05
2022-04-12 17:45:04,667 reid_baseline.train INFO: Epoch 20 done. Time per batch: 2.155[s] Speed: 7.4[samples/s]
2022-04-12 17:46:09,990 reid_baseline.train INFO: normal accuracy 0.602290950744559 2.0824859142303467 
2022-04-12 17:46:09,992 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 17:46:09,992 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 208.2%
2022-04-12 17:46:33,682 reid_baseline.train INFO: normal accuracy 0.7423439340400471 1.6064752340316772 
2022-04-12 17:46:33,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 17:46:33,682 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 160.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits/transformer_best_model.pth
2022-04-12 17:47:37,411 reid_baseline.train INFO: normal accuracy 0.6006872852233677 2.079298257827759 
2022-04-12 17:47:37,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 17:47:37,412 reid_baseline.train INFO: Accuracy: 60.1%
2022-04-12 17:48:00,479 reid_baseline.train INFO: normal accuracy 0.7407243816254417 1.6059048175811768 
2022-04-12 17:48:00,479 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 17:48:00,479 reid_baseline.train INFO: Train Accuracy: 74.1%
2022-04-12 17:48:05,533 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits
2022-04-12 17:48:05,533 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth')
2022-04-12 17:48:05,533 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 17:48:05,533 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 17:48:05,533 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth
2022-04-12 17:48:18,749 reid_baseline.train INFO: start training
2022-04-12 17:52:07,495 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-12 17:54:04,056 reid_baseline.train INFO: Epoch 1 done. Time per batch: 2.264[s] Speed: 7.1[samples/s]
2022-04-12 17:55:12,589 reid_baseline.train INFO: normal accuracy 0.5465194863708043 4.1707072257995605 
2022-04-12 17:55:13,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 17:55:13,494 reid_baseline.train INFO: Val Accuracy: 54.7% Mean Entropy: 417.1%
2022-04-12 17:55:43,326 reid_baseline.train INFO: normal accuracy 0.6217593941159336 4.16972017288208 
2022-04-12 17:55:43,326 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 17:55:43,327 reid_baseline.train INFO: Train Accuracy: 62.2% Mean Entropy: 417.0%
2022-04-12 17:59:31,301 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.985, Acc: 0.722, Base Lr: 1.66e-03
2022-04-12 18:01:27,289 reid_baseline.train INFO: Epoch 2 done. Time per batch: 2.263[s] Speed: 7.1[samples/s]
2022-04-12 18:02:33,170 reid_baseline.train INFO: normal accuracy 0.5841405722009462 4.13608455657959 
2022-04-12 18:02:34,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 18:02:34,058 reid_baseline.train INFO: Val Accuracy: 58.4% Mean Entropy: 413.6%
2022-04-12 18:02:57,583 reid_baseline.train INFO: normal accuracy 0.6577337605592776 4.112522602081299 
2022-04-12 18:02:57,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 18:02:57,583 reid_baseline.train INFO: Train Accuracy: 65.8% Mean Entropy: 411.3%
2022-04-12 18:06:27,273 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-12 18:08:31,030 reid_baseline.train INFO: Epoch 3 done. Time per batch: 2.194[s] Speed: 7.3[samples/s]
2022-04-12 18:09:36,309 reid_baseline.train INFO: normal accuracy 0.5938274386123 3.890770196914673 
2022-04-12 18:09:37,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 18:09:37,264 reid_baseline.train INFO: Val Accuracy: 59.4% Mean Entropy: 389.1%
2022-04-12 18:10:00,576 reid_baseline.train INFO: normal accuracy 0.6680745703466356 3.775545358657837 
2022-04-12 18:10:00,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 18:10:00,576 reid_baseline.train INFO: Train Accuracy: 66.8% Mean Entropy: 377.6%
2022-04-12 18:13:47,118 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-12 18:15:42,567 reid_baseline.train INFO: Epoch 4 done. Time per batch: 2.250[s] Speed: 7.1[samples/s]
2022-04-12 18:16:47,856 reid_baseline.train INFO: normal accuracy 0.6562288803784636 3.2684359550476074 
2022-04-12 18:16:48,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 18:16:48,710 reid_baseline.train INFO: Val Accuracy: 65.6% Mean Entropy: 326.8%
2022-04-12 18:17:09,110 reid_baseline.train INFO: normal accuracy 0.7263326536556948 3.0641753673553467 
2022-04-12 18:17:09,110 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 18:17:09,110 reid_baseline.train INFO: Train Accuracy: 72.6% Mean Entropy: 306.4%
2022-04-12 18:20:48,984 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.854, Base Lr: 4.04e-03
2022-04-12 18:22:45,450 reid_baseline.train INFO: Epoch 5 done. Time per batch: 2.213[s] Speed: 7.2[samples/s]
2022-04-12 18:23:49,482 reid_baseline.train INFO: normal accuracy 0.7373282270781708 2.7248337268829346 
2022-04-12 18:23:50,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 18:23:50,477 reid_baseline.train INFO: Val Accuracy: 73.7% Mean Entropy: 272.5%
2022-04-12 18:24:14,668 reid_baseline.train INFO: normal accuracy 0.796970579667929 2.4748337268829346 
2022-04-12 18:24:14,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 18:24:14,668 reid_baseline.train INFO: Train Accuracy: 79.7% Mean Entropy: 247.5%
2022-04-12 18:28:01,531 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.646, Acc: 0.900, Base Lr: 4.83e-03
2022-04-12 18:29:38,077 reid_baseline.train INFO: Epoch 6 done. Time per batch: 2.128[s] Speed: 7.5[samples/s]
2022-04-12 18:30:43,159 reid_baseline.train INFO: normal accuracy 0.7681910340166704 2.392871618270874 
2022-04-12 18:30:44,002 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 18:30:44,002 reid_baseline.train INFO: Val Accuracy: 76.8% Mean Entropy: 239.3%
2022-04-12 18:31:07,531 reid_baseline.train INFO: normal accuracy 0.8307602679871833 2.124526023864746 
2022-04-12 18:31:07,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 18:31:07,531 reid_baseline.train INFO: Train Accuracy: 83.1% Mean Entropy: 212.5%
2022-04-12 18:34:54,767 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.448, Acc: 0.932, Base Lr: 5.62e-03
2022-04-12 18:36:50,520 reid_baseline.train INFO: Epoch 7 done. Time per batch: 2.256[s] Speed: 7.1[samples/s]
2022-04-12 18:37:56,551 reid_baseline.train INFO: normal accuracy 0.7884658706915972 2.155437707901001 
2022-04-12 18:37:57,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 18:37:57,510 reid_baseline.train INFO: Val Accuracy: 78.8% Mean Entropy: 215.5%
2022-04-12 18:38:21,136 reid_baseline.train INFO: normal accuracy 0.8498397902709001 1.8790242671966553 
2022-04-12 18:38:21,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 18:38:21,136 reid_baseline.train INFO: Train Accuracy: 85.0% Mean Entropy: 187.9%
2022-04-12 18:41:53,066 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.949, Base Lr: 6.42e-03
2022-04-12 18:43:48,569 reid_baseline.train INFO: Epoch 8 done. Time per batch: 2.153[s] Speed: 7.4[samples/s]
2022-04-12 18:44:54,214 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.9494959115982056 
2022-04-12 18:44:55,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 18:44:55,077 reid_baseline.train INFO: Val Accuracy: 79.1% Mean Entropy: 194.9%
2022-04-12 18:45:18,875 reid_baseline.train INFO: normal accuracy 0.8552286629769881 1.6561329364776611 
2022-04-12 18:45:18,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 18:45:18,875 reid_baseline.train INFO: Train Accuracy: 85.5% Mean Entropy: 165.6%
2022-04-12 18:49:06,299 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.968, Base Lr: 7.21e-03
2022-04-12 18:51:02,469 reid_baseline.train INFO: Epoch 9 done. Time per batch: 2.260[s] Speed: 7.1[samples/s]
2022-04-12 18:52:09,684 reid_baseline.train INFO: normal accuracy 0.7979274611398963 1.8521881103515625 
2022-04-12 18:52:10,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 18:52:10,560 reid_baseline.train INFO: Val Accuracy: 79.8% Mean Entropy: 185.2%
2022-04-12 18:52:34,354 reid_baseline.train INFO: normal accuracy 0.8639673754733469 1.5276752710342407 
2022-04-12 18:52:34,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 18:52:34,354 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 152.8%
2022-04-12 18:56:26,530 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.978, Base Lr: 4.01e-03
2022-04-12 18:58:21,652 reid_baseline.train INFO: Epoch 10 done. Time per batch: 2.285[s] Speed: 7.0[samples/s]
2022-04-12 18:59:28,585 reid_baseline.train INFO: normal accuracy 0.7958999774724037 1.8689082860946655 
2022-04-12 18:59:28,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 18:59:28,587 reid_baseline.train INFO: Val Accuracy: 79.6% Mean Entropy: 186.9%
2022-04-12 18:59:52,080 reid_baseline.train INFO: normal accuracy 0.8639673754733469 1.5361251831054688 
2022-04-12 18:59:52,080 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 18:59:52,080 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 153.6%
2022-04-12 19:03:27,116 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.152, Acc: 0.984, Base Lr: 3.38e-03
2022-04-12 19:05:20,734 reid_baseline.train INFO: Epoch 11 done. Time per batch: 2.162[s] Speed: 7.4[samples/s]
2022-04-12 19:06:25,542 reid_baseline.train INFO: normal accuracy 0.79477359765713 1.8351335525512695 
2022-04-12 19:06:26,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 19:06:26,542 reid_baseline.train INFO: Val Accuracy: 79.5% Mean Entropy: 183.5%
2022-04-12 19:06:49,893 reid_baseline.train INFO: normal accuracy 0.8641130206816195 1.4976814985275269 
2022-04-12 19:06:49,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 19:06:49,894 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 149.8%
2022-04-12 19:10:36,443 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.100, Acc: 0.987, Base Lr: 2.77e-03
2022-04-12 19:12:31,798 reid_baseline.train INFO: Epoch 12 done. Time per batch: 2.249[s] Speed: 7.1[samples/s]
2022-04-12 19:13:36,696 reid_baseline.train INFO: normal accuracy 0.7990538409551701 1.8130443096160889 
2022-04-12 19:13:37,585 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 19:13:37,585 reid_baseline.train INFO: Val Accuracy: 79.9% Mean Entropy: 181.3%
2022-04-12 19:14:01,047 reid_baseline.train INFO: normal accuracy 0.8671715700553452 1.4689441919326782 
2022-04-12 19:14:01,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 19:14:01,048 reid_baseline.train INFO: Train Accuracy: 86.7% Mean Entropy: 146.9%
2022-04-12 19:17:14,625 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.092, Acc: 0.985, Base Lr: 2.20e-03
2022-04-12 19:18:59,076 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.961[s] Speed: 8.2[samples/s]
2022-04-12 19:20:04,896 reid_baseline.train INFO: normal accuracy 0.8031088082901554 1.7699394226074219 
2022-04-12 19:20:05,930 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 19:20:05,930 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 177.0%
2022-04-12 19:20:29,846 reid_baseline.train INFO: normal accuracy 0.8700844742207982 1.4191982746124268 
2022-04-12 19:20:29,846 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 19:20:29,846 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 141.9%
2022-04-12 19:24:16,115 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.063, Acc: 0.991, Base Lr: 1.66e-03
2022-04-12 19:26:11,739 reid_baseline.train INFO: Epoch 14 done. Time per batch: 2.249[s] Speed: 7.1[samples/s]
2022-04-12 19:27:17,543 reid_baseline.train INFO: normal accuracy 0.8033340842532102 1.747326374053955 
2022-04-12 19:27:18,490 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 19:27:18,490 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 174.7%
2022-04-12 19:27:41,668 reid_baseline.train INFO: normal accuracy 0.8703757646373435 1.396435260772705 
2022-04-12 19:27:41,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 19:27:41,668 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 139.6%
2022-04-12 19:31:25,165 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.064, Acc: 0.991, Base Lr: 1.19e-03
2022-04-12 19:33:20,821 reid_baseline.train INFO: Epoch 15 done. Time per batch: 2.231[s] Speed: 7.2[samples/s]
2022-04-12 19:34:27,000 reid_baseline.train INFO: normal accuracy 0.8033340842532102 1.8057894706726074 
2022-04-12 19:34:27,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 19:34:27,000 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 180.6%
2022-04-12 19:34:50,146 reid_baseline.train INFO: normal accuracy 0.8702301194290708 1.448434829711914 
2022-04-12 19:34:50,146 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 19:34:50,146 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 144.8%
2022-04-12 19:38:37,107 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.065, Acc: 0.993, Base Lr: 7.78e-04
2022-04-12 19:40:25,793 reid_baseline.train INFO: Epoch 16 done. Time per batch: 2.208[s] Speed: 7.2[samples/s]
2022-04-12 19:41:33,656 reid_baseline.train INFO: normal accuracy 0.8006307726965533 1.8315964937210083 
2022-04-12 19:41:33,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 19:41:33,658 reid_baseline.train INFO: Val Accuracy: 80.1% Mean Entropy: 183.2%
2022-04-12 19:41:58,337 reid_baseline.train INFO: normal accuracy 0.8687736673463443 1.4746813774108887 
2022-04-12 19:41:58,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 19:41:58,338 reid_baseline.train INFO: Train Accuracy: 86.9% Mean Entropy: 147.5%
2022-04-12 19:45:45,362 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.051, Acc: 0.989, Base Lr: 4.51e-04
2022-04-12 19:47:39,927 reid_baseline.train INFO: Epoch 17 done. Time per batch: 2.247[s] Speed: 7.1[samples/s]
2022-04-12 19:48:44,657 reid_baseline.train INFO: normal accuracy 0.7981527371029511 1.7577999830245972 
2022-04-12 19:48:44,660 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 19:48:44,660 reid_baseline.train INFO: Val Accuracy: 79.8% Mean Entropy: 175.8%
2022-04-12 19:49:08,167 reid_baseline.train INFO: normal accuracy 0.8671715700553452 1.403810977935791 
2022-04-12 19:49:08,167 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 19:49:08,167 reid_baseline.train INFO: Train Accuracy: 86.7% Mean Entropy: 140.4%
2022-04-12 19:52:45,003 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.062, Acc: 0.993, Base Lr: 2.11e-04
2022-04-12 19:54:45,099 reid_baseline.train INFO: Epoch 18 done. Time per batch: 2.216[s] Speed: 7.2[samples/s]
2022-04-12 19:55:51,341 reid_baseline.train INFO: normal accuracy 0.8010813246226628 1.7604827880859375 
2022-04-12 19:55:51,342 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 19:55:51,342 reid_baseline.train INFO: Val Accuracy: 80.1% Mean Entropy: 176.0%
2022-04-12 19:56:14,887 reid_baseline.train INFO: normal accuracy 0.8693562481794349 1.4047129154205322 
2022-04-12 19:56:14,887 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 19:56:14,887 reid_baseline.train INFO: Train Accuracy: 86.9% Mean Entropy: 140.5%
2022-04-12 20:00:02,324 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.058, Acc: 0.992, Base Lr: 6.51e-05
2022-04-12 20:01:58,275 reid_baseline.train INFO: Epoch 19 done. Time per batch: 2.259[s] Speed: 7.1[samples/s]
2022-04-12 20:03:03,315 reid_baseline.train INFO: normal accuracy 0.802658256364046 1.7839343547821045 
2022-04-12 20:03:03,317 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 20:03:03,317 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 178.4%
2022-04-12 20:03:26,877 reid_baseline.train INFO: normal accuracy 0.8703757646373435 1.4268473386764526 
2022-04-12 20:03:26,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 20:03:26,877 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 142.7%
2022-04-12 20:07:09,417 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.061, Acc: 0.988, Base Lr: 1.60e-05
2022-04-12 20:09:05,866 reid_baseline.train INFO: Epoch 20 done. Time per batch: 2.230[s] Speed: 7.2[samples/s]
2022-04-12 20:10:12,840 reid_baseline.train INFO: normal accuracy 0.8037846361793196 1.7491521835327148 
2022-04-12 20:10:12,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 20:10:12,841 reid_baseline.train INFO: Val Accuracy: 80.4% Mean Entropy: 174.9%
2022-04-12 20:10:35,972 reid_baseline.train INFO: normal accuracy 0.8711039906787067 1.396178126335144 
2022-04-12 20:10:35,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 20:10:35,973 reid_baseline.train INFO: Train Accuracy: 87.1% Mean Entropy: 139.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits/transformer_best_model.pth
2022-04-12 20:11:42,655 reid_baseline.train INFO: normal accuracy 0.8033340842532102 1.747326374053955 
2022-04-12 20:11:42,655 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 20:11:42,656 reid_baseline.train INFO: Accuracy: 80.3%
2022-04-12 20:12:05,977 reid_baseline.train INFO: normal accuracy 0.8703757646373435 1.396435260772705 
2022-04-12 20:12:05,978 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 20:12:05,978 reid_baseline.train INFO: Train Accuracy: 87.0%
2022-04-12 20:12:11,224 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits
2022-04-12 20:12:11,224 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Real_World_only_classifier/transformer_best_model.pth')
2022-04-12 20:12:11,224 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 20:12:11,224 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 20:12:11,225 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_only_classifier/transformer_best_model.pth
2022-04-12 20:12:24,245 reid_baseline.train INFO: start training
2022-04-12 20:16:07,585 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-12 20:18:11,283 reid_baseline.train INFO: Epoch 1 done. Time per batch: 2.274[s] Speed: 7.0[samples/s]
2022-04-12 20:20:54,376 reid_baseline.train INFO: normal accuracy 0.6366766123479458 4.169925212860107 
2022-04-12 20:20:55,301 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 20:20:55,301 reid_baseline.train INFO: Val Accuracy: 63.7% Mean Entropy: 417.0%
2022-04-12 20:21:18,445 reid_baseline.train INFO: normal accuracy 0.6805719339622641 4.169206142425537 
2022-04-12 20:21:18,445 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 20:21:18,445 reid_baseline.train INFO: Train Accuracy: 68.1% Mean Entropy: 416.9%
2022-04-12 20:25:20,055 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.985, Acc: 0.722, Base Lr: 1.66e-03
2022-04-12 20:27:05,052 reid_baseline.train INFO: Epoch 2 done. Time per batch: 2.280[s] Speed: 7.0[samples/s]
2022-04-12 20:29:53,498 reid_baseline.train INFO: normal accuracy 0.6669726876291026 4.112792015075684 
2022-04-12 20:29:54,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 20:29:54,523 reid_baseline.train INFO: Val Accuracy: 66.7% Mean Entropy: 411.3%
2022-04-12 20:30:18,324 reid_baseline.train INFO: normal accuracy 0.7118219339622641 4.097279071807861 
2022-04-12 20:30:18,324 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 20:30:18,325 reid_baseline.train INFO: Train Accuracy: 71.2% Mean Entropy: 409.7%
2022-04-12 20:34:13,820 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-12 20:36:12,928 reid_baseline.train INFO: Epoch 3 done. Time per batch: 2.333[s] Speed: 6.9[samples/s]
2022-04-12 20:39:38,791 reid_baseline.train INFO: normal accuracy 0.6867110397062198 3.7704312801361084 
2022-04-12 20:39:39,813 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 20:39:39,813 reid_baseline.train INFO: Val Accuracy: 68.7% Mean Entropy: 377.0%
2022-04-12 20:40:04,044 reid_baseline.train INFO: normal accuracy 0.7286261792452831 3.69685697555542 
2022-04-12 20:40:04,044 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 20:40:04,045 reid_baseline.train INFO: Train Accuracy: 72.9% Mean Entropy: 369.7%
2022-04-12 20:44:16,515 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-12 20:46:20,841 reid_baseline.train INFO: Epoch 4 done. Time per batch: 2.479[s] Speed: 6.5[samples/s]
2022-04-12 20:49:39,384 reid_baseline.train INFO: normal accuracy 0.7411062657792059 3.0444352626800537 
2022-04-12 20:49:40,366 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 20:49:40,366 reid_baseline.train INFO: Val Accuracy: 74.1% Mean Entropy: 304.4%
2022-04-12 20:50:04,289 reid_baseline.train INFO: normal accuracy 0.7816922169811321 2.9178593158721924 
2022-04-12 20:50:04,289 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 20:50:04,289 reid_baseline.train INFO: Train Accuracy: 78.2% Mean Entropy: 291.8%
2022-04-12 20:54:28,122 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.855, Base Lr: 4.04e-03
2022-04-12 20:56:34,287 reid_baseline.train INFO: Epoch 5 done. Time per batch: 2.566[s] Speed: 6.2[samples/s]
2022-04-12 20:59:50,628 reid_baseline.train INFO: normal accuracy 0.7987147119577691 2.465287208557129 
2022-04-12 20:59:51,598 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 20:59:51,598 reid_baseline.train INFO: Val Accuracy: 79.9% Mean Entropy: 246.5%
2022-04-12 21:00:16,274 reid_baseline.train INFO: normal accuracy 0.8368219339622641 2.305129289627075 
2022-04-12 21:00:16,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 21:00:16,275 reid_baseline.train INFO: Train Accuracy: 83.7% Mean Entropy: 230.5%
2022-04-12 21:04:33,521 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.647, Acc: 0.899, Base Lr: 4.83e-03
2022-04-12 21:06:50,683 reid_baseline.train INFO: Epoch 6 done. Time per batch: 2.595[s] Speed: 6.2[samples/s]
2022-04-12 21:10:11,097 reid_baseline.train INFO: normal accuracy 0.8251090199678678 2.119577646255493 
2022-04-12 21:10:12,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 21:10:12,102 reid_baseline.train INFO: Val Accuracy: 82.5% Mean Entropy: 212.0%
2022-04-12 21:10:35,929 reid_baseline.train INFO: normal accuracy 0.8679245283018868 1.9458634853363037 
2022-04-12 21:10:35,930 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 21:10:35,930 reid_baseline.train INFO: Train Accuracy: 86.8% Mean Entropy: 194.6%
2022-04-12 21:14:49,155 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.447, Acc: 0.932, Base Lr: 5.62e-03
2022-04-12 21:16:57,192 reid_baseline.train INFO: Epoch 7 done. Time per batch: 2.508[s] Speed: 6.4[samples/s]
2022-04-12 21:20:22,664 reid_baseline.train INFO: normal accuracy 0.8363552903373881 1.8976081609725952 
2022-04-12 21:20:25,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 21:20:25,208 reid_baseline.train INFO: Val Accuracy: 83.6% Mean Entropy: 189.8%
2022-04-12 21:20:49,696 reid_baseline.train INFO: normal accuracy 0.8811910377358491 1.709602952003479 
2022-04-12 21:20:49,696 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 21:20:49,696 reid_baseline.train INFO: Train Accuracy: 88.1% Mean Entropy: 171.0%
2022-04-12 21:25:03,946 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.949, Base Lr: 6.42e-03
2022-04-12 21:27:08,964 reid_baseline.train INFO: Epoch 8 done. Time per batch: 2.495[s] Speed: 6.4[samples/s]
2022-04-12 21:30:32,012 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.6992440223693848 
2022-04-12 21:30:32,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 21:30:32,966 reid_baseline.train INFO: Val Accuracy: 84.1% Mean Entropy: 169.9%
2022-04-12 21:30:57,151 reid_baseline.train INFO: normal accuracy 0.8882665094339622 1.491821050643921 
2022-04-12 21:30:57,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 21:30:57,151 reid_baseline.train INFO: Train Accuracy: 88.8% Mean Entropy: 149.2%
2022-04-12 21:35:03,837 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.968, Base Lr: 7.21e-03
2022-04-12 21:37:09,412 reid_baseline.train INFO: Epoch 9 done. Time per batch: 2.449[s] Speed: 6.5[samples/s]
2022-04-12 21:40:34,908 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.5955843925476074 
2022-04-12 21:40:37,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 21:40:37,780 reid_baseline.train INFO: Val Accuracy: 84.1% Mean Entropy: 159.6%
2022-04-12 21:41:03,371 reid_baseline.train INFO: normal accuracy 0.8919516509433962 1.3580480813980103 
2022-04-12 21:41:03,371 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 21:41:03,371 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 135.8%
2022-04-12 21:45:30,774 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.978, Base Lr: 4.01e-03
2022-04-12 21:47:39,758 reid_baseline.train INFO: Epoch 10 done. Time per batch: 2.608[s] Speed: 6.1[samples/s]
2022-04-12 21:51:07,453 reid_baseline.train INFO: normal accuracy 0.8439293091576773 1.6151618957519531 
2022-04-12 21:51:07,454 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 21:51:07,454 reid_baseline.train INFO: Val Accuracy: 84.4% Mean Entropy: 161.5%
2022-04-12 21:51:32,155 reid_baseline.train INFO: normal accuracy 0.8954893867924528 1.3685905933380127 
2022-04-12 21:51:32,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 21:51:32,155 reid_baseline.train INFO: Train Accuracy: 89.5% Mean Entropy: 136.9%
2022-04-12 21:55:51,749 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.152, Acc: 0.982, Base Lr: 3.38e-03
2022-04-12 21:58:09,295 reid_baseline.train INFO: Epoch 11 done. Time per batch: 2.613[s] Speed: 6.1[samples/s]
2022-04-12 22:01:36,642 reid_baseline.train INFO: normal accuracy 0.8436997934358503 1.5881086587905884 
2022-04-12 22:01:37,872 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 22:01:37,873 reid_baseline.train INFO: Val Accuracy: 84.4% Mean Entropy: 158.8%
2022-04-12 22:02:01,941 reid_baseline.train INFO: normal accuracy 0.8962264150943396 1.3349045515060425 
2022-04-12 22:02:01,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 22:02:01,941 reid_baseline.train INFO: Train Accuracy: 89.6% Mean Entropy: 133.5%
2022-04-12 22:06:20,814 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.100, Acc: 0.987, Base Lr: 2.77e-03
2022-04-12 22:08:30,751 reid_baseline.train INFO: Epoch 12 done. Time per batch: 2.558[s] Speed: 6.3[samples/s]
2022-04-12 22:12:08,438 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.5727667808532715 
2022-04-12 22:12:09,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 22:12:09,426 reid_baseline.train INFO: Val Accuracy: 84.0% Mean Entropy: 157.3%
2022-04-12 22:12:33,406 reid_baseline.train INFO: normal accuracy 0.8946049528301887 1.3102494478225708 
2022-04-12 22:12:33,407 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 22:12:33,407 reid_baseline.train INFO: Train Accuracy: 89.5% Mean Entropy: 131.0%
2022-04-12 22:16:59,373 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.092, Acc: 0.985, Base Lr: 2.20e-03
2022-04-12 22:19:20,504 reid_baseline.train INFO: Epoch 13 done. Time per batch: 2.678[s] Speed: 6.0[samples/s]
2022-04-12 22:22:30,077 reid_baseline.train INFO: normal accuracy 0.8455359192104659 1.5224889516830444 
2022-04-12 22:22:31,064 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 22:22:31,064 reid_baseline.train INFO: Val Accuracy: 84.6% Mean Entropy: 152.2%
2022-04-12 22:23:01,828 reid_baseline.train INFO: normal accuracy 0.8981426886792453 1.2562555074691772 
2022-04-12 22:23:01,829 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 22:23:01,829 reid_baseline.train INFO: Train Accuracy: 89.8% Mean Entropy: 125.6%
2022-04-12 22:26:59,024 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.063, Acc: 0.991, Base Lr: 1.66e-03
2022-04-12 22:28:59,741 reid_baseline.train INFO: Epoch 14 done. Time per batch: 2.355[s] Speed: 6.8[samples/s]
2022-04-12 22:32:05,566 reid_baseline.train INFO: normal accuracy 0.8464539820977737 1.4998809099197388 
2022-04-12 22:32:06,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 22:32:06,606 reid_baseline.train INFO: Val Accuracy: 84.6% Mean Entropy: 150.0%
2022-04-12 22:32:30,225 reid_baseline.train INFO: normal accuracy 0.8987323113207547 1.233412265777588 
2022-04-12 22:32:30,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 22:32:30,226 reid_baseline.train INFO: Train Accuracy: 89.9% Mean Entropy: 123.3%
2022-04-12 22:36:35,252 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.065, Acc: 0.991, Base Lr: 1.19e-03
2022-04-12 22:38:35,544 reid_baseline.train INFO: Epoch 15 done. Time per batch: 2.403[s] Speed: 6.7[samples/s]
2022-04-12 22:41:42,223 reid_baseline.train INFO: normal accuracy 0.8466834978196006 1.5528905391693115 
2022-04-12 22:41:42,223 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 22:41:42,223 reid_baseline.train INFO: Val Accuracy: 84.7% Mean Entropy: 155.3%
2022-04-12 22:42:06,130 reid_baseline.train INFO: normal accuracy 0.8988797169811321 1.2815604209899902 
2022-04-12 22:42:06,131 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 22:42:06,131 reid_baseline.train INFO: Train Accuracy: 89.9% Mean Entropy: 128.2%
2022-04-12 22:46:07,711 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.065, Acc: 0.993, Base Lr: 7.78e-04
2022-04-12 22:48:19,143 reid_baseline.train INFO: Epoch 16 done. Time per batch: 2.454[s] Speed: 6.5[samples/s]
2022-04-12 22:51:17,622 reid_baseline.train INFO: normal accuracy 0.8439293091576773 1.590084195137024 
2022-04-12 22:51:17,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 22:51:17,625 reid_baseline.train INFO: Val Accuracy: 84.4% Mean Entropy: 159.0%
2022-04-12 22:51:42,057 reid_baseline.train INFO: normal accuracy 0.8974056603773585 1.3153984546661377 
2022-04-12 22:51:42,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 22:51:42,058 reid_baseline.train INFO: Train Accuracy: 89.7% Mean Entropy: 131.5%
2022-04-12 22:55:35,376 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.051, Acc: 0.989, Base Lr: 4.51e-04
2022-04-12 22:57:27,099 reid_baseline.train INFO: Epoch 17 done. Time per batch: 2.270[s] Speed: 7.0[samples/s]
2022-04-12 23:00:20,283 reid_baseline.train INFO: normal accuracy 0.8446178563231581 1.5170451402664185 
2022-04-12 23:00:20,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 23:00:20,285 reid_baseline.train INFO: Val Accuracy: 84.5% Mean Entropy: 151.7%
2022-04-12 23:00:44,110 reid_baseline.train INFO: normal accuracy 0.8978478773584906 1.245020866394043 
2022-04-12 23:00:44,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 23:00:44,111 reid_baseline.train INFO: Train Accuracy: 89.8% Mean Entropy: 124.5%
2022-04-12 23:04:32,972 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.062, Acc: 0.993, Base Lr: 2.11e-04
2022-04-12 23:06:29,504 reid_baseline.train INFO: Epoch 18 done. Time per batch: 2.271[s] Speed: 7.0[samples/s]
2022-04-12 23:09:11,714 reid_baseline.train INFO: normal accuracy 0.8471425292632545 1.518616795539856 
2022-04-12 23:09:11,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 23:09:11,717 reid_baseline.train INFO: Val Accuracy: 84.7% Mean Entropy: 151.9%
2022-04-12 23:09:35,332 reid_baseline.train INFO: normal accuracy 0.8997641509433962 1.24520742893219 
2022-04-12 23:09:35,332 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 23:09:35,332 reid_baseline.train INFO: Train Accuracy: 90.0% Mean Entropy: 124.5%
2022-04-12 23:13:25,114 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.058, Acc: 0.991, Base Lr: 6.51e-05
2022-04-12 23:15:22,206 reid_baseline.train INFO: Epoch 19 done. Time per batch: 2.282[s] Speed: 7.0[samples/s]
2022-04-12 23:18:06,340 reid_baseline.train INFO: normal accuracy 0.8464539820977737 1.5414501428604126 
2022-04-12 23:18:06,341 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 23:18:06,341 reid_baseline.train INFO: Val Accuracy: 84.6% Mean Entropy: 154.1%
2022-04-12 23:18:32,872 reid_baseline.train INFO: normal accuracy 0.8991745283018868 1.266668677330017 
2022-04-12 23:18:32,872 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 23:18:32,872 reid_baseline.train INFO: Train Accuracy: 89.9% Mean Entropy: 126.7%
2022-04-12 23:22:19,094 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.061, Acc: 0.988, Base Lr: 1.60e-05
2022-04-12 23:24:15,277 reid_baseline.train INFO: Epoch 20 done. Time per batch: 2.253[s] Speed: 7.1[samples/s]
2022-04-12 23:26:59,202 reid_baseline.train INFO: normal accuracy 0.8471425292632545 1.5106890201568604 
2022-04-12 23:26:59,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 23:26:59,203 reid_baseline.train INFO: Val Accuracy: 84.7% Mean Entropy: 151.1%
2022-04-12 23:27:22,598 reid_baseline.train INFO: normal accuracy 0.8997641509433962 1.2387986183166504 
2022-04-12 23:27:22,599 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 23:27:22,599 reid_baseline.train INFO: Train Accuracy: 90.0% Mean Entropy: 123.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits/transformer_best_model.pth
2022-04-12 23:30:05,511 reid_baseline.train INFO: normal accuracy 0.8464539820977737 1.4998809099197388 
2022-04-12 23:30:05,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 23:30:05,512 reid_baseline.train INFO: Accuracy: 84.6%
2022-04-12 23:30:26,950 reid_baseline.train INFO: normal accuracy 0.8987323113207547 1.233412265777588 
2022-04-12 23:30:26,950 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 23:30:26,950 reid_baseline.train INFO: Train Accuracy: 89.9%
