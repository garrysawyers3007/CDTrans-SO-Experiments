2022-04-20 16:57:52,091 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_11_feature_mixup_RCS
2022-04-20 16:57:52,091 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_11_feature_mixup_RCS', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Clipart_only_classifier/transformer_best_model.pth', configuration='Art2Clipart')
2022-04-20 16:57:52,091 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-20 16:57:52,092 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-20 16:57:52,092 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_11_feature_mixup_RCS
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_only_classifier/transformer_best_model.pth
2022-04-20 16:58:06,365 reid_baseline.train INFO: start training
2022-04-20 17:03:24,499 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.098, Acc: 0.400, Base Lr: 8.72e-04
2022-04-20 17:06:08,891 reid_baseline.train INFO: Epoch 1 done. Time per batch: 3.156[s] Speed: 5.1[samples/s]
2022-04-20 17:07:19,656 reid_baseline.train INFO: normal accuracy 0.3443298969072165 4.170092582702637 
2022-04-20 17:07:20,379 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 17:07:20,379 reid_baseline.train INFO: Val Accuracy: 34.4% Mean Entropy: 417.0%
2022-04-20 17:07:53,358 reid_baseline.train INFO: normal accuracy 0.5008833922261484 4.1699538230896 
2022-04-20 17:07:53,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 17:07:53,358 reid_baseline.train INFO: Train Accuracy: 50.1% Mean Entropy: 417.0%
2022-04-20 17:13:09,140 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.492, Acc: 0.748, Base Lr: 1.66e-03
2022-04-20 17:15:47,744 reid_baseline.train INFO: Epoch 2 done. Time per batch: 3.121[s] Speed: 5.1[samples/s]
2022-04-20 17:16:57,496 reid_baseline.train INFO: normal accuracy 0.3665521191294387 4.13631010055542 
2022-04-20 17:16:58,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 17:16:58,395 reid_baseline.train INFO: Val Accuracy: 36.7% Mean Entropy: 413.6%
2022-04-20 17:17:33,370 reid_baseline.train INFO: normal accuracy 0.5169316843345112 4.125232696533203 
2022-04-20 17:17:33,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 17:17:33,370 reid_baseline.train INFO: Train Accuracy: 51.7% Mean Entropy: 412.5%
2022-04-20 17:22:41,740 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.591, Acc: 0.761, Base Lr: 2.46e-03
2022-04-20 17:25:21,683 reid_baseline.train INFO: Epoch 3 done. Time per batch: 3.081[s] Speed: 5.2[samples/s]
2022-04-20 17:26:25,352 reid_baseline.train INFO: normal accuracy 0.4054982817869416 3.9211416244506836 
2022-04-20 17:26:26,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 17:26:26,100 reid_baseline.train INFO: Val Accuracy: 40.5% Mean Entropy: 392.1%
2022-04-20 17:26:58,965 reid_baseline.train INFO: normal accuracy 0.5435806831566549 3.8261988162994385 
2022-04-20 17:26:58,965 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 17:26:58,965 reid_baseline.train INFO: Train Accuracy: 54.4% Mean Entropy: 382.6%
2022-04-20 17:31:28,403 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.497, Acc: 0.786, Base Lr: 3.25e-03
2022-04-20 17:33:44,050 reid_baseline.train INFO: Epoch 4 done. Time per batch: 2.664[s] Speed: 6.0[samples/s]
2022-04-20 17:34:48,202 reid_baseline.train INFO: normal accuracy 0.4849942726231386 3.3356897830963135 
2022-04-20 17:34:49,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 17:34:49,021 reid_baseline.train INFO: Val Accuracy: 48.5% Mean Entropy: 333.6%
2022-04-20 17:35:20,898 reid_baseline.train INFO: normal accuracy 0.6089517078916372 3.11411190032959 
2022-04-20 17:35:20,898 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 17:35:20,899 reid_baseline.train INFO: Train Accuracy: 60.9% Mean Entropy: 311.4%
2022-04-20 17:40:03,225 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 1.845, Acc: 0.836, Base Lr: 4.04e-03
2022-04-20 17:42:20,556 reid_baseline.train INFO: Epoch 5 done. Time per batch: 2.761[s] Speed: 5.8[samples/s]
2022-04-20 17:43:23,835 reid_baseline.train INFO: normal accuracy 0.550057273768614 2.906787872314453 
2022-04-20 17:43:24,599 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 17:43:24,600 reid_baseline.train INFO: Val Accuracy: 55.0% Mean Entropy: 290.7%
2022-04-20 17:43:52,374 reid_baseline.train INFO: normal accuracy 0.6719670200235571 2.609020233154297 
2022-04-20 17:43:52,374 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 17:43:52,374 reid_baseline.train INFO: Train Accuracy: 67.2% Mean Entropy: 260.9%
2022-04-20 17:48:29,137 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.483, Acc: 0.881, Base Lr: 4.83e-03
2022-04-20 17:50:52,017 reid_baseline.train INFO: Epoch 6 done. Time per batch: 2.761[s] Speed: 5.8[samples/s]
2022-04-20 17:51:57,151 reid_baseline.train INFO: normal accuracy 0.5802978235967927 2.5321552753448486 
2022-04-20 17:51:57,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 17:51:57,940 reid_baseline.train INFO: Val Accuracy: 58.0% Mean Entropy: 253.2%
2022-04-20 17:52:32,114 reid_baseline.train INFO: normal accuracy 0.7062720848056537 2.194519281387329 
2022-04-20 17:52:32,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 17:52:32,115 reid_baseline.train INFO: Train Accuracy: 70.6% Mean Entropy: 219.5%
2022-04-20 17:57:14,575 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.302, Acc: 0.915, Base Lr: 5.62e-03
2022-04-20 17:59:37,046 reid_baseline.train INFO: Epoch 7 done. Time per batch: 2.795[s] Speed: 5.7[samples/s]
2022-04-20 18:00:40,959 reid_baseline.train INFO: normal accuracy 0.590836197021764 2.2838833332061768 
2022-04-20 18:00:41,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 18:00:41,755 reid_baseline.train INFO: Val Accuracy: 59.1% Mean Entropy: 228.4%
2022-04-20 18:01:15,527 reid_baseline.train INFO: normal accuracy 0.7218786808009423 1.919187068939209 
2022-04-20 18:01:15,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 18:01:15,527 reid_baseline.train INFO: Train Accuracy: 72.2% Mean Entropy: 191.9%
2022-04-20 18:05:38,271 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.203, Acc: 0.938, Base Lr: 6.42e-03
2022-04-20 18:08:11,995 reid_baseline.train INFO: Epoch 8 done. Time per batch: 2.740[s] Speed: 5.8[samples/s]
2022-04-20 18:09:14,808 reid_baseline.train INFO: normal accuracy 0.6034364261168385 2.1849002838134766 
2022-04-20 18:09:15,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 18:09:15,681 reid_baseline.train INFO: Val Accuracy: 60.3% Mean Entropy: 218.5%
2022-04-20 18:09:49,698 reid_baseline.train INFO: normal accuracy 0.7343934040047114 1.8039703369140625 
2022-04-20 18:09:49,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 18:09:49,699 reid_baseline.train INFO: Train Accuracy: 73.4% Mean Entropy: 180.4%
2022-04-20 18:14:32,448 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.131, Acc: 0.954, Base Lr: 7.21e-03
2022-04-20 18:16:48,992 reid_baseline.train INFO: Epoch 9 done. Time per batch: 2.758[s] Speed: 5.8[samples/s]
2022-04-20 18:17:51,300 reid_baseline.train INFO: normal accuracy 0.6038946162657503 2.076587200164795 
2022-04-20 18:17:52,091 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 18:17:52,091 reid_baseline.train INFO: Val Accuracy: 60.4% Mean Entropy: 207.7%
2022-04-20 18:18:25,623 reid_baseline.train INFO: normal accuracy 0.7380742049469965 1.668145775794983 
2022-04-20 18:18:25,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 18:18:25,624 reid_baseline.train INFO: Train Accuracy: 73.8% Mean Entropy: 166.8%
2022-04-20 18:22:55,265 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.097, Acc: 0.969, Base Lr: 4.01e-03
2022-04-20 18:24:01,420 reid_baseline.train INFO: Epoch 10 done. Time per batch: 2.209[s] Speed: 7.2[samples/s]
2022-04-20 18:25:01,820 reid_baseline.train INFO: normal accuracy 0.6038946162657503 2.040738105773926 
2022-04-20 18:25:02,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 18:25:02,555 reid_baseline.train INFO: Val Accuracy: 60.4% Mean Entropy: 204.1%
2022-04-20 18:25:21,708 reid_baseline.train INFO: normal accuracy 0.7402826855123675 1.6232719421386719 
2022-04-20 18:25:21,708 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 18:25:21,708 reid_baseline.train INFO: Train Accuracy: 74.0% Mean Entropy: 162.3%
2022-04-20 18:30:06,045 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.030, Acc: 0.978, Base Lr: 3.38e-03
2022-04-20 18:32:46,760 reid_baseline.train INFO: Epoch 11 done. Time per batch: 2.928[s] Speed: 5.5[samples/s]
2022-04-20 18:33:49,934 reid_baseline.train INFO: normal accuracy 0.6112256586483391 2.0361764430999756 
2022-04-20 18:33:50,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-20 18:33:50,689 reid_baseline.train INFO: Val Accuracy: 61.1% Mean Entropy: 203.6%
2022-04-20 18:34:23,928 reid_baseline.train INFO: normal accuracy 0.7463191990577149 1.5992897748947144 
2022-04-20 18:34:23,929 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-20 18:34:23,929 reid_baseline.train INFO: Train Accuracy: 74.6% Mean Entropy: 159.9%
2022-04-20 18:39:34,757 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.018, Acc: 0.982, Base Lr: 2.77e-03
2022-04-20 18:42:15,409 reid_baseline.train INFO: Epoch 12 done. Time per batch: 3.102[s] Speed: 5.2[samples/s]
2022-04-20 18:43:18,527 reid_baseline.train INFO: normal accuracy 0.6057273768613974 1.9837987422943115 
2022-04-20 18:43:19,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-20 18:43:19,270 reid_baseline.train INFO: Val Accuracy: 60.6% Mean Entropy: 198.4%
2022-04-20 18:43:53,667 reid_baseline.train INFO: normal accuracy 0.7429328621908127 1.5468926429748535 
2022-04-20 18:43:53,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-20 18:43:53,667 reid_baseline.train INFO: Train Accuracy: 74.3% Mean Entropy: 154.7%
2022-04-20 18:49:07,110 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.004, Acc: 0.985, Base Lr: 2.20e-03
2022-04-20 18:51:46,676 reid_baseline.train INFO: Epoch 13 done. Time per batch: 3.112[s] Speed: 5.1[samples/s]
2022-04-20 18:52:51,229 reid_baseline.train INFO: normal accuracy 0.6077892325315005 2.0005972385406494 
2022-04-20 18:52:51,231 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-20 18:52:51,231 reid_baseline.train INFO: Val Accuracy: 60.8% Mean Entropy: 200.1%
2022-04-20 18:53:24,220 reid_baseline.train INFO: normal accuracy 0.7446996466431095 1.55679452419281 
2022-04-20 18:53:24,221 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-20 18:53:24,221 reid_baseline.train INFO: Train Accuracy: 74.5% Mean Entropy: 155.7%
2022-04-20 18:58:33,340 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.011, Acc: 0.986, Base Lr: 1.66e-03
2022-04-20 19:01:14,255 reid_baseline.train INFO: Epoch 14 done. Time per batch: 3.092[s] Speed: 5.2[samples/s]
2022-04-20 19:02:17,280 reid_baseline.train INFO: normal accuracy 0.6116838487972509 2.0247066020965576 
2022-04-20 19:02:17,282 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-20 19:02:17,282 reid_baseline.train INFO: Val Accuracy: 61.2% Mean Entropy: 202.5%
2022-04-20 19:02:50,948 reid_baseline.train INFO: normal accuracy 0.7473498233215548 1.5719802379608154 
2022-04-20 19:02:50,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-20 19:02:50,948 reid_baseline.train INFO: Train Accuracy: 74.7% Mean Entropy: 157.2%
2022-04-20 19:08:02,241 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.979, Acc: 0.986, Base Lr: 1.19e-03
2022-04-20 19:10:41,369 reid_baseline.train INFO: Epoch 15 done. Time per batch: 3.095[s] Speed: 5.2[samples/s]
2022-04-20 19:11:45,147 reid_baseline.train INFO: normal accuracy 0.6123711340206186 2.0479819774627686 
2022-04-20 19:11:45,149 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-20 19:11:45,149 reid_baseline.train INFO: Val Accuracy: 61.2% Mean Entropy: 204.8%
2022-04-20 19:12:17,699 reid_baseline.train INFO: normal accuracy 0.747791519434629 1.5947787761688232 
2022-04-20 19:12:17,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-20 19:12:17,699 reid_baseline.train INFO: Train Accuracy: 74.8% Mean Entropy: 159.5%
2022-04-20 19:17:27,345 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.972, Acc: 0.991, Base Lr: 7.78e-04
2022-04-20 19:20:07,153 reid_baseline.train INFO: Epoch 16 done. Time per batch: 3.088[s] Speed: 5.2[samples/s]
2022-04-20 19:21:11,211 reid_baseline.train INFO: normal accuracy 0.6075601374570446 2.0358283519744873 
2022-04-20 19:21:11,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-20 19:21:11,213 reid_baseline.train INFO: Val Accuracy: 60.8% Mean Entropy: 203.6%
2022-04-20 19:21:44,872 reid_baseline.train INFO: normal accuracy 0.7446996466431095 1.582687258720398 
2022-04-20 19:21:44,873 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-20 19:21:44,873 reid_baseline.train INFO: Train Accuracy: 74.5% Mean Entropy: 158.3%
2022-04-20 19:26:54,994 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.951, Acc: 0.987, Base Lr: 4.51e-04
2022-04-20 19:29:32,256 reid_baseline.train INFO: Epoch 17 done. Time per batch: 3.075[s] Speed: 5.2[samples/s]
2022-04-20 19:30:34,396 reid_baseline.train INFO: normal accuracy 0.6105383734249714 2.0396223068237305 
2022-04-20 19:30:34,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-20 19:30:34,399 reid_baseline.train INFO: Val Accuracy: 61.1% Mean Entropy: 204.0%
2022-04-20 19:31:07,203 reid_baseline.train INFO: normal accuracy 0.7467608951707891 1.5805160999298096 
2022-04-20 19:31:07,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-20 19:31:07,203 reid_baseline.train INFO: Train Accuracy: 74.7% Mean Entropy: 158.1%
2022-04-20 19:35:50,925 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.974, Acc: 0.984, Base Lr: 2.11e-04
2022-04-20 19:38:39,200 reid_baseline.train INFO: Epoch 18 done. Time per batch: 2.974[s] Speed: 5.4[samples/s]
2022-04-20 19:39:45,521 reid_baseline.train INFO: normal accuracy 0.6126002290950745 2.080594539642334 
2022-04-20 19:39:45,523 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-20 19:39:45,524 reid_baseline.train INFO: Val Accuracy: 61.3% Mean Entropy: 208.1%
2022-04-20 19:40:19,739 reid_baseline.train INFO: normal accuracy 0.7480859835100118 1.6204746961593628 
2022-04-20 19:40:19,740 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-20 19:40:19,740 reid_baseline.train INFO: Train Accuracy: 74.8% Mean Entropy: 162.0%
2022-04-20 19:45:49,183 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.947, Acc: 0.987, Base Lr: 6.51e-05
2022-04-20 19:48:36,976 reid_baseline.train INFO: Epoch 19 done. Time per batch: 3.271[s] Speed: 4.9[samples/s]
2022-04-20 19:49:42,276 reid_baseline.train INFO: normal accuracy 0.6087056128293241 2.0052061080932617 
2022-04-20 19:49:42,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-20 19:49:42,279 reid_baseline.train INFO: Val Accuracy: 60.9% Mean Entropy: 200.5%
2022-04-20 19:50:16,015 reid_baseline.train INFO: normal accuracy 0.7454358068315665 1.5490370988845825 
2022-04-20 19:50:16,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-20 19:50:16,016 reid_baseline.train INFO: Train Accuracy: 74.5% Mean Entropy: 154.9%
2022-04-20 19:55:46,535 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.964, Acc: 0.990, Base Lr: 1.60e-05
2022-04-20 19:58:35,568 reid_baseline.train INFO: Epoch 20 done. Time per batch: 3.287[s] Speed: 4.9[samples/s]
2022-04-20 19:59:48,899 reid_baseline.train INFO: normal accuracy 0.6105383734249714 2.0249571800231934 
2022-04-20 19:59:48,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-20 19:59:48,902 reid_baseline.train INFO: Val Accuracy: 61.1% Mean Entropy: 202.5%
2022-04-20 20:00:23,803 reid_baseline.train INFO: normal accuracy 0.7467608951707891 1.5671919584274292 
2022-04-20 20:00:23,803 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-20 20:00:23,803 reid_baseline.train INFO: Train Accuracy: 74.7% Mean Entropy: 156.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_11_feature_mixup_RCS/transformer_best_model.pth
2022-04-20 20:01:38,634 reid_baseline.train INFO: normal accuracy 0.6057273768613974 1.9837987422943115 
2022-04-20 20:01:38,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-20 20:01:38,635 reid_baseline.train INFO: Accuracy: 60.6%
2022-04-20 20:02:14,052 reid_baseline.train INFO: normal accuracy 0.7429328621908127 1.5468926429748535 
2022-04-20 20:02:14,053 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-20 20:02:14,053 reid_baseline.train INFO: Train Accuracy: 74.3%
2022-04-20 20:02:19,340 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_11_feature_mixup_RCS
2022-04-20 20:02:19,340 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_11_feature_mixup_RCS', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth', configuration='Art2Product')
2022-04-20 20:02:19,340 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-20 20:02:19,340 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-20 20:02:19,340 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_11_feature_mixup_RCS
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth
2022-04-20 20:02:34,122 reid_baseline.train INFO: start training
2022-04-20 20:08:09,113 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.509, Acc: 0.376, Base Lr: 8.72e-04
2022-04-20 20:11:02,743 reid_baseline.train INFO: Epoch 1 done. Time per batch: 3.328[s] Speed: 4.8[samples/s]
2022-04-20 20:12:28,733 reid_baseline.train INFO: normal accuracy 0.5715251182698806 4.170834541320801 
2022-04-20 20:12:29,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 20:12:29,807 reid_baseline.train INFO: Val Accuracy: 57.2% Mean Entropy: 417.1%
2022-04-20 20:13:06,264 reid_baseline.train INFO: normal accuracy 0.6392368191086514 4.17030668258667 
2022-04-20 20:13:06,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 20:13:06,265 reid_baseline.train INFO: Train Accuracy: 63.9% Mean Entropy: 417.0%
2022-04-20 20:18:31,620 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.994, Acc: 0.712, Base Lr: 1.66e-03
2022-04-20 20:21:17,648 reid_baseline.train INFO: Epoch 2 done. Time per batch: 3.233[s] Speed: 4.9[samples/s]
2022-04-20 20:22:44,695 reid_baseline.train INFO: normal accuracy 0.5911241270556432 4.138080596923828 
2022-04-20 20:22:45,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 20:22:45,626 reid_baseline.train INFO: Val Accuracy: 59.1% Mean Entropy: 413.8%
2022-04-20 20:23:22,171 reid_baseline.train INFO: normal accuracy 0.6559860180600058 4.124845504760742 
2022-04-20 20:23:22,171 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 20:23:22,171 reid_baseline.train INFO: Train Accuracy: 65.6% Mean Entropy: 412.5%
2022-04-20 20:28:49,864 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.763, Acc: 0.746, Base Lr: 2.46e-03
2022-04-20 20:31:43,102 reid_baseline.train INFO: Epoch 3 done. Time per batch: 3.295[s] Speed: 4.9[samples/s]
2022-04-20 20:33:13,460 reid_baseline.train INFO: normal accuracy 0.605316512728092 3.895508050918579 
2022-04-20 20:33:14,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 20:33:14,459 reid_baseline.train INFO: Val Accuracy: 60.5% Mean Entropy: 389.6%
2022-04-20 20:33:51,805 reid_baseline.train INFO: normal accuracy 0.6685115059714536 3.7893357276916504 
2022-04-20 20:33:51,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 20:33:51,805 reid_baseline.train INFO: Train Accuracy: 66.9% Mean Entropy: 378.9%
2022-04-20 20:39:46,854 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.642, Acc: 0.771, Base Lr: 3.25e-03
2022-04-20 20:42:50,577 reid_baseline.train INFO: Epoch 4 done. Time per batch: 3.545[s] Speed: 4.5[samples/s]
2022-04-20 20:44:19,612 reid_baseline.train INFO: normal accuracy 0.6487947735976571 3.321882486343384 
2022-04-20 20:44:20,389 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 20:44:20,389 reid_baseline.train INFO: Val Accuracy: 64.9% Mean Entropy: 332.2%
2022-04-20 20:44:55,661 reid_baseline.train INFO: normal accuracy 0.7149723274104282 3.107388973236084 
2022-04-20 20:44:55,662 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 20:44:55,662 reid_baseline.train INFO: Train Accuracy: 71.5% Mean Entropy: 310.7%
2022-04-20 20:50:11,153 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 1.977, Acc: 0.838, Base Lr: 4.04e-03
2022-04-20 20:53:13,410 reid_baseline.train INFO: Epoch 5 done. Time per batch: 3.275[s] Speed: 4.9[samples/s]
2022-04-20 20:54:47,278 reid_baseline.train INFO: normal accuracy 0.7220094615904483 2.7892367839813232 
2022-04-20 20:54:48,461 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 20:54:48,462 reid_baseline.train INFO: Val Accuracy: 72.2% Mean Entropy: 278.9%
2022-04-20 20:55:25,316 reid_baseline.train INFO: normal accuracy 0.7826973492572095 2.545473098754883 
2022-04-20 20:55:25,317 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 20:55:25,317 reid_baseline.train INFO: Train Accuracy: 78.3% Mean Entropy: 254.5%
2022-04-20 21:00:49,022 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.622, Acc: 0.888, Base Lr: 4.83e-03
2022-04-20 21:03:27,360 reid_baseline.train INFO: Epoch 6 done. Time per batch: 3.171[s] Speed: 5.0[samples/s]
2022-04-20 21:04:57,420 reid_baseline.train INFO: normal accuracy 0.7630096868664114 2.4030673503875732 
2022-04-20 21:04:58,569 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 21:04:58,570 reid_baseline.train INFO: Val Accuracy: 76.3% Mean Entropy: 240.3%
2022-04-20 21:05:36,785 reid_baseline.train INFO: normal accuracy 0.8252257500728226 2.138251781463623 
2022-04-20 21:05:36,786 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 21:05:36,786 reid_baseline.train INFO: Train Accuracy: 82.5% Mean Entropy: 213.8%
2022-04-20 21:10:28,879 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.434, Acc: 0.915, Base Lr: 5.62e-03
2022-04-20 21:13:20,431 reid_baseline.train INFO: Epoch 7 done. Time per batch: 3.050[s] Speed: 5.2[samples/s]
2022-04-20 21:14:50,819 reid_baseline.train INFO: normal accuracy 0.7801306600585718 2.1685640811920166 
2022-04-20 21:14:51,655 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 21:14:51,656 reid_baseline.train INFO: Val Accuracy: 78.0% Mean Entropy: 216.9%
2022-04-20 21:15:29,326 reid_baseline.train INFO: normal accuracy 0.8429944654820857 1.8876808881759644 
2022-04-20 21:15:29,327 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 21:15:29,327 reid_baseline.train INFO: Train Accuracy: 84.3% Mean Entropy: 188.8%
2022-04-20 21:20:47,055 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.321, Acc: 0.942, Base Lr: 6.42e-03
2022-04-20 21:23:18,588 reid_baseline.train INFO: Epoch 8 done. Time per batch: 3.087[s] Speed: 5.2[samples/s]
2022-04-20 21:24:38,393 reid_baseline.train INFO: normal accuracy 0.7848614552827213 2.0031511783599854 
2022-04-20 21:24:39,362 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 21:24:39,363 reid_baseline.train INFO: Val Accuracy: 78.5% Mean Entropy: 200.3%
2022-04-20 21:25:17,567 reid_baseline.train INFO: normal accuracy 0.8496941450626274 1.7072311639785767 
2022-04-20 21:25:17,567 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 21:25:17,567 reid_baseline.train INFO: Train Accuracy: 85.0% Mean Entropy: 170.7%
2022-04-20 21:30:23,505 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.956, Base Lr: 7.21e-03
2022-04-20 21:32:58,487 reid_baseline.train INFO: Epoch 9 done. Time per batch: 3.032[s] Speed: 5.3[samples/s]
2022-04-20 21:34:30,272 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.878438949584961 
2022-04-20 21:34:31,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 21:34:31,443 reid_baseline.train INFO: Val Accuracy: 78.1% Mean Entropy: 187.8%
2022-04-20 21:35:08,640 reid_baseline.train INFO: normal accuracy 0.8520244683949898 1.5591257810592651 
2022-04-20 21:35:08,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 21:35:08,641 reid_baseline.train INFO: Train Accuracy: 85.2% Mean Entropy: 155.9%
2022-04-20 21:40:25,601 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.188, Acc: 0.969, Base Lr: 4.01e-03
2022-04-20 21:43:06,732 reid_baseline.train INFO: Epoch 10 done. Time per batch: 3.145[s] Speed: 5.1[samples/s]
2022-04-20 21:44:33,352 reid_baseline.train INFO: normal accuracy 0.7913944582113088 1.8973647356033325 
2022-04-20 21:44:33,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 21:44:33,353 reid_baseline.train INFO: Val Accuracy: 79.1% Mean Entropy: 189.7%
2022-04-20 21:45:09,137 reid_baseline.train INFO: normal accuracy 0.8595980192251675 1.5662504434585571 
2022-04-20 21:45:09,138 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 21:45:09,138 reid_baseline.train INFO: Train Accuracy: 86.0% Mean Entropy: 156.6%
2022-04-20 21:50:36,940 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.107, Acc: 0.981, Base Lr: 3.38e-03
2022-04-20 21:53:04,375 reid_baseline.train INFO: Epoch 11 done. Time per batch: 3.126[s] Speed: 5.1[samples/s]
2022-04-20 21:54:38,025 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.8108206987380981 
2022-04-20 21:54:39,087 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-20 21:54:39,088 reid_baseline.train INFO: Val Accuracy: 79.0% Mean Entropy: 181.1%
2022-04-20 21:55:09,014 reid_baseline.train INFO: normal accuracy 0.8598893096417128 1.4847251176834106 
2022-04-20 21:55:09,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-20 21:55:09,014 reid_baseline.train INFO: Train Accuracy: 86.0% Mean Entropy: 148.5%
2022-04-20 22:00:02,913 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.097, Acc: 0.985, Base Lr: 2.77e-03
2022-04-20 22:03:07,819 reid_baseline.train INFO: Epoch 12 done. Time per batch: 3.150[s] Speed: 5.1[samples/s]
2022-04-20 22:04:38,676 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.755250334739685 
2022-04-20 22:04:39,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-20 22:04:39,561 reid_baseline.train INFO: Val Accuracy: 79.1% Mean Entropy: 175.5%
2022-04-20 22:05:18,813 reid_baseline.train INFO: normal accuracy 0.8617826973492572 1.428731918334961 
2022-04-20 22:05:18,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-20 22:05:18,814 reid_baseline.train INFO: Train Accuracy: 86.2% Mean Entropy: 142.9%
2022-04-20 22:10:56,235 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.073, Acc: 0.986, Base Lr: 2.20e-03
2022-04-20 22:12:32,631 reid_baseline.train INFO: Epoch 13 done. Time per batch: 2.854[s] Speed: 5.6[samples/s]
2022-04-20 22:13:52,378 reid_baseline.train INFO: normal accuracy 0.7943230457310205 1.7948025465011597 
2022-04-20 22:13:52,379 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-20 22:13:52,379 reid_baseline.train INFO: Val Accuracy: 79.4% Mean Entropy: 179.5%
2022-04-20 22:14:14,089 reid_baseline.train INFO: normal accuracy 0.8641130206816195 1.4539213180541992 
2022-04-20 22:14:14,090 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-20 22:14:14,090 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 145.4%
2022-04-20 22:16:12,774 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.065, Acc: 0.986, Base Lr: 1.66e-03
2022-04-20 22:17:08,291 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.146[s] Speed: 14.0[samples/s]
2022-04-20 22:18:27,612 reid_baseline.train INFO: normal accuracy 0.7956747015093489 1.8004428148269653 
2022-04-20 22:18:27,613 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-20 22:18:27,613 reid_baseline.train INFO: Val Accuracy: 79.6% Mean Entropy: 180.0%
2022-04-20 22:18:50,189 reid_baseline.train INFO: normal accuracy 0.8651325371395281 1.4544768333435059 
2022-04-20 22:18:50,190 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-20 22:18:50,190 reid_baseline.train INFO: Train Accuracy: 86.5% Mean Entropy: 145.4%
2022-04-20 22:20:46,499 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.035, Acc: 0.986, Base Lr: 1.19e-03
2022-04-20 22:21:44,717 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.148[s] Speed: 13.9[samples/s]
2022-04-20 22:23:06,760 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.820585012435913 
2022-04-20 22:23:06,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-20 22:23:06,760 reid_baseline.train INFO: Val Accuracy: 79.3% Mean Entropy: 182.1%
2022-04-20 22:23:30,533 reid_baseline.train INFO: normal accuracy 0.863530439848529 1.472927451133728 
2022-04-20 22:23:30,533 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-20 22:23:30,533 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 147.3%
2022-04-20 22:25:30,610 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.026, Acc: 0.993, Base Lr: 7.78e-04
2022-04-20 22:26:26,494 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.158[s] Speed: 13.8[samples/s]
2022-04-20 22:27:47,167 reid_baseline.train INFO: normal accuracy 0.7934219418788016 1.7910609245300293 
2022-04-20 22:27:47,167 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-20 22:27:47,167 reid_baseline.train INFO: Val Accuracy: 79.3% Mean Entropy: 179.1%
2022-04-20 22:28:10,136 reid_baseline.train INFO: normal accuracy 0.8638217302650743 1.4437534809112549 
2022-04-20 22:28:10,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-20 22:28:10,137 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 144.4%
2022-04-20 22:30:06,415 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.037, Acc: 0.987, Base Lr: 4.51e-04
2022-04-20 22:31:03,311 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.139[s] Speed: 14.0[samples/s]
2022-04-20 22:32:28,616 reid_baseline.train INFO: normal accuracy 0.7958999774724037 1.8010245561599731 
2022-04-20 22:32:28,617 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-20 22:32:28,617 reid_baseline.train INFO: Val Accuracy: 79.6% Mean Entropy: 180.1%
2022-04-20 22:32:52,126 reid_baseline.train INFO: normal accuracy 0.865569472764346 1.4466179609298706 
2022-04-20 22:32:52,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-20 22:32:52,126 reid_baseline.train INFO: Train Accuracy: 86.6% Mean Entropy: 144.7%
2022-04-20 22:34:51,070 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.037, Acc: 0.986, Base Lr: 2.11e-04
2022-04-20 22:35:49,844 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.169[s] Speed: 13.7[samples/s]
2022-04-20 22:37:09,761 reid_baseline.train INFO: normal accuracy 0.7936472178418563 1.8468629121780396 
2022-04-20 22:37:09,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-20 22:37:09,762 reid_baseline.train INFO: Val Accuracy: 79.4% Mean Entropy: 184.7%
2022-04-20 22:37:32,556 reid_baseline.train INFO: normal accuracy 0.8641130206816195 1.491580843925476 
2022-04-20 22:37:32,556 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-20 22:37:32,557 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 149.2%
2022-04-20 22:39:34,501 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.030, Acc: 0.989, Base Lr: 6.51e-05
2022-04-20 22:40:31,746 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.179[s] Speed: 13.6[samples/s]
2022-04-20 22:41:53,458 reid_baseline.train INFO: normal accuracy 0.7945483216940752 1.767431378364563 
2022-04-20 22:41:53,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-20 22:41:53,461 reid_baseline.train INFO: Val Accuracy: 79.5% Mean Entropy: 176.7%
2022-04-20 22:42:17,014 reid_baseline.train INFO: normal accuracy 0.8646956015147101 1.4186054468154907 
2022-04-20 22:42:17,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-20 22:42:17,014 reid_baseline.train INFO: Train Accuracy: 86.5% Mean Entropy: 141.9%
2022-04-20 22:44:16,601 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.013, Acc: 0.991, Base Lr: 1.60e-05
2022-04-20 22:45:11,833 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.150[s] Speed: 13.9[samples/s]
2022-04-20 22:46:39,069 reid_baseline.train INFO: normal accuracy 0.7956747015093489 1.797823190689087 
2022-04-20 22:46:39,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-20 22:46:39,070 reid_baseline.train INFO: Val Accuracy: 79.6% Mean Entropy: 179.8%
2022-04-20 22:47:00,153 reid_baseline.train INFO: normal accuracy 0.8652781823478007 1.4456701278686523 
2022-04-20 22:47:00,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-20 22:47:00,153 reid_baseline.train INFO: Train Accuracy: 86.5% Mean Entropy: 144.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_11_feature_mixup_RCS/transformer_best_model.pth
2022-04-20 22:48:29,357 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.755250334739685 
2022-04-20 22:48:29,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-20 22:48:29,358 reid_baseline.train INFO: Accuracy: 79.1%
2022-04-20 22:48:50,819 reid_baseline.train INFO: normal accuracy 0.8617826973492572 1.428731918334961 
2022-04-20 22:48:50,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-20 22:48:50,820 reid_baseline.train INFO: Train Accuracy: 86.2%
2022-04-20 22:48:57,577 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_11_feature_mixup_RCS
2022-04-20 22:48:57,577 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_11_feature_mixup_RCS', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Art_2_Real_World_only_classifier/transformer_best_model.pth', configuration='Art2Real_World')
2022-04-20 22:48:57,577 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-20 22:48:57,577 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-20 22:48:57,577 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_11_feature_mixup_RCS
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_only_classifier/transformer_best_model.pth
2022-04-20 22:49:15,301 reid_baseline.train INFO: start training
2022-04-20 22:51:13,759 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.813, Acc: 0.404, Base Lr: 8.72e-04
2022-04-20 22:52:11,384 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.150[s] Speed: 13.9[samples/s]
2022-04-20 22:55:33,839 reid_baseline.train INFO: normal accuracy 0.6474638512738122 4.170646667480469 
2022-04-20 22:55:34,686 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 22:55:34,686 reid_baseline.train INFO: Val Accuracy: 64.7% Mean Entropy: 417.1%
2022-04-20 22:55:58,488 reid_baseline.train INFO: normal accuracy 0.6928066037735849 4.17019510269165 
2022-04-20 22:55:58,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-20 22:55:58,488 reid_baseline.train INFO: Train Accuracy: 69.3% Mean Entropy: 417.0%
2022-04-20 22:57:58,420 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.327, Acc: 0.730, Base Lr: 1.66e-03
2022-04-20 22:58:56,542 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-04-20 23:02:13,183 reid_baseline.train INFO: normal accuracy 0.6690383291255451 4.126246929168701 
2022-04-20 23:02:14,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 23:02:14,365 reid_baseline.train INFO: Val Accuracy: 66.9% Mean Entropy: 412.6%
2022-04-20 23:02:36,949 reid_baseline.train INFO: normal accuracy 0.7127063679245284 4.1152663230896 
2022-04-20 23:02:36,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-20 23:02:36,949 reid_baseline.train INFO: Train Accuracy: 71.3% Mean Entropy: 411.5%
2022-04-20 23:04:31,657 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.392, Acc: 0.756, Base Lr: 2.46e-03
2022-04-20 23:05:29,889 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.138[s] Speed: 14.1[samples/s]
2022-04-20 23:08:55,503 reid_baseline.train INFO: normal accuracy 0.6844158824879504 3.7990705966949463 
2022-04-20 23:08:56,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 23:08:56,346 reid_baseline.train INFO: Val Accuracy: 68.4% Mean Entropy: 379.9%
2022-04-20 23:09:21,609 reid_baseline.train INFO: normal accuracy 0.722877358490566 3.7240025997161865 
2022-04-20 23:09:21,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-20 23:09:21,609 reid_baseline.train INFO: Train Accuracy: 72.3% Mean Entropy: 372.4%
2022-04-20 23:11:24,263 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.358, Acc: 0.776, Base Lr: 3.25e-03
2022-04-20 23:12:21,041 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.180[s] Speed: 13.6[samples/s]
2022-04-20 23:15:27,803 reid_baseline.train INFO: normal accuracy 0.7234335551985311 3.0378780364990234 
2022-04-20 23:15:28,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 23:15:28,754 reid_baseline.train INFO: Val Accuracy: 72.3% Mean Entropy: 303.8%
2022-04-20 23:15:50,879 reid_baseline.train INFO: normal accuracy 0.7634139150943396 2.9031424522399902 
2022-04-20 23:15:50,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-20 23:15:50,879 reid_baseline.train INFO: Train Accuracy: 76.3% Mean Entropy: 290.3%
2022-04-20 23:17:46,140 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 1.755, Acc: 0.836, Base Lr: 4.04e-03
2022-04-20 23:18:42,626 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.130[s] Speed: 14.2[samples/s]
2022-04-20 23:21:59,281 reid_baseline.train INFO: normal accuracy 0.7833371585953638 2.398068428039551 
2022-04-20 23:22:00,195 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 23:22:00,195 reid_baseline.train INFO: Val Accuracy: 78.3% Mean Entropy: 239.8%
2022-04-20 23:22:23,455 reid_baseline.train INFO: normal accuracy 0.8262087264150944 2.258263349533081 
2022-04-20 23:22:23,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-20 23:22:23,456 reid_baseline.train INFO: Train Accuracy: 82.6% Mean Entropy: 225.8%
2022-04-20 23:24:22,689 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.424, Acc: 0.886, Base Lr: 4.83e-03
2022-04-20 23:25:23,349 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.183[s] Speed: 13.5[samples/s]
2022-04-20 23:28:36,480 reid_baseline.train INFO: normal accuracy 0.8175350011475786 1.9914751052856445 
2022-04-20 23:28:37,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 23:28:37,453 reid_baseline.train INFO: Val Accuracy: 81.8% Mean Entropy: 199.1%
2022-04-20 23:28:58,856 reid_baseline.train INFO: normal accuracy 0.8614386792452831 1.8356375694274902 
2022-04-20 23:28:58,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-20 23:28:58,857 reid_baseline.train INFO: Train Accuracy: 86.1% Mean Entropy: 183.6%
2022-04-20 23:30:51,651 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.269, Acc: 0.915, Base Lr: 5.62e-03
2022-04-20 23:31:53,826 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.151[s] Speed: 13.9[samples/s]
2022-04-20 23:35:21,994 reid_baseline.train INFO: normal accuracy 0.8310764287353684 1.7111903429031372 
2022-04-20 23:35:23,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 23:35:23,380 reid_baseline.train INFO: Val Accuracy: 83.1% Mean Entropy: 171.1%
2022-04-20 23:35:46,811 reid_baseline.train INFO: normal accuracy 0.8763266509433962 1.5376747846603394 
2022-04-20 23:35:46,811 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-20 23:35:46,811 reid_baseline.train INFO: Train Accuracy: 87.6% Mean Entropy: 153.8%
2022-04-20 23:37:40,148 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.165, Acc: 0.941, Base Lr: 6.42e-03
2022-04-20 23:38:36,095 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.114[s] Speed: 14.4[samples/s]
2022-04-20 23:42:00,375 reid_baseline.train INFO: normal accuracy 0.8363552903373881 1.603287696838379 
2022-04-20 23:42:01,455 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 23:42:01,455 reid_baseline.train INFO: Val Accuracy: 83.6% Mean Entropy: 160.3%
2022-04-20 23:42:25,605 reid_baseline.train INFO: normal accuracy 0.8831073113207547 1.4074223041534424 
2022-04-20 23:42:25,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-20 23:42:25,606 reid_baseline.train INFO: Train Accuracy: 88.3% Mean Entropy: 140.7%
2022-04-20 23:44:22,528 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.119, Acc: 0.960, Base Lr: 7.21e-03
2022-04-20 23:45:21,342 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.156[s] Speed: 13.8[samples/s]
2022-04-20 23:48:36,775 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.4662227630615234 
2022-04-20 23:48:37,628 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 23:48:37,628 reid_baseline.train INFO: Val Accuracy: 83.8% Mean Entropy: 146.6%
2022-04-20 23:48:59,888 reid_baseline.train INFO: normal accuracy 0.8881191037735849 1.25680410861969 
2022-04-20 23:48:59,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-20 23:48:59,889 reid_baseline.train INFO: Train Accuracy: 88.8% Mean Entropy: 125.7%
2022-04-20 23:51:00,021 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.059, Acc: 0.964, Base Lr: 4.01e-03
2022-04-20 23:51:57,852 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-04-20 23:55:18,140 reid_baseline.train INFO: normal accuracy 0.8370438375028689 1.4905576705932617 
2022-04-20 23:55:18,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 23:55:18,143 reid_baseline.train INFO: Val Accuracy: 83.7% Mean Entropy: 149.1%
2022-04-20 23:55:39,885 reid_baseline.train INFO: normal accuracy 0.8900353773584906 1.2618622779846191 
2022-04-20 23:55:39,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-20 23:55:39,886 reid_baseline.train INFO: Train Accuracy: 89.0% Mean Entropy: 126.2%
2022-04-20 23:57:35,159 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.009, Acc: 0.983, Base Lr: 3.38e-03
2022-04-20 23:58:38,113 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.173[s] Speed: 13.6[samples/s]
2022-04-21 00:01:57,107 reid_baseline.train INFO: normal accuracy 0.8446178563231581 1.4230152368545532 
2022-04-21 00:01:58,290 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-21 00:01:58,291 reid_baseline.train INFO: Val Accuracy: 84.5% Mean Entropy: 142.3%
2022-04-21 00:02:20,734 reid_baseline.train INFO: normal accuracy 0.8963738207547169 1.1938802003860474 
2022-04-21 00:02:20,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-21 00:02:20,735 reid_baseline.train INFO: Train Accuracy: 89.6% Mean Entropy: 119.4%
2022-04-21 00:04:19,440 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.966, Acc: 0.984, Base Lr: 2.77e-03
2022-04-21 00:05:17,091 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.160[s] Speed: 13.8[samples/s]
2022-04-21 00:08:34,763 reid_baseline.train INFO: normal accuracy 0.8446178563231581 1.3856699466705322 
2022-04-21 00:08:35,708 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-21 00:08:35,709 reid_baseline.train INFO: Val Accuracy: 84.5% Mean Entropy: 138.6%
2022-04-21 00:08:59,277 reid_baseline.train INFO: normal accuracy 0.8968160377358491 1.149279236793518 
2022-04-21 00:08:59,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-21 00:08:59,278 reid_baseline.train INFO: Train Accuracy: 89.7% Mean Entropy: 114.9%
2022-04-21 00:11:01,254 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.961, Acc: 0.986, Base Lr: 2.20e-03
2022-04-21 00:12:00,441 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.192[s] Speed: 13.4[samples/s]
2022-04-21 00:15:26,443 reid_baseline.train INFO: normal accuracy 0.8459949506541198 1.4083536863327026 
2022-04-21 00:15:26,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-21 00:15:26,444 reid_baseline.train INFO: Val Accuracy: 84.6% Mean Entropy: 140.8%
2022-04-21 00:15:50,207 reid_baseline.train INFO: normal accuracy 0.8979952830188679 1.162013053894043 
2022-04-21 00:15:50,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-21 00:15:50,208 reid_baseline.train INFO: Train Accuracy: 89.8% Mean Entropy: 116.2%
2022-04-21 00:17:48,038 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.957, Acc: 0.986, Base Lr: 1.66e-03
2022-04-21 00:18:43,978 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.143[s] Speed: 14.0[samples/s]
2022-04-21 00:21:57,615 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.4317277669906616 
2022-04-21 00:21:57,616 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-21 00:21:57,616 reid_baseline.train INFO: Val Accuracy: 84.3% Mean Entropy: 143.2%
2022-04-21 00:22:20,205 reid_baseline.train INFO: normal accuracy 0.8966686320754716 1.1793819665908813 
2022-04-21 00:22:20,206 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-21 00:22:20,207 reid_baseline.train INFO: Train Accuracy: 89.7% Mean Entropy: 117.9%
2022-04-21 00:24:18,312 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.937, Acc: 0.989, Base Lr: 1.19e-03
2022-04-21 00:25:18,476 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.173[s] Speed: 13.6[samples/s]
