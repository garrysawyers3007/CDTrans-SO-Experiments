2022-05-08 17:12:09,435 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ClipartDRI_0.0
2022-05-08 17:12:09,435 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ClipartDRI_0.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.0)
2022-05-08 17:12:09,435 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-08 17:12:09,435 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 17:12:09,436 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Clipart.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ClipartDRI_0.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-08 17:12:26,080 reid_baseline.train INFO: start training
2022-05-08 17:14:22,074 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.540, Loss2: 4.146, Loss3: 4.174,  Acc: 0.317, Acc2: 0.178, Acc2_pse: 0.178, Base Lr: 8.72e-04
2022-05-08 17:15:15,916 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.156[s] Speed: 13.8[samples/s]
2022-05-08 17:18:36,895 reid_baseline.train INFO: normal accuracy 0.36036655211912944 4.172111511230469 
2022-05-08 17:18:38,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 17:18:38,256 reid_baseline.train INFO: Accuracy: 36.0%, best Accuracy: 36.0%, min Mean_entropy: 4e+00
2022-05-08 17:20:38,447 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.548, Loss2: 3.973, Loss3: 4.171,  Acc: 0.281, Acc2: 0.431, Acc2_pse: 0.431, Base Lr: 1.66e-03
2022-05-08 17:21:29,408 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.180[s] Speed: 13.6[samples/s]
2022-05-08 17:25:00,924 reid_baseline.train INFO: normal accuracy 0.38190148911798394 4.158466815948486 
2022-05-08 17:25:02,240 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 17:25:02,240 reid_baseline.train INFO: Accuracy: 38.2%, best Accuracy: 38.2%, min Mean_entropy: 4e+00
2022-05-08 17:26:58,508 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 1.549, Loss2: 3.668, Loss3: 4.146,  Acc: 0.275, Acc2: 0.468, Acc2_pse: 0.468, Base Lr: 2.46e-03
2022-05-08 17:27:48,621 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.147[s] Speed: 14.0[samples/s]
2022-05-08 17:31:10,878 reid_baseline.train INFO: normal accuracy 0.4252004581901489 4.051353454589844 
2022-05-08 17:31:12,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 17:31:12,336 reid_baseline.train INFO: Accuracy: 42.5%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 17:33:12,013 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 1.617, Loss2: 3.128, Loss3: 3.880,  Acc: 0.242, Acc2: 0.452, Acc2_pse: 0.452, Base Lr: 3.25e-03
2022-05-08 17:34:01,659 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.167[s] Speed: 13.7[samples/s]
2022-05-08 17:37:36,376 reid_baseline.train INFO: normal accuracy 0.36769759450171824 3.3470962047576904 
2022-05-08 17:37:36,376 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 17:37:36,376 reid_baseline.train INFO: Accuracy: 36.8%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 17:39:29,348 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 1.639, Loss2: 2.811, Loss3: 3.049,  Acc: 0.220, Acc2: 0.396, Acc2_pse: 0.396, Base Lr: 4.04e-03
2022-05-08 17:40:20,899 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.126[s] Speed: 14.2[samples/s]
2022-05-08 17:43:45,919 reid_baseline.train INFO: normal accuracy 0.3434135166093929 2.3356893062591553 
2022-05-08 17:43:45,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 17:43:45,920 reid_baseline.train INFO: Accuracy: 34.3%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 17:45:45,642 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 1.672, Loss2: 2.782, Loss3: 2.299,  Acc: 0.202, Acc2: 0.390, Acc2_pse: 0.390, Base Lr: 4.83e-03
2022-05-08 17:46:33,936 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.183[s] Speed: 13.5[samples/s]
2022-05-08 17:50:04,700 reid_baseline.train INFO: normal accuracy 0.3537227949599084 1.819179654121399 
2022-05-08 17:50:04,701 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 17:50:04,701 reid_baseline.train INFO: Accuracy: 35.4%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 17:51:58,299 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 1.660, Loss2: 2.616, Loss3: 1.883,  Acc: 0.206, Acc2: 0.441, Acc2_pse: 0.441, Base Lr: 5.62e-03
2022-05-08 17:52:46,792 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.133[s] Speed: 14.1[samples/s]
2022-05-08 17:56:10,014 reid_baseline.train INFO: normal accuracy 0.3951890034364261 1.6705824136734009 
2022-05-08 17:56:10,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 17:56:10,015 reid_baseline.train INFO: Accuracy: 39.5%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 17:58:08,991 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 1.679, Loss2: 2.433, Loss3: 1.598,  Acc: 0.193, Acc2: 0.492, Acc2_pse: 0.492, Base Lr: 6.42e-03
2022-05-08 17:59:00,246 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.182[s] Speed: 13.5[samples/s]
2022-05-08 18:02:24,288 reid_baseline.train INFO: normal accuracy 0.41878579610538375 1.5230164527893066 
2022-05-08 18:02:24,289 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 18:02:24,289 reid_baseline.train INFO: Accuracy: 41.9%, best Accuracy: 42.5%, min Mean_entropy: 4e+00
2022-05-08 18:04:22,166 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 1.687, Loss2: 2.315, Loss3: 1.403,  Acc: 0.194, Acc2: 0.500, Acc2_pse: 0.500, Base Lr: 7.21e-03
2022-05-08 18:05:15,221 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-05-08 18:08:41,850 reid_baseline.train INFO: normal accuracy 0.4435280641466208 1.3315420150756836 
2022-05-08 18:08:43,122 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 18:08:43,122 reid_baseline.train INFO: Accuracy: 44.4%, best Accuracy: 44.4%, min Mean_entropy: 1e+00
2022-05-08 18:10:43,550 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 1.703, Loss2: 2.225, Loss3: 1.213,  Acc: 0.167, Acc2: 0.548, Acc2_pse: 0.548, Base Lr: 6.83e-03
2022-05-08 18:11:33,543 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.192[s] Speed: 13.4[samples/s]
2022-05-08 18:15:05,534 reid_baseline.train INFO: normal accuracy 0.4343642611683849 1.1336047649383545 
2022-05-08 18:15:05,535 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 18:15:05,535 reid_baseline.train INFO: Accuracy: 43.4%, best Accuracy: 44.4%, min Mean_entropy: 1e+00
2022-05-08 18:16:57,387 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 1.674, Loss2: 2.145, Loss3: 1.139,  Acc: 0.191, Acc2: 0.556, Acc2_pse: 0.556, Base Lr: 6.60e-03
2022-05-08 18:17:49,352 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.130[s] Speed: 14.2[samples/s]
2022-05-08 18:21:11,973 reid_baseline.train INFO: normal accuracy 0.4439862542955326 1.1382989883422852 
2022-05-08 18:21:13,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 18:21:13,164 reid_baseline.train INFO: Accuracy: 44.4%, best Accuracy: 44.4%, min Mean_entropy: 1e+00
2022-05-08 18:23:09,809 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 1.699, Loss2: 2.057, Loss3: 1.048,  Acc: 0.189, Acc2: 0.576, Acc2_pse: 0.576, Base Lr: 6.35e-03
2022-05-08 18:24:07,372 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.210[s] Speed: 13.2[samples/s]
2022-05-08 18:27:29,340 reid_baseline.train INFO: normal accuracy 0.47880870561282934 1.0623369216918945 
2022-05-08 18:27:30,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 18:27:30,744 reid_baseline.train INFO: Accuracy: 47.9%, best Accuracy: 47.9%, min Mean_entropy: 1e+00
2022-05-08 18:29:28,576 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 1.665, Loss2: 1.943, Loss3: 1.000,  Acc: 0.204, Acc2: 0.603, Acc2_pse: 0.603, Base Lr: 6.09e-03
2022-05-08 18:30:20,360 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.178[s] Speed: 13.6[samples/s]
2022-05-08 18:33:47,901 reid_baseline.train INFO: normal accuracy 0.49988545246277205 1.0128889083862305 
2022-05-08 18:33:49,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 18:33:49,203 reid_baseline.train INFO: Accuracy: 50.0%, best Accuracy: 50.0%, min Mean_entropy: 1e+00
2022-05-08 18:35:49,651 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 1.698, Loss2: 1.838, Loss3: 0.971,  Acc: 0.188, Acc2: 0.646, Acc2_pse: 0.646, Base Lr: 5.82e-03
2022-05-08 18:36:45,429 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.223[s] Speed: 13.1[samples/s]
2022-05-08 18:40:12,230 reid_baseline.train INFO: normal accuracy 0.5063001145475372 0.9848034381866455 
2022-05-08 18:40:13,414 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 18:40:13,414 reid_baseline.train INFO: Accuracy: 50.6%, best Accuracy: 50.6%, min Mean_entropy: 1e+00
2022-05-08 18:42:13,341 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 1.679, Loss2: 1.834, Loss3: 0.947,  Acc: 0.211, Acc2: 0.646, Acc2_pse: 0.646, Base Lr: 5.54e-03
2022-05-08 18:43:06,899 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.213[s] Speed: 13.2[samples/s]
2022-05-08 18:46:22,359 reid_baseline.train INFO: normal accuracy 0.4936998854524628 0.8119258284568787 
2022-05-08 18:46:22,360 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 18:46:22,360 reid_baseline.train INFO: Accuracy: 49.4%, best Accuracy: 50.6%, min Mean_entropy: 1e+00
2022-05-08 18:48:22,244 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 1.666, Loss2: 1.778, Loss3: 0.922,  Acc: 0.200, Acc2: 0.652, Acc2_pse: 0.652, Base Lr: 5.24e-03
2022-05-08 18:49:14,400 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.195[s] Speed: 13.4[samples/s]
2022-05-08 18:52:41,155 reid_baseline.train INFO: normal accuracy 0.5360824742268041 0.9032514691352844 
2022-05-08 18:52:42,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 18:52:42,368 reid_baseline.train INFO: Accuracy: 53.6%, best Accuracy: 53.6%, min Mean_entropy: 0.9
2022-05-08 18:54:41,082 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 1.674, Loss2: 1.755, Loss3: 0.916,  Acc: 0.195, Acc2: 0.664, Acc2_pse: 0.664, Base Lr: 4.94e-03
2022-05-08 18:55:33,862 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.182[s] Speed: 13.5[samples/s]
2022-05-08 18:58:52,975 reid_baseline.train INFO: normal accuracy 0.5163802978235968 0.8015023469924927 
2022-05-08 18:58:52,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 18:58:52,975 reid_baseline.train INFO: Accuracy: 51.6%, best Accuracy: 53.6%, min Mean_entropy: 0.9
2022-05-08 19:00:57,173 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 1.669, Loss2: 1.660, Loss3: 0.890,  Acc: 0.198, Acc2: 0.690, Acc2_pse: 0.690, Base Lr: 4.63e-03
2022-05-08 19:01:49,418 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.208[s] Speed: 13.2[samples/s]
2022-05-08 19:05:07,905 reid_baseline.train INFO: normal accuracy 0.5489117983963345 0.8506247997283936 
2022-05-08 19:05:09,269 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 19:05:09,269 reid_baseline.train INFO: Accuracy: 54.9%, best Accuracy: 54.9%, min Mean_entropy: 0.9
2022-05-08 19:07:07,743 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 1.663, Loss2: 1.663, Loss3: 0.872,  Acc: 0.204, Acc2: 0.696, Acc2_pse: 0.696, Base Lr: 4.32e-03
2022-05-08 19:07:57,972 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.180[s] Speed: 13.6[samples/s]
2022-05-08 19:11:17,796 reid_baseline.train INFO: normal accuracy 0.5168384879725086 0.7709778547286987 
2022-05-08 19:11:17,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 19:11:17,797 reid_baseline.train INFO: Accuracy: 51.7%, best Accuracy: 54.9%, min Mean_entropy: 0.9
2022-05-08 19:13:20,100 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 1.663, Loss2: 1.602, Loss3: 0.818,  Acc: 0.194, Acc2: 0.712, Acc2_pse: 0.712, Base Lr: 4.01e-03
2022-05-08 19:14:09,894 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.203[s] Speed: 13.3[samples/s]
2022-05-08 19:17:24,745 reid_baseline.train INFO: normal accuracy 0.552348224513173 0.8141911625862122 
2022-05-08 19:17:26,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 19:17:26,039 reid_baseline.train INFO: Accuracy: 55.2%, best Accuracy: 55.2%, min Mean_entropy: 0.8
2022-05-08 19:19:23,951 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 1.660, Loss2: 1.613, Loss3: 0.844,  Acc: 0.193, Acc2: 0.715, Acc2_pse: 0.715, Base Lr: 3.69e-03
2022-05-08 19:20:13,829 reid_baseline.train INFO: Epoch 21 done. Time per batch: 1.148[s] Speed: 13.9[samples/s]
2022-05-08 19:23:34,658 reid_baseline.train INFO: normal accuracy 0.547766323024055 0.779290497303009 
2022-05-08 19:23:34,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-08 19:23:34,658 reid_baseline.train INFO: Accuracy: 54.8%, best Accuracy: 55.2%, min Mean_entropy: 0.8
2022-05-08 19:25:39,314 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 1.679, Loss2: 1.543, Loss3: 0.820,  Acc: 0.180, Acc2: 0.727, Acc2_pse: 0.727, Base Lr: 3.38e-03
2022-05-08 19:26:28,322 reid_baseline.train INFO: Epoch 22 done. Time per batch: 1.206[s] Speed: 13.3[samples/s]
2022-05-08 19:29:51,549 reid_baseline.train INFO: normal accuracy 0.552348224513173 0.7359288930892944 
2022-05-08 19:29:51,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-08 19:29:51,549 reid_baseline.train INFO: Accuracy: 55.2%, best Accuracy: 55.2%, min Mean_entropy: 0.8
2022-05-08 19:31:48,155 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 1.682, Loss2: 1.513, Loss3: 0.780,  Acc: 0.178, Acc2: 0.750, Acc2_pse: 0.750, Base Lr: 3.08e-03
2022-05-08 19:32:37,308 reid_baseline.train INFO: Epoch 23 done. Time per batch: 1.151[s] Speed: 13.9[samples/s]
2022-05-08 19:36:00,748 reid_baseline.train INFO: normal accuracy 0.565864833906071 0.7216153740882874 
2022-05-08 19:36:02,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-08 19:36:02,164 reid_baseline.train INFO: Accuracy: 56.6%, best Accuracy: 56.6%, min Mean_entropy: 0.7
2022-05-08 19:38:00,919 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 1.682, Loss2: 1.505, Loss3: 0.795,  Acc: 0.199, Acc2: 0.750, Acc2_pse: 0.750, Base Lr: 2.77e-03
2022-05-08 19:38:48,596 reid_baseline.train INFO: Epoch 24 done. Time per batch: 1.164[s] Speed: 13.7[samples/s]
2022-05-08 19:42:14,447 reid_baseline.train INFO: normal accuracy 0.540893470790378 0.7174301147460938 
2022-05-08 19:42:14,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-08 19:42:14,447 reid_baseline.train INFO: Accuracy: 54.1%, best Accuracy: 56.6%, min Mean_entropy: 0.7
2022-05-08 19:44:09,238 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 1.695, Loss2: 1.491, Loss3: 0.818,  Acc: 0.166, Acc2: 0.761, Acc2_pse: 0.761, Base Lr: 2.48e-03
2022-05-08 19:45:01,192 reid_baseline.train INFO: Epoch 25 done. Time per batch: 1.150[s] Speed: 13.9[samples/s]
2022-05-08 19:48:27,354 reid_baseline.train INFO: normal accuracy 0.547766323024055 0.6862949132919312 
2022-05-08 19:48:27,359 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-08 19:48:27,359 reid_baseline.train INFO: Accuracy: 54.8%, best Accuracy: 56.6%, min Mean_entropy: 0.7
2022-05-08 19:50:26,172 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 1.687, Loss2: 1.445, Loss3: 0.782,  Acc: 0.185, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 2.20e-03
2022-05-08 19:51:15,057 reid_baseline.train INFO: Epoch 26 done. Time per batch: 1.164[s] Speed: 13.7[samples/s]
2022-05-08 19:54:34,946 reid_baseline.train INFO: normal accuracy 0.5729667812142039 0.734450101852417 
2022-05-08 19:54:36,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-08 19:54:36,296 reid_baseline.train INFO: Accuracy: 57.3%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 19:56:31,187 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 1.692, Loss2: 1.449, Loss3: 0.742,  Acc: 0.188, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 1.92e-03
2022-05-08 19:57:21,014 reid_baseline.train INFO: Epoch 27 done. Time per batch: 1.142[s] Speed: 14.0[samples/s]
2022-05-08 20:00:46,485 reid_baseline.train INFO: normal accuracy 0.5557846506300115 0.7542431354522705 
2022-05-08 20:00:46,486 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-08 20:00:46,489 reid_baseline.train INFO: Accuracy: 55.6%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:02:45,934 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 1.683, Loss2: 1.408, Loss3: 0.766,  Acc: 0.174, Acc2: 0.775, Acc2_pse: 0.775, Base Lr: 1.66e-03
2022-05-08 20:03:34,164 reid_baseline.train INFO: Epoch 28 done. Time per batch: 1.172[s] Speed: 13.6[samples/s]
2022-05-08 20:07:04,060 reid_baseline.train INFO: normal accuracy 0.5495990836197022 0.6816574335098267 
2022-05-08 20:07:04,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-08 20:07:04,061 reid_baseline.train INFO: Accuracy: 55.0%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:09:08,156 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 1.692, Loss2: 1.429, Loss3: 0.686,  Acc: 0.177, Acc2: 0.771, Acc2_pse: 0.771, Base Lr: 1.42e-03
2022-05-08 20:10:00,425 reid_baseline.train INFO: Epoch 29 done. Time per batch: 1.233[s] Speed: 13.0[samples/s]
2022-05-08 20:13:21,286 reid_baseline.train INFO: normal accuracy 0.5601374570446735 0.6865575313568115 
2022-05-08 20:13:21,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-08 20:13:21,286 reid_baseline.train INFO: Accuracy: 56.0%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:15:20,428 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 1.688, Loss2: 1.425, Loss3: 0.719,  Acc: 0.183, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 1.19e-03
2022-05-08 20:16:11,154 reid_baseline.train INFO: Epoch 30 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-05-08 20:19:34,340 reid_baseline.train INFO: normal accuracy 0.5576174112256587 0.7406623959541321 
2022-05-08 20:19:34,340 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-08 20:19:34,340 reid_baseline.train INFO: Accuracy: 55.8%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:21:30,085 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 1.692, Loss2: 1.403, Loss3: 0.745,  Acc: 0.181, Acc2: 0.784, Acc2_pse: 0.784, Base Lr: 9.72e-04
2022-05-08 20:22:25,231 reid_baseline.train INFO: Epoch 31 done. Time per batch: 1.179[s] Speed: 13.6[samples/s]
2022-05-08 20:26:03,933 reid_baseline.train INFO: normal accuracy 0.5491408934707904 0.651580274105072 
2022-05-08 20:26:03,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-08 20:26:03,934 reid_baseline.train INFO: Accuracy: 54.9%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:28:02,260 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 1.646, Loss2: 1.416, Loss3: 0.709,  Acc: 0.203, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 7.78e-04
2022-05-08 20:28:49,717 reid_baseline.train INFO: Epoch 32 done. Time per batch: 1.143[s] Speed: 14.0[samples/s]
2022-05-08 20:32:08,374 reid_baseline.train INFO: normal accuracy 0.5729667812142039 0.6915848255157471 
2022-05-08 20:32:08,374 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-08 20:32:08,374 reid_baseline.train INFO: Accuracy: 57.3%, best Accuracy: 57.3%, min Mean_entropy: 0.7
2022-05-08 20:34:04,367 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 1.673, Loss2: 1.423, Loss3: 0.739,  Acc: 0.194, Acc2: 0.775, Acc2_pse: 0.775, Base Lr: 6.04e-04
2022-05-08 20:34:54,042 reid_baseline.train INFO: Epoch 33 done. Time per batch: 1.158[s] Speed: 13.8[samples/s]
2022-05-08 20:38:24,897 reid_baseline.train INFO: normal accuracy 0.5798396334478809 0.722961962223053 
2022-05-08 20:38:26,181 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-08 20:38:26,182 reid_baseline.train INFO: Accuracy: 58.0%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 20:40:17,025 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 1.690, Loss2: 1.394, Loss3: 0.702,  Acc: 0.192, Acc2: 0.783, Acc2_pse: 0.783, Base Lr: 4.51e-04
2022-05-08 20:41:06,104 reid_baseline.train INFO: Epoch 34 done. Time per batch: 1.118[s] Speed: 14.3[samples/s]
2022-05-08 20:44:32,807 reid_baseline.train INFO: normal accuracy 0.5642611683848797 0.6948554515838623 
2022-05-08 20:44:32,808 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-08 20:44:32,808 reid_baseline.train INFO: Accuracy: 56.4%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 20:46:27,649 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 1.689, Loss2: 1.394, Loss3: 0.694,  Acc: 0.183, Acc2: 0.781, Acc2_pse: 0.781, Base Lr: 3.20e-04
2022-05-08 20:47:13,454 reid_baseline.train INFO: Epoch 35 done. Time per batch: 1.115[s] Speed: 14.3[samples/s]
2022-05-08 20:50:45,205 reid_baseline.train INFO: normal accuracy 0.5784650630011455 0.6958590149879456 
2022-05-08 20:50:45,205 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-08 20:50:45,205 reid_baseline.train INFO: Accuracy: 57.8%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 20:52:39,674 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 1.706, Loss2: 1.390, Loss3: 0.697,  Acc: 0.172, Acc2: 0.779, Acc2_pse: 0.779, Base Lr: 2.11e-04
2022-05-08 20:53:28,360 reid_baseline.train INFO: Epoch 36 done. Time per batch: 1.157[s] Speed: 13.8[samples/s]
2022-05-08 20:56:49,690 reid_baseline.train INFO: normal accuracy 0.5775486827033218 0.7055556774139404 
2022-05-08 20:56:49,691 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-08 20:56:49,691 reid_baseline.train INFO: Accuracy: 57.8%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 20:58:44,143 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 1.683, Loss2: 1.436, Loss3: 0.735,  Acc: 0.194, Acc2: 0.768, Acc2_pse: 0.768, Base Lr: 1.26e-04
2022-05-08 20:59:32,448 reid_baseline.train INFO: Epoch 37 done. Time per batch: 1.145[s] Speed: 14.0[samples/s]
2022-05-08 21:03:02,420 reid_baseline.train INFO: normal accuracy 0.5722794959908362 0.6476833820343018 
2022-05-08 21:03:02,420 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-08 21:03:02,420 reid_baseline.train INFO: Accuracy: 57.2%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 21:05:08,786 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 1.671, Loss2: 1.381, Loss3: 0.656,  Acc: 0.192, Acc2: 0.786, Acc2_pse: 0.786, Base Lr: 6.51e-05
2022-05-08 21:06:02,679 reid_baseline.train INFO: Epoch 38 done. Time per batch: 1.243[s] Speed: 12.9[samples/s]
2022-05-08 21:09:32,541 reid_baseline.train INFO: normal accuracy 0.5633447880870561 0.7003546357154846 
2022-05-08 21:09:32,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-08 21:09:32,541 reid_baseline.train INFO: Accuracy: 56.3%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 21:11:30,043 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 1.665, Loss2: 1.401, Loss3: 0.706,  Acc: 0.203, Acc2: 0.779, Acc2_pse: 0.779, Base Lr: 2.83e-05
2022-05-08 21:12:16,263 reid_baseline.train INFO: Epoch 39 done. Time per batch: 1.128[s] Speed: 14.2[samples/s]
2022-05-08 21:15:38,806 reid_baseline.train INFO: normal accuracy 0.5553264604810997 0.667147159576416 
2022-05-08 21:15:38,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-08 21:15:38,807 reid_baseline.train INFO: Accuracy: 55.5%, best Accuracy: 58.0%, min Mean_entropy: 0.7
2022-05-08 21:17:32,949 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 1.660, Loss2: 1.369, Loss3: 0.719,  Acc: 0.206, Acc2: 0.790, Acc2_pse: 0.790, Base Lr: 1.60e-05
2022-05-08 21:18:23,886 reid_baseline.train INFO: Epoch 40 done. Time per batch: 1.138[s] Speed: 14.1[samples/s]
2022-05-08 21:21:40,765 reid_baseline.train INFO: normal accuracy 0.5583046964490264 0.6403154730796814 
2022-05-08 21:21:40,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-08 21:21:40,765 reid_baseline.train INFO: Accuracy: 55.8%, best Accuracy: 58.0%, min Mean_entropy: 0.7
best model preformance is 0.5798396334478809
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ClipartDRI_0.0/transformer_best_model.pth
2022-05-08 21:25:13,511 reid_baseline.train INFO: normal accuracy 0.5798396334478809 0.722961962223053 
2022-05-08 21:25:13,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-08 21:25:13,512 reid_baseline.train INFO: Accuracy: 58.0%
2022-05-08 21:28:08,471 reid_baseline.train INFO: normal accuracy 0.9348990523279769 0.18183289468288422 
2022-05-08 21:28:08,472 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-08 21:28:08,472 reid_baseline.train INFO: Accuracy: 93.5%
2022-05-08 21:28:16,803 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ProductDRI_0.0
2022-05-08 21:28:16,803 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ProductDRI_0.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.0)
2022-05-08 21:28:16,803 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-08 21:28:16,803 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 21:28:16,804 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Product.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ProductDRI_0.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Product and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-08 21:28:32,131 reid_baseline.train INFO: start training
2022-05-08 21:30:27,897 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.540, Loss2: 4.146, Loss3: 4.174,  Acc: 0.317, Acc2: 0.178, Acc2_pse: 0.178, Base Lr: 8.72e-04
2022-05-08 21:31:20,466 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.146[s] Speed: 14.0[samples/s]
2022-05-08 21:34:42,591 reid_baseline.train INFO: normal accuracy 0.45122775399864834 4.17233419418335 
2022-05-08 21:34:43,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 21:34:43,874 reid_baseline.train INFO: Accuracy: 45.1%, best Accuracy: 45.1%, min Mean_entropy: 4e+00
2022-05-08 21:36:48,367 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.548, Loss2: 3.973, Loss3: 4.171,  Acc: 0.281, Acc2: 0.431, Acc2_pse: 0.431, Base Lr: 1.66e-03
2022-05-08 21:37:38,795 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.206[s] Speed: 13.3[samples/s]
2022-05-08 21:41:06,778 reid_baseline.train INFO: normal accuracy 0.5041676053165127 4.159918785095215 
2022-05-08 21:41:07,970 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 21:41:07,970 reid_baseline.train INFO: Accuracy: 50.4%, best Accuracy: 50.4%, min Mean_entropy: 4e+00
2022-05-08 21:43:04,974 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 1.549, Loss2: 3.668, Loss3: 4.146,  Acc: 0.275, Acc2: 0.468, Acc2_pse: 0.468, Base Lr: 2.46e-03
2022-05-08 21:43:51,676 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.129[s] Speed: 14.2[samples/s]
2022-05-08 21:47:15,908 reid_baseline.train INFO: normal accuracy 0.5314259968461366 4.0260467529296875 
2022-05-08 21:47:17,156 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 21:47:17,157 reid_baseline.train INFO: Accuracy: 53.1%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 21:49:18,433 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 1.617, Loss2: 3.128, Loss3: 3.880,  Acc: 0.242, Acc2: 0.452, Acc2_pse: 0.452, Base Lr: 3.25e-03
2022-05-08 21:50:09,458 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.188[s] Speed: 13.5[samples/s]
2022-05-08 21:53:39,448 reid_baseline.train INFO: normal accuracy 0.46136517233611174 3.3689897060394287 
2022-05-08 21:53:39,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 21:53:39,453 reid_baseline.train INFO: Accuracy: 46.1%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 21:55:30,075 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 1.639, Loss2: 2.811, Loss3: 3.049,  Acc: 0.220, Acc2: 0.396, Acc2_pse: 0.396, Base Lr: 4.04e-03
2022-05-08 21:56:19,718 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.098[s] Speed: 14.6[samples/s]
2022-05-08 21:59:38,164 reid_baseline.train INFO: normal accuracy 0.39445821130885333 2.381114959716797 
2022-05-08 21:59:38,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 21:59:38,165 reid_baseline.train INFO: Accuracy: 39.4%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:01:32,958 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 1.672, Loss2: 2.781, Loss3: 2.300,  Acc: 0.202, Acc2: 0.391, Acc2_pse: 0.391, Base Lr: 4.83e-03
2022-05-08 22:02:21,752 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.152[s] Speed: 13.9[samples/s]
2022-05-08 22:05:58,094 reid_baseline.train INFO: normal accuracy 0.41045280468574 1.8695634603500366 
2022-05-08 22:05:58,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 22:05:58,095 reid_baseline.train INFO: Accuracy: 41.0%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:07:50,091 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 1.660, Loss2: 2.617, Loss3: 1.882,  Acc: 0.209, Acc2: 0.439, Acc2_pse: 0.439, Base Lr: 5.62e-03
2022-05-08 22:08:36,756 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.109[s] Speed: 14.4[samples/s]
2022-05-08 22:12:03,405 reid_baseline.train INFO: normal accuracy 0.47150259067357514 1.6040421724319458 
2022-05-08 22:12:03,405 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 22:12:03,405 reid_baseline.train INFO: Accuracy: 47.2%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:13:59,766 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 1.679, Loss2: 2.434, Loss3: 1.599,  Acc: 0.196, Acc2: 0.491, Acc2_pse: 0.491, Base Lr: 6.42e-03
2022-05-08 22:14:52,028 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-05-08 22:18:25,832 reid_baseline.train INFO: normal accuracy 0.5120522640234287 1.489710807800293 
2022-05-08 22:18:25,837 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 22:18:25,838 reid_baseline.train INFO: Accuracy: 51.2%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:20:20,158 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 1.687, Loss2: 2.320, Loss3: 1.404,  Acc: 0.193, Acc2: 0.505, Acc2_pse: 0.505, Base Lr: 7.21e-03
2022-05-08 22:21:12,308 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.140[s] Speed: 14.0[samples/s]
2022-05-08 22:24:41,559 reid_baseline.train INFO: normal accuracy 0.5043928812795675 1.2053136825561523 
2022-05-08 22:24:41,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 22:24:41,560 reid_baseline.train INFO: Accuracy: 50.4%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:26:38,748 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 1.707, Loss2: 2.233, Loss3: 1.210,  Acc: 0.160, Acc2: 0.550, Acc2_pse: 0.550, Base Lr: 6.83e-03
2022-05-08 22:27:27,320 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.159[s] Speed: 13.8[samples/s]
2022-05-08 22:30:56,110 reid_baseline.train INFO: normal accuracy 0.5242171660283848 1.0291142463684082 
2022-05-08 22:30:56,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 22:30:56,111 reid_baseline.train INFO: Accuracy: 52.4%, best Accuracy: 53.1%, min Mean_entropy: 4e+00
2022-05-08 22:32:46,650 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 1.673, Loss2: 2.147, Loss3: 1.146,  Acc: 0.183, Acc2: 0.557, Acc2_pse: 0.557, Base Lr: 6.60e-03
2022-05-08 22:33:35,071 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.096[s] Speed: 14.6[samples/s]
2022-05-08 22:36:53,081 reid_baseline.train INFO: normal accuracy 0.5469700382969137 1.0581233501434326 
2022-05-08 22:36:54,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 22:36:54,321 reid_baseline.train INFO: Accuracy: 54.7%, best Accuracy: 54.7%, min Mean_entropy: 1e+00
2022-05-08 22:38:49,059 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 1.696, Loss2: 2.063, Loss3: 1.043,  Acc: 0.189, Acc2: 0.573, Acc2_pse: 0.573, Base Lr: 6.35e-03
2022-05-08 22:39:41,835 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.163[s] Speed: 13.8[samples/s]
2022-05-08 22:43:07,337 reid_baseline.train INFO: normal accuracy 0.575580085604866 0.9801549911499023 
2022-05-08 22:43:08,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 22:43:08,659 reid_baseline.train INFO: Accuracy: 57.6%, best Accuracy: 57.6%, min Mean_entropy: 1e+00
2022-05-08 22:45:03,870 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 1.666, Loss2: 1.942, Loss3: 1.020,  Acc: 0.199, Acc2: 0.609, Acc2_pse: 0.609, Base Lr: 6.09e-03
2022-05-08 22:45:54,003 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.148[s] Speed: 13.9[samples/s]
2022-05-08 22:49:15,002 reid_baseline.train INFO: normal accuracy 0.5908988510925884 0.9003664255142212 
2022-05-08 22:49:16,075 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 22:49:16,076 reid_baseline.train INFO: Accuracy: 59.1%, best Accuracy: 59.1%, min Mean_entropy: 0.9
2022-05-08 22:51:03,847 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 1.694, Loss2: 1.845, Loss3: 0.974,  Acc: 0.191, Acc2: 0.639, Acc2_pse: 0.639, Base Lr: 5.82e-03
2022-05-08 22:51:50,669 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.073[s] Speed: 14.9[samples/s]
2022-05-08 22:55:27,042 reid_baseline.train INFO: normal accuracy 0.6107231358414057 0.8840363621711731 
2022-05-08 22:55:28,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 22:55:28,135 reid_baseline.train INFO: Accuracy: 61.1%, best Accuracy: 61.1%, min Mean_entropy: 0.9
2022-05-08 22:57:05,573 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 1.674, Loss2: 1.843, Loss3: 0.959,  Acc: 0.206, Acc2: 0.638, Acc2_pse: 0.638, Base Lr: 5.54e-03
2022-05-08 22:57:48,367 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.981[s] Speed: 16.3[samples/s]
2022-05-08 23:00:39,980 reid_baseline.train INFO: normal accuracy 0.6001351655778329 0.7633205056190491 
2022-05-08 23:00:39,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 23:00:39,981 reid_baseline.train INFO: Accuracy: 60.0%, best Accuracy: 61.1%, min Mean_entropy: 0.9
2022-05-08 23:02:20,944 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 1.674, Loss2: 1.788, Loss3: 0.921,  Acc: 0.204, Acc2: 0.657, Acc2_pse: 0.657, Base Lr: 5.24e-03
2022-05-08 23:02:59,170 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.966[s] Speed: 16.6[samples/s]
2022-05-08 23:05:58,271 reid_baseline.train INFO: normal accuracy 0.643613426447398 0.7792961001396179 
2022-05-08 23:05:59,393 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 23:05:59,394 reid_baseline.train INFO: Accuracy: 64.4%, best Accuracy: 64.4%, min Mean_entropy: 0.8
2022-05-08 23:07:39,624 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 1.673, Loss2: 1.772, Loss3: 0.912,  Acc: 0.205, Acc2: 0.670, Acc2_pse: 0.670, Base Lr: 4.94e-03
2022-05-08 23:08:26,896 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.017[s] Speed: 15.7[samples/s]
2022-05-08 23:11:22,734 reid_baseline.train INFO: normal accuracy 0.6264924532552376 0.7229137420654297 
2022-05-08 23:11:22,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 23:11:22,734 reid_baseline.train INFO: Accuracy: 62.6%, best Accuracy: 64.4%, min Mean_entropy: 0.8
2022-05-08 23:13:03,350 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 1.665, Loss2: 1.662, Loss3: 0.895,  Acc: 0.194, Acc2: 0.691, Acc2_pse: 0.691, Base Lr: 4.63e-03
2022-05-08 23:13:46,923 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.988[s] Speed: 16.2[samples/s]
2022-05-08 23:16:53,993 reid_baseline.train INFO: normal accuracy 0.6469925658932192 0.7162097096443176 
2022-05-08 23:16:54,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 23:16:54,981 reid_baseline.train INFO: Accuracy: 64.7%, best Accuracy: 64.7%, min Mean_entropy: 0.7
2022-05-08 23:18:35,822 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 1.673, Loss2: 1.672, Loss3: 0.872,  Acc: 0.192, Acc2: 0.689, Acc2_pse: 0.689, Base Lr: 4.32e-03
2022-05-08 23:19:16,043 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.985[s] Speed: 16.2[samples/s]
2022-05-08 23:22:24,077 reid_baseline.train INFO: normal accuracy 0.6431628745212886 0.6985070705413818 
2022-05-08 23:22:24,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 23:22:24,078 reid_baseline.train INFO: Accuracy: 64.3%, best Accuracy: 64.7%, min Mean_entropy: 0.7
2022-05-08 23:24:04,934 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 1.673, Loss2: 1.610, Loss3: 0.813,  Acc: 0.186, Acc2: 0.707, Acc2_pse: 0.707, Base Lr: 4.01e-03
2022-05-08 23:24:48,538 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.010[s] Speed: 15.8[samples/s]
2022-05-08 23:27:51,889 reid_baseline.train INFO: normal accuracy 0.6578058121198468 0.6924790740013123 
2022-05-08 23:27:52,864 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 23:27:52,864 reid_baseline.train INFO: Accuracy: 65.8%, best Accuracy: 65.8%, min Mean_entropy: 0.7
2022-05-08 23:29:36,876 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 1.671, Loss2: 1.618, Loss3: 0.845,  Acc: 0.187, Acc2: 0.714, Acc2_pse: 0.714, Base Lr: 3.69e-03
2022-05-08 23:30:18,172 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.995[s] Speed: 16.1[samples/s]
2022-05-08 23:33:10,381 reid_baseline.train INFO: normal accuracy 0.6632124352331606 0.6687614321708679 
2022-05-08 23:33:11,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-08 23:33:11,399 reid_baseline.train INFO: Accuracy: 66.3%, best Accuracy: 66.3%, min Mean_entropy: 0.7
2022-05-08 23:34:51,518 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 1.689, Loss2: 1.561, Loss3: 0.822,  Acc: 0.172, Acc2: 0.717, Acc2_pse: 0.717, Base Lr: 3.38e-03
2022-05-08 23:35:34,710 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.994[s] Speed: 16.1[samples/s]
2022-05-08 23:38:31,172 reid_baseline.train INFO: normal accuracy 0.6555530524892994 0.6316820383071899 
2022-05-08 23:38:31,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-08 23:38:31,172 reid_baseline.train INFO: Accuracy: 65.6%, best Accuracy: 66.3%, min Mean_entropy: 0.7
2022-05-08 23:40:13,570 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 1.692, Loss2: 1.524, Loss3: 0.779,  Acc: 0.183, Acc2: 0.748, Acc2_pse: 0.748, Base Lr: 3.08e-03
2022-05-08 23:40:53,735 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.990[s] Speed: 16.2[samples/s]
2022-05-08 23:43:56,817 reid_baseline.train INFO: normal accuracy 0.6661410227528722 0.6233911514282227 
2022-05-08 23:43:57,687 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-08 23:43:57,687 reid_baseline.train INFO: Accuracy: 66.6%, best Accuracy: 66.6%, min Mean_entropy: 0.6
2022-05-08 23:45:32,228 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 1.689, Loss2: 1.510, Loss3: 0.803,  Acc: 0.193, Acc2: 0.750, Acc2_pse: 0.750, Base Lr: 2.77e-03
2022-05-08 23:46:12,931 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.945[s] Speed: 16.9[samples/s]
2022-05-08 23:49:15,974 reid_baseline.train INFO: normal accuracy 0.6573552601937374 0.616509735584259 
2022-05-08 23:49:15,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-08 23:49:15,975 reid_baseline.train INFO: Accuracy: 65.7%, best Accuracy: 66.6%, min Mean_entropy: 0.6
2022-05-08 23:50:38,406 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 1.702, Loss2: 1.501, Loss3: 0.828,  Acc: 0.166, Acc2: 0.758, Acc2_pse: 0.758, Base Lr: 2.48e-03
2022-05-08 23:51:11,714 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.797[s] Speed: 20.1[samples/s]
2022-05-08 23:53:36,441 reid_baseline.train INFO: normal accuracy 0.6587069159720658 0.5972758531570435 
2022-05-08 23:53:36,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-08 23:53:36,442 reid_baseline.train INFO: Accuracy: 65.9%, best Accuracy: 66.6%, min Mean_entropy: 0.6
2022-05-08 23:54:57,300 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 1.696, Loss2: 1.452, Loss3: 0.779,  Acc: 0.191, Acc2: 0.751, Acc2_pse: 0.751, Base Lr: 2.20e-03
2022-05-08 23:55:28,300 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.777[s] Speed: 20.6[samples/s]
2022-05-08 23:57:50,062 reid_baseline.train INFO: normal accuracy 0.6771795449425546 0.6199227571487427 
2022-05-08 23:57:50,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-08 23:57:50,909 reid_baseline.train INFO: Accuracy: 67.7%, best Accuracy: 67.7%, min Mean_entropy: 0.6
2022-05-08 23:59:10,265 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 1.694, Loss2: 1.459, Loss3: 0.753,  Acc: 0.188, Acc2: 0.759, Acc2_pse: 0.759, Base Lr: 1.92e-03
2022-05-08 23:59:42,819 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.777[s] Speed: 20.6[samples/s]
2022-05-09 00:02:07,411 reid_baseline.train INFO: normal accuracy 0.6841630997972517 0.6509115695953369 
2022-05-09 00:02:08,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 00:02:08,232 reid_baseline.train INFO: Accuracy: 68.4%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:03:29,251 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 1.684, Loss2: 1.416, Loss3: 0.770,  Acc: 0.180, Acc2: 0.772, Acc2_pse: 0.772, Base Lr: 1.66e-03
2022-05-09 00:04:00,914 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.788[s] Speed: 20.3[samples/s]
2022-05-09 00:06:25,438 reid_baseline.train INFO: normal accuracy 0.6616355034917775 0.5727720260620117 
2022-05-09 00:06:25,438 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 00:06:25,439 reid_baseline.train INFO: Accuracy: 66.2%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:07:46,637 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 1.694, Loss2: 1.447, Loss3: 0.683,  Acc: 0.172, Acc2: 0.767, Acc2_pse: 0.767, Base Lr: 1.42e-03
2022-05-09 00:08:20,213 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.803[s] Speed: 19.9[samples/s]
2022-05-09 00:10:42,318 reid_baseline.train INFO: normal accuracy 0.6726740256814598 0.5862014293670654 
2022-05-09 00:10:42,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 00:10:42,319 reid_baseline.train INFO: Accuracy: 67.3%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:12:02,538 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 1.688, Loss2: 1.432, Loss3: 0.733,  Acc: 0.189, Acc2: 0.764, Acc2_pse: 0.764, Base Lr: 1.19e-03
2022-05-09 00:12:37,676 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.796[s] Speed: 20.1[samples/s]
2022-05-09 00:14:49,586 reid_baseline.train INFO: normal accuracy 0.6701959900878576 0.6334342956542969 
2022-05-09 00:14:49,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 00:14:49,586 reid_baseline.train INFO: Accuracy: 67.0%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:15:59,597 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 1.697, Loss2: 1.418, Loss3: 0.736,  Acc: 0.176, Acc2: 0.773, Acc2_pse: 0.773, Base Lr: 9.72e-04
2022-05-09 00:16:33,054 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.713[s] Speed: 22.4[samples/s]
2022-05-09 00:18:42,047 reid_baseline.train INFO: normal accuracy 0.6659157467898176 0.5624708533287048 
2022-05-09 00:18:42,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 00:18:42,047 reid_baseline.train INFO: Accuracy: 66.6%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:19:52,153 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 1.649, Loss2: 1.423, Loss3: 0.714,  Acc: 0.205, Acc2: 0.759, Acc2_pse: 0.759, Base Lr: 7.78e-04
2022-05-09 00:20:21,127 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 00:22:30,699 reid_baseline.train INFO: normal accuracy 0.6778553728317188 0.5701617002487183 
2022-05-09 00:22:30,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 00:22:30,699 reid_baseline.train INFO: Accuracy: 67.8%, best Accuracy: 68.4%, min Mean_entropy: 0.7
2022-05-09 00:23:41,048 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 1.676, Loss2: 1.433, Loss3: 0.741,  Acc: 0.180, Acc2: 0.769, Acc2_pse: 0.769, Base Lr: 6.04e-04
2022-05-09 00:24:10,668 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.697[s] Speed: 23.0[samples/s]
2022-05-09 00:26:14,229 reid_baseline.train INFO: normal accuracy 0.6888938950214012 0.6058917045593262 
2022-05-09 00:26:15,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 00:26:15,006 reid_baseline.train INFO: Accuracy: 68.9%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:27:22,304 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 1.695, Loss2: 1.398, Loss3: 0.709,  Acc: 0.181, Acc2: 0.782, Acc2_pse: 0.782, Base Lr: 4.51e-04
2022-05-09 00:27:52,054 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 00:29:59,291 reid_baseline.train INFO: normal accuracy 0.6807839603514305 0.5879934430122375 
2022-05-09 00:29:59,291 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 00:29:59,291 reid_baseline.train INFO: Accuracy: 68.1%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:31:08,830 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 1.697, Loss2: 1.400, Loss3: 0.693,  Acc: 0.180, Acc2: 0.776, Acc2_pse: 0.776, Base Lr: 3.20e-04
2022-05-09 00:31:36,981 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.678[s] Speed: 23.6[samples/s]
2022-05-09 00:33:41,913 reid_baseline.train INFO: normal accuracy 0.680333408425321 0.5823462605476379 
2022-05-09 00:33:41,913 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 00:33:41,913 reid_baseline.train INFO: Accuracy: 68.0%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:34:48,215 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 1.709, Loss2: 1.398, Loss3: 0.698,  Acc: 0.167, Acc2: 0.779, Acc2_pse: 0.779, Base Lr: 2.11e-04
2022-05-09 00:35:16,337 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.670[s] Speed: 23.9[samples/s]
2022-05-09 00:37:22,609 reid_baseline.train INFO: normal accuracy 0.6816850642036495 0.599448025226593 
2022-05-09 00:37:22,610 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 00:37:22,610 reid_baseline.train INFO: Accuracy: 68.2%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:38:32,472 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 1.683, Loss2: 1.438, Loss3: 0.742,  Acc: 0.194, Acc2: 0.762, Acc2_pse: 0.762, Base Lr: 1.26e-04
2022-05-09 00:39:01,099 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 00:41:09,248 reid_baseline.train INFO: normal accuracy 0.6774048209056094 0.5477314591407776 
2022-05-09 00:41:09,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 00:41:09,248 reid_baseline.train INFO: Accuracy: 67.7%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:42:18,167 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 1.673, Loss2: 1.385, Loss3: 0.660,  Acc: 0.188, Acc2: 0.786, Acc2_pse: 0.786, Base Lr: 6.51e-05
2022-05-09 00:42:46,947 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.674[s] Speed: 23.7[samples/s]
2022-05-09 00:44:50,901 reid_baseline.train INFO: normal accuracy 0.6787564766839378 0.5900606513023376 
2022-05-09 00:44:50,901 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 00:44:50,901 reid_baseline.train INFO: Accuracy: 67.9%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:46:01,499 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 1.668, Loss2: 1.407, Loss3: 0.713,  Acc: 0.197, Acc2: 0.777, Acc2_pse: 0.777, Base Lr: 2.83e-05
2022-05-09 00:46:29,227 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 00:48:36,227 reid_baseline.train INFO: normal accuracy 0.6683937823834197 0.5611295104026794 
2022-05-09 00:48:36,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 00:48:36,228 reid_baseline.train INFO: Accuracy: 66.8%, best Accuracy: 68.9%, min Mean_entropy: 0.6
2022-05-09 00:49:44,213 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 1.661, Loss2: 1.381, Loss3: 0.716,  Acc: 0.200, Acc2: 0.780, Acc2_pse: 0.780, Base Lr: 1.60e-05
2022-05-09 00:50:13,982 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 00:52:19,926 reid_baseline.train INFO: normal accuracy 0.6724487497184051 0.5427610278129578 
2022-05-09 00:52:19,926 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 00:52:19,926 reid_baseline.train INFO: Accuracy: 67.2%, best Accuracy: 68.9%, min Mean_entropy: 0.6
best model preformance is 0.6888938950214012
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ProductDRI_0.0/transformer_best_model.pth
2022-05-09 00:54:21,879 reid_baseline.train INFO: normal accuracy 0.6888938950214012 0.6058917045593262 
2022-05-09 00:54:21,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 00:54:21,879 reid_baseline.train INFO: Accuracy: 68.9%
2022-05-09 00:56:06,312 reid_baseline.train INFO: normal accuracy 0.9357231149567367 0.18609289824962616 
2022-05-09 00:56:06,313 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 00:56:06,313 reid_baseline.train INFO: Accuracy: 93.6%
2022-05-09 00:56:11,396 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.0
2022-05-09 00:56:11,396 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.0)
2022-05-09 00:56:11,396 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 00:56:11,396 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 00:56:11,396 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Real_World.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Real_World and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4357 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 00:56:19,665 reid_baseline.train INFO: start training
2022-05-09 00:57:29,035 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.540, Loss2: 4.146, Loss3: 4.174,  Acc: 0.317, Acc2: 0.178, Acc2_pse: 0.178, Base Lr: 8.72e-04
2022-05-09 00:58:00,271 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 01:03:46,732 reid_baseline.train INFO: normal accuracy 0.5597888455359192 4.172191619873047 
2022-05-09 01:03:47,523 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 01:03:47,524 reid_baseline.train INFO: Accuracy: 56.0%, best Accuracy: 56.0%, min Mean_entropy: 4e+00
2022-05-09 01:04:57,256 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.548, Loss2: 3.973, Loss3: 4.171,  Acc: 0.281, Acc2: 0.431, Acc2_pse: 0.431, Base Lr: 1.66e-03
2022-05-09 01:05:27,330 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.688[s] Speed: 23.2[samples/s]
2022-05-09 01:11:20,399 reid_baseline.train INFO: normal accuracy 0.5992655496901538 4.15557861328125 
2022-05-09 01:11:21,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 01:11:21,277 reid_baseline.train INFO: Accuracy: 59.9%, best Accuracy: 59.9%, min Mean_entropy: 4e+00
2022-05-09 01:12:30,371 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 1.549, Loss2: 3.668, Loss3: 4.146,  Acc: 0.275, Acc2: 0.468, Acc2_pse: 0.468, Base Lr: 2.46e-03
2022-05-09 01:12:58,509 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.670[s] Speed: 23.9[samples/s]
2022-05-09 01:18:53,538 reid_baseline.train INFO: normal accuracy 0.614872618774386 3.973094940185547 
2022-05-09 01:18:54,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 01:18:54,356 reid_baseline.train INFO: Accuracy: 61.5%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:20:04,140 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 1.617, Loss2: 3.128, Loss3: 3.880,  Acc: 0.242, Acc2: 0.452, Acc2_pse: 0.452, Base Lr: 3.25e-03
2022-05-09 01:20:33,217 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.681[s] Speed: 23.5[samples/s]
2022-05-09 01:26:22,512 reid_baseline.train INFO: normal accuracy 0.5425751663988984 3.0744004249572754 
2022-05-09 01:26:22,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 01:26:22,513 reid_baseline.train INFO: Accuracy: 54.3%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:27:30,044 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 1.639, Loss2: 2.811, Loss3: 3.049,  Acc: 0.220, Acc2: 0.396, Acc2_pse: 0.396, Base Lr: 4.04e-03
2022-05-09 01:27:59,298 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.662[s] Speed: 24.2[samples/s]
2022-05-09 01:33:46,287 reid_baseline.train INFO: normal accuracy 0.489557034656874 2.049262523651123 
2022-05-09 01:33:46,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 01:33:46,287 reid_baseline.train INFO: Accuracy: 49.0%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:34:55,951 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 1.672, Loss2: 2.781, Loss3: 2.299,  Acc: 0.201, Acc2: 0.391, Acc2_pse: 0.391, Base Lr: 4.83e-03
2022-05-09 01:35:23,647 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-09 01:41:10,112 reid_baseline.train INFO: normal accuracy 0.5067707137938949 1.598360538482666 
2022-05-09 01:41:10,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 01:41:10,113 reid_baseline.train INFO: Accuracy: 50.7%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:42:17,402 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 1.660, Loss2: 2.617, Loss3: 1.883,  Acc: 0.209, Acc2: 0.440, Acc2_pse: 0.440, Base Lr: 5.62e-03
2022-05-09 01:42:45,629 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.668[s] Speed: 24.0[samples/s]
2022-05-09 01:48:38,014 reid_baseline.train INFO: normal accuracy 0.5620840027541887 1.3682267665863037 
2022-05-09 01:48:38,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 01:48:38,014 reid_baseline.train INFO: Accuracy: 56.2%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:49:47,112 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 1.678, Loss2: 2.433, Loss3: 1.599,  Acc: 0.197, Acc2: 0.491, Acc2_pse: 0.491, Base Lr: 6.42e-03
2022-05-09 01:50:17,822 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 01:56:16,870 reid_baseline.train INFO: normal accuracy 0.5962818453064035 1.2238932847976685 
2022-05-09 01:56:16,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 01:56:16,871 reid_baseline.train INFO: Accuracy: 59.6%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 01:57:26,643 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 1.686, Loss2: 2.320, Loss3: 1.405,  Acc: 0.200, Acc2: 0.503, Acc2_pse: 0.503, Base Lr: 7.21e-03
2022-05-09 01:57:58,572 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-05-09 02:03:48,208 reid_baseline.train INFO: normal accuracy 0.5978884553591921 0.9953463673591614 
2022-05-09 02:03:48,208 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 02:03:48,209 reid_baseline.train INFO: Accuracy: 59.8%, best Accuracy: 61.5%, min Mean_entropy: 4e+00
2022-05-09 02:04:58,574 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 1.705, Loss2: 2.231, Loss3: 1.210,  Acc: 0.159, Acc2: 0.551, Acc2_pse: 0.551, Base Lr: 6.83e-03
2022-05-09 02:05:27,568 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 02:11:32,443 reid_baseline.train INFO: normal accuracy 0.6187743860454441 0.8433171510696411 
2022-05-09 02:11:33,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 02:11:33,214 reid_baseline.train INFO: Accuracy: 61.9%, best Accuracy: 61.9%, min Mean_entropy: 0.8
2022-05-09 02:12:39,552 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 1.671, Loss2: 2.145, Loss3: 1.143,  Acc: 0.185, Acc2: 0.557, Acc2_pse: 0.557, Base Lr: 6.60e-03
2022-05-09 02:13:09,304 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-09 02:19:14,761 reid_baseline.train INFO: normal accuracy 0.6451686940555428 0.8453128933906555 
2022-05-09 02:19:15,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 02:19:15,544 reid_baseline.train INFO: Accuracy: 64.5%, best Accuracy: 64.5%, min Mean_entropy: 0.8
2022-05-09 02:20:24,040 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 1.700, Loss2: 2.068, Loss3: 1.042,  Acc: 0.189, Acc2: 0.578, Acc2_pse: 0.578, Base Lr: 6.35e-03
2022-05-09 02:20:55,553 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 02:26:42,294 reid_baseline.train INFO: normal accuracy 0.6731696121184301 0.7700084447860718 
2022-05-09 02:26:43,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 02:26:43,073 reid_baseline.train INFO: Accuracy: 67.3%, best Accuracy: 67.3%, min Mean_entropy: 0.8
2022-05-09 02:27:51,958 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 1.666, Loss2: 1.949, Loss3: 1.000,  Acc: 0.209, Acc2: 0.611, Acc2_pse: 0.611, Base Lr: 6.09e-03
2022-05-09 02:28:22,599 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.691[s] Speed: 23.2[samples/s]
2022-05-09 02:34:11,289 reid_baseline.train INFO: normal accuracy 0.6867110397062198 0.7170301675796509 
2022-05-09 02:34:12,067 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 02:34:12,067 reid_baseline.train INFO: Accuracy: 68.7%, best Accuracy: 68.7%, min Mean_entropy: 0.7
2022-05-09 02:35:21,891 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 1.688, Loss2: 1.846, Loss3: 0.981,  Acc: 0.197, Acc2: 0.637, Acc2_pse: 0.637, Base Lr: 5.82e-03
2022-05-09 02:35:50,799 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.685[s] Speed: 23.3[samples/s]
2022-05-09 02:41:49,205 reid_baseline.train INFO: normal accuracy 0.6887766812026623 0.695924699306488 
2022-05-09 02:41:50,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 02:41:50,018 reid_baseline.train INFO: Accuracy: 68.9%, best Accuracy: 68.9%, min Mean_entropy: 0.7
2022-05-09 02:42:57,086 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 1.670, Loss2: 1.832, Loss3: 0.962,  Acc: 0.202, Acc2: 0.649, Acc2_pse: 0.649, Base Lr: 5.54e-03
2022-05-09 02:43:26,254 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-09 02:49:16,589 reid_baseline.train INFO: normal accuracy 0.6793665366077576 0.579102098941803 
2022-05-09 02:49:16,589 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 02:49:16,589 reid_baseline.train INFO: Accuracy: 67.9%, best Accuracy: 68.9%, min Mean_entropy: 0.7
2022-05-09 02:50:25,437 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 1.669, Loss2: 1.787, Loss3: 0.925,  Acc: 0.204, Acc2: 0.653, Acc2_pse: 0.653, Base Lr: 5.24e-03
2022-05-09 02:50:52,712 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.666[s] Speed: 24.0[samples/s]
2022-05-09 02:56:39,603 reid_baseline.train INFO: normal accuracy 0.7234335551985311 0.6258906722068787 
2022-05-09 02:56:40,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 02:56:40,395 reid_baseline.train INFO: Accuracy: 72.3%, best Accuracy: 72.3%, min Mean_entropy: 0.6
2022-05-09 02:57:51,526 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 1.671, Loss2: 1.764, Loss3: 0.918,  Acc: 0.197, Acc2: 0.668, Acc2_pse: 0.668, Base Lr: 4.94e-03
2022-05-09 02:58:23,255 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.709[s] Speed: 22.6[samples/s]
2022-05-09 03:04:14,968 reid_baseline.train INFO: normal accuracy 0.7020885930686253 0.5664305686950684 
2022-05-09 03:04:14,968 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 03:04:14,969 reid_baseline.train INFO: Accuracy: 70.2%, best Accuracy: 72.3%, min Mean_entropy: 0.6
2022-05-09 03:05:26,347 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 1.665, Loss2: 1.660, Loss3: 0.880,  Acc: 0.208, Acc2: 0.693, Acc2_pse: 0.693, Base Lr: 4.63e-03
2022-05-09 03:05:56,161 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.691[s] Speed: 23.1[samples/s]
2022-05-09 03:11:39,171 reid_baseline.train INFO: normal accuracy 0.7415652972228598 0.565139651298523 
2022-05-09 03:11:39,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 03:11:39,934 reid_baseline.train INFO: Accuracy: 74.2%, best Accuracy: 74.2%, min Mean_entropy: 0.6
2022-05-09 03:12:50,350 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 1.663, Loss2: 1.674, Loss3: 0.867,  Acc: 0.202, Acc2: 0.695, Acc2_pse: 0.695, Base Lr: 4.32e-03
2022-05-09 03:13:19,158 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 03:19:07,815 reid_baseline.train INFO: normal accuracy 0.7211383979802617 0.5328971147537231 
2022-05-09 03:19:07,816 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 03:19:07,816 reid_baseline.train INFO: Accuracy: 72.1%, best Accuracy: 74.2%, min Mean_entropy: 0.6
2022-05-09 03:20:15,889 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 1.674, Loss2: 1.605, Loss3: 0.809,  Acc: 0.188, Acc2: 0.710, Acc2_pse: 0.710, Base Lr: 4.01e-03
2022-05-09 03:20:46,183 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 03:26:37,064 reid_baseline.train INFO: normal accuracy 0.7466146431030526 0.5319994688034058 
2022-05-09 03:26:37,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 03:26:37,906 reid_baseline.train INFO: Accuracy: 74.7%, best Accuracy: 74.7%, min Mean_entropy: 0.5
2022-05-09 03:27:47,269 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 1.670, Loss2: 1.617, Loss3: 0.843,  Acc: 0.188, Acc2: 0.711, Acc2_pse: 0.711, Base Lr: 3.69e-03
2022-05-09 03:28:16,737 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 03:34:12,102 reid_baseline.train INFO: normal accuracy 0.7431719072756484 0.507804811000824 
2022-05-09 03:34:12,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 03:34:12,102 reid_baseline.train INFO: Accuracy: 74.3%, best Accuracy: 74.7%, min Mean_entropy: 0.5
2022-05-09 03:35:21,873 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 1.684, Loss2: 1.566, Loss3: 0.814,  Acc: 0.181, Acc2: 0.721, Acc2_pse: 0.721, Base Lr: 3.38e-03
2022-05-09 03:35:51,138 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-09 03:41:42,774 reid_baseline.train INFO: normal accuracy 0.7424833601101676 0.49221137166023254 
2022-05-09 03:41:42,774 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 03:41:42,774 reid_baseline.train INFO: Accuracy: 74.2%, best Accuracy: 74.7%, min Mean_entropy: 0.5
2022-05-09 03:42:52,142 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 1.692, Loss2: 1.517, Loss3: 0.779,  Acc: 0.184, Acc2: 0.751, Acc2_pse: 0.751, Base Lr: 3.08e-03
2022-05-09 03:43:20,174 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-09 03:49:04,975 reid_baseline.train INFO: normal accuracy 0.7523525361487262 0.47843223810195923 
2022-05-09 03:49:05,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 03:49:05,743 reid_baseline.train INFO: Accuracy: 75.2%, best Accuracy: 75.2%, min Mean_entropy: 0.5
2022-05-09 03:50:14,696 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 1.683, Loss2: 1.511, Loss3: 0.794,  Acc: 0.193, Acc2: 0.743, Acc2_pse: 0.743, Base Lr: 2.77e-03
2022-05-09 03:50:43,607 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 03:56:33,388 reid_baseline.train INFO: normal accuracy 0.7351388570117053 0.4827645719051361 
2022-05-09 03:56:33,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 03:56:33,388 reid_baseline.train INFO: Accuracy: 73.5%, best Accuracy: 75.2%, min Mean_entropy: 0.5
2022-05-09 03:57:41,004 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 1.697, Loss2: 1.498, Loss3: 0.822,  Acc: 0.168, Acc2: 0.760, Acc2_pse: 0.760, Base Lr: 2.48e-03
2022-05-09 03:58:10,940 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-09 04:03:57,954 reid_baseline.train INFO: normal accuracy 0.7452375487720909 0.46063822507858276 
2022-05-09 04:03:57,955 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 04:03:57,955 reid_baseline.train INFO: Accuracy: 74.5%, best Accuracy: 75.2%, min Mean_entropy: 0.5
2022-05-09 04:05:06,911 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 1.686, Loss2: 1.442, Loss3: 0.788,  Acc: 0.195, Acc2: 0.754, Acc2_pse: 0.754, Base Lr: 2.20e-03
2022-05-09 04:05:36,166 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 04:11:28,936 reid_baseline.train INFO: normal accuracy 0.7594675235253615 0.47914835810661316 
2022-05-09 04:11:29,739 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 04:11:29,739 reid_baseline.train INFO: Accuracy: 75.9%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:12:38,920 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 1.690, Loss2: 1.461, Loss3: 0.747,  Acc: 0.192, Acc2: 0.760, Acc2_pse: 0.760, Base Lr: 1.92e-03
2022-05-09 04:13:08,796 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 04:19:06,165 reid_baseline.train INFO: normal accuracy 0.7557952719761304 0.4926070272922516 
2022-05-09 04:19:06,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 04:19:06,165 reid_baseline.train INFO: Accuracy: 75.6%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:20:15,854 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 1.684, Loss2: 1.409, Loss3: 0.769,  Acc: 0.177, Acc2: 0.781, Acc2_pse: 0.781, Base Lr: 1.66e-03
2022-05-09 04:20:44,802 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 04:26:33,177 reid_baseline.train INFO: normal accuracy 0.7500573789304568 0.4401869475841522 
2022-05-09 04:26:33,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 04:26:33,177 reid_baseline.train INFO: Accuracy: 75.0%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:27:44,273 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 1.692, Loss2: 1.445, Loss3: 0.681,  Acc: 0.172, Acc2: 0.762, Acc2_pse: 0.762, Base Lr: 1.42e-03
2022-05-09 04:28:14,333 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-05-09 04:34:16,739 reid_baseline.train INFO: normal accuracy 0.7571723663070921 0.44820088148117065 
2022-05-09 04:34:16,739 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 04:34:16,739 reid_baseline.train INFO: Accuracy: 75.7%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:35:26,779 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 1.684, Loss2: 1.427, Loss3: 0.731,  Acc: 0.187, Acc2: 0.767, Acc2_pse: 0.767, Base Lr: 1.19e-03
2022-05-09 04:35:57,464 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 04:41:53,270 reid_baseline.train INFO: normal accuracy 0.7548772090888226 0.4801237881183624 
2022-05-09 04:41:53,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 04:41:53,271 reid_baseline.train INFO: Accuracy: 75.5%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:43:03,214 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 1.689, Loss2: 1.409, Loss3: 0.740,  Acc: 0.183, Acc2: 0.780, Acc2_pse: 0.780, Base Lr: 9.72e-04
2022-05-09 04:43:36,796 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.714[s] Speed: 22.4[samples/s]
2022-05-09 04:49:27,157 reid_baseline.train INFO: normal accuracy 0.7512049575395915 0.4264674782752991 
2022-05-09 04:49:27,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 04:49:27,158 reid_baseline.train INFO: Accuracy: 75.1%, best Accuracy: 75.9%, min Mean_entropy: 0.5
2022-05-09 04:50:37,895 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 1.642, Loss2: 1.420, Loss3: 0.712,  Acc: 0.205, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 7.78e-04
2022-05-09 04:51:06,914 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 04:56:57,216 reid_baseline.train INFO: normal accuracy 0.761533165021804 0.44486117362976074 
2022-05-09 04:56:57,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 04:56:57,979 reid_baseline.train INFO: Accuracy: 76.2%, best Accuracy: 76.2%, min Mean_entropy: 0.4
2022-05-09 04:58:08,206 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 1.668, Loss2: 1.429, Loss3: 0.745,  Acc: 0.199, Acc2: 0.781, Acc2_pse: 0.781, Base Lr: 6.04e-04
2022-05-09 04:58:37,172 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 05:04:41,148 reid_baseline.train INFO: normal accuracy 0.7711728253385357 0.46778419613838196 
2022-05-09 05:04:41,905 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 05:04:41,905 reid_baseline.train INFO: Accuracy: 77.1%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:05:48,694 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 1.689, Loss2: 1.395, Loss3: 0.710,  Acc: 0.187, Acc2: 0.781, Acc2_pse: 0.781, Base Lr: 4.51e-04
2022-05-09 05:06:18,031 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.671[s] Speed: 23.9[samples/s]
2022-05-09 05:12:17,777 reid_baseline.train INFO: normal accuracy 0.7590084920817076 0.4513038694858551 
2022-05-09 05:12:17,778 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 05:12:17,778 reid_baseline.train INFO: Accuracy: 75.9%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:13:26,577 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 1.689, Loss2: 1.399, Loss3: 0.695,  Acc: 0.179, Acc2: 0.772, Acc2_pse: 0.772, Base Lr: 3.20e-04
2022-05-09 05:13:54,129 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.669[s] Speed: 23.9[samples/s]
2022-05-09 05:19:51,014 reid_baseline.train INFO: normal accuracy 0.7681891209547854 0.4491104185581207 
2022-05-09 05:19:51,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 05:19:51,015 reid_baseline.train INFO: Accuracy: 76.8%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:20:58,231 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 1.704, Loss2: 1.395, Loss3: 0.690,  Acc: 0.179, Acc2: 0.781, Acc2_pse: 0.781, Base Lr: 2.11e-04
2022-05-09 05:21:26,368 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 05:27:26,659 reid_baseline.train INFO: normal accuracy 0.7652054165710351 0.45505884289741516 
2022-05-09 05:27:26,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 05:27:26,659 reid_baseline.train INFO: Accuracy: 76.5%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:28:35,550 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 1.682, Loss2: 1.435, Loss3: 0.744,  Acc: 0.193, Acc2: 0.760, Acc2_pse: 0.760, Base Lr: 1.26e-04
2022-05-09 05:29:04,609 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 05:35:00,304 reid_baseline.train INFO: normal accuracy 0.761762680743631 0.414345920085907 
2022-05-09 05:35:00,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 05:35:00,305 reid_baseline.train INFO: Accuracy: 76.2%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:36:10,634 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 1.670, Loss2: 1.384, Loss3: 0.659,  Acc: 0.191, Acc2: 0.785, Acc2_pse: 0.785, Base Lr: 6.51e-05
2022-05-09 05:36:39,599 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 05:42:25,489 reid_baseline.train INFO: normal accuracy 0.7610741335781501 0.44900229573249817 
2022-05-09 05:42:25,490 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 05:42:25,490 reid_baseline.train INFO: Accuracy: 76.1%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:43:35,714 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 1.666, Loss2: 1.403, Loss3: 0.708,  Acc: 0.202, Acc2: 0.780, Acc2_pse: 0.780, Base Lr: 2.83e-05
2022-05-09 05:44:03,206 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 05:49:51,516 reid_baseline.train INFO: normal accuracy 0.7548772090888226 0.42858636379241943 
2022-05-09 05:49:51,517 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 05:49:51,517 reid_baseline.train INFO: Accuracy: 75.5%, best Accuracy: 77.1%, min Mean_entropy: 0.5
2022-05-09 05:50:59,565 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 1.662, Loss2: 1.371, Loss3: 0.720,  Acc: 0.206, Acc2: 0.784, Acc2_pse: 0.784, Base Lr: 1.60e-05
2022-05-09 05:51:29,237 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 05:57:17,108 reid_baseline.train INFO: normal accuracy 0.7535001147578609 0.4159839451313019 
2022-05-09 05:57:17,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 05:57:17,109 reid_baseline.train INFO: Accuracy: 75.4%, best Accuracy: 77.1%, min Mean_entropy: 0.5
best model preformance is 0.7711728253385357
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.0/transformer_best_model.pth
2022-05-09 06:03:03,174 reid_baseline.train INFO: normal accuracy 0.7711728253385357 0.46778419613838196 
2022-05-09 06:03:03,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 06:03:03,175 reid_baseline.train INFO: Accuracy: 77.1%
2022-05-09 06:04:48,097 reid_baseline.train INFO: normal accuracy 0.9336629583848373 0.18834248185157776 
2022-05-09 06:04:48,098 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 06:04:48,098 reid_baseline.train INFO: Accuracy: 93.4%
2022-05-09 06:04:53,376 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ClipartDRI_0.2
2022-05-09 06:04:53,376 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ClipartDRI_0.2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.2)
2022-05-09 06:04:53,376 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 06:04:53,376 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 06:04:53,376 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Clipart.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ClipartDRI_0.2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 06:05:01,723 reid_baseline.train INFO: start training
2022-05-09 06:06:11,432 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.424, Loss2: 4.148, Loss3: 4.174,  Acc: 0.388, Acc2: 0.168, Acc2_pse: 0.168, Base Lr: 8.72e-04
2022-05-09 06:06:43,159 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 06:08:41,550 reid_baseline.train INFO: normal accuracy 0.3537227949599084 4.172269344329834 
2022-05-09 06:08:42,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 06:08:42,267 reid_baseline.train INFO: Accuracy: 35.4%, best Accuracy: 35.4%, min Mean_entropy: 4e+00
2022-05-09 06:09:52,846 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.053, Loss2: 3.987, Loss3: 4.171,  Acc: 0.623, Acc2: 0.424, Acc2_pse: 0.424, Base Lr: 1.66e-03
2022-05-09 06:10:23,225 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-05-09 06:12:23,288 reid_baseline.train INFO: normal accuracy 0.3720504009163803 4.1603264808654785 
2022-05-09 06:12:24,098 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 06:12:24,099 reid_baseline.train INFO: Accuracy: 37.2%, best Accuracy: 37.2%, min Mean_entropy: 4e+00
2022-05-09 06:13:33,521 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.727, Loss2: 3.705, Loss3: 4.151,  Acc: 0.797, Acc2: 0.457, Acc2_pse: 0.457, Base Lr: 2.46e-03
2022-05-09 06:14:02,313 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 06:16:01,816 reid_baseline.train INFO: normal accuracy 0.41328751431844213 4.076822280883789 
2022-05-09 06:16:02,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 06:16:02,581 reid_baseline.train INFO: Accuracy: 41.3%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:17:11,801 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.579, Loss2: 3.192, Loss3: 3.929,  Acc: 0.842, Acc2: 0.441, Acc2_pse: 0.441, Base Lr: 3.25e-03
2022-05-09 06:17:40,627 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 06:19:40,665 reid_baseline.train INFO: normal accuracy 0.34936998854524626 3.4421260356903076 
2022-05-09 06:19:40,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 06:19:40,665 reid_baseline.train INFO: Accuracy: 34.9%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:20:46,641 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.547, Loss2: 2.852, Loss3: 3.127,  Acc: 0.856, Acc2: 0.387, Acc2_pse: 0.387, Base Lr: 4.04e-03
2022-05-09 06:21:16,264 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.655[s] Speed: 24.4[samples/s]
2022-05-09 06:23:17,537 reid_baseline.train INFO: normal accuracy 0.3353951890034364 2.393606424331665 
2022-05-09 06:23:17,538 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 06:23:17,538 reid_baseline.train INFO: Accuracy: 33.5%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:24:27,383 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.505, Loss2: 2.815, Loss3: 2.344,  Acc: 0.847, Acc2: 0.386, Acc2_pse: 0.386, Base Lr: 4.83e-03
2022-05-09 06:24:55,341 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 06:26:54,141 reid_baseline.train INFO: normal accuracy 0.33837342497136313 1.8486634492874146 
2022-05-09 06:26:54,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 06:26:54,141 reid_baseline.train INFO: Accuracy: 33.8%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:28:01,742 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.436, Loss2: 2.682, Loss3: 1.883,  Acc: 0.894, Acc2: 0.423, Acc2_pse: 0.423, Base Lr: 5.62e-03
2022-05-09 06:28:30,121 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.671[s] Speed: 23.8[samples/s]
2022-05-09 06:30:28,611 reid_baseline.train INFO: normal accuracy 0.3731958762886598 1.7166956663131714 
2022-05-09 06:30:28,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 06:30:28,611 reid_baseline.train INFO: Accuracy: 37.3%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:31:38,250 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.393, Loss2: 2.478, Loss3: 1.612,  Acc: 0.888, Acc2: 0.470, Acc2_pse: 0.470, Base Lr: 6.42e-03
2022-05-09 06:32:08,433 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 06:34:03,860 reid_baseline.train INFO: normal accuracy 0.4018327605956472 1.559412956237793 
2022-05-09 06:34:03,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 06:34:03,860 reid_baseline.train INFO: Accuracy: 40.2%, best Accuracy: 41.3%, min Mean_entropy: 4e+00
2022-05-09 06:35:12,736 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.335, Loss2: 2.360, Loss3: 1.442,  Acc: 0.917, Acc2: 0.481, Acc2_pse: 0.481, Base Lr: 7.21e-03
2022-05-09 06:35:44,432 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 06:37:43,758 reid_baseline.train INFO: normal accuracy 0.4245131729667812 1.3402496576309204 
2022-05-09 06:37:44,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 06:37:44,541 reid_baseline.train INFO: Accuracy: 42.5%, best Accuracy: 42.5%, min Mean_entropy: 1e+00
2022-05-09 06:38:55,440 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.332, Loss2: 2.271, Loss3: 1.220,  Acc: 0.903, Acc2: 0.536, Acc2_pse: 0.536, Base Lr: 6.83e-03
2022-05-09 06:39:25,043 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.703[s] Speed: 22.8[samples/s]
2022-05-09 06:41:26,007 reid_baseline.train INFO: normal accuracy 0.41626575028636886 1.132396936416626 
2022-05-09 06:41:26,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 06:41:26,007 reid_baseline.train INFO: Accuracy: 41.6%, best Accuracy: 42.5%, min Mean_entropy: 1e+00
2022-05-09 06:42:33,075 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.290, Loss2: 2.206, Loss3: 1.138,  Acc: 0.929, Acc2: 0.550, Acc2_pse: 0.550, Base Lr: 6.60e-03
2022-05-09 06:43:02,053 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-09 06:44:59,527 reid_baseline.train INFO: normal accuracy 0.4306987399770905 1.1531383991241455 
2022-05-09 06:45:00,257 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 06:45:00,257 reid_baseline.train INFO: Accuracy: 43.1%, best Accuracy: 43.1%, min Mean_entropy: 1e+00
2022-05-09 06:46:07,865 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.252, Loss2: 2.088, Loss3: 1.068,  Acc: 0.938, Acc2: 0.570, Acc2_pse: 0.570, Base Lr: 6.35e-03
2022-05-09 06:46:38,795 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-09 06:48:34,153 reid_baseline.train INFO: normal accuracy 0.4611683848797251 1.1117160320281982 
2022-05-09 06:48:34,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 06:48:34,984 reid_baseline.train INFO: Accuracy: 46.1%, best Accuracy: 46.1%, min Mean_entropy: 1e+00
2022-05-09 06:49:43,937 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.241, Loss2: 1.992, Loss3: 1.023,  Acc: 0.938, Acc2: 0.590, Acc2_pse: 0.590, Base Lr: 6.09e-03
2022-05-09 06:50:14,798 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 06:52:16,306 reid_baseline.train INFO: normal accuracy 0.4856815578465063 1.0822346210479736 
2022-05-09 06:52:17,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 06:52:17,076 reid_baseline.train INFO: Accuracy: 48.6%, best Accuracy: 48.6%, min Mean_entropy: 1e+00
2022-05-09 06:53:26,048 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.227, Loss2: 1.892, Loss3: 0.980,  Acc: 0.949, Acc2: 0.625, Acc2_pse: 0.625, Base Lr: 5.82e-03
2022-05-09 06:53:54,708 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 06:55:52,083 reid_baseline.train INFO: normal accuracy 0.48957617411225657 1.044927954673767 
2022-05-09 06:55:52,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 06:55:52,841 reid_baseline.train INFO: Accuracy: 49.0%, best Accuracy: 49.0%, min Mean_entropy: 1e+00
2022-05-09 06:57:00,443 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.235, Loss2: 1.880, Loss3: 0.974,  Acc: 0.936, Acc2: 0.633, Acc2_pse: 0.633, Base Lr: 5.54e-03
2022-05-09 06:57:29,833 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.678[s] Speed: 23.6[samples/s]
2022-05-09 06:59:25,446 reid_baseline.train INFO: normal accuracy 0.47697594501718216 0.8814801573753357 
2022-05-09 06:59:25,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 06:59:25,447 reid_baseline.train INFO: Accuracy: 47.7%, best Accuracy: 49.0%, min Mean_entropy: 1e+00
2022-05-09 07:00:33,127 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.206, Loss2: 1.806, Loss3: 0.942,  Acc: 0.953, Acc2: 0.640, Acc2_pse: 0.640, Base Lr: 5.24e-03
2022-05-09 07:01:00,554 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.660[s] Speed: 24.3[samples/s]
2022-05-09 07:02:59,275 reid_baseline.train INFO: normal accuracy 0.5303550973654066 1.0011934041976929 
2022-05-09 07:03:00,089 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 07:03:00,089 reid_baseline.train INFO: Accuracy: 53.0%, best Accuracy: 53.0%, min Mean_entropy: 1e+00
2022-05-09 07:04:09,312 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.188, Loss2: 1.784, Loss3: 0.936,  Acc: 0.958, Acc2: 0.643, Acc2_pse: 0.643, Base Lr: 4.94e-03
2022-05-09 07:04:41,065 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-05-09 07:06:41,078 reid_baseline.train INFO: normal accuracy 0.49713631156930127 0.8586816787719727 
2022-05-09 07:06:41,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 07:06:41,078 reid_baseline.train INFO: Accuracy: 49.7%, best Accuracy: 53.0%, min Mean_entropy: 1e+00
2022-05-09 07:07:51,968 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.201, Loss2: 1.705, Loss3: 0.888,  Acc: 0.953, Acc2: 0.677, Acc2_pse: 0.677, Base Lr: 4.63e-03
2022-05-09 07:08:21,999 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-09 07:10:21,783 reid_baseline.train INFO: normal accuracy 0.5374570446735395 0.905943751335144 
2022-05-09 07:10:22,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 07:10:22,640 reid_baseline.train INFO: Accuracy: 53.7%, best Accuracy: 53.7%, min Mean_entropy: 0.9
2022-05-09 07:11:32,293 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.195, Loss2: 1.703, Loss3: 0.888,  Acc: 0.957, Acc2: 0.669, Acc2_pse: 0.669, Base Lr: 4.32e-03
2022-05-09 07:12:01,345 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-09 07:14:01,863 reid_baseline.train INFO: normal accuracy 0.5117983963344788 0.8018556833267212 
2022-05-09 07:14:01,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 07:14:01,863 reid_baseline.train INFO: Accuracy: 51.2%, best Accuracy: 53.7%, min Mean_entropy: 0.9
2022-05-09 07:15:09,127 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.198, Loss2: 1.633, Loss3: 0.827,  Acc: 0.954, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 4.01e-03
2022-05-09 07:15:38,536 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 07:17:36,280 reid_baseline.train INFO: normal accuracy 0.5406643757159221 0.8585157990455627 
2022-05-09 07:17:37,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 07:17:37,048 reid_baseline.train INFO: Accuracy: 54.1%, best Accuracy: 54.1%, min Mean_entropy: 0.9
2022-05-09 07:18:44,291 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.177, Loss2: 1.656, Loss3: 0.851,  Acc: 0.962, Acc2: 0.694, Acc2_pse: 0.694, Base Lr: 3.69e-03
2022-05-09 07:19:13,584 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-09 07:21:14,477 reid_baseline.train INFO: normal accuracy 0.5248568155784651 0.8322023749351501 
2022-05-09 07:21:14,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 07:21:14,478 reid_baseline.train INFO: Accuracy: 52.5%, best Accuracy: 54.1%, min Mean_entropy: 0.9
2022-05-09 07:22:22,916 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.176, Loss2: 1.598, Loss3: 0.828,  Acc: 0.960, Acc2: 0.702, Acc2_pse: 0.702, Base Lr: 3.38e-03
2022-05-09 07:22:51,919 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 07:24:53,276 reid_baseline.train INFO: normal accuracy 0.5392898052691867 0.7672483325004578 
2022-05-09 07:24:53,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 07:24:53,276 reid_baseline.train INFO: Accuracy: 53.9%, best Accuracy: 54.1%, min Mean_entropy: 0.9
2022-05-09 07:26:02,639 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.176, Loss2: 1.549, Loss3: 0.792,  Acc: 0.965, Acc2: 0.734, Acc2_pse: 0.734, Base Lr: 3.08e-03
2022-05-09 07:26:31,101 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.679[s] Speed: 23.6[samples/s]
2022-05-09 07:28:32,828 reid_baseline.train INFO: normal accuracy 0.5525773195876289 0.7843245267868042 
2022-05-09 07:28:33,646 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 07:28:33,647 reid_baseline.train INFO: Accuracy: 55.3%, best Accuracy: 55.3%, min Mean_entropy: 0.8
2022-05-09 07:29:41,914 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.162, Loss2: 1.543, Loss3: 0.807,  Acc: 0.971, Acc2: 0.729, Acc2_pse: 0.729, Base Lr: 2.77e-03
2022-05-09 07:30:11,327 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 07:32:12,746 reid_baseline.train INFO: normal accuracy 0.5266895761741123 0.751105546951294 
2022-05-09 07:32:12,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 07:32:12,747 reid_baseline.train INFO: Accuracy: 52.7%, best Accuracy: 55.3%, min Mean_entropy: 0.8
2022-05-09 07:33:20,135 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.169, Loss2: 1.541, Loss3: 0.832,  Acc: 0.966, Acc2: 0.739, Acc2_pse: 0.739, Base Lr: 2.48e-03
2022-05-09 07:33:49,137 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.664[s] Speed: 24.1[samples/s]
2022-05-09 07:35:49,361 reid_baseline.train INFO: normal accuracy 0.531729667812142 0.7252962589263916 
2022-05-09 07:35:49,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 07:35:49,361 reid_baseline.train INFO: Accuracy: 53.2%, best Accuracy: 55.3%, min Mean_entropy: 0.8
2022-05-09 07:36:59,160 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.184, Loss2: 1.490, Loss3: 0.792,  Acc: 0.958, Acc2: 0.739, Acc2_pse: 0.739, Base Lr: 2.20e-03
2022-05-09 07:37:28,274 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 07:39:25,523 reid_baseline.train INFO: normal accuracy 0.5624284077892325 0.7761881351470947 
2022-05-09 07:39:26,291 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 07:39:26,292 reid_baseline.train INFO: Accuracy: 56.2%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:40:34,208 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.176, Loss2: 1.488, Loss3: 0.771,  Acc: 0.961, Acc2: 0.756, Acc2_pse: 0.756, Base Lr: 1.92e-03
2022-05-09 07:41:03,460 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-09 07:43:05,112 reid_baseline.train INFO: normal accuracy 0.543184421534937 0.781166672706604 
2022-05-09 07:43:05,112 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 07:43:05,112 reid_baseline.train INFO: Accuracy: 54.3%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:44:14,836 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.173, Loss2: 1.446, Loss3: 0.790,  Acc: 0.963, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 1.66e-03
2022-05-09 07:44:43,673 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 07:46:46,466 reid_baseline.train INFO: normal accuracy 0.5266895761741123 0.7134623527526855 
2022-05-09 07:46:46,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 07:46:46,467 reid_baseline.train INFO: Accuracy: 52.7%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:47:57,996 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.171, Loss2: 1.480, Loss3: 0.701,  Acc: 0.959, Acc2: 0.758, Acc2_pse: 0.758, Base Lr: 1.42e-03
2022-05-09 07:48:28,028 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.710[s] Speed: 22.5[samples/s]
2022-05-09 07:50:26,018 reid_baseline.train INFO: normal accuracy 0.5443298969072164 0.7344838976860046 
2022-05-09 07:50:26,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 07:50:26,018 reid_baseline.train INFO: Accuracy: 54.4%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:51:36,834 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.179, Loss2: 1.461, Loss3: 0.749,  Acc: 0.964, Acc2: 0.747, Acc2_pse: 0.747, Base Lr: 1.19e-03
2022-05-09 07:52:07,677 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.701[s] Speed: 22.8[samples/s]
2022-05-09 07:54:08,546 reid_baseline.train INFO: normal accuracy 0.5413516609392898 0.7781097292900085 
2022-05-09 07:54:08,546 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 07:54:08,546 reid_baseline.train INFO: Accuracy: 54.1%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:55:18,285 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.159, Loss2: 1.452, Loss3: 0.755,  Acc: 0.971, Acc2: 0.757, Acc2_pse: 0.757, Base Lr: 9.72e-04
2022-05-09 07:55:51,409 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.709[s] Speed: 22.6[samples/s]
2022-05-09 07:57:54,814 reid_baseline.train INFO: normal accuracy 0.5328751431844215 0.6936730742454529 
2022-05-09 07:57:54,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 07:57:54,814 reid_baseline.train INFO: Accuracy: 53.3%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 07:59:04,657 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.159, Loss2: 1.466, Loss3: 0.720,  Acc: 0.972, Acc2: 0.748, Acc2_pse: 0.748, Base Lr: 7.78e-04
2022-05-09 07:59:33,105 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.678[s] Speed: 23.6[samples/s]
2022-05-09 08:01:31,032 reid_baseline.train INFO: normal accuracy 0.5610538373424971 0.7491276264190674 
2022-05-09 08:01:31,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 08:01:31,032 reid_baseline.train INFO: Accuracy: 56.1%, best Accuracy: 56.2%, min Mean_entropy: 0.8
2022-05-09 08:02:41,459 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.160, Loss2: 1.474, Loss3: 0.745,  Acc: 0.965, Acc2: 0.751, Acc2_pse: 0.751, Base Lr: 6.04e-04
2022-05-09 08:03:10,778 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.697[s] Speed: 22.9[samples/s]
2022-05-09 08:05:10,592 reid_baseline.train INFO: normal accuracy 0.5729667812142039 0.77428138256073 
2022-05-09 08:05:11,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 08:05:11,356 reid_baseline.train INFO: Accuracy: 57.3%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:06:18,803 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.159, Loss2: 1.430, Loss3: 0.722,  Acc: 0.967, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 4.51e-04
2022-05-09 08:06:47,891 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-09 08:08:50,594 reid_baseline.train INFO: normal accuracy 0.5447880870561282 0.7329714894294739 
2022-05-09 08:08:50,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 08:08:50,595 reid_baseline.train INFO: Accuracy: 54.5%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:10:00,153 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.160, Loss2: 1.433, Loss3: 0.715,  Acc: 0.966, Acc2: 0.761, Acc2_pse: 0.761, Base Lr: 3.20e-04
2022-05-09 08:10:27,769 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-09 08:12:28,939 reid_baseline.train INFO: normal accuracy 0.5633447880870561 0.7464523315429688 
2022-05-09 08:12:28,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 08:12:28,939 reid_baseline.train INFO: Accuracy: 56.3%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:13:35,222 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.170, Loss2: 1.437, Loss3: 0.706,  Acc: 0.963, Acc2: 0.757, Acc2_pse: 0.757, Base Lr: 2.11e-04
2022-05-09 08:14:03,659 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.671[s] Speed: 23.8[samples/s]
2022-05-09 08:16:04,248 reid_baseline.train INFO: normal accuracy 0.5621993127147766 0.7503843903541565 
2022-05-09 08:16:04,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 08:16:04,248 reid_baseline.train INFO: Accuracy: 56.2%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:17:14,032 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.157, Loss2: 1.477, Loss3: 0.755,  Acc: 0.971, Acc2: 0.746, Acc2_pse: 0.746, Base Lr: 1.26e-04
2022-05-09 08:17:42,687 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 08:19:42,982 reid_baseline.train INFO: normal accuracy 0.5518900343642612 0.6926698684692383 
2022-05-09 08:19:42,982 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 08:19:42,983 reid_baseline.train INFO: Accuracy: 55.2%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:20:52,654 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.156, Loss2: 1.412, Loss3: 0.671,  Acc: 0.968, Acc2: 0.770, Acc2_pse: 0.770, Base Lr: 6.51e-05
2022-05-09 08:21:21,812 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 08:23:21,075 reid_baseline.train INFO: normal accuracy 0.5473081328751432 0.7436972856521606 
2022-05-09 08:23:21,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 08:23:21,076 reid_baseline.train INFO: Accuracy: 54.7%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:24:31,025 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.153, Loss2: 1.442, Loss3: 0.718,  Acc: 0.971, Acc2: 0.757, Acc2_pse: 0.757, Base Lr: 2.83e-05
2022-05-09 08:24:58,841 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.674[s] Speed: 23.7[samples/s]
2022-05-09 08:26:59,607 reid_baseline.train INFO: normal accuracy 0.5390607101947308 0.7020965218544006 
2022-05-09 08:26:59,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 08:26:59,608 reid_baseline.train INFO: Accuracy: 53.9%, best Accuracy: 57.3%, min Mean_entropy: 0.8
2022-05-09 08:28:06,809 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.157, Loss2: 1.401, Loss3: 0.731,  Acc: 0.972, Acc2: 0.773, Acc2_pse: 0.773, Base Lr: 1.60e-05
2022-05-09 08:28:37,620 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 08:30:34,205 reid_baseline.train INFO: normal accuracy 0.5406643757159221 0.6900773644447327 
2022-05-09 08:30:34,206 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 08:30:34,206 reid_baseline.train INFO: Accuracy: 54.1%, best Accuracy: 57.3%, min Mean_entropy: 0.8
best model preformance is 0.5729667812142039
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ClipartDRI_0.2/transformer_best_model.pth
2022-05-09 08:32:35,421 reid_baseline.train INFO: normal accuracy 0.5729667812142039 0.77428138256073 
2022-05-09 08:32:35,422 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 08:32:35,422 reid_baseline.train INFO: Accuracy: 57.3%
2022-05-09 08:34:19,833 reid_baseline.train INFO: normal accuracy 0.9274824886691388 0.21117031574249268 
2022-05-09 08:34:19,833 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 08:34:19,833 reid_baseline.train INFO: Accuracy: 92.7%
2022-05-09 08:34:24,949 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ProductDRI_0.2
2022-05-09 08:34:24,949 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ProductDRI_0.2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.2)
2022-05-09 08:34:24,949 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 08:34:24,950 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 08:34:24,950 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Product.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ProductDRI_0.2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Product and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 08:34:33,351 reid_baseline.train INFO: start training
2022-05-09 08:35:43,261 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.424, Loss2: 4.148, Loss3: 4.174,  Acc: 0.388, Acc2: 0.168, Acc2_pse: 0.168, Base Lr: 8.72e-04
2022-05-09 08:36:14,533 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 08:38:16,866 reid_baseline.train INFO: normal accuracy 0.4478486145528272 4.1724677085876465 
2022-05-09 08:38:17,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 08:38:17,573 reid_baseline.train INFO: Accuracy: 44.8%, best Accuracy: 44.8%, min Mean_entropy: 4e+00
2022-05-09 08:39:27,039 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.053, Loss2: 3.987, Loss3: 4.171,  Acc: 0.625, Acc2: 0.424, Acc2_pse: 0.424, Base Lr: 1.66e-03
2022-05-09 08:39:56,731 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-09 08:42:00,998 reid_baseline.train INFO: normal accuracy 0.49290380716377563 4.161637783050537 
2022-05-09 08:42:01,759 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 08:42:01,759 reid_baseline.train INFO: Accuracy: 49.3%, best Accuracy: 49.3%, min Mean_entropy: 4e+00
2022-05-09 08:43:10,891 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.727, Loss2: 3.705, Loss3: 4.151,  Acc: 0.797, Acc2: 0.457, Acc2_pse: 0.457, Base Lr: 2.46e-03
2022-05-09 08:43:39,493 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 08:45:42,235 reid_baseline.train INFO: normal accuracy 0.5167830592475783 4.0531744956970215 
2022-05-09 08:45:42,987 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 08:45:42,988 reid_baseline.train INFO: Accuracy: 51.7%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 08:46:52,932 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.579, Loss2: 3.192, Loss3: 3.929,  Acc: 0.842, Acc2: 0.441, Acc2_pse: 0.441, Base Lr: 3.25e-03
2022-05-09 08:47:21,939 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.682[s] Speed: 23.5[samples/s]
2022-05-09 08:49:26,961 reid_baseline.train INFO: normal accuracy 0.44920027033115567 3.4536960124969482 
2022-05-09 08:49:26,962 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 08:49:26,962 reid_baseline.train INFO: Accuracy: 44.9%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 08:50:33,659 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.547, Loss2: 2.852, Loss3: 3.127,  Acc: 0.855, Acc2: 0.388, Acc2_pse: 0.388, Base Lr: 4.04e-03
2022-05-09 08:51:03,076 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.658[s] Speed: 24.3[samples/s]
2022-05-09 08:53:02,919 reid_baseline.train INFO: normal accuracy 0.3800405496733499 2.4387729167938232 
2022-05-09 08:53:02,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 08:53:02,920 reid_baseline.train INFO: Accuracy: 38.0%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 08:54:12,740 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.506, Loss2: 2.815, Loss3: 2.344,  Acc: 0.847, Acc2: 0.386, Acc2_pse: 0.386, Base Lr: 4.83e-03
2022-05-09 08:54:40,708 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 08:56:44,485 reid_baseline.train INFO: normal accuracy 0.3962604190132913 1.9160369634628296 
2022-05-09 08:56:44,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 08:56:44,485 reid_baseline.train INFO: Accuracy: 39.6%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 08:57:51,379 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.433, Loss2: 2.679, Loss3: 1.885,  Acc: 0.895, Acc2: 0.426, Acc2_pse: 0.426, Base Lr: 5.62e-03
2022-05-09 08:58:20,030 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.667[s] Speed: 24.0[samples/s]
2022-05-09 09:00:23,909 reid_baseline.train INFO: normal accuracy 0.45032665014642936 1.6677391529083252 
2022-05-09 09:00:23,909 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 09:00:23,909 reid_baseline.train INFO: Accuracy: 45.0%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 09:01:33,187 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.396, Loss2: 2.477, Loss3: 1.613,  Acc: 0.887, Acc2: 0.469, Acc2_pse: 0.469, Base Lr: 6.42e-03
2022-05-09 09:02:03,333 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.688[s] Speed: 23.2[samples/s]
2022-05-09 09:04:06,478 reid_baseline.train INFO: normal accuracy 0.4965082225726515 1.5380635261535645 
2022-05-09 09:04:06,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 09:04:06,478 reid_baseline.train INFO: Accuracy: 49.7%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 09:05:14,945 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.338, Loss2: 2.356, Loss3: 1.446,  Acc: 0.915, Acc2: 0.484, Acc2_pse: 0.484, Base Lr: 7.21e-03
2022-05-09 09:05:47,045 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 09:07:52,841 reid_baseline.train INFO: normal accuracy 0.4892993917548997 1.2423691749572754 
2022-05-09 09:07:52,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 09:07:52,841 reid_baseline.train INFO: Accuracy: 48.9%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 09:09:02,852 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.328, Loss2: 2.264, Loss3: 1.225,  Acc: 0.901, Acc2: 0.536, Acc2_pse: 0.536, Base Lr: 6.83e-03
2022-05-09 09:09:32,015 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 09:11:36,035 reid_baseline.train INFO: normal accuracy 0.510024780355936 1.0412474870681763 
2022-05-09 09:11:36,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 09:11:36,035 reid_baseline.train INFO: Accuracy: 51.0%, best Accuracy: 51.7%, min Mean_entropy: 4e+00
2022-05-09 09:12:42,334 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.285, Loss2: 2.204, Loss3: 1.138,  Acc: 0.928, Acc2: 0.549, Acc2_pse: 0.549, Base Lr: 6.60e-03
2022-05-09 09:13:12,159 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.662[s] Speed: 24.2[samples/s]
2022-05-09 09:15:14,249 reid_baseline.train INFO: normal accuracy 0.5354809641811219 1.0924052000045776 
2022-05-09 09:15:15,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 09:15:15,020 reid_baseline.train INFO: Accuracy: 53.5%, best Accuracy: 53.5%, min Mean_entropy: 1e+00
2022-05-09 09:16:22,688 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.257, Loss2: 2.086, Loss3: 1.070,  Acc: 0.938, Acc2: 0.571, Acc2_pse: 0.571, Base Lr: 6.35e-03
2022-05-09 09:16:54,225 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 09:18:54,763 reid_baseline.train INFO: normal accuracy 0.5577832845235413 1.0170711278915405 
2022-05-09 09:18:55,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 09:18:55,532 reid_baseline.train INFO: Accuracy: 55.8%, best Accuracy: 55.8%, min Mean_entropy: 1e+00
2022-05-09 09:20:03,959 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.241, Loss2: 1.982, Loss3: 1.028,  Acc: 0.938, Acc2: 0.591, Acc2_pse: 0.591, Base Lr: 6.09e-03
2022-05-09 09:20:34,159 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-09 09:22:42,574 reid_baseline.train INFO: normal accuracy 0.574678981752647 0.9408553838729858 
2022-05-09 09:22:43,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 09:22:43,332 reid_baseline.train INFO: Accuracy: 57.5%, best Accuracy: 57.5%, min Mean_entropy: 0.9
2022-05-09 09:23:52,326 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.228, Loss2: 1.893, Loss3: 0.972,  Acc: 0.947, Acc2: 0.620, Acc2_pse: 0.620, Base Lr: 5.82e-03
2022-05-09 09:24:21,613 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.682[s] Speed: 23.4[samples/s]
2022-05-09 09:26:33,122 reid_baseline.train INFO: normal accuracy 0.592926334760081 0.9200608134269714 
2022-05-09 09:26:33,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 09:26:33,884 reid_baseline.train INFO: Accuracy: 59.3%, best Accuracy: 59.3%, min Mean_entropy: 0.9
2022-05-09 09:27:41,258 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.231, Loss2: 1.887, Loss3: 0.980,  Acc: 0.940, Acc2: 0.633, Acc2_pse: 0.633, Base Lr: 5.54e-03
2022-05-09 09:28:10,601 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 09:30:12,179 reid_baseline.train INFO: normal accuracy 0.5890966433881505 0.8068801164627075 
2022-05-09 09:30:12,180 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 09:30:12,180 reid_baseline.train INFO: Accuracy: 58.9%, best Accuracy: 59.3%, min Mean_entropy: 0.9
2022-05-09 09:31:19,958 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.206, Loss2: 1.816, Loss3: 0.934,  Acc: 0.952, Acc2: 0.649, Acc2_pse: 0.649, Base Lr: 5.24e-03
2022-05-09 09:31:47,036 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.658[s] Speed: 24.3[samples/s]
2022-05-09 09:33:50,863 reid_baseline.train INFO: normal accuracy 0.6316738004054967 0.8454442024230957 
2022-05-09 09:33:51,619 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 09:33:51,619 reid_baseline.train INFO: Accuracy: 63.2%, best Accuracy: 63.2%, min Mean_entropy: 0.8
2022-05-09 09:35:01,500 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.189, Loss2: 1.782, Loss3: 0.936,  Acc: 0.953, Acc2: 0.650, Acc2_pse: 0.650, Base Lr: 4.94e-03
2022-05-09 09:35:32,443 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.695[s] Speed: 23.0[samples/s]
2022-05-09 09:37:31,308 reid_baseline.train INFO: normal accuracy 0.6145528272133364 0.7502226829528809 
2022-05-09 09:37:31,308 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 09:37:31,308 reid_baseline.train INFO: Accuracy: 61.5%, best Accuracy: 63.2%, min Mean_entropy: 0.8
2022-05-09 09:38:42,369 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.199, Loss2: 1.716, Loss3: 0.889,  Acc: 0.954, Acc2: 0.667, Acc2_pse: 0.667, Base Lr: 4.63e-03
2022-05-09 09:39:12,030 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 09:41:18,283 reid_baseline.train INFO: normal accuracy 0.6424870466321243 0.7783578634262085 
2022-05-09 09:41:19,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 09:41:19,051 reid_baseline.train INFO: Accuracy: 64.2%, best Accuracy: 64.2%, min Mean_entropy: 0.8
2022-05-09 09:42:29,654 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.190, Loss2: 1.702, Loss3: 0.894,  Acc: 0.954, Acc2: 0.676, Acc2_pse: 0.676, Base Lr: 4.32e-03
2022-05-09 09:42:59,254 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.700[s] Speed: 22.9[samples/s]
2022-05-09 09:45:05,705 reid_baseline.train INFO: normal accuracy 0.6264924532552376 0.729098379611969 
2022-05-09 09:45:05,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 09:45:05,705 reid_baseline.train INFO: Accuracy: 62.6%, best Accuracy: 64.2%, min Mean_entropy: 0.8
2022-05-09 09:46:14,464 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.198, Loss2: 1.627, Loss3: 0.839,  Acc: 0.955, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 4.01e-03
2022-05-09 09:46:44,576 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.691[s] Speed: 23.2[samples/s]
2022-05-09 09:48:52,082 reid_baseline.train INFO: normal accuracy 0.6553277765262446 0.7481397390365601 
2022-05-09 09:48:52,833 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 09:48:52,833 reid_baseline.train INFO: Accuracy: 65.5%, best Accuracy: 65.5%, min Mean_entropy: 0.7
2022-05-09 09:50:00,672 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.175, Loss2: 1.651, Loss3: 0.867,  Acc: 0.961, Acc2: 0.695, Acc2_pse: 0.695, Base Lr: 3.69e-03
2022-05-09 09:50:29,840 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.664[s] Speed: 24.1[samples/s]
2022-05-09 09:52:31,789 reid_baseline.train INFO: normal accuracy 0.6467672899301644 0.687988817691803 
2022-05-09 09:52:31,789 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 09:52:31,789 reid_baseline.train INFO: Accuracy: 64.7%, best Accuracy: 65.5%, min Mean_entropy: 0.7
2022-05-09 09:53:40,699 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.172, Loss2: 1.597, Loss3: 0.838,  Acc: 0.962, Acc2: 0.706, Acc2_pse: 0.706, Base Lr: 3.38e-03
2022-05-09 09:54:10,256 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 09:56:09,283 reid_baseline.train INFO: normal accuracy 0.6460914620410002 0.6484199166297913 
2022-05-09 09:56:09,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 09:56:09,284 reid_baseline.train INFO: Accuracy: 64.6%, best Accuracy: 65.5%, min Mean_entropy: 0.7
2022-05-09 09:57:18,438 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.177, Loss2: 1.560, Loss3: 0.788,  Acc: 0.965, Acc2: 0.730, Acc2_pse: 0.730, Base Lr: 3.08e-03
2022-05-09 09:57:46,662 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 09:59:50,602 reid_baseline.train INFO: normal accuracy 0.6632124352331606 0.6592089533805847 
2022-05-09 09:59:51,389 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 09:59:51,389 reid_baseline.train INFO: Accuracy: 66.3%, best Accuracy: 66.3%, min Mean_entropy: 0.7
2022-05-09 10:00:59,866 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.164, Loss2: 1.550, Loss3: 0.810,  Acc: 0.969, Acc2: 0.726, Acc2_pse: 0.726, Base Lr: 2.77e-03
2022-05-09 10:01:28,154 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 10:03:34,184 reid_baseline.train INFO: normal accuracy 0.6505969813020951 0.6389303803443909 
2022-05-09 10:03:34,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 10:03:34,184 reid_baseline.train INFO: Accuracy: 65.1%, best Accuracy: 66.3%, min Mean_entropy: 0.7
2022-05-09 10:04:41,332 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.168, Loss2: 1.533, Loss3: 0.843,  Acc: 0.965, Acc2: 0.749, Acc2_pse: 0.749, Base Lr: 2.48e-03
2022-05-09 10:05:11,335 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.670[s] Speed: 23.9[samples/s]
2022-05-09 10:07:17,354 reid_baseline.train INFO: normal accuracy 0.6514980851543141 0.6131890416145325 
2022-05-09 10:07:17,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 10:07:17,354 reid_baseline.train INFO: Accuracy: 65.1%, best Accuracy: 66.3%, min Mean_entropy: 0.7
2022-05-09 10:08:26,506 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.186, Loss2: 1.489, Loss3: 0.799,  Acc: 0.955, Acc2: 0.743, Acc2_pse: 0.743, Base Lr: 2.20e-03
2022-05-09 10:08:55,353 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 10:10:58,144 reid_baseline.train INFO: normal accuracy 0.6706465420139671 0.6464726328849792 
2022-05-09 10:10:59,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 10:10:59,010 reid_baseline.train INFO: Accuracy: 67.1%, best Accuracy: 67.1%, min Mean_entropy: 0.6
2022-05-09 10:12:07,787 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.178, Loss2: 1.487, Loss3: 0.779,  Acc: 0.963, Acc2: 0.751, Acc2_pse: 0.751, Base Lr: 1.92e-03
2022-05-09 10:12:37,357 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 10:14:39,399 reid_baseline.train INFO: normal accuracy 0.6778553728317188 0.6748459339141846 
2022-05-09 10:14:40,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 10:14:40,175 reid_baseline.train INFO: Accuracy: 67.8%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:15:49,432 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.174, Loss2: 1.439, Loss3: 0.797,  Acc: 0.963, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 1.66e-03
2022-05-09 10:16:18,174 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.685[s] Speed: 23.3[samples/s]
2022-05-09 10:18:22,939 reid_baseline.train INFO: normal accuracy 0.6580310880829016 0.5961581468582153 
2022-05-09 10:18:22,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 10:18:22,940 reid_baseline.train INFO: Accuracy: 65.8%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:19:34,449 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.173, Loss2: 1.476, Loss3: 0.699,  Acc: 0.959, Acc2: 0.756, Acc2_pse: 0.756, Base Lr: 1.42e-03
2022-05-09 10:20:04,556 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.710[s] Speed: 22.5[samples/s]
2022-05-09 10:22:06,998 reid_baseline.train INFO: normal accuracy 0.6677179544942554 0.6060686707496643 
2022-05-09 10:22:06,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 10:22:06,998 reid_baseline.train INFO: Accuracy: 66.8%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:23:16,930 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.178, Loss2: 1.464, Loss3: 0.758,  Acc: 0.965, Acc2: 0.752, Acc2_pse: 0.752, Base Lr: 1.19e-03
2022-05-09 10:23:47,252 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.691[s] Speed: 23.2[samples/s]
2022-05-09 10:25:54,345 reid_baseline.train INFO: normal accuracy 0.665465194863708 0.658341109752655 
2022-05-09 10:25:54,345 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 10:25:54,345 reid_baseline.train INFO: Accuracy: 66.5%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:27:02,877 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.159, Loss2: 1.449, Loss3: 0.757,  Acc: 0.969, Acc2: 0.760, Acc2_pse: 0.760, Base Lr: 9.72e-04
2022-05-09 10:27:36,624 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.705[s] Speed: 22.7[samples/s]
2022-05-09 10:29:45,034 reid_baseline.train INFO: normal accuracy 0.6553277765262446 0.5914390683174133 
2022-05-09 10:29:45,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 10:29:45,035 reid_baseline.train INFO: Accuracy: 65.5%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:30:53,811 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.160, Loss2: 1.466, Loss3: 0.723,  Acc: 0.969, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 7.78e-04
2022-05-09 10:31:22,501 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.671[s] Speed: 23.8[samples/s]
2022-05-09 10:33:30,717 reid_baseline.train INFO: normal accuracy 0.6726740256814598 0.6110222339630127 
2022-05-09 10:33:30,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 10:33:30,717 reid_baseline.train INFO: Accuracy: 67.3%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 10:34:40,583 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.163, Loss2: 1.468, Loss3: 0.760,  Acc: 0.966, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 6.04e-04
2022-05-09 10:35:10,820 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.699[s] Speed: 22.9[samples/s]
2022-05-09 10:37:13,777 reid_baseline.train INFO: normal accuracy 0.6857400315386348 0.6460269093513489 
2022-05-09 10:37:14,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 10:37:14,559 reid_baseline.train INFO: Accuracy: 68.6%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:38:21,453 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.159, Loss2: 1.428, Loss3: 0.732,  Acc: 0.968, Acc2: 0.768, Acc2_pse: 0.768, Base Lr: 4.51e-04
2022-05-09 10:38:50,440 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.670[s] Speed: 23.9[samples/s]
2022-05-09 10:40:57,158 reid_baseline.train INFO: normal accuracy 0.6713223699031313 0.6137708425521851 
2022-05-09 10:40:57,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 10:40:57,159 reid_baseline.train INFO: Accuracy: 67.1%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:42:06,052 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.160, Loss2: 1.435, Loss3: 0.716,  Acc: 0.965, Acc2: 0.756, Acc2_pse: 0.756, Base Lr: 3.20e-04
2022-05-09 10:42:34,004 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-09 10:44:39,674 reid_baseline.train INFO: normal accuracy 0.6738004054967335 0.6130786538124084 
2022-05-09 10:44:39,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 10:44:39,674 reid_baseline.train INFO: Accuracy: 67.4%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:45:46,362 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.171, Loss2: 1.441, Loss3: 0.703,  Acc: 0.965, Acc2: 0.762, Acc2_pse: 0.762, Base Lr: 2.11e-04
2022-05-09 10:46:14,520 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 10:48:19,323 reid_baseline.train INFO: normal accuracy 0.6728993016445145 0.6259215474128723 
2022-05-09 10:48:19,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 10:48:19,323 reid_baseline.train INFO: Accuracy: 67.3%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:49:28,166 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.160, Loss2: 1.469, Loss3: 0.764,  Acc: 0.968, Acc2: 0.755, Acc2_pse: 0.755, Base Lr: 1.26e-04
2022-05-09 10:49:56,252 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.682[s] Speed: 23.4[samples/s]
2022-05-09 10:52:01,126 reid_baseline.train INFO: normal accuracy 0.6697454381617481 0.5714002251625061 
2022-05-09 10:52:01,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 10:52:01,126 reid_baseline.train INFO: Accuracy: 67.0%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:53:11,070 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.156, Loss2: 1.412, Loss3: 0.679,  Acc: 0.971, Acc2: 0.779, Acc2_pse: 0.779, Base Lr: 6.51e-05
2022-05-09 10:53:39,951 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.681[s] Speed: 23.5[samples/s]
2022-05-09 10:55:40,156 reid_baseline.train INFO: normal accuracy 0.6749267853120072 0.6161720156669617 
2022-05-09 10:55:40,156 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 10:55:40,157 reid_baseline.train INFO: Accuracy: 67.5%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 10:56:50,839 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.154, Loss2: 1.438, Loss3: 0.728,  Acc: 0.971, Acc2: 0.760, Acc2_pse: 0.760, Base Lr: 2.83e-05
2022-05-09 10:57:18,824 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 10:59:21,569 reid_baseline.train INFO: normal accuracy 0.6620860554178869 0.5858138203620911 
2022-05-09 10:59:21,569 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 10:59:21,569 reid_baseline.train INFO: Accuracy: 66.2%, best Accuracy: 68.6%, min Mean_entropy: 0.6
2022-05-09 11:00:29,383 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.158, Loss2: 1.405, Loss3: 0.733,  Acc: 0.971, Acc2: 0.774, Acc2_pse: 0.774, Base Lr: 1.60e-05
2022-05-09 11:00:58,784 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.670[s] Speed: 23.9[samples/s]
2022-05-09 11:03:03,399 reid_baseline.train INFO: normal accuracy 0.6650146429375986 0.5779942274093628 
2022-05-09 11:03:03,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 11:03:03,399 reid_baseline.train INFO: Accuracy: 66.5%, best Accuracy: 68.6%, min Mean_entropy: 0.6
best model preformance is 0.6857400315386348
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ProductDRI_0.2/transformer_best_model.pth
2022-05-09 11:05:05,610 reid_baseline.train INFO: normal accuracy 0.6857400315386348 0.6460269093513489 
2022-05-09 11:05:05,610 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 11:05:05,610 reid_baseline.train INFO: Accuracy: 68.6%
2022-05-09 11:06:49,757 reid_baseline.train INFO: normal accuracy 0.9283065512978986 0.21227282285690308 
2022-05-09 11:06:49,757 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 11:06:49,757 reid_baseline.train INFO: Accuracy: 92.8%
2022-05-09 11:06:55,070 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.2
2022-05-09 11:06:55,070 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=0.2)
2022-05-09 11:06:55,070 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 11:06:55,070 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 11:06:55,071 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Real_World.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Real_World and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4357 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 11:07:03,478 reid_baseline.train INFO: start training
2022-05-09 11:08:13,592 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.424, Loss2: 4.148, Loss3: 4.174,  Acc: 0.388, Acc2: 0.168, Acc2_pse: 0.168, Base Lr: 8.72e-04
2022-05-09 11:08:45,369 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.697[s] Speed: 23.0[samples/s]
2022-05-09 11:14:33,705 reid_baseline.train INFO: normal accuracy 0.5563461097085151 4.172342777252197 
2022-05-09 11:14:34,416 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 11:14:34,417 reid_baseline.train INFO: Accuracy: 55.6%, best Accuracy: 55.6%, min Mean_entropy: 4e+00
2022-05-09 11:15:44,892 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 1.053, Loss2: 3.987, Loss3: 4.171,  Acc: 0.624, Acc2: 0.424, Acc2_pse: 0.424, Base Lr: 1.66e-03
2022-05-09 11:16:14,824 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 11:22:09,012 reid_baseline.train INFO: normal accuracy 0.590084920817076 4.157988548278809 
2022-05-09 11:22:09,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 11:22:09,764 reid_baseline.train INFO: Accuracy: 59.0%, best Accuracy: 59.0%, min Mean_entropy: 4e+00
2022-05-09 11:23:18,907 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.727, Loss2: 3.705, Loss3: 4.151,  Acc: 0.797, Acc2: 0.457, Acc2_pse: 0.457, Base Lr: 2.46e-03
2022-05-09 11:23:47,291 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 11:29:42,700 reid_baseline.train INFO: normal accuracy 0.6075281156759238 4.0058722496032715 
2022-05-09 11:29:43,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 11:29:43,511 reid_baseline.train INFO: Accuracy: 60.8%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 11:30:53,078 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.579, Loss2: 3.192, Loss3: 3.929,  Acc: 0.842, Acc2: 0.441, Acc2_pse: 0.441, Base Lr: 3.25e-03
2022-05-09 11:31:22,704 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-09 11:37:17,502 reid_baseline.train INFO: normal accuracy 0.52742712875832 3.1768176555633545 
2022-05-09 11:37:17,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 11:37:17,502 reid_baseline.train INFO: Accuracy: 52.7%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 11:38:24,777 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.547, Loss2: 2.852, Loss3: 3.127,  Acc: 0.856, Acc2: 0.388, Acc2_pse: 0.388, Base Lr: 4.04e-03
2022-05-09 11:38:53,740 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.658[s] Speed: 24.3[samples/s]
2022-05-09 11:44:37,215 reid_baseline.train INFO: normal accuracy 0.4741794812944687 2.106053590774536 
2022-05-09 11:44:37,215 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 11:44:37,215 reid_baseline.train INFO: Accuracy: 47.4%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 11:45:46,635 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.506, Loss2: 2.814, Loss3: 2.344,  Acc: 0.846, Acc2: 0.385, Acc2_pse: 0.385, Base Lr: 4.83e-03
2022-05-09 11:46:14,317 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 11:51:54,609 reid_baseline.train INFO: normal accuracy 0.49277025476245123 1.64385187625885 
2022-05-09 11:51:54,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 11:51:54,609 reid_baseline.train INFO: Accuracy: 49.3%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 11:53:02,244 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.437, Loss2: 2.680, Loss3: 1.884,  Acc: 0.894, Acc2: 0.421, Acc2_pse: 0.421, Base Lr: 5.62e-03
2022-05-09 11:53:30,581 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.671[s] Speed: 23.8[samples/s]
2022-05-09 11:59:21,467 reid_baseline.train INFO: normal accuracy 0.54395226072986 1.4368153810501099 
2022-05-09 11:59:21,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 11:59:21,468 reid_baseline.train INFO: Accuracy: 54.4%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 12:00:30,404 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.397, Loss2: 2.476, Loss3: 1.612,  Acc: 0.887, Acc2: 0.475, Acc2_pse: 0.475, Base Lr: 6.42e-03
2022-05-09 12:01:00,662 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-09 12:06:58,354 reid_baseline.train INFO: normal accuracy 0.5831994491622676 1.273836612701416 
2022-05-09 12:06:58,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 12:06:58,354 reid_baseline.train INFO: Accuracy: 58.3%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 12:08:07,518 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.333, Loss2: 2.361, Loss3: 1.439,  Acc: 0.917, Acc2: 0.485, Acc2_pse: 0.485, Base Lr: 7.21e-03
2022-05-09 12:08:38,753 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-09 12:14:25,546 reid_baseline.train INFO: normal accuracy 0.5831994491622676 1.0348386764526367 
2022-05-09 12:14:25,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 12:14:25,547 reid_baseline.train INFO: Accuracy: 58.3%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 12:15:36,007 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.331, Loss2: 2.266, Loss3: 1.225,  Acc: 0.908, Acc2: 0.538, Acc2_pse: 0.538, Base Lr: 6.83e-03
2022-05-09 12:16:05,493 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.698[s] Speed: 22.9[samples/s]
2022-05-09 12:21:59,882 reid_baseline.train INFO: normal accuracy 0.6056919899013082 0.8603307604789734 
2022-05-09 12:21:59,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 12:21:59,883 reid_baseline.train INFO: Accuracy: 60.6%, best Accuracy: 60.8%, min Mean_entropy: 4e+00
2022-05-09 12:23:06,500 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.280, Loss2: 2.202, Loss3: 1.143,  Acc: 0.931, Acc2: 0.548, Acc2_pse: 0.548, Base Lr: 6.60e-03
2022-05-09 12:23:36,142 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.663[s] Speed: 24.1[samples/s]
2022-05-09 12:29:33,275 reid_baseline.train INFO: normal accuracy 0.6240532476474638 0.8681139349937439 
2022-05-09 12:29:34,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 12:29:34,036 reid_baseline.train INFO: Accuracy: 62.4%, best Accuracy: 62.4%, min Mean_entropy: 0.9
2022-05-09 12:30:42,444 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.252, Loss2: 2.090, Loss3: 1.065,  Acc: 0.940, Acc2: 0.571, Acc2_pse: 0.571, Base Lr: 6.35e-03
2022-05-09 12:31:14,126 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.694[s] Speed: 23.0[samples/s]
2022-05-09 12:36:54,958 reid_baseline.train INFO: normal accuracy 0.6600872159742942 0.8227115869522095 
2022-05-09 12:36:55,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 12:36:55,840 reid_baseline.train INFO: Accuracy: 66.0%, best Accuracy: 66.0%, min Mean_entropy: 0.8
2022-05-09 12:38:04,807 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.239, Loss2: 1.980, Loss3: 1.025,  Acc: 0.940, Acc2: 0.590, Acc2_pse: 0.590, Base Lr: 6.09e-03
2022-05-09 12:38:35,672 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 12:44:26,231 reid_baseline.train INFO: normal accuracy 0.6704154234565067 0.7562806010246277 
2022-05-09 12:44:26,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 12:44:26,995 reid_baseline.train INFO: Accuracy: 67.0%, best Accuracy: 67.0%, min Mean_entropy: 0.8
2022-05-09 12:45:37,165 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.222, Loss2: 1.891, Loss3: 0.974,  Acc: 0.949, Acc2: 0.621, Acc2_pse: 0.621, Base Lr: 5.82e-03
2022-05-09 12:46:06,828 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 12:52:06,377 reid_baseline.train INFO: normal accuracy 0.6782189579986229 0.7322506308555603 
2022-05-09 12:52:07,154 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 12:52:07,154 reid_baseline.train INFO: Accuracy: 67.8%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 12:53:14,735 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.231, Loss2: 1.883, Loss3: 0.982,  Acc: 0.938, Acc2: 0.633, Acc2_pse: 0.633, Base Lr: 5.54e-03
2022-05-09 12:53:44,322 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.679[s] Speed: 23.6[samples/s]
2022-05-09 12:59:33,748 reid_baseline.train INFO: normal accuracy 0.6740876750057379 0.6225816607475281 
2022-05-09 12:59:33,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 12:59:33,749 reid_baseline.train INFO: Accuracy: 67.4%, best Accuracy: 67.8%, min Mean_entropy: 0.7
2022-05-09 13:00:42,376 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.206, Loss2: 1.812, Loss3: 0.944,  Acc: 0.950, Acc2: 0.639, Acc2_pse: 0.639, Base Lr: 5.24e-03
2022-05-09 13:01:10,158 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.669[s] Speed: 23.9[samples/s]
2022-05-09 13:06:53,486 reid_baseline.train INFO: normal accuracy 0.7229745237548773 0.6714423894882202 
2022-05-09 13:06:54,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 13:06:54,297 reid_baseline.train INFO: Accuracy: 72.3%, best Accuracy: 72.3%, min Mean_entropy: 0.7
2022-05-09 13:08:04,813 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.189, Loss2: 1.789, Loss3: 0.934,  Acc: 0.953, Acc2: 0.651, Acc2_pse: 0.651, Base Lr: 4.94e-03
2022-05-09 13:08:36,333 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.703[s] Speed: 22.7[samples/s]
2022-05-09 13:14:25,753 reid_baseline.train INFO: normal accuracy 0.694285058526509 0.5983835458755493 
2022-05-09 13:14:25,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 13:14:25,754 reid_baseline.train INFO: Accuracy: 69.4%, best Accuracy: 72.3%, min Mean_entropy: 0.7
2022-05-09 13:15:36,779 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.199, Loss2: 1.719, Loss3: 0.881,  Acc: 0.950, Acc2: 0.669, Acc2_pse: 0.669, Base Lr: 4.63e-03
2022-05-09 13:16:06,157 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-09 13:21:45,725 reid_baseline.train INFO: normal accuracy 0.7300895111315125 0.6177448630332947 
2022-05-09 13:21:46,496 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 13:21:46,497 reid_baseline.train INFO: Accuracy: 73.0%, best Accuracy: 73.0%, min Mean_entropy: 0.6
2022-05-09 13:22:57,626 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.193, Loss2: 1.712, Loss3: 0.879,  Acc: 0.954, Acc2: 0.670, Acc2_pse: 0.670, Base Lr: 4.32e-03
2022-05-09 13:23:26,816 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.701[s] Speed: 22.8[samples/s]
2022-05-09 13:29:21,396 reid_baseline.train INFO: normal accuracy 0.707137938948818 0.5578970313072205 
2022-05-09 13:29:21,396 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 13:29:21,396 reid_baseline.train INFO: Accuracy: 70.7%, best Accuracy: 73.0%, min Mean_entropy: 0.6
2022-05-09 13:30:30,714 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.198, Loss2: 1.632, Loss3: 0.825,  Acc: 0.952, Acc2: 0.695, Acc2_pse: 0.695, Base Lr: 4.01e-03
2022-05-09 13:31:00,745 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-09 13:36:52,226 reid_baseline.train INFO: normal accuracy 0.7376635299518017 0.5662455558776855 
2022-05-09 13:36:53,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 13:36:53,013 reid_baseline.train INFO: Accuracy: 73.8%, best Accuracy: 73.8%, min Mean_entropy: 0.6
2022-05-09 13:38:00,882 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.176, Loss2: 1.651, Loss3: 0.866,  Acc: 0.962, Acc2: 0.696, Acc2_pse: 0.696, Base Lr: 3.69e-03
2022-05-09 13:38:30,068 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.665[s] Speed: 24.1[samples/s]
2022-05-09 13:44:27,447 reid_baseline.train INFO: normal accuracy 0.7316961211843012 0.5356270670890808 
2022-05-09 13:44:27,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 13:44:27,448 reid_baseline.train INFO: Accuracy: 73.2%, best Accuracy: 73.8%, min Mean_entropy: 0.6
2022-05-09 13:45:36,386 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.174, Loss2: 1.593, Loss3: 0.834,  Acc: 0.963, Acc2: 0.701, Acc2_pse: 0.701, Base Lr: 3.38e-03
2022-05-09 13:46:06,028 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 13:51:54,771 reid_baseline.train INFO: normal accuracy 0.7316961211843012 0.4977527856826782 
2022-05-09 13:51:54,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 13:51:54,772 reid_baseline.train INFO: Accuracy: 73.2%, best Accuracy: 73.8%, min Mean_entropy: 0.6
2022-05-09 13:53:05,037 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.178, Loss2: 1.551, Loss3: 0.789,  Acc: 0.966, Acc2: 0.732, Acc2_pse: 0.732, Base Lr: 3.08e-03
2022-05-09 13:53:34,236 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 13:59:19,847 reid_baseline.train INFO: normal accuracy 0.7452375487720909 0.5074654221534729 
2022-05-09 13:59:20,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 13:59:20,615 reid_baseline.train INFO: Accuracy: 74.5%, best Accuracy: 74.5%, min Mean_entropy: 0.5
2022-05-09 14:00:30,522 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.165, Loss2: 1.538, Loss3: 0.813,  Acc: 0.970, Acc2: 0.728, Acc2_pse: 0.728, Base Lr: 2.77e-03
2022-05-09 14:01:00,052 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 14:06:49,601 reid_baseline.train INFO: normal accuracy 0.7314666054624742 0.49175360798835754 
2022-05-09 14:06:49,601 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 14:06:49,601 reid_baseline.train INFO: Accuracy: 73.1%, best Accuracy: 74.5%, min Mean_entropy: 0.5
2022-05-09 14:07:57,864 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.166, Loss2: 1.538, Loss3: 0.839,  Acc: 0.965, Acc2: 0.738, Acc2_pse: 0.738, Base Lr: 2.48e-03
2022-05-09 14:08:27,879 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.677[s] Speed: 23.6[samples/s]
2022-05-09 14:14:12,227 reid_baseline.train INFO: normal accuracy 0.7355978884553592 0.4659329354763031 
2022-05-09 14:14:12,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 14:14:12,227 reid_baseline.train INFO: Accuracy: 73.6%, best Accuracy: 74.5%, min Mean_entropy: 0.5
2022-05-09 14:15:21,205 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.188, Loss2: 1.488, Loss3: 0.793,  Acc: 0.955, Acc2: 0.737, Acc2_pse: 0.737, Base Lr: 2.20e-03
2022-05-09 14:15:50,578 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.682[s] Speed: 23.5[samples/s]
2022-05-09 14:21:41,719 reid_baseline.train INFO: normal accuracy 0.7578609134725729 0.4960261583328247 
2022-05-09 14:21:42,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 14:21:42,524 reid_baseline.train INFO: Accuracy: 75.8%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 14:22:51,541 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.175, Loss2: 1.494, Loss3: 0.759,  Acc: 0.959, Acc2: 0.747, Acc2_pse: 0.747, Base Lr: 1.92e-03
2022-05-09 14:23:23,078 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-05-09 14:29:21,698 reid_baseline.train INFO: normal accuracy 0.7525820518705532 0.5113767981529236 
2022-05-09 14:29:21,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 14:29:21,699 reid_baseline.train INFO: Accuracy: 75.3%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 14:30:31,238 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.173, Loss2: 1.442, Loss3: 0.801,  Acc: 0.964, Acc2: 0.765, Acc2_pse: 0.765, Base Lr: 1.66e-03
2022-05-09 14:31:00,203 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 14:36:43,572 reid_baseline.train INFO: normal accuracy 0.740647234335552 0.46056610345840454 
2022-05-09 14:36:43,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 14:36:43,573 reid_baseline.train INFO: Accuracy: 74.1%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 14:37:54,824 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.171, Loss2: 1.483, Loss3: 0.701,  Acc: 0.962, Acc2: 0.754, Acc2_pse: 0.754, Base Lr: 1.42e-03
2022-05-09 14:38:25,064 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.709[s] Speed: 22.6[samples/s]
2022-05-09 14:44:19,048 reid_baseline.train INFO: normal accuracy 0.7541886619233418 0.46383994817733765 
2022-05-09 14:44:19,049 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 14:44:19,049 reid_baseline.train INFO: Accuracy: 75.4%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 14:45:30,346 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.178, Loss2: 1.469, Loss3: 0.750,  Acc: 0.964, Acc2: 0.744, Acc2_pse: 0.744, Base Lr: 1.19e-03
2022-05-09 14:46:00,741 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.700[s] Speed: 22.9[samples/s]
2022-05-09 14:51:54,969 reid_baseline.train INFO: normal accuracy 0.7509754418177645 0.49597954750061035 
2022-05-09 14:51:54,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 14:51:54,969 reid_baseline.train INFO: Accuracy: 75.1%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 14:53:03,765 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.157, Loss2: 1.447, Loss3: 0.760,  Acc: 0.970, Acc2: 0.753, Acc2_pse: 0.753, Base Lr: 9.72e-04
2022-05-09 14:53:36,751 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.701[s] Speed: 22.8[samples/s]
2022-05-09 14:59:27,819 reid_baseline.train INFO: normal accuracy 0.7445490016066101 0.4418722987174988 
2022-05-09 14:59:27,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 14:59:27,820 reid_baseline.train INFO: Accuracy: 74.5%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 15:00:38,396 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.159, Loss2: 1.462, Loss3: 0.716,  Acc: 0.968, Acc2: 0.753, Acc2_pse: 0.753, Base Lr: 7.78e-04
2022-05-09 15:01:07,566 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 15:06:59,403 reid_baseline.train INFO: normal accuracy 0.757631397750746 0.47274646162986755 
2022-05-09 15:06:59,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 15:06:59,403 reid_baseline.train INFO: Accuracy: 75.8%, best Accuracy: 75.8%, min Mean_entropy: 0.5
2022-05-09 15:08:10,021 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.160, Loss2: 1.472, Loss3: 0.755,  Acc: 0.967, Acc2: 0.750, Acc2_pse: 0.750, Base Lr: 6.04e-04
2022-05-09 15:08:39,474 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.699[s] Speed: 22.9[samples/s]
2022-05-09 15:14:37,998 reid_baseline.train INFO: normal accuracy 0.7691071838420932 0.4862488806247711 
2022-05-09 15:14:38,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 15:14:38,780 reid_baseline.train INFO: Accuracy: 76.9%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:15:46,807 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.158, Loss2: 1.430, Loss3: 0.722,  Acc: 0.967, Acc2: 0.762, Acc2_pse: 0.762, Base Lr: 4.51e-04
2022-05-09 15:16:15,163 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-09 15:22:22,788 reid_baseline.train INFO: normal accuracy 0.7544181776451687 0.46297892928123474 
2022-05-09 15:22:22,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 15:22:22,788 reid_baseline.train INFO: Accuracy: 75.4%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:23:34,127 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.162, Loss2: 1.434, Loss3: 0.715,  Acc: 0.965, Acc2: 0.756, Acc2_pse: 0.756, Base Lr: 3.20e-04
2022-05-09 15:24:02,822 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 15:29:56,653 reid_baseline.train INFO: normal accuracy 0.761533165021804 0.46761512756347656 
2022-05-09 15:29:56,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 15:29:56,653 reid_baseline.train INFO: Accuracy: 76.2%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:31:04,855 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.169, Loss2: 1.438, Loss3: 0.711,  Acc: 0.963, Acc2: 0.756, Acc2_pse: 0.756, Base Lr: 2.11e-04
2022-05-09 15:31:33,331 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.685[s] Speed: 23.4[samples/s]
2022-05-09 15:37:39,162 reid_baseline.train INFO: normal accuracy 0.7606151021344962 0.47324231266975403 
2022-05-09 15:37:39,162 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 15:37:39,162 reid_baseline.train INFO: Accuracy: 76.1%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:38:48,522 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.158, Loss2: 1.471, Loss3: 0.758,  Acc: 0.971, Acc2: 0.750, Acc2_pse: 0.750, Base Lr: 1.26e-04
2022-05-09 15:39:17,215 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-09 15:45:13,997 reid_baseline.train INFO: normal accuracy 0.7567133348634382 0.43257299065589905 
2022-05-09 15:45:13,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 15:45:13,997 reid_baseline.train INFO: Accuracy: 75.7%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:46:23,995 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.157, Loss2: 1.414, Loss3: 0.673,  Acc: 0.969, Acc2: 0.775, Acc2_pse: 0.775, Base Lr: 6.51e-05
2022-05-09 15:46:53,168 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 15:52:40,416 reid_baseline.train INFO: normal accuracy 0.7537296304796879 0.46612748503685 
2022-05-09 15:52:40,416 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 15:52:40,416 reid_baseline.train INFO: Accuracy: 75.4%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 15:53:51,000 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.153, Loss2: 1.439, Loss3: 0.724,  Acc: 0.971, Acc2: 0.763, Acc2_pse: 0.763, Base Lr: 2.83e-05
2022-05-09 15:54:18,284 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.674[s] Speed: 23.8[samples/s]
2022-05-09 16:00:05,532 reid_baseline.train INFO: normal accuracy 0.748909800321322 0.44414547085762024 
2022-05-09 16:00:05,532 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 16:00:05,533 reid_baseline.train INFO: Accuracy: 74.9%, best Accuracy: 76.9%, min Mean_entropy: 0.5
2022-05-09 16:01:13,808 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.158, Loss2: 1.400, Loss3: 0.732,  Acc: 0.971, Acc2: 0.777, Acc2_pse: 0.777, Base Lr: 1.60e-05
2022-05-09 16:01:43,565 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-09 16:07:29,718 reid_baseline.train INFO: normal accuracy 0.7484507688776681 0.4368698298931122 
2022-05-09 16:07:29,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 16:07:29,719 reid_baseline.train INFO: Accuracy: 74.8%, best Accuracy: 76.9%, min Mean_entropy: 0.5
best model preformance is 0.7691071838420932
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_0.2/transformer_best_model.pth
2022-05-09 16:13:17,771 reid_baseline.train INFO: normal accuracy 0.7691071838420932 0.4862488806247711 
2022-05-09 16:13:17,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 16:13:17,771 reid_baseline.train INFO: Accuracy: 76.9%
2022-05-09 16:15:03,483 reid_baseline.train INFO: normal accuracy 0.9266584260403791 0.20995217561721802 
2022-05-09 16:15:03,483 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 16:15:03,483 reid_baseline.train INFO: Accuracy: 92.7%
2022-05-09 16:15:08,857 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0
2022-05-09 16:15:08,857 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=1.0)
2022-05-09 16:15:08,857 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 16:15:08,857 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 16:15:08,857 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Clipart.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 16:15:16,722 reid_baseline.train INFO: start training
2022-05-09 16:16:26,958 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.293, Loss2: 4.160, Loss3: 4.174,  Acc: 0.475, Acc2: 0.090, Acc2_pse: 0.090, Base Lr: 8.72e-04
2022-05-09 16:16:58,639 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-05-09 16:18:57,287 reid_baseline.train INFO: normal accuracy 0.2849942726231386 4.173048496246338 
2022-05-09 16:18:58,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 16:18:58,055 reid_baseline.train INFO: Accuracy: 28.5%, best Accuracy: 28.5%, min Mean_entropy: 4e+00
2022-05-09 16:20:08,317 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 0.652, Loss2: 4.074, Loss3: 4.173,  Acc: 0.814, Acc2: 0.378, Acc2_pse: 0.378, Base Lr: 1.66e-03
2022-05-09 16:20:38,443 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.692[s] Speed: 23.1[samples/s]
2022-05-09 16:22:38,758 reid_baseline.train INFO: normal accuracy 0.33722794959908364 4.169177055358887 
2022-05-09 16:22:39,537 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 16:22:39,537 reid_baseline.train INFO: Accuracy: 33.7%, best Accuracy: 33.7%, min Mean_entropy: 4e+00
2022-05-09 16:23:49,299 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.313, Loss2: 3.906, Loss3: 4.168,  Acc: 0.933, Acc2: 0.418, Acc2_pse: 0.418, Base Lr: 2.46e-03
2022-05-09 16:24:18,676 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-09 16:26:17,463 reid_baseline.train INFO: normal accuracy 0.3958762886597938 4.147492408752441 
2022-05-09 16:26:18,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 16:26:18,238 reid_baseline.train INFO: Accuracy: 39.6%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:27:27,371 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.205, Loss2: 3.559, Loss3: 4.118,  Acc: 0.951, Acc2: 0.426, Acc2_pse: 0.426, Base Lr: 3.25e-03
2022-05-09 16:27:56,042 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.674[s] Speed: 23.7[samples/s]
2022-05-09 16:29:56,551 reid_baseline.train INFO: normal accuracy 0.33012600229095074 3.9435062408447266 
2022-05-09 16:29:56,551 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 16:29:56,552 reid_baseline.train INFO: Accuracy: 33.0%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:31:02,928 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.190, Loss2: 3.092, Loss3: 3.708,  Acc: 0.962, Acc2: 0.392, Acc2_pse: 0.392, Base Lr: 4.04e-03
2022-05-09 16:31:33,128 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-09 16:33:34,081 reid_baseline.train INFO: normal accuracy 0.31844215349369986 2.9461050033569336 
2022-05-09 16:33:34,081 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 16:33:34,081 reid_baseline.train INFO: Accuracy: 31.8%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:34:43,930 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.182, Loss2: 2.942, Loss3: 2.795,  Acc: 0.965, Acc2: 0.342, Acc2_pse: 0.342, Base Lr: 4.83e-03
2022-05-09 16:35:11,738 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.687[s] Speed: 23.3[samples/s]
2022-05-09 16:37:11,683 reid_baseline.train INFO: normal accuracy 0.3042382588774341 2.1881558895111084 
2022-05-09 16:37:11,683 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 16:37:11,683 reid_baseline.train INFO: Accuracy: 30.4%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:38:19,176 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.171, Loss2: 2.865, Loss3: 2.160,  Acc: 0.964, Acc2: 0.369, Acc2_pse: 0.369, Base Lr: 5.62e-03
2022-05-09 16:38:47,764 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-09 16:40:47,348 reid_baseline.train INFO: normal accuracy 0.3347079037800687 1.935161828994751 
2022-05-09 16:40:47,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 16:40:47,348 reid_baseline.train INFO: Accuracy: 33.5%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:41:57,044 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.176, Loss2: 2.667, Loss3: 1.748,  Acc: 0.960, Acc2: 0.428, Acc2_pse: 0.428, Base Lr: 6.42e-03
2022-05-09 16:42:26,346 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-09 16:44:22,562 reid_baseline.train INFO: normal accuracy 0.3532646048109966 1.693613886833191 
2022-05-09 16:44:22,563 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 16:44:22,563 reid_baseline.train INFO: Accuracy: 35.3%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:45:32,703 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.137, Loss2: 2.543, Loss3: 1.553,  Acc: 0.977, Acc2: 0.438, Acc2_pse: 0.438, Base Lr: 7.21e-03
2022-05-09 16:46:04,945 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.701[s] Speed: 22.8[samples/s]
2022-05-09 16:48:04,512 reid_baseline.train INFO: normal accuracy 0.3835051546391753 1.4858388900756836 
2022-05-09 16:48:04,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 16:48:04,513 reid_baseline.train INFO: Accuracy: 38.4%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:49:14,803 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.147, Loss2: 2.415, Loss3: 1.300,  Acc: 0.971, Acc2: 0.490, Acc2_pse: 0.490, Base Lr: 6.83e-03
2022-05-09 16:49:44,169 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.697[s] Speed: 23.0[samples/s]
2022-05-09 16:51:46,219 reid_baseline.train INFO: normal accuracy 0.3766323024054983 1.2450660467147827 
2022-05-09 16:51:46,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 16:51:46,220 reid_baseline.train INFO: Accuracy: 37.7%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:52:52,671 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.135, Loss2: 2.342, Loss3: 1.220,  Acc: 0.974, Acc2: 0.506, Acc2_pse: 0.506, Base Lr: 6.60e-03
2022-05-09 16:53:22,490 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.663[s] Speed: 24.1[samples/s]
2022-05-09 16:55:20,875 reid_baseline.train INFO: normal accuracy 0.38648339060710196 1.2094281911849976 
2022-05-09 16:55:20,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 16:55:20,876 reid_baseline.train INFO: Accuracy: 38.6%, best Accuracy: 39.6%, min Mean_entropy: 4e+00
2022-05-09 16:56:29,319 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.142, Loss2: 2.221, Loss3: 1.125,  Acc: 0.973, Acc2: 0.528, Acc2_pse: 0.528, Base Lr: 6.35e-03
2022-05-09 16:57:00,759 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.694[s] Speed: 23.1[samples/s]
2022-05-09 16:58:57,761 reid_baseline.train INFO: normal accuracy 0.4148911798396335 1.2243903875350952 
2022-05-09 16:58:58,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 16:58:58,572 reid_baseline.train INFO: Accuracy: 41.5%, best Accuracy: 41.5%, min Mean_entropy: 1e+00
2022-05-09 17:00:08,100 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.132, Loss2: 2.141, Loss3: 1.045,  Acc: 0.982, Acc2: 0.541, Acc2_pse: 0.541, Base Lr: 6.09e-03
2022-05-09 17:00:39,439 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.700[s] Speed: 22.9[samples/s]
2022-05-09 17:02:40,734 reid_baseline.train INFO: normal accuracy 0.4311569301260023 1.1641701459884644 
2022-05-09 17:02:41,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 17:02:41,479 reid_baseline.train INFO: Accuracy: 43.1%, best Accuracy: 43.1%, min Mean_entropy: 1e+00
2022-05-09 17:03:51,408 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.121, Loss2: 2.029, Loss3: 1.027,  Acc: 0.982, Acc2: 0.571, Acc2_pse: 0.571, Base Lr: 5.82e-03
2022-05-09 17:04:20,676 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.688[s] Speed: 23.2[samples/s]
2022-05-09 17:06:18,525 reid_baseline.train INFO: normal accuracy 0.43871706758304696 1.1018760204315186 
2022-05-09 17:06:19,297 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 17:06:19,297 reid_baseline.train INFO: Accuracy: 43.9%, best Accuracy: 43.9%, min Mean_entropy: 1e+00
2022-05-09 17:07:27,781 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.140, Loss2: 2.013, Loss3: 1.024,  Acc: 0.972, Acc2: 0.585, Acc2_pse: 0.585, Base Lr: 5.54e-03
2022-05-09 17:07:57,463 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-09 17:09:53,157 reid_baseline.train INFO: normal accuracy 0.4306987399770905 0.9418599605560303 
2022-05-09 17:09:53,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 17:09:53,158 reid_baseline.train INFO: Accuracy: 43.1%, best Accuracy: 43.9%, min Mean_entropy: 1e+00
2022-05-09 17:11:01,088 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.133, Loss2: 1.945, Loss3: 0.958,  Acc: 0.977, Acc2: 0.601, Acc2_pse: 0.601, Base Lr: 5.24e-03
2022-05-09 17:11:28,430 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.662[s] Speed: 24.2[samples/s]
2022-05-09 17:13:27,371 reid_baseline.train INFO: normal accuracy 0.47262313860252003 1.0453681945800781 
2022-05-09 17:13:28,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 17:13:28,140 reid_baseline.train INFO: Accuracy: 47.3%, best Accuracy: 47.3%, min Mean_entropy: 1e+00
2022-05-09 17:14:37,984 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.120, Loss2: 1.924, Loss3: 0.952,  Acc: 0.982, Acc2: 0.603, Acc2_pse: 0.603, Base Lr: 4.94e-03
2022-05-09 17:15:09,398 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.698[s] Speed: 22.9[samples/s]
2022-05-09 17:17:09,991 reid_baseline.train INFO: normal accuracy 0.4536082474226804 0.9018063545227051 
2022-05-09 17:17:09,991 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 17:17:09,991 reid_baseline.train INFO: Accuracy: 45.4%, best Accuracy: 47.3%, min Mean_entropy: 1e+00
2022-05-09 17:18:22,204 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.125, Loss2: 1.833, Loss3: 0.907,  Acc: 0.979, Acc2: 0.621, Acc2_pse: 0.621, Base Lr: 4.63e-03
2022-05-09 17:18:52,225 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.700[s] Speed: 22.9[samples/s]
2022-05-09 17:20:51,823 reid_baseline.train INFO: normal accuracy 0.49049255441008016 0.9701153039932251 
2022-05-09 17:20:52,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 17:20:52,589 reid_baseline.train INFO: Accuracy: 49.0%, best Accuracy: 49.0%, min Mean_entropy: 1e+00
2022-05-09 17:22:04,079 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.116, Loss2: 1.840, Loss3: 0.920,  Acc: 0.983, Acc2: 0.626, Acc2_pse: 0.626, Base Lr: 4.32e-03
2022-05-09 17:22:33,560 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-05-09 17:24:33,514 reid_baseline.train INFO: normal accuracy 0.4641466208476518 0.8383232951164246 
2022-05-09 17:24:33,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 17:24:33,515 reid_baseline.train INFO: Accuracy: 46.4%, best Accuracy: 49.0%, min Mean_entropy: 1e+00
2022-05-09 17:25:41,734 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.119, Loss2: 1.753, Loss3: 0.866,  Acc: 0.982, Acc2: 0.637, Acc2_pse: 0.637, Base Lr: 4.01e-03
2022-05-09 17:26:10,964 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 17:28:11,023 reid_baseline.train INFO: normal accuracy 0.4950744558991982 0.9134499430656433 
2022-05-09 17:28:11,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 17:28:11,805 reid_baseline.train INFO: Accuracy: 49.5%, best Accuracy: 49.5%, min Mean_entropy: 0.9
2022-05-09 17:29:20,365 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.116, Loss2: 1.790, Loss3: 0.898,  Acc: 0.986, Acc2: 0.632, Acc2_pse: 0.632, Base Lr: 3.69e-03
2022-05-09 17:29:50,113 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-09 17:31:51,121 reid_baseline.train INFO: normal accuracy 0.4875143184421535 0.8734210133552551 
2022-05-09 17:31:51,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 17:31:51,122 reid_baseline.train INFO: Accuracy: 48.8%, best Accuracy: 49.5%, min Mean_entropy: 0.9
2022-05-09 17:32:59,542 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.111, Loss2: 1.734, Loss3: 0.848,  Acc: 0.982, Acc2: 0.652, Acc2_pse: 0.652, Base Lr: 3.38e-03
2022-05-09 17:33:28,499 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-09 17:35:31,329 reid_baseline.train INFO: normal accuracy 0.4882016036655212 0.8283905386924744 
2022-05-09 17:35:31,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 17:35:31,330 reid_baseline.train INFO: Accuracy: 48.8%, best Accuracy: 49.5%, min Mean_entropy: 0.9
2022-05-09 17:36:40,460 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.119, Loss2: 1.684, Loss3: 0.819,  Acc: 0.982, Acc2: 0.681, Acc2_pse: 0.681, Base Lr: 3.08e-03
2022-05-09 17:37:09,537 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.682[s] Speed: 23.5[samples/s]
2022-05-09 17:39:10,865 reid_baseline.train INFO: normal accuracy 0.5193585337915235 0.8679494261741638 
2022-05-09 17:39:11,675 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 17:39:11,676 reid_baseline.train INFO: Accuracy: 51.9%, best Accuracy: 51.9%, min Mean_entropy: 0.9
2022-05-09 17:40:20,292 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.108, Loss2: 1.671, Loss3: 0.848,  Acc: 0.989, Acc2: 0.680, Acc2_pse: 0.680, Base Lr: 2.77e-03
2022-05-09 17:40:48,892 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-09 17:42:49,651 reid_baseline.train INFO: normal accuracy 0.4831615120274914 0.7767588496208191 
2022-05-09 17:42:49,652 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 17:42:49,652 reid_baseline.train INFO: Accuracy: 48.3%, best Accuracy: 51.9%, min Mean_entropy: 0.9
2022-05-09 17:43:58,287 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.112, Loss2: 1.666, Loss3: 0.886,  Acc: 0.985, Acc2: 0.683, Acc2_pse: 0.683, Base Lr: 2.48e-03
2022-05-09 17:44:28,056 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.678[s] Speed: 23.6[samples/s]
2022-05-09 17:46:30,721 reid_baseline.train INFO: normal accuracy 0.4852233676975945 0.7660170197486877 
2022-05-09 17:46:30,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 17:46:30,721 reid_baseline.train INFO: Accuracy: 48.5%, best Accuracy: 51.9%, min Mean_entropy: 0.9
2022-05-09 17:47:40,604 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.117, Loss2: 1.623, Loss3: 0.831,  Acc: 0.980, Acc2: 0.688, Acc2_pse: 0.688, Base Lr: 2.20e-03
2022-05-09 17:48:09,975 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 17:50:07,471 reid_baseline.train INFO: normal accuracy 0.520504009163803 0.8470297455787659 
2022-05-09 17:50:08,325 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 17:50:08,325 reid_baseline.train INFO: Accuracy: 52.1%, best Accuracy: 52.1%, min Mean_entropy: 0.8
2022-05-09 17:51:17,211 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.111, Loss2: 1.619, Loss3: 0.797,  Acc: 0.986, Acc2: 0.690, Acc2_pse: 0.690, Base Lr: 1.92e-03
2022-05-09 17:51:47,628 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-09 17:53:48,318 reid_baseline.train INFO: normal accuracy 0.49896907216494846 0.8298079967498779 
2022-05-09 17:53:48,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 17:53:48,319 reid_baseline.train INFO: Accuracy: 49.9%, best Accuracy: 52.1%, min Mean_entropy: 0.8
2022-05-09 17:54:58,364 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.115, Loss2: 1.567, Loss3: 0.851,  Acc: 0.980, Acc2: 0.701, Acc2_pse: 0.701, Base Lr: 1.66e-03
2022-05-09 17:55:27,103 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-09 17:57:28,105 reid_baseline.train INFO: normal accuracy 0.4879725085910653 0.7524236440658569 
2022-05-09 17:57:28,105 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 17:57:28,105 reid_baseline.train INFO: Accuracy: 48.8%, best Accuracy: 52.1%, min Mean_entropy: 0.8
2022-05-09 17:58:39,389 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.111, Loss2: 1.587, Loss3: 0.771,  Acc: 0.984, Acc2: 0.711, Acc2_pse: 0.711, Base Lr: 1.42e-03
2022-05-09 17:59:09,297 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.707[s] Speed: 22.6[samples/s]
2022-05-09 18:01:07,002 reid_baseline.train INFO: normal accuracy 0.5053837342497136 0.7821494340896606 
2022-05-09 18:01:07,003 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 18:01:07,003 reid_baseline.train INFO: Accuracy: 50.5%, best Accuracy: 52.1%, min Mean_entropy: 0.8
2022-05-09 18:02:18,644 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.107, Loss2: 1.602, Loss3: 0.796,  Acc: 0.986, Acc2: 0.683, Acc2_pse: 0.683, Base Lr: 1.19e-03
2022-05-09 18:02:49,322 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-05-09 18:04:49,230 reid_baseline.train INFO: normal accuracy 0.5030927835051546 0.8310883641242981 
2022-05-09 18:04:49,230 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 18:04:49,230 reid_baseline.train INFO: Accuracy: 50.3%, best Accuracy: 52.1%, min Mean_entropy: 0.8
2022-05-09 18:05:58,208 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.105, Loss2: 1.567, Loss3: 0.797,  Acc: 0.987, Acc2: 0.698, Acc2_pse: 0.698, Base Lr: 9.72e-04
2022-05-09 18:06:31,233 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.703[s] Speed: 22.8[samples/s]
