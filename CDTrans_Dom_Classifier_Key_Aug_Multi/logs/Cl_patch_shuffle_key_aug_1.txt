2022-04-16 15:31:24,719 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1
2022-04-16 15:31:24,720 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-16 15:31:24,720 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 15:31:24,720 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 15:31:24,720 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 15:31:29,415 reid_baseline.train INFO: start training
2022-04-16 15:32:09,980 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.163, Base Lr: 4.76e-04
2022-04-16 15:32:50,055 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.295, Base Lr: 4.76e-04
2022-04-16 15:33:17,465 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-16 15:33:45,054 reid_baseline.train INFO: normal accuracy 0.4820766378244747 4.171695709228516 
2022-04-16 15:33:48,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 15:33:48,178 reid_baseline.train INFO: Accuracy: 48.2% Mean Entropy: 417.2%
2022-04-16 15:34:23,635 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.889, Acc: 0.559, Base Lr: 8.72e-04
2022-04-16 15:35:02,099 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.816, Acc: 0.547, Base Lr: 8.72e-04
2022-04-16 15:35:28,957 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.369[s] Speed: 43.3[samples/s]
2022-04-16 15:35:59,899 reid_baseline.train INFO: normal accuracy 0.523279769262464 4.152945041656494 
2022-04-16 15:36:03,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 15:36:03,024 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 415.3%
2022-04-16 15:36:45,047 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.387, Acc: 0.595, Base Lr: 1.27e-03
2022-04-16 15:37:22,301 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.278, Acc: 0.577, Base Lr: 1.27e-03
2022-04-16 15:37:49,699 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-16 15:38:15,752 reid_baseline.train INFO: normal accuracy 0.5525339925834364 4.013593673706055 
2022-04-16 15:38:18,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 15:38:18,875 reid_baseline.train INFO: Accuracy: 55.3% Mean Entropy: 401.4%
2022-04-16 15:38:54,804 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.728, Acc: 0.594, Base Lr: 1.66e-03
2022-04-16 15:39:31,345 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.612, Base Lr: 1.66e-03
2022-04-16 15:39:57,904 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-04-16 15:40:28,300 reid_baseline.train INFO: normal accuracy 0.6023897816234034 3.6229865550994873 
2022-04-16 15:40:33,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 15:40:33,669 reid_baseline.train INFO: Accuracy: 60.2% Mean Entropy: 362.3%
2022-04-16 15:41:11,759 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.184, Acc: 0.659, Base Lr: 2.06e-03
2022-04-16 15:41:48,367 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.112, Acc: 0.668, Base Lr: 2.06e-03
2022-04-16 15:42:17,164 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-16 15:42:44,025 reid_baseline.train INFO: normal accuracy 0.6522455706633704 3.1872122287750244 
2022-04-16 15:42:47,129 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 15:42:47,130 reid_baseline.train INFO: Accuracy: 65.2% Mean Entropy: 318.7%
2022-04-16 15:43:26,957 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.797, Acc: 0.731, Base Lr: 2.46e-03
2022-04-16 15:44:02,832 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.779, Acc: 0.737, Base Lr: 2.46e-03
2022-04-16 15:44:30,491 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.379[s] Speed: 42.3[samples/s]
2022-04-16 15:45:12,722 reid_baseline.train INFO: normal accuracy 0.6909765142150803 2.84145450592041 
2022-04-16 15:45:16,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 15:45:16,072 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 284.1%
2022-04-16 15:45:54,458 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.613, Acc: 0.774, Base Lr: 2.85e-03
2022-04-16 15:46:32,941 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.596, Acc: 0.765, Base Lr: 2.85e-03
2022-04-16 15:46:58,121 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.374[s] Speed: 42.8[samples/s]
2022-04-16 15:47:27,440 reid_baseline.train INFO: normal accuracy 0.7012772970745776 2.5709288120269775 
2022-04-16 15:47:32,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 15:47:32,682 reid_baseline.train INFO: Accuracy: 70.1% Mean Entropy: 257.1%
2022-04-16 15:48:12,528 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.457, Acc: 0.805, Base Lr: 3.25e-03
2022-04-16 15:48:50,473 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.457, Acc: 0.805, Base Lr: 3.25e-03
2022-04-16 15:49:17,038 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 15:49:44,770 reid_baseline.train INFO: normal accuracy 0.7198187062216729 2.3980748653411865 
2022-04-16 15:49:47,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 15:49:47,894 reid_baseline.train INFO: Accuracy: 72.0% Mean Entropy: 239.8%
2022-04-16 15:50:25,921 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.399, Acc: 0.817, Base Lr: 3.64e-03
2022-04-16 15:51:05,222 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.366, Acc: 0.824, Base Lr: 3.64e-03
2022-04-16 15:51:32,216 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 15:52:04,209 reid_baseline.train INFO: normal accuracy 0.7268232385661311 2.2833316326141357 
2022-04-16 15:52:07,415 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 15:52:07,415 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 228.3%
2022-04-16 15:52:45,812 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.302, Acc: 0.839, Base Lr: 4.04e-03
2022-04-16 15:53:24,812 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.313, Acc: 0.838, Base Lr: 4.04e-03
2022-04-16 15:53:54,324 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.392[s] Speed: 40.9[samples/s]
2022-04-16 15:54:27,409 reid_baseline.train INFO: normal accuracy 0.7317676143386898 2.1715164184570312 
2022-04-16 15:54:31,069 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 15:54:31,070 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 217.2%
2022-04-16 15:55:07,622 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.246, Acc: 0.868, Base Lr: 4.44e-03
2022-04-16 15:55:46,212 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.258, Acc: 0.860, Base Lr: 4.44e-03
2022-04-16 15:56:15,822 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.384[s] Speed: 41.7[samples/s]
2022-04-16 15:56:45,413 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.076578378677368 
2022-04-16 15:56:48,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 15:56:48,541 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 207.7%
2022-04-16 15:57:24,829 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.206, Acc: 0.869, Base Lr: 4.83e-03
2022-04-16 15:58:05,785 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.202, Acc: 0.868, Base Lr: 4.83e-03
2022-04-16 15:58:33,217 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.383[s] Speed: 41.7[samples/s]
2022-04-16 15:59:00,881 reid_baseline.train INFO: normal accuracy 0.7400082406262876 2.0110325813293457 
2022-04-16 15:59:04,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 15:59:04,016 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 201.1%
2022-04-16 15:59:41,949 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.138, Acc: 0.887, Base Lr: 5.23e-03
2022-04-16 16:00:21,091 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.156, Acc: 0.883, Base Lr: 5.23e-03
2022-04-16 16:00:50,546 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-16 16:01:18,935 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.0290873050689697 
2022-04-16 16:01:18,937 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 16:01:18,937 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 202.9%
2022-04-16 16:01:52,274 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.114, Acc: 0.891, Base Lr: 5.62e-03
2022-04-16 16:02:33,672 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.123, Acc: 0.892, Base Lr: 5.62e-03
2022-04-16 16:03:02,036 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.378[s] Speed: 42.4[samples/s]
2022-04-16 16:03:28,996 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.9426189661026 
2022-04-16 16:03:32,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 16:03:32,119 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 194.3%
2022-04-16 16:04:12,955 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.078, Acc: 0.907, Base Lr: 6.02e-03
2022-04-16 16:04:52,647 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.092, Acc: 0.901, Base Lr: 6.02e-03
2022-04-16 16:05:22,583 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-16 16:05:50,778 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.9407734870910645 
2022-04-16 16:05:53,923 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 16:05:53,923 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 194.1%
2022-04-16 16:06:33,744 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.064, Acc: 0.906, Base Lr: 6.42e-03
2022-04-16 16:07:09,140 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.067, Acc: 0.912, Base Lr: 6.42e-03
2022-04-16 16:07:35,693 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-16 16:08:07,569 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.914987564086914 
2022-04-16 16:08:10,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 16:08:10,984 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 191.5%
2022-04-16 16:08:48,515 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.050, Acc: 0.918, Base Lr: 6.81e-03
2022-04-16 16:09:28,081 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.045, Acc: 0.917, Base Lr: 6.81e-03
2022-04-16 16:09:55,704 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.384[s] Speed: 41.7[samples/s]
2022-04-16 16:10:25,665 reid_baseline.train INFO: normal accuracy 0.7350638648537289 1.8490986824035645 
2022-04-16 16:10:28,826 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 16:10:28,826 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 184.9%
2022-04-16 16:11:05,659 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.026, Acc: 0.925, Base Lr: 7.21e-03
2022-04-16 16:11:43,779 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.028, Acc: 0.923, Base Lr: 7.21e-03
2022-04-16 16:12:10,500 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 16:12:39,039 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8259018659591675 
2022-04-16 16:12:42,209 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 16:12:42,211 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 182.6%
2022-04-16 16:13:21,222 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.023, Acc: 0.927, Base Lr: 7.60e-03
2022-04-16 16:14:00,336 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.014, Acc: 0.931, Base Lr: 7.60e-03
2022-04-16 16:14:28,955 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-16 16:14:57,579 reid_baseline.train INFO: normal accuracy 0.7354758961681088 1.8400344848632812 
2022-04-16 16:14:57,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 16:14:57,584 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 184.0%
2022-04-16 16:15:36,138 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.980, Acc: 0.939, Base Lr: 4.01e-03
2022-04-16 16:16:12,386 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.983, Acc: 0.939, Base Lr: 4.01e-03
2022-04-16 16:16:38,140 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.368[s] Speed: 43.4[samples/s]
2022-04-16 16:17:17,407 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.7818515300750732 
2022-04-16 16:17:20,504 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 16:17:20,505 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 178.2%
2022-04-16 16:18:00,241 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.962, Acc: 0.950, Base Lr: 3.69e-03
2022-04-16 16:18:41,190 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.960, Acc: 0.951, Base Lr: 3.69e-03
2022-04-16 16:19:10,479 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-16 16:19:40,645 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.7900850772857666 
2022-04-16 16:19:40,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 16:19:40,647 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 179.0%
2022-04-16 16:20:22,564 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.945, Acc: 0.952, Base Lr: 3.38e-03
2022-04-16 16:21:00,247 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.948, Acc: 0.949, Base Lr: 3.38e-03
2022-04-16 16:21:28,110 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 16:22:02,693 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.7865653038024902 
2022-04-16 16:22:02,698 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 16:22:02,698 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 178.7%
2022-04-16 16:22:35,130 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.941, Acc: 0.949, Base Lr: 3.08e-03
2022-04-16 16:23:06,010 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.957, Acc: 0.944, Base Lr: 3.08e-03
2022-04-16 16:23:29,986 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 16:24:00,833 reid_baseline.train INFO: normal accuracy 0.7428924598269468 1.7158454656600952 
2022-04-16 16:24:04,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 16:24:04,018 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 171.6%
2022-04-16 16:24:45,355 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.940, Acc: 0.951, Base Lr: 2.77e-03
2022-04-16 16:25:24,229 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.938, Acc: 0.950, Base Lr: 2.77e-03
2022-04-16 16:25:50,169 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.389[s] Speed: 41.2[samples/s]
2022-04-16 16:26:20,221 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8114063739776611 
2022-04-16 16:26:20,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 16:26:20,227 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 181.1%
2022-04-16 16:27:01,738 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.941, Acc: 0.954, Base Lr: 2.48e-03
2022-04-16 16:27:41,978 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.936, Acc: 0.956, Base Lr: 2.48e-03
2022-04-16 16:28:06,663 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-16 16:28:36,795 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.7281873226165771 
2022-04-16 16:28:36,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 16:28:36,797 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 172.8%
2022-04-16 16:29:21,704 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.958, Base Lr: 2.20e-03
2022-04-16 16:29:59,275 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.918, Acc: 0.957, Base Lr: 2.20e-03
2022-04-16 16:30:21,404 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 16:30:49,905 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.8091782331466675 
2022-04-16 16:30:49,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 16:30:49,910 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 180.9%
2022-04-16 16:31:29,338 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.917, Acc: 0.956, Base Lr: 1.92e-03
2022-04-16 16:32:06,832 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.923, Acc: 0.956, Base Lr: 1.92e-03
2022-04-16 16:32:32,202 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-04-16 16:33:02,395 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.8498954772949219 
2022-04-16 16:33:02,397 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 16:33:02,397 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 185.0%
2022-04-16 16:33:35,662 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.902, Acc: 0.964, Base Lr: 1.66e-03
2022-04-16 16:34:07,138 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.912, Acc: 0.960, Base Lr: 1.66e-03
2022-04-16 16:34:32,673 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-16 16:34:59,110 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.8353863954544067 
2022-04-16 16:34:59,112 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 16:34:59,112 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 183.5%
2022-04-16 16:35:31,623 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.911, Acc: 0.958, Base Lr: 1.42e-03
2022-04-16 16:36:02,909 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.905, Acc: 0.959, Base Lr: 1.42e-03
2022-04-16 16:36:21,357 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-16 16:36:48,902 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8219116926193237 
2022-04-16 16:36:48,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 16:36:48,907 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 182.2%
2022-04-16 16:37:28,745 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.895, Acc: 0.967, Base Lr: 1.19e-03
2022-04-16 16:38:01,331 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.908, Acc: 0.960, Base Lr: 1.19e-03
2022-04-16 16:38:20,214 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.334[s] Speed: 47.8[samples/s]
2022-04-16 16:38:54,483 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.8327375650405884 
2022-04-16 16:38:54,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 16:38:54,485 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 183.3%
2022-04-16 16:39:28,081 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.917, Acc: 0.957, Base Lr: 9.72e-04
2022-04-16 16:40:04,138 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.908, Acc: 0.960, Base Lr: 9.72e-04
2022-04-16 16:40:26,149 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-16 16:40:57,409 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.9050734043121338 
2022-04-16 16:40:57,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 16:40:57,411 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 190.5%
2022-04-16 16:41:29,607 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.890, Acc: 0.971, Base Lr: 7.78e-04
2022-04-16 16:41:59,966 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.895, Acc: 0.966, Base Lr: 7.78e-04
2022-04-16 16:42:25,294 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-16 16:42:52,073 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.8184406757354736 
2022-04-16 16:42:52,075 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 16:42:52,075 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 181.8%
2022-04-16 16:43:24,482 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.891, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 16:43:55,615 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.887, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 16:44:15,491 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.306[s] Speed: 52.4[samples/s]
2022-04-16 16:44:44,763 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.870790719985962 
2022-04-16 16:44:44,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 16:44:44,766 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 187.1%
2022-04-16 16:45:23,160 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.908, Acc: 0.958, Base Lr: 4.51e-04
2022-04-16 16:45:54,469 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.900, Acc: 0.961, Base Lr: 4.51e-04
2022-04-16 16:46:14,921 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-16 16:46:46,342 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8337904214859009 
2022-04-16 16:46:46,345 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 16:46:46,345 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 183.4%
2022-04-16 16:47:19,408 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.898, Acc: 0.962, Base Lr: 3.20e-04
2022-04-16 16:47:56,301 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.891, Acc: 0.967, Base Lr: 3.20e-04
2022-04-16 16:48:16,674 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-16 16:48:47,140 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.8055342435836792 
2022-04-16 16:48:47,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 16:48:47,141 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 180.6%
2022-04-16 16:49:19,615 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.898, Acc: 0.962, Base Lr: 2.11e-04
2022-04-16 16:49:49,234 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.898, Acc: 0.963, Base Lr: 2.11e-04
2022-04-16 16:50:12,470 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.313[s] Speed: 51.2[samples/s]
2022-04-16 16:50:39,826 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.7972655296325684 
2022-04-16 16:50:39,831 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 16:50:39,831 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 179.7%
2022-04-16 16:51:11,648 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.897, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 16:51:44,605 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 16:52:04,009 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-16 16:52:31,445 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.816772222518921 
2022-04-16 16:52:31,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 16:52:31,447 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 181.7%
2022-04-16 16:53:12,262 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.894, Acc: 0.962, Base Lr: 6.51e-05
2022-04-16 16:53:45,112 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.899, Acc: 0.962, Base Lr: 6.51e-05
2022-04-16 16:54:04,492 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-16 16:54:34,915 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8158299922943115 
2022-04-16 16:54:34,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 16:54:34,915 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 181.6%
2022-04-16 16:55:08,304 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.902, Acc: 0.960, Base Lr: 2.83e-05
2022-04-16 16:55:44,576 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.897, Acc: 0.961, Base Lr: 2.83e-05
2022-04-16 16:56:08,962 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.344[s] Speed: 46.4[samples/s]
2022-04-16 16:56:37,938 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.7950502634048462 
2022-04-16 16:56:37,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 16:56:37,939 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 179.5%
2022-04-16 16:57:11,691 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.895, Acc: 0.967, Base Lr: 1.60e-05
2022-04-16 16:57:38,320 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.890, Acc: 0.968, Base Lr: 1.60e-05
2022-04-16 16:57:55,937 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-16 16:58:31,548 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8137662410736084 
2022-04-16 16:58:31,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 16:58:31,552 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 181.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1/transformer_best_model.pth
2022-04-16 16:59:11,077 reid_baseline.train INFO: normal accuracy 0.7428924598269468 1.7158454656600952 
2022-04-16 16:59:11,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:59:11,078 reid_baseline.train INFO: Accuracy: 74.3%
2022-04-16 17:00:07,794 reid_baseline.train INFO: normal accuracy 0.7428924598269468 1.7158454656600952 
2022-04-16 17:00:07,794 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:00:07,794 reid_baseline.train INFO: Shuffled Accuracy: 74.3%
2022-04-16 17:00:43,355 reid_baseline.train INFO: normal accuracy 0.9720504009163803 0.6534358859062195 
2022-04-16 17:00:43,355 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:00:43,355 reid_baseline.train INFO: Source Clean Accuracy: 97.2%
2022-04-16 17:00:47,795 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1
2022-04-16 17:00:47,795 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-16 17:00:47,795 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 17:00:47,796 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 17:00:47,796 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 17:00:54,172 reid_baseline.train INFO: start training
2022-04-16 17:01:37,306 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.162, Base Lr: 4.76e-04
2022-04-16 17:02:10,346 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.295, Base Lr: 4.76e-04
2022-04-16 17:02:29,761 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.347[s] Speed: 46.2[samples/s]
2022-04-16 17:04:31,647 reid_baseline.train INFO: normal accuracy 0.5407390406242828 4.17166805267334 
2022-04-16 17:04:34,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 17:04:34,660 reid_baseline.train INFO: Accuracy: 54.1% Mean Entropy: 417.2%
2022-04-16 17:05:06,430 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.889, Acc: 0.559, Base Lr: 8.72e-04
2022-04-16 17:05:36,040 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.816, Acc: 0.547, Base Lr: 8.72e-04
2022-04-16 17:05:55,840 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.297[s] Speed: 53.8[samples/s]
2022-04-16 17:07:51,723 reid_baseline.train INFO: normal accuracy 0.5804452605003443 4.151088714599609 
2022-04-16 17:07:54,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 17:07:54,883 reid_baseline.train INFO: Accuracy: 58.0% Mean Entropy: 415.1%
2022-04-16 17:08:29,328 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.387, Acc: 0.594, Base Lr: 1.27e-03
2022-04-16 17:09:03,025 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.278, Acc: 0.577, Base Lr: 1.27e-03
2022-04-16 17:09:27,253 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-16 17:11:27,419 reid_baseline.train INFO: normal accuracy 0.6105118200596741 3.9834842681884766 
2022-04-16 17:11:30,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 17:11:30,585 reid_baseline.train INFO: Accuracy: 61.1% Mean Entropy: 398.3%
2022-04-16 17:12:07,886 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.728, Acc: 0.594, Base Lr: 1.66e-03
2022-04-16 17:12:42,732 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.612, Base Lr: 1.66e-03
2022-04-16 17:13:03,684 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-16 17:15:02,322 reid_baseline.train INFO: normal accuracy 0.6554969015377553 3.499457597732544 
2022-04-16 17:15:10,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 17:15:10,033 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 349.9%
2022-04-16 17:15:45,288 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.184, Acc: 0.659, Base Lr: 2.06e-03
2022-04-16 17:16:18,598 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.112, Acc: 0.668, Base Lr: 2.06e-03
2022-04-16 17:16:41,611 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.335[s] Speed: 47.7[samples/s]
2022-04-16 17:18:36,767 reid_baseline.train INFO: normal accuracy 0.7050722974523755 2.9936206340789795 
2022-04-16 17:18:41,791 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 17:18:41,791 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 299.4%
2022-04-16 17:19:14,891 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.797, Acc: 0.731, Base Lr: 2.46e-03
2022-04-16 17:19:48,297 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.779, Acc: 0.737, Base Lr: 2.46e-03
2022-04-16 17:20:15,502 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 17:22:16,072 reid_baseline.train INFO: normal accuracy 0.7411062657792059 2.624765157699585 
2022-04-16 17:22:21,726 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 17:22:21,726 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 262.5%
2022-04-16 17:22:58,606 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.613, Acc: 0.774, Base Lr: 2.85e-03
2022-04-16 17:23:34,800 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.596, Acc: 0.766, Base Lr: 2.85e-03
2022-04-16 17:23:56,240 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 17:25:56,688 reid_baseline.train INFO: normal accuracy 0.7557952719761304 2.3473079204559326 
2022-04-16 17:26:04,180 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 17:26:04,180 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 234.7%
2022-04-16 17:26:39,338 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.457, Acc: 0.805, Base Lr: 3.25e-03
2022-04-16 17:27:09,781 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.457, Acc: 0.805, Base Lr: 3.25e-03
2022-04-16 17:27:33,053 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.326[s] Speed: 49.2[samples/s]
2022-04-16 17:29:34,236 reid_baseline.train INFO: normal accuracy 0.7723204039476704 2.1624643802642822 
2022-04-16 17:29:41,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 17:29:41,438 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 216.2%
2022-04-16 17:30:14,303 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.399, Acc: 0.817, Base Lr: 3.64e-03
2022-04-16 17:30:47,980 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.366, Acc: 0.824, Base Lr: 3.64e-03
2022-04-16 17:31:15,504 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-16 17:33:16,974 reid_baseline.train INFO: normal accuracy 0.7794353913243057 2.075058698654175 
2022-04-16 17:33:21,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 17:33:21,305 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 207.5%
2022-04-16 17:33:58,858 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.302, Acc: 0.839, Base Lr: 4.04e-03
2022-04-16 17:34:32,880 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.313, Acc: 0.838, Base Lr: 4.04e-03
2022-04-16 17:34:55,645 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.346[s] Speed: 46.3[samples/s]
2022-04-16 17:37:23,712 reid_baseline.train INFO: normal accuracy 0.7778287812715171 1.9552658796310425 
2022-04-16 17:37:30,005 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 17:37:30,005 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 195.5%
2022-04-16 17:38:03,440 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.246, Acc: 0.868, Base Lr: 4.44e-03
2022-04-16 17:38:36,528 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.258, Acc: 0.860, Base Lr: 4.44e-03
2022-04-16 17:39:00,815 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-16 17:41:03,598 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.8806215524673462 
2022-04-16 17:41:09,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 17:41:09,809 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 188.1%
2022-04-16 17:41:43,762 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.206, Acc: 0.870, Base Lr: 4.83e-03
2022-04-16 17:42:21,510 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.202, Acc: 0.868, Base Lr: 4.83e-03
2022-04-16 17:42:46,582 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.354[s] Speed: 45.1[samples/s]
2022-04-16 17:44:48,336 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.8344299793243408 
2022-04-16 17:44:54,189 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 17:44:54,189 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 183.4%
2022-04-16 17:45:33,396 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.138, Acc: 0.888, Base Lr: 5.23e-03
2022-04-16 17:46:03,847 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.156, Acc: 0.883, Base Lr: 5.23e-03
2022-04-16 17:46:27,633 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.342[s] Speed: 46.7[samples/s]
2022-04-16 17:48:22,566 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.8454828262329102 
2022-04-16 17:48:22,566 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 17:48:22,567 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 184.5%
2022-04-16 17:48:55,293 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.113, Acc: 0.892, Base Lr: 5.62e-03
2022-04-16 17:49:27,008 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.123, Acc: 0.892, Base Lr: 5.62e-03
2022-04-16 17:49:51,309 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-16 17:51:50,610 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.7925962209701538 
2022-04-16 17:51:53,749 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 17:51:53,750 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 179.3%
2022-04-16 17:52:28,528 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.077, Acc: 0.909, Base Lr: 6.02e-03
2022-04-16 17:53:07,486 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.092, Acc: 0.902, Base Lr: 6.02e-03
2022-04-16 17:53:28,556 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-16 17:55:32,235 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7920986413955688 
2022-04-16 17:55:35,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 17:55:35,366 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 179.2%
2022-04-16 17:56:16,724 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.064, Acc: 0.907, Base Lr: 6.42e-03
2022-04-16 17:56:47,222 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.067, Acc: 0.912, Base Lr: 6.42e-03
2022-04-16 17:57:08,263 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-16 17:59:11,751 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.7494319677352905 
2022-04-16 17:59:14,861 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 17:59:14,862 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 174.9%
2022-04-16 17:59:47,901 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.050, Acc: 0.919, Base Lr: 6.81e-03
2022-04-16 18:00:17,240 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.045, Acc: 0.919, Base Lr: 6.81e-03
2022-04-16 18:00:39,075 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-16 18:02:40,654 reid_baseline.train INFO: normal accuracy 0.7886160201973835 1.6936266422271729 
2022-04-16 18:02:43,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 18:02:43,790 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 169.4%
2022-04-16 18:03:21,116 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.026, Acc: 0.926, Base Lr: 7.21e-03
2022-04-16 18:03:58,160 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.028, Acc: 0.924, Base Lr: 7.21e-03
2022-04-16 18:04:17,931 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-16 18:06:15,328 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.7223806381225586 
2022-04-16 18:06:15,333 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 18:06:15,333 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 172.2%
2022-04-16 18:06:53,673 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.023, Acc: 0.927, Base Lr: 7.60e-03
2022-04-16 18:07:21,633 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.014, Acc: 0.930, Base Lr: 7.60e-03
2022-04-16 18:07:45,009 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-16 18:09:43,306 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.726986289024353 
2022-04-16 18:09:43,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 18:09:43,311 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 172.7%
2022-04-16 18:10:16,028 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.980, Acc: 0.940, Base Lr: 4.01e-03
2022-04-16 18:10:46,939 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.983, Acc: 0.938, Base Lr: 4.01e-03
2022-04-16 18:11:10,213 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-16 18:13:24,143 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.6686698198318481 
2022-04-16 18:13:31,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 18:13:31,914 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 166.9%
2022-04-16 18:14:07,203 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.961, Acc: 0.950, Base Lr: 3.69e-03
2022-04-16 18:14:45,560 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.959, Acc: 0.950, Base Lr: 3.69e-03
2022-04-16 18:15:11,061 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-04-16 18:17:12,906 reid_baseline.train INFO: normal accuracy 0.7932063346339224 1.6749101877212524 
2022-04-16 18:17:12,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 18:17:12,906 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 167.5%
2022-04-16 18:17:55,652 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.945, Acc: 0.950, Base Lr: 3.38e-03
2022-04-16 18:18:27,017 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.949, Acc: 0.948, Base Lr: 3.38e-03
2022-04-16 18:18:48,188 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-16 18:20:47,555 reid_baseline.train INFO: normal accuracy 0.7959605232958458 1.6802966594696045 
2022-04-16 18:20:47,556 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 18:20:47,556 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 168.0%
2022-04-16 18:21:21,379 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.941, Acc: 0.949, Base Lr: 3.08e-03
2022-04-16 18:21:51,991 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.956, Acc: 0.944, Base Lr: 3.08e-03
2022-04-16 18:22:13,801 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.316[s] Speed: 50.6[samples/s]
2022-04-16 18:24:15,112 reid_baseline.train INFO: normal accuracy 0.7984851962359422 1.6033954620361328 
2022-04-16 18:24:18,204 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 18:24:18,205 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 160.3%
2022-04-16 18:24:48,378 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.940, Acc: 0.951, Base Lr: 2.77e-03
2022-04-16 18:25:19,293 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.938, Acc: 0.950, Base Lr: 2.77e-03
2022-04-16 18:25:41,852 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.306[s] Speed: 52.2[samples/s]
2022-04-16 18:27:30,076 reid_baseline.train INFO: normal accuracy 0.7943539132430572 1.7159086465835571 
2022-04-16 18:27:30,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 18:27:30,079 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 171.6%
2022-04-16 18:28:09,240 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.941, Acc: 0.954, Base Lr: 2.48e-03
2022-04-16 18:28:46,833 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.936, Acc: 0.957, Base Lr: 2.48e-03
2022-04-16 18:29:11,621 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 18:31:11,468 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.603514313697815 
2022-04-16 18:31:11,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 18:31:11,469 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 160.4%
2022-04-16 18:31:50,254 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.959, Base Lr: 2.20e-03
2022-04-16 18:32:29,829 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.917, Acc: 0.957, Base Lr: 2.20e-03
2022-04-16 18:32:56,619 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.385[s] Speed: 41.5[samples/s]
2022-04-16 18:34:53,801 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.6829317808151245 
2022-04-16 18:34:53,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 18:34:53,801 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 168.3%
2022-04-16 18:35:31,950 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.917, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 18:36:09,911 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.923, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 18:36:38,123 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 18:38:37,774 reid_baseline.train INFO: normal accuracy 0.7929768189120955 1.7204246520996094 
2022-04-16 18:38:37,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 18:38:37,775 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 172.0%
2022-04-16 18:39:15,309 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.902, Acc: 0.964, Base Lr: 1.66e-03
2022-04-16 18:39:52,533 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.912, Acc: 0.960, Base Lr: 1.66e-03
2022-04-16 18:40:20,511 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.376[s] Speed: 42.5[samples/s]
2022-04-16 18:42:18,204 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7168010473251343 
2022-04-16 18:42:18,204 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 18:42:18,204 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 171.7%
2022-04-16 18:42:55,866 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.911, Acc: 0.958, Base Lr: 1.42e-03
2022-04-16 18:43:33,855 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.905, Acc: 0.960, Base Lr: 1.42e-03
2022-04-16 18:44:02,897 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.383[s] Speed: 41.7[samples/s]
2022-04-16 18:46:03,594 reid_baseline.train INFO: normal accuracy 0.7929768189120955 1.697959542274475 
2022-04-16 18:46:03,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 18:46:03,596 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 169.8%
2022-04-16 18:46:44,337 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.895, Acc: 0.968, Base Lr: 1.19e-03
2022-04-16 18:47:22,863 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.908, Acc: 0.961, Base Lr: 1.19e-03
2022-04-16 18:47:49,274 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.387[s] Speed: 41.3[samples/s]
2022-04-16 18:49:53,970 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7114877700805664 
2022-04-16 18:49:53,971 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 18:49:53,971 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 171.1%
2022-04-16 18:50:34,853 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.917, Acc: 0.958, Base Lr: 9.72e-04
2022-04-16 18:51:09,042 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.907, Acc: 0.961, Base Lr: 9.72e-04
2022-04-16 18:51:32,438 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.361[s] Speed: 44.4[samples/s]
2022-04-16 18:53:34,130 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.7833014726638794 
2022-04-16 18:53:34,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 18:53:34,134 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 178.3%
2022-04-16 18:54:14,659 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.889, Acc: 0.970, Base Lr: 7.78e-04
2022-04-16 18:54:52,301 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.895, Acc: 0.966, Base Lr: 7.78e-04
2022-04-16 18:55:18,534 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.382[s] Speed: 41.8[samples/s]
2022-04-16 18:57:19,923 reid_baseline.train INFO: normal accuracy 0.7886160201973835 1.6924760341644287 
2022-04-16 18:57:19,923 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 18:57:19,924 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 169.2%
2022-04-16 18:57:59,657 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.891, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 18:58:38,089 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.887, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 18:59:02,224 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-04-16 19:01:03,693 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.743247151374817 
2022-04-16 19:01:03,696 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 19:01:03,696 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 174.3%
2022-04-16 19:01:44,343 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.908, Acc: 0.957, Base Lr: 4.51e-04
2022-04-16 19:02:22,529 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.899, Acc: 0.961, Base Lr: 4.51e-04
2022-04-16 19:02:46,986 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.378[s] Speed: 42.3[samples/s]
2022-04-16 19:04:42,422 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.701343059539795 
2022-04-16 19:04:42,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 19:04:42,427 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 170.1%
2022-04-16 19:05:21,820 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.898, Acc: 0.963, Base Lr: 3.20e-04
2022-04-16 19:05:59,492 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.891, Acc: 0.967, Base Lr: 3.20e-04
2022-04-16 19:06:23,238 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.369[s] Speed: 43.3[samples/s]
2022-04-16 19:08:17,315 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.6783549785614014 
2022-04-16 19:08:17,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 19:08:17,320 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 167.8%
2022-04-16 19:08:56,697 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.898, Acc: 0.961, Base Lr: 2.11e-04
2022-04-16 19:09:32,447 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.898, Acc: 0.962, Base Lr: 2.11e-04
2022-04-16 19:09:59,086 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-16 19:11:52,514 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.6770437955856323 
2022-04-16 19:11:52,519 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 19:11:52,519 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 167.7%
2022-04-16 19:12:32,975 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.897, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 19:13:11,516 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.966, Base Lr: 1.26e-04
2022-04-16 19:13:34,896 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-04-16 19:15:33,566 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7032594680786133 
2022-04-16 19:15:33,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 19:15:33,570 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 170.3%
2022-04-16 19:16:12,826 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.894, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 19:16:51,871 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.899, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 19:17:17,545 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.381[s] Speed: 42.0[samples/s]
2022-04-16 19:19:15,702 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.6994415521621704 
2022-04-16 19:19:15,706 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 19:19:15,707 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.9%
2022-04-16 19:19:56,509 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.902, Acc: 0.961, Base Lr: 2.83e-05
2022-04-16 19:20:32,984 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.897, Acc: 0.961, Base Lr: 2.83e-05
2022-04-16 19:21:00,154 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 19:22:58,802 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.6752716302871704 
2022-04-16 19:22:58,804 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 19:22:58,804 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 167.5%
2022-04-16 19:23:35,402 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.895, Acc: 0.966, Base Lr: 1.60e-05
2022-04-16 19:24:14,883 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.890, Acc: 0.967, Base Lr: 1.60e-05
2022-04-16 19:24:40,503 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.373[s] Speed: 43.0[samples/s]
2022-04-16 19:26:38,339 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.6934120655059814 
2022-04-16 19:26:38,339 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 19:26:38,340 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 169.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1/transformer_best_model.pth
2022-04-16 19:28:57,620 reid_baseline.train INFO: normal accuracy 0.7984851962359422 1.6033954620361328 
2022-04-16 19:28:57,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:28:57,620 reid_baseline.train INFO: Accuracy: 79.8%
2022-04-16 19:30:59,129 reid_baseline.train INFO: normal accuracy 0.7984851962359422 1.6033954620361328 
2022-04-16 19:30:59,129 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:30:59,129 reid_baseline.train INFO: Shuffled Accuracy: 79.8%
2022-04-16 19:31:32,969 reid_baseline.train INFO: normal accuracy 0.9711340206185567 0.6528863310813904 
2022-04-16 19:31:32,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:31:32,969 reid_baseline.train INFO: Source Clean Accuracy: 97.1%
2022-04-16 19:31:37,920 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2
2022-04-16 19:31:37,920 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-16 19:31:37,920 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 19:31:37,920 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 19:31:37,921 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 19:31:45,573 reid_baseline.train INFO: start training
2022-04-16 19:32:26,542 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.145, Acc: 0.164, Base Lr: 4.76e-04
2022-04-16 19:33:01,730 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.301, Base Lr: 4.76e-04
2022-04-16 19:33:25,573 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.361[s] Speed: 44.3[samples/s]
2022-04-16 19:33:58,043 reid_baseline.train INFO: normal accuracy 0.484548825710754 4.171704292297363 
2022-04-16 19:34:04,039 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 19:34:04,040 reid_baseline.train INFO: Accuracy: 48.5% Mean Entropy: 417.2%
2022-04-16 19:34:40,789 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.891, Acc: 0.562, Base Lr: 8.72e-04
2022-04-16 19:35:14,748 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.817, Acc: 0.555, Base Lr: 8.72e-04
2022-04-16 19:35:38,803 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-16 19:36:11,376 reid_baseline.train INFO: normal accuracy 0.5265760197775031 4.152777194976807 
2022-04-16 19:36:17,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 19:36:17,953 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 415.3%
2022-04-16 19:36:56,311 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.389, Acc: 0.594, Base Lr: 1.27e-03
2022-04-16 19:37:29,935 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.276, Acc: 0.579, Base Lr: 1.27e-03
2022-04-16 19:37:52,424 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 19:38:19,841 reid_baseline.train INFO: normal accuracy 0.5562422744128553 4.010095596313477 
2022-04-16 19:38:27,199 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 19:38:27,200 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 401.0%
2022-04-16 19:39:08,327 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.727, Acc: 0.585, Base Lr: 1.66e-03
2022-04-16 19:39:41,551 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.612, Base Lr: 1.66e-03
2022-04-16 19:40:04,033 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 19:40:35,120 reid_baseline.train INFO: normal accuracy 0.6048619695096827 3.6257033348083496 
2022-04-16 19:40:38,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 19:40:38,542 reid_baseline.train INFO: Accuracy: 60.5% Mean Entropy: 362.6%
2022-04-16 19:41:13,246 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.181, Acc: 0.661, Base Lr: 2.06e-03
2022-04-16 19:41:46,700 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.107, Acc: 0.672, Base Lr: 2.06e-03
2022-04-16 19:42:15,491 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 19:42:45,473 reid_baseline.train INFO: normal accuracy 0.6477132262051916 3.178096055984497 
2022-04-16 19:42:48,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 19:42:48,598 reid_baseline.train INFO: Accuracy: 64.8% Mean Entropy: 317.8%
2022-04-16 19:43:22,620 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.792, Acc: 0.728, Base Lr: 2.46e-03
2022-04-16 19:43:53,596 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.777, Acc: 0.735, Base Lr: 2.46e-03
2022-04-16 19:44:15,357 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-16 19:44:45,002 reid_baseline.train INFO: normal accuracy 0.6942727647301195 2.824648141860962 
2022-04-16 19:44:48,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 19:44:48,100 reid_baseline.train INFO: Accuracy: 69.4% Mean Entropy: 282.5%
2022-04-16 19:45:21,987 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.614, Acc: 0.772, Base Lr: 2.85e-03
2022-04-16 19:45:55,259 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.597, Acc: 0.765, Base Lr: 2.85e-03
2022-04-16 19:46:19,436 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-16 19:46:50,596 reid_baseline.train INFO: normal accuracy 0.6979810465595385 2.575883626937866 
2022-04-16 19:46:53,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 19:46:53,690 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 257.6%
2022-04-16 19:47:29,917 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.452, Acc: 0.801, Base Lr: 3.25e-03
2022-04-16 19:48:01,940 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.460, Acc: 0.798, Base Lr: 3.25e-03
2022-04-16 19:48:25,079 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-16 19:48:54,717 reid_baseline.train INFO: normal accuracy 0.7169344870210136 2.3889527320861816 
2022-04-16 19:48:58,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 19:48:58,176 reid_baseline.train INFO: Accuracy: 71.7% Mean Entropy: 238.9%
2022-04-16 19:49:42,368 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.397, Acc: 0.822, Base Lr: 3.64e-03
2022-04-16 19:50:16,953 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.366, Acc: 0.828, Base Lr: 3.64e-03
2022-04-16 19:50:38,888 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.369[s] Speed: 43.4[samples/s]
2022-04-16 19:51:11,510 reid_baseline.train INFO: normal accuracy 0.7317676143386898 2.2863893508911133 
2022-04-16 19:51:15,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 19:51:15,348 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 228.6%
2022-04-16 19:51:49,504 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.298, Acc: 0.843, Base Lr: 4.04e-03
2022-04-16 19:52:22,731 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.314, Acc: 0.836, Base Lr: 4.04e-03
2022-04-16 19:52:51,320 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 19:53:27,269 reid_baseline.train INFO: normal accuracy 0.7276473011948908 2.1852355003356934 
2022-04-16 19:53:33,972 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 19:53:33,973 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 218.5%
2022-04-16 19:54:08,371 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.250, Acc: 0.857, Base Lr: 4.44e-03
2022-04-16 19:54:41,470 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.257, Acc: 0.858, Base Lr: 4.44e-03
2022-04-16 19:55:09,976 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 19:55:38,994 reid_baseline.train INFO: normal accuracy 0.7400082406262876 2.0870423316955566 
2022-04-16 19:55:44,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 19:55:44,863 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 208.7%
2022-04-16 19:56:18,086 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.206, Acc: 0.874, Base Lr: 4.83e-03
2022-04-16 19:56:49,473 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.207, Acc: 0.871, Base Lr: 4.83e-03
2022-04-16 19:57:12,384 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.321[s] Speed: 49.9[samples/s]
2022-04-16 19:57:42,638 reid_baseline.train INFO: normal accuracy 0.7412443345694273 2.035573720932007 
2022-04-16 19:57:46,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 19:57:46,204 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 203.6%
2022-04-16 19:58:20,246 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.141, Acc: 0.894, Base Lr: 5.23e-03
2022-04-16 19:58:52,095 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.155, Acc: 0.887, Base Lr: 5.23e-03
2022-04-16 19:59:13,611 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 19:59:44,187 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.0165956020355225 
2022-04-16 19:59:49,499 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 19:59:49,499 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 201.7%
2022-04-16 20:00:27,103 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.111, Acc: 0.891, Base Lr: 5.62e-03
2022-04-16 20:00:59,208 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.125, Acc: 0.889, Base Lr: 5.62e-03
2022-04-16 20:01:22,430 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-16 20:01:53,774 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.9942671060562134 
2022-04-16 20:01:59,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 20:01:59,313 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 199.4%
2022-04-16 20:02:37,928 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.077, Acc: 0.905, Base Lr: 6.02e-03
2022-04-16 20:03:11,894 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.092, Acc: 0.902, Base Lr: 6.02e-03
2022-04-16 20:03:34,445 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.348[s] Speed: 45.9[samples/s]
2022-04-16 20:04:32,436 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9591224193572998 
2022-04-16 20:04:52,205 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 20:04:52,206 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 195.9%
2022-04-16 20:05:28,296 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.055, Acc: 0.917, Base Lr: 6.42e-03
2022-04-16 20:06:06,188 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.066, Acc: 0.916, Base Lr: 6.42e-03
2022-04-16 20:06:29,762 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.357[s] Speed: 44.8[samples/s]
2022-04-16 20:07:02,209 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.9178285598754883 
2022-04-16 20:07:08,243 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 20:07:08,244 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 191.8%
2022-04-16 20:07:43,563 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.056, Acc: 0.921, Base Lr: 6.81e-03
2022-04-16 20:08:17,230 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.054, Acc: 0.918, Base Lr: 6.81e-03
2022-04-16 20:08:46,546 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.360[s] Speed: 44.4[samples/s]
2022-04-16 20:09:17,842 reid_baseline.train INFO: normal accuracy 0.7358879274824887 1.825400710105896 
2022-04-16 20:09:22,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 20:09:22,953 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 182.5%
2022-04-16 20:09:55,610 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.029, Acc: 0.921, Base Lr: 7.21e-03
2022-04-16 20:10:26,179 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.026, Acc: 0.923, Base Lr: 7.21e-03
2022-04-16 20:10:50,804 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-16 20:11:20,584 reid_baseline.train INFO: normal accuracy 0.7342398022249691 1.835582971572876 
2022-04-16 20:11:20,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 20:11:20,586 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 183.6%
2022-04-16 20:11:52,015 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.020, Acc: 0.922, Base Lr: 7.60e-03
2022-04-16 20:12:24,093 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.017, Acc: 0.927, Base Lr: 7.60e-03
2022-04-16 20:12:48,385 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.322[s] Speed: 49.8[samples/s]
2022-04-16 20:13:18,521 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.7623316049575806 
2022-04-16 20:13:24,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 20:13:24,610 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 176.2%
2022-04-16 20:14:00,353 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.985, Acc: 0.937, Base Lr: 4.01e-03
2022-04-16 20:14:32,344 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.990, Acc: 0.936, Base Lr: 4.01e-03
2022-04-16 20:14:55,679 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-16 20:15:29,052 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.7944324016571045 
2022-04-16 20:15:29,054 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 20:15:29,055 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 179.4%
2022-04-16 20:16:06,079 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.967, Acc: 0.948, Base Lr: 3.69e-03
2022-04-16 20:16:41,232 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.965, Acc: 0.944, Base Lr: 3.69e-03
2022-04-16 20:17:05,054 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 20:17:37,343 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.7729161977767944 
2022-04-16 20:17:37,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 20:17:37,343 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 177.3%
2022-04-16 20:18:08,034 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.954, Acc: 0.951, Base Lr: 3.38e-03
2022-04-16 20:18:41,504 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.953, Acc: 0.948, Base Lr: 3.38e-03
2022-04-16 20:19:08,143 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-16 20:19:34,568 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.7761682271957397 
2022-04-16 20:19:34,568 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 20:19:34,568 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 177.6%
2022-04-16 20:20:06,415 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.941, Acc: 0.951, Base Lr: 3.08e-03
2022-04-16 20:20:38,918 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.955, Acc: 0.944, Base Lr: 3.08e-03
2022-04-16 20:21:02,732 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-16 20:21:28,641 reid_baseline.train INFO: normal accuracy 0.7466007416563659 1.7349600791931152 
2022-04-16 20:21:31,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 20:21:31,759 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 173.5%
2022-04-16 20:22:02,972 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.939, Acc: 0.947, Base Lr: 2.77e-03
2022-04-16 20:22:33,105 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.936, Acc: 0.951, Base Lr: 2.77e-03
2022-04-16 20:22:55,430 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.306[s] Speed: 52.2[samples/s]
2022-04-16 20:23:22,449 reid_baseline.train INFO: normal accuracy 0.7338277709105891 1.794450283050537 
2022-04-16 20:23:22,449 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 20:23:22,449 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 179.4%
2022-04-16 20:23:58,441 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.937, Acc: 0.951, Base Lr: 2.48e-03
2022-04-16 20:24:33,606 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.937, Acc: 0.953, Base Lr: 2.48e-03
2022-04-16 20:24:55,750 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-16 20:25:27,898 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.7243458032608032 
2022-04-16 20:25:31,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 20:25:31,030 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 172.4%
2022-04-16 20:26:03,920 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.962, Base Lr: 2.20e-03
2022-04-16 20:26:37,219 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.919, Acc: 0.957, Base Lr: 2.20e-03
2022-04-16 20:27:02,629 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-16 20:27:29,867 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8073604106903076 
2022-04-16 20:27:29,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 20:27:29,870 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 180.7%
2022-04-16 20:28:01,598 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.913, Acc: 0.962, Base Lr: 1.92e-03
2022-04-16 20:28:35,776 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.918, Acc: 0.958, Base Lr: 1.92e-03
2022-04-16 20:29:01,994 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.337[s] Speed: 47.4[samples/s]
2022-04-16 20:29:27,580 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.82853102684021 
2022-04-16 20:29:27,585 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 20:29:27,585 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 182.9%
2022-04-16 20:29:56,474 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.903, Acc: 0.961, Base Lr: 1.66e-03
2022-04-16 20:30:30,664 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.914, Acc: 0.958, Base Lr: 1.66e-03
2022-04-16 20:30:54,224 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-16 20:31:18,902 reid_baseline.train INFO: normal accuracy 0.7362999587968686 1.8165148496627808 
2022-04-16 20:31:18,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 20:31:18,907 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 181.7%
2022-04-16 20:31:57,566 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.909, Acc: 0.960, Base Lr: 1.42e-03
2022-04-16 20:32:31,930 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.906, Acc: 0.962, Base Lr: 1.42e-03
2022-04-16 20:32:55,817 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 20:33:25,871 reid_baseline.train INFO: normal accuracy 0.7371240214256284 1.8126097917556763 
2022-04-16 20:33:25,873 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 20:33:25,874 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 181.3%
2022-04-16 20:33:56,230 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.895, Acc: 0.965, Base Lr: 1.19e-03
2022-04-16 20:34:30,415 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.904, Acc: 0.961, Base Lr: 1.19e-03
2022-04-16 20:34:58,776 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-16 20:35:33,716 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.8341593742370605 
2022-04-16 20:35:33,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 20:35:33,717 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 183.4%
2022-04-16 20:36:07,265 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.920, Acc: 0.952, Base Lr: 9.72e-04
2022-04-16 20:36:38,234 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.914, Acc: 0.955, Base Lr: 9.72e-04
2022-04-16 20:37:03,307 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-16 20:37:27,289 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8978476524353027 
2022-04-16 20:37:27,290 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 20:37:27,290 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 189.8%
2022-04-16 20:37:57,692 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.891, Acc: 0.969, Base Lr: 7.78e-04
2022-04-16 20:38:31,027 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.899, Acc: 0.966, Base Lr: 7.78e-04
2022-04-16 20:38:53,189 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.315[s] Speed: 50.9[samples/s]
2022-04-16 20:39:17,695 reid_baseline.train INFO: normal accuracy 0.7371240214256284 1.81404709815979 
2022-04-16 20:39:17,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 20:39:17,697 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 181.4%
2022-04-16 20:39:55,962 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.891, Acc: 0.966, Base Lr: 6.04e-04
2022-04-16 20:40:26,489 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.887, Acc: 0.968, Base Lr: 6.04e-04
2022-04-16 20:40:46,603 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-16 20:41:37,947 reid_baseline.train INFO: normal accuracy 0.7371240214256284 1.8620893955230713 
2022-04-16 20:41:37,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 20:41:37,948 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 186.2%
2022-04-16 20:42:09,069 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.912, Acc: 0.958, Base Lr: 4.51e-04
2022-04-16 20:42:46,110 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.904, Acc: 0.962, Base Lr: 4.51e-04
2022-04-16 20:43:12,651 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-16 20:43:46,334 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8295711278915405 
2022-04-16 20:43:46,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 20:43:46,338 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 183.0%
2022-04-16 20:44:21,442 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.894, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 20:44:53,771 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.893, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 20:45:19,408 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-16 20:45:48,908 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.7936817407608032 
2022-04-16 20:45:48,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 20:45:48,910 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 179.4%
2022-04-16 20:46:21,421 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.892, Acc: 0.970, Base Lr: 2.11e-04
2022-04-16 20:46:51,817 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.891, Acc: 0.968, Base Lr: 2.11e-04
2022-04-16 20:47:13,598 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.310[s] Speed: 51.6[samples/s]
2022-04-16 20:47:43,830 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.7868015766143799 
2022-04-16 20:47:43,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 20:47:43,830 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 178.7%
2022-04-16 20:48:20,555 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.892, Acc: 0.970, Base Lr: 1.26e-04
2022-04-16 20:48:55,171 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.967, Base Lr: 1.26e-04
2022-04-16 20:49:19,762 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.351[s] Speed: 45.5[samples/s]
2022-04-16 20:49:48,735 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8285720348358154 
2022-04-16 20:49:48,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 20:49:48,738 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 182.9%
2022-04-16 20:50:28,082 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.897, Acc: 0.963, Base Lr: 6.51e-05
2022-04-16 20:51:00,332 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.900, Acc: 0.962, Base Lr: 6.51e-05
2022-04-16 20:51:20,964 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-16 20:51:53,622 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8169583082199097 
2022-04-16 20:51:53,623 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 20:51:53,623 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 181.7%
2022-04-16 20:52:27,369 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.903, Acc: 0.965, Base Lr: 2.83e-05
2022-04-16 20:53:04,280 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.897, Acc: 0.966, Base Lr: 2.83e-05
2022-04-16 20:53:26,935 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-16 20:53:58,499 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.7857720851898193 
2022-04-16 20:53:58,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 20:53:58,500 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 178.6%
2022-04-16 20:54:30,205 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.898, Acc: 0.966, Base Lr: 1.60e-05
2022-04-16 20:55:01,814 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.892, Acc: 0.967, Base Lr: 1.60e-05
2022-04-16 20:55:28,544 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-16 20:56:03,184 reid_baseline.train INFO: normal accuracy 0.7367119901112484 1.8108710050582886 
2022-04-16 20:56:03,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 20:56:03,184 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 181.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2/transformer_best_model.pth
2022-04-16 20:56:40,152 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.7243458032608032 
2022-04-16 20:56:40,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:56:40,152 reid_baseline.train INFO: Accuracy: 73.8%
2022-04-16 20:57:11,549 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.7243458032608032 
2022-04-16 20:57:11,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:57:11,549 reid_baseline.train INFO: Shuffled Accuracy: 73.8%
2022-04-16 20:57:44,995 reid_baseline.train INFO: normal accuracy 0.9736540664375716 0.6347150206565857 
2022-04-16 20:57:44,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:57:44,995 reid_baseline.train INFO: Source Clean Accuracy: 97.4%
2022-04-16 20:57:49,969 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2
2022-04-16 20:57:49,969 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-16 20:57:49,969 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 20:57:49,970 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 20:57:49,970 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 20:57:57,092 reid_baseline.train INFO: start training
2022-04-16 20:58:42,496 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.145, Acc: 0.164, Base Lr: 4.76e-04
2022-04-16 20:59:17,395 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.301, Base Lr: 4.76e-04
2022-04-16 20:59:42,675 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 21:01:43,522 reid_baseline.train INFO: normal accuracy 0.5430341978425522 4.1716837882995605 
2022-04-16 21:01:49,466 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 21:01:49,467 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 417.2%
2022-04-16 21:02:24,792 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.891, Acc: 0.562, Base Lr: 8.72e-04
2022-04-16 21:03:02,489 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.817, Acc: 0.555, Base Lr: 8.72e-04
2022-04-16 21:03:29,907 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.368[s] Speed: 43.5[samples/s]
2022-04-16 21:05:29,469 reid_baseline.train INFO: normal accuracy 0.581592839109479 4.151037216186523 
2022-04-16 21:05:35,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 21:05:35,434 reid_baseline.train INFO: Accuracy: 58.2% Mean Entropy: 415.1%
2022-04-16 21:06:15,351 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.389, Acc: 0.594, Base Lr: 1.27e-03
2022-04-16 21:06:48,796 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.276, Acc: 0.579, Base Lr: 1.27e-03
2022-04-16 21:07:11,626 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.352[s] Speed: 45.4[samples/s]
2022-04-16 21:09:09,248 reid_baseline.train INFO: normal accuracy 0.6100527886160202 3.9799962043762207 
2022-04-16 21:09:17,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 21:09:17,221 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 398.0%
2022-04-16 21:09:52,167 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.727, Acc: 0.585, Base Lr: 1.66e-03
2022-04-16 21:10:23,740 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.612, Base Lr: 1.66e-03
2022-04-16 21:10:48,240 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-16 21:12:47,216 reid_baseline.train INFO: normal accuracy 0.6559559329814092 3.5028319358825684 
2022-04-16 21:12:51,472 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 21:12:51,472 reid_baseline.train INFO: Accuracy: 65.6% Mean Entropy: 350.3%
2022-04-16 21:13:22,410 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.181, Acc: 0.661, Base Lr: 2.06e-03
2022-04-16 21:13:52,643 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.107, Acc: 0.672, Base Lr: 2.06e-03
2022-04-16 21:14:16,955 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.313[s] Speed: 51.1[samples/s]
2022-04-16 21:16:07,127 reid_baseline.train INFO: normal accuracy 0.7080560018361258 2.9833691120147705 
2022-04-16 21:16:13,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 21:16:13,296 reid_baseline.train INFO: Accuracy: 70.8% Mean Entropy: 298.3%
2022-04-16 21:16:53,800 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.792, Acc: 0.729, Base Lr: 2.46e-03
2022-04-16 21:17:28,854 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.777, Acc: 0.735, Base Lr: 2.46e-03
2022-04-16 21:17:54,284 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-04-16 21:19:56,579 reid_baseline.train INFO: normal accuracy 0.7424833601101676 2.5994045734405518 
2022-04-16 21:20:00,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 21:20:00,948 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 259.9%
2022-04-16 21:20:39,450 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.614, Acc: 0.772, Base Lr: 2.85e-03
2022-04-16 21:21:16,499 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.596, Acc: 0.765, Base Lr: 2.85e-03
2022-04-16 21:21:45,076 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.381[s] Speed: 41.9[samples/s]
2022-04-16 21:23:44,972 reid_baseline.train INFO: normal accuracy 0.7546476933669957 2.348844051361084 
2022-04-16 21:23:51,394 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 21:23:51,394 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 234.9%
2022-04-16 21:24:30,411 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.452, Acc: 0.800, Base Lr: 3.25e-03
2022-04-16 21:25:08,241 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.460, Acc: 0.798, Base Lr: 3.25e-03
2022-04-16 21:25:36,429 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.385[s] Speed: 41.6[samples/s]
2022-04-16 21:27:40,321 reid_baseline.train INFO: normal accuracy 0.7686481523984393 2.1546905040740967 
2022-04-16 21:27:47,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 21:27:47,767 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 215.5%
2022-04-16 21:28:29,983 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.397, Acc: 0.821, Base Lr: 3.64e-03
2022-04-16 21:29:09,043 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.366, Acc: 0.828, Base Lr: 3.64e-03
2022-04-16 21:29:36,934 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-16 21:31:34,144 reid_baseline.train INFO: normal accuracy 0.7764516869405554 2.071136951446533 
2022-04-16 21:31:39,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 21:31:39,714 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 207.1%
2022-04-16 21:32:16,827 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.298, Acc: 0.844, Base Lr: 4.04e-03
2022-04-16 21:32:53,266 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.314, Acc: 0.836, Base Lr: 4.04e-03
2022-04-16 21:33:22,621 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.377[s] Speed: 42.4[samples/s]
2022-04-16 21:35:29,669 reid_baseline.train INFO: normal accuracy 0.7759926554969016 1.976256251335144 
2022-04-16 21:35:32,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 21:35:32,892 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 197.6%
2022-04-16 21:36:13,461 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.250, Acc: 0.857, Base Lr: 4.44e-03
2022-04-16 21:36:51,957 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.257, Acc: 0.858, Base Lr: 4.44e-03
2022-04-16 21:37:20,317 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-16 21:39:21,912 reid_baseline.train INFO: normal accuracy 0.7856323158136332 1.8887879848480225 
2022-04-16 21:39:25,040 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 21:39:25,040 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 188.9%
2022-04-16 21:40:07,900 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.206, Acc: 0.874, Base Lr: 4.83e-03
2022-04-16 21:40:46,957 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.207, Acc: 0.871, Base Lr: 4.83e-03
2022-04-16 21:41:13,843 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-16 21:43:15,180 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.8502196073532104 
2022-04-16 21:43:21,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 21:43:21,432 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 185.0%
2022-04-16 21:44:02,369 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.141, Acc: 0.894, Base Lr: 5.23e-03
2022-04-16 21:44:41,864 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.155, Acc: 0.888, Base Lr: 5.23e-03
2022-04-16 21:45:08,375 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 21:47:05,713 reid_baseline.train INFO: normal accuracy 0.7888455359192105 1.8444454669952393 
2022-04-16 21:47:11,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 21:47:11,973 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 184.4%
2022-04-16 21:47:53,601 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.110, Acc: 0.892, Base Lr: 5.62e-03
2022-04-16 21:48:32,945 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.125, Acc: 0.891, Base Lr: 5.62e-03
2022-04-16 21:49:00,129 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-16 21:50:55,596 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.8349714279174805 
2022-04-16 21:50:58,726 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 21:50:58,727 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 183.5%
2022-04-16 21:51:41,291 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.076, Acc: 0.905, Base Lr: 6.02e-03
2022-04-16 21:52:22,659 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.091, Acc: 0.902, Base Lr: 6.02e-03
2022-04-16 21:52:48,553 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-16 21:54:47,183 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.8014551401138306 
2022-04-16 21:54:50,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 21:54:50,347 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 180.1%
2022-04-16 21:55:26,816 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.055, Acc: 0.919, Base Lr: 6.42e-03
2022-04-16 21:55:55,421 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.066, Acc: 0.917, Base Lr: 6.42e-03
2022-04-16 21:56:15,708 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.313[s] Speed: 51.2[samples/s]
2022-04-16 21:58:20,214 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.757653832435608 
2022-04-16 21:58:29,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 21:58:29,980 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 175.8%
2022-04-16 21:59:11,807 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.056, Acc: 0.921, Base Lr: 6.81e-03
2022-04-16 21:59:50,033 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.054, Acc: 0.917, Base Lr: 6.81e-03
2022-04-16 22:00:17,621 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 22:02:18,492 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.6694589853286743 
2022-04-16 22:02:21,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 22:02:21,691 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 166.9%
2022-04-16 22:03:03,073 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.030, Acc: 0.925, Base Lr: 7.21e-03
2022-04-16 22:03:43,016 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.027, Acc: 0.924, Base Lr: 7.21e-03
2022-04-16 22:04:07,763 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.389[s] Speed: 41.2[samples/s]
2022-04-16 22:06:04,448 reid_baseline.train INFO: normal accuracy 0.7883865044755566 1.7207988500595093 
2022-04-16 22:06:04,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 22:06:04,452 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 172.1%
2022-04-16 22:06:43,314 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.019, Acc: 0.922, Base Lr: 7.60e-03
2022-04-16 22:07:22,558 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.016, Acc: 0.927, Base Lr: 7.60e-03
2022-04-16 22:07:48,725 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 22:09:49,808 reid_baseline.train INFO: normal accuracy 0.7810420013770943 1.654462456703186 
2022-04-16 22:09:52,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 22:09:52,916 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 165.4%
2022-04-16 22:10:33,864 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.984, Acc: 0.937, Base Lr: 4.01e-03
2022-04-16 22:11:12,077 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.989, Acc: 0.936, Base Lr: 4.01e-03
2022-04-16 22:11:38,410 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-16 22:13:42,413 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.664151906967163 
2022-04-16 22:13:42,414 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 22:13:42,414 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 166.4%
2022-04-16 22:14:19,874 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.968, Acc: 0.949, Base Lr: 3.69e-03
2022-04-16 22:14:51,289 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.966, Acc: 0.944, Base Lr: 3.69e-03
2022-04-16 22:15:17,793 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-16 22:17:20,846 reid_baseline.train INFO: normal accuracy 0.7936653660775763 1.6588568687438965 
2022-04-16 22:17:20,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 22:17:20,849 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 165.9%
2022-04-16 22:17:56,013 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.955, Acc: 0.951, Base Lr: 3.38e-03
2022-04-16 22:18:35,128 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.954, Acc: 0.947, Base Lr: 3.38e-03
2022-04-16 22:18:57,664 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 22:20:58,844 reid_baseline.train INFO: normal accuracy 0.7934358503557494 1.6670275926589966 
2022-04-16 22:20:58,845 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 22:20:58,845 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 166.7%
2022-04-16 22:21:39,574 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.941, Acc: 0.947, Base Lr: 3.08e-03
2022-04-16 22:22:10,957 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.955, Acc: 0.943, Base Lr: 3.08e-03
2022-04-16 22:22:36,811 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-16 22:24:32,963 reid_baseline.train INFO: normal accuracy 0.7936653660775763 1.6153912544250488 
2022-04-16 22:24:38,669 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 22:24:38,669 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 161.5%
2022-04-16 22:25:13,114 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.939, Acc: 0.947, Base Lr: 2.77e-03
2022-04-16 22:25:43,004 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.937, Acc: 0.951, Base Lr: 2.77e-03
2022-04-16 22:26:07,105 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.324[s] Speed: 49.4[samples/s]
2022-04-16 22:28:05,222 reid_baseline.train INFO: normal accuracy 0.7929768189120955 1.6878859996795654 
2022-04-16 22:28:05,222 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 22:28:05,223 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 168.8%
2022-04-16 22:28:39,002 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.938, Acc: 0.951, Base Lr: 2.48e-03
2022-04-16 22:29:17,808 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.938, Acc: 0.953, Base Lr: 2.48e-03
2022-04-16 22:29:41,351 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.352[s] Speed: 45.4[samples/s]
2022-04-16 22:31:44,111 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.6099183559417725 
2022-04-16 22:31:49,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 22:31:49,167 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 161.0%
2022-04-16 22:32:31,559 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.963, Base Lr: 2.20e-03
2022-04-16 22:33:04,303 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.919, Acc: 0.958, Base Lr: 2.20e-03
2022-04-16 22:33:24,394 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-16 22:35:46,509 reid_baseline.train INFO: normal accuracy 0.7902226302501721 1.6798629760742188 
2022-04-16 22:35:46,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 22:35:46,513 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 168.0%
2022-04-16 22:36:21,120 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.912, Acc: 0.962, Base Lr: 1.92e-03
2022-04-16 22:36:56,045 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.918, Acc: 0.957, Base Lr: 1.92e-03
2022-04-16 22:37:20,219 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 22:39:21,614 reid_baseline.train INFO: normal accuracy 0.7938948817994033 1.7023661136627197 
2022-04-16 22:39:21,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 22:39:21,614 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 170.2%
2022-04-16 22:39:54,543 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.903, Acc: 0.963, Base Lr: 1.66e-03
2022-04-16 22:40:28,063 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.914, Acc: 0.959, Base Lr: 1.66e-03
2022-04-16 22:40:55,573 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 22:42:58,961 reid_baseline.train INFO: normal accuracy 0.7952719761303649 1.701642394065857 
2022-04-16 22:42:58,962 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 22:42:58,962 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 170.2%
2022-04-16 22:43:33,388 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.910, Acc: 0.960, Base Lr: 1.42e-03
2022-04-16 22:44:11,559 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.906, Acc: 0.962, Base Lr: 1.42e-03
2022-04-16 22:44:35,043 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 22:46:35,766 reid_baseline.train INFO: normal accuracy 0.7945834289648841 1.6917403936386108 
2022-04-16 22:46:35,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 22:46:35,771 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 169.2%
2022-04-16 22:47:09,637 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.894, Acc: 0.966, Base Lr: 1.19e-03
2022-04-16 22:47:40,143 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.904, Acc: 0.963, Base Lr: 1.19e-03
2022-04-16 22:48:02,490 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.318[s] Speed: 50.4[samples/s]
2022-04-16 22:50:05,411 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.712931513786316 
2022-04-16 22:50:05,413 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 22:50:05,413 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.3%
2022-04-16 22:50:39,576 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.920, Acc: 0.952, Base Lr: 9.72e-04
2022-04-16 22:51:08,664 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.914, Acc: 0.955, Base Lr: 9.72e-04
2022-04-16 22:51:36,491 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-16 22:53:42,552 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7763636112213135 
2022-04-16 22:53:42,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 22:53:42,554 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 177.6%
2022-04-16 22:54:16,438 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.892, Acc: 0.969, Base Lr: 7.78e-04
2022-04-16 22:54:54,389 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.899, Acc: 0.966, Base Lr: 7.78e-04
2022-04-16 22:55:16,222 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 22:57:19,571 reid_baseline.train INFO: normal accuracy 0.7913702088593069 1.6902364492416382 
2022-04-16 22:57:19,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 22:57:19,573 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 169.0%
2022-04-16 22:57:56,094 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.891, Acc: 0.964, Base Lr: 6.04e-04
2022-04-16 22:58:28,896 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.887, Acc: 0.967, Base Lr: 6.04e-04
2022-04-16 22:58:50,842 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-16 23:00:50,259 reid_baseline.train INFO: normal accuracy 0.7927473031902685 1.7377266883850098 
2022-04-16 23:00:50,261 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 23:00:50,262 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 173.8%
2022-04-16 23:01:23,818 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.912, Acc: 0.958, Base Lr: 4.51e-04
2022-04-16 23:01:57,337 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.904, Acc: 0.962, Base Lr: 4.51e-04
2022-04-16 23:02:23,119 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-16 23:04:23,177 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.697611927986145 
2022-04-16 23:04:23,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 23:04:23,177 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.8%
2022-04-16 23:05:01,554 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.895, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 23:05:36,962 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.893, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 23:05:57,530 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.346[s] Speed: 46.3[samples/s]
2022-04-16 23:07:53,497 reid_baseline.train INFO: normal accuracy 0.7913702088593069 1.6664209365844727 
2022-04-16 23:07:53,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 23:07:53,498 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 166.6%
2022-04-16 23:08:27,422 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.892, Acc: 0.970, Base Lr: 2.11e-04
2022-04-16 23:08:58,165 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.891, Acc: 0.968, Base Lr: 2.11e-04
2022-04-16 23:09:19,262 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.314[s] Speed: 50.9[samples/s]
2022-04-16 23:11:12,923 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.6680772304534912 
2022-04-16 23:11:12,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 23:11:12,927 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 166.8%
2022-04-16 23:11:46,022 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.892, Acc: 0.970, Base Lr: 1.26e-04
2022-04-16 23:12:16,217 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.967, Base Lr: 1.26e-04
2022-04-16 23:12:41,560 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 23:14:41,264 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7180742025375366 
2022-04-16 23:14:41,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 23:14:41,266 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.8%
2022-04-16 23:15:16,376 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.897, Acc: 0.964, Base Lr: 6.51e-05
2022-04-16 23:15:54,937 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.900, Acc: 0.963, Base Lr: 6.51e-05
2022-04-16 23:16:15,196 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 23:18:15,216 reid_baseline.train INFO: normal accuracy 0.7920587560247877 1.6986358165740967 
2022-04-16 23:18:15,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 23:18:15,218 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.9%
2022-04-16 23:18:55,811 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.903, Acc: 0.962, Base Lr: 2.83e-05
2022-04-16 23:19:25,399 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.897, Acc: 0.963, Base Lr: 2.83e-05
2022-04-16 23:19:47,373 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-16 23:21:42,981 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.6661736965179443 
2022-04-16 23:21:42,982 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 23:21:42,982 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 166.6%
2022-04-16 23:22:15,500 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.898, Acc: 0.965, Base Lr: 1.60e-05
2022-04-16 23:22:46,632 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.891, Acc: 0.967, Base Lr: 1.60e-05
2022-04-16 23:23:07,095 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-16 23:25:14,287 reid_baseline.train INFO: normal accuracy 0.790911177415653 1.6889779567718506 
2022-04-16 23:25:14,288 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 23:25:14,288 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 168.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2/transformer_best_model.pth
2022-04-16 23:27:16,053 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.6099183559417725 
2022-04-16 23:27:16,053 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:27:16,054 reid_baseline.train INFO: Accuracy: 79.3%
2022-04-16 23:29:13,526 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.6099183559417725 
2022-04-16 23:29:13,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:29:13,526 reid_baseline.train INFO: Shuffled Accuracy: 79.3%
2022-04-16 23:29:46,027 reid_baseline.train INFO: normal accuracy 0.9731958762886598 0.6386492848396301 
2022-04-16 23:29:46,028 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:29:46,028 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-16 23:29:50,397 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3
2022-04-16 23:29:50,397 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-16 23:29:50,398 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 23:29:50,398 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 23:29:50,398 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 23:29:57,095 reid_baseline.train INFO: start training
2022-04-16 23:30:37,238 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.169, Base Lr: 4.76e-04
2022-04-16 23:31:12,843 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.304, Base Lr: 4.76e-04
2022-04-16 23:31:38,027 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.367[s] Speed: 43.6[samples/s]
2022-04-16 23:32:07,766 reid_baseline.train INFO: normal accuracy 0.4791924186238154 4.171713829040527 
