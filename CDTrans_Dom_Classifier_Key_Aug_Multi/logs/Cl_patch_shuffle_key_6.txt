2022-04-15 20:22:05,317 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_2
2022-04-15 20:22:05,317 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-15 20:22:05,317 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 20:22:05,317 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 20:22:05,318 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 20:22:09,068 reid_baseline.train INFO: start training
2022-04-15 20:22:18,029 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.130, Acc: 0.267, Base Lr: 4.76e-04
2022-04-15 20:22:27,611 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.077, Acc: 0.393, Base Lr: 4.76e-04
2022-04-15 20:22:39,867 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.113[s] Speed: 142.0[samples/s]
2022-04-15 20:22:51,971 reid_baseline.train INFO: normal accuracy 0.48825710754017304 4.170660018920898 
2022-04-15 20:22:55,088 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 20:22:55,089 reid_baseline.train INFO: Accuracy: 48.8% Mean Entropy: 417.1%
2022-04-15 20:23:10,462 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.610, Base Lr: 8.72e-04
2022-04-15 20:23:27,337 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.665, Acc: 0.609, Base Lr: 8.72e-04
2022-04-15 20:23:39,487 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 20:23:51,570 reid_baseline.train INFO: normal accuracy 0.5166872682323856 4.14261531829834 
2022-04-15 20:23:55,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 20:23:55,494 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 414.3%
2022-04-15 20:24:10,952 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.140, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 20:24:27,390 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.003, Acc: 0.634, Base Lr: 1.27e-03
2022-04-15 20:24:39,573 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.161[s] Speed: 99.1[samples/s]
2022-04-15 20:24:51,517 reid_baseline.train INFO: normal accuracy 0.5558302430984755 3.981259346008301 
2022-04-15 20:24:55,455 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 20:24:55,455 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 398.1%
2022-04-15 20:25:11,059 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.380, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 20:25:28,880 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.309, Acc: 0.682, Base Lr: 1.66e-03
2022-04-15 20:25:41,017 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.167[s] Speed: 95.9[samples/s]
2022-04-15 20:25:53,071 reid_baseline.train INFO: normal accuracy 0.6452410383189122 3.6288371086120605 
2022-04-15 20:25:56,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 20:25:56,172 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 362.9%
2022-04-15 20:26:11,771 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.898, Acc: 0.728, Base Lr: 2.06e-03
2022-04-15 20:26:29,225 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.823, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 20:26:41,410 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.166[s] Speed: 96.6[samples/s]
2022-04-15 20:26:53,571 reid_baseline.train INFO: normal accuracy 0.6918005768438401 3.193950653076172 
2022-04-15 20:26:58,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 20:26:58,366 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 319.4%
2022-04-15 20:27:13,917 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.603, Acc: 0.786, Base Lr: 2.46e-03
2022-04-15 20:27:30,373 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.794, Base Lr: 2.46e-03
2022-04-15 20:27:42,571 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 20:27:54,677 reid_baseline.train INFO: normal accuracy 0.7119901112484549 2.9105329513549805 
2022-04-15 20:27:59,081 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 20:27:59,081 reid_baseline.train INFO: Accuracy: 71.2% Mean Entropy: 291.1%
2022-04-15 20:28:14,685 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.361, Acc: 0.847, Base Lr: 2.85e-03
2022-04-15 20:28:29,940 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.356, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 20:28:42,132 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.158[s] Speed: 101.5[samples/s]
2022-04-15 20:28:54,278 reid_baseline.train INFO: normal accuracy 0.7268232385661311 2.6822614669799805 
2022-04-15 20:28:58,486 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 20:28:58,487 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 268.2%
2022-04-15 20:29:14,165 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.236, Acc: 0.881, Base Lr: 3.25e-03
2022-04-15 20:29:32,025 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.243, Acc: 0.874, Base Lr: 3.25e-03
2022-04-15 20:29:44,246 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.168[s] Speed: 95.5[samples/s]
2022-04-15 20:29:56,351 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.456686496734619 
2022-04-15 20:29:59,825 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 20:29:59,826 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 245.7%
2022-04-15 20:30:15,607 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.184, Acc: 0.883, Base Lr: 3.64e-03
2022-04-15 20:30:32,563 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.171, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 20:30:44,771 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.165[s] Speed: 97.2[samples/s]
2022-04-15 20:30:56,990 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.3405723571777344 
2022-04-15 20:31:00,103 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 20:31:00,103 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 234.1%
2022-04-15 20:31:15,710 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.109, Acc: 0.906, Base Lr: 4.04e-03
2022-04-15 20:31:32,098 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.114, Acc: 0.905, Base Lr: 4.04e-03
2022-04-15 20:31:44,263 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.162[s] Speed: 98.9[samples/s]
2022-04-15 20:32:00,796 reid_baseline.train INFO: normal accuracy 0.7449526163988464 2.187211513519287 
2022-04-15 20:32:05,733 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 20:32:05,734 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 218.7%
2022-04-15 20:32:16,968 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.081, Acc: 0.913, Base Lr: 4.44e-03
2022-04-15 20:32:29,061 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.073, Acc: 0.918, Base Lr: 4.44e-03
2022-04-15 20:32:41,247 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.130[s] Speed: 123.0[samples/s]
2022-04-15 20:32:53,386 reid_baseline.train INFO: normal accuracy 0.7544293366295839 2.1549692153930664 
2022-04-15 20:32:56,802 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 20:32:56,802 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 215.5%
2022-04-15 20:33:09,771 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.999, Acc: 0.941, Base Lr: 4.83e-03
2022-04-15 20:33:23,311 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.008, Acc: 0.935, Base Lr: 4.83e-03
2022-04-15 20:33:32,379 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.130[s] Speed: 122.8[samples/s]
2022-04-15 20:33:40,500 reid_baseline.train INFO: normal accuracy 0.7470127729707458 2.0529685020446777 
2022-04-15 20:33:43,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 20:33:43,584 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 205.3%
2022-04-15 20:33:52,513 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.998, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 20:34:00,707 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.991, Acc: 0.941, Base Lr: 5.23e-03
2022-04-15 20:34:06,787 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.085[s] Speed: 188.3[samples/s]
2022-04-15 20:34:14,685 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9960060119628906 
2022-04-15 20:34:17,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 20:34:17,789 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 199.6%
2022-04-15 20:34:26,685 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.966, Acc: 0.946, Base Lr: 5.62e-03
2022-04-15 20:34:34,869 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.964, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 20:34:40,919 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.085[s] Speed: 188.9[samples/s]
2022-04-15 20:34:48,630 reid_baseline.train INFO: normal accuracy 0.7503090234857849 1.9739482402801514 
2022-04-15 20:34:51,740 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 20:34:51,740 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 197.4%
2022-04-15 20:35:00,568 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.936, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 20:35:08,761 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.942, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 20:35:14,813 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.084[s] Speed: 189.4[samples/s]
2022-04-15 20:35:22,530 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.9104076623916626 
2022-04-15 20:35:25,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 20:35:25,614 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 191.0%
2022-04-15 20:35:34,488 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.919, Acc: 0.963, Base Lr: 6.42e-03
2022-04-15 20:35:42,667 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.916, Acc: 0.962, Base Lr: 6.42e-03
2022-04-15 20:35:48,709 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.085[s] Speed: 189.2[samples/s]
2022-04-15 20:35:56,607 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9644142389297485 
2022-04-15 20:35:56,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 20:35:56,607 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 196.4%
2022-04-15 20:36:05,475 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.898, Acc: 0.967, Base Lr: 6.81e-03
2022-04-15 20:36:13,621 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.906, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 20:36:19,687 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.085[s] Speed: 189.3[samples/s]
2022-04-15 20:36:27,558 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.9415422677993774 
2022-04-15 20:36:27,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 20:36:27,558 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 194.2%
2022-04-15 20:36:36,438 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.880, Acc: 0.969, Base Lr: 7.21e-03
2022-04-15 20:36:44,620 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.892, Acc: 0.967, Base Lr: 7.21e-03
2022-04-15 20:36:50,663 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.085[s] Speed: 189.1[samples/s]
2022-04-15 20:36:58,580 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.918190836906433 
2022-04-15 20:36:58,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 20:36:58,581 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 191.8%
2022-04-15 20:37:07,465 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.880, Acc: 0.971, Base Lr: 7.60e-03
2022-04-15 20:37:15,662 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 20:37:21,713 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.085[s] Speed: 188.9[samples/s]
2022-04-15 20:37:29,536 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.8723210096359253 
2022-04-15 20:37:32,634 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 20:37:32,634 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 187.2%
2022-04-15 20:37:41,504 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.876, Acc: 0.968, Base Lr: 4.01e-03
2022-04-15 20:37:49,718 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.869, Acc: 0.972, Base Lr: 4.01e-03
2022-04-15 20:37:55,763 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.085[s] Speed: 188.9[samples/s]
2022-04-15 20:38:06,526 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9391717910766602 
2022-04-15 20:38:06,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 20:38:06,526 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 193.9%
2022-04-15 20:38:15,416 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.849, Acc: 0.979, Base Lr: 3.69e-03
2022-04-15 20:38:23,610 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.851, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 20:38:29,659 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.085[s] Speed: 188.9[samples/s]
2022-04-15 20:38:37,485 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.937576413154602 
2022-04-15 20:38:37,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 20:38:37,485 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 193.8%
2022-04-15 20:38:46,356 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.844, Acc: 0.976, Base Lr: 3.38e-03
2022-04-15 20:38:54,566 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.844, Acc: 0.978, Base Lr: 3.38e-03
2022-04-15 20:39:00,649 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.085[s] Speed: 188.6[samples/s]
2022-04-15 20:39:08,605 reid_baseline.train INFO: normal accuracy 0.7515451174289246 1.953330397605896 
2022-04-15 20:39:08,605 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 20:39:08,605 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 195.3%
2022-04-15 20:39:17,450 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.850, Acc: 0.974, Base Lr: 3.08e-03
2022-04-15 20:39:25,631 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.843, Acc: 0.977, Base Lr: 3.08e-03
2022-04-15 20:39:31,678 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.084[s] Speed: 189.4[samples/s]
2022-04-15 20:39:39,345 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.928174376487732 
2022-04-15 20:39:39,345 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 20:39:39,345 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 192.8%
2022-04-15 20:39:48,230 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 20:39:56,404 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 20:40:02,461 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.085[s] Speed: 189.0[samples/s]
2022-04-15 20:40:10,191 reid_baseline.train INFO: normal accuracy 0.7441285537700866 1.9602795839309692 
2022-04-15 20:40:10,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 20:40:10,192 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 196.0%
2022-04-15 20:40:19,087 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.843, Acc: 0.977, Base Lr: 2.48e-03
2022-04-15 20:40:27,294 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.840, Acc: 0.978, Base Lr: 2.48e-03
2022-04-15 20:40:33,390 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.085[s] Speed: 188.4[samples/s]
2022-04-15 20:40:41,252 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.903106451034546 
2022-04-15 20:40:41,252 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 20:40:41,252 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 190.3%
2022-04-15 20:40:50,165 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 2.20e-03
2022-04-15 20:40:58,374 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.834, Acc: 0.978, Base Lr: 2.20e-03
2022-04-15 20:41:04,433 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.085[s] Speed: 188.5[samples/s]
2022-04-15 20:41:12,261 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.937835931777954 
2022-04-15 20:41:12,261 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 20:41:12,262 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 193.8%
2022-04-15 20:41:21,139 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.836, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 20:41:29,349 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.841, Acc: 0.976, Base Lr: 1.92e-03
2022-04-15 20:41:35,415 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.085[s] Speed: 188.7[samples/s]
2022-04-15 20:41:43,126 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.9633095264434814 
2022-04-15 20:41:43,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 20:41:43,127 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 196.3%
2022-04-15 20:41:52,002 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.828, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 20:42:00,190 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 20:42:06,237 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.085[s] Speed: 189.1[samples/s]
2022-04-15 20:42:14,081 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.9659206867218018 
2022-04-15 20:42:14,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 20:42:14,082 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 196.6%
2022-04-15 20:42:22,949 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.830, Acc: 0.979, Base Lr: 1.42e-03
2022-04-15 20:42:31,141 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.822, Acc: 0.983, Base Lr: 1.42e-03
2022-04-15 20:42:37,172 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.085[s] Speed: 189.2[samples/s]
2022-04-15 20:42:45,045 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.971710205078125 
2022-04-15 20:42:45,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 20:42:45,046 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 197.2%
2022-04-15 20:42:53,923 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.828, Acc: 0.981, Base Lr: 1.19e-03
2022-04-15 20:43:02,130 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.826, Acc: 0.982, Base Lr: 1.19e-03
2022-04-15 20:43:08,197 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.085[s] Speed: 188.7[samples/s]
2022-04-15 20:43:18,947 reid_baseline.train INFO: normal accuracy 0.7503090234857849 1.9570380449295044 
2022-04-15 20:43:18,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 20:43:18,948 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 195.7%
2022-04-15 20:43:27,859 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.822, Acc: 0.979, Base Lr: 9.72e-04
2022-04-15 20:43:36,044 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 9.72e-04
2022-04-15 20:43:42,126 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.085[s] Speed: 188.5[samples/s]
2022-04-15 20:43:49,881 reid_baseline.train INFO: normal accuracy 0.746188710341986 2.0347251892089844 
2022-04-15 20:43:49,881 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 20:43:49,882 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 203.5%
2022-04-15 20:43:58,782 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.812, Acc: 0.987, Base Lr: 7.78e-04
2022-04-15 20:44:06,980 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 7.78e-04
2022-04-15 20:44:13,035 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.085[s] Speed: 188.7[samples/s]
2022-04-15 20:44:20,670 reid_baseline.train INFO: normal accuracy 0.7523691800576844 1.9790312051773071 
2022-04-15 20:44:20,670 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 20:44:20,670 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 197.9%
2022-04-15 20:44:29,595 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 6.04e-04
2022-04-15 20:44:37,788 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.823, Acc: 0.980, Base Lr: 6.04e-04
2022-04-15 20:44:43,853 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.085[s] Speed: 188.5[samples/s]
2022-04-15 20:44:51,667 reid_baseline.train INFO: normal accuracy 0.7490729295426453 1.9942368268966675 
2022-04-15 20:44:51,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 20:44:51,667 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 199.4%
2022-04-15 20:45:00,559 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.817, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 20:45:08,770 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 4.51e-04
2022-04-15 20:45:15,106 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.086[s] Speed: 186.4[samples/s]
2022-04-15 20:45:27,292 reid_baseline.train INFO: normal accuracy 0.749896992171405 1.9734493494033813 
2022-04-15 20:45:27,294 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 20:45:27,294 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 197.3%
2022-04-15 20:45:44,575 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.815, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 20:46:01,122 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 20:46:11,973 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.164[s] Speed: 97.8[samples/s]
2022-04-15 20:46:25,101 reid_baseline.train INFO: normal accuracy 0.7515451174289246 1.9962152242660522 
2022-04-15 20:46:25,101 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 20:46:25,102 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 199.6%
2022-04-15 20:46:42,378 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.816, Acc: 0.982, Base Lr: 2.11e-04
2022-04-15 20:46:58,927 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.815, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 20:47:09,527 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.163[s] Speed: 98.3[samples/s]
2022-04-15 20:47:21,767 reid_baseline.train INFO: normal accuracy 0.7515451174289246 1.962660789489746 
2022-04-15 20:47:21,770 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 20:47:21,770 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 196.3%
2022-04-15 20:47:40,146 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.830, Acc: 0.978, Base Lr: 1.26e-04
2022-04-15 20:47:56,746 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.822, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 20:48:07,430 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.167[s] Speed: 95.7[samples/s]
2022-04-15 20:48:19,365 reid_baseline.train INFO: normal accuracy 0.7490729295426453 1.9721776247024536 
2022-04-15 20:48:19,367 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 20:48:19,367 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 197.2%
2022-04-15 20:48:36,708 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 20:48:53,299 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 20:49:03,730 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 20:49:15,518 reid_baseline.train INFO: normal accuracy 0.7511330861145447 1.9678843021392822 
2022-04-15 20:49:15,518 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 20:49:15,519 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 196.8%
2022-04-15 20:49:32,929 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.816, Acc: 0.985, Base Lr: 2.83e-05
2022-04-15 20:49:49,521 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.815, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 20:50:01,082 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.167[s] Speed: 95.9[samples/s]
2022-04-15 20:50:13,441 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.9601045846939087 
2022-04-15 20:50:13,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 20:50:13,443 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 196.0%
2022-04-15 20:50:31,526 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.822, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 20:50:48,088 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 20:51:00,243 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.171[s] Speed: 93.4[samples/s]
2022-04-15 20:51:15,474 reid_baseline.train INFO: normal accuracy 0.7511330861145447 1.9967833757400513 
2022-04-15 20:51:15,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 20:51:15,474 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 199.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_2/transformer_best_model.pth
2022-04-15 20:51:33,270 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.8723210096359253 
2022-04-15 20:51:33,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 20:51:33,270 reid_baseline.train INFO: Accuracy: 75.1%
2022-04-15 20:51:45,453 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.8723210096359253 
2022-04-15 20:51:45,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 20:51:45,453 reid_baseline.train INFO: Shuffled Accuracy: 75.1%
2022-04-15 20:52:03,624 reid_baseline.train INFO: normal accuracy 0.9775486827033218 0.6199718713760376 
2022-04-15 20:52:03,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 20:52:03,625 reid_baseline.train INFO: Source Clean Accuracy: 97.8%
2022-04-15 20:52:07,057 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_2
2022-04-15 20:52:07,058 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-15 20:52:07,058 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 20:52:07,058 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 20:52:07,058 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 20:52:11,084 reid_baseline.train INFO: start training
2022-04-15 20:52:28,650 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.130, Acc: 0.267, Base Lr: 4.76e-04
2022-04-15 20:52:45,257 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.077, Acc: 0.393, Base Lr: 4.76e-04
2022-04-15 20:52:57,464 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.170[s] Speed: 94.3[samples/s]
2022-04-15 20:53:33,510 reid_baseline.train INFO: normal accuracy 0.5659857700252467 4.170406818389893 
2022-04-15 20:53:38,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 20:53:38,184 reid_baseline.train INFO: Accuracy: 56.6% Mean Entropy: 417.0%
2022-04-15 20:53:53,853 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.610, Base Lr: 8.72e-04
2022-04-15 20:54:10,861 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.665, Acc: 0.609, Base Lr: 8.72e-04
2022-04-15 20:54:23,031 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.164[s] Speed: 97.4[samples/s]
2022-04-15 20:54:57,194 reid_baseline.train INFO: normal accuracy 0.5880192793206335 4.1359710693359375 
2022-04-15 20:55:04,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 20:55:04,596 reid_baseline.train INFO: Accuracy: 58.8% Mean Entropy: 413.6%
2022-04-15 20:55:21,525 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.140, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 20:55:38,074 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.003, Acc: 0.634, Base Lr: 1.27e-03
2022-04-15 20:55:50,237 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.167[s] Speed: 95.8[samples/s]
2022-04-15 20:56:24,934 reid_baseline.train INFO: normal accuracy 0.6240532476474638 3.9217565059661865 
2022-04-15 20:56:28,349 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 20:56:28,349 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 392.2%
2022-04-15 20:56:44,291 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.380, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 20:57:00,602 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.309, Acc: 0.682, Base Lr: 1.66e-03
2022-04-15 20:57:12,816 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 20:57:44,345 reid_baseline.train INFO: normal accuracy 0.7025476245122791 3.4661731719970703 
2022-04-15 20:57:51,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 20:57:51,218 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 346.6%
2022-04-15 20:58:09,200 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.898, Acc: 0.728, Base Lr: 2.06e-03
2022-04-15 20:58:25,777 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.823, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 20:58:37,938 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.171[s] Speed: 93.6[samples/s]
2022-04-15 20:59:12,267 reid_baseline.train INFO: normal accuracy 0.7484507688776681 2.961103677749634 
2022-04-15 20:59:15,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 20:59:15,812 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 296.1%
2022-04-15 20:59:31,632 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.603, Acc: 0.786, Base Lr: 2.46e-03
2022-04-15 20:59:47,261 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.794, Base Lr: 2.46e-03
2022-04-15 20:59:59,454 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.160[s] Speed: 100.3[samples/s]
2022-04-15 21:00:32,892 reid_baseline.train INFO: normal accuracy 0.7732384668349782 2.649902105331421 
2022-04-15 21:00:36,926 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 21:00:36,926 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 265.0%
2022-04-15 21:00:54,314 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.361, Acc: 0.847, Base Lr: 2.85e-03
2022-04-15 21:01:10,873 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.356, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 21:01:21,295 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-15 21:01:53,262 reid_baseline.train INFO: normal accuracy 0.7883865044755566 2.418243408203125 
2022-04-15 21:01:56,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 21:01:56,354 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 241.8%
2022-04-15 21:02:12,612 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.236, Acc: 0.881, Base Lr: 3.25e-03
2022-04-15 21:02:28,558 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.243, Acc: 0.874, Base Lr: 3.25e-03
2022-04-15 21:02:40,730 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-15 21:03:18,908 reid_baseline.train INFO: normal accuracy 0.7973376176268074 2.203364372253418 
2022-04-15 21:03:23,124 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 21:03:23,124 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 220.3%
2022-04-15 21:03:40,492 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.184, Acc: 0.883, Base Lr: 3.64e-03
2022-04-15 21:03:55,662 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.171, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 21:04:07,448 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 21:04:39,676 reid_baseline.train INFO: normal accuracy 0.8044526050034427 2.08895206451416 
2022-04-15 21:04:42,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 21:04:42,764 reid_baseline.train INFO: Accuracy: 80.4% Mean Entropy: 208.9%
2022-04-15 21:05:00,264 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.109, Acc: 0.906, Base Lr: 4.04e-03
2022-04-15 21:05:16,857 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.114, Acc: 0.905, Base Lr: 4.04e-03
2022-04-15 21:05:29,036 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.169[s] Speed: 94.6[samples/s]
2022-04-15 21:06:05,796 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.9471943378448486 
2022-04-15 21:06:08,881 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 21:06:08,881 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 194.7%
2022-04-15 21:06:25,289 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.081, Acc: 0.913, Base Lr: 4.44e-03
2022-04-15 21:06:41,122 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.073, Acc: 0.918, Base Lr: 4.44e-03
2022-04-15 21:06:53,356 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 21:07:27,608 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.9238814115524292 
2022-04-15 21:07:31,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 21:07:31,013 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 192.4%
2022-04-15 21:07:48,434 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.999, Acc: 0.941, Base Lr: 4.83e-03
2022-04-15 21:08:05,022 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.008, Acc: 0.935, Base Lr: 4.83e-03
2022-04-15 21:08:15,829 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.164[s] Speed: 97.6[samples/s]
2022-04-15 21:08:47,874 reid_baseline.train INFO: normal accuracy 0.8140922653201744 1.8304855823516846 
2022-04-15 21:08:51,282 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 21:08:51,282 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 183.0%
2022-04-15 21:09:06,858 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.998, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 21:09:23,471 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.991, Acc: 0.941, Base Lr: 5.23e-03
2022-04-15 21:09:35,682 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 21:10:09,128 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.7857794761657715 
2022-04-15 21:10:12,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 21:10:12,542 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 178.6%
2022-04-15 21:10:29,946 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.966, Acc: 0.946, Base Lr: 5.62e-03
2022-04-15 21:10:45,035 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.964, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 21:10:56,909 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-15 21:11:30,227 reid_baseline.train INFO: normal accuracy 0.8173054854257517 1.7791755199432373 
2022-04-15 21:11:33,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 21:11:33,642 reid_baseline.train INFO: Accuracy: 81.7% Mean Entropy: 177.9%
2022-04-15 21:11:50,183 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.936, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 21:12:06,728 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.942, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 21:12:18,890 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.165[s] Speed: 96.7[samples/s]
2022-04-15 21:12:54,192 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.6945048570632935 
2022-04-15 21:12:57,290 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 21:12:57,290 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 169.5%
2022-04-15 21:13:13,847 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.919, Acc: 0.963, Base Lr: 6.42e-03
2022-04-15 21:13:29,529 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.916, Acc: 0.962, Base Lr: 6.42e-03
2022-04-15 21:13:41,703 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 21:14:13,729 reid_baseline.train INFO: normal accuracy 0.8161579068166169 1.7412889003753662 
2022-04-15 21:14:13,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 21:14:13,729 reid_baseline.train INFO: Accuracy: 81.6% Mean Entropy: 174.1%
2022-04-15 21:14:31,150 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.898, Acc: 0.967, Base Lr: 6.81e-03
2022-04-15 21:14:47,726 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.906, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 21:14:59,736 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.168[s] Speed: 95.1[samples/s]
2022-04-15 21:15:33,269 reid_baseline.train INFO: normal accuracy 0.8092724351618086 1.7450296878814697 
2022-04-15 21:15:33,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 21:15:33,272 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 174.5%
2022-04-15 21:15:49,769 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.880, Acc: 0.969, Base Lr: 7.21e-03
2022-04-15 21:16:05,570 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.892, Acc: 0.967, Base Lr: 7.21e-03
2022-04-15 21:16:17,782 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.163[s] Speed: 98.3[samples/s]
2022-04-15 21:16:51,598 reid_baseline.train INFO: normal accuracy 0.8049116364470966 1.704931616783142 
2022-04-15 21:16:51,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 21:16:51,600 reid_baseline.train INFO: Accuracy: 80.5% Mean Entropy: 170.5%
2022-04-15 21:17:09,019 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.880, Acc: 0.971, Base Lr: 7.60e-03
2022-04-15 21:17:25,639 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 21:17:36,132 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.163[s] Speed: 98.3[samples/s]
2022-04-15 21:18:09,399 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.6589043140411377 
2022-04-15 21:18:12,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 21:18:12,483 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 165.9%
2022-04-15 21:18:28,737 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.876, Acc: 0.968, Base Lr: 4.01e-03
2022-04-15 21:18:44,753 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.869, Acc: 0.972, Base Lr: 4.01e-03
2022-04-15 21:18:56,914 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 21:19:33,961 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.742552638053894 
2022-04-15 21:19:33,963 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 21:19:33,963 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 174.3%
2022-04-15 21:19:51,317 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.849, Acc: 0.979, Base Lr: 3.69e-03
2022-04-15 21:20:05,951 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.851, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 21:20:18,272 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 21:20:49,489 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7242759466171265 
2022-04-15 21:20:49,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 21:20:49,492 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 172.4%
2022-04-15 21:21:05,739 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.844, Acc: 0.976, Base Lr: 3.38e-03
2022-04-15 21:21:19,027 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.844, Acc: 0.978, Base Lr: 3.38e-03
2022-04-15 21:21:30,161 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.149[s] Speed: 107.6[samples/s]
2022-04-15 21:22:03,329 reid_baseline.train INFO: normal accuracy 0.8095019508836355 1.7198728322982788 
2022-04-15 21:22:03,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 21:22:03,332 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 172.0%
2022-04-15 21:22:20,656 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.850, Acc: 0.974, Base Lr: 3.08e-03
2022-04-15 21:22:37,208 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.843, Acc: 0.977, Base Lr: 3.08e-03
2022-04-15 21:22:44,860 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.152[s] Speed: 105.4[samples/s]
2022-04-15 21:23:23,860 reid_baseline.train INFO: normal accuracy 0.8060592150562313 1.7282640933990479 
2022-04-15 21:23:23,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 21:23:23,863 reid_baseline.train INFO: Accuracy: 80.6% Mean Entropy: 172.8%
2022-04-15 21:23:41,227 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 21:23:57,831 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 21:24:07,085 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.158[s] Speed: 101.2[samples/s]
2022-04-15 21:24:46,965 reid_baseline.train INFO: normal accuracy 0.8039935735597888 1.7498410940170288 
2022-04-15 21:24:46,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 21:24:46,968 reid_baseline.train INFO: Accuracy: 80.4% Mean Entropy: 175.0%
2022-04-15 21:25:04,315 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.843, Acc: 0.977, Base Lr: 2.48e-03
2022-04-15 21:25:20,868 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.840, Acc: 0.978, Base Lr: 2.48e-03
2022-04-15 21:25:30,368 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.159[s] Speed: 100.8[samples/s]
2022-04-15 21:26:09,474 reid_baseline.train INFO: normal accuracy 0.8147808124856553 1.6744334697723389 
2022-04-15 21:26:09,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 21:26:09,476 reid_baseline.train INFO: Accuracy: 81.5% Mean Entropy: 167.4%
2022-04-15 21:26:26,819 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 2.20e-03
2022-04-15 21:26:43,394 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.834, Acc: 0.978, Base Lr: 2.20e-03
2022-04-15 21:26:53,281 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.160[s] Speed: 99.9[samples/s]
2022-04-15 21:27:33,777 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.706541657447815 
2022-04-15 21:27:33,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 21:27:33,780 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 170.7%
2022-04-15 21:27:51,196 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.836, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 21:28:07,786 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.841, Acc: 0.976, Base Lr: 1.92e-03
2022-04-15 21:28:17,141 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.159[s] Speed: 100.9[samples/s]
2022-04-15 21:28:53,832 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.736821174621582 
2022-04-15 21:28:53,832 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 21:28:53,832 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 173.7%
2022-04-15 21:29:11,937 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.828, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 21:29:28,536 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 21:29:40,731 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.172[s] Speed: 93.3[samples/s]
2022-04-15 21:30:17,705 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.7363717555999756 
2022-04-15 21:30:17,706 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 21:30:17,706 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 173.6%
2022-04-15 21:30:36,038 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.830, Acc: 0.979, Base Lr: 1.42e-03
2022-04-15 21:30:52,576 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.822, Acc: 0.983, Base Lr: 1.42e-03
2022-04-15 21:31:04,734 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.172[s] Speed: 93.0[samples/s]
2022-04-15 21:31:42,235 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.73885977268219 
2022-04-15 21:31:42,235 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 21:31:42,235 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 173.9%
2022-04-15 21:31:57,791 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.828, Acc: 0.981, Base Lr: 1.19e-03
2022-04-15 21:32:14,329 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.826, Acc: 0.982, Base Lr: 1.19e-03
2022-04-15 21:32:26,521 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 21:33:07,867 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.7247298955917358 
2022-04-15 21:33:07,868 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 21:33:07,868 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 172.5%
2022-04-15 21:33:25,310 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.822, Acc: 0.979, Base Lr: 9.72e-04
2022-04-15 21:33:41,830 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 9.72e-04
2022-04-15 21:33:53,963 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.169[s] Speed: 94.9[samples/s]
2022-04-15 21:34:30,710 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.8101481199264526 
2022-04-15 21:34:30,712 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 21:34:30,712 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 181.0%
2022-04-15 21:34:45,738 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.812, Acc: 0.987, Base Lr: 7.78e-04
2022-04-15 21:35:02,263 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 7.78e-04
2022-04-15 21:35:14,413 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.160[s] Speed: 100.1[samples/s]
2022-04-15 21:35:53,413 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.7611445188522339 
2022-04-15 21:35:53,413 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 21:35:53,413 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 176.1%
2022-04-15 21:36:08,888 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 6.04e-04
2022-04-15 21:36:25,416 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.823, Acc: 0.980, Base Lr: 6.04e-04
2022-04-15 21:36:37,588 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.162[s] Speed: 99.0[samples/s]
2022-04-15 21:37:14,529 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.7747135162353516 
2022-04-15 21:37:14,529 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 21:37:14,529 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 177.5%
2022-04-15 21:37:27,685 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.817, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 21:37:44,267 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 4.51e-04
2022-04-15 21:37:56,453 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.153[s] Speed: 104.4[samples/s]
2022-04-15 21:38:32,714 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.7445855140686035 
2022-04-15 21:38:32,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 21:38:32,714 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 174.5%
2022-04-15 21:38:46,319 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.815, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 21:39:02,851 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 21:39:15,015 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.155[s] Speed: 103.4[samples/s]
2022-04-15 21:39:51,775 reid_baseline.train INFO: normal accuracy 0.8140922653201744 1.771763563156128 
2022-04-15 21:39:51,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 21:39:51,777 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 177.2%
2022-04-15 21:40:05,235 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.816, Acc: 0.982, Base Lr: 2.11e-04
2022-04-15 21:40:21,774 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.815, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 21:40:33,941 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.154[s] Speed: 103.8[samples/s]
2022-04-15 21:41:10,857 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.731303334236145 
2022-04-15 21:41:10,859 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 21:41:10,859 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 173.1%
2022-04-15 21:41:25,044 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.830, Acc: 0.978, Base Lr: 1.26e-04
2022-04-15 21:41:41,576 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.822, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 21:41:53,762 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.157[s] Speed: 102.0[samples/s]
2022-04-15 21:42:29,528 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.740241289138794 
2022-04-15 21:42:29,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 21:42:29,531 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 174.0%
2022-04-15 21:42:42,937 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 21:42:59,469 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 21:43:11,629 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.154[s] Speed: 104.0[samples/s]
2022-04-15 21:43:48,187 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.736901879310608 
2022-04-15 21:43:48,188 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 21:43:48,188 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 173.7%
2022-04-15 21:44:02,624 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.816, Acc: 0.985, Base Lr: 2.83e-05
2022-04-15 21:44:19,207 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.815, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 21:44:31,367 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.158[s] Speed: 101.3[samples/s]
2022-04-15 21:45:08,823 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7286090850830078 
2022-04-15 21:45:08,824 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 21:45:08,824 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 172.9%
2022-04-15 21:45:24,372 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.822, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 21:45:40,937 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 21:45:53,135 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 21:46:32,508 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.7711795568466187 
2022-04-15 21:46:32,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 21:46:32,511 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 177.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_2/transformer_best_model.pth
2022-04-15 21:47:08,815 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.6589043140411377 
2022-04-15 21:47:08,815 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:47:08,815 reid_baseline.train INFO: Accuracy: 81.0%
2022-04-15 21:47:46,245 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.6589043140411377 
2022-04-15 21:47:46,245 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:47:46,246 reid_baseline.train INFO: Shuffled Accuracy: 81.0%
2022-04-15 21:48:08,540 reid_baseline.train INFO: normal accuracy 0.9775486827033218 0.6199718713760376 
2022-04-15 21:48:08,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:48:08,540 reid_baseline.train INFO: Source Clean Accuracy: 97.8%
2022-04-15 21:48:11,593 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_3
2022-04-15 21:48:11,593 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-15 21:48:11,594 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 21:48:11,594 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 21:48:11,594 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 21:48:18,207 reid_baseline.train INFO: start training
2022-04-15 21:48:32,013 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.262, Base Lr: 4.76e-04
2022-04-15 21:48:43,324 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.392, Base Lr: 4.76e-04
2022-04-15 21:48:53,545 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.129[s] Speed: 124.3[samples/s]
2022-04-15 21:49:03,947 reid_baseline.train INFO: normal accuracy 0.4861969509682736 4.170651912689209 
2022-04-15 21:49:07,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 21:49:07,284 reid_baseline.train INFO: Accuracy: 48.6% Mean Entropy: 417.1%
2022-04-15 21:49:24,624 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.778, Acc: 0.599, Base Lr: 8.72e-04
2022-04-15 21:49:41,178 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.667, Acc: 0.607, Base Lr: 8.72e-04
2022-04-15 21:49:50,599 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.159[s] Speed: 100.9[samples/s]
2022-04-15 21:50:01,114 reid_baseline.train INFO: normal accuracy 0.5203955500618047 4.142848014831543 
2022-04-15 21:50:04,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 21:50:04,203 reid_baseline.train INFO: Accuracy: 52.0% Mean Entropy: 414.3%
2022-04-15 21:50:18,147 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.141, Acc: 0.636, Base Lr: 1.27e-03
2022-04-15 21:50:32,557 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.003, Acc: 0.637, Base Lr: 1.27e-03
2022-04-15 21:50:44,767 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.149[s] Speed: 107.7[samples/s]
2022-04-15 21:50:56,808 reid_baseline.train INFO: normal accuracy 0.5570663370416151 3.980119466781616 
2022-04-15 21:50:59,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 21:50:59,902 reid_baseline.train INFO: Accuracy: 55.7% Mean Entropy: 398.0%
2022-04-15 21:51:12,717 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.375, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 21:51:25,788 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.305, Acc: 0.686, Base Lr: 1.66e-03
2022-04-15 21:51:35,408 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.130[s] Speed: 123.0[samples/s]
2022-04-15 21:51:47,294 reid_baseline.train INFO: normal accuracy 0.642356819118253 3.6230568885803223 
2022-04-15 21:51:50,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 21:51:50,729 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 362.3%
2022-04-15 21:52:08,103 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.911, Acc: 0.724, Base Lr: 2.06e-03
2022-04-15 21:52:23,294 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.831, Acc: 0.743, Base Lr: 2.06e-03
2022-04-15 21:52:30,956 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.147[s] Speed: 108.6[samples/s]
2022-04-15 21:52:41,488 reid_baseline.train INFO: normal accuracy 0.6913885455294603 3.2062501907348633 
2022-04-15 21:52:44,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 21:52:44,908 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 320.6%
2022-04-15 21:52:58,095 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.600, Acc: 0.789, Base Lr: 2.46e-03
2022-04-15 21:53:13,884 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.550, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 21:53:26,063 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.151[s] Speed: 106.2[samples/s]
2022-04-15 21:53:38,148 reid_baseline.train INFO: normal accuracy 0.7058096415327565 2.9111404418945312 
2022-04-15 21:53:41,254 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 21:53:41,254 reid_baseline.train INFO: Accuracy: 70.6% Mean Entropy: 291.1%
2022-04-15 21:53:52,943 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.361, Acc: 0.837, Base Lr: 2.85e-03
2022-04-15 21:54:06,081 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.357, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 21:54:16,119 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.128[s] Speed: 125.3[samples/s]
2022-04-15 21:54:28,311 reid_baseline.train INFO: normal accuracy 0.7272352698805109 2.6766228675842285 
2022-04-15 21:54:31,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 21:54:31,403 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 267.7%
2022-04-15 21:54:48,734 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.231, Acc: 0.881, Base Lr: 3.25e-03
2022-04-15 21:55:01,013 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.874, Base Lr: 3.25e-03
2022-04-15 21:55:10,760 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.144[s] Speed: 111.0[samples/s]
2022-04-15 21:55:21,647 reid_baseline.train INFO: normal accuracy 0.7412443345694273 2.4883532524108887 
2022-04-15 21:55:26,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 21:55:26,153 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 248.8%
2022-04-15 21:55:41,189 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.188, Acc: 0.877, Base Lr: 3.64e-03
2022-04-15 21:55:57,800 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 21:56:10,016 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.161[s] Speed: 99.6[samples/s]
2022-04-15 21:56:19,601 reid_baseline.train INFO: normal accuracy 0.749896992171405 2.3240654468536377 
2022-04-15 21:56:23,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 21:56:23,022 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 232.4%
2022-04-15 21:56:36,926 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.906, Base Lr: 4.04e-03
2022-04-15 21:56:49,867 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.117, Acc: 0.903, Base Lr: 4.04e-03
2022-04-15 21:57:00,275 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.136[s] Speed: 117.3[samples/s]
2022-04-15 21:57:15,476 reid_baseline.train INFO: normal accuracy 0.749896992171405 2.1860179901123047 
2022-04-15 21:57:18,567 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 21:57:18,567 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 218.6%
2022-04-15 21:57:34,401 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.078, Acc: 0.917, Base Lr: 4.44e-03
2022-04-15 21:57:46,473 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.076, Acc: 0.914, Base Lr: 4.44e-03
2022-04-15 21:57:56,275 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.138[s] Speed: 115.9[samples/s]
2022-04-15 21:58:06,423 reid_baseline.train INFO: normal accuracy 0.7548413679439637 2.1533942222595215 
2022-04-15 21:58:09,504 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 21:58:09,504 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 215.3%
2022-04-15 21:58:26,823 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.998, Acc: 0.946, Base Lr: 4.83e-03
2022-04-15 21:58:43,376 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.010, Acc: 0.938, Base Lr: 4.83e-03
2022-04-15 21:58:52,557 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.158[s] Speed: 101.5[samples/s]
2022-04-15 21:59:03,895 reid_baseline.train INFO: normal accuracy 0.7494849608570251 2.0578274726867676 
2022-04-15 21:59:07,333 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 21:59:07,334 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 205.8%
2022-04-15 21:59:21,391 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.990, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 21:59:36,336 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.992, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 21:59:48,541 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.151[s] Speed: 106.0[samples/s]
2022-04-15 22:00:00,814 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.9960261583328247 
2022-04-15 22:00:05,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 22:00:05,237 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 199.6%
2022-04-15 22:00:16,379 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.969, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 22:00:29,461 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.962, Acc: 0.949, Base Lr: 5.62e-03
2022-04-15 22:00:39,136 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.124[s] Speed: 128.9[samples/s]
2022-04-15 22:00:50,874 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.975916862487793 
2022-04-15 22:00:53,962 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 22:00:53,963 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 197.6%
2022-04-15 22:01:11,359 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.943, Acc: 0.950, Base Lr: 6.02e-03
2022-04-15 22:01:26,672 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.944, Acc: 0.949, Base Lr: 6.02e-03
2022-04-15 22:01:33,816 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.146[s] Speed: 109.6[samples/s]
2022-04-15 22:01:44,491 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.8813313245773315 
2022-04-15 22:01:49,245 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 22:01:49,245 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 188.1%
2022-04-15 22:02:02,869 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.923, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 22:02:18,093 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.924, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 22:02:30,283 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.150[s] Speed: 106.5[samples/s]
2022-04-15 22:02:42,467 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.9741462469100952 
2022-04-15 22:02:42,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 22:02:42,470 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 197.4%
2022-04-15 22:02:55,578 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.893, Acc: 0.972, Base Lr: 6.81e-03
2022-04-15 22:03:08,778 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.904, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 22:03:17,405 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.128[s] Speed: 125.1[samples/s]
2022-04-15 22:03:29,280 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.9499180316925049 
2022-04-15 22:03:29,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 22:03:29,283 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 195.0%
2022-04-15 22:03:46,677 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.888, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 22:04:03,302 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.895, Acc: 0.962, Base Lr: 7.21e-03
2022-04-15 22:04:12,418 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.158[s] Speed: 101.3[samples/s]
2022-04-15 22:04:25,100 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9195609092712402 
2022-04-15 22:04:25,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 22:04:25,102 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 192.0%
2022-04-15 22:04:38,132 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.877, Acc: 0.974, Base Lr: 7.60e-03
2022-04-15 22:04:51,613 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.882, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 22:05:03,802 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.142[s] Speed: 112.9[samples/s]
2022-04-15 22:05:15,925 reid_baseline.train INFO: normal accuracy 0.7470127729707458 1.8772633075714111 
2022-04-15 22:05:19,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 22:05:19,330 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 187.7%
2022-04-15 22:05:32,913 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.874, Acc: 0.970, Base Lr: 4.01e-03
2022-04-15 22:05:45,744 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.865, Acc: 0.973, Base Lr: 4.01e-03
2022-04-15 22:05:55,410 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.132[s] Speed: 121.1[samples/s]
2022-04-15 22:06:08,268 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.942144751548767 
2022-04-15 22:06:08,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 22:06:08,270 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 194.2%
2022-04-15 22:06:25,558 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.847, Acc: 0.982, Base Lr: 3.69e-03
2022-04-15 22:06:42,164 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.851, Acc: 0.977, Base Lr: 3.69e-03
2022-04-15 22:06:52,102 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.161[s] Speed: 99.7[samples/s]
2022-04-15 22:07:03,018 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.9683138132095337 
2022-04-15 22:07:03,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 22:07:03,018 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 196.8%
2022-04-15 22:07:16,267 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.839, Acc: 0.982, Base Lr: 3.38e-03
2022-04-15 22:07:30,751 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.843, Acc: 0.981, Base Lr: 3.38e-03
2022-04-15 22:07:42,964 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.146[s] Speed: 109.4[samples/s]
2022-04-15 22:07:55,180 reid_baseline.train INFO: normal accuracy 0.7519571487433044 2.0089528560638428 
2022-04-15 22:07:55,183 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 22:07:55,183 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 200.9%
2022-04-15 22:08:09,938 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.850, Acc: 0.976, Base Lr: 3.08e-03
2022-04-15 22:08:22,044 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.08e-03
2022-04-15 22:08:31,608 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.133[s] Speed: 119.9[samples/s]
2022-04-15 22:08:41,621 reid_baseline.train INFO: normal accuracy 0.749896992171405 1.9368553161621094 
2022-04-15 22:08:41,622 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 22:08:41,622 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 193.7%
2022-04-15 22:08:59,015 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.831, Acc: 0.984, Base Lr: 2.77e-03
2022-04-15 22:09:15,617 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.835, Acc: 0.982, Base Lr: 2.77e-03
2022-04-15 22:09:27,322 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.167[s] Speed: 95.6[samples/s]
2022-04-15 22:09:38,161 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9567769765853882 
2022-04-15 22:09:38,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 22:09:38,164 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 195.7%
2022-04-15 22:09:51,635 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.839, Acc: 0.975, Base Lr: 2.48e-03
2022-04-15 22:10:05,519 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.835, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 22:10:17,763 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.145[s] Speed: 110.3[samples/s]
2022-04-15 22:10:29,888 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9514943361282349 
2022-04-15 22:10:29,890 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 22:10:29,890 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 195.1%
2022-04-15 22:10:45,905 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.829, Acc: 0.980, Base Lr: 2.20e-03
2022-04-15 22:10:58,014 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.837, Acc: 0.978, Base Lr: 2.20e-03
2022-04-15 22:11:07,118 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.136[s] Speed: 117.4[samples/s]
2022-04-15 22:11:17,758 reid_baseline.train INFO: normal accuracy 0.7511330861145447 1.9771424531936646 
2022-04-15 22:11:17,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 22:11:17,759 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 197.7%
2022-04-15 22:11:35,149 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.834, Acc: 0.974, Base Lr: 1.92e-03
2022-04-15 22:11:51,748 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.837, Acc: 0.974, Base Lr: 1.92e-03
2022-04-15 22:12:03,427 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.167[s] Speed: 95.7[samples/s]
2022-04-15 22:12:13,487 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.995691180229187 
2022-04-15 22:12:13,487 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 22:12:13,488 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 199.6%
2022-04-15 22:12:26,742 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.832, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 22:12:40,571 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.832, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 22:12:52,738 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.144[s] Speed: 111.3[samples/s]
2022-04-15 22:13:04,866 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.9881373643875122 
2022-04-15 22:13:04,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 22:13:04,869 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 198.8%
2022-04-15 22:13:21,242 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.831, Acc: 0.980, Base Lr: 1.42e-03
2022-04-15 22:13:32,196 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.825, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 22:13:42,015 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.136[s] Speed: 117.6[samples/s]
2022-04-15 22:13:53,103 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.9990363121032715 
2022-04-15 22:13:53,106 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 22:13:53,106 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 199.9%
2022-04-15 22:14:09,271 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.827, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 22:14:25,878 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.822, Acc: 0.981, Base Lr: 1.19e-03
2022-04-15 22:14:38,078 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.165[s] Speed: 97.1[samples/s]
2022-04-15 22:14:54,453 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.9812413454055786 
2022-04-15 22:14:54,454 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 22:14:54,454 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 198.1%
2022-04-15 22:15:07,861 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.819, Acc: 0.981, Base Lr: 9.72e-04
2022-04-15 22:15:20,105 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 22:15:27,376 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.121[s] Speed: 132.7[samples/s]
2022-04-15 22:15:37,803 reid_baseline.train INFO: normal accuracy 0.7503090234857849 2.044145345687866 
2022-04-15 22:15:37,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 22:15:37,806 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 204.4%
2022-04-15 22:15:50,849 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.814, Acc: 0.984, Base Lr: 7.78e-04
2022-04-15 22:16:01,675 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.817, Acc: 0.982, Base Lr: 7.78e-04
2022-04-15 22:16:11,975 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.125[s] Speed: 127.9[samples/s]
2022-04-15 22:16:22,708 reid_baseline.train INFO: normal accuracy 0.7470127729707458 2.030665636062622 
2022-04-15 22:16:22,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 22:16:22,710 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 203.1%
2022-04-15 22:16:38,407 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.817, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 22:16:51,675 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.822, Acc: 0.978, Base Lr: 6.04e-04
2022-04-15 22:16:58,181 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.130[s] Speed: 123.2[samples/s]
2022-04-15 22:17:10,380 reid_baseline.train INFO: normal accuracy 0.7482488669138855 2.0302343368530273 
2022-04-15 22:17:10,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 22:17:10,382 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 203.0%
2022-04-15 22:17:27,759 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.816, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 22:17:43,906 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 4.51e-04
2022-04-15 22:17:55,465 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.165[s] Speed: 96.9[samples/s]
2022-04-15 22:18:09,024 reid_baseline.train INFO: normal accuracy 0.7466007416563659 2.018134117126465 
2022-04-15 22:18:09,026 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 22:18:09,026 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 201.8%
2022-04-15 22:18:26,345 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.812, Acc: 0.983, Base Lr: 3.20e-04
2022-04-15 22:18:42,908 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 22:18:53,642 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.163[s] Speed: 97.9[samples/s]
2022-04-15 22:19:06,452 reid_baseline.train INFO: normal accuracy 0.7503090234857849 2.0333311557769775 
2022-04-15 22:19:06,454 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 22:19:06,454 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 203.3%
2022-04-15 22:19:23,715 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.811, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 22:19:40,278 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.813, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 22:19:50,952 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.163[s] Speed: 98.2[samples/s]
2022-04-15 22:20:02,944 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.9793730974197388 
2022-04-15 22:20:02,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 22:20:02,945 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 197.9%
2022-04-15 22:20:20,244 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.826, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 22:20:36,842 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 1.26e-04
2022-04-15 22:20:47,283 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 22:20:58,650 reid_baseline.train INFO: normal accuracy 0.7470127729707458 2.0161468982696533 
2022-04-15 22:20:58,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 22:20:58,653 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 201.6%
2022-04-15 22:21:16,067 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 6.51e-05
2022-04-15 22:21:32,681 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 22:21:44,084 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 22:21:56,172 reid_baseline.train INFO: normal accuracy 0.7474248042851257 2.0098209381103516 
2022-04-15 22:21:56,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 22:21:56,173 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 201.0%
2022-04-15 22:22:15,049 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.816, Acc: 0.986, Base Lr: 2.83e-05
2022-04-15 22:22:31,607 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.814, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 22:22:43,769 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.174[s] Speed: 91.8[samples/s]
2022-04-15 22:22:56,449 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.9898364543914795 
2022-04-15 22:22:56,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 22:22:56,451 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 199.0%
2022-04-15 22:23:14,515 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.820, Acc: 0.981, Base Lr: 1.60e-05
2022-04-15 22:23:31,113 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.817, Acc: 0.981, Base Lr: 1.60e-05
2022-04-15 22:23:43,290 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.172[s] Speed: 93.3[samples/s]
2022-04-15 22:23:58,992 reid_baseline.train INFO: normal accuracy 0.7482488669138855 2.0173990726470947 
2022-04-15 22:23:58,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 22:23:58,993 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 201.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_3/transformer_best_model.pth
2022-04-15 22:24:17,120 reid_baseline.train INFO: normal accuracy 0.7470127729707458 1.8772633075714111 
2022-04-15 22:24:17,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:24:17,121 reid_baseline.train INFO: Accuracy: 74.7%
2022-04-15 22:24:29,430 reid_baseline.train INFO: normal accuracy 0.7470127729707458 1.8772633075714111 
2022-04-15 22:24:29,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:24:29,430 reid_baseline.train INFO: Shuffled Accuracy: 74.7%
2022-04-15 22:24:47,459 reid_baseline.train INFO: normal accuracy 0.9786941580756013 0.6057252883911133 
2022-04-15 22:24:47,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:24:47,459 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
2022-04-15 22:24:50,985 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_3
2022-04-15 22:24:50,985 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-15 22:24:50,985 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 22:24:50,985 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 22:24:50,986 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 22:24:55,077 reid_baseline.train INFO: start training
2022-04-15 22:25:12,591 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.262, Base Lr: 4.76e-04
2022-04-15 22:25:29,184 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.392, Base Lr: 4.76e-04
2022-04-15 22:25:40,930 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.168[s] Speed: 95.4[samples/s]
2022-04-15 22:26:16,464 reid_baseline.train INFO: normal accuracy 0.5618544870323617 4.170406818389893 
2022-04-15 22:26:19,845 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 22:26:19,845 reid_baseline.train INFO: Accuracy: 56.2% Mean Entropy: 417.0%
2022-04-15 22:26:34,527 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.778, Acc: 0.599, Base Lr: 8.72e-04
2022-04-15 22:26:50,642 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.667, Acc: 0.607, Base Lr: 8.72e-04
2022-04-15 22:27:02,316 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.156[s] Speed: 102.9[samples/s]
2022-04-15 22:27:34,179 reid_baseline.train INFO: normal accuracy 0.5903144365389029 4.136245250701904 
2022-04-15 22:27:37,604 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 22:27:37,605 reid_baseline.train INFO: Accuracy: 59.0% Mean Entropy: 413.6%
2022-04-15 22:27:56,121 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.141, Acc: 0.636, Base Lr: 1.27e-03
2022-04-15 22:28:12,667 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.003, Acc: 0.637, Base Lr: 1.27e-03
2022-04-15 22:28:24,836 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.173[s] Speed: 92.6[samples/s]
2022-04-15 22:28:59,353 reid_baseline.train INFO: normal accuracy 0.6208400275418866 3.9212512969970703 
2022-04-15 22:29:03,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 22:29:03,966 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 392.1%
2022-04-15 22:29:21,422 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.375, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 22:29:35,854 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.305, Acc: 0.686, Base Lr: 1.66e-03
2022-04-15 22:29:47,480 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.159[s] Speed: 100.6[samples/s]
2022-04-15 22:30:18,376 reid_baseline.train INFO: normal accuracy 0.698645857241221 3.456899404525757 
2022-04-15 22:30:21,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 22:30:21,813 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 345.7%
2022-04-15 22:30:38,933 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.911, Acc: 0.724, Base Lr: 2.06e-03
2022-04-15 22:30:55,509 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.831, Acc: 0.743, Base Lr: 2.06e-03
2022-04-15 22:31:07,688 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.168[s] Speed: 95.4[samples/s]
2022-04-15 22:31:45,393 reid_baseline.train INFO: normal accuracy 0.7454670644939179 2.974775552749634 
2022-04-15 22:31:49,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 22:31:49,175 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 297.5%
2022-04-15 22:32:05,009 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.600, Acc: 0.789, Base Lr: 2.46e-03
2022-04-15 22:32:21,337 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.550, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 22:32:33,545 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-15 22:33:09,052 reid_baseline.train INFO: normal accuracy 0.7702547624512279 2.6514220237731934 
2022-04-15 22:33:12,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 22:33:12,141 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 265.1%
2022-04-15 22:33:29,561 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.361, Acc: 0.837, Base Lr: 2.85e-03
2022-04-15 22:33:46,151 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.357, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 22:33:56,657 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.163[s] Speed: 98.3[samples/s]
2022-04-15 22:34:28,650 reid_baseline.train INFO: normal accuracy 0.7886160201973835 2.4116833209991455 
2022-04-15 22:34:32,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 22:34:32,541 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 241.2%
2022-04-15 22:34:48,870 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.231, Acc: 0.881, Base Lr: 3.25e-03
2022-04-15 22:35:03,702 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.874, Base Lr: 3.25e-03
2022-04-15 22:35:15,872 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.158[s] Speed: 101.0[samples/s]
2022-04-15 22:35:52,261 reid_baseline.train INFO: normal accuracy 0.7971081019049805 2.2278897762298584 
2022-04-15 22:35:56,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 22:35:56,653 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 222.8%
2022-04-15 22:36:14,016 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.188, Acc: 0.877, Base Lr: 3.64e-03
2022-04-15 22:36:29,805 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 22:36:41,534 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.164[s] Speed: 97.5[samples/s]
2022-04-15 22:37:13,685 reid_baseline.train INFO: normal accuracy 0.8046821207252697 2.0717217922210693 
2022-04-15 22:37:16,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 22:37:16,766 reid_baseline.train INFO: Accuracy: 80.5% Mean Entropy: 207.2%
2022-04-15 22:37:33,998 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.906, Base Lr: 4.04e-03
2022-04-15 22:37:50,570 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.117, Acc: 0.903, Base Lr: 4.04e-03
2022-04-15 22:38:02,746 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.168[s] Speed: 95.2[samples/s]
2022-04-15 22:38:38,919 reid_baseline.train INFO: normal accuracy 0.8101904980491164 1.9459730386734009 
2022-04-15 22:38:42,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 22:38:42,983 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 194.6%
2022-04-15 22:39:00,307 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.078, Acc: 0.917, Base Lr: 4.44e-03
2022-04-15 22:39:15,279 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.076, Acc: 0.914, Base Lr: 4.44e-03
2022-04-15 22:39:27,461 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 22:40:02,307 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.923866629600525 
2022-04-15 22:40:05,711 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 22:40:05,711 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 192.4%
2022-04-15 22:40:23,157 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.998, Acc: 0.946, Base Lr: 4.83e-03
2022-04-15 22:40:39,774 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.010, Acc: 0.938, Base Lr: 4.83e-03
2022-04-15 22:40:50,417 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.163[s] Speed: 97.9[samples/s]
2022-04-15 22:41:22,437 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.8491750955581665 
2022-04-15 22:41:25,873 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 22:41:25,874 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 184.9%
2022-04-15 22:41:41,490 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.990, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 22:41:58,120 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.992, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 22:42:10,328 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 22:42:43,066 reid_baseline.train INFO: normal accuracy 0.8136332338765205 1.7989146709442139 
2022-04-15 22:42:46,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 22:42:46,488 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 179.9%
2022-04-15 22:43:03,886 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.969, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 22:43:18,588 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.962, Acc: 0.949, Base Lr: 5.62e-03
2022-04-15 22:43:30,840 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 22:44:06,934 reid_baseline.train INFO: normal accuracy 0.81592839109479 1.7817226648330688 
2022-04-15 22:44:10,873 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 22:44:10,874 reid_baseline.train INFO: Accuracy: 81.6% Mean Entropy: 178.2%
2022-04-15 22:44:27,590 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.943, Acc: 0.950, Base Lr: 6.02e-03
2022-04-15 22:44:44,128 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.944, Acc: 0.949, Base Lr: 6.02e-03
2022-04-15 22:44:56,348 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 22:45:29,508 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.690268635749817 
2022-04-15 22:45:32,612 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 22:45:32,612 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 169.0%
2022-04-15 22:45:50,006 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.923, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 22:46:04,940 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.924, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 22:46:17,165 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.163[s] Speed: 98.2[samples/s]
2022-04-15 22:46:48,700 reid_baseline.train INFO: normal accuracy 0.8138627495983475 1.7532098293304443 
2022-04-15 22:46:48,703 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 22:46:48,703 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 175.3%
2022-04-15 22:47:05,503 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.893, Acc: 0.972, Base Lr: 6.81e-03
2022-04-15 22:47:22,074 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.904, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 22:47:34,240 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.167[s] Speed: 96.1[samples/s]
2022-04-15 22:48:08,074 reid_baseline.train INFO: normal accuracy 0.807436309387193 1.7417060136795044 
2022-04-15 22:48:08,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 22:48:08,076 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 174.2%
2022-04-15 22:48:25,404 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.888, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 22:48:40,394 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.895, Acc: 0.962, Base Lr: 7.21e-03
2022-04-15 22:48:52,580 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.163[s] Speed: 98.3[samples/s]
2022-04-15 22:49:25,637 reid_baseline.train INFO: normal accuracy 0.8129446867110397 1.7009626626968384 
2022-04-15 22:49:25,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 22:49:25,640 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 170.1%
2022-04-15 22:49:43,072 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.877, Acc: 0.974, Base Lr: 7.60e-03
2022-04-15 22:49:59,693 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.882, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 22:50:11,030 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.166[s] Speed: 96.4[samples/s]
2022-04-15 22:50:45,016 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.6643383502960205 
2022-04-15 22:50:48,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 22:50:48,114 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 166.4%
2022-04-15 22:51:03,977 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.874, Acc: 0.970, Base Lr: 4.01e-03
2022-04-15 22:51:20,384 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.865, Acc: 0.973, Base Lr: 4.01e-03
2022-04-15 22:51:32,540 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.162[s] Speed: 98.5[samples/s]
2022-04-15 22:52:08,202 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.7297430038452148 
2022-04-15 22:52:08,205 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 22:52:08,205 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 173.0%
2022-04-15 22:52:25,571 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.847, Acc: 0.982, Base Lr: 3.69e-03
2022-04-15 22:52:41,361 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.851, Acc: 0.977, Base Lr: 3.69e-03
2022-04-15 22:52:50,570 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.155[s] Speed: 103.3[samples/s]
2022-04-15 22:53:26,572 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.7458291053771973 
2022-04-15 22:53:26,574 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 22:53:26,574 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 174.6%
2022-04-15 22:53:40,275 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.839, Acc: 0.982, Base Lr: 3.38e-03
2022-04-15 22:53:50,479 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.843, Acc: 0.981, Base Lr: 3.38e-03
2022-04-15 22:54:02,664 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.132[s] Speed: 121.3[samples/s]
2022-04-15 22:54:35,932 reid_baseline.train INFO: normal accuracy 0.8147808124856553 1.7706485986709595 
2022-04-15 22:54:35,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 22:54:35,933 reid_baseline.train INFO: Accuracy: 81.5% Mean Entropy: 177.1%
2022-04-15 22:54:49,921 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.850, Acc: 0.976, Base Lr: 3.08e-03
2022-04-15 22:55:02,442 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.08e-03
2022-04-15 22:55:14,605 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.141[s] Speed: 113.2[samples/s]
2022-04-15 22:55:49,166 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7188704013824463 
2022-04-15 22:55:49,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 22:55:49,167 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 171.9%
2022-04-15 22:56:03,505 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.831, Acc: 0.984, Base Lr: 2.77e-03
2022-04-15 22:56:17,006 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.835, Acc: 0.982, Base Lr: 2.77e-03
2022-04-15 22:56:29,188 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.146[s] Speed: 109.3[samples/s]
2022-04-15 22:57:02,755 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.7375272512435913 
2022-04-15 22:57:02,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 22:57:02,755 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 173.8%
2022-04-15 22:57:16,605 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.839, Acc: 0.975, Base Lr: 2.48e-03
2022-04-15 22:57:30,180 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.835, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 22:57:42,354 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.145[s] Speed: 110.5[samples/s]
2022-04-15 22:58:15,294 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.7140713930130005 
2022-04-15 22:58:15,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 22:58:15,295 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 171.4%
2022-04-15 22:58:29,850 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.829, Acc: 0.980, Base Lr: 2.20e-03
2022-04-15 22:58:43,626 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.837, Acc: 0.978, Base Lr: 2.20e-03
2022-04-15 22:58:55,812 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.148[s] Speed: 108.0[samples/s]
2022-04-15 22:59:31,047 reid_baseline.train INFO: normal accuracy 0.8143217810420014 1.738450050354004 
2022-04-15 22:59:31,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 22:59:31,050 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 173.8%
2022-04-15 22:59:44,654 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.834, Acc: 0.974, Base Lr: 1.92e-03
2022-04-15 22:59:57,051 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.837, Acc: 0.974, Base Lr: 1.92e-03
2022-04-15 23:00:09,216 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.140[s] Speed: 114.7[samples/s]
2022-04-15 23:00:41,538 reid_baseline.train INFO: normal accuracy 0.8131742024328666 1.7661781311035156 
2022-04-15 23:00:41,538 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 23:00:41,539 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 176.6%
2022-04-15 23:00:55,619 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.832, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 23:01:08,157 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.832, Acc: 0.979, Base Lr: 1.66e-03
2022-04-15 23:01:19,743 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.140[s] Speed: 114.6[samples/s]
2022-04-15 23:01:50,529 reid_baseline.train INFO: normal accuracy 0.8140922653201744 1.7480580806732178 
2022-04-15 23:01:50,530 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 23:01:50,530 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 174.8%
2022-04-15 23:02:04,676 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.831, Acc: 0.980, Base Lr: 1.42e-03
2022-04-15 23:02:17,669 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.825, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 23:02:28,404 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.138[s] Speed: 115.6[samples/s]
2022-04-15 23:03:00,473 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.757493019104004 
2022-04-15 23:03:00,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 23:03:00,475 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 175.7%
2022-04-15 23:03:14,510 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.827, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 23:03:26,547 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.822, Acc: 0.981, Base Lr: 1.19e-03
2022-04-15 23:03:35,703 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.129[s] Speed: 124.3[samples/s]
2022-04-15 23:04:12,894 reid_baseline.train INFO: normal accuracy 0.81592839109479 1.7455726861953735 
2022-04-15 23:04:12,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 23:04:12,894 reid_baseline.train INFO: Accuracy: 81.6% Mean Entropy: 174.6%
2022-04-15 23:04:26,830 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.819, Acc: 0.981, Base Lr: 9.72e-04
2022-04-15 23:04:39,867 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 23:04:49,791 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.135[s] Speed: 118.6[samples/s]
2022-04-15 23:05:20,340 reid_baseline.train INFO: normal accuracy 0.8140922653201744 1.8106307983398438 
2022-04-15 23:05:20,340 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 23:05:20,341 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 181.1%
2022-04-15 23:05:33,303 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.814, Acc: 0.984, Base Lr: 7.78e-04
2022-04-15 23:05:45,867 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.817, Acc: 0.982, Base Lr: 7.78e-04
2022-04-15 23:05:55,318 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.128[s] Speed: 125.1[samples/s]
2022-04-15 23:06:28,599 reid_baseline.train INFO: normal accuracy 0.8129446867110397 1.8047300577163696 
2022-04-15 23:06:28,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 23:06:28,602 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 180.5%
2022-04-15 23:06:41,734 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.817, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 23:06:53,696 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.822, Acc: 0.978, Base Lr: 6.04e-04
2022-04-15 23:07:03,400 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.127[s] Speed: 125.8[samples/s]
2022-04-15 23:07:38,033 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.8011577129364014 
2022-04-15 23:07:38,036 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 23:07:38,036 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 180.1%
2022-04-15 23:07:52,122 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.816, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 23:08:05,224 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 4.51e-04
2022-04-15 23:08:14,931 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.135[s] Speed: 118.6[samples/s]
2022-04-15 23:08:48,773 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.7810249328613281 
2022-04-15 23:08:48,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 23:08:48,775 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 178.1%
2022-04-15 23:09:04,766 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.812, Acc: 0.983, Base Lr: 3.20e-04
2022-04-15 23:09:16,291 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 23:09:26,124 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.137[s] Speed: 117.2[samples/s]
2022-04-15 23:10:02,294 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.8032854795455933 
2022-04-15 23:10:02,297 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 23:10:02,297 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 180.3%
2022-04-15 23:10:18,547 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.811, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 23:10:29,867 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.813, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 23:10:39,275 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.135[s] Speed: 118.4[samples/s]
2022-04-15 23:11:14,951 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.7423231601715088 
2022-04-15 23:11:14,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 23:11:14,953 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 174.2%
2022-04-15 23:11:32,304 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.826, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 23:11:43,533 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 1.26e-04
2022-04-15 23:11:53,360 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.140[s] Speed: 114.0[samples/s]
2022-04-15 23:12:28,401 reid_baseline.train INFO: normal accuracy 0.8136332338765205 1.7757022380828857 
2022-04-15 23:12:28,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 23:12:28,403 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 177.6%
2022-04-15 23:12:45,797 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 6.51e-05
2022-04-15 23:12:58,080 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 23:13:08,238 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.146[s] Speed: 109.9[samples/s]
2022-04-15 23:13:42,099 reid_baseline.train INFO: normal accuracy 0.8129446867110397 1.7710970640182495 
2022-04-15 23:13:42,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 23:13:42,099 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 177.1%
2022-04-15 23:13:59,457 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.816, Acc: 0.986, Base Lr: 2.83e-05
2022-04-15 23:14:11,791 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.814, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 23:14:21,266 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.143[s] Speed: 111.7[samples/s]
2022-04-15 23:14:58,668 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.75071382522583 
2022-04-15 23:14:58,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 23:14:58,668 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 175.1%
2022-04-15 23:15:16,007 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.820, Acc: 0.981, Base Lr: 1.60e-05
2022-04-15 23:15:28,595 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.817, Acc: 0.981, Base Lr: 1.60e-05
2022-04-15 23:15:38,253 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.145[s] Speed: 110.6[samples/s]
2022-04-15 23:16:14,727 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.781578540802002 
2022-04-15 23:16:14,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 23:16:14,730 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 178.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_3/transformer_best_model.pth
2022-04-15 23:16:53,756 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.6643383502960205 
2022-04-15 23:16:53,756 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:16:53,756 reid_baseline.train INFO: Accuracy: 81.0%
2022-04-15 23:17:28,615 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.6643383502960205 
2022-04-15 23:17:28,615 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:17:28,615 reid_baseline.train INFO: Shuffled Accuracy: 81.0%
2022-04-15 23:17:48,456 reid_baseline.train INFO: normal accuracy 0.9786941580756013 0.6057252883911133 
2022-04-15 23:17:48,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:17:48,456 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
