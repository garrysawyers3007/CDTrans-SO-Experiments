2022-04-16 15:31:29,449 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_4
2022-04-16 15:31:29,449 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-16 15:31:29,450 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 15:31:29,450 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 15:31:29,450 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 15:31:37,585 reid_baseline.train INFO: start training
2022-04-16 15:32:22,932 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.164, Base Lr: 4.76e-04
2022-04-16 15:33:01,257 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.298, Base Lr: 4.76e-04
2022-04-16 15:33:27,053 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-16 15:33:56,191 reid_baseline.train INFO: normal accuracy 0.48702101359703337 4.171700954437256 
2022-04-16 15:33:59,308 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 15:33:59,309 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 417.2%
2022-04-16 15:34:38,277 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.890, Acc: 0.570, Base Lr: 8.72e-04
2022-04-16 15:35:15,554 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.816, Acc: 0.553, Base Lr: 8.72e-04
2022-04-16 15:35:41,106 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-16 15:36:14,096 reid_baseline.train INFO: normal accuracy 0.5265760197775031 4.152739524841309 
2022-04-16 15:36:18,145 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 15:36:18,146 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 415.3%
2022-04-16 15:36:55,618 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.384, Acc: 0.597, Base Lr: 1.27e-03
2022-04-16 15:37:34,426 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.273, Acc: 0.576, Base Lr: 1.27e-03
2022-04-16 15:37:59,151 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-04-16 15:38:29,479 reid_baseline.train INFO: normal accuracy 0.5517099299546766 4.010866641998291 
2022-04-16 15:38:32,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 15:38:32,583 reid_baseline.train INFO: Accuracy: 55.2% Mean Entropy: 401.1%
2022-04-16 15:39:09,420 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.720, Acc: 0.589, Base Lr: 1.66e-03
2022-04-16 15:39:46,232 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.592, Acc: 0.613, Base Lr: 1.66e-03
2022-04-16 15:40:09,006 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-16 15:40:40,678 reid_baseline.train INFO: normal accuracy 0.6007416563658838 3.6198954582214355 
2022-04-16 15:40:45,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 15:40:45,095 reid_baseline.train INFO: Accuracy: 60.1% Mean Entropy: 362.0%
2022-04-16 15:41:24,777 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.177, Acc: 0.663, Base Lr: 2.06e-03
2022-04-16 15:42:02,541 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.107, Acc: 0.676, Base Lr: 2.06e-03
2022-04-16 15:42:27,050 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.373[s] Speed: 42.8[samples/s]
2022-04-16 15:42:57,109 reid_baseline.train INFO: normal accuracy 0.6551297898640297 3.183697462081909 
2022-04-16 15:43:01,185 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 15:43:01,186 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 318.4%
2022-04-16 15:43:40,808 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.800, Acc: 0.733, Base Lr: 2.46e-03
2022-04-16 15:44:17,118 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.779, Acc: 0.737, Base Lr: 2.46e-03
2022-04-16 15:44:39,977 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-16 15:45:28,525 reid_baseline.train INFO: normal accuracy 0.6913885455294603 2.8146045207977295 
2022-04-16 15:45:32,550 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 15:45:32,551 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 281.5%
2022-04-16 15:46:06,574 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.618, Acc: 0.766, Base Lr: 2.85e-03
2022-04-16 15:46:43,800 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.599, Acc: 0.764, Base Lr: 2.85e-03
2022-04-16 15:47:08,212 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 15:47:41,857 reid_baseline.train INFO: normal accuracy 0.6988051091882983 2.5728697776794434 
2022-04-16 15:47:46,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 15:47:46,413 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 257.3%
2022-04-16 15:48:26,944 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.455, Acc: 0.806, Base Lr: 3.25e-03
2022-04-16 15:49:04,636 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.458, Acc: 0.801, Base Lr: 3.25e-03
2022-04-16 15:49:30,975 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 15:50:01,448 reid_baseline.train INFO: normal accuracy 0.7169344870210136 2.3902699947357178 
2022-04-16 15:50:04,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 15:50:04,544 reid_baseline.train INFO: Accuracy: 71.7% Mean Entropy: 239.0%
2022-04-16 15:50:44,679 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.393, Acc: 0.812, Base Lr: 3.64e-03
2022-04-16 15:51:22,561 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.364, Acc: 0.823, Base Lr: 3.64e-03
2022-04-16 15:51:47,497 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.377[s] Speed: 42.4[samples/s]
2022-04-16 15:52:19,614 reid_baseline.train INFO: normal accuracy 0.7284713638236506 2.290177345275879 
2022-04-16 15:52:24,130 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 15:52:24,130 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 229.0%
2022-04-16 15:53:05,353 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.302, Acc: 0.841, Base Lr: 4.04e-03
2022-04-16 15:53:43,167 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.309, Acc: 0.840, Base Lr: 4.04e-03
2022-04-16 15:54:09,061 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.384[s] Speed: 41.6[samples/s]
2022-04-16 15:54:44,371 reid_baseline.train INFO: normal accuracy 0.7268232385661311 2.182785987854004 
2022-04-16 15:54:47,504 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 15:54:47,505 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 218.3%
2022-04-16 15:55:25,151 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.244, Acc: 0.861, Base Lr: 4.44e-03
2022-04-16 15:56:03,142 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.259, Acc: 0.857, Base Lr: 4.44e-03
2022-04-16 15:56:28,380 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.369[s] Speed: 43.3[samples/s]
2022-04-16 15:56:58,881 reid_baseline.train INFO: normal accuracy 0.7362999587968686 2.0896284580230713 
2022-04-16 15:57:02,008 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 15:57:02,008 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 209.0%
2022-04-16 15:57:43,724 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.210, Acc: 0.867, Base Lr: 4.83e-03
2022-04-16 15:58:19,527 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.208, Acc: 0.867, Base Lr: 4.83e-03
2022-04-16 15:58:43,796 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-16 15:59:15,997 reid_baseline.train INFO: normal accuracy 0.7445405850844664 2.012998580932617 
2022-04-16 15:59:20,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 15:59:20,608 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 201.3%
2022-04-16 16:00:01,069 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.147, Acc: 0.886, Base Lr: 5.23e-03
2022-04-16 16:00:39,704 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.158, Acc: 0.885, Base Lr: 5.23e-03
2022-04-16 16:01:04,185 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-16 16:01:30,373 reid_baseline.train INFO: normal accuracy 0.7395962093119077 2.004793405532837 
2022-04-16 16:01:33,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 16:01:33,481 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 200.5%
2022-04-16 16:02:11,504 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.114, Acc: 0.892, Base Lr: 5.62e-03
2022-04-16 16:02:47,703 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.122, Acc: 0.893, Base Lr: 5.62e-03
2022-04-16 16:03:13,429 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-04-16 16:03:44,851 reid_baseline.train INFO: normal accuracy 0.7428924598269468 2.0109760761260986 
2022-04-16 16:03:44,856 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 16:03:44,856 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 201.1%
2022-04-16 16:04:23,291 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.084, Acc: 0.907, Base Lr: 6.02e-03
2022-04-16 16:05:02,425 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.094, Acc: 0.903, Base Lr: 6.02e-03
2022-04-16 16:05:29,291 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 16:06:00,964 reid_baseline.train INFO: normal accuracy 0.7354758961681088 1.9445898532867432 
2022-04-16 16:06:04,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 16:06:04,070 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 194.5%
2022-04-16 16:06:44,751 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.061, Acc: 0.916, Base Lr: 6.42e-03
2022-04-16 16:07:22,248 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.073, Acc: 0.914, Base Lr: 6.42e-03
2022-04-16 16:07:44,723 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.369[s] Speed: 43.4[samples/s]
2022-04-16 16:08:17,714 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.92933988571167 
2022-04-16 16:08:20,865 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 16:08:20,866 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 192.9%
2022-04-16 16:09:00,296 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.051, Acc: 0.917, Base Lr: 6.81e-03
2022-04-16 16:09:38,753 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.048, Acc: 0.919, Base Lr: 6.81e-03
2022-04-16 16:10:04,497 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.380[s] Speed: 42.2[samples/s]
2022-04-16 16:10:36,692 reid_baseline.train INFO: normal accuracy 0.7288833951380305 1.8236734867095947 
2022-04-16 16:10:39,833 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 16:10:39,834 reid_baseline.train INFO: Accuracy: 72.9% Mean Entropy: 182.4%
2022-04-16 16:11:18,857 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.034, Acc: 0.923, Base Lr: 7.21e-03
2022-04-16 16:11:56,422 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.025, Acc: 0.922, Base Lr: 7.21e-03
2022-04-16 16:12:21,471 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 16:12:52,400 reid_baseline.train INFO: normal accuracy 0.73053152039555 1.8231998682022095 
2022-04-16 16:12:55,497 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 16:12:55,498 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 182.3%
2022-04-16 16:13:33,659 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.018, Acc: 0.926, Base Lr: 7.60e-03
2022-04-16 16:14:12,192 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.013, Acc: 0.931, Base Lr: 7.60e-03
2022-04-16 16:14:38,399 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.377[s] Speed: 42.4[samples/s]
2022-04-16 16:15:07,138 reid_baseline.train INFO: normal accuracy 0.7362999587968686 1.804932951927185 
2022-04-16 16:15:10,294 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 16:15:10,295 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 180.5%
2022-04-16 16:15:47,367 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.982, Acc: 0.944, Base Lr: 4.01e-03
2022-04-16 16:16:25,984 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.985, Acc: 0.939, Base Lr: 4.01e-03
2022-04-16 16:16:46,223 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.351[s] Speed: 45.5[samples/s]
2022-04-16 16:17:21,965 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.7766152620315552 
2022-04-16 16:17:25,150 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 16:17:25,151 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 177.7%
2022-04-16 16:18:03,013 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.964, Acc: 0.955, Base Lr: 3.69e-03
2022-04-16 16:18:41,680 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.960, Acc: 0.951, Base Lr: 3.69e-03
2022-04-16 16:19:09,787 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.383[s] Speed: 41.7[samples/s]
2022-04-16 16:19:39,662 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.7904901504516602 
2022-04-16 16:19:39,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 16:19:39,667 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 179.0%
2022-04-16 16:20:19,757 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.947, Acc: 0.952, Base Lr: 3.38e-03
2022-04-16 16:20:56,767 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.950, Acc: 0.948, Base Lr: 3.38e-03
2022-04-16 16:21:24,092 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 16:21:54,260 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.7580325603485107 
2022-04-16 16:21:57,746 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 16:21:57,746 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 175.8%
2022-04-16 16:22:32,602 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.944, Acc: 0.943, Base Lr: 3.08e-03
2022-04-16 16:23:01,100 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.953, Acc: 0.943, Base Lr: 3.08e-03
2022-04-16 16:23:26,299 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-16 16:23:56,727 reid_baseline.train INFO: normal accuracy 0.7466007416563659 1.740594506263733 
2022-04-16 16:23:59,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 16:23:59,839 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 174.1%
2022-04-16 16:24:39,669 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.946, Acc: 0.945, Base Lr: 2.77e-03
2022-04-16 16:25:15,109 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.939, Acc: 0.948, Base Lr: 2.77e-03
2022-04-16 16:25:43,273 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-16 16:26:13,601 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.8039792776107788 
2022-04-16 16:26:13,601 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 16:26:13,601 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 180.4%
2022-04-16 16:26:51,624 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.937, Acc: 0.952, Base Lr: 2.48e-03
2022-04-16 16:27:30,267 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.936, Acc: 0.951, Base Lr: 2.48e-03
2022-04-16 16:27:57,319 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 16:28:26,684 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.7257333993911743 
2022-04-16 16:28:29,862 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 16:28:29,862 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 172.6%
2022-04-16 16:29:04,260 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.966, Base Lr: 2.20e-03
2022-04-16 16:29:41,707 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.917, Acc: 0.959, Base Lr: 2.20e-03
2022-04-16 16:30:07,278 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.357[s] Speed: 44.8[samples/s]
2022-04-16 16:30:36,795 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8006150722503662 
2022-04-16 16:30:36,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 16:30:36,795 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 180.1%
2022-04-16 16:31:15,307 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.919, Acc: 0.956, Base Lr: 1.92e-03
2022-04-16 16:31:51,348 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.920, Acc: 0.954, Base Lr: 1.92e-03
2022-04-16 16:32:18,724 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-16 16:32:47,676 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.811454176902771 
2022-04-16 16:32:47,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 16:32:47,677 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 181.1%
2022-04-16 16:33:24,368 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.903, Acc: 0.962, Base Lr: 1.66e-03
2022-04-16 16:33:52,940 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.918, Acc: 0.956, Base Lr: 1.66e-03
2022-04-16 16:34:19,329 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-16 16:34:45,004 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8428088426589966 
2022-04-16 16:34:45,008 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 16:34:45,008 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 184.3%
2022-04-16 16:35:13,486 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.914, Acc: 0.960, Base Lr: 1.42e-03
2022-04-16 16:35:44,523 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.907, Acc: 0.962, Base Lr: 1.42e-03
2022-04-16 16:36:05,430 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.295[s] Speed: 54.3[samples/s]
2022-04-16 16:36:32,693 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.8213903903961182 
2022-04-16 16:36:32,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 16:36:32,694 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 182.1%
2022-04-16 16:37:10,157 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.895, Acc: 0.965, Base Lr: 1.19e-03
2022-04-16 16:37:44,080 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.904, Acc: 0.963, Base Lr: 1.19e-03
2022-04-16 16:38:07,142 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 16:38:43,750 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.810610055923462 
2022-04-16 16:38:43,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 16:38:43,753 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 181.1%
2022-04-16 16:39:13,488 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.915, Acc: 0.957, Base Lr: 9.72e-04
2022-04-16 16:39:50,289 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.907, Acc: 0.961, Base Lr: 9.72e-04
2022-04-16 16:40:17,544 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.344[s] Speed: 46.6[samples/s]
2022-04-16 16:40:47,902 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.8794255256652832 
2022-04-16 16:40:47,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 16:40:47,902 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 187.9%
2022-04-16 16:41:18,012 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.892, Acc: 0.967, Base Lr: 7.78e-04
2022-04-16 16:41:48,814 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.898, Acc: 0.962, Base Lr: 7.78e-04
2022-04-16 16:42:11,241 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.305[s] Speed: 52.4[samples/s]
2022-04-16 16:42:39,035 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.8137524127960205 
2022-04-16 16:42:39,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 16:42:39,038 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 181.4%
2022-04-16 16:43:11,845 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.886, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 16:43:42,160 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.885, Acc: 0.968, Base Lr: 6.04e-04
2022-04-16 16:44:03,825 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.311[s] Speed: 51.5[samples/s]
2022-04-16 16:44:33,728 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.8523211479187012 
2022-04-16 16:44:33,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 16:44:33,730 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 185.2%
2022-04-16 16:45:10,412 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.911, Acc: 0.959, Base Lr: 4.51e-04
2022-04-16 16:45:41,704 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.903, Acc: 0.963, Base Lr: 4.51e-04
2022-04-16 16:46:03,719 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-16 16:46:34,940 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.826327919960022 
2022-04-16 16:46:34,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 16:46:34,942 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 182.6%
2022-04-16 16:47:05,203 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.897, Acc: 0.960, Base Lr: 3.20e-04
2022-04-16 16:47:41,274 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.888, Acc: 0.967, Base Lr: 3.20e-04
2022-04-16 16:48:06,756 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-16 16:48:35,436 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.8106647729873657 
2022-04-16 16:48:35,438 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 16:48:35,438 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 181.1%
2022-04-16 16:49:07,660 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.899, Acc: 0.966, Base Lr: 2.11e-04
2022-04-16 16:49:37,410 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.898, Acc: 0.965, Base Lr: 2.11e-04
2022-04-16 16:49:58,398 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.304[s] Speed: 52.7[samples/s]
2022-04-16 16:50:25,139 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.7917888164520264 
2022-04-16 16:50:25,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 16:50:25,142 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 179.2%
2022-04-16 16:50:58,540 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.894, Acc: 0.969, Base Lr: 1.26e-04
2022-04-16 16:51:29,622 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.966, Base Lr: 1.26e-04
2022-04-16 16:51:51,850 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.318[s] Speed: 50.4[samples/s]
2022-04-16 16:52:19,498 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.8289477825164795 
2022-04-16 16:52:19,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 16:52:19,498 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 182.9%
2022-04-16 16:52:50,022 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.890, Acc: 0.965, Base Lr: 6.51e-05
2022-04-16 16:53:26,884 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.896, Acc: 0.963, Base Lr: 6.51e-05
2022-04-16 16:53:47,726 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-16 16:54:18,745 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.8097373247146606 
2022-04-16 16:54:18,750 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 16:54:18,750 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 181.0%
2022-04-16 16:54:49,040 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.904, Acc: 0.962, Base Lr: 2.83e-05
2022-04-16 16:55:19,566 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.896, Acc: 0.962, Base Lr: 2.83e-05
2022-04-16 16:55:46,064 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 16:56:09,753 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.7892816066741943 
2022-04-16 16:56:09,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 16:56:09,754 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 178.9%
2022-04-16 16:56:38,626 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.902, Acc: 0.964, Base Lr: 1.60e-05
2022-04-16 16:57:08,193 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.892, Acc: 0.965, Base Lr: 1.60e-05
2022-04-16 16:57:29,488 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.292[s] Speed: 54.8[samples/s]
2022-04-16 16:58:03,040 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.8190878629684448 
2022-04-16 16:58:03,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 16:58:03,041 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 181.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_4/transformer_best_model.pth
2022-04-16 16:58:35,395 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.7257333993911743 
2022-04-16 16:58:35,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:58:35,395 reid_baseline.train INFO: Accuracy: 74.2%
2022-04-16 16:59:11,154 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.7257333993911743 
2022-04-16 16:59:11,154 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:59:11,154 reid_baseline.train INFO: Shuffled Accuracy: 74.2%
2022-04-16 17:00:26,852 reid_baseline.train INFO: normal accuracy 0.9741122565864834 0.6289549469947815 
2022-04-16 17:00:26,853 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:00:26,853 reid_baseline.train INFO: Source Clean Accuracy: 97.4%
2022-04-16 17:00:34,407 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_4
2022-04-16 17:00:34,407 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-16 17:00:34,407 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 17:00:34,408 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 17:00:34,408 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 17:00:42,713 reid_baseline.train INFO: start training
2022-04-16 17:01:12,916 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.164, Base Lr: 4.76e-04
2022-04-16 17:01:51,847 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.299, Base Lr: 4.76e-04
2022-04-16 17:02:16,037 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 17:04:18,420 reid_baseline.train INFO: normal accuracy 0.5425751663988984 4.171679496765137 
2022-04-16 17:04:21,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 17:04:21,435 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 417.2%
2022-04-16 17:04:51,956 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.890, Acc: 0.570, Base Lr: 8.72e-04
2022-04-16 17:05:24,460 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.816, Acc: 0.553, Base Lr: 8.72e-04
2022-04-16 17:05:48,035 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-16 17:07:45,510 reid_baseline.train INFO: normal accuracy 0.5797567133348634 4.150954246520996 
2022-04-16 17:07:48,631 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 17:07:48,632 reid_baseline.train INFO: Accuracy: 58.0% Mean Entropy: 415.1%
2022-04-16 17:08:20,575 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.384, Acc: 0.597, Base Lr: 1.27e-03
2022-04-16 17:08:54,815 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.273, Acc: 0.576, Base Lr: 1.27e-03
2022-04-16 17:09:22,290 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 17:11:22,338 reid_baseline.train INFO: normal accuracy 0.6063805370667891 3.980057954788208 
2022-04-16 17:11:25,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 17:11:25,459 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 398.0%
2022-04-16 17:11:59,635 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.720, Acc: 0.590, Base Lr: 1.66e-03
2022-04-16 17:12:37,408 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.592, Acc: 0.614, Base Lr: 1.66e-03
2022-04-16 17:13:00,062 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.347[s] Speed: 46.2[samples/s]
2022-04-16 17:15:00,804 reid_baseline.train INFO: normal accuracy 0.6561854487032361 3.4980766773223877 
2022-04-16 17:15:08,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 17:15:08,444 reid_baseline.train INFO: Accuracy: 65.6% Mean Entropy: 349.8%
2022-04-16 17:15:44,967 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.177, Acc: 0.663, Base Lr: 2.06e-03
2022-04-16 17:16:18,836 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.107, Acc: 0.676, Base Lr: 2.06e-03
2022-04-16 17:16:42,451 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 17:18:37,909 reid_baseline.train INFO: normal accuracy 0.7066789075051642 2.9930202960968018 
2022-04-16 17:18:42,957 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 17:18:42,957 reid_baseline.train INFO: Accuracy: 70.7% Mean Entropy: 299.3%
2022-04-16 17:19:16,993 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.800, Acc: 0.733, Base Lr: 2.46e-03
2022-04-16 17:19:49,675 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.779, Acc: 0.737, Base Lr: 2.46e-03
2022-04-16 17:20:16,886 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 17:22:16,280 reid_baseline.train INFO: normal accuracy 0.7404177186137251 2.5938100814819336 
2022-04-16 17:22:22,208 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 17:22:22,209 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 259.4%
2022-04-16 17:22:59,764 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.618, Acc: 0.767, Base Lr: 2.85e-03
2022-04-16 17:23:36,545 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.599, Acc: 0.764, Base Lr: 2.85e-03
2022-04-16 17:23:58,001 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 17:25:56,760 reid_baseline.train INFO: normal accuracy 0.7525820518705532 2.3461737632751465 
2022-04-16 17:26:04,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 17:26:04,371 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 234.6%
2022-04-16 17:26:40,068 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.455, Acc: 0.806, Base Lr: 3.25e-03
2022-04-16 17:27:12,687 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.458, Acc: 0.801, Base Lr: 3.25e-03
2022-04-16 17:27:34,635 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-16 17:29:34,742 reid_baseline.train INFO: normal accuracy 0.7732384668349782 2.159402847290039 
2022-04-16 17:29:41,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 17:29:41,947 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 215.9%
2022-04-16 17:30:15,789 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.393, Acc: 0.812, Base Lr: 3.64e-03
2022-04-16 17:30:52,006 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.364, Acc: 0.823, Base Lr: 3.64e-03
2022-04-16 17:31:18,760 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 17:33:18,873 reid_baseline.train INFO: normal accuracy 0.7808124856552674 2.078930139541626 
2022-04-16 17:33:23,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 17:33:23,171 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 207.9%
2022-04-16 17:34:02,975 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.302, Acc: 0.842, Base Lr: 4.04e-03
2022-04-16 17:34:36,835 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.309, Acc: 0.841, Base Lr: 4.04e-03
2022-04-16 17:34:57,955 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-16 17:37:23,750 reid_baseline.train INFO: normal accuracy 0.7798944227679596 1.9703527688980103 
2022-04-16 17:37:30,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 17:37:30,013 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 197.0%
2022-04-16 17:38:02,568 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.244, Acc: 0.861, Base Lr: 4.44e-03
2022-04-16 17:38:35,724 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.259, Acc: 0.857, Base Lr: 4.44e-03
2022-04-16 17:39:00,568 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-16 17:41:03,582 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.8913869857788086 
2022-04-16 17:41:09,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 17:41:09,625 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 189.1%
2022-04-16 17:41:42,539 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.210, Acc: 0.865, Base Lr: 4.83e-03
2022-04-16 17:42:20,310 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.208, Acc: 0.866, Base Lr: 4.83e-03
2022-04-16 17:42:46,040 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-16 17:44:48,054 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.8283917903900146 
2022-04-16 17:44:53,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 17:44:53,878 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 182.8%
2022-04-16 17:45:32,663 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.147, Acc: 0.887, Base Lr: 5.23e-03
2022-04-16 17:46:03,207 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.157, Acc: 0.885, Base Lr: 5.23e-03
2022-04-16 17:46:27,151 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-16 17:48:21,199 reid_baseline.train INFO: normal accuracy 0.7883865044755566 1.836050033569336 
2022-04-16 17:48:21,199 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 17:48:21,199 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 183.6%
2022-04-16 17:48:52,614 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.115, Acc: 0.893, Base Lr: 5.62e-03
2022-04-16 17:49:22,933 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.121, Acc: 0.895, Base Lr: 5.62e-03
2022-04-16 17:49:47,549 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.316[s] Speed: 50.6[samples/s]
2022-04-16 17:51:45,456 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.860649824142456 
2022-04-16 17:51:45,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 17:51:45,456 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 186.1%
2022-04-16 17:52:15,804 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.084, Acc: 0.910, Base Lr: 6.02e-03
2022-04-16 17:52:52,928 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.094, Acc: 0.905, Base Lr: 6.02e-03
2022-04-16 17:53:20,479 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-16 17:55:25,658 reid_baseline.train INFO: normal accuracy 0.7943539132430572 1.7860760688781738 
2022-04-16 17:55:28,769 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 17:55:28,769 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 178.6%
2022-04-16 17:56:05,688 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.060, Acc: 0.917, Base Lr: 6.42e-03
2022-04-16 17:56:37,856 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.072, Acc: 0.914, Base Lr: 6.42e-03
2022-04-16 17:57:01,482 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 17:59:03,184 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.7709211111068726 
2022-04-16 17:59:06,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 17:59:06,288 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 177.1%
2022-04-16 17:59:37,720 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.050, Acc: 0.918, Base Lr: 6.81e-03
2022-04-16 18:00:08,196 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.048, Acc: 0.919, Base Lr: 6.81e-03
2022-04-16 18:00:29,726 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.306[s] Speed: 52.4[samples/s]
2022-04-16 18:02:31,148 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.669119119644165 
2022-04-16 18:02:34,247 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 18:02:34,248 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 166.9%
2022-04-16 18:03:02,831 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.034, Acc: 0.924, Base Lr: 7.21e-03
2022-04-16 18:03:41,390 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.025, Acc: 0.924, Base Lr: 7.21e-03
2022-04-16 18:04:08,673 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.346[s] Speed: 46.3[samples/s]
2022-04-16 18:06:09,667 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.6976664066314697 
2022-04-16 18:06:09,669 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 18:06:09,669 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.8%
2022-04-16 18:06:47,213 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.017, Acc: 0.927, Base Lr: 7.60e-03
2022-04-16 18:07:18,140 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.013, Acc: 0.930, Base Lr: 7.60e-03
2022-04-16 18:07:42,235 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-16 18:09:41,623 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.7024011611938477 
2022-04-16 18:09:41,623 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 18:09:41,624 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 170.2%
2022-04-16 18:10:13,942 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.982, Acc: 0.942, Base Lr: 4.01e-03
2022-04-16 18:10:45,497 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.985, Acc: 0.938, Base Lr: 4.01e-03
2022-04-16 18:11:09,633 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.322[s] Speed: 49.6[samples/s]
2022-04-16 18:13:24,126 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.6558079719543457 
2022-04-16 18:13:31,824 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 18:13:31,824 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 165.6%
2022-04-16 18:14:07,223 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.965, Acc: 0.952, Base Lr: 3.69e-03
2022-04-16 18:14:46,474 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.961, Acc: 0.948, Base Lr: 3.69e-03
2022-04-16 18:15:11,579 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.365[s] Speed: 43.8[samples/s]
2022-04-16 18:17:12,900 reid_baseline.train INFO: normal accuracy 0.7975671333486344 1.6815778017044067 
2022-04-16 18:17:12,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 18:17:12,902 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 168.2%
2022-04-16 18:17:53,435 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.946, Acc: 0.952, Base Lr: 3.38e-03
2022-04-16 18:18:24,632 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.950, Acc: 0.948, Base Lr: 3.38e-03
2022-04-16 18:18:47,191 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.345[s] Speed: 46.3[samples/s]
2022-04-16 18:20:46,958 reid_baseline.train INFO: normal accuracy 0.7961900390176727 1.65007483959198 
2022-04-16 18:20:50,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 18:20:50,071 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 165.0%
2022-04-16 18:21:23,627 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.945, Acc: 0.943, Base Lr: 3.08e-03
2022-04-16 18:21:54,383 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.954, Acc: 0.943, Base Lr: 3.08e-03
2022-04-16 18:22:15,957 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.315[s] Speed: 50.9[samples/s]
2022-04-16 18:24:19,103 reid_baseline.train INFO: normal accuracy 0.7977966490704613 1.6218425035476685 
2022-04-16 18:24:22,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 18:24:22,232 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 162.2%
2022-04-16 18:24:53,135 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.945, Acc: 0.947, Base Lr: 2.77e-03
2022-04-16 18:25:23,946 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.939, Acc: 0.949, Base Lr: 2.77e-03
2022-04-16 18:25:43,937 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-16 18:27:32,288 reid_baseline.train INFO: normal accuracy 0.7968785861831535 1.7040109634399414 
2022-04-16 18:27:32,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 18:27:32,293 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 170.4%
2022-04-16 18:28:10,485 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.937, Acc: 0.952, Base Lr: 2.48e-03
2022-04-16 18:28:49,860 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.936, Acc: 0.951, Base Lr: 2.48e-03
2022-04-16 18:29:14,705 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-04-16 18:31:14,118 reid_baseline.train INFO: normal accuracy 0.7959605232958458 1.6025396585464478 
2022-04-16 18:31:17,254 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 18:31:17,254 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 160.3%
2022-04-16 18:31:59,405 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 18:32:37,418 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.917, Acc: 0.958, Base Lr: 2.20e-03
2022-04-16 18:33:02,543 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-16 18:34:58,925 reid_baseline.train INFO: normal accuracy 0.7957310075740188 1.676369071006775 
2022-04-16 18:34:58,929 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 18:34:58,929 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 167.6%
2022-04-16 18:35:38,887 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.919, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 18:36:17,303 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.920, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 18:36:44,450 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.387[s] Speed: 41.4[samples/s]
2022-04-16 18:38:43,688 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.684134840965271 
2022-04-16 18:38:43,691 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 18:38:43,691 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 168.4%
2022-04-16 18:39:22,207 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.904, Acc: 0.960, Base Lr: 1.66e-03
2022-04-16 18:40:00,074 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.918, Acc: 0.955, Base Lr: 1.66e-03
2022-04-16 18:40:26,399 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.376[s] Speed: 42.5[samples/s]
2022-04-16 18:42:23,339 reid_baseline.train INFO: normal accuracy 0.7941243975212302 1.7175830602645874 
2022-04-16 18:42:23,342 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 18:42:23,342 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 171.8%
2022-04-16 18:43:00,594 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.914, Acc: 0.960, Base Lr: 1.42e-03
2022-04-16 18:43:37,172 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.907, Acc: 0.962, Base Lr: 1.42e-03
2022-04-16 18:44:04,648 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.371[s] Speed: 43.1[samples/s]
2022-04-16 18:46:03,133 reid_baseline.train INFO: normal accuracy 0.7929768189120955 1.7002912759780884 
2022-04-16 18:46:03,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 18:46:03,136 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 170.0%
2022-04-16 18:46:43,702 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.895, Acc: 0.966, Base Lr: 1.19e-03
2022-04-16 18:47:21,181 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.905, Acc: 0.963, Base Lr: 1.19e-03
2022-04-16 18:47:48,709 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.387[s] Speed: 41.4[samples/s]
2022-04-16 18:49:52,160 reid_baseline.train INFO: normal accuracy 0.7938948817994033 1.6914234161376953 
2022-04-16 18:49:52,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 18:49:52,163 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 169.1%
2022-04-16 18:50:34,197 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.915, Acc: 0.955, Base Lr: 9.72e-04
2022-04-16 18:51:07,428 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.907, Acc: 0.959, Base Lr: 9.72e-04
2022-04-16 18:51:30,050 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-16 18:53:30,234 reid_baseline.train INFO: normal accuracy 0.7943539132430572 1.7608723640441895 
2022-04-16 18:53:30,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 18:53:30,236 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 176.1%
2022-04-16 18:54:06,875 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.893, Acc: 0.965, Base Lr: 7.78e-04
2022-04-16 18:54:46,952 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.898, Acc: 0.960, Base Lr: 7.78e-04
2022-04-16 18:55:14,080 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 18:57:15,557 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.6909397840499878 
2022-04-16 18:57:15,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 18:57:15,558 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 169.1%
2022-04-16 18:57:47,660 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.886, Acc: 0.971, Base Lr: 6.04e-04
2022-04-16 18:58:24,763 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.885, Acc: 0.969, Base Lr: 6.04e-04
2022-04-16 18:58:53,719 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.360[s] Speed: 44.5[samples/s]
2022-04-16 19:00:54,432 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7324373722076416 
2022-04-16 19:00:54,436 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 19:00:54,436 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 173.2%
2022-04-16 19:01:29,542 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.911, Acc: 0.959, Base Lr: 4.51e-04
2022-04-16 19:02:07,693 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.903, Acc: 0.963, Base Lr: 4.51e-04
2022-04-16 19:02:36,129 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 19:04:31,703 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.6998687982559204 
2022-04-16 19:04:31,708 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 19:04:31,708 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 170.0%
2022-04-16 19:05:06,781 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.897, Acc: 0.961, Base Lr: 3.20e-04
2022-04-16 19:05:46,693 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.888, Acc: 0.968, Base Lr: 3.20e-04
2022-04-16 19:06:13,709 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.374[s] Speed: 42.8[samples/s]
2022-04-16 19:08:08,523 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.692401647567749 
2022-04-16 19:08:08,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 19:08:08,524 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 169.2%
2022-04-16 19:08:46,159 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.899, Acc: 0.965, Base Lr: 2.11e-04
2022-04-16 19:09:24,082 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.898, Acc: 0.965, Base Lr: 2.11e-04
2022-04-16 19:09:51,900 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.379[s] Speed: 42.3[samples/s]
2022-04-16 19:11:46,552 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.678629994392395 
2022-04-16 19:11:46,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 19:11:46,554 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 167.9%
2022-04-16 19:12:25,833 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.894, Acc: 0.967, Base Lr: 1.26e-04
2022-04-16 19:13:04,695 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.893, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 19:13:31,693 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.385[s] Speed: 41.5[samples/s]
2022-04-16 19:15:28,985 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.7196589708328247 
2022-04-16 19:15:28,986 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 19:15:28,986 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 172.0%
2022-04-16 19:16:08,186 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.890, Acc: 0.965, Base Lr: 6.51e-05
2022-04-16 19:16:47,296 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.896, Acc: 0.963, Base Lr: 6.51e-05
2022-04-16 19:17:13,507 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 19:19:10,040 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.6934964656829834 
2022-04-16 19:19:10,040 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 19:19:10,040 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.3%
2022-04-16 19:19:49,545 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.904, Acc: 0.962, Base Lr: 2.83e-05
2022-04-16 19:20:26,893 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.897, Acc: 0.961, Base Lr: 2.83e-05
2022-04-16 19:20:55,728 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.387[s] Speed: 41.3[samples/s]
2022-04-16 19:22:54,601 reid_baseline.train INFO: normal accuracy 0.7913702088593069 1.6755125522613525 
2022-04-16 19:22:54,603 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 19:22:54,603 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 167.6%
2022-04-16 19:23:32,166 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.902, Acc: 0.964, Base Lr: 1.60e-05
2022-04-16 19:24:09,764 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.892, Acc: 0.965, Base Lr: 1.60e-05
2022-04-16 19:24:38,137 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-16 19:26:37,704 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.7023402452468872 
2022-04-16 19:26:37,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 19:26:37,704 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 170.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_4/transformer_best_model.pth
2022-04-16 19:28:57,675 reid_baseline.train INFO: normal accuracy 0.7959605232958458 1.6025396585464478 
2022-04-16 19:28:57,675 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:28:57,675 reid_baseline.train INFO: Accuracy: 79.6%
2022-04-16 19:30:58,888 reid_baseline.train INFO: normal accuracy 0.7959605232958458 1.6025396585464478 
2022-04-16 19:30:58,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:30:58,888 reid_baseline.train INFO: Shuffled Accuracy: 79.6%
2022-04-16 19:31:32,847 reid_baseline.train INFO: normal accuracy 0.9745704467353952 0.6279407143592834 
2022-04-16 19:31:32,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:31:32,847 reid_baseline.train INFO: Source Clean Accuracy: 97.5%
2022-04-16 19:31:37,836 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_6
2022-04-16 19:31:37,836 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-16 19:31:37,836 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 19:31:37,837 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 19:31:37,837 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 19:31:45,566 reid_baseline.train INFO: start training
2022-04-16 19:32:26,661 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.163, Base Lr: 4.76e-04
2022-04-16 19:33:01,708 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.296, Base Lr: 4.76e-04
2022-04-16 19:33:25,339 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.360[s] Speed: 44.4[samples/s]
2022-04-16 19:33:57,994 reid_baseline.train INFO: normal accuracy 0.484548825710754 4.1717119216918945 
2022-04-16 19:34:03,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 19:34:03,882 reid_baseline.train INFO: Accuracy: 48.5% Mean Entropy: 417.2%
2022-04-16 19:34:40,813 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.892, Acc: 0.564, Base Lr: 8.72e-04
2022-04-16 19:35:14,884 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.817, Acc: 0.557, Base Lr: 8.72e-04
2022-04-16 19:35:39,755 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 19:36:11,815 reid_baseline.train INFO: normal accuracy 0.5241038318912238 4.152929782867432 
2022-04-16 19:36:18,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 19:36:18,431 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 415.3%
2022-04-16 19:36:56,342 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.385, Acc: 0.593, Base Lr: 1.27e-03
2022-04-16 19:37:30,353 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.273, Acc: 0.579, Base Lr: 1.27e-03
2022-04-16 19:37:53,018 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 19:38:20,731 reid_baseline.train INFO: normal accuracy 0.5484136794396374 4.0132527351379395 
2022-04-16 19:38:30,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 19:38:30,820 reid_baseline.train INFO: Accuracy: 54.8% Mean Entropy: 401.3%
2022-04-16 19:39:09,907 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.726, Acc: 0.585, Base Lr: 1.66e-03
2022-04-16 19:39:43,023 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.610, Base Lr: 1.66e-03
2022-04-16 19:40:05,988 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-16 19:40:37,816 reid_baseline.train INFO: normal accuracy 0.603625875566543 3.6268582344055176 
2022-04-16 19:40:42,725 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 19:40:42,726 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 362.7%
2022-04-16 19:41:15,181 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.182, Acc: 0.652, Base Lr: 2.06e-03
2022-04-16 19:41:51,089 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.109, Acc: 0.666, Base Lr: 2.06e-03
2022-04-16 19:42:18,369 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 19:42:50,946 reid_baseline.train INFO: normal accuracy 0.6526576019777504 3.1914429664611816 
2022-04-16 19:42:55,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 19:42:55,516 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 319.1%
2022-04-16 19:43:27,879 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.794, Acc: 0.731, Base Lr: 2.46e-03
2022-04-16 19:43:58,748 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.777, Acc: 0.732, Base Lr: 2.46e-03
2022-04-16 19:44:20,562 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.312[s] Speed: 51.4[samples/s]
2022-04-16 19:44:53,411 reid_baseline.train INFO: normal accuracy 0.6918005768438401 2.817579984664917 
2022-04-16 19:44:56,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 19:44:56,510 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 281.8%
2022-04-16 19:45:30,791 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.612, Acc: 0.771, Base Lr: 2.85e-03
2022-04-16 19:46:03,683 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.596, Acc: 0.766, Base Lr: 2.85e-03
2022-04-16 19:46:25,030 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-16 19:46:57,762 reid_baseline.train INFO: normal accuracy 0.7012772970745776 2.5877695083618164 
2022-04-16 19:47:00,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 19:47:00,904 reid_baseline.train INFO: Accuracy: 70.1% Mean Entropy: 258.8%
2022-04-16 19:47:36,341 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.457, Acc: 0.797, Base Lr: 3.25e-03
2022-04-16 19:48:08,825 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.459, Acc: 0.797, Base Lr: 3.25e-03
2022-04-16 19:48:29,713 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-16 19:49:00,297 reid_baseline.train INFO: normal accuracy 0.7161104243922538 2.396742582321167 
2022-04-16 19:49:05,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 19:49:05,545 reid_baseline.train INFO: Accuracy: 71.6% Mean Entropy: 239.7%
2022-04-16 19:49:45,689 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.393, Acc: 0.819, Base Lr: 3.64e-03
2022-04-16 19:50:18,827 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.367, Acc: 0.827, Base Lr: 3.64e-03
2022-04-16 19:50:41,524 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 19:51:13,738 reid_baseline.train INFO: normal accuracy 0.7276473011948908 2.297772169113159 
2022-04-16 19:51:18,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 19:51:18,693 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 229.8%
2022-04-16 19:51:51,809 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.297, Acc: 0.835, Base Lr: 4.04e-03
2022-04-16 19:52:25,169 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.309, Acc: 0.835, Base Lr: 4.04e-03
2022-04-16 19:52:53,813 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.348[s] Speed: 45.9[samples/s]
2022-04-16 19:53:27,969 reid_baseline.train INFO: normal accuracy 0.7284713638236506 2.1785640716552734 
2022-04-16 19:53:34,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 19:53:34,877 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 217.9%
2022-04-16 19:54:09,487 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.248, Acc: 0.865, Base Lr: 4.44e-03
2022-04-16 19:54:42,112 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.255, Acc: 0.861, Base Lr: 4.44e-03
2022-04-16 19:55:10,759 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 19:55:39,296 reid_baseline.train INFO: normal accuracy 0.7416563658838071 2.106748580932617 
2022-04-16 19:55:45,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 19:55:45,164 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 210.7%
2022-04-16 19:56:19,372 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.210, Acc: 0.872, Base Lr: 4.83e-03
2022-04-16 19:56:50,704 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.206, Acc: 0.869, Base Lr: 4.83e-03
2022-04-16 19:57:14,538 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-16 19:57:45,179 reid_baseline.train INFO: normal accuracy 0.738360115368768 2.02681303024292 
2022-04-16 19:57:48,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 19:57:48,796 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 202.7%
2022-04-16 19:58:21,692 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.143, Acc: 0.892, Base Lr: 5.23e-03
2022-04-16 19:58:52,687 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.156, Acc: 0.882, Base Lr: 5.23e-03
2022-04-16 19:59:14,831 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.315[s] Speed: 50.8[samples/s]
2022-04-16 19:59:45,058 reid_baseline.train INFO: normal accuracy 0.7358879274824887 2.007131576538086 
2022-04-16 19:59:50,390 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 19:59:50,391 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 200.7%
2022-04-16 20:00:28,408 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.107, Acc: 0.895, Base Lr: 5.62e-03
2022-04-16 20:01:00,321 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.121, Acc: 0.895, Base Lr: 5.62e-03
2022-04-16 20:01:23,122 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 20:01:54,355 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.9932626485824585 
2022-04-16 20:01:59,931 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 20:01:59,931 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 199.3%
2022-04-16 20:02:38,859 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.081, Acc: 0.900, Base Lr: 6.02e-03
2022-04-16 20:03:13,887 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.095, Acc: 0.898, Base Lr: 6.02e-03
2022-04-16 20:03:35,680 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 20:04:32,425 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.961317777633667 
2022-04-16 20:04:52,132 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 20:04:52,133 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 196.1%
2022-04-16 20:05:27,778 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.060, Acc: 0.915, Base Lr: 6.42e-03
2022-04-16 20:06:05,994 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.068, Acc: 0.917, Base Lr: 6.42e-03
2022-04-16 20:06:28,875 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-16 20:07:02,006 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.8978995084762573 
2022-04-16 20:07:08,091 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 20:07:08,091 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 189.8%
2022-04-16 20:07:43,427 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.056, Acc: 0.911, Base Lr: 6.81e-03
2022-04-16 20:08:17,439 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.051, Acc: 0.913, Base Lr: 6.81e-03
2022-04-16 20:08:46,964 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-16 20:09:18,881 reid_baseline.train INFO: normal accuracy 0.7350638648537289 1.8478411436080933 
2022-04-16 20:09:24,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 20:09:24,024 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 184.8%
2022-04-16 20:09:57,207 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.030, Acc: 0.921, Base Lr: 7.21e-03
2022-04-16 20:10:27,977 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.027, Acc: 0.925, Base Lr: 7.21e-03
2022-04-16 20:10:52,913 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-16 20:11:22,896 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8516614437103271 
2022-04-16 20:11:22,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 20:11:22,900 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 185.2%
2022-04-16 20:11:54,069 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.022, Acc: 0.922, Base Lr: 7.60e-03
2022-04-16 20:12:25,098 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.012, Acc: 0.931, Base Lr: 7.60e-03
2022-04-16 20:12:48,619 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-16 20:13:18,604 reid_baseline.train INFO: normal accuracy 0.7317676143386898 1.8062633275985718 
2022-04-16 20:13:24,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 20:13:24,723 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 180.6%
2022-04-16 20:14:02,154 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.977, Acc: 0.946, Base Lr: 4.01e-03
2022-04-16 20:14:34,707 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.982, Acc: 0.941, Base Lr: 4.01e-03
2022-04-16 20:14:56,145 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-16 20:15:30,446 reid_baseline.train INFO: normal accuracy 0.7342398022249691 1.8036547899246216 
2022-04-16 20:15:34,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 20:15:34,278 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 180.4%
2022-04-16 20:16:13,938 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.961, Acc: 0.949, Base Lr: 3.69e-03
2022-04-16 20:16:47,464 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.962, Acc: 0.948, Base Lr: 3.69e-03
2022-04-16 20:17:09,502 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-16 20:17:41,589 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.7904129028320312 
2022-04-16 20:17:44,701 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 20:17:44,702 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 179.0%
2022-04-16 20:18:18,247 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.953, Acc: 0.947, Base Lr: 3.38e-03
2022-04-16 20:18:54,127 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.952, Acc: 0.946, Base Lr: 3.38e-03
2022-04-16 20:19:19,215 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 20:19:49,327 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8004090785980225 
2022-04-16 20:19:49,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 20:19:49,331 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 180.0%
2022-04-16 20:20:23,750 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.943, Acc: 0.950, Base Lr: 3.08e-03
2022-04-16 20:20:55,209 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.957, Acc: 0.945, Base Lr: 3.08e-03
2022-04-16 20:21:19,842 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.332[s] Speed: 48.3[samples/s]
2022-04-16 20:21:48,450 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.726388692855835 
2022-04-16 20:21:51,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 20:21:51,560 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 172.6%
2022-04-16 20:22:23,094 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.941, Acc: 0.947, Base Lr: 2.77e-03
2022-04-16 20:22:53,397 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.938, Acc: 0.948, Base Lr: 2.77e-03
2022-04-16 20:23:12,998 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.298[s] Speed: 53.6[samples/s]
2022-04-16 20:23:38,525 reid_baseline.train INFO: normal accuracy 0.7350638648537289 1.828797698020935 
2022-04-16 20:23:38,528 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 20:23:38,528 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 182.9%
2022-04-16 20:24:18,491 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.944, Acc: 0.948, Base Lr: 2.48e-03
2022-04-16 20:24:50,112 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.941, Acc: 0.949, Base Lr: 2.48e-03
2022-04-16 20:25:09,377 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-16 20:25:43,020 reid_baseline.train INFO: normal accuracy 0.7367119901112484 1.7099241018295288 
2022-04-16 20:25:46,130 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 20:25:46,132 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 171.0%
2022-04-16 20:26:22,399 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 20:27:01,358 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.922, Acc: 0.956, Base Lr: 2.20e-03
2022-04-16 20:27:21,816 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 20:27:51,913 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.7969653606414795 
2022-04-16 20:27:51,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 20:27:51,915 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 179.7%
2022-04-16 20:28:27,491 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.919, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 20:29:03,127 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.922, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 20:29:28,049 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.352[s] Speed: 45.4[samples/s]
2022-04-16 20:29:55,555 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.818923830986023 
2022-04-16 20:29:55,556 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 20:29:55,556 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 181.9%
2022-04-16 20:30:30,946 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.908, Acc: 0.962, Base Lr: 1.66e-03
2022-04-16 20:31:00,719 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.919, Acc: 0.955, Base Lr: 1.66e-03
2022-04-16 20:31:20,838 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.312[s] Speed: 51.2[samples/s]
2022-04-16 20:31:45,289 reid_baseline.train INFO: normal accuracy 0.7362999587968686 1.835640549659729 
2022-04-16 20:31:45,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 20:31:45,292 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 183.6%
2022-04-16 20:32:22,374 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.909, Acc: 0.957, Base Lr: 1.42e-03
2022-04-16 20:32:53,628 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.902, Acc: 0.961, Base Lr: 1.42e-03
2022-04-16 20:33:13,815 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-16 20:33:44,317 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8244044780731201 
2022-04-16 20:33:44,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 20:33:44,318 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 182.4%
2022-04-16 20:34:19,270 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.893, Acc: 0.965, Base Lr: 1.19e-03
2022-04-16 20:34:54,948 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.903, Acc: 0.962, Base Lr: 1.19e-03
2022-04-16 20:35:15,312 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-16 20:35:48,764 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.8162354230880737 
2022-04-16 20:35:48,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 20:35:48,766 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 181.6%
2022-04-16 20:36:24,080 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.917, Acc: 0.959, Base Lr: 9.72e-04
2022-04-16 20:36:56,967 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.910, Acc: 0.959, Base Lr: 9.72e-04
2022-04-16 20:37:22,218 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.342[s] Speed: 46.7[samples/s]
2022-04-16 20:37:48,819 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.90494966506958 
2022-04-16 20:37:48,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 20:37:48,822 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 190.5%
2022-04-16 20:38:23,433 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.891, Acc: 0.969, Base Lr: 7.78e-04
2022-04-16 20:38:55,031 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.897, Acc: 0.965, Base Lr: 7.78e-04
2022-04-16 20:39:13,630 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.311[s] Speed: 51.5[samples/s]
2022-04-16 20:39:39,302 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8169331550598145 
2022-04-16 20:39:39,307 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 20:39:39,307 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 181.7%
2022-04-16 20:40:14,123 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.893, Acc: 0.962, Base Lr: 6.04e-04
2022-04-16 20:40:42,189 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.889, Acc: 0.964, Base Lr: 6.04e-04
2022-04-16 20:40:59,295 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.293[s] Speed: 54.6[samples/s]
2022-04-16 20:41:41,582 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.85489821434021 
2022-04-16 20:41:41,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 20:41:41,584 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 185.5%
2022-04-16 20:42:11,661 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.916, Acc: 0.957, Base Lr: 4.51e-04
2022-04-16 20:42:48,325 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.906, Acc: 0.961, Base Lr: 4.51e-04
2022-04-16 20:43:14,280 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 20:43:46,401 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.8491854667663574 
2022-04-16 20:43:46,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 20:43:46,404 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 184.9%
2022-04-16 20:44:21,581 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.894, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 20:44:54,506 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.889, Acc: 0.967, Base Lr: 3.20e-04
2022-04-16 20:45:20,028 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-16 20:45:49,266 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.7945234775543213 
2022-04-16 20:45:49,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 20:45:49,266 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 179.5%
2022-04-16 20:46:23,850 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.896, Acc: 0.964, Base Lr: 2.11e-04
2022-04-16 20:46:54,790 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.894, Acc: 0.964, Base Lr: 2.11e-04
2022-04-16 20:47:15,906 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-16 20:47:46,041 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.7922335863113403 
2022-04-16 20:47:46,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 20:47:46,041 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 179.2%
2022-04-16 20:48:21,223 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.898, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 20:48:55,714 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.894, Acc: 0.966, Base Lr: 1.26e-04
2022-04-16 20:49:20,300 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.345[s] Speed: 46.3[samples/s]
2022-04-16 20:49:49,396 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.8274012804031372 
2022-04-16 20:49:49,396 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 20:49:49,396 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 182.7%
2022-04-16 20:50:29,742 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.896, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 20:51:01,529 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.901, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 20:51:23,694 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.345[s] Speed: 46.3[samples/s]
2022-04-16 20:51:55,851 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.8269070386886597 
2022-04-16 20:51:55,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 20:51:55,851 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 182.7%
2022-04-16 20:52:31,377 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.899, Acc: 0.964, Base Lr: 2.83e-05
2022-04-16 20:53:09,021 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.895, Acc: 0.964, Base Lr: 2.83e-05
2022-04-16 20:53:29,716 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 20:54:01,495 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.7935782670974731 
2022-04-16 20:54:01,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 20:54:01,495 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 179.4%
2022-04-16 20:54:33,983 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.901, Acc: 0.966, Base Lr: 1.60e-05
2022-04-16 20:55:05,217 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.892, Acc: 0.969, Base Lr: 1.60e-05
2022-04-16 20:55:31,346 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-16 20:56:04,409 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.814789891242981 
2022-04-16 20:56:04,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 20:56:04,409 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 181.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_6/transformer_best_model.pth
2022-04-16 20:56:41,040 reid_baseline.train INFO: normal accuracy 0.7367119901112484 1.7099241018295288 
2022-04-16 20:56:41,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:56:41,041 reid_baseline.train INFO: Accuracy: 73.7%
2022-04-16 20:57:13,243 reid_baseline.train INFO: normal accuracy 0.7367119901112484 1.7099241018295288 
2022-04-16 20:57:13,243 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:57:13,243 reid_baseline.train INFO: Shuffled Accuracy: 73.7%
2022-04-16 20:57:45,775 reid_baseline.train INFO: normal accuracy 0.9729667812142039 0.6199893355369568 
2022-04-16 20:57:45,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 20:57:45,775 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-16 20:57:49,993 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_6
2022-04-16 20:57:49,993 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-16 20:57:49,993 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 20:57:49,994 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 20:57:49,994 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 20:57:57,409 reid_baseline.train INFO: start training
2022-04-16 20:58:42,322 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.163, Base Lr: 4.76e-04
2022-04-16 20:59:17,307 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.296, Base Lr: 4.76e-04
2022-04-16 20:59:42,879 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.381[s] Speed: 42.0[samples/s]
2022-04-16 21:01:43,429 reid_baseline.train INFO: normal accuracy 0.54395226072986 4.171687602996826 
2022-04-16 21:01:49,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 21:01:49,285 reid_baseline.train INFO: Accuracy: 54.4% Mean Entropy: 417.2%
2022-04-16 21:02:24,048 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.892, Acc: 0.565, Base Lr: 8.72e-04
2022-04-16 21:03:01,833 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.817, Acc: 0.557, Base Lr: 8.72e-04
2022-04-16 21:03:29,636 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.368[s] Speed: 43.5[samples/s]
2022-04-16 21:05:29,836 reid_baseline.train INFO: normal accuracy 0.5825109019967868 4.151192665100098 
2022-04-16 21:05:35,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 21:05:35,675 reid_baseline.train INFO: Accuracy: 58.3% Mean Entropy: 415.1%
2022-04-16 21:06:16,297 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.385, Acc: 0.593, Base Lr: 1.27e-03
2022-04-16 21:06:50,091 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.273, Acc: 0.579, Base Lr: 1.27e-03
2022-04-16 21:07:12,787 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.356[s] Speed: 45.0[samples/s]
2022-04-16 21:09:11,002 reid_baseline.train INFO: normal accuracy 0.6075281156759238 3.982252836227417 
2022-04-16 21:09:20,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 21:09:20,997 reid_baseline.train INFO: Accuracy: 60.8% Mean Entropy: 398.2%
2022-04-16 21:09:53,141 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.726, Acc: 0.585, Base Lr: 1.66e-03
2022-04-16 21:10:25,504 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.598, Acc: 0.610, Base Lr: 1.66e-03
2022-04-16 21:10:48,765 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-16 21:12:49,202 reid_baseline.train INFO: normal accuracy 0.6552673858159284 3.503140926361084 
2022-04-16 21:12:54,321 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 21:12:54,322 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 350.3%
2022-04-16 21:13:24,651 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.182, Acc: 0.652, Base Lr: 2.06e-03
2022-04-16 21:13:55,425 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.109, Acc: 0.666, Base Lr: 2.06e-03
2022-04-16 21:14:18,429 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-16 21:16:07,107 reid_baseline.train INFO: normal accuracy 0.7089740647234336 2.9971132278442383 
2022-04-16 21:16:13,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 21:16:13,238 reid_baseline.train INFO: Accuracy: 70.9% Mean Entropy: 299.7%
2022-04-16 21:16:54,570 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.794, Acc: 0.731, Base Lr: 2.46e-03
2022-04-16 21:17:34,375 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.777, Acc: 0.732, Base Lr: 2.46e-03
2022-04-16 21:17:57,391 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.381[s] Speed: 41.9[samples/s]
2022-04-16 21:19:58,209 reid_baseline.train INFO: normal accuracy 0.7456965802157448 2.5924203395843506 
2022-04-16 21:20:02,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 21:20:02,788 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 259.2%
2022-04-16 21:20:42,897 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.612, Acc: 0.771, Base Lr: 2.85e-03
2022-04-16 21:21:20,444 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.596, Acc: 0.766, Base Lr: 2.85e-03
2022-04-16 21:21:46,891 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.381[s] Speed: 42.0[samples/s]
2022-04-16 21:23:45,738 reid_baseline.train INFO: normal accuracy 0.7571723663070921 2.3586905002593994 
2022-04-16 21:23:52,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 21:23:52,143 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 235.9%
2022-04-16 21:24:31,739 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.457, Acc: 0.796, Base Lr: 3.25e-03
2022-04-16 21:25:09,642 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.459, Acc: 0.797, Base Lr: 3.25e-03
2022-04-16 21:25:37,596 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-16 21:27:40,393 reid_baseline.train INFO: normal accuracy 0.7714023410603627 2.157212018966675 
2022-04-16 21:27:47,834 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 21:27:47,835 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 215.7%
2022-04-16 21:28:29,379 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.393, Acc: 0.818, Base Lr: 3.64e-03
2022-04-16 21:29:08,616 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.366, Acc: 0.827, Base Lr: 3.64e-03
2022-04-16 21:29:36,422 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-16 21:31:34,499 reid_baseline.train INFO: normal accuracy 0.7815010328207482 2.0794289112091064 
2022-04-16 21:31:40,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 21:31:40,277 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 207.9%
2022-04-16 21:32:19,957 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.297, Acc: 0.837, Base Lr: 4.04e-03
2022-04-16 21:32:55,502 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.309, Acc: 0.836, Base Lr: 4.04e-03
2022-04-16 21:33:23,950 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 21:35:34,355 reid_baseline.train INFO: normal accuracy 0.778517328436998 1.9622513055801392 
2022-04-16 21:35:37,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 21:35:37,474 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 196.2%
2022-04-16 21:36:18,837 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.248, Acc: 0.864, Base Lr: 4.44e-03
2022-04-16 21:36:57,265 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.255, Acc: 0.860, Base Lr: 4.44e-03
2022-04-16 21:37:24,437 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 21:39:25,796 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.8967841863632202 
2022-04-16 21:39:30,022 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 21:39:30,022 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 189.7%
2022-04-16 21:40:11,682 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.210, Acc: 0.872, Base Lr: 4.83e-03
2022-04-16 21:40:48,875 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.206, Acc: 0.868, Base Lr: 4.83e-03
2022-04-16 21:41:15,772 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.387[s] Speed: 41.3[samples/s]
2022-04-16 21:43:15,187 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.8372899293899536 
2022-04-16 21:43:21,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 21:43:21,451 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 183.7%
2022-04-16 21:44:02,681 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.142, Acc: 0.891, Base Lr: 5.23e-03
2022-04-16 21:44:42,191 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.156, Acc: 0.881, Base Lr: 5.23e-03
2022-04-16 21:45:10,453 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-16 21:47:05,668 reid_baseline.train INFO: normal accuracy 0.7886160201973835 1.8309818506240845 
2022-04-16 21:47:11,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 21:47:11,593 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 183.1%
2022-04-16 21:47:50,980 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.107, Acc: 0.896, Base Lr: 5.62e-03
2022-04-16 21:48:26,036 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.121, Acc: 0.895, Base Lr: 5.62e-03
2022-04-16 21:48:55,307 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 21:50:52,174 reid_baseline.train INFO: normal accuracy 0.7957310075740188 1.8366749286651611 
2022-04-16 21:50:52,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 21:50:52,177 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 183.7%
2022-04-16 21:51:30,968 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.081, Acc: 0.901, Base Lr: 6.02e-03
2022-04-16 21:52:12,319 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.094, Acc: 0.900, Base Lr: 6.02e-03
2022-04-16 21:52:41,148 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-16 21:54:40,822 reid_baseline.train INFO: normal accuracy 0.7945834289648841 1.8081790208816528 
2022-04-16 21:54:43,972 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 21:54:43,972 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 180.8%
2022-04-16 21:55:21,854 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.060, Acc: 0.915, Base Lr: 6.42e-03
2022-04-16 21:55:50,749 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.068, Acc: 0.918, Base Lr: 6.42e-03
2022-04-16 21:56:12,584 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 21:58:20,061 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.737213373184204 
2022-04-16 21:58:29,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 21:58:29,828 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 173.7%
2022-04-16 21:59:10,448 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.057, Acc: 0.911, Base Lr: 6.81e-03
2022-04-16 21:59:45,788 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.052, Acc: 0.914, Base Lr: 6.81e-03
2022-04-16 22:00:13,624 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 22:02:13,565 reid_baseline.train INFO: normal accuracy 0.7876979573100757 1.6870521306991577 
2022-04-16 22:02:16,683 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 22:02:16,684 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 168.7%
2022-04-16 22:02:56,780 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.031, Acc: 0.918, Base Lr: 7.21e-03
2022-04-16 22:03:33,742 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.027, Acc: 0.923, Base Lr: 7.21e-03
2022-04-16 22:04:02,152 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-16 22:05:58,212 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7309770584106445 
2022-04-16 22:05:58,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 22:05:58,212 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 173.1%
2022-04-16 22:06:35,846 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.021, Acc: 0.926, Base Lr: 7.60e-03
2022-04-16 22:07:14,474 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.012, Acc: 0.933, Base Lr: 7.60e-03
2022-04-16 22:07:42,776 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 22:09:43,226 reid_baseline.train INFO: normal accuracy 0.7883865044755566 1.6807971000671387 
2022-04-16 22:09:46,316 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 22:09:46,316 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 168.1%
2022-04-16 22:10:23,305 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.976, Acc: 0.944, Base Lr: 4.01e-03
2022-04-16 22:11:01,612 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.982, Acc: 0.940, Base Lr: 4.01e-03
2022-04-16 22:11:31,136 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.384[s] Speed: 41.7[samples/s]
2022-04-16 22:13:38,004 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.6737877130508423 
2022-04-16 22:13:41,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 22:13:41,126 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 167.4%
2022-04-16 22:14:19,312 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.961, Acc: 0.950, Base Lr: 3.69e-03
2022-04-16 22:14:49,517 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.962, Acc: 0.949, Base Lr: 3.69e-03
2022-04-16 22:15:17,173 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 22:17:21,168 reid_baseline.train INFO: normal accuracy 0.7952719761303649 1.671020746231079 
2022-04-16 22:17:24,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 22:17:24,312 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 167.1%
2022-04-16 22:17:58,653 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.954, Acc: 0.949, Base Lr: 3.38e-03
2022-04-16 22:18:36,221 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.952, Acc: 0.947, Base Lr: 3.38e-03
2022-04-16 22:18:58,224 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 22:20:58,860 reid_baseline.train INFO: normal accuracy 0.7961900390176727 1.6805678606033325 
2022-04-16 22:20:58,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 22:20:58,861 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 168.1%
2022-04-16 22:21:39,033 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.943, Acc: 0.950, Base Lr: 3.08e-03
2022-04-16 22:22:11,003 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.957, Acc: 0.946, Base Lr: 3.08e-03
2022-04-16 22:22:36,869 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-16 22:24:32,401 reid_baseline.train INFO: normal accuracy 0.7943539132430572 1.6057313680648804 
2022-04-16 22:24:38,031 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 22:24:38,032 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 160.6%
2022-04-16 22:25:11,099 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.941, Acc: 0.947, Base Lr: 2.77e-03
2022-04-16 22:25:41,362 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.939, Acc: 0.948, Base Lr: 2.77e-03
2022-04-16 22:26:04,571 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-16 22:28:05,272 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.7282167673110962 
2022-04-16 22:28:05,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 22:28:05,272 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 172.8%
2022-04-16 22:28:38,420 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.944, Acc: 0.947, Base Lr: 2.48e-03
2022-04-16 22:29:16,473 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.941, Acc: 0.949, Base Lr: 2.48e-03
2022-04-16 22:29:40,403 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.348[s] Speed: 45.9[samples/s]
2022-04-16 22:31:39,661 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.5923042297363281 
2022-04-16 22:31:43,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 22:31:43,641 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 159.2%
2022-04-16 22:32:25,994 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.910, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 22:32:57,963 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.922, Acc: 0.957, Base Lr: 2.20e-03
2022-04-16 22:33:21,500 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.358[s] Speed: 44.6[samples/s]
2022-04-16 22:35:46,702 reid_baseline.train INFO: normal accuracy 0.786779894422768 1.6688276529312134 
2022-04-16 22:35:46,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 22:35:46,704 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 166.9%
2022-04-16 22:36:21,530 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.920, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 22:36:56,547 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.922, Acc: 0.955, Base Lr: 1.92e-03
2022-04-16 22:37:20,471 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 22:39:20,373 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.6947954893112183 
2022-04-16 22:39:20,375 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 22:39:20,376 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 169.5%
2022-04-16 22:39:51,582 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.908, Acc: 0.963, Base Lr: 1.66e-03
2022-04-16 22:40:25,789 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.919, Acc: 0.956, Base Lr: 1.66e-03
2022-04-16 22:40:54,335 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-16 22:42:58,199 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.7194513082504272 
2022-04-16 22:42:58,201 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 22:42:58,202 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 171.9%
2022-04-16 22:43:32,002 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.909, Acc: 0.956, Base Lr: 1.42e-03
2022-04-16 22:44:11,210 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.902, Acc: 0.962, Base Lr: 1.42e-03
2022-04-16 22:44:33,752 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 22:46:35,912 reid_baseline.train INFO: normal accuracy 0.7927473031902685 1.7005198001861572 
2022-04-16 22:46:35,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 22:46:35,914 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 170.1%
2022-04-16 22:47:11,292 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.893, Acc: 0.965, Base Lr: 1.19e-03
2022-04-16 22:47:43,544 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.904, Acc: 0.961, Base Lr: 1.19e-03
2022-04-16 22:48:04,209 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-16 22:50:05,732 reid_baseline.train INFO: normal accuracy 0.790911177415653 1.6994528770446777 
2022-04-16 22:50:05,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 22:50:05,734 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 169.9%
2022-04-16 22:50:40,569 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.917, Acc: 0.959, Base Lr: 9.72e-04
2022-04-16 22:51:12,288 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.911, Acc: 0.959, Base Lr: 9.72e-04
2022-04-16 22:51:39,124 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-16 22:53:45,772 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.7873666286468506 
2022-04-16 22:53:45,772 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 22:53:45,772 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 178.7%
2022-04-16 22:54:22,330 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.891, Acc: 0.968, Base Lr: 7.78e-04
2022-04-16 22:54:57,889 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.897, Acc: 0.965, Base Lr: 7.78e-04
2022-04-16 22:55:18,793 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.341[s] Speed: 47.0[samples/s]
2022-04-16 22:57:19,664 reid_baseline.train INFO: normal accuracy 0.7929768189120955 1.6943867206573486 
2022-04-16 22:57:19,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 22:57:19,664 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 169.4%
2022-04-16 22:57:55,531 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.894, Acc: 0.961, Base Lr: 6.04e-04
2022-04-16 22:58:27,618 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.889, Acc: 0.964, Base Lr: 6.04e-04
2022-04-16 22:58:50,002 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-16 23:00:48,435 reid_baseline.train INFO: normal accuracy 0.7932063346339224 1.73337721824646 
2022-04-16 23:00:48,436 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 23:00:48,436 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 173.3%
2022-04-16 23:01:19,968 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.916, Acc: 0.958, Base Lr: 4.51e-04
2022-04-16 23:01:51,534 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.905, Acc: 0.962, Base Lr: 4.51e-04
2022-04-16 23:02:18,942 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.332[s] Speed: 48.3[samples/s]
2022-04-16 23:04:18,906 reid_baseline.train INFO: normal accuracy 0.7920587560247877 1.721428632736206 
2022-04-16 23:04:18,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 23:04:18,906 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 172.1%
2022-04-16 23:04:52,486 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.894, Acc: 0.965, Base Lr: 3.20e-04
2022-04-16 23:05:30,462 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.889, Acc: 0.967, Base Lr: 3.20e-04
2022-04-16 23:05:51,685 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 23:07:47,157 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.6706655025482178 
2022-04-16 23:07:47,159 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 23:07:47,159 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 167.1%
2022-04-16 23:08:22,922 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.896, Acc: 0.962, Base Lr: 2.11e-04
2022-04-16 23:08:53,197 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.895, Acc: 0.963, Base Lr: 2.11e-04
2022-04-16 23:09:15,257 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-16 23:11:10,199 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.6757150888442993 
2022-04-16 23:11:10,200 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 23:11:10,200 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 167.6%
2022-04-16 23:11:43,277 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.898, Acc: 0.966, Base Lr: 1.26e-04
2022-04-16 23:12:14,518 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.894, Acc: 0.965, Base Lr: 1.26e-04
2022-04-16 23:12:38,468 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-16 23:14:39,792 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7142847776412964 
2022-04-16 23:14:39,792 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 23:14:39,793 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 171.4%
2022-04-16 23:15:14,107 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.896, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 23:15:49,845 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.901, Acc: 0.961, Base Lr: 6.51e-05
2022-04-16 23:16:11,821 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-16 23:18:10,606 reid_baseline.train INFO: normal accuracy 0.790911177415653 1.7094007730484009 
2022-04-16 23:18:10,608 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 23:18:10,608 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 170.9%
2022-04-16 23:18:47,360 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.899, Acc: 0.964, Base Lr: 2.83e-05
2022-04-16 23:19:18,784 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.894, Acc: 0.964, Base Lr: 2.83e-05
2022-04-16 23:19:42,518 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-16 23:21:41,285 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.6747632026672363 
2022-04-16 23:21:41,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 23:21:41,287 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 167.5%
2022-04-16 23:22:13,405 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.901, Acc: 0.965, Base Lr: 1.60e-05
2022-04-16 23:22:42,412 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.892, Acc: 0.968, Base Lr: 1.60e-05
2022-04-16 23:23:03,446 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-16 23:25:12,770 reid_baseline.train INFO: normal accuracy 0.7920587560247877 1.697658896446228 
2022-04-16 23:25:12,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 23:25:12,771 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_6/transformer_best_model.pth
2022-04-16 23:27:10,644 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.5923042297363281 
2022-04-16 23:27:10,644 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:27:10,645 reid_baseline.train INFO: Accuracy: 79.2%
2022-04-16 23:29:08,241 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.5923042297363281 
2022-04-16 23:29:08,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:29:08,241 reid_baseline.train INFO: Shuffled Accuracy: 79.2%
2022-04-16 23:29:41,226 reid_baseline.train INFO: normal accuracy 0.9729667812142039 0.6202189922332764 
2022-04-16 23:29:41,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:29:41,226 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-16 23:29:47,696 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_8
2022-04-16 23:29:47,696 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-16 23:29:47,696 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 23:29:47,696 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 23:29:47,697 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 23:29:53,585 reid_baseline.train INFO: start training
2022-04-16 23:30:28,359 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.144, Acc: 0.160, Base Lr: 4.76e-04
2022-04-16 23:31:03,700 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.109, Acc: 0.297, Base Lr: 4.76e-04
2022-04-16 23:31:32,661 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.362[s] Speed: 44.3[samples/s]
2022-04-16 23:32:00,929 reid_baseline.train INFO: normal accuracy 0.48413679439637414 4.171698093414307 
2022-04-16 23:32:03,954 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 23:32:03,955 reid_baseline.train INFO: Accuracy: 48.4% Mean Entropy: 417.2%
2022-04-16 23:32:25,909 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.889, Acc: 0.563, Base Lr: 8.72e-04
2022-04-16 23:32:46,509 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.816, Acc: 0.552, Base Lr: 8.72e-04
2022-04-16 23:33:00,924 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-16 23:33:22,565 reid_baseline.train INFO: normal accuracy 0.5282241450350227 4.152806282043457 
2022-04-16 23:33:25,663 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 23:33:25,663 reid_baseline.train INFO: Accuracy: 52.8% Mean Ent