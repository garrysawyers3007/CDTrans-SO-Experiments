2022-05-08 11:08:06,454 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/APR_DRI_patch_4
2022-05-08 11:08:06,454 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/APR_DRI_patch_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/APR.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False, layer_num=1)
2022-05-08 11:08:06,454 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 11:08:06,454 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 11:08:06,455 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/APR.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/APR_DRI_patch_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train APR and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11223 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 11:08:15,872 reid_baseline.train INFO: start training
2022-05-08 11:09:04,113 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.086, Acc: 0.416, Base Lr: 8.72e-04
2022-05-08 11:09:50,602 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 3.974, Acc: 0.576, Base Lr: 8.72e-04
2022-05-08 11:10:36,611 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.861, Acc: 0.635, Base Lr: 8.72e-04
2022-05-08 11:11:22,022 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.745, Acc: 0.669, Base Lr: 8.72e-04
2022-05-08 11:12:06,467 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.622, Acc: 0.690, Base Lr: 8.72e-04
2022-05-08 11:12:50,805 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.500, Acc: 0.705, Base Lr: 8.72e-04
2022-05-08 11:13:33,637 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.374, Acc: 0.721, Base Lr: 8.72e-04
2022-05-08 11:13:34,437 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.452[s] Speed: 35.4[samples/s]
2022-05-08 11:14:20,242 reid_baseline.train INFO: normal accuracy 0.5454753722794959 3.9407060146331787 
2022-05-08 11:14:21,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 11:14:21,284 reid_baseline.train INFO: Accuracy: 54.5% Mean Entropy: 394.1%
2022-05-08 11:15:12,355 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.259, Acc: 0.805, Base Lr: 1.66e-03
2022-05-08 11:16:01,222 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.096, Acc: 0.812, Base Lr: 1.66e-03
2022-05-08 11:16:43,007 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 1.987, Acc: 0.809, Base Lr: 1.66e-03
2022-05-08 11:17:27,275 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 1.904, Acc: 0.812, Base Lr: 1.66e-03
2022-05-08 11:18:11,190 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 1.820, Acc: 0.822, Base Lr: 1.66e-03
2022-05-08 11:18:54,199 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 1.756, Acc: 0.826, Base Lr: 1.66e-03
2022-05-08 11:19:34,954 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 1.701, Acc: 0.828, Base Lr: 1.66e-03
2022-05-08 11:19:35,890 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.448[s] Speed: 35.7[samples/s]
2022-05-08 11:20:21,167 reid_baseline.train INFO: normal accuracy 0.5949599083619702 2.5608346462249756 
2022-05-08 11:20:22,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 11:20:22,378 reid_baseline.train INFO: Accuracy: 59.5% Mean Entropy: 256.1%
2022-05-08 11:21:10,462 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.298, Acc: 0.877, Base Lr: 2.46e-03
2022-05-08 11:21:56,758 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.277, Acc: 0.879, Base Lr: 2.46e-03
2022-05-08 11:22:45,131 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.266, Acc: 0.877, Base Lr: 2.46e-03
2022-05-08 11:23:31,772 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.245, Acc: 0.878, Base Lr: 2.46e-03
2022-05-08 11:24:14,479 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.236, Acc: 0.879, Base Lr: 2.46e-03
2022-05-08 11:24:58,198 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.229, Acc: 0.878, Base Lr: 2.46e-03
2022-05-08 11:25:38,789 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.221, Acc: 0.878, Base Lr: 2.46e-03
2022-05-08 11:25:39,540 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.452[s] Speed: 35.4[samples/s]
2022-05-08 11:26:25,452 reid_baseline.train INFO: normal accuracy 0.6100801832760596 2.0432090759277344 
2022-05-08 11:26:26,742 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 11:26:26,742 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 204.3%
2022-05-08 11:27:17,282 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.083, Acc: 0.917, Base Lr: 3.25e-03
2022-05-08 11:28:00,330 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.112, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 11:28:45,544 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.102, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 11:29:29,899 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.101, Acc: 0.903, Base Lr: 3.25e-03
2022-05-08 11:30:16,913 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.100, Acc: 0.901, Base Lr: 3.25e-03
2022-05-08 11:31:04,763 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.100, Acc: 0.901, Base Lr: 3.25e-03
2022-05-08 11:31:45,345 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.098, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 11:31:46,097 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.455[s] Speed: 35.2[samples/s]
2022-05-08 11:32:29,683 reid_baseline.train INFO: normal accuracy 0.6302405498281787 1.871624231338501 
2022-05-08 11:32:32,449 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 11:32:32,449 reid_baseline.train INFO: Accuracy: 63.0% Mean Entropy: 187.2%
2022-05-08 11:33:21,236 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.020, Acc: 0.925, Base Lr: 4.04e-03
2022-05-08 11:34:04,823 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.024, Acc: 0.924, Base Lr: 4.04e-03
2022-05-08 11:34:47,151 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.026, Acc: 0.922, Base Lr: 4.04e-03
2022-05-08 11:35:30,288 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.033, Acc: 0.920, Base Lr: 4.04e-03
2022-05-08 11:36:14,984 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.034, Acc: 0.921, Base Lr: 4.04e-03
2022-05-08 11:37:00,006 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.036, Acc: 0.920, Base Lr: 4.04e-03
2022-05-08 11:37:38,292 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.036, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 11:37:38,994 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.437[s] Speed: 36.6[samples/s]
2022-05-08 11:38:26,539 reid_baseline.train INFO: normal accuracy 0.638487972508591 1.7151905298233032 
2022-05-08 11:38:27,870 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 11:38:27,870 reid_baseline.train INFO: Accuracy: 63.8% Mean Entropy: 171.5%
2022-05-08 11:39:20,069 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 0.995, Acc: 0.936, Base Lr: 4.83e-03
2022-05-08 11:40:04,352 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 0.993, Acc: 0.934, Base Lr: 4.83e-03
2022-05-08 11:40:45,618 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 0.995, Acc: 0.933, Base Lr: 4.83e-03
2022-05-08 11:41:28,976 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 0.988, Acc: 0.935, Base Lr: 4.83e-03
2022-05-08 11:42:12,272 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 0.988, Acc: 0.935, Base Lr: 4.83e-03
2022-05-08 11:42:56,267 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 0.986, Acc: 0.936, Base Lr: 4.83e-03
2022-05-08 11:43:36,161 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 0.985, Acc: 0.937, Base Lr: 4.83e-03
2022-05-08 11:43:36,900 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.440[s] Speed: 36.4[samples/s]
2022-05-08 11:44:21,467 reid_baseline.train INFO: normal accuracy 0.6327605956471936 1.757235050201416 
2022-05-08 11:44:21,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 11:44:21,468 reid_baseline.train INFO: Accuracy: 63.3% Mean Entropy: 175.7%
2022-05-08 11:45:10,182 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 0.931, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 11:45:55,074 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 0.945, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 11:46:41,813 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 0.949, Acc: 0.947, Base Lr: 5.62e-03
2022-05-08 11:47:29,313 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 0.947, Acc: 0.947, Base Lr: 5.62e-03
2022-05-08 11:48:10,289 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 0.947, Acc: 0.949, Base Lr: 5.62e-03
2022-05-08 11:48:52,995 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 0.946, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 11:49:30,333 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 0.948, Acc: 0.949, Base Lr: 5.62e-03
2022-05-08 11:49:31,109 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.441[s] Speed: 36.3[samples/s]
2022-05-08 11:50:16,559 reid_baseline.train INFO: normal accuracy 0.6316151202749141 1.7251324653625488 
2022-05-08 11:50:16,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 11:50:16,562 reid_baseline.train INFO: Accuracy: 63.2% Mean Entropy: 172.5%
2022-05-08 11:51:05,127 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.900, Acc: 0.967, Base Lr: 6.42e-03
2022-05-08 11:51:48,714 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.903, Acc: 0.968, Base Lr: 6.42e-03
2022-05-08 11:52:32,841 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.907, Acc: 0.964, Base Lr: 6.42e-03
2022-05-08 11:53:16,306 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.909, Acc: 0.963, Base Lr: 6.42e-03
2022-05-08 11:54:03,948 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.917, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 11:54:51,428 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.919, Acc: 0.959, Base Lr: 6.42e-03
2022-05-08 11:55:31,197 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.920, Acc: 0.959, Base Lr: 6.42e-03
2022-05-08 11:55:32,258 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.449[s] Speed: 35.6[samples/s]
2022-05-08 11:56:18,426 reid_baseline.train INFO: normal accuracy 0.6387170675830469 1.5996617078781128 
2022-05-08 11:56:20,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 11:56:20,882 reid_baseline.train INFO: Accuracy: 63.9% Mean Entropy: 160.0%
2022-05-08 11:57:09,863 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.887, Acc: 0.970, Base Lr: 7.21e-03
2022-05-08 11:57:54,586 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.893, Acc: 0.970, Base Lr: 7.21e-03
2022-05-08 11:58:38,124 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.893, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 11:59:22,254 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.890, Acc: 0.970, Base Lr: 7.21e-03
2022-05-08 12:00:05,976 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.894, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 12:00:49,527 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.892, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 12:01:29,481 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.891, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 12:01:30,227 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.441[s] Speed: 36.3[samples/s]
2022-05-08 12:02:20,413 reid_baseline.train INFO: normal accuracy 0.6229095074455899 1.6722033023834229 
2022-05-08 12:02:20,414 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 12:02:20,414 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 167.2%
2022-05-08 12:03:12,918 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.863, Acc: 0.975, Base Lr: 4.01e-03
2022-05-08 12:03:55,655 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.862, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 12:04:40,028 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.859, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 12:05:23,659 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.860, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 12:06:07,931 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.861, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 12:06:49,744 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.861, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 12:07:29,875 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.861, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 12:07:30,608 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.441[s] Speed: 36.2[samples/s]
2022-05-08 12:08:16,685 reid_baseline.train INFO: normal accuracy 0.633906071019473 1.6673965454101562 
2022-05-08 12:08:16,686 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 12:08:16,686 reid_baseline.train INFO: Accuracy: 63.4% Mean Entropy: 166.7%
2022-05-08 12:09:04,143 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.842, Acc: 0.984, Base Lr: 3.38e-03
2022-05-08 12:09:51,912 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.841, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 12:10:39,794 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.842, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 12:11:27,486 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.843, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 12:12:08,212 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.844, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 12:12:50,142 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.844, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 12:13:27,658 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.843, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 12:13:28,328 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.443[s] Speed: 36.1[samples/s]
2022-05-08 12:14:14,821 reid_baseline.train INFO: normal accuracy 0.6416953035509737 1.5751559734344482 
2022-05-08 12:14:16,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 12:14:16,076 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 157.5%
2022-05-08 12:15:05,484 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.836, Acc: 0.989, Base Lr: 2.77e-03
2022-05-08 12:15:48,846 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.835, Acc: 0.987, Base Lr: 2.77e-03
2022-05-08 12:16:33,439 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.834, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 12:17:19,237 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.834, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 12:18:06,383 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.834, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 12:18:50,214 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.835, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 12:19:26,928 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.834, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 12:19:27,509 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.443[s] Speed: 36.1[samples/s]
2022-05-08 12:20:13,443 reid_baseline.train INFO: normal accuracy 0.6355097365406643 1.6030306816101074 
2022-05-08 12:20:13,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 12:20:13,445 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 160.3%
2022-05-08 12:21:01,953 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.823, Acc: 0.990, Base Lr: 2.20e-03
2022-05-08 12:21:47,312 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.827, Acc: 0.988, Base Lr: 2.20e-03
2022-05-08 12:22:30,148 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.825, Acc: 0.989, Base Lr: 2.20e-03
2022-05-08 12:23:14,147 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.825, Acc: 0.989, Base Lr: 2.20e-03
2022-05-08 12:23:58,023 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.825, Acc: 0.989, Base Lr: 2.20e-03
2022-05-08 12:24:39,116 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.826, Acc: 0.988, Base Lr: 2.20e-03
2022-05-08 12:25:19,604 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.828, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 12:25:20,444 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.437[s] Speed: 36.6[samples/s]
2022-05-08 12:26:09,919 reid_baseline.train INFO: normal accuracy 0.6471935853379153 1.607518196105957 
2022-05-08 12:26:09,920 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 12:26:09,920 reid_baseline.train INFO: Accuracy: 64.7% Mean Entropy: 160.8%
2022-05-08 12:27:00,464 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.814, Acc: 0.991, Base Lr: 1.66e-03
2022-05-08 12:27:42,853 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.818, Acc: 0.990, Base Lr: 1.66e-03
2022-05-08 12:28:26,688 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.818, Acc: 0.990, Base Lr: 1.66e-03
2022-05-08 12:29:10,801 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.820, Acc: 0.990, Base Lr: 1.66e-03
2022-05-08 12:29:55,544 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.823, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 12:30:37,293 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.822, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 12:31:18,706 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.822, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 12:31:19,520 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.441[s] Speed: 36.3[samples/s]
2022-05-08 12:32:06,455 reid_baseline.train INFO: normal accuracy 0.6414662084765178 1.6400303840637207 
2022-05-08 12:32:06,455 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 12:32:06,455 reid_baseline.train INFO: Accuracy: 64.1% Mean Entropy: 164.0%
2022-05-08 12:32:56,648 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.808, Acc: 0.994, Base Lr: 1.19e-03
2022-05-08 12:33:43,094 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.809, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 12:34:30,926 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.812, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 12:35:16,237 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.811, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 12:35:59,752 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.813, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 12:36:40,376 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.813, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 12:37:21,534 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.814, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 12:37:22,488 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.450[s] Speed: 35.6[samples/s]
2022-05-08 12:38:10,206 reid_baseline.train INFO: normal accuracy 0.6412371134020619 1.584596872329712 
2022-05-08 12:38:10,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 12:38:10,207 reid_baseline.train INFO: Accuracy: 64.1% Mean Entropy: 158.5%
2022-05-08 12:38:59,742 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.813, Acc: 0.987, Base Lr: 7.78e-04
2022-05-08 12:39:43,383 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.809, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 12:40:28,279 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.809, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 12:41:15,519 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.810, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 12:41:59,963 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.809, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 12:42:41,512 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.809, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 12:43:20,041 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.810, Acc: 0.990, Base Lr: 7.78e-04
2022-05-08 12:43:20,929 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.443[s] Speed: 36.2[samples/s]
2022-05-08 12:44:06,601 reid_baseline.train INFO: normal accuracy 0.6421534936998855 1.6768156290054321 
2022-05-08 12:44:06,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 12:44:06,603 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 167.7%
2022-05-08 12:44:54,864 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.801, Acc: 0.993, Base Lr: 4.51e-04
2022-05-08 12:45:40,225 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.804, Acc: 0.993, Base Lr: 4.51e-04
2022-05-08 12:46:23,821 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.805, Acc: 0.993, Base Lr: 4.51e-04
2022-05-08 12:47:08,055 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.807, Acc: 0.992, Base Lr: 4.51e-04
2022-05-08 12:47:50,871 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 4.51e-04
2022-05-08 12:48:33,010 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.808, Acc: 0.992, Base Lr: 4.51e-04
2022-05-08 12:49:16,773 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.809, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 12:49:17,703 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.443[s] Speed: 36.1[samples/s]
2022-05-08 12:50:06,896 reid_baseline.train INFO: normal accuracy 0.6451317296678122 1.6553459167480469 
2022-05-08 12:50:06,898 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 12:50:06,899 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 165.5%
2022-05-08 12:50:51,981 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.813, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 12:51:36,763 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.812, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 12:52:20,676 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.808, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 12:53:06,532 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.806, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 12:53:48,664 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 12:54:28,137 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.806, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 12:55:10,714 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.808, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 12:55:11,544 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.434[s] Speed: 36.9[samples/s]
2022-05-08 12:55:57,228 reid_baseline.train INFO: normal accuracy 0.6435280641466209 1.602734923362732 
2022-05-08 12:55:57,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 12:55:57,229 reid_baseline.train INFO: Accuracy: 64.4% Mean Entropy: 160.3%
2022-05-08 12:56:49,032 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.808, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 12:57:35,769 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.808, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 12:58:21,353 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.807, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 12:59:04,207 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.808, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 12:59:45,415 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 13:00:26,041 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 13:01:09,847 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 13:01:10,771 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.446[s] Speed: 35.8[samples/s]
2022-05-08 13:01:57,570 reid_baseline.train INFO: normal accuracy 0.6451317296678122 1.6297799348831177 
2022-05-08 13:01:57,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 13:01:57,571 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 163.0%
2022-05-08 13:02:46,684 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.808, Acc: 0.993, Base Lr: 1.60e-05
2022-05-08 13:03:29,898 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.807, Acc: 0.993, Base Lr: 1.60e-05
2022-05-08 13:04:16,053 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.810, Acc: 0.990, Base Lr: 1.60e-05
2022-05-08 13:05:03,046 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.808, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 13:05:45,834 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.807, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 13:06:23,277 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.807, Acc: 0.990, Base Lr: 1.60e-05
2022-05-08 13:07:02,085 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.808, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 13:07:02,875 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.435[s] Speed: 36.8[samples/s]
2022-05-08 13:07:47,843 reid_baseline.train INFO: normal accuracy 0.6449026345933563 1.612403392791748 
2022-05-08 13:07:47,843 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 13:07:47,844 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 161.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/APR_DRI_patch_4/transformer_best_model.pth
2022-05-08 13:08:35,602 reid_baseline.train INFO: normal accuracy 0.6416953035509737 1.5751559734344482 
2022-05-08 13:08:35,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:08:35,603 reid_baseline.train INFO: Accuracy: 64.2%
2022-05-08 13:09:21,556 reid_baseline.train INFO: normal accuracy 0.6416953035509737 1.5751559734344482 
2022-05-08 13:09:21,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:09:21,558 reid_baseline.train INFO: Shuffled Accuracy: 64.2%
2022-05-08 13:13:19,004 reid_baseline.train INFO: normal accuracy 0.99171344560278 0.6211084723472595 
2022-05-08 13:13:19,005 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:13:19,005 reid_baseline.train INFO: Source Clean Accuracy: 99.2%
2022-05-08 13:13:26,885 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/APR_DRI_patch_5
2022-05-08 13:13:26,885 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/APR_DRI_patch_5', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/APR.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=5, dom_cls=False, layer_num=1)
2022-05-08 13:13:26,885 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 13:13:26,885 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 13:13:26,886 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/APR.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/APR_DRI_patch_5
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train APR and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11223 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 13:13:40,133 reid_baseline.train INFO: start training
2022-05-08 13:14:37,630 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.086, Acc: 0.416, Base Lr: 8.72e-04
2022-05-08 13:15:28,841 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 3.974, Acc: 0.577, Base Lr: 8.72e-04
2022-05-08 13:16:18,221 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.860, Acc: 0.636, Base Lr: 8.72e-04
2022-05-08 13:17:08,081 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.744, Acc: 0.671, Base Lr: 8.72e-04
2022-05-08 13:17:56,528 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.622, Acc: 0.691, Base Lr: 8.72e-04
2022-05-08 13:18:44,692 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.500, Acc: 0.706, Base Lr: 8.72e-04
2022-05-08 13:19:39,159 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.374, Acc: 0.722, Base Lr: 8.72e-04
2022-05-08 13:19:40,479 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.511[s] Speed: 31.3[samples/s]
2022-05-08 13:20:28,022 reid_baseline.train INFO: normal accuracy 0.5457044673539518 3.9421141147613525 
2022-05-08 13:20:29,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 13:20:29,276 reid_baseline.train INFO: Accuracy: 54.6% Mean Entropy: 394.2%
2022-05-08 13:21:26,286 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.282, Acc: 0.814, Base Lr: 1.66e-03
2022-05-08 13:22:17,691 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.105, Acc: 0.819, Base Lr: 1.66e-03
2022-05-08 13:23:06,465 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 2.003, Acc: 0.811, Base Lr: 1.66e-03
2022-05-08 13:23:54,856 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 1.906, Acc: 0.816, Base Lr: 1.66e-03
2022-05-08 13:24:40,083 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 1.823, Acc: 0.822, Base Lr: 1.66e-03
2022-05-08 13:25:29,344 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 1.756, Acc: 0.826, Base Lr: 1.66e-03
2022-05-08 13:26:20,839 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 1.705, Acc: 0.827, Base Lr: 1.66e-03
2022-05-08 13:26:21,981 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.502[s] Speed: 31.8[samples/s]
2022-05-08 13:27:10,313 reid_baseline.train INFO: normal accuracy 0.5990836197021764 2.548236846923828 
2022-05-08 13:27:11,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 13:27:11,717 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 254.8%
2022-05-08 13:28:12,369 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.279, Acc: 0.877, Base Lr: 2.46e-03
2022-05-08 13:28:52,915 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.264, Acc: 0.876, Base Lr: 2.46e-03
2022-05-08 13:29:37,540 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.253, Acc: 0.878, Base Lr: 2.46e-03
2022-05-08 13:30:27,135 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.245, Acc: 0.875, Base Lr: 2.46e-03
2022-05-08 13:31:14,881 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.231, Acc: 0.879, Base Lr: 2.46e-03
2022-05-08 13:32:02,970 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.228, Acc: 0.878, Base Lr: 2.46e-03
2022-05-08 13:32:51,225 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.221, Acc: 0.877, Base Lr: 2.46e-03
2022-05-08 13:32:52,201 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.485[s] Speed: 33.0[samples/s]
2022-05-08 13:33:36,530 reid_baseline.train INFO: normal accuracy 0.6164948453608248 2.0293824672698975 
2022-05-08 13:33:37,678 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 13:33:37,678 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 202.9%
2022-05-08 13:34:33,051 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.135, Acc: 0.891, Base Lr: 3.25e-03
2022-05-08 13:35:26,120 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.132, Acc: 0.888, Base Lr: 3.25e-03
2022-05-08 13:36:17,600 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.126, Acc: 0.894, Base Lr: 3.25e-03
2022-05-08 13:37:02,240 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.110, Acc: 0.897, Base Lr: 3.25e-03
2022-05-08 13:37:49,506 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.109, Acc: 0.899, Base Lr: 3.25e-03
2022-05-08 13:38:37,070 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.102, Acc: 0.900, Base Lr: 3.25e-03
2022-05-08 13:39:26,508 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.100, Acc: 0.901, Base Lr: 3.25e-03
2022-05-08 13:39:27,848 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.499[s] Speed: 32.1[samples/s]
2022-05-08 13:40:12,586 reid_baseline.train INFO: normal accuracy 0.6252004581901489 1.941111445426941 
2022-05-08 13:40:13,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 13:40:13,840 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 194.1%
2022-05-08 13:41:09,550 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.031, Acc: 0.923, Base Lr: 4.04e-03
2022-05-08 13:41:58,774 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.034, Acc: 0.921, Base Lr: 4.04e-03
2022-05-08 13:42:51,116 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.037, Acc: 0.918, Base Lr: 4.04e-03
2022-05-08 13:43:43,166 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.042, Acc: 0.916, Base Lr: 4.04e-03
2022-05-08 13:44:29,644 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.039, Acc: 0.918, Base Lr: 4.04e-03
2022-05-08 13:45:14,062 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.038, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 13:46:07,344 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.037, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 13:46:08,447 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.505[s] Speed: 31.7[samples/s]
2022-05-08 13:46:58,788 reid_baseline.train INFO: normal accuracy 0.6325315005727377 1.783036470413208 
2022-05-08 13:46:59,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 13:46:59,875 reid_baseline.train INFO: Accuracy: 63.3% Mean Entropy: 178.3%
2022-05-08 13:47:53,391 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 1.011, Acc: 0.931, Base Lr: 4.83e-03
2022-05-08 13:48:47,577 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 1.008, Acc: 0.929, Base Lr: 4.83e-03
2022-05-08 13:49:41,396 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 1.002, Acc: 0.930, Base Lr: 4.83e-03
2022-05-08 13:50:29,436 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 0.993, Acc: 0.933, Base Lr: 4.83e-03
2022-05-08 13:51:19,090 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 0.989, Acc: 0.936, Base Lr: 4.83e-03
2022-05-08 13:52:07,269 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 0.990, Acc: 0.935, Base Lr: 4.83e-03
2022-05-08 13:52:51,884 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 0.992, Acc: 0.933, Base Lr: 4.83e-03
2022-05-08 13:52:53,013 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.503[s] Speed: 31.8[samples/s]
2022-05-08 13:53:37,801 reid_baseline.train INFO: normal accuracy 0.6366552119129438 1.7499468326568604 
2022-05-08 13:53:39,101 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 13:53:39,102 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 175.0%
2022-05-08 13:54:34,012 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 0.936, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 13:55:27,128 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 0.932, Acc: 0.954, Base Lr: 5.62e-03
2022-05-08 13:56:18,537 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 0.938, Acc: 0.952, Base Lr: 5.62e-03
2022-05-08 13:57:08,045 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 0.942, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 13:57:55,049 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 0.946, Acc: 0.949, Base Lr: 5.62e-03
2022-05-08 13:58:40,309 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 0.945, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 13:59:32,258 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 0.949, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 13:59:33,339 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.504[s] Speed: 31.7[samples/s]
2022-05-08 14:00:22,240 reid_baseline.train INFO: normal accuracy 0.6357388316151202 1.660586953163147 
2022-05-08 14:00:23,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 14:00:23,444 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 166.1%
2022-05-08 14:01:17,450 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.923, Acc: 0.954, Base Lr: 6.42e-03
2022-05-08 14:02:10,171 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.927, Acc: 0.955, Base Lr: 6.42e-03
2022-05-08 14:03:03,408 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.920, Acc: 0.959, Base Lr: 6.42e-03
2022-05-08 14:03:55,617 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.920, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 14:04:42,827 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.922, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 14:05:32,969 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.923, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 14:06:21,827 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.924, Acc: 0.959, Base Lr: 6.42e-03
2022-05-08 14:06:23,013 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.512[s] Speed: 31.2[samples/s]
2022-05-08 14:07:07,875 reid_baseline.train INFO: normal accuracy 0.6368843069873997 1.6640331745147705 
2022-05-08 14:07:07,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 14:07:07,877 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 166.4%
2022-05-08 14:08:03,717 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.909, Acc: 0.958, Base Lr: 7.21e-03
2022-05-08 14:08:57,912 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.897, Acc: 0.964, Base Lr: 7.21e-03
2022-05-08 14:09:49,222 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.894, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 14:10:36,041 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.892, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 14:11:23,198 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.891, Acc: 0.967, Base Lr: 7.21e-03
2022-05-08 14:12:13,840 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.894, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 14:13:03,101 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.895, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 14:13:03,705 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.507[s] Speed: 31.6[samples/s]
2022-05-08 14:13:48,355 reid_baseline.train INFO: normal accuracy 0.6428407789232532 1.6573498249053955 
2022-05-08 14:13:49,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 14:13:49,657 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 165.7%
2022-05-08 14:14:45,187 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.876, Acc: 0.976, Base Lr: 4.01e-03
2022-05-08 14:15:34,631 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.870, Acc: 0.974, Base Lr: 4.01e-03
2022-05-08 14:16:25,119 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.866, Acc: 0.976, Base Lr: 4.01e-03
2022-05-08 14:17:15,285 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.861, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 14:18:04,138 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.861, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 14:18:48,574 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.861, Acc: 0.979, Base Lr: 4.01e-03
2022-05-08 14:19:38,498 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.860, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 14:19:39,423 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.498[s] Speed: 32.1[samples/s]
2022-05-08 14:20:26,032 reid_baseline.train INFO: normal accuracy 0.649942726231386 1.6369214057922363 
2022-05-08 14:20:27,131 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 14:20:27,131 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 163.7%
2022-05-08 14:21:22,933 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.842, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 14:22:12,515 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.841, Acc: 0.985, Base Lr: 3.38e-03
2022-05-08 14:23:02,761 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.842, Acc: 0.985, Base Lr: 3.38e-03
2022-05-08 14:23:49,553 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.842, Acc: 0.985, Base Lr: 3.38e-03
2022-05-08 14:24:37,277 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.842, Acc: 0.985, Base Lr: 3.38e-03
2022-05-08 14:25:30,027 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.843, Acc: 0.984, Base Lr: 3.38e-03
2022-05-08 14:26:22,179 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.843, Acc: 0.984, Base Lr: 3.38e-03
2022-05-08 14:26:23,339 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.507[s] Speed: 31.6[samples/s]
2022-05-08 14:27:09,612 reid_baseline.train INFO: normal accuracy 0.638487972508591 1.5970829725265503 
2022-05-08 14:27:10,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 14:27:10,719 reid_baseline.train INFO: Accuracy: 63.8% Mean Entropy: 159.7%
2022-05-08 14:28:06,445 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.844, Acc: 0.982, Base Lr: 2.77e-03
2022-05-08 14:28:57,166 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.837, Acc: 0.987, Base Lr: 2.77e-03
2022-05-08 14:29:46,075 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.839, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 14:30:30,084 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.838, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 14:31:19,002 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.837, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 14:32:10,383 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.837, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 14:32:59,713 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.837, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 14:33:00,615 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.498[s] Speed: 32.1[samples/s]
2022-05-08 14:33:46,369 reid_baseline.train INFO: normal accuracy 0.6513172966781214 1.5824185609817505 
2022-05-08 14:33:47,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 14:33:47,668 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 158.2%
2022-05-08 14:34:45,082 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.835, Acc: 0.986, Base Lr: 2.20e-03
2022-05-08 14:35:36,323 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.830, Acc: 0.986, Base Lr: 2.20e-03
2022-05-08 14:36:22,221 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.827, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 14:37:09,211 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.827, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 14:37:56,914 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.828, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 14:38:47,050 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.828, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 14:39:36,632 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.829, Acc: 0.986, Base Lr: 2.20e-03
2022-05-08 14:39:37,643 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.498[s] Speed: 32.1[samples/s]
2022-05-08 14:40:23,282 reid_baseline.train INFO: normal accuracy 0.6481099656357389 1.617179274559021 
2022-05-08 14:40:23,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 14:40:23,283 reid_baseline.train INFO: Accuracy: 64.8% Mean Entropy: 161.7%
2022-05-08 14:41:18,879 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.816, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 14:42:09,553 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.814, Acc: 0.991, Base Lr: 1.66e-03
2022-05-08 14:43:05,327 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.817, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 14:43:54,589 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.821, Acc: 0.987, Base Lr: 1.66e-03
2022-05-08 14:44:44,454 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.820, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 14:45:33,532 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.819, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 14:46:21,469 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.820, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 14:46:22,368 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.511[s] Speed: 31.3[samples/s]
2022-05-08 14:47:07,716 reid_baseline.train INFO: normal accuracy 0.643298969072165 1.5788339376449585 
2022-05-08 14:47:08,842 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 14:47:08,843 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 157.9%
2022-05-08 14:48:04,315 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.815, Acc: 0.987, Base Lr: 1.19e-03
2022-05-08 14:48:55,457 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.812, Acc: 0.989, Base Lr: 1.19e-03
2022-05-08 14:49:43,442 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.810, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 14:50:29,553 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.809, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 14:51:23,658 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.811, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 14:52:16,937 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.814, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 14:53:01,348 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.816, Acc: 0.989, Base Lr: 1.19e-03
2022-05-08 14:53:02,577 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.504[s] Speed: 31.8[samples/s]
2022-05-08 14:53:49,383 reid_baseline.train INFO: normal accuracy 0.6462772050400917 1.5787016153335571 
2022-05-08 14:53:50,688 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 14:53:50,689 reid_baseline.train INFO: Accuracy: 64.6% Mean Entropy: 157.9%
2022-05-08 14:54:45,376 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.810, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 14:55:37,126 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.811, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 14:56:24,894 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.812, Acc: 0.990, Base Lr: 7.78e-04
2022-05-08 14:57:12,888 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.813, Acc: 0.990, Base Lr: 7.78e-04
2022-05-08 14:58:03,517 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.814, Acc: 0.989, Base Lr: 7.78e-04
2022-05-08 14:58:54,511 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.814, Acc: 0.989, Base Lr: 7.78e-04
2022-05-08 14:59:47,421 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.813, Acc: 0.990, Base Lr: 7.78e-04
2022-05-08 14:59:48,331 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.509[s] Speed: 31.4[samples/s]
2022-05-08 15:00:34,329 reid_baseline.train INFO: normal accuracy 0.6508591065292096 1.61037015914917 
2022-05-08 15:00:34,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 15:00:34,331 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 161.0%
2022-05-08 15:01:27,972 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.810, Acc: 0.992, Base Lr: 4.51e-04
2022-05-08 15:02:19,319 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.812, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 15:03:07,936 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.811, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 15:03:56,927 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.811, Acc: 0.990, Base Lr: 4.51e-04
2022-05-08 15:04:47,817 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.810, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 15:05:40,070 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.810, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 15:06:32,505 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.810, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 15:06:33,652 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.512[s] Speed: 31.3[samples/s]
2022-05-08 15:07:20,435 reid_baseline.train INFO: normal accuracy 0.6508591065292096 1.6310595273971558 
2022-05-08 15:07:20,436 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 15:07:20,436 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 163.1%
2022-05-08 15:08:19,595 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.807, Acc: 0.989, Base Lr: 2.11e-04
2022-05-08 15:09:16,241 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.809, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 15:10:04,134 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.810, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 15:10:53,308 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.809, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 15:11:47,946 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.809, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 15:12:41,915 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.808, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 15:13:36,373 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.808, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 15:13:37,619 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.537[s] Speed: 29.8[samples/s]
2022-05-08 15:14:23,449 reid_baseline.train INFO: normal accuracy 0.6504009163802978 1.6350998878479004 
2022-05-08 15:14:23,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 15:14:23,450 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 163.5%
2022-05-08 15:15:20,968 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.806, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 15:16:12,043 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.804, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 15:17:04,311 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.808, Acc: 0.989, Base Lr: 6.51e-05
2022-05-08 15:18:03,534 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.808, Acc: 0.990, Base Lr: 6.51e-05
2022-05-08 15:18:55,005 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.808, Acc: 0.990, Base Lr: 6.51e-05
2022-05-08 15:19:44,815 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.808, Acc: 0.990, Base Lr: 6.51e-05
2022-05-08 15:20:39,500 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.808, Acc: 0.990, Base Lr: 6.51e-05
2022-05-08 15:20:40,749 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.537[s] Speed: 29.8[samples/s]
2022-05-08 15:21:26,396 reid_baseline.train INFO: normal accuracy 0.6510882016036655 1.6065067052841187 
2022-05-08 15:21:26,397 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 15:21:26,397 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 160.7%
2022-05-08 15:22:31,710 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.801, Acc: 0.993, Base Lr: 1.60e-05
2022-05-08 15:23:29,742 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.804, Acc: 0.993, Base Lr: 1.60e-05
2022-05-08 15:24:22,062 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 15:25:14,438 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.806, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 15:26:11,265 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 15:27:16,034 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.808, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 15:28:16,942 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.809, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 15:28:17,939 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-05-08 15:29:06,445 reid_baseline.train INFO: normal accuracy 0.6506300114547537 1.6598676443099976 
2022-05-08 15:29:06,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 15:29:06,446 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 166.0%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/APR_DRI_patch_5/transformer_best_model.pth
2022-05-08 15:29:53,846 reid_baseline.train INFO: normal accuracy 0.6462772050400917 1.5787016153335571 
2022-05-08 15:29:53,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 15:29:53,847 reid_baseline.train INFO: Accuracy: 64.6%
2022-05-08 15:30:37,899 reid_baseline.train INFO: normal accuracy 0.6462772050400917 1.5787016153335571 
2022-05-08 15:30:37,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 15:30:37,900 reid_baseline.train INFO: Shuffled Accuracy: 64.6%
2022-05-08 15:34:38,360 reid_baseline.train INFO: normal accuracy 0.9935846030473136 0.5706506371498108 
2022-05-08 15:34:38,360 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 15:34:38,360 reid_baseline.train INFO: Source Clean Accuracy: 99.4%
2022-05-08 15:34:46,026 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/APR_DRI_patch_6
2022-05-08 15:34:46,027 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/APR_DRI_patch_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/APR.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False, layer_num=1)
2022-05-08 15:34:46,027 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 15:34:46,027 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 15:34:46,028 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/APR.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/APR_DRI_patch_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train APR and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11223 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 15:34:59,295 reid_baseline.train INFO: start training
2022-05-08 15:36:24,808 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.086, Acc: 0.409, Base Lr: 8.72e-04
2022-05-08 15:37:36,174 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 3.974, Acc: 0.572, Base Lr: 8.72e-04
2022-05-08 15:38:43,013 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.861, Acc: 0.633, Base Lr: 8.72e-04
2022-05-08 15:39:45,040 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.744, Acc: 0.669, Base Lr: 8.72e-04
2022-05-08 15:40:53,990 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.622, Acc: 0.689, Base Lr: 8.72e-04
2022-05-08 15:42:02,703 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.500, Acc: 0.705, Base Lr: 8.72e-04
2022-05-08 15:43:04,869 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.374, Acc: 0.720, Base Lr: 8.72e-04
2022-05-08 15:43:05,732 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-08 15:43:50,863 reid_baseline.train INFO: normal accuracy 0.54524627720504 3.9389548301696777 
2022-05-08 15:43:51,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 15:43:51,965 reid_baseline.train INFO: Accuracy: 54.5% Mean Entropy: 393.9%
2022-05-08 15:45:12,084 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.262, Acc: 0.798, Base Lr: 1.66e-03
2022-05-08 15:46:26,176 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.110, Acc: 0.810, Base Lr: 1.66e-03
2022-05-08 15:47:30,722 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 1.984, Acc: 0.821, Base Lr: 1.66e-03
2022-05-08 15:48:40,883 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 1.895, Acc: 0.821, Base Lr: 1.66e-03
2022-05-08 15:49:51,206 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 1.821, Acc: 0.826, Base Lr: 1.66e-03
2022-05-08 15:50:59,464 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 1.760, Acc: 0.827, Base Lr: 1.66e-03
2022-05-08 15:52:06,727 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 1.705, Acc: 0.831, Base Lr: 1.66e-03
2022-05-08 15:52:07,881 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.706[s] Speed: 22.6[samples/s]
2022-05-08 15:52:54,455 reid_baseline.train INFO: normal accuracy 0.5983963344788087 2.590879440307617 
2022-05-08 15:52:55,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 15:52:55,593 reid_baseline.train INFO: Accuracy: 59.8% Mean Entropy: 259.1%
2022-05-08 15:54:10,382 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.298, Acc: 0.866, Base Lr: 2.46e-03
2022-05-08 15:55:24,928 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.281, Acc: 0.871, Base Lr: 2.46e-03
2022-05-08 15:56:29,625 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.260, Acc: 0.872, Base Lr: 2.46e-03
2022-05-08 15:57:30,137 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.248, Acc: 0.873, Base Lr: 2.46e-03
2022-05-08 15:58:28,025 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.232, Acc: 0.875, Base Lr: 2.46e-03
2022-05-08 15:59:24,679 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.226, Acc: 0.875, Base Lr: 2.46e-03
2022-05-08 16:00:21,553 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.220, Acc: 0.874, Base Lr: 2.46e-03
2022-05-08 16:00:22,195 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.636[s] Speed: 25.2[samples/s]
2022-05-08 16:01:07,760 reid_baseline.train INFO: normal accuracy 0.6215349369988545 2.057974100112915 
2022-05-08 16:01:09,026 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 16:01:09,026 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 205.8%
2022-05-08 16:02:13,473 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.140, Acc: 0.893, Base Lr: 3.25e-03
2022-05-08 16:03:16,018 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.119, Acc: 0.901, Base Lr: 3.25e-03
2022-05-08 16:04:13,485 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.113, Acc: 0.903, Base Lr: 3.25e-03
2022-05-08 16:05:11,037 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.107, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 16:06:11,403 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.106, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 16:07:07,409 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.103, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 16:08:00,501 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.101, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 16:08:01,643 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-05-08 16:08:46,380 reid_baseline.train INFO: normal accuracy 0.6373424971363115 1.9023773670196533 
2022-05-08 16:08:47,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 16:08:47,666 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 190.2%
2022-05-08 16:09:57,028 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.055, Acc: 0.916, Base Lr: 4.04e-03
2022-05-08 16:10:54,277 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.041, Acc: 0.922, Base Lr: 4.04e-03
2022-05-08 16:11:52,435 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.044, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 16:12:43,617 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.041, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 16:13:35,270 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.040, Acc: 0.918, Base Lr: 4.04e-03
2022-05-08 16:14:33,689 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.037, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 16:15:30,092 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.035, Acc: 0.921, Base Lr: 4.04e-03
2022-05-08 16:15:31,065 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.575[s] Speed: 27.8[samples/s]
2022-05-08 16:16:16,227 reid_baseline.train INFO: normal accuracy 0.6345933562428407 1.7483303546905518 
2022-05-08 16:16:17,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 16:16:17,370 reid_baseline.train INFO: Accuracy: 63.5% Mean Entropy: 174.8%
2022-05-08 16:17:19,067 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 0.966, Acc: 0.947, Base Lr: 4.83e-03
2022-05-08 16:18:13,084 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 0.987, Acc: 0.937, Base Lr: 4.83e-03
2022-05-08 16:19:07,478 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 0.992, Acc: 0.934, Base Lr: 4.83e-03
2022-05-08 16:20:09,525 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 0.993, Acc: 0.933, Base Lr: 4.83e-03
2022-05-08 16:21:06,608 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 0.991, Acc: 0.934, Base Lr: 4.83e-03
2022-05-08 16:21:59,497 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 0.990, Acc: 0.935, Base Lr: 4.83e-03
2022-05-08 16:22:54,238 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 0.990, Acc: 0.936, Base Lr: 4.83e-03
2022-05-08 16:22:54,871 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.566[s] Speed: 28.3[samples/s]
2022-05-08 16:23:38,204 reid_baseline.train INFO: normal accuracy 0.6510882016036655 1.709070086479187 
2022-05-08 16:23:39,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 16:23:39,439 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 170.9%
2022-05-08 16:24:41,206 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 0.934, Acc: 0.960, Base Lr: 5.62e-03
2022-05-08 16:25:47,085 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 0.940, Acc: 0.954, Base Lr: 5.62e-03
2022-05-08 16:26:54,276 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 0.942, Acc: 0.952, Base Lr: 5.62e-03
2022-05-08 16:28:19,826 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 0.947, Acc: 0.951, Base Lr: 5.62e-03
2022-05-08 16:29:51,617 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 0.946, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 16:31:05,824 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 0.945, Acc: 0.949, Base Lr: 5.62e-03
2022-05-08 16:32:24,513 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 0.949, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 16:32:25,299 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.749[s] Speed: 21.4[samples/s]
2022-05-08 16:33:16,313 reid_baseline.train INFO: normal accuracy 0.6371134020618556 1.7455142736434937 
2022-05-08 16:33:16,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 16:33:16,319 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 174.6%
2022-05-08 16:34:39,360 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.910, Acc: 0.967, Base Lr: 6.42e-03
2022-05-08 16:36:00,095 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.915, Acc: 0.962, Base Lr: 6.42e-03
2022-05-08 16:37:20,205 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.918, Acc: 0.962, Base Lr: 6.42e-03
2022-05-08 16:38:36,679 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.914, Acc: 0.963, Base Lr: 6.42e-03
2022-05-08 16:40:02,690 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.914, Acc: 0.963, Base Lr: 6.42e-03
2022-05-08 16:41:19,501 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.916, Acc: 0.961, Base Lr: 6.42e-03
2022-05-08 16:42:40,843 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.919, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 16:42:42,274 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.806[s] Speed: 19.8[samples/s]
2022-05-08 16:43:35,702 reid_baseline.train INFO: normal accuracy 0.6359679266895761 1.5206929445266724 
2022-05-08 16:43:37,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 16:43:37,012 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 152.1%
2022-05-08 16:44:58,020 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.881, Acc: 0.974, Base Lr: 7.21e-03
2022-05-08 16:46:13,837 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.892, Acc: 0.968, Base Lr: 7.21e-03
2022-05-08 16:47:31,308 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.894, Acc: 0.968, Base Lr: 7.21e-03
2022-05-08 16:48:49,947 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.896, Acc: 0.967, Base Lr: 7.21e-03
2022-05-08 16:50:16,799 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.897, Acc: 0.965, Base Lr: 7.21e-03
2022-05-08 16:51:39,216 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.898, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 16:53:01,646 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.898, Acc: 0.966, Base Lr: 7.21e-03
2022-05-08 16:53:02,853 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.806[s] Speed: 19.9[samples/s]
2022-05-08 16:53:54,690 reid_baseline.train INFO: normal accuracy 0.6302405498281787 1.7165648937225342 
2022-05-08 16:53:54,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 16:53:54,692 reid_baseline.train INFO: Accuracy: 63.0% Mean Entropy: 171.7%
2022-05-08 16:55:23,360 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.857, Acc: 0.974, Base Lr: 4.01e-03
2022-05-08 16:56:52,333 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.855, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 16:58:16,486 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.856, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 16:59:38,114 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.855, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 17:00:51,619 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.856, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 17:02:09,671 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.858, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 17:03:29,853 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.860, Acc: 0.976, Base Lr: 4.01e-03
2022-05-08 17:03:31,425 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.821[s] Speed: 19.5[samples/s]
2022-05-08 17:04:24,528 reid_baseline.train INFO: normal accuracy 0.6371134020618556 1.519167423248291 
2022-05-08 17:04:25,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 17:04:25,806 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 151.9%
2022-05-08 17:05:48,572 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.842, Acc: 0.985, Base Lr: 3.38e-03
2022-05-08 17:07:06,054 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.846, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 17:08:21,537 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.845, Acc: 0.984, Base Lr: 3.38e-03
2022-05-08 17:09:41,807 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.848, Acc: 0.984, Base Lr: 3.38e-03
2022-05-08 17:11:18,698 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.848, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 17:12:36,269 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.846, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 17:14:00,615 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.845, Acc: 0.983, Base Lr: 3.38e-03
2022-05-08 17:14:01,774 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.820[s] Speed: 19.5[samples/s]
2022-05-08 17:14:51,874 reid_baseline.train INFO: normal accuracy 0.6460481099656358 1.615858554840088 
2022-05-08 17:14:51,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 17:14:51,877 reid_baseline.train INFO: Accuracy: 64.6% Mean Entropy: 161.6%
2022-05-08 17:16:17,686 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.832, Acc: 0.989, Base Lr: 2.77e-03
2022-05-08 17:17:31,551 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.829, Acc: 0.990, Base Lr: 2.77e-03
2022-05-08 17:18:47,159 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.833, Acc: 0.988, Base Lr: 2.77e-03
2022-05-08 17:20:08,842 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.833, Acc: 0.987, Base Lr: 2.77e-03
2022-05-08 17:21:31,010 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.833, Acc: 0.988, Base Lr: 2.77e-03
2022-05-08 17:22:57,581 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.833, Acc: 0.987, Base Lr: 2.77e-03
2022-05-08 17:24:19,866 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.833, Acc: 0.987, Base Lr: 2.77e-03
2022-05-08 17:24:20,789 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.810[s] Speed: 19.8[samples/s]
2022-05-08 17:25:07,908 reid_baseline.train INFO: normal accuracy 0.6421534936998855 1.5784416198730469 
2022-05-08 17:25:07,909 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 17:25:07,909 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 157.8%
2022-05-08 17:26:33,770 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.834, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:27:58,993 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.829, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:29:18,017 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.828, Acc: 0.986, Base Lr: 2.20e-03
2022-05-08 17:30:34,261 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.828, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:31:51,876 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.827, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:33:11,216 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.826, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:34:35,689 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.827, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 17:34:37,114 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.811[s] Speed: 19.7[samples/s]
2022-05-08 17:35:29,840 reid_baseline.train INFO: normal accuracy 0.6426116838487973 1.6571069955825806 
2022-05-08 17:35:29,842 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 17:35:29,842 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 165.7%
2022-05-08 17:36:54,096 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.816, Acc: 0.991, Base Lr: 1.66e-03
2022-05-08 17:38:08,859 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.820, Acc: 0.990, Base Lr: 1.66e-03
2022-05-08 17:39:26,204 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.821, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 17:40:47,095 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.821, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 17:42:08,650 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.820, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 17:43:27,488 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.821, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 17:44:42,410 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.821, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 17:44:43,460 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.788[s] Speed: 20.3[samples/s]
2022-05-08 17:45:30,215 reid_baseline.train INFO: normal accuracy 0.6449026345933563 1.5720295906066895 
2022-05-08 17:45:30,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 17:45:30,218 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 157.2%
2022-05-08 17:47:01,016 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.806, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 17:48:29,479 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.806, Acc: 0.993, Base Lr: 1.19e-03
2022-05-08 17:49:43,859 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.808, Acc: 0.993, Base Lr: 1.19e-03
2022-05-08 17:51:00,904 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.810, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 17:52:16,665 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.811, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 17:53:38,468 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.812, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 17:54:59,468 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.813, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 17:55:00,802 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.813[s] Speed: 19.7[samples/s]
2022-05-08 17:55:49,668 reid_baseline.train INFO: normal accuracy 0.6419243986254296 1.6001274585723877 
2022-05-08 17:55:49,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 17:55:49,669 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 160.0%
2022-05-08 17:57:10,867 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.806, Acc: 0.993, Base Lr: 7.78e-04
2022-05-08 17:58:25,545 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.810, Acc: 0.990, Base Lr: 7.78e-04
2022-05-08 17:59:53,407 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.811, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 18:01:17,117 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.810, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 18:02:33,668 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.810, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 18:03:49,658 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.810, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 18:05:04,526 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.810, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 18:05:05,981 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.792[s] Speed: 20.2[samples/s]
2022-05-08 18:05:55,464 reid_baseline.train INFO: normal accuracy 0.6458190148911799 1.6640019416809082 
2022-05-08 18:05:55,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 18:05:55,472 reid_baseline.train INFO: Accuracy: 64.6% Mean Entropy: 166.4%
2022-05-08 18:07:23,593 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.809, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 18:08:41,986 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.809, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 18:09:59,565 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.808, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 18:11:17,763 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.810, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 18:12:40,913 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.809, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 18:14:00,762 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.810, Acc: 0.990, Base Lr: 4.51e-04
2022-05-08 18:15:18,700 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.810, Acc: 0.990, Base Lr: 4.51e-04
2022-05-08 18:15:19,925 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.803[s] Speed: 19.9[samples/s]
2022-05-08 18:16:08,988 reid_baseline.train INFO: normal accuracy 0.6449026345933563 1.642428994178772 
2022-05-08 18:16:08,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 18:16:08,991 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 164.2%
2022-05-08 18:17:30,871 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.803, Acc: 0.993, Base Lr: 2.11e-04
2022-05-08 18:18:45,853 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.806, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 18:20:08,889 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.806, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 18:21:28,894 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.807, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 18:22:47,604 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.808, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 18:24:10,325 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.809, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 18:25:33,198 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.809, Acc: 0.990, Base Lr: 2.11e-04
2022-05-08 18:25:34,366 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.805[s] Speed: 19.9[samples/s]
2022-05-08 18:26:23,582 reid_baseline.train INFO: normal accuracy 0.6428407789232532 1.5882188081741333 
2022-05-08 18:26:23,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 18:26:23,584 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 158.8%
2022-05-08 18:27:51,751 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.819, Acc: 0.989, Base Lr: 6.51e-05
2022-05-08 18:29:08,863 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.815, Acc: 0.989, Base Lr: 6.51e-05
2022-05-08 18:30:25,162 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.810, Acc: 0.990, Base Lr: 6.51e-05
2022-05-08 18:31:41,778 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.809, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 18:33:03,448 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 18:34:24,911 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.807, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 18:35:44,026 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.808, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 18:35:45,155 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.800[s] Speed: 20.0[samples/s]
2022-05-08 18:36:38,516 reid_baseline.train INFO: normal accuracy 0.6430698739977091 1.6582903861999512 
2022-05-08 18:36:38,519 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 18:36:38,519 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 165.8%
2022-05-08 18:37:57,050 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.801, Acc: 0.995, Base Lr: 1.60e-05
2022-05-08 18:39:14,635 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 18:40:35,870 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.806, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 18:41:58,796 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.804, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 18:43:21,455 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.805, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 18:44:28,046 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.805, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 18:45:42,392 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.806, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 18:45:43,571 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.776[s] Speed: 20.6[samples/s]
2022-05-08 18:46:32,733 reid_baseline.train INFO: normal accuracy 0.6465063001145476 1.6916594505310059 
2022-05-08 18:46:32,735 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 18:46:32,737 reid_baseline.train INFO: Accuracy: 64.7% Mean Entropy: 169.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/APR_DRI_patch_6/transformer_best_model.pth
2022-05-08 18:47:23,400 reid_baseline.train INFO: normal accuracy 0.6371134020618556 1.519167423248291 
2022-05-08 18:47:23,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 18:47:23,401 reid_baseline.train INFO: Accuracy: 63.7%
2022-05-08 18:48:15,440 reid_baseline.train INFO: normal accuracy 0.6371134020618556 1.519167423248291 
2022-05-08 18:48:15,441 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 18:48:15,442 reid_baseline.train INFO: Shuffled Accuracy: 63.7%
2022-05-08 18:52:27,508 reid_baseline.train INFO: normal accuracy 0.9900204936291545 0.6120641231536865 
2022-05-08 18:52:27,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 18:52:27,510 reid_baseline.train INFO: Source Clean Accuracy: 99.0%
2022-05-08 18:52:35,544 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/APR_DRI_patch_7
2022-05-08 18:52:35,545 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/APR_DRI_patch_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/APR.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=7, dom_cls=False, layer_num=1)
2022-05-08 18:52:35,545 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 18:52:35,545 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 18:52:35,546 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/APR.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/APR_DRI_patch_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train APR and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11223 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 18:52:49,507 reid_baseline.train INFO: start training
2022-05-08 18:54:33,715 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.086, Acc: 0.417, Base Lr: 8.72e-04
2022-05-08 18:56:05,382 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 3.973, Acc: 0.578, Base Lr: 8.72e-04
2022-05-08 18:57:36,464 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.859, Acc: 0.637, Base Lr: 8.72e-04
2022-05-08 18:59:09,161 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.743, Acc: 0.673, Base Lr: 8.72e-04
2022-05-08 19:00:54,785 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.620, Acc: 0.692, Base Lr: 8.72e-04
2022-05-08 19:02:29,204 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.499, Acc: 0.707, Base Lr: 8.72e-04
2022-05-08 19:03:59,939 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.373, Acc: 0.723, Base Lr: 8.72e-04
2022-05-08 19:04:01,375 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.954[s] Speed: 16.8[samples/s]
2022-05-08 19:04:48,688 reid_baseline.train INFO: normal accuracy 0.5473081328751432 3.952653408050537 
2022-05-08 19:04:49,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 19:04:49,875 reid_baseline.train INFO: Accuracy: 54.7% Mean Entropy: 395.3%
2022-05-08 19:06:33,389 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.269, Acc: 0.801, Base Lr: 1.66e-03
2022-05-08 19:08:06,473 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.116, Acc: 0.811, Base Lr: 1.66e-03
2022-05-08 19:09:39,107 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 1.989, Acc: 0.815, Base Lr: 1.66e-03
2022-05-08 19:11:07,978 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 1.907, Acc: 0.817, Base Lr: 1.66e-03
2022-05-08 19:12:54,249 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 1.825, Acc: 0.823, Base Lr: 1.66e-03
2022-05-08 19:14:32,824 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 1.764, Acc: 0.826, Base Lr: 1.66e-03
2022-05-08 19:16:03,676 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 1.706, Acc: 0.830, Base Lr: 1.66e-03
2022-05-08 19:16:04,899 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.962[s] Speed: 16.6[samples/s]
2022-05-08 19:16:51,702 reid_baseline.train INFO: normal accuracy 0.6027491408934708 2.56946063041687 
2022-05-08 19:16:52,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 19:16:52,969 reid_baseline.train INFO: Accuracy: 60.3% Mean Entropy: 256.9%
2022-05-08 19:18:33,008 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.309, Acc: 0.869, Base Lr: 2.46e-03
2022-05-08 19:20:10,155 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.285, Acc: 0.864, Base Lr: 2.46e-03
2022-05-08 19:21:42,289 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.269, Acc: 0.866, Base Lr: 2.46e-03
2022-05-08 19:23:14,863 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.254, Acc: 0.870, Base Lr: 2.46e-03
2022-05-08 19:24:58,524 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.244, Acc: 0.869, Base Lr: 2.46e-03
2022-05-08 19:26:37,878 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.233, Acc: 0.872, Base Lr: 2.46e-03
2022-05-08 19:28:08,048 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.222, Acc: 0.874, Base Lr: 2.46e-03
2022-05-08 19:28:09,299 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.963[s] Speed: 16.6[samples/s]
2022-05-08 19:28:57,704 reid_baseline.train INFO: normal accuracy 0.620389461626575 2.115187644958496 
2022-05-08 19:28:59,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 19:28:59,017 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 211.5%
2022-05-08 19:30:36,138 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.115, Acc: 0.905, Base Lr: 3.25e-03
2022-05-08 19:32:13,204 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.114, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 19:33:48,189 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.111, Acc: 0.899, Base Lr: 3.25e-03
2022-05-08 19:35:20,510 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.101, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 19:37:01,041 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.100, Acc: 0.901, Base Lr: 3.25e-03
2022-05-08 19:38:37,257 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.097, Acc: 0.902, Base Lr: 3.25e-03
2022-05-08 19:40:10,002 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.098, Acc: 0.900, Base Lr: 3.25e-03
2022-05-08 19:40:11,175 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.957[s] Speed: 16.7[samples/s]
2022-05-08 19:40:59,565 reid_baseline.train INFO: normal accuracy 0.6352806414662084 1.912049412727356 
2022-05-08 19:41:00,843 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 19:41:00,843 reid_baseline.train INFO: Accuracy: 63.5% Mean Entropy: 191.2%
2022-05-08 19:42:34,168 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.044, Acc: 0.915, Base Lr: 4.04e-03
2022-05-08 19:44:07,757 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.043, Acc: 0.915, Base Lr: 4.04e-03
2022-05-08 19:45:46,440 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.038, Acc: 0.919, Base Lr: 4.04e-03
2022-05-08 19:47:18,801 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.036, Acc: 0.920, Base Lr: 4.04e-03
2022-05-08 19:48:55,671 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.035, Acc: 0.921, Base Lr: 4.04e-03
2022-05-08 19:50:32,848 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.037, Acc: 0.920, Base Lr: 4.04e-03
2022-05-08 19:52:05,960 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.035, Acc: 0.920, Base Lr: 4.04e-03
2022-05-08 19:52:07,231 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.949[s] Speed: 16.9[samples/s]
2022-05-08 19:52:59,919 reid_baseline.train INFO: normal accuracy 0.6394043528064146 1.8034672737121582 
2022-05-08 19:53:01,120 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 19:53:01,120 reid_baseline.train INFO: Accuracy: 63.9% Mean Entropy: 180.3%
2022-05-08 19:54:34,897 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 0.987, Acc: 0.939, Base Lr: 4.83e-03
2022-05-08 19:56:05,228 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 0.983, Acc: 0.938, Base Lr: 4.83e-03
2022-05-08 19:57:40,442 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 0.981, Acc: 0.940, Base Lr: 4.83e-03
2022-05-08 19:59:18,548 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 0.985, Acc: 0.938, Base Lr: 4.83e-03
2022-05-08 20:00:56,749 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 0.984, Acc: 0.939, Base Lr: 4.83e-03
2022-05-08 20:02:29,891 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 0.984, Acc: 0.939, Base Lr: 4.83e-03
2022-05-08 20:04:02,959 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 0.986, Acc: 0.938, Base Lr: 4.83e-03
2022-05-08 20:04:04,282 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.945[s] Speed: 16.9[samples/s]
2022-05-08 20:04:57,907 reid_baseline.train INFO: normal accuracy 0.6394043528064146 1.7417411804199219 
2022-05-08 20:04:59,195 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 20:04:59,195 reid_baseline.train INFO: Accuracy: 63.9% Mean Entropy: 174.2%
2022-05-08 20:06:46,326 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 0.941, Acc: 0.955, Base Lr: 5.62e-03
2022-05-08 20:08:26,237 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 0.948, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 20:09:58,541 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 0.943, Acc: 0.951, Base Lr: 5.62e-03
2022-05-08 20:11:24,576 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 0.944, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 20:13:04,216 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 0.944, Acc: 0.950, Base Lr: 5.62e-03
2022-05-08 20:14:35,329 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 0.946, Acc: 0.949, Base Lr: 5.62e-03
2022-05-08 20:16:04,232 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 0.947, Acc: 0.948, Base Lr: 5.62e-03
2022-05-08 20:16:05,384 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.949[s] Speed: 16.9[samples/s]
2022-05-08 20:16:53,980 reid_baseline.train INFO: normal accuracy 0.6423825887743414 1.5435844659805298 
2022-05-08 20:16:55,301 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 20:16:55,301 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 154.4%
2022-05-08 20:18:29,408 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.913, Acc: 0.961, Base Lr: 6.42e-03
2022-05-08 20:20:00,523 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.930, Acc: 0.958, Base Lr: 6.42e-03
2022-05-08 20:21:31,936 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.924, Acc: 0.961, Base Lr: 6.42e-03
2022-05-08 20:23:02,826 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.925, Acc: 0.960, Base Lr: 6.42e-03
2022-05-08 20:24:48,743 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.923, Acc: 0.961, Base Lr: 6.42e-03
2022-05-08 20:26:19,989 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.925, Acc: 0.958, Base Lr: 6.42e-03
2022-05-08 20:27:47,636 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.923, Acc: 0.958, Base Lr: 6.42e-03
2022-05-08 20:27:49,239 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.931[s] Speed: 17.2[samples/s]
2022-05-08 20:28:36,004 reid_baseline.train INFO: normal accuracy 0.6293241695303551 1.6536585092544556 
2022-05-08 20:28:36,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 20:28:36,007 reid_baseline.train INFO: Accuracy: 62.9% Mean Entropy: 165.4%
2022-05-08 20:30:15,600 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.881, Acc: 0.972, Base Lr: 7.21e-03
2022-05-08 20:31:50,634 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.890, Acc: 0.971, Base Lr: 7.21e-03
2022-05-08 20:33:22,024 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.891, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 20:34:51,852 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.894, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 20:36:28,665 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.893, Acc: 0.970, Base Lr: 7.21e-03
2022-05-08 20:38:07,664 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.895, Acc: 0.969, Base Lr: 7.21e-03
2022-05-08 20:39:36,894 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.895, Acc: 0.968, Base Lr: 7.21e-03
2022-05-08 20:39:38,398 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.943[s] Speed: 17.0[samples/s]
2022-05-08 20:40:26,700 reid_baseline.train INFO: normal accuracy 0.6442153493699886 1.5793792009353638 
2022-05-08 20:40:26,700 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 20:40:26,700 reid_baseline.train INFO: Accuracy: 64.4% Mean Entropy: 157.9%
2022-05-08 20:41:55,679 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.853, Acc: 0.982, Base Lr: 4.01e-03
2022-05-08 20:43:30,804 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.860, Acc: 0.979, Base Lr: 4.01e-03
2022-05-08 20:45:04,279 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.862, Acc: 0.979, Base Lr: 4.01e-03
2022-05-08 20:46:34,913 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.860, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 20:48:06,501 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.860, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 20:49:44,109 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.861, Acc: 0.978, Base Lr: 4.01e-03
2022-05-08 20:51:14,112 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.861, Acc: 0.977, Base Lr: 4.01e-03
2022-05-08 20:51:15,157 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.924[s] Speed: 17.3[samples/s]
2022-05-08 20:52:07,056 reid_baseline.train INFO: normal accuracy 0.6442153493699886 1.6762855052947998 
2022-05-08 20:52:07,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 20:52:07,059 reid_baseline.train INFO: Accuracy: 64.4% Mean Entropy: 167.6%
2022-05-08 20:53:40,441 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.847, Acc: 0.981, Base Lr: 3.38e-03
2022-05-08 20:55:14,013 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.847, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 20:56:48,710 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.846, Acc: 0.981, Base Lr: 3.38e-03
2022-05-08 20:58:21,163 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.845, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 20:59:55,962 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.846, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 21:01:33,698 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.845, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 21:03:09,316 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.844, Acc: 0.982, Base Lr: 3.38e-03
2022-05-08 21:03:10,570 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.945[s] Speed: 16.9[samples/s]
2022-05-08 21:04:04,664 reid_baseline.train INFO: normal accuracy 0.6465063001145476 1.6658152341842651 
2022-05-08 21:04:04,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 21:04:04,667 reid_baseline.train INFO: Accuracy: 64.7% Mean Entropy: 166.6%
2022-05-08 21:05:44,696 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.832, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 21:07:18,135 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.837, Acc: 0.984, Base Lr: 2.77e-03
2022-05-08 21:08:52,106 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.837, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 21:10:27,003 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.835, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 21:12:00,349 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.834, Acc: 0.986, Base Lr: 2.77e-03
2022-05-08 21:13:30,886 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.835, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 21:15:01,897 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.835, Acc: 0.985, Base Lr: 2.77e-03
2022-05-08 21:15:03,053 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.938[s] Speed: 17.1[samples/s]
2022-05-08 21:15:49,023 reid_baseline.train INFO: normal accuracy 0.6508591065292096 1.5422042608261108 
2022-05-08 21:15:50,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 21:15:50,282 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 154.2%
2022-05-08 21:17:29,576 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.825, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 21:18:58,312 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.824, Acc: 0.988, Base Lr: 2.20e-03
2022-05-08 21:20:26,489 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.822, Acc: 0.989, Base Lr: 2.20e-03
2022-05-08 21:22:04,052 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.825, Acc: 0.988, Base Lr: 2.20e-03
2022-05-08 21:23:49,966 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.827, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 21:25:18,337 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.827, Acc: 0.988, Base Lr: 2.20e-03
2022-05-08 21:26:44,455 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.828, Acc: 0.987, Base Lr: 2.20e-03
2022-05-08 21:26:45,175 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.933[s] Speed: 17.2[samples/s]
2022-05-08 21:27:32,983 reid_baseline.train INFO: normal accuracy 0.6506300114547537 1.6447741985321045 
2022-05-08 21:27:32,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 21:27:32,986 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 164.5%
2022-05-08 21:29:09,291 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.820, Acc: 0.987, Base Lr: 1.66e-03
2022-05-08 21:30:44,301 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.818, Acc: 0.987, Base Lr: 1.66e-03
2022-05-08 21:32:16,476 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.817, Acc: 0.989, Base Lr: 1.66e-03
2022-05-08 21:33:45,489 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.820, Acc: 0.987, Base Lr: 1.66e-03
2022-05-08 21:35:16,801 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.821, Acc: 0.987, Base Lr: 1.66e-03
2022-05-08 21:36:56,702 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.821, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 21:38:22,048 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.820, Acc: 0.988, Base Lr: 1.66e-03
2022-05-08 21:38:23,613 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.927[s] Speed: 17.3[samples/s]
2022-05-08 21:39:11,978 reid_baseline.train INFO: normal accuracy 0.6446735395189004 1.5947415828704834 
2022-05-08 21:39:11,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 21:39:11,979 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 159.5%
2022-05-08 21:40:46,649 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.812, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 21:42:21,707 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.817, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 21:43:55,782 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.815, Acc: 0.991, Base Lr: 1.19e-03
2022-05-08 21:45:26,601 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.814, Acc: 0.992, Base Lr: 1.19e-03
2022-05-08 21:46:58,752 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.816, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 21:48:32,375 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.814, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 21:50:16,664 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.815, Acc: 0.990, Base Lr: 1.19e-03
2022-05-08 21:50:17,979 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.949[s] Speed: 16.9[samples/s]
2022-05-08 21:51:05,387 reid_baseline.train INFO: normal accuracy 0.6490263459335625 1.5536460876464844 
2022-05-08 21:51:05,391 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 21:51:05,392 reid_baseline.train INFO: Accuracy: 64.9% Mean Entropy: 155.4%
2022-05-08 21:52:40,593 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.805, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 21:54:08,652 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.805, Acc: 0.992, Base Lr: 7.78e-04
2022-05-08 21:55:46,372 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.807, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 21:57:22,056 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.810, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 21:58:50,904 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.810, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 22:00:23,973 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.810, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 22:01:54,467 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.810, Acc: 0.991, Base Lr: 7.78e-04
2022-05-08 22:01:55,948 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.927[s] Speed: 17.3[samples/s]
2022-05-08 22:02:49,974 reid_baseline.train INFO: normal accuracy 0.6451317296678122 1.6323643922805786 
2022-05-08 22:02:49,976 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 22:02:49,977 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 163.2%
2022-05-08 22:04:32,064 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.815, Acc: 0.987, Base Lr: 4.51e-04
2022-05-08 22:05:59,939 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.812, Acc: 0.989, Base Lr: 4.51e-04
2022-05-08 22:07:33,856 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.808, Acc: 0.990, Base Lr: 4.51e-04
2022-05-08 22:09:06,303 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.807, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 22:10:44,133 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.807, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 22:12:15,211 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.807, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 22:13:45,769 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.808, Acc: 0.991, Base Lr: 4.51e-04
2022-05-08 22:13:47,457 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.937[s] Speed: 17.1[samples/s]
2022-05-08 22:14:35,539 reid_baseline.train INFO: normal accuracy 0.6476517754868271 1.578688144683838 
2022-05-08 22:14:35,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 22:14:35,541 reid_baseline.train INFO: Accuracy: 64.8% Mean Entropy: 157.9%
2022-05-08 22:16:21,730 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.804, Acc: 0.993, Base Lr: 2.11e-04
2022-05-08 22:18:03,597 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.807, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 22:19:36,451 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.808, Acc: 0.993, Base Lr: 2.11e-04
2022-05-08 22:21:11,762 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.807, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 22:22:47,665 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.808, Acc: 0.992, Base Lr: 2.11e-04
2022-05-08 22:24:26,441 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.806, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 22:25:59,295 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.807, Acc: 0.991, Base Lr: 2.11e-04
2022-05-08 22:26:00,614 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.976[s] Speed: 16.4[samples/s]
2022-05-08 22:26:50,441 reid_baseline.train INFO: normal accuracy 0.6492554410080184 1.5959559679031372 
2022-05-08 22:26:50,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 22:26:50,444 reid_baseline.train INFO: Accuracy: 64.9% Mean Entropy: 159.6%
2022-05-08 22:28:30,226 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.810, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 22:30:12,224 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.807, Acc: 0.991, Base Lr: 6.51e-05
2022-05-08 22:31:53,440 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 22:33:26,420 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.805, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 22:34:59,708 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 22:36:34,120 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 22:38:09,022 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.806, Acc: 0.992, Base Lr: 6.51e-05
2022-05-08 22:38:10,392 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.968[s] Speed: 16.5[samples/s]
2022-05-08 22:38:59,885 reid_baseline.train INFO: normal accuracy 0.6467353951890035 1.6247528791427612 
2022-05-08 22:38:59,887 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 22:38:59,888 reid_baseline.train INFO: Accuracy: 64.7% Mean Entropy: 162.5%
2022-05-08 22:40:40,018 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.806, Acc: 0.993, Base Lr: 1.60e-05
2022-05-08 22:42:20,871 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 22:43:55,646 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.808, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 22:45:10,001 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 22:46:14,842 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.807, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 22:47:23,367 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.806, Acc: 0.992, Base Lr: 1.60e-05
2022-05-08 22:48:30,988 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.807, Acc: 0.991, Base Lr: 1.60e-05
2022-05-08 22:48:31,575 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.814[s] Speed: 19.7[samples/s]
2022-05-08 22:49:16,089 reid_baseline.train INFO: normal accuracy 0.6492554410080184 1.6346313953399658 
2022-05-08 22:49:16,090 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 22:49:16,090 reid_baseline.train INFO: Accuracy: 64.9% Mean Entropy: 163.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/APR_DRI_patch_7/transformer_best_model.pth
2022-05-08 22:50:04,522 reid_baseline.train INFO: normal accuracy 0.6508591065292096 1.5422042608261108 
2022-05-08 22:50:04,523 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 22:50:04,523 reid_baseline.train INFO: Accuracy: 65.1%
2022-05-08 22:50:51,821 reid_baseline.train INFO: normal accuracy 0.6508591065292096 1.5422042608261108 
2022-05-08 22:50:51,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 22:50:51,822 reid_baseline.train INFO: Shuffled Accuracy: 65.1%
2022-05-08 22:54:42,030 reid_baseline.train INFO: normal accuracy 0.991535240131872 0.5841729640960693 
2022-05-08 22:54:42,030 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 22:54:42,031 reid_baseline.train INFO: Source Clean Accuracy: 99.2%
