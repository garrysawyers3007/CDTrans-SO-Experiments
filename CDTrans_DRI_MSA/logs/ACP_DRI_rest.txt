2022-05-08 11:08:17,004 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/ACP_DRI_patch_4
2022-05-08 11:08:17,005 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/ACP_DRI_patch_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/ACP.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False, layer_num=1)
2022-05-08 11:08:17,005 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 11:08:17,005 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 11:08:17,006 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/ACP.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train ACP and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11231 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 11:08:29,490 reid_baseline.train INFO: start training
2022-05-08 11:09:21,936 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.094, Acc: 0.382, Base Lr: 8.72e-04
2022-05-08 11:10:07,202 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 4.003, Acc: 0.501, Base Lr: 8.72e-04
2022-05-08 11:10:51,764 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.911, Acc: 0.544, Base Lr: 8.72e-04
2022-05-08 11:11:36,653 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.820, Acc: 0.573, Base Lr: 8.72e-04
2022-05-08 11:12:21,966 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.725, Acc: 0.594, Base Lr: 8.72e-04
2022-05-08 11:13:06,182 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.631, Acc: 0.609, Base Lr: 8.72e-04
2022-05-08 11:13:46,139 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.530, Acc: 0.623, Base Lr: 8.72e-04
2022-05-08 11:13:48,047 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.451[s] Speed: 35.5[samples/s]
2022-05-08 11:16:28,943 reid_baseline.train INFO: normal accuracy 0.7766812026623824 3.9928109645843506 
2022-05-08 11:16:30,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 11:16:30,127 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 399.3%
2022-05-08 11:17:16,896 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.634, Acc: 0.714, Base Lr: 1.66e-03
2022-05-08 11:18:01,009 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.490, Acc: 0.714, Base Lr: 1.66e-03
2022-05-08 11:18:44,793 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 2.350, Acc: 0.725, Base Lr: 1.66e-03
2022-05-08 11:19:28,919 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 2.246, Acc: 0.733, Base Lr: 1.66e-03
2022-05-08 11:20:09,381 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 2.160, Acc: 0.739, Base Lr: 1.66e-03
2022-05-08 11:20:48,046 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 2.090, Acc: 0.742, Base Lr: 1.66e-03
2022-05-08 11:21:29,352 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 2.032, Acc: 0.745, Base Lr: 1.66e-03
2022-05-08 11:21:30,300 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.428[s] Speed: 37.4[samples/s]
2022-05-08 11:24:17,086 reid_baseline.train INFO: normal accuracy 0.8317649759008492 2.2125396728515625 
2022-05-08 11:24:18,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 11:24:18,476 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 221.3%
2022-05-08 11:25:05,848 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.548, Acc: 0.804, Base Lr: 2.46e-03
2022-05-08 11:25:48,390 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.535, Acc: 0.799, Base Lr: 2.46e-03
2022-05-08 11:26:25,684 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.496, Acc: 0.806, Base Lr: 2.46e-03
2022-05-08 11:27:13,364 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.482, Acc: 0.806, Base Lr: 2.46e-03
2022-05-08 11:27:58,219 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.468, Acc: 0.809, Base Lr: 2.46e-03
2022-05-08 11:28:38,780 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.455, Acc: 0.810, Base Lr: 2.46e-03
2022-05-08 11:29:22,084 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.436, Acc: 0.815, Base Lr: 2.46e-03
2022-05-08 11:29:23,128 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.434[s] Speed: 36.9[samples/s]
2022-05-08 11:32:22,897 reid_baseline.train INFO: normal accuracy 0.8675694285058526 1.5053246021270752 
2022-05-08 11:32:24,037 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 11:32:24,038 reid_baseline.train INFO: Accuracy: 86.8% Mean Entropy: 150.5%
2022-05-08 11:33:08,309 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.300, Acc: 0.843, Base Lr: 3.25e-03
2022-05-08 11:33:52,719 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.279, Acc: 0.847, Base Lr: 3.25e-03
2022-05-08 11:34:36,774 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.270, Acc: 0.850, Base Lr: 3.25e-03
2022-05-08 11:35:18,995 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.273, Acc: 0.850, Base Lr: 3.25e-03
2022-05-08 11:36:01,230 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.267, Acc: 0.853, Base Lr: 3.25e-03
2022-05-08 11:36:44,818 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.260, Acc: 0.855, Base Lr: 3.25e-03
2022-05-08 11:37:28,541 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.252, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 11:37:29,575 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.435[s] Speed: 36.8[samples/s]
2022-05-08 11:40:17,078 reid_baseline.train INFO: normal accuracy 0.8749139316043149 1.2683258056640625 
2022-05-08 11:40:18,521 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 11:40:18,522 reid_baseline.train INFO: Accuracy: 87.5% Mean Entropy: 126.8%
2022-05-08 11:41:05,835 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.142, Acc: 0.887, Base Lr: 4.04e-03
2022-05-08 11:41:48,395 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.160, Acc: 0.879, Base Lr: 4.04e-03
2022-05-08 11:42:30,270 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.158, Acc: 0.877, Base Lr: 4.04e-03
2022-05-08 11:43:12,075 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.160, Acc: 0.878, Base Lr: 4.04e-03
2022-05-08 11:43:54,761 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.162, Acc: 0.877, Base Lr: 4.04e-03
2022-05-08 11:44:35,205 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.159, Acc: 0.880, Base Lr: 4.04e-03
2022-05-08 11:45:18,785 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.159, Acc: 0.879, Base Lr: 4.04e-03
2022-05-08 11:45:19,841 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.429[s] Speed: 37.3[samples/s]
2022-05-08 11:48:12,101 reid_baseline.train INFO: normal accuracy 0.8811108560936424 1.213236927986145 
2022-05-08 11:48:13,407 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 11:48:13,408 reid_baseline.train INFO: Accuracy: 88.1% Mean Entropy: 121.3%
2022-05-08 11:48:59,021 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 1.072, Acc: 0.914, Base Lr: 4.83e-03
2022-05-08 11:49:39,997 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 1.072, Acc: 0.917, Base Lr: 4.83e-03
2022-05-08 11:50:17,899 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 1.086, Acc: 0.909, Base Lr: 4.83e-03
2022-05-08 11:51:03,046 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 1.085, Acc: 0.909, Base Lr: 4.83e-03
2022-05-08 11:51:47,570 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 1.085, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 11:52:32,530 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 1.092, Acc: 0.904, Base Lr: 4.83e-03
2022-05-08 11:53:16,637 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 1.092, Acc: 0.903, Base Lr: 4.83e-03
2022-05-08 11:53:17,713 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.433[s] Speed: 36.9[samples/s]
2022-05-08 11:56:02,487 reid_baseline.train INFO: normal accuracy 0.8859306862520082 1.1352943181991577 
2022-05-08 11:56:04,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 11:56:04,961 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 113.5%
2022-05-08 11:56:49,477 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 1.044, Acc: 0.929, Base Lr: 5.62e-03
2022-05-08 11:57:32,666 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 1.029, Acc: 0.931, Base Lr: 5.62e-03
2022-05-08 11:58:17,172 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 1.029, Acc: 0.930, Base Lr: 5.62e-03
2022-05-08 11:59:00,591 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 1.029, Acc: 0.929, Base Lr: 5.62e-03
2022-05-08 11:59:45,517 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 1.033, Acc: 0.928, Base Lr: 5.62e-03
2022-05-08 12:00:28,985 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 1.037, Acc: 0.925, Base Lr: 5.62e-03
2022-05-08 12:01:11,549 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 1.037, Acc: 0.925, Base Lr: 5.62e-03
2022-05-08 12:01:12,509 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.438[s] Speed: 36.5[samples/s]
2022-05-08 12:03:54,849 reid_baseline.train INFO: normal accuracy 0.8840945604773927 1.070417881011963 
2022-05-08 12:03:56,116 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 12:03:56,117 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 107.0%
2022-05-08 12:04:43,659 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.989, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 12:05:27,787 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.990, Acc: 0.938, Base Lr: 6.42e-03
2022-05-08 12:06:11,123 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.992, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 12:06:52,625 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.990, Acc: 0.936, Base Lr: 6.42e-03
2022-05-08 12:07:37,404 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.993, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 12:08:16,663 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.991, Acc: 0.936, Base Lr: 6.42e-03
2022-05-08 12:08:58,777 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.996, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 12:08:59,713 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.432[s] Speed: 37.0[samples/s]
2022-05-08 12:11:45,071 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0104808807373047 
2022-05-08 12:11:46,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 12:11:46,459 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 101.0%
2022-05-08 12:12:34,506 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.959, Acc: 0.951, Base Lr: 7.21e-03
2022-05-08 12:13:19,834 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.962, Acc: 0.949, Base Lr: 7.21e-03
2022-05-08 12:13:57,822 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.963, Acc: 0.947, Base Lr: 7.21e-03
2022-05-08 12:14:38,103 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.966, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 12:15:22,123 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.965, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 12:16:04,014 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.964, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 12:16:45,951 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.965, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 12:16:47,061 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.428[s] Speed: 37.4[samples/s]
2022-05-08 12:19:35,201 reid_baseline.train INFO: normal accuracy 0.8804223089281615 0.955550491809845 
2022-05-08 12:19:36,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 12:19:36,492 reid_baseline.train INFO: Accuracy: 88.0% Mean Entropy: 95.6%
2022-05-08 12:20:19,461 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.925, Acc: 0.959, Base Lr: 4.01e-03
2022-05-08 12:21:04,598 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.921, Acc: 0.959, Base Lr: 4.01e-03
2022-05-08 12:21:47,107 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.919, Acc: 0.959, Base Lr: 4.01e-03
2022-05-08 12:22:29,625 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.916, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 12:23:12,431 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.919, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 12:23:56,433 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.916, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 12:24:38,671 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.918, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 12:24:40,013 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.432[s] Speed: 37.0[samples/s]
2022-05-08 12:27:26,392 reid_baseline.train INFO: normal accuracy 0.886619233417489 0.9938375949859619 
2022-05-08 12:27:26,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 12:27:26,393 reid_baseline.train INFO: Accuracy: 88.7% Mean Entropy: 99.4%
2022-05-08 12:28:14,237 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.888, Acc: 0.974, Base Lr: 3.38e-03
2022-05-08 12:28:57,139 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.890, Acc: 0.971, Base Lr: 3.38e-03
2022-05-08 12:29:39,520 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.890, Acc: 0.970, Base Lr: 3.38e-03
2022-05-08 12:30:20,546 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.892, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 12:31:05,389 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.897, Acc: 0.967, Base Lr: 3.38e-03
2022-05-08 12:31:46,329 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.896, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 12:32:26,822 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.898, Acc: 0.967, Base Lr: 3.38e-03
2022-05-08 12:32:27,879 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.429[s] Speed: 37.3[samples/s]
2022-05-08 12:35:11,456 reid_baseline.train INFO: normal accuracy 0.8843240761992196 1.0939491987228394 
2022-05-08 12:35:11,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 12:35:11,458 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 109.4%
2022-05-08 12:35:57,246 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.882, Acc: 0.976, Base Lr: 2.77e-03
2022-05-08 12:36:38,509 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.879, Acc: 0.975, Base Lr: 2.77e-03
2022-05-08 12:37:22,277 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.878, Acc: 0.973, Base Lr: 2.77e-03
2022-05-08 12:38:02,693 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.878, Acc: 0.973, Base Lr: 2.77e-03
2022-05-08 12:38:45,093 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.880, Acc: 0.973, Base Lr: 2.77e-03
2022-05-08 12:39:28,507 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.880, Acc: 0.974, Base Lr: 2.77e-03
2022-05-08 12:40:12,223 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.881, Acc: 0.972, Base Lr: 2.77e-03
2022-05-08 12:40:13,280 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.430[s] Speed: 37.2[samples/s]
2022-05-08 12:43:03,220 reid_baseline.train INFO: normal accuracy 0.8882258434702777 1.0347583293914795 
2022-05-08 12:43:03,221 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 12:43:03,221 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 103.5%
2022-05-08 12:43:44,492 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.866, Acc: 0.977, Base Lr: 2.20e-03
2022-05-08 12:44:24,890 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.863, Acc: 0.977, Base Lr: 2.20e-03
2022-05-08 12:45:08,850 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.867, Acc: 0.977, Base Lr: 2.20e-03
2022-05-08 12:45:53,551 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.867, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 12:46:37,236 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.867, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 12:47:20,459 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.870, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 12:48:02,607 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.873, Acc: 0.974, Base Lr: 2.20e-03
2022-05-08 12:48:03,530 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.428[s] Speed: 37.4[samples/s]
2022-05-08 12:50:42,999 reid_baseline.train INFO: normal accuracy 0.8852421390865274 1.0214899778366089 
2022-05-08 12:50:43,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 12:50:43,000 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 102.1%
2022-05-08 12:51:30,074 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.861, Acc: 0.976, Base Lr: 1.66e-03
2022-05-08 12:52:14,096 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.863, Acc: 0.974, Base Lr: 1.66e-03
2022-05-08 12:52:57,428 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.864, Acc: 0.974, Base Lr: 1.66e-03
2022-05-08 12:53:39,860 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.866, Acc: 0.975, Base Lr: 1.66e-03
2022-05-08 12:54:26,371 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.865, Acc: 0.976, Base Lr: 1.66e-03
2022-05-08 12:55:10,270 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.865, Acc: 0.975, Base Lr: 1.66e-03
2022-05-08 12:55:49,944 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.865, Acc: 0.975, Base Lr: 1.66e-03
2022-05-08 12:55:51,001 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.438[s] Speed: 36.5[samples/s]
2022-05-08 12:58:33,333 reid_baseline.train INFO: normal accuracy 0.8829469818682579 1.058126449584961 
2022-05-08 12:58:33,334 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 12:58:33,334 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 105.8%
2022-05-08 12:59:20,806 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.864, Acc: 0.971, Base Lr: 1.19e-03
2022-05-08 13:00:06,381 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.855, Acc: 0.974, Base Lr: 1.19e-03
2022-05-08 13:00:49,591 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.858, Acc: 0.976, Base Lr: 1.19e-03
2022-05-08 13:01:31,391 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.858, Acc: 0.975, Base Lr: 1.19e-03
2022-05-08 13:02:10,140 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.856, Acc: 0.977, Base Lr: 1.19e-03
2022-05-08 13:02:55,082 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.854, Acc: 0.978, Base Lr: 1.19e-03
2022-05-08 13:03:36,741 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.855, Acc: 0.978, Base Lr: 1.19e-03
2022-05-08 13:03:37,752 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.434[s] Speed: 36.9[samples/s]
2022-05-08 13:06:25,056 reid_baseline.train INFO: normal accuracy 0.8854716548083543 1.085805892944336 
2022-05-08 13:06:25,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 13:06:25,058 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 108.6%
2022-05-08 13:07:12,083 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.845, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 13:07:49,808 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.851, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 13:08:30,710 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.853, Acc: 0.978, Base Lr: 7.78e-04
2022-05-08 13:09:13,519 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.855, Acc: 0.976, Base Lr: 7.78e-04
2022-05-08 13:09:49,395 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.853, Acc: 0.977, Base Lr: 7.78e-04
2022-05-08 13:10:26,612 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.851, Acc: 0.978, Base Lr: 7.78e-04
2022-05-08 13:11:05,878 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.850, Acc: 0.978, Base Lr: 7.78e-04
2022-05-08 13:11:06,622 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-05-08 13:13:50,981 reid_baseline.train INFO: normal accuracy 0.8896029378012393 1.0650168657302856 
2022-05-08 13:13:50,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 13:13:50,983 reid_baseline.train INFO: Accuracy: 89.0% Mean Entropy: 106.5%
2022-05-08 13:14:37,079 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.839, Acc: 0.983, Base Lr: 4.51e-04
2022-05-08 13:15:21,624 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.847, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 13:16:03,020 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.848, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 13:16:43,512 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.849, Acc: 0.980, Base Lr: 4.51e-04
2022-05-08 13:17:26,954 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.849, Acc: 0.980, Base Lr: 4.51e-04
2022-05-08 13:18:09,176 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.850, Acc: 0.979, Base Lr: 4.51e-04
2022-05-08 13:18:52,044 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.849, Acc: 0.979, Base Lr: 4.51e-04
2022-05-08 13:18:53,027 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.430[s] Speed: 37.2[samples/s]
2022-05-08 13:21:37,195 reid_baseline.train INFO: normal accuracy 0.8875372963047968 1.0543938875198364 
2022-05-08 13:21:37,196 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 13:21:37,196 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 105.4%
2022-05-08 13:22:23,504 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.855, Acc: 0.976, Base Lr: 2.11e-04
2022-05-08 13:23:04,380 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.851, Acc: 0.978, Base Lr: 2.11e-04
2022-05-08 13:23:45,857 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.847, Acc: 0.980, Base Lr: 2.11e-04
2022-05-08 13:24:25,882 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.845, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 13:25:07,164 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.843, Acc: 0.983, Base Lr: 2.11e-04
2022-05-08 13:25:47,642 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.843, Acc: 0.983, Base Lr: 2.11e-04
2022-05-08 13:26:27,149 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.844, Acc: 0.983, Base Lr: 2.11e-04
2022-05-08 13:26:28,112 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.414[s] Speed: 38.6[samples/s]
2022-05-08 13:29:14,089 reid_baseline.train INFO: normal accuracy 0.8877668120266238 1.0652086734771729 
2022-05-08 13:29:14,090 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 13:29:14,090 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 106.5%
2022-05-08 13:30:00,442 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.852, Acc: 0.977, Base Lr: 6.51e-05
2022-05-08 13:30:42,898 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.846, Acc: 0.980, Base Lr: 6.51e-05
2022-05-08 13:31:27,126 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.847, Acc: 0.980, Base Lr: 6.51e-05
2022-05-08 13:32:07,771 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.845, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 13:32:49,986 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.847, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 13:33:29,805 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.847, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 13:34:10,697 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.845, Acc: 0.982, Base Lr: 6.51e-05
2022-05-08 13:34:11,750 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.424[s] Speed: 37.7[samples/s]
2022-05-08 13:36:58,856 reid_baseline.train INFO: normal accuracy 0.8863897176956621 1.0944268703460693 
2022-05-08 13:36:58,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 13:36:58,857 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 109.4%
2022-05-08 13:37:44,858 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.841, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 13:38:27,055 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.844, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 13:39:10,462 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.847, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 13:39:51,120 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.846, Acc: 0.980, Base Lr: 1.60e-05
2022-05-08 13:40:31,398 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.846, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 13:41:14,322 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.845, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 13:41:57,464 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.844, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 13:41:58,305 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.426[s] Speed: 37.5[samples/s]
2022-05-08 13:44:41,906 reid_baseline.train INFO: normal accuracy 0.8879963277484507 1.0491224527359009 
2022-05-08 13:44:41,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 13:44:41,908 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 104.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_4/transformer_best_model.pth
2022-05-08 13:47:28,592 reid_baseline.train INFO: normal accuracy 0.8804223089281615 0.955550491809845 
2022-05-08 13:47:28,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:47:28,593 reid_baseline.train INFO: Accuracy: 88.0%
2022-05-08 13:50:11,421 reid_baseline.train INFO: normal accuracy 0.8804223089281615 0.955550491809845 
2022-05-08 13:50:11,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:50:11,421 reid_baseline.train INFO: Shuffled Accuracy: 88.0%
2022-05-08 13:52:20,570 reid_baseline.train INFO: normal accuracy 0.9713293562461045 0.6449666023254395 
2022-05-08 13:52:20,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 13:52:20,571 reid_baseline.train INFO: Source Clean Accuracy: 97.1%
2022-05-08 13:52:29,174 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/ACP_DRI_patch_5
2022-05-08 13:52:29,175 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/ACP_DRI_patch_5', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/ACP.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=5, dom_cls=False, layer_num=1)
2022-05-08 13:52:29,175 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 13:52:29,175 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 13:52:29,175 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/ACP.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_5
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train ACP and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11231 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 13:52:43,424 reid_baseline.train INFO: start training
2022-05-08 13:53:34,043 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.094, Acc: 0.387, Base Lr: 8.72e-04
2022-05-08 13:54:22,721 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 4.003, Acc: 0.502, Base Lr: 8.72e-04
2022-05-08 13:55:12,303 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.911, Acc: 0.548, Base Lr: 8.72e-04
2022-05-08 13:56:02,818 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.820, Acc: 0.577, Base Lr: 8.72e-04
2022-05-08 13:56:54,308 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.724, Acc: 0.598, Base Lr: 8.72e-04
2022-05-08 13:57:45,125 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.631, Acc: 0.611, Base Lr: 8.72e-04
2022-05-08 13:58:34,654 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.530, Acc: 0.624, Base Lr: 8.72e-04
2022-05-08 13:58:37,131 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.501[s] Speed: 31.9[samples/s]
2022-05-08 14:01:23,288 reid_baseline.train INFO: normal accuracy 0.7762221712187285 3.992478847503662 
2022-05-08 14:01:24,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 14:01:24,485 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 399.2%
2022-05-08 14:02:19,573 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.618, Acc: 0.729, Base Lr: 1.66e-03
2022-05-08 14:03:11,528 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.478, Acc: 0.725, Base Lr: 1.66e-03
2022-05-08 14:04:01,309 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 2.356, Acc: 0.723, Base Lr: 1.66e-03
2022-05-08 14:04:55,160 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 2.261, Acc: 0.726, Base Lr: 1.66e-03
2022-05-08 14:05:44,602 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 2.177, Acc: 0.728, Base Lr: 1.66e-03
2022-05-08 14:06:34,053 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 2.100, Acc: 0.735, Base Lr: 1.66e-03
2022-05-08 14:07:15,393 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 2.035, Acc: 0.743, Base Lr: 1.66e-03
2022-05-08 14:07:16,592 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.502[s] Speed: 31.9[samples/s]
2022-05-08 14:10:03,213 reid_baseline.train INFO: normal accuracy 0.8322240073445031 2.2331604957580566 
2022-05-08 14:10:04,493 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 14:10:04,494 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 223.3%
2022-05-08 14:10:59,025 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.573, Acc: 0.793, Base Lr: 2.46e-03
2022-05-08 14:11:49,242 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.546, Acc: 0.797, Base Lr: 2.46e-03
2022-05-08 14:12:39,501 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.516, Acc: 0.802, Base Lr: 2.46e-03
2022-05-08 14:13:27,261 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.493, Acc: 0.807, Base Lr: 2.46e-03
2022-05-08 14:14:15,646 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.468, Acc: 0.809, Base Lr: 2.46e-03
2022-05-08 14:15:02,626 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.452, Acc: 0.813, Base Lr: 2.46e-03
2022-05-08 14:15:49,809 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.438, Acc: 0.815, Base Lr: 2.46e-03
2022-05-08 14:15:51,047 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.493[s] Speed: 32.4[samples/s]
2022-05-08 14:18:51,490 reid_baseline.train INFO: normal accuracy 0.8675694285058526 1.4939855337142944 
2022-05-08 14:18:52,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 14:18:52,653 reid_baseline.train INFO: Accuracy: 86.8% Mean Entropy: 149.4%
2022-05-08 14:19:43,868 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.306, Acc: 0.842, Base Lr: 3.25e-03
2022-05-08 14:20:29,280 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.286, Acc: 0.853, Base Lr: 3.25e-03
2022-05-08 14:21:19,940 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.282, Acc: 0.850, Base Lr: 3.25e-03
2022-05-08 14:22:07,626 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.269, Acc: 0.852, Base Lr: 3.25e-03
2022-05-08 14:22:55,484 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.268, Acc: 0.854, Base Lr: 3.25e-03
2022-05-08 14:23:47,032 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.259, Acc: 0.856, Base Lr: 3.25e-03
2022-05-08 14:24:37,763 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.252, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 14:24:38,983 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.493[s] Speed: 32.4[samples/s]
2022-05-08 14:27:18,074 reid_baseline.train INFO: normal accuracy 0.8733073215515262 1.2649458646774292 
2022-05-08 14:27:19,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 14:27:19,266 reid_baseline.train INFO: Accuracy: 87.3% Mean Entropy: 126.5%
2022-05-08 14:28:12,451 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.156, Acc: 0.886, Base Lr: 4.04e-03
2022-05-08 14:29:02,257 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.154, Acc: 0.885, Base Lr: 4.04e-03
2022-05-08 14:29:50,086 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.163, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 14:30:36,704 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.162, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 14:31:27,484 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.163, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 14:32:18,088 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.154, Acc: 0.883, Base Lr: 4.04e-03
2022-05-08 14:33:07,809 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.156, Acc: 0.882, Base Lr: 4.04e-03
2022-05-08 14:33:08,755 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.498[s] Speed: 32.1[samples/s]
2022-05-08 14:35:53,916 reid_baseline.train INFO: normal accuracy 0.8843240761992196 1.1814992427825928 
2022-05-08 14:35:55,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 14:35:55,227 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 118.1%
2022-05-08 14:36:48,420 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 1.099, Acc: 0.903, Base Lr: 4.83e-03
2022-05-08 14:37:34,803 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 1.093, Acc: 0.902, Base Lr: 4.83e-03
2022-05-08 14:38:20,960 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 1.095, Acc: 0.903, Base Lr: 4.83e-03
2022-05-08 14:39:11,100 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 1.095, Acc: 0.904, Base Lr: 4.83e-03
2022-05-08 14:39:57,595 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 1.094, Acc: 0.904, Base Lr: 4.83e-03
2022-05-08 14:40:44,321 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 1.092, Acc: 0.905, Base Lr: 4.83e-03
2022-05-08 14:41:32,678 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 1.093, Acc: 0.903, Base Lr: 4.83e-03
2022-05-08 14:41:33,830 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.482[s] Speed: 33.2[samples/s]
2022-05-08 14:44:14,776 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0874875783920288 
2022-05-08 14:44:16,004 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 14:44:16,005 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 108.7%
2022-05-08 14:45:10,772 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 1.043, Acc: 0.917, Base Lr: 5.62e-03
2022-05-08 14:45:59,618 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 1.042, Acc: 0.918, Base Lr: 5.62e-03
2022-05-08 14:46:48,310 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 1.045, Acc: 0.917, Base Lr: 5.62e-03
2022-05-08 14:47:34,581 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 1.040, Acc: 0.918, Base Lr: 5.62e-03
2022-05-08 14:48:26,677 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 1.040, Acc: 0.919, Base Lr: 5.62e-03
2022-05-08 14:49:18,285 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 1.038, Acc: 0.920, Base Lr: 5.62e-03
2022-05-08 14:50:08,927 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 1.039, Acc: 0.920, Base Lr: 5.62e-03
2022-05-08 14:50:10,105 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.504[s] Speed: 31.7[samples/s]
2022-05-08 14:52:51,154 reid_baseline.train INFO: normal accuracy 0.8840945604773927 1.1088266372680664 
2022-05-08 14:52:51,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 14:52:51,156 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 110.9%
2022-05-08 14:53:38,173 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.959, Acc: 0.946, Base Lr: 6.42e-03
2022-05-08 14:54:26,935 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 0.982, Acc: 0.943, Base Lr: 6.42e-03
2022-05-08 14:55:18,317 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 0.989, Acc: 0.943, Base Lr: 6.42e-03
2022-05-08 14:56:07,822 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.992, Acc: 0.942, Base Lr: 6.42e-03
2022-05-08 14:57:02,677 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.996, Acc: 0.939, Base Lr: 6.42e-03
2022-05-08 14:57:52,265 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.994, Acc: 0.939, Base Lr: 6.42e-03
2022-05-08 14:58:42,876 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.999, Acc: 0.937, Base Lr: 6.42e-03
2022-05-08 14:58:43,982 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.502[s] Speed: 31.9[samples/s]
2022-05-08 15:01:29,076 reid_baseline.train INFO: normal accuracy 0.8820289189809501 1.0232115983963013 
2022-05-08 15:01:30,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 15:01:30,312 reid_baseline.train INFO: Accuracy: 88.2% Mean Entropy: 102.3%
2022-05-08 15:02:24,631 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.965, Acc: 0.947, Base Lr: 7.21e-03
2022-05-08 15:03:16,058 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.952, Acc: 0.953, Base Lr: 7.21e-03
2022-05-08 15:04:06,524 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.956, Acc: 0.950, Base Lr: 7.21e-03
2022-05-08 15:04:56,565 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.961, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 15:05:49,009 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.964, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 15:06:39,627 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.965, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 15:07:28,479 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.967, Acc: 0.944, Base Lr: 7.21e-03
2022-05-08 15:07:29,884 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.512[s] Speed: 31.2[samples/s]
2022-05-08 15:10:11,887 reid_baseline.train INFO: normal accuracy 0.8797337617626807 1.1311181783676147 
2022-05-08 15:10:11,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 15:10:11,891 reid_baseline.train INFO: Accuracy: 88.0% Mean Entropy: 113.1%
2022-05-08 15:11:08,666 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.914, Acc: 0.965, Base Lr: 4.01e-03
2022-05-08 15:12:01,076 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.915, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 15:12:54,065 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.912, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 15:13:45,996 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.918, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 15:14:36,413 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.920, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 15:15:27,512 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.917, Acc: 0.963, Base Lr: 4.01e-03
2022-05-08 15:16:14,514 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.917, Acc: 0.962, Base Lr: 4.01e-03
2022-05-08 15:16:15,193 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.517[s] Speed: 30.9[samples/s]
2022-05-08 15:19:05,861 reid_baseline.train INFO: normal accuracy 0.8838650447555657 1.0602948665618896 
2022-05-08 15:19:05,861 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 15:19:05,861 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 106.0%
2022-05-08 15:20:02,431 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.885, Acc: 0.975, Base Lr: 3.38e-03
2022-05-08 15:20:54,445 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.891, Acc: 0.971, Base Lr: 3.38e-03
2022-05-08 15:21:51,417 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.893, Acc: 0.970, Base Lr: 3.38e-03
2022-05-08 15:22:51,226 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.894, Acc: 0.970, Base Lr: 3.38e-03
2022-05-08 15:23:50,221 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.896, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 15:24:48,290 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.896, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 15:25:47,678 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.894, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 15:25:49,107 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.574[s] Speed: 27.9[samples/s]
2022-05-08 15:28:39,723 reid_baseline.train INFO: normal accuracy 0.8850126233647004 1.104839563369751 
2022-05-08 15:28:39,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 15:28:39,724 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 110.5%
2022-05-08 15:29:35,152 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.881, Acc: 0.966, Base Lr: 2.77e-03
2022-05-08 15:30:19,363 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.885, Acc: 0.968, Base Lr: 2.77e-03
2022-05-08 15:31:12,250 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.884, Acc: 0.969, Base Lr: 2.77e-03
2022-05-08 15:32:11,111 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.884, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 15:33:10,025 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.882, Acc: 0.972, Base Lr: 2.77e-03
2022-05-08 15:34:07,490 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.880, Acc: 0.972, Base Lr: 2.77e-03
2022-05-08 15:34:55,561 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.879, Acc: 0.973, Base Lr: 2.77e-03
2022-05-08 15:34:56,416 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.536[s] Speed: 29.8[samples/s]
2022-05-08 15:37:36,350 reid_baseline.train INFO: normal accuracy 0.8838650447555657 1.0019687414169312 
2022-05-08 15:37:37,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 15:37:37,509 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 100.2%
2022-05-08 15:38:35,199 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.873, Acc: 0.974, Base Lr: 2.20e-03
2022-05-08 15:39:31,075 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.871, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 15:40:27,990 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.868, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 15:41:25,305 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.870, Acc: 0.974, Base Lr: 2.20e-03
2022-05-08 15:42:20,830 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.869, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 15:43:12,801 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.870, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 15:44:06,241 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.869, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 15:44:07,443 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.555[s] Speed: 28.8[samples/s]
2022-05-08 15:46:47,062 reid_baseline.train INFO: normal accuracy 0.8829469818682579 1.034142017364502 
2022-05-08 15:46:47,064 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 15:46:47,065 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 103.4%
2022-05-08 15:47:45,784 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.849, Acc: 0.981, Base Lr: 1.66e-03
2022-05-08 15:48:44,862 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.847, Acc: 0.982, Base Lr: 1.66e-03
2022-05-08 15:49:42,344 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.66e-03
2022-05-08 15:50:37,865 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.856, Acc: 0.978, Base Lr: 1.66e-03
2022-05-08 15:51:33,951 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.858, Acc: 0.977, Base Lr: 1.66e-03
2022-05-08 15:52:29,252 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.860, Acc: 0.977, Base Lr: 1.66e-03
2022-05-08 15:53:24,057 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.863, Acc: 0.976, Base Lr: 1.66e-03
2022-05-08 15:53:25,219 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.566[s] Speed: 28.2[samples/s]
2022-05-08 15:56:12,526 reid_baseline.train INFO: normal accuracy 0.8829469818682579 1.0603278875350952 
2022-05-08 15:56:12,530 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 15:56:12,531 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 106.0%
2022-05-08 15:57:10,027 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.855, Acc: 0.979, Base Lr: 1.19e-03
2022-05-08 15:57:58,634 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.853, Acc: 0.979, Base Lr: 1.19e-03
2022-05-08 15:58:47,433 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.852, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 15:59:34,228 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.849, Acc: 0.981, Base Lr: 1.19e-03
2022-05-08 16:00:22,267 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.850, Acc: 0.981, Base Lr: 1.19e-03
2022-05-08 16:01:09,123 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.852, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 16:01:58,102 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 16:01:59,285 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.494[s] Speed: 32.4[samples/s]
2022-05-08 16:04:40,030 reid_baseline.train INFO: normal accuracy 0.8861602019738352 1.1192787885665894 
2022-05-08 16:04:40,031 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 16:04:40,032 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 111.9%
2022-05-08 16:05:31,961 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.854, Acc: 0.974, Base Lr: 7.78e-04
2022-05-08 16:06:20,437 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.847, Acc: 0.979, Base Lr: 7.78e-04
2022-05-08 16:07:07,284 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.846, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 16:07:54,102 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.846, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 16:08:39,183 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.847, Acc: 0.982, Base Lr: 7.78e-04
2022-05-08 16:09:26,792 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.846, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 16:10:15,693 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.848, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 16:10:16,799 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.480[s] Speed: 33.4[samples/s]
2022-05-08 16:12:52,948 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.1094321012496948 
2022-05-08 16:12:52,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 16:12:52,949 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 110.9%
2022-05-08 16:13:46,497 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.840, Acc: 0.982, Base Lr: 4.51e-04
2022-05-08 16:14:35,077 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.847, Acc: 0.979, Base Lr: 4.51e-04
2022-05-08 16:15:22,856 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.846, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 16:16:10,078 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.846, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 16:16:57,587 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.844, Acc: 0.982, Base Lr: 4.51e-04
2022-05-08 16:17:46,465 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.846, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 16:18:34,454 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.847, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 16:18:35,518 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.488[s] Speed: 32.8[samples/s]
2022-05-08 16:21:15,806 reid_baseline.train INFO: normal accuracy 0.8847831076428735 1.0926368236541748 
2022-05-08 16:21:15,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 16:21:15,807 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 109.3%
2022-05-08 16:22:06,069 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.847, Acc: 0.977, Base Lr: 2.11e-04
2022-05-08 16:22:52,857 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.845, Acc: 0.978, Base Lr: 2.11e-04
2022-05-08 16:23:39,088 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.847, Acc: 0.977, Base Lr: 2.11e-04
2022-05-08 16:24:27,803 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.844, Acc: 0.979, Base Lr: 2.11e-04
2022-05-08 16:25:26,375 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.844, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 16:26:36,106 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.845, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 16:27:38,989 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.845, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 16:27:40,819 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.548[s] Speed: 29.2[samples/s]
2022-05-08 16:30:31,194 reid_baseline.train INFO: normal accuracy 0.8845535919210465 1.0607837438583374 
2022-05-08 16:30:31,194 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 16:30:31,195 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 106.1%
2022-05-08 16:31:39,479 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.854, Acc: 0.974, Base Lr: 6.51e-05
2022-05-08 16:32:45,500 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.852, Acc: 0.976, Base Lr: 6.51e-05
2022-05-08 16:33:49,787 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.848, Acc: 0.978, Base Lr: 6.51e-05
2022-05-08 16:34:55,484 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.847, Acc: 0.979, Base Lr: 6.51e-05
2022-05-08 16:36:00,009 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.846, Acc: 0.980, Base Lr: 6.51e-05
2022-05-08 16:37:10,556 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.844, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 16:38:16,326 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.845, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 16:38:17,659 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.664[s] Speed: 24.1[samples/s]
2022-05-08 16:41:13,612 reid_baseline.train INFO: normal accuracy 0.8854716548083543 0.9951801300048828 
2022-05-08 16:41:14,859 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 16:41:14,859 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 99.5%
2022-05-08 16:42:24,113 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.835, Acc: 0.986, Base Lr: 1.60e-05
2022-05-08 16:43:29,945 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.835, Acc: 0.985, Base Lr: 1.60e-05
2022-05-08 16:44:31,266 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.841, Acc: 0.983, Base Lr: 1.60e-05
2022-05-08 16:45:38,746 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.844, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 16:46:47,322 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.842, Acc: 0.983, Base Lr: 1.60e-05
2022-05-08 16:47:52,139 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.842, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 16:48:58,500 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.842, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 16:48:59,749 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.662[s] Speed: 24.2[samples/s]
2022-05-08 16:51:50,124 reid_baseline.train INFO: normal accuracy 0.8857011705301813 1.070446491241455 
2022-05-08 16:51:50,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 16:51:50,126 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 107.0%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_5/transformer_best_model.pth
2022-05-08 16:54:42,024 reid_baseline.train INFO: normal accuracy 0.8854716548083543 0.9951801300048828 
2022-05-08 16:54:42,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 16:54:42,024 reid_baseline.train INFO: Accuracy: 88.5%
2022-05-08 16:57:35,677 reid_baseline.train INFO: normal accuracy 0.8854716548083543 0.9951801300048828 
2022-05-08 16:57:35,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 16:57:35,677 reid_baseline.train INFO: Shuffled Accuracy: 88.5%
2022-05-08 16:59:52,869 reid_baseline.train INFO: normal accuracy 0.9857537173893687 0.5828551650047302 
2022-05-08 16:59:52,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 16:59:52,869 reid_baseline.train INFO: Source Clean Accuracy: 98.6%
2022-05-08 17:00:00,794 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/ACP_DRI_patch_6
2022-05-08 17:00:00,794 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/ACP_DRI_patch_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/ACP.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False, layer_num=1)
2022-05-08 17:00:00,795 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 17:00:00,795 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 17:00:00,795 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/ACP.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train ACP and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11231 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 17:00:15,872 reid_baseline.train INFO: start training
2022-05-08 17:01:39,274 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.094, Acc: 0.387, Base Lr: 8.72e-04
2022-05-08 17:02:57,179 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 4.003, Acc: 0.504, Base Lr: 8.72e-04
2022-05-08 17:04:16,301 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.912, Acc: 0.550, Base Lr: 8.72e-04
2022-05-08 17:05:32,612 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.821, Acc: 0.577, Base Lr: 8.72e-04
2022-05-08 17:06:49,118 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.725, Acc: 0.597, Base Lr: 8.72e-04
2022-05-08 17:08:10,213 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.632, Acc: 0.611, Base Lr: 8.72e-04
2022-05-08 17:09:27,526 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.530, Acc: 0.625, Base Lr: 8.72e-04
2022-05-08 17:09:29,535 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.786[s] Speed: 20.4[samples/s]
2022-05-08 17:12:20,051 reid_baseline.train INFO: normal accuracy 0.7759926554969016 3.991579532623291 
2022-05-08 17:12:21,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 17:12:21,346 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 399.2%
2022-05-08 17:13:47,234 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.632, Acc: 0.714, Base Lr: 1.66e-03
2022-05-08 17:15:05,683 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.489, Acc: 0.721, Base Lr: 1.66e-03
2022-05-08 17:16:22,443 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 2.367, Acc: 0.726, Base Lr: 1.66e-03
2022-05-08 17:17:44,349 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 2.253, Acc: 0.731, Base Lr: 1.66e-03
2022-05-08 17:19:01,489 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 2.171, Acc: 0.736, Base Lr: 1.66e-03
2022-05-08 17:20:19,472 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 2.099, Acc: 0.739, Base Lr: 1.66e-03
2022-05-08 17:21:38,360 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 2.034, Acc: 0.745, Base Lr: 1.66e-03
2022-05-08 17:21:39,997 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.796[s] Speed: 20.1[samples/s]
2022-05-08 17:24:31,491 reid_baseline.train INFO: normal accuracy 0.8274041771861372 2.204054355621338 
2022-05-08 17:24:32,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 17:24:32,990 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 220.4%
2022-05-08 17:25:56,001 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.523, Acc: 0.801, Base Lr: 2.46e-03
2022-05-08 17:27:18,615 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.506, Acc: 0.807, Base Lr: 2.46e-03
2022-05-08 17:28:44,343 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.496, Acc: 0.807, Base Lr: 2.46e-03
2022-05-08 17:30:02,951 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.473, Acc: 0.813, Base Lr: 2.46e-03
2022-05-08 17:31:18,493 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.461, Acc: 0.814, Base Lr: 2.46e-03
2022-05-08 17:32:37,475 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.447, Acc: 0.815, Base Lr: 2.46e-03
2022-05-08 17:33:59,422 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.434, Acc: 0.817, Base Lr: 2.46e-03
2022-05-08 17:34:01,096 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.809[s] Speed: 19.8[samples/s]
2022-05-08 17:36:59,728 reid_baseline.train INFO: normal accuracy 0.8666513656185448 1.5249600410461426 
2022-05-08 17:37:01,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 17:37:01,121 reid_baseline.train INFO: Accuracy: 86.7% Mean Entropy: 152.5%
2022-05-08 17:38:24,493 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.280, Acc: 0.847, Base Lr: 3.25e-03
2022-05-08 17:39:41,950 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.272, Acc: 0.847, Base Lr: 3.25e-03
2022-05-08 17:40:59,329 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.276, Acc: 0.851, Base Lr: 3.25e-03
2022-05-08 17:42:18,901 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.272, Acc: 0.852, Base Lr: 3.25e-03
2022-05-08 17:43:35,248 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.262, Acc: 0.854, Base Lr: 3.25e-03
2022-05-08 17:44:52,312 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.253, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 17:46:08,907 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.254, Acc: 0.856, Base Lr: 3.25e-03
2022-05-08 17:46:10,624 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.783[s] Speed: 20.4[samples/s]
2022-05-08 17:49:04,413 reid_baseline.train INFO: normal accuracy 0.8733073215515262 1.3135894536972046 
2022-05-08 17:49:05,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 17:49:05,575 reid_baseline.train INFO: Accuracy: 87.3% Mean Entropy: 131.4%
2022-05-08 17:50:27,059 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.172, Acc: 0.891, Base Lr: 4.04e-03
2022-05-08 17:51:46,055 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.154, Acc: 0.889, Base Lr: 4.04e-03
2022-05-08 17:53:06,479 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.157, Acc: 0.885, Base Lr: 4.04e-03
2022-05-08 17:54:23,997 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.166, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 17:55:40,743 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.167, Acc: 0.880, Base Lr: 4.04e-03
2022-05-08 17:56:57,109 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.163, Acc: 0.880, Base Lr: 4.04e-03
2022-05-08 17:58:21,157 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.159, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 17:58:22,640 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.793[s] Speed: 20.2[samples/s]
2022-05-08 18:01:27,792 reid_baseline.train INFO: normal accuracy 0.8797337617626807 1.1644724607467651 
2022-05-08 18:01:29,144 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 18:01:29,145 reid_baseline.train INFO: Accuracy: 88.0% Mean Entropy: 116.4%
2022-05-08 18:02:49,930 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 1.105, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 18:04:13,528 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 1.100, Acc: 0.906, Base Lr: 4.83e-03
2022-05-08 18:05:28,924 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 1.091, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 18:06:45,448 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 1.092, Acc: 0.906, Base Lr: 4.83e-03
2022-05-08 18:08:08,125 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 1.089, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 18:09:27,387 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 1.090, Acc: 0.906, Base Lr: 4.83e-03
2022-05-08 18:10:48,288 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 1.092, Acc: 0.905, Base Lr: 4.83e-03
2022-05-08 18:10:50,449 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.799[s] Speed: 20.0[samples/s]
2022-05-08 18:13:44,484 reid_baseline.train INFO: normal accuracy 0.8790452145971999 1.1014169454574585 
2022-05-08 18:13:45,862 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 18:13:45,863 reid_baseline.train INFO: Accuracy: 87.9% Mean Entropy: 110.1%
2022-05-08 18:15:06,584 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 1.011, Acc: 0.937, Base Lr: 5.62e-03
2022-05-08 18:16:24,388 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 1.018, Acc: 0.934, Base Lr: 5.62e-03
2022-05-08 18:17:45,815 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 1.021, Acc: 0.930, Base Lr: 5.62e-03
2022-05-08 18:19:04,296 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 1.026, Acc: 0.929, Base Lr: 5.62e-03
2022-05-08 18:20:20,939 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 1.033, Acc: 0.926, Base Lr: 5.62e-03
2022-05-08 18:21:38,490 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 1.036, Acc: 0.925, Base Lr: 5.62e-03
2022-05-08 18:22:57,744 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 1.035, Acc: 0.924, Base Lr: 5.62e-03
2022-05-08 18:22:59,676 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.789[s] Speed: 20.3[samples/s]
2022-05-08 18:25:51,793 reid_baseline.train INFO: normal accuracy 0.8861602019738352 1.080245852470398 
2022-05-08 18:25:53,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 18:25:53,101 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 108.0%
2022-05-08 18:27:11,456 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 0.992, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 18:28:34,268 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 1.004, Acc: 0.932, Base Lr: 6.42e-03
2022-05-08 18:29:53,736 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 1.000, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 18:31:09,414 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.999, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 18:32:26,962 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.995, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 18:33:43,260 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.996, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 18:35:00,727 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.998, Acc: 0.933, Base Lr: 6.42e-03
2022-05-08 18:35:02,547 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.783[s] Speed: 20.4[samples/s]
2022-05-08 18:37:56,468 reid_baseline.train INFO: normal accuracy 0.8808813403718154 1.0467166900634766 
2022-05-08 18:37:57,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 18:37:57,817 reid_baseline.train INFO: Accuracy: 88.1% Mean Entropy: 104.7%
2022-05-08 18:39:26,081 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.962, Acc: 0.940, Base Lr: 7.21e-03
2022-05-08 18:40:49,730 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.960, Acc: 0.944, Base Lr: 7.21e-03
2022-05-08 18:42:16,337 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.963, Acc: 0.942, Base Lr: 7.21e-03
2022-05-08 18:43:37,993 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.961, Acc: 0.944, Base Lr: 7.21e-03
2022-05-08 18:44:42,910 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.961, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 18:46:00,538 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.961, Acc: 0.945, Base Lr: 7.21e-03
2022-05-08 18:47:17,068 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.961, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 18:47:18,533 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.798[s] Speed: 20.0[samples/s]
2022-05-08 18:50:12,825 reid_baseline.train INFO: normal accuracy 0.8788156988753729 1.0728164911270142 
2022-05-08 18:50:12,827 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 18:50:12,827 reid_baseline.train INFO: Accuracy: 87.9% Mean Entropy: 107.3%
2022-05-08 18:51:35,320 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.921, Acc: 0.959, Base Lr: 4.01e-03
2022-05-08 18:52:47,084 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.917, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 18:54:07,236 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.920, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 18:55:23,857 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.919, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 18:56:42,992 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.918, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 18:57:59,629 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.918, Acc: 0.962, Base Lr: 4.01e-03
2022-05-08 18:59:15,750 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.920, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 18:59:17,362 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.775[s] Speed: 20.6[samples/s]
2022-05-08 19:02:07,821 reid_baseline.train INFO: normal accuracy 0.8863897176956621 1.0560431480407715 
2022-05-08 19:02:07,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 19:02:07,822 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 105.6%
2022-05-08 19:03:27,918 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.902, Acc: 0.962, Base Lr: 3.38e-03
2022-05-08 19:04:43,591 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.896, Acc: 0.967, Base Lr: 3.38e-03
2022-05-08 19:06:01,931 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.896, Acc: 0.967, Base Lr: 3.38e-03
2022-05-08 19:07:16,872 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.893, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 19:08:39,144 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.892, Acc: 0.971, Base Lr: 3.38e-03
2022-05-08 19:09:55,726 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.892, Acc: 0.970, Base Lr: 3.38e-03
2022-05-08 19:11:11,291 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.893, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 19:11:12,915 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.776[s] Speed: 20.6[samples/s]
2022-05-08 19:14:10,960 reid_baseline.train INFO: normal accuracy 0.8843240761992196 1.076627254486084 
2022-05-08 19:14:10,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 19:14:10,961 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 107.7%
2022-05-08 19:15:31,815 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.872, Acc: 0.978, Base Lr: 2.77e-03
2022-05-08 19:16:48,049 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.883, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 19:18:05,319 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.882, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 19:19:26,858 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.880, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 19:20:46,452 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.883, Acc: 0.970, Base Lr: 2.77e-03
2022-05-08 19:22:04,304 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.883, Acc: 0.969, Base Lr: 2.77e-03
2022-05-08 19:23:20,540 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.883, Acc: 0.969, Base Lr: 2.77e-03
2022-05-08 19:23:22,223 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.785[s] Speed: 20.4[samples/s]
2022-05-08 19:26:12,341 reid_baseline.train INFO: normal accuracy 0.8815698875372963 1.037339210510254 
2022-05-08 19:26:13,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 19:26:13,509 reid_baseline.train INFO: Accuracy: 88.2% Mean Entropy: 103.7%
2022-05-08 19:27:33,207 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.866, Acc: 0.977, Base Lr: 2.20e-03
2022-05-08 19:28:48,546 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.868, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 19:30:02,559 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.871, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 19:31:22,898 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.868, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 19:32:41,796 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.871, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 19:33:58,629 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.871, Acc: 0.974, Base Lr: 2.20e-03
2022-05-08 19:35:14,961 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.870, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 19:35:16,906 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.774[s] Speed: 20.7[samples/s]
2022-05-08 19:38:13,811 reid_baseline.train INFO: normal accuracy 0.8831764975900849 1.0372538566589355 
2022-05-08 19:38:15,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 19:38:15,048 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 103.7%
2022-05-08 19:39:35,597 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.66e-03
2022-05-08 19:40:53,996 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.859, Acc: 0.980, Base Lr: 1.66e-03
2022-05-08 19:42:10,796 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.860, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 19:43:32,231 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.860, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 19:44:51,916 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.861, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 19:46:07,412 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.861, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 19:47:23,264 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.863, Acc: 0.978, Base Lr: 1.66e-03
2022-05-08 19:47:25,271 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.783[s] Speed: 20.4[samples/s]
2022-05-08 19:50:14,023 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.023751139640808 
2022-05-08 19:50:15,274 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 19:50:15,274 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 102.4%
2022-05-08 19:51:37,034 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.849, Acc: 0.981, Base Lr: 1.19e-03
2022-05-08 19:52:53,263 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.854, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 19:54:08,712 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.858, Acc: 0.977, Base Lr: 1.19e-03
2022-05-08 19:55:29,899 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.854, Acc: 0.979, Base Lr: 1.19e-03
2022-05-08 19:56:47,587 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.856, Acc: 0.979, Base Lr: 1.19e-03
2022-05-08 19:58:03,831 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.857, Acc: 0.978, Base Lr: 1.19e-03
2022-05-08 19:59:21,140 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.856, Acc: 0.978, Base Lr: 1.19e-03
2022-05-08 19:59:22,773 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.780[s] Speed: 20.5[samples/s]
2022-05-08 20:02:15,473 reid_baseline.train INFO: normal accuracy 0.882717466146431 1.02863609790802 
2022-05-08 20:02:15,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 20:02:15,475 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 102.9%
2022-05-08 20:03:34,223 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.859, Acc: 0.976, Base Lr: 7.78e-04
2022-05-08 20:04:50,552 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.850, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 20:06:02,988 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.849, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 20:07:30,095 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.850, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 20:08:52,823 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.850, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 20:10:09,878 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.851, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 20:11:19,938 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.850, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 20:11:22,030 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.778[s] Speed: 20.6[samples/s]
2022-05-08 20:14:12,199 reid_baseline.train INFO: normal accuracy 0.8834060133119118 1.0322059392929077 
2022-05-08 20:14:12,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 20:14:12,202 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 103.2%
2022-05-08 20:15:33,850 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.857, Acc: 0.977, Base Lr: 4.51e-04
2022-05-08 20:16:48,167 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.851, Acc: 0.980, Base Lr: 4.51e-04
2022-05-08 20:18:06,601 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.847, Acc: 0.982, Base Lr: 4.51e-04
2022-05-08 20:19:25,129 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.849, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 20:20:41,236 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.846, Acc: 0.982, Base Lr: 4.51e-04
2022-05-08 20:21:59,548 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.846, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 20:23:13,421 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.847, Acc: 0.981, Base Lr: 4.51e-04
2022-05-08 20:23:15,226 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.773[s] Speed: 20.7[samples/s]
2022-05-08 20:26:05,267 reid_baseline.train INFO: normal accuracy 0.8834060133119118 1.1214135885238647 
2022-05-08 20:26:05,268 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 20:26:05,268 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 112.1%
2022-05-08 20:27:27,200 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.841, Acc: 0.979, Base Lr: 2.11e-04
2022-05-08 20:28:42,145 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.845, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 20:30:00,744 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.843, Acc: 0.983, Base Lr: 2.11e-04
2022-05-08 20:31:19,074 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.841, Acc: 0.984, Base Lr: 2.11e-04
2022-05-08 20:32:36,629 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.841, Acc: 0.984, Base Lr: 2.11e-04
2022-05-08 20:33:54,653 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.841, Acc: 0.984, Base Lr: 2.11e-04
2022-05-08 20:35:07,824 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.842, Acc: 0.983, Base Lr: 2.11e-04
2022-05-08 20:35:09,240 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.775[s] Speed: 20.7[samples/s]
2022-05-08 20:37:56,352 reid_baseline.train INFO: normal accuracy 0.8838650447555657 1.095719337463379 
2022-05-08 20:37:56,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 20:37:56,355 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 109.6%
2022-05-08 20:39:17,412 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.843, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 20:40:35,186 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.842, Acc: 0.982, Base Lr: 6.51e-05
2022-05-08 20:41:53,823 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.841, Acc: 0.983, Base Lr: 6.51e-05
2022-05-08 20:43:12,089 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.841, Acc: 0.982, Base Lr: 6.51e-05
2022-05-08 20:44:29,671 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.842, Acc: 0.982, Base Lr: 6.51e-05
2022-05-08 20:45:47,853 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.843, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 20:47:06,370 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.844, Acc: 0.981, Base Lr: 6.51e-05
2022-05-08 20:47:08,199 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.786[s] Speed: 20.4[samples/s]
2022-05-08 20:49:54,242 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0185151100158691 
2022-05-08 20:49:55,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 20:49:55,495 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 101.9%
2022-05-08 20:51:12,479 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.852, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 20:52:29,486 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.848, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 20:53:51,171 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.847, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 20:55:06,384 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.848, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 20:56:25,219 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.845, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 20:57:41,840 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.845, Acc: 0.982, Base Lr: 1.60e-05
2022-05-08 20:58:59,901 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.845, Acc: 0.981, Base Lr: 1.60e-05
2022-05-08 20:59:01,879 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.778[s] Speed: 20.6[samples/s]
2022-05-08 21:01:49,753 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0816277265548706 
2022-05-08 21:01:49,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 21:01:49,754 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 108.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_6/transformer_best_model.pth
2022-05-08 21:04:42,929 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0185151100158691 
2022-05-08 21:04:42,930 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 21:04:42,931 reid_baseline.train INFO: Accuracy: 88.4%
2022-05-08 21:07:39,478 reid_baseline.train INFO: normal accuracy 0.8836355290337388 1.0185151100158691 
2022-05-08 21:07:39,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 21:07:39,478 reid_baseline.train INFO: Shuffled Accuracy: 88.4%
2022-05-08 21:09:51,781 reid_baseline.train INFO: normal accuracy 0.9858427566556851 0.6100196838378906 
2022-05-08 21:09:51,782 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-08 21:09:51,782 reid_baseline.train INFO: Source Clean Accuracy: 98.6%
2022-05-08 21:10:00,039 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/ACP_DRI_patch_7
2022-05-08 21:10:00,040 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/ACP_DRI_patch_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/ACP.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=7, dom_cls=False, layer_num=1)
2022-05-08 21:10:00,040 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-08 21:10:00,040 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 21:10:00,040 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/ACP.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train ACP and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |    11231 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-08 21:10:15,138 reid_baseline.train INFO: start training
2022-05-08 21:11:54,241 reid_baseline.train INFO: Epoch[1] Iteration[100/702] Loss: 4.093, Acc: 0.389, Base Lr: 8.72e-04
2022-05-08 21:13:24,690 reid_baseline.train INFO: Epoch[1] Iteration[200/702] Loss: 4.002, Acc: 0.504, Base Lr: 8.72e-04
2022-05-08 21:14:54,405 reid_baseline.train INFO: Epoch[1] Iteration[300/702] Loss: 3.911, Acc: 0.549, Base Lr: 8.72e-04
2022-05-08 21:16:23,845 reid_baseline.train INFO: Epoch[1] Iteration[400/702] Loss: 3.819, Acc: 0.578, Base Lr: 8.72e-04
2022-05-08 21:18:03,646 reid_baseline.train INFO: Epoch[1] Iteration[500/702] Loss: 3.723, Acc: 0.598, Base Lr: 8.72e-04
2022-05-08 21:19:33,456 reid_baseline.train INFO: Epoch[1] Iteration[600/702] Loss: 3.630, Acc: 0.613, Base Lr: 8.72e-04
2022-05-08 21:21:03,257 reid_baseline.train INFO: Epoch[1] Iteration[700/702] Loss: 3.529, Acc: 0.625, Base Lr: 8.72e-04
2022-05-08 21:21:05,902 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.923[s] Speed: 17.3[samples/s]
2022-05-08 21:23:57,372 reid_baseline.train INFO: normal accuracy 0.7762221712187285 3.9930508136749268 
2022-05-08 21:23:58,660 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 21:23:58,660 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 399.3%
2022-05-08 21:25:33,156 reid_baseline.train INFO: Epoch[2] Iteration[100/702] Loss: 2.596, Acc: 0.723, Base Lr: 1.66e-03
2022-05-08 21:27:01,967 reid_baseline.train INFO: Epoch[2] Iteration[200/702] Loss: 2.450, Acc: 0.731, Base Lr: 1.66e-03
2022-05-08 21:28:29,284 reid_baseline.train INFO: Epoch[2] Iteration[300/702] Loss: 2.344, Acc: 0.724, Base Lr: 1.66e-03
2022-05-08 21:30:03,215 reid_baseline.train INFO: Epoch[2] Iteration[400/702] Loss: 2.250, Acc: 0.730, Base Lr: 1.66e-03
2022-05-08 21:31:32,159 reid_baseline.train INFO: Epoch[2] Iteration[500/702] Loss: 2.170, Acc: 0.734, Base Lr: 1.66e-03
2022-05-08 21:33:04,340 reid_baseline.train INFO: Epoch[2] Iteration[600/702] Loss: 2.095, Acc: 0.740, Base Lr: 1.66e-03
2022-05-08 21:34:35,265 reid_baseline.train INFO: Epoch[2] Iteration[700/702] Loss: 2.033, Acc: 0.743, Base Lr: 1.66e-03
2022-05-08 21:34:36,711 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.909[s] Speed: 17.6[samples/s]
2022-05-08 21:37:25,818 reid_baseline.train INFO: normal accuracy 0.8310764287353684 2.2384183406829834 
2022-05-08 21:37:27,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 21:37:27,000 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 223.8%
2022-05-08 21:38:59,983 reid_baseline.train INFO: Epoch[3] Iteration[100/702] Loss: 1.573, Acc: 0.796, Base Lr: 2.46e-03
2022-05-08 21:40:28,436 reid_baseline.train INFO: Epoch[3] Iteration[200/702] Loss: 1.534, Acc: 0.806, Base Lr: 2.46e-03
2022-05-08 21:42:00,445 reid_baseline.train INFO: Epoch[3] Iteration[300/702] Loss: 1.513, Acc: 0.802, Base Lr: 2.46e-03
2022-05-08 21:43:33,386 reid_baseline.train INFO: Epoch[3] Iteration[400/702] Loss: 1.492, Acc: 0.805, Base Lr: 2.46e-03
2022-05-08 21:45:03,249 reid_baseline.train INFO: Epoch[3] Iteration[500/702] Loss: 1.468, Acc: 0.808, Base Lr: 2.46e-03
2022-05-08 21:46:33,708 reid_baseline.train INFO: Epoch[3] Iteration[600/702] Loss: 1.450, Acc: 0.812, Base Lr: 2.46e-03
2022-05-08 21:47:59,905 reid_baseline.train INFO: Epoch[3] Iteration[700/702] Loss: 1.437, Acc: 0.815, Base Lr: 2.46e-03
2022-05-08 21:48:02,146 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.905[s] Speed: 17.7[samples/s]
2022-05-08 21:50:49,473 reid_baseline.train INFO: normal accuracy 0.8634381455129676 1.4966081380844116 
2022-05-08 21:50:50,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 21:50:50,916 reid_baseline.train INFO: Accuracy: 86.3% Mean Entropy: 149.7%
2022-05-08 21:52:34,526 reid_baseline.train INFO: Epoch[4] Iteration[100/702] Loss: 1.287, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 21:54:02,767 reid_baseline.train INFO: Epoch[4] Iteration[200/702] Loss: 1.271, Acc: 0.855, Base Lr: 3.25e-03
2022-05-08 21:55:35,814 reid_baseline.train INFO: Epoch[4] Iteration[300/702] Loss: 1.271, Acc: 0.854, Base Lr: 3.25e-03
2022-05-08 21:57:07,656 reid_baseline.train INFO: Epoch[4] Iteration[400/702] Loss: 1.267, Acc: 0.855, Base Lr: 3.25e-03
2022-05-08 21:58:39,897 reid_baseline.train INFO: Epoch[4] Iteration[500/702] Loss: 1.261, Acc: 0.856, Base Lr: 3.25e-03
2022-05-08 22:00:08,856 reid_baseline.train INFO: Epoch[4] Iteration[600/702] Loss: 1.255, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 22:01:39,214 reid_baseline.train INFO: Epoch[4] Iteration[700/702] Loss: 1.251, Acc: 0.857, Base Lr: 3.25e-03
2022-05-08 22:01:41,671 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.927[s] Speed: 17.3[samples/s]
2022-05-08 22:04:34,853 reid_baseline.train INFO: normal accuracy 0.8737663529951801 1.2945687770843506 
2022-05-08 22:04:36,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 22:04:36,049 reid_baseline.train INFO: Accuracy: 87.4% Mean Entropy: 129.5%
2022-05-08 22:06:09,962 reid_baseline.train INFO: Epoch[5] Iteration[100/702] Loss: 1.160, Acc: 0.881, Base Lr: 4.04e-03
2022-05-08 22:07:43,754 reid_baseline.train INFO: Epoch[5] Iteration[200/702] Loss: 1.145, Acc: 0.884, Base Lr: 4.04e-03
2022-05-08 22:09:13,712 reid_baseline.train INFO: Epoch[5] Iteration[300/702] Loss: 1.147, Acc: 0.889, Base Lr: 4.04e-03
2022-05-08 22:10:47,276 reid_baseline.train INFO: Epoch[5] Iteration[400/702] Loss: 1.154, Acc: 0.888, Base Lr: 4.04e-03
2022-05-08 22:12:16,686 reid_baseline.train INFO: Epoch[5] Iteration[500/702] Loss: 1.153, Acc: 0.886, Base Lr: 4.04e-03
2022-05-08 22:13:44,419 reid_baseline.train INFO: Epoch[5] Iteration[600/702] Loss: 1.156, Acc: 0.886, Base Lr: 4.04e-03
2022-05-08 22:15:17,229 reid_baseline.train INFO: Epoch[5] Iteration[700/702] Loss: 1.152, Acc: 0.887, Base Lr: 4.04e-03
2022-05-08 22:15:19,393 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.916[s] Speed: 17.5[samples/s]
2022-05-08 22:18:09,501 reid_baseline.train INFO: normal accuracy 0.8774386045444112 1.1673500537872314 
2022-05-08 22:18:10,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 22:18:10,748 reid_baseline.train INFO: Accuracy: 87.7% Mean Entropy: 116.7%
2022-05-08 22:19:46,305 reid_baseline.train INFO: Epoch[6] Iteration[100/702] Loss: 1.088, Acc: 0.913, Base Lr: 4.83e-03
2022-05-08 22:21:20,073 reid_baseline.train INFO: Epoch[6] Iteration[200/702] Loss: 1.095, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 22:22:53,305 reid_baseline.train INFO: Epoch[6] Iteration[300/702] Loss: 1.086, Acc: 0.911, Base Lr: 4.83e-03
2022-05-08 22:24:29,632 reid_baseline.train INFO: Epoch[6] Iteration[400/702] Loss: 1.088, Acc: 0.908, Base Lr: 4.83e-03
2022-05-08 22:26:02,580 reid_baseline.train INFO: Epoch[6] Iteration[500/702] Loss: 1.085, Acc: 0.909, Base Lr: 4.83e-03
2022-05-08 22:27:36,710 reid_baseline.train INFO: Epoch[6] Iteration[600/702] Loss: 1.086, Acc: 0.907, Base Lr: 4.83e-03
2022-05-08 22:29:09,189 reid_baseline.train INFO: Epoch[6] Iteration[700/702] Loss: 1.091, Acc: 0.904, Base Lr: 4.83e-03
2022-05-08 22:29:10,927 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.940[s] Speed: 17.0[samples/s]
2022-05-08 22:32:00,330 reid_baseline.train INFO: normal accuracy 0.8806518246499885 1.1382485628128052 
2022-05-08 22:32:01,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 22:32:01,637 reid_baseline.train INFO: Accuracy: 88.1% Mean Entropy: 113.8%
2022-05-08 22:33:39,887 reid_baseline.train INFO: Epoch[7] Iteration[100/702] Loss: 1.018, Acc: 0.928, Base Lr: 5.62e-03
2022-05-08 22:35:13,131 reid_baseline.train INFO: Epoch[7] Iteration[200/702] Loss: 1.035, Acc: 0.920, Base Lr: 5.62e-03
2022-05-08 22:36:47,357 reid_baseline.train INFO: Epoch[7] Iteration[300/702] Loss: 1.034, Acc: 0.924, Base Lr: 5.62e-03
2022-05-08 22:38:27,465 reid_baseline.train INFO: Epoch[7] Iteration[400/702] Loss: 1.040, Acc: 0.921, Base Lr: 5.62e-03
2022-05-08 22:40:11,871 reid_baseline.train INFO: Epoch[7] Iteration[500/702] Loss: 1.041, Acc: 0.922, Base Lr: 5.62e-03
2022-05-08 22:41:55,059 reid_baseline.train INFO: Epoch[7] Iteration[600/702] Loss: 1.040, Acc: 0.922, Base Lr: 5.62e-03
2022-05-08 22:43:30,060 reid_baseline.train INFO: Epoch[7] Iteration[700/702] Loss: 1.039, Acc: 0.921, Base Lr: 5.62e-03
2022-05-08 22:43:32,300 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.983[s] Speed: 16.3[samples/s]
2022-05-08 22:46:17,639 reid_baseline.train INFO: normal accuracy 0.8838650447555657 1.112187385559082 
2022-05-08 22:46:18,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 22:46:18,888 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 111.2%
2022-05-08 22:47:24,508 reid_baseline.train INFO: Epoch[8] Iteration[100/702] Loss: 1.003, Acc: 0.929, Base Lr: 6.42e-03
2022-05-08 22:48:25,027 reid_baseline.train INFO: Epoch[8] Iteration[200/702] Loss: 1.004, Acc: 0.932, Base Lr: 6.42e-03
2022-05-08 22:49:15,124 reid_baseline.train INFO: Epoch[8] Iteration[300/702] Loss: 1.006, Acc: 0.933, Base Lr: 6.42e-03
2022-05-08 22:50:08,037 reid_baseline.train INFO: Epoch[8] Iteration[400/702] Loss: 0.998, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 22:51:04,443 reid_baseline.train INFO: Epoch[8] Iteration[500/702] Loss: 0.997, Acc: 0.935, Base Lr: 6.42e-03
2022-05-08 22:52:05,347 reid_baseline.train INFO: Epoch[8] Iteration[600/702] Loss: 0.998, Acc: 0.934, Base Lr: 6.42e-03
2022-05-08 22:53:05,772 reid_baseline.train INFO: Epoch[8] Iteration[700/702] Loss: 0.998, Acc: 0.933, Base Lr: 6.42e-03
2022-05-08 22:53:07,519 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.582[s] Speed: 27.5[samples/s]
2022-05-08 22:55:41,486 reid_baseline.train INFO: normal accuracy 0.8840945604773927 0.9762589931488037 
2022-05-08 22:55:42,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 22:55:42,399 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 97.6%
2022-05-08 22:56:21,408 reid_baseline.train INFO: Epoch[9] Iteration[100/702] Loss: 0.950, Acc: 0.952, Base Lr: 7.21e-03
2022-05-08 22:57:03,874 reid_baseline.train INFO: Epoch[9] Iteration[200/702] Loss: 0.952, Acc: 0.949, Base Lr: 7.21e-03
2022-05-08 22:57:43,316 reid_baseline.train INFO: Epoch[9] Iteration[300/702] Loss: 0.955, Acc: 0.951, Base Lr: 7.21e-03
2022-05-08 22:58:21,485 reid_baseline.train INFO: Epoch[9] Iteration[400/702] Loss: 0.968, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 22:59:00,833 reid_baseline.train INFO: Epoch[9] Iteration[500/702] Loss: 0.969, Acc: 0.946, Base Lr: 7.21e-03
2022-05-08 22:59:38,295 reid_baseline.train INFO: Epoch[9] Iteration[600/702] Loss: 0.965, Acc: 0.947, Base Lr: 7.21e-03
2022-05-08 23:00:14,228 reid_baseline.train INFO: Epoch[9] Iteration[700/702] Loss: 0.965, Acc: 0.947, Base Lr: 7.21e-03
2022-05-08 23:00:15,262 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.389[s] Speed: 41.2[samples/s]
2022-05-08 23:02:42,342 reid_baseline.train INFO: normal accuracy 0.8781271517098921 1.1758408546447754 
2022-05-08 23:02:42,344 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 23:02:42,344 reid_baseline.train INFO: Accuracy: 87.8% Mean Entropy: 117.6%
2022-05-08 23:03:22,844 reid_baseline.train INFO: Epoch[10] Iteration[100/702] Loss: 0.924, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 23:04:04,531 reid_baseline.train INFO: Epoch[10] Iteration[200/702] Loss: 0.920, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 23:04:43,159 reid_baseline.train INFO: Epoch[10] Iteration[300/702] Loss: 0.917, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 23:05:20,978 reid_baseline.train INFO: Epoch[10] Iteration[400/702] Loss: 0.918, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 23:05:58,374 reid_baseline.train INFO: Epoch[10] Iteration[500/702] Loss: 0.918, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 23:06:34,442 reid_baseline.train INFO: Epoch[10] Iteration[600/702] Loss: 0.917, Acc: 0.961, Base Lr: 4.01e-03
2022-05-08 23:07:13,150 reid_baseline.train INFO: Epoch[10] Iteration[700/702] Loss: 0.917, Acc: 0.960, Base Lr: 4.01e-03
2022-05-08 23:07:14,032 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.387[s] Speed: 41.3[samples/s]
2022-05-08 23:09:36,412 reid_baseline.train INFO: normal accuracy 0.8870782648611429 1.0519496202468872 
2022-05-08 23:09:36,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 23:09:36,413 reid_baseline.train INFO: Accuracy: 88.7% Mean Entropy: 105.2%
2022-05-08 23:10:19,773 reid_baseline.train INFO: Epoch[11] Iteration[100/702] Loss: 0.900, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 23:10:57,431 reid_baseline.train INFO: Epoch[11] Iteration[200/702] Loss: 0.897, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 23:11:35,709 reid_baseline.train INFO: Epoch[11] Iteration[300/702] Loss: 0.898, Acc: 0.967, Base Lr: 3.38e-03
2022-05-08 23:12:14,444 reid_baseline.train INFO: Epoch[11] Iteration[400/702] Loss: 0.895, Acc: 0.969, Base Lr: 3.38e-03
2022-05-08 23:12:55,593 reid_baseline.train INFO: Epoch[11] Iteration[500/702] Loss: 0.895, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 23:13:36,544 reid_baseline.train INFO: Epoch[11] Iteration[600/702] Loss: 0.897, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 23:14:12,622 reid_baseline.train INFO: Epoch[11] Iteration[700/702] Loss: 0.896, Acc: 0.968, Base Lr: 3.38e-03
2022-05-08 23:14:13,361 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-05-08 23:16:34,729 reid_baseline.train INFO: normal accuracy 0.8817994032591232 1.0935217142105103 
2022-05-08 23:16:34,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 23:16:34,730 reid_baseline.train INFO: Accuracy: 88.2% Mean Entropy: 109.4%
2022-05-08 23:17:11,909 reid_baseline.train INFO: Epoch[12] Iteration[100/702] Loss: 0.876, Acc: 0.972, Base Lr: 2.77e-03
2022-05-08 23:17:52,473 reid_baseline.train INFO: Epoch[12] Iteration[200/702] Loss: 0.882, Acc: 0.968, Base Lr: 2.77e-03
2022-05-08 23:18:30,999 reid_baseline.train INFO: Epoch[12] Iteration[300/702] Loss: 0.886, Acc: 0.967, Base Lr: 2.77e-03
2022-05-08 23:19:10,807 reid_baseline.train INFO: Epoch[12] Iteration[400/702] Loss: 0.884, Acc: 0.970, Base Lr: 2.77e-03
2022-05-08 23:19:48,605 reid_baseline.train INFO: Epoch[12] Iteration[500/702] Loss: 0.881, Acc: 0.970, Base Lr: 2.77e-03
2022-05-08 23:20:27,433 reid_baseline.train INFO: Epoch[12] Iteration[600/702] Loss: 0.881, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 23:21:03,985 reid_baseline.train INFO: Epoch[12] Iteration[700/702] Loss: 0.881, Acc: 0.971, Base Lr: 2.77e-03
2022-05-08 23:21:04,584 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.384[s] Speed: 41.6[samples/s]
2022-05-08 23:23:24,857 reid_baseline.train INFO: normal accuracy 0.8845535919210465 1.10834801197052 
2022-05-08 23:23:24,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 23:23:24,858 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 110.8%
2022-05-08 23:24:05,451 reid_baseline.train INFO: Epoch[13] Iteration[100/702] Loss: 0.864, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 23:24:45,582 reid_baseline.train INFO: Epoch[13] Iteration[200/702] Loss: 0.863, Acc: 0.979, Base Lr: 2.20e-03
2022-05-08 23:25:20,823 reid_baseline.train INFO: Epoch[13] Iteration[300/702] Loss: 0.865, Acc: 0.978, Base Lr: 2.20e-03
2022-05-08 23:26:00,598 reid_baseline.train INFO: Epoch[13] Iteration[400/702] Loss: 0.868, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 23:26:37,247 reid_baseline.train INFO: Epoch[13] Iteration[500/702] Loss: 0.868, Acc: 0.977, Base Lr: 2.20e-03
2022-05-08 23:27:16,326 reid_baseline.train INFO: Epoch[13] Iteration[600/702] Loss: 0.868, Acc: 0.976, Base Lr: 2.20e-03
2022-05-08 23:27:48,935 reid_baseline.train INFO: Epoch[13] Iteration[700/702] Loss: 0.870, Acc: 0.975, Base Lr: 2.20e-03
2022-05-08 23:27:49,525 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.377[s] Speed: 42.4[samples/s]
2022-05-08 23:30:17,411 reid_baseline.train INFO: normal accuracy 0.8882258434702777 1.0344340801239014 
2022-05-08 23:30:17,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 23:30:17,412 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 103.4%
2022-05-08 23:31:00,048 reid_baseline.train INFO: Epoch[14] Iteration[100/702] Loss: 0.856, Acc: 0.981, Base Lr: 1.66e-03
2022-05-08 23:31:37,477 reid_baseline.train INFO: Epoch[14] Iteration[200/702] Loss: 0.860, Acc: 0.981, Base Lr: 1.66e-03
2022-05-08 23:32:13,245 reid_baseline.train INFO: Epoch[14] Iteration[300/702] Loss: 0.861, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 23:32:51,564 reid_baseline.train INFO: Epoch[14] Iteration[400/702] Loss: 0.864, Acc: 0.978, Base Lr: 1.66e-03
2022-05-08 23:33:28,193 reid_baseline.train INFO: Epoch[14] Iteration[500/702] Loss: 0.861, Acc: 0.978, Base Lr: 1.66e-03
2022-05-08 23:34:07,242 reid_baseline.train INFO: Epoch[14] Iteration[600/702] Loss: 0.859, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 23:34:45,943 reid_baseline.train INFO: Epoch[14] Iteration[700/702] Loss: 0.860, Acc: 0.979, Base Lr: 1.66e-03
2022-05-08 23:34:46,629 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-05-08 23:37:08,285 reid_baseline.train INFO: normal accuracy 0.8875372963047968 1.054643154144287 
2022-05-08 23:37:08,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 23:37:08,286 reid_baseline.train INFO: Accuracy: 88.8% Mean Entropy: 105.5%
2022-05-08 23:37:48,021 reid_baseline.train INFO: Epoch[15] Iteration[100/702] Loss: 0.851, Acc: 0.984, Base Lr: 1.19e-03
2022-05-08 23:38:27,179 reid_baseline.train INFO: Epoch[15] Iteration[200/702] Loss: 0.852, Acc: 0.982, Base Lr: 1.19e-03
2022-05-08 23:39:04,599 reid_baseline.train INFO: Epoch[15] Iteration[300/702] Loss: 0.852, Acc: 0.981, Base Lr: 1.19e-03
2022-05-08 23:39:45,977 reid_baseline.train INFO: Epoch[15] Iteration[400/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 23:40:28,056 reid_baseline.train INFO: Epoch[15] Iteration[500/702] Loss: 0.854, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 23:41:06,104 reid_baseline.train INFO: Epoch[15] Iteration[600/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 23:41:43,140 reid_baseline.train INFO: Epoch[15] Iteration[700/702] Loss: 0.853, Acc: 0.980, Base Lr: 1.19e-03
2022-05-08 23:41:43,700 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-05-08 23:44:06,956 reid_baseline.train INFO: normal accuracy 0.8850126233647004 1.021931767463684 
2022-05-08 23:44:06,956 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 23:44:06,957 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 102.2%
2022-05-08 23:44:47,018 reid_baseline.train INFO: Epoch[16] Iteration[100/702] Loss: 0.841, Acc: 0.982, Base Lr: 7.78e-04
2022-05-08 23:45:26,587 reid_baseline.train INFO: Epoch[16] Iteration[200/702] Loss: 0.844, Acc: 0.982, Base Lr: 7.78e-04
2022-05-08 23:46:06,534 reid_baseline.train INFO: Epoch[16] Iteration[300/702] Loss: 0.849, Acc: 0.980, Base Lr: 7.78e-04
2022-05-08 23:46:48,781 reid_baseline.train INFO: Epoch[16] Iteration[400/702] Loss: 0.850, Acc: 0.979, Base Lr: 7.78e-04
2022-05-08 23:47:32,731 reid_baseline.train INFO: Epoch[16] Iteration[500/702] Loss: 0.847, Acc: 0.981, Base Lr: 7.78e-04
2022-05-08 23:48:16,269 reid_baseline.train INFO: Epoch[16] Iteration[600/702] Loss: 0.849, Acc: 0.979, Base Lr: 7.78e-04
2022-05-08 23:48:57,320 reid_baseline.train INFO: Epoch[16] Iteration[700/702] Loss: 0.849, Acc: 0.979, Base Lr: 7.78e-04
2022-05-08 23:48:57,876 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.414[s] Speed: 38.6[samples/s]
2022-05-08 23:50:54,465 reid_baseline.train INFO: normal accuracy 0.886619233417489 1.08397376537323 
2022-05-08 23:50:54,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 23:50:54,467 reid_baseline.train INFO: Accuracy: 88.7% Mean Entropy: 108.4%
2022-05-08 23:51:17,140 reid_baseline.train INFO: Epoch[17] Iteration[100/702] Loss: 0.853, Acc: 0.979, Base Lr: 4.51e-04
2022-05-08 23:51:38,784 reid_baseline.train INFO: Epoch[17] Iteration[200/702] Loss: 0.850, Acc: 0.978, Base Lr: 4.51e-04
2022-05-08 23:52:00,379 reid_baseline.train INFO: Epoch[17] Iteration[300/702] Loss: 0.850, Acc: 0.978, Base Lr: 4.51e-04
2022-05-08 23:52:22,721 reid_baseline.train INFO: Epoch[17] Iteration[400/702] Loss: 0.849, Acc: 0.978, Base Lr: 4.51e-04
2022-05-08 23:52:45,342 reid_baseline.train INFO: Epoch[17] Iteration[500/702] Loss: 0.848, Acc: 0.979, Base Lr: 4.51e-04
2022-05-08 23:53:05,122 reid_baseline.train INFO: Epoch[17] Iteration[600/702] Loss: 0.846, Acc: 0.980, Base Lr: 4.51e-04
2022-05-08 23:53:26,997 reid_baseline.train INFO: Epoch[17] Iteration[700/702] Loss: 0.845, Acc: 0.980, Base Lr: 4.51e-04
2022-05-08 23:53:27,410 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.218[s] Speed: 73.5[samples/s]
2022-05-08 23:55:15,888 reid_baseline.train INFO: normal accuracy 0.8847831076428735 1.1178327798843384 
2022-05-08 23:55:15,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 23:55:15,889 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 111.8%
2022-05-08 23:55:36,400 reid_baseline.train INFO: Epoch[18] Iteration[100/702] Loss: 0.844, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 23:55:59,149 reid_baseline.train INFO: Epoch[18] Iteration[200/702] Loss: 0.844, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 23:56:22,879 reid_baseline.train INFO: Epoch[18] Iteration[300/702] Loss: 0.843, Acc: 0.982, Base Lr: 2.11e-04
2022-05-08 23:56:44,656 reid_baseline.train INFO: Epoch[18] Iteration[400/702] Loss: 0.844, Acc: 0.980, Base Lr: 2.11e-04
2022-05-08 23:57:07,089 reid_baseline.train INFO: Epoch[18] Iteration[500/702] Loss: 0.846, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 23:57:29,149 reid_baseline.train INFO: Epoch[18] Iteration[600/702] Loss: 0.844, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 23:57:49,591 reid_baseline.train INFO: Epoch[18] Iteration[700/702] Loss: 0.845, Acc: 0.981, Base Lr: 2.11e-04
2022-05-08 23:57:50,347 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.220[s] Speed: 72.8[samples/s]
2022-05-08 23:59:38,600 reid_baseline.train INFO: normal accuracy 0.8840945604773927 1.0662095546722412 
2022-05-08 23:59:38,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 23:59:38,602 reid_baseline.train INFO: Accuracy: 88.4% Mean Entropy: 106.6%
2022-05-08 23:59:59,458 reid_baseline.train INFO: Epoch[19] Iteration[100/702] Loss: 0.847, Acc: 0.981, Base Lr: 6.51e-05
2022-05-09 00:00:22,571 reid_baseline.train INFO: Epoch[19] Iteration[200/702] Loss: 0.837, Acc: 0.984, Base Lr: 6.51e-05
2022-05-09 00:00:44,723 reid_baseline.train INFO: Epoch[19] Iteration[300/702] Loss: 0.841, Acc: 0.983, Base Lr: 6.51e-05
2022-05-09 00:01:07,535 reid_baseline.train INFO: Epoch[19] Iteration[400/702] Loss: 0.843, Acc: 0.981, Base Lr: 6.51e-05
2022-05-09 00:01:30,216 reid_baseline.train INFO: Epoch[19] Iteration[500/702] Loss: 0.843, Acc: 0.982, Base Lr: 6.51e-05
2022-05-09 00:01:51,091 reid_baseline.train INFO: Epoch[19] Iteration[600/702] Loss: 0.842, Acc: 0.982, Base Lr: 6.51e-05
2022-05-09 00:02:10,890 reid_baseline.train INFO: Epoch[19] Iteration[700/702] Loss: 0.845, Acc: 0.980, Base Lr: 6.51e-05
2022-05-09 00:02:11,372 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.218[s] Speed: 73.6[samples/s]
2022-05-09 00:03:59,650 reid_baseline.train INFO: normal accuracy 0.8847831076428735 1.0526572465896606 
2022-05-09 00:03:59,651 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 00:03:59,651 reid_baseline.train INFO: Accuracy: 88.5% Mean Entropy: 105.3%
2022-05-09 00:04:21,737 reid_baseline.train INFO: Epoch[20] Iteration[100/702] Loss: 0.831, Acc: 0.985, Base Lr: 1.60e-05
2022-05-09 00:04:42,087 reid_baseline.train INFO: Epoch[20] Iteration[200/702] Loss: 0.840, Acc: 0.982, Base Lr: 1.60e-05
2022-05-09 00:05:03,940 reid_baseline.train INFO: Epoch[20] Iteration[300/702] Loss: 0.844, Acc: 0.981, Base Lr: 1.60e-05
2022-05-09 00:05:25,523 reid_baseline.train INFO: Epoch[20] Iteration[400/702] Loss: 0.841, Acc: 0.982, Base Lr: 1.60e-05
2022-05-09 00:05:46,499 reid_baseline.train INFO: Epoch[20] Iteration[500/702] Loss: 0.842, Acc: 0.982, Base Lr: 1.60e-05
2022-05-09 00:06:08,478 reid_baseline.train INFO: Epoch[20] Iteration[600/702] Loss: 0.844, Acc: 0.981, Base Lr: 1.60e-05
2022-05-09 00:06:28,660 reid_baseline.train INFO: Epoch[20] Iteration[700/702] Loss: 0.846, Acc: 0.980, Base Lr: 1.60e-05
2022-05-09 00:06:29,324 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.213[s] Speed: 75.1[samples/s]
2022-05-09 00:08:20,320 reid_baseline.train INFO: normal accuracy 0.8857011705301813 1.1410807371139526 
2022-05-09 00:08:20,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 00:08:20,320 reid_baseline.train INFO: Accuracy: 88.6% Mean Entropy: 114.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/ACP_DRI_patch_7/transformer_best_model.pth
2022-05-09 00:10:09,977 reid_baseline.train INFO: normal accuracy 0.8840945604773927 0.9762589931488037 
2022-05-09 00:10:09,978 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-09 00:10:09,978 reid_baseline.train INFO: Accuracy: 88.4%
2022-05-09 00:12:04,508 reid_baseline.train INFO: normal accuracy 0.8840945604773927 0.9762589931488037 
2022-05-09 00:12:04,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-09 00:12:04,509 reid_baseline.train INFO: Shuffled Accuracy: 88.4%
2022-05-09 00:13:40,531 reid_baseline.train INFO: normal accuracy 0.9655418039355356 0.7011494040489197 
2022-05-09 00:13:40,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-09 00:13:40,531 reid_baseline.train INFO: Source Clean Accuracy: 96.6%
