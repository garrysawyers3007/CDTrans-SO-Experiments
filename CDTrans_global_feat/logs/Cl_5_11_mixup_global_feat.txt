2022-04-12 12:17:54,325 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2Art_patch_aug5_feature_mixup_global_feat
2022-04-12 12:17:54,325 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2Art_patch_aug5_feature_mixup_global_feat', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Clipart_2Art_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_classifier/transformer_best_model.pth')
2022-04-12 12:17:54,325 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 12:17:54,326 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 12:17:54,326 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2Art_patch_aug5_feature_mixup_global_feat
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Art_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_classifier/transformer_best_model.pth
2022-04-12 12:17:58,782 reid_baseline.train INFO: start training
2022-04-12 12:19:02,442 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.318, Acc: 0.341, Base Lr: 8.72e-04
2022-04-12 12:20:03,689 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.202, Acc: 0.458, Base Lr: 8.72e-04
2022-04-12 12:20:48,490 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.621[s] Speed: 25.8[samples/s]
2022-04-12 12:21:25,175 reid_baseline.train INFO: normal accuracy 0.4964977338277709 4.163506507873535 
2022-04-12 12:21:28,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 12:21:28,178 reid_baseline.train INFO: Val Accuracy: 49.6% Mean Entropy: 416.4%
2022-04-12 12:21:45,065 reid_baseline.train INFO: normal accuracy 0.5995288574793876 4.154485702514648 
2022-04-12 12:21:45,065 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 12:21:45,065 reid_baseline.train INFO: Train Accuracy: 60.0% Mean Entropy: 415.4%
2022-04-12 12:22:47,902 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.637, Acc: 0.625, Base Lr: 1.66e-03
2022-04-12 12:23:49,192 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.467, Acc: 0.614, Base Lr: 1.66e-03
2022-04-12 12:24:33,728 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-04-12 12:25:10,080 reid_baseline.train INFO: normal accuracy 0.5624227441285538 4.033260822296143 
2022-04-12 12:25:13,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 12:25:13,163 reid_baseline.train INFO: Val Accuracy: 56.2% Mean Entropy: 403.3%
2022-04-12 12:25:29,890 reid_baseline.train INFO: normal accuracy 0.6411955241460542 3.8677749633789062 
2022-04-12 12:25:29,890 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 12:25:29,890 reid_baseline.train INFO: Train Accuracy: 64.1% Mean Entropy: 386.8%
2022-04-12 12:26:32,876 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.706, Acc: 0.667, Base Lr: 2.46e-03
2022-04-12 12:27:34,220 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.554, Acc: 0.684, Base Lr: 2.46e-03
2022-04-12 12:28:18,926 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.619[s] Speed: 25.8[samples/s]
2022-04-12 12:28:55,386 reid_baseline.train INFO: normal accuracy 0.6679027606098064 3.6304593086242676 
2022-04-12 12:28:58,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 12:28:58,476 reid_baseline.train INFO: Val Accuracy: 66.8% Mean Entropy: 363.0%
2022-04-12 12:29:14,281 reid_baseline.train INFO: normal accuracy 0.7363074204946997 3.1501240730285645 
2022-04-12 12:29:14,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 12:29:14,282 reid_baseline.train INFO: Train Accuracy: 73.6% Mean Entropy: 315.0%
2022-04-12 12:30:17,193 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.054, Acc: 0.752, Base Lr: 3.25e-03
2022-04-12 12:31:18,512 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.963, Acc: 0.768, Base Lr: 3.25e-03
2022-04-12 12:32:03,028 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-04-12 12:32:39,241 reid_baseline.train INFO: normal accuracy 0.7062216728471363 3.0867130756378174 
2022-04-12 12:32:42,322 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 12:32:42,323 reid_baseline.train INFO: Val Accuracy: 70.6% Mean Entropy: 308.7%
2022-04-12 12:32:58,151 reid_baseline.train INFO: normal accuracy 0.7907832744405182 2.414766550064087 
2022-04-12 12:32:58,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 12:32:58,151 reid_baseline.train INFO: Train Accuracy: 79.1% Mean Entropy: 241.5%
2022-04-12 12:34:01,044 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.688, Acc: 0.831, Base Lr: 4.04e-03
2022-04-12 12:35:02,173 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.679, Acc: 0.827, Base Lr: 4.04e-03
2022-04-12 12:35:46,777 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-04-12 12:36:23,590 reid_baseline.train INFO: normal accuracy 0.7284713638236506 2.709899663925171 
2022-04-12 12:36:26,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 12:36:26,685 reid_baseline.train INFO: Val Accuracy: 72.8% Mean Entropy: 271.0%
2022-04-12 12:36:43,511 reid_baseline.train INFO: normal accuracy 0.8268551236749117 1.9667446613311768 
2022-04-12 12:36:43,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 12:36:43,511 reid_baseline.train INFO: Train Accuracy: 82.7% Mean Entropy: 196.7%
2022-04-12 12:37:46,187 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.493, Acc: 0.870, Base Lr: 4.83e-03
2022-04-12 12:38:47,400 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.497, Acc: 0.861, Base Lr: 4.83e-03
2022-04-12 12:39:31,773 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 12:40:07,674 reid_baseline.train INFO: normal accuracy 0.7297074577667902 2.517425298690796 
2022-04-12 12:40:10,778 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 12:40:10,778 reid_baseline.train INFO: Val Accuracy: 73.0% Mean Entropy: 251.7%
2022-04-12 12:40:26,617 reid_baseline.train INFO: normal accuracy 0.8442285041224971 1.7311848402023315 
2022-04-12 12:40:26,617 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 12:40:26,617 reid_baseline.train INFO: Train Accuracy: 84.4% Mean Entropy: 173.1%
2022-04-12 12:41:29,747 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.423, Acc: 0.887, Base Lr: 5.62e-03
2022-04-12 12:42:31,137 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.419, Acc: 0.888, Base Lr: 5.62e-03
2022-04-12 12:43:15,874 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 12:43:52,678 reid_baseline.train INFO: normal accuracy 0.7404202719406675 2.396876573562622 
2022-04-12 12:43:55,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 12:43:55,762 reid_baseline.train INFO: Val Accuracy: 74.0% Mean Entropy: 239.7%
2022-04-12 12:44:12,519 reid_baseline.train INFO: normal accuracy 0.8624852767962309 1.5826023817062378 
2022-04-12 12:44:12,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 12:44:12,520 reid_baseline.train INFO: Train Accuracy: 86.2% Mean Entropy: 158.3%
2022-04-12 12:45:15,594 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.308, Acc: 0.914, Base Lr: 6.42e-03
2022-04-12 12:46:16,912 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.328, Acc: 0.915, Base Lr: 6.42e-03
2022-04-12 12:47:01,822 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 12:47:38,478 reid_baseline.train INFO: normal accuracy 0.7395962093119077 2.256808042526245 
2022-04-12 12:47:41,585 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 12:47:41,586 reid_baseline.train INFO: Val Accuracy: 74.0% Mean Entropy: 225.7%
2022-04-12 12:47:58,315 reid_baseline.train INFO: normal accuracy 0.8726442873969376 1.426478624343872 
2022-04-12 12:47:58,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 12:47:58,315 reid_baseline.train INFO: Train Accuracy: 87.3% Mean Entropy: 142.6%
2022-04-12 12:49:01,675 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.315, Acc: 0.927, Base Lr: 7.21e-03
2022-04-12 12:50:03,450 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.295, Acc: 0.928, Base Lr: 7.21e-03
2022-04-12 12:50:47,953 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.621[s] Speed: 25.8[samples/s]
2022-04-12 12:51:24,809 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.181779623031616 
2022-04-12 12:51:27,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 12:51:27,917 reid_baseline.train INFO: Val Accuracy: 74.6% Mean Entropy: 218.2%
2022-04-12 12:51:44,884 reid_baseline.train INFO: normal accuracy 0.8816254416961131 1.326538324356079 
2022-04-12 12:51:44,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 12:51:44,884 reid_baseline.train INFO: Train Accuracy: 88.2% Mean Entropy: 132.7%
2022-04-12 12:52:47,605 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.241, Acc: 0.938, Base Lr: 4.01e-03
2022-04-12 12:53:49,235 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.231, Acc: 0.944, Base Lr: 4.01e-03
2022-04-12 12:54:34,235 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 12:55:14,144 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.126572370529175 
2022-04-12 12:55:17,224 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 12:55:17,225 reid_baseline.train INFO: Val Accuracy: 74.3% Mean Entropy: 212.7%
2022-04-12 12:55:33,254 reid_baseline.train INFO: normal accuracy 0.8848645465253239 1.270456075668335 
2022-04-12 12:55:33,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 12:55:33,255 reid_baseline.train INFO: Train Accuracy: 88.5% Mean Entropy: 127.0%
2022-04-12 12:56:36,520 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.187, Acc: 0.951, Base Lr: 3.38e-03
2022-04-12 12:57:38,057 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.183, Acc: 0.952, Base Lr: 3.38e-03
2022-04-12 12:58:22,795 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.621[s] Speed: 25.8[samples/s]
2022-04-12 12:58:59,438 reid_baseline.train INFO: normal accuracy 0.7449526163988464 2.138432741165161 
2022-04-12 12:58:59,438 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 12:58:59,438 reid_baseline.train INFO: Val Accuracy: 74.5% Mean Entropy: 213.8%
2022-04-12 12:59:15,281 reid_baseline.train INFO: normal accuracy 0.8873674911660777 1.2671767473220825 
2022-04-12 12:59:15,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 12:59:15,281 reid_baseline.train INFO: Train Accuracy: 88.7% Mean Entropy: 126.7%
2022-04-12 13:00:18,008 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.184, Acc: 0.960, Base Lr: 2.77e-03
2022-04-12 13:01:19,360 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.182, Acc: 0.957, Base Lr: 2.77e-03
2022-04-12 13:02:04,106 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-04-12 13:02:40,973 reid_baseline.train INFO: normal accuracy 0.746188710341986 2.0940446853637695 
2022-04-12 13:02:44,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 13:02:44,055 reid_baseline.train INFO: Val Accuracy: 74.6% Mean Entropy: 209.4%
2022-04-12 13:03:00,137 reid_baseline.train INFO: normal accuracy 0.8898704358068316 1.2244422435760498 
2022-04-12 13:03:00,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 13:03:00,137 reid_baseline.train INFO: Train Accuracy: 89.0% Mean Entropy: 122.4%
2022-04-12 13:04:04,184 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.147, Acc: 0.954, Base Lr: 2.20e-03
2022-04-12 13:05:05,784 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.160, Acc: 0.954, Base Lr: 2.20e-03
2022-04-12 13:05:50,320 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.623[s] Speed: 25.7[samples/s]
2022-04-12 13:06:27,188 reid_baseline.train INFO: normal accuracy 0.7445405850844664 2.136033535003662 
2022-04-12 13:06:27,189 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 13:06:27,189 reid_baseline.train INFO: Val Accuracy: 74.5% Mean Entropy: 213.6%
2022-04-12 13:06:43,070 reid_baseline.train INFO: normal accuracy 0.8911955241460542 1.2490445375442505 
2022-04-12 13:06:43,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 13:06:43,070 reid_baseline.train INFO: Train Accuracy: 89.1% Mean Entropy: 124.9%
2022-04-12 13:07:46,171 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.136, Acc: 0.959, Base Lr: 1.66e-03
2022-04-12 13:08:47,779 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.136, Acc: 0.960, Base Lr: 1.66e-03
2022-04-12 13:09:32,563 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.621[s] Speed: 25.8[samples/s]
2022-04-12 13:10:09,430 reid_baseline.train INFO: normal accuracy 0.7449526163988464 2.102123737335205 
2022-04-12 13:10:09,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 13:10:09,430 reid_baseline.train INFO: Val Accuracy: 74.5% Mean Entropy: 210.2%
2022-04-12 13:10:26,251 reid_baseline.train INFO: normal accuracy 0.8917844522968198 1.2153387069702148 
2022-04-12 13:10:26,251 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 13:10:26,251 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 121.5%
2022-04-12 13:11:29,469 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.129, Acc: 0.958, Base Lr: 1.19e-03
2022-04-12 13:12:31,222 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.133, Acc: 0.960, Base Lr: 1.19e-03
2022-04-12 13:13:16,025 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.622[s] Speed: 25.7[samples/s]
2022-04-12 13:13:53,271 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.163102388381958 
2022-04-12 13:13:53,271 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 13:13:53,271 reid_baseline.train INFO: Val Accuracy: 74.3% Mean Entropy: 216.3%
2022-04-12 13:14:10,273 reid_baseline.train INFO: normal accuracy 0.8919316843345112 1.2643299102783203 
2022-04-12 13:14:10,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 13:14:10,273 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 126.4%
2022-04-12 13:15:13,571 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.123, Acc: 0.966, Base Lr: 7.78e-04
2022-04-12 13:16:15,370 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.121, Acc: 0.964, Base Lr: 7.78e-04
2022-04-12 13:17:00,318 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.623[s] Speed: 25.7[samples/s]
2022-04-12 13:17:38,363 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.1373679637908936 
2022-04-12 13:17:38,363 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 13:17:38,363 reid_baseline.train INFO: Val Accuracy: 74.6% Mean Entropy: 213.7%
2022-04-12 13:17:54,282 reid_baseline.train INFO: normal accuracy 0.8931095406360424 1.2406028509140015 
2022-04-12 13:17:54,282 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 13:17:54,283 reid_baseline.train INFO: Train Accuracy: 89.3% Mean Entropy: 124.1%
2022-04-12 13:18:57,897 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.125, Acc: 0.959, Base Lr: 4.51e-04
2022-04-12 13:19:59,736 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.119, Acc: 0.965, Base Lr: 4.51e-04
2022-04-12 13:20:44,690 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.624[s] Speed: 25.6[samples/s]
2022-04-12 13:21:21,648 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.0886003971099854 
2022-04-12 13:21:24,733 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 13:21:24,733 reid_baseline.train INFO: Val Accuracy: 74.6% Mean Entropy: 208.9%
2022-04-12 13:21:40,660 reid_baseline.train INFO: normal accuracy 0.8931095406360424 1.1946958303451538 
2022-04-12 13:21:40,660 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 13:21:40,660 reid_baseline.train INFO: Train Accuracy: 89.3% Mean Entropy: 119.5%
2022-04-12 13:22:43,990 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.112, Acc: 0.972, Base Lr: 2.11e-04
2022-04-12 13:23:45,430 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.125, Acc: 0.967, Base Lr: 2.11e-04
2022-04-12 13:24:30,004 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 13:25:06,463 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.0854134559631348 
2022-04-12 13:25:09,539 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 13:25:09,539 reid_baseline.train INFO: Val Accuracy: 74.2% Mean Entropy: 208.5%
2022-04-12 13:25:25,657 reid_baseline.train INFO: normal accuracy 0.8926678445229682 1.197828769683838 
2022-04-12 13:25:25,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 13:25:25,657 reid_baseline.train INFO: Train Accuracy: 89.3% Mean Entropy: 119.8%
2022-04-12 13:26:28,824 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.113, Acc: 0.969, Base Lr: 6.51e-05
2022-04-12 13:27:30,427 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.115, Acc: 0.971, Base Lr: 6.51e-05
2022-04-12 13:28:15,063 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 13:28:51,712 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.097733736038208 
2022-04-12 13:28:51,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 13:28:51,713 reid_baseline.train INFO: Val Accuracy: 74.2% Mean Entropy: 209.8%
2022-04-12 13:29:07,626 reid_baseline.train INFO: normal accuracy 0.8920789163722026 1.2027024030685425 
2022-04-12 13:29:07,626 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 13:29:07,626 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 120.3%
2022-04-12 13:30:10,660 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.089, Acc: 0.972, Base Lr: 1.60e-05
2022-04-12 13:31:12,300 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.117, Acc: 0.966, Base Lr: 1.60e-05
2022-04-12 13:31:56,982 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 13:32:36,488 reid_baseline.train INFO: normal accuracy 0.7395962093119077 2.1134448051452637 
2022-04-12 13:32:36,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 13:32:36,488 reid_baseline.train INFO: Val Accuracy: 74.0% Mean Entropy: 211.3%
2022-04-12 13:32:52,475 reid_baseline.train INFO: normal accuracy 0.8913427561837456 1.2194422483444214 
2022-04-12 13:32:52,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 13:32:52,475 reid_baseline.train INFO: Train Accuracy: 89.1% Mean Entropy: 121.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Art_patch_aug5_feature_mixup_global_feat/transformer_best_model.pth
2022-04-12 13:33:32,146 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.0854134559631348 
2022-04-12 13:33:32,146 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 13:33:32,146 reid_baseline.train INFO: Accuracy: 74.2%
2022-04-12 13:33:47,988 reid_baseline.train INFO: normal accuracy 0.8926678445229682 1.197828769683838 
2022-04-12 13:33:47,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 13:33:47,988 reid_baseline.train INFO: Train Accuracy: 89.3%
2022-04-12 13:33:51,706 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2Product_patch_aug5_feature_mixup_global_feat
2022-04-12 13:33:51,707 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2Product_patch_aug5_feature_mixup_global_feat', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Clipart_2Product_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_classifier/transformer_best_model.pth')
2022-04-12 13:33:51,707 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 13:33:51,707 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 13:33:51,707 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2Product_patch_aug5_feature_mixup_global_feat
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Product_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_classifier/transformer_best_model.pth
2022-04-12 13:33:59,025 reid_baseline.train INFO: start training
2022-04-12 13:35:02,723 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.318, Acc: 0.341, Base Lr: 8.72e-04
2022-04-12 13:36:03,537 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.202, Acc: 0.458, Base Lr: 8.72e-04
2022-04-12 13:36:48,119 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.619[s] Speed: 25.9[samples/s]
2022-04-12 13:37:33,454 reid_baseline.train INFO: normal accuracy 0.5681459788240595 4.1596150398254395 
2022-04-12 13:37:36,461 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 13:37:36,461 reid_baseline.train INFO: Val Accuracy: 56.8% Mean Entropy: 416.0%
2022-04-12 13:37:52,458 reid_baseline.train INFO: normal accuracy 0.612335302135393 4.154592514038086 
2022-04-12 13:37:52,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 13:37:52,458 reid_baseline.train INFO: Train Accuracy: 61.2% Mean Entropy: 415.5%
2022-04-12 13:38:54,991 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.637, Acc: 0.625, Base Lr: 1.66e-03
2022-04-12 13:39:55,833 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.467, Acc: 0.614, Base Lr: 1.66e-03
2022-04-12 13:40:40,159 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.614[s] Speed: 26.0[samples/s]
2022-04-12 13:41:24,962 reid_baseline.train INFO: normal accuracy 0.595629646316738 3.947960376739502 
2022-04-12 13:41:28,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 13:41:28,048 reid_baseline.train INFO: Val Accuracy: 59.6% Mean Entropy: 394.8%
2022-04-12 13:41:43,958 reid_baseline.train INFO: normal accuracy 0.6398228078146297 3.8626928329467773 
2022-04-12 13:41:43,958 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 13:41:43,958 reid_baseline.train INFO: Train Accuracy: 64.0% Mean Entropy: 386.3%
2022-04-12 13:42:46,885 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.706, Acc: 0.667, Base Lr: 2.46e-03
2022-04-12 13:43:47,854 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.554, Acc: 0.684, Base Lr: 2.46e-03
2022-04-12 13:44:32,091 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 13:45:17,047 reid_baseline.train INFO: normal accuracy 0.6877675152061276 3.3374972343444824 
2022-04-12 13:45:20,125 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 13:45:20,125 reid_baseline.train INFO: Val Accuracy: 68.8% Mean Entropy: 333.7%
2022-04-12 13:45:36,023 reid_baseline.train INFO: normal accuracy 0.7305770104497955 3.112088203430176 
2022-04-12 13:45:36,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 13:45:36,023 reid_baseline.train INFO: Train Accuracy: 73.1% Mean Entropy: 311.2%
2022-04-12 13:46:38,666 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.054, Acc: 0.752, Base Lr: 3.25e-03
2022-04-12 13:47:39,349 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.963, Acc: 0.768, Base Lr: 3.25e-03
2022-04-12 13:48:23,518 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-04-12 13:49:10,867 reid_baseline.train INFO: normal accuracy 0.7332732597431854 2.6937503814697266 
2022-04-12 13:49:13,950 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 13:49:13,950 reid_baseline.train INFO: Val Accuracy: 73.3% Mean Entropy: 269.4%
2022-04-12 13:49:29,754 reid_baseline.train INFO: normal accuracy 0.7850976828714221 2.3696346282958984 
2022-04-12 13:49:29,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 13:49:29,754 reid_baseline.train INFO: Train Accuracy: 78.5% Mean Entropy: 237.0%
2022-04-12 13:50:32,118 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.689, Acc: 0.831, Base Lr: 4.04e-03
2022-04-12 13:51:33,052 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.680, Acc: 0.827, Base Lr: 4.04e-03
2022-04-12 13:52:17,521 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.614[s] Speed: 26.0[samples/s]
2022-04-12 13:53:02,548 reid_baseline.train INFO: normal accuracy 0.758053615679207 2.3101065158843994 
2022-04-12 13:53:05,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 13:53:05,625 reid_baseline.train INFO: Val Accuracy: 75.8% Mean Entropy: 231.0%
2022-04-12 13:53:21,556 reid_baseline.train INFO: normal accuracy 0.81860517946388 1.9354805946350098 
2022-04-12 13:53:21,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 13:53:21,557 reid_baseline.train INFO: Train Accuracy: 81.9% Mean Entropy: 193.5%
2022-04-12 13:54:24,043 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.493, Acc: 0.871, Base Lr: 4.83e-03
2022-04-12 13:55:25,160 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.497, Acc: 0.860, Base Lr: 4.83e-03
2022-04-12 13:56:09,355 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.615[s] Speed: 26.0[samples/s]
2022-04-12 13:56:54,943 reid_baseline.train INFO: normal accuracy 0.7652624464969587 2.118685007095337 
2022-04-12 13:56:58,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 13:56:58,033 reid_baseline.train INFO: Val Accuracy: 76.5% Mean Entropy: 211.9%
2022-04-12 13:57:13,948 reid_baseline.train INFO: normal accuracy 0.8359836437982735 1.7098960876464844 
2022-04-12 13:57:13,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 13:57:13,948 reid_baseline.train INFO: Train Accuracy: 83.6% Mean Entropy: 171.0%
2022-04-12 13:58:16,475 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.423, Acc: 0.887, Base Lr: 5.62e-03
2022-04-12 13:59:17,252 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.419, Acc: 0.888, Base Lr: 5.62e-03
2022-04-12 14:00:01,646 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.614[s] Speed: 26.0[samples/s]
2022-04-12 14:00:46,936 reid_baseline.train INFO: normal accuracy 0.7657129984230683 2.0314013957977295 
2022-04-12 14:00:50,022 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 14:00:50,023 reid_baseline.train INFO: Val Accuracy: 76.6% Mean Entropy: 203.1%
2022-04-12 14:01:05,772 reid_baseline.train INFO: normal accuracy 0.847228532485234 1.5851467847824097 
2022-04-12 14:01:05,772 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 14:01:05,772 reid_baseline.train INFO: Train Accuracy: 84.7% Mean Entropy: 158.5%
2022-04-12 14:02:08,416 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.308, Acc: 0.912, Base Lr: 6.42e-03
2022-04-12 14:03:09,236 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.327, Acc: 0.914, Base Lr: 6.42e-03
2022-04-12 14:03:53,590 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.615[s] Speed: 26.0[samples/s]
2022-04-12 14:04:47,646 reid_baseline.train INFO: normal accuracy 0.7765262446496959 1.8933629989624023 
2022-04-12 14:04:50,750 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 14:04:50,750 reid_baseline.train INFO: Val Accuracy: 77.7% Mean Entropy: 189.3%
2022-04-12 14:05:06,977 reid_baseline.train INFO: normal accuracy 0.8607451158564289 1.4324512481689453 
2022-04-12 14:05:06,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 14:05:06,977 reid_baseline.train INFO: Train Accuracy: 86.1% Mean Entropy: 143.2%
2022-04-12 14:06:09,676 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.315, Acc: 0.928, Base Lr: 7.21e-03
2022-04-12 14:07:10,653 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.295, Acc: 0.929, Base Lr: 7.21e-03
2022-04-12 14:07:54,811 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.615[s] Speed: 26.0[samples/s]
2022-04-12 14:08:40,223 reid_baseline.train INFO: normal accuracy 0.7819328677630096 1.8459794521331787 
2022-04-12 14:08:43,605 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 14:08:43,605 reid_baseline.train INFO: Val Accuracy: 78.2% Mean Entropy: 184.6%
2022-04-12 14:08:59,522 reid_baseline.train INFO: normal accuracy 0.8690368014538846 1.3533341884613037 
2022-04-12 14:08:59,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 14:08:59,522 reid_baseline.train INFO: Train Accuracy: 86.9% Mean Entropy: 135.3%
2022-04-12 14:10:02,154 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.241, Acc: 0.939, Base Lr: 4.01e-03
2022-04-12 14:11:03,269 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.231, Acc: 0.944, Base Lr: 4.01e-03
2022-04-12 14:11:47,563 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 14:12:36,286 reid_baseline.train INFO: normal accuracy 0.7868889389502141 1.7956544160842896 
2022-04-12 14:12:39,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 14:12:39,364 reid_baseline.train INFO: Val Accuracy: 78.7% Mean Entropy: 179.6%
2022-04-12 14:12:55,328 reid_baseline.train INFO: normal accuracy 0.874602453430259 1.2990379333496094 
2022-04-12 14:12:55,328 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 14:12:55,328 reid_baseline.train INFO: Train Accuracy: 87.5% Mean Entropy: 129.9%
2022-04-12 14:13:57,613 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.186, Acc: 0.951, Base Lr: 3.38e-03
2022-04-12 14:14:58,741 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.183, Acc: 0.952, Base Lr: 3.38e-03
2022-04-12 14:15:42,848 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.614[s] Speed: 26.1[samples/s]
2022-04-12 14:16:28,252 reid_baseline.train INFO: normal accuracy 0.7895922505068709 1.8314969539642334 
2022-04-12 14:16:28,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 14:16:28,253 reid_baseline.train INFO: Val Accuracy: 79.0% Mean Entropy: 183.1%
2022-04-12 14:16:44,000 reid_baseline.train INFO: normal accuracy 0.8773284870513403 1.3113164901733398 
2022-04-12 14:16:44,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 14:16:44,001 reid_baseline.train INFO: Train Accuracy: 87.7% Mean Entropy: 131.1%
2022-04-12 14:17:46,503 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.184, Acc: 0.959, Base Lr: 2.77e-03
2022-04-12 14:18:47,293 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.182, Acc: 0.957, Base Lr: 2.77e-03
2022-04-12 14:19:31,613 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.614[s] Speed: 26.1[samples/s]
2022-04-12 14:20:16,355 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.7928681373596191 
2022-04-12 14:20:19,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 14:20:19,439 reid_baseline.train INFO: Val Accuracy: 78.4% Mean Entropy: 179.3%
2022-04-12 14:20:35,384 reid_baseline.train INFO: normal accuracy 0.8761926397092231 1.2704333066940308 
2022-04-12 14:20:35,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 14:20:35,384 reid_baseline.train INFO: Train Accuracy: 87.6% Mean Entropy: 127.0%
2022-04-12 14:21:37,950 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.147, Acc: 0.955, Base Lr: 2.20e-03
2022-04-12 14:22:38,769 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.160, Acc: 0.955, Base Lr: 2.20e-03
2022-04-12 14:23:22,324 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.611[s] Speed: 26.2[samples/s]
2022-04-12 14:24:06,790 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.8411282300949097 
2022-04-12 14:24:06,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 14:24:06,790 reid_baseline.train INFO: Val Accuracy: 78.6% Mean Entropy: 184.1%
2022-04-12 14:24:22,593 reid_baseline.train INFO: normal accuracy 0.878691503861881 1.3027020692825317 
2022-04-12 14:24:22,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 14:24:22,593 reid_baseline.train INFO: Train Accuracy: 87.9% Mean Entropy: 130.3%
2022-04-12 14:25:25,129 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.136, Acc: 0.960, Base Lr: 1.66e-03
2022-04-12 14:26:25,929 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.137, Acc: 0.960, Base Lr: 1.66e-03
2022-04-12 14:27:10,228 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.614[s] Speed: 26.1[samples/s]
2022-04-12 14:27:55,199 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.8087486028671265 
2022-04-12 14:27:55,199 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 14:27:55,199 reid_baseline.train INFO: Val Accuracy: 78.8% Mean Entropy: 180.9%
2022-04-12 14:28:10,902 reid_baseline.train INFO: normal accuracy 0.8800545206724216 1.2701963186264038 
2022-04-12 14:28:10,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 14:28:10,902 reid_baseline.train INFO: Train Accuracy: 88.0% Mean Entropy: 127.0%
2022-04-12 14:29:13,092 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.129, Acc: 0.958, Base Lr: 1.19e-03
2022-04-12 14:30:13,726 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.133, Acc: 0.960, Base Lr: 1.19e-03
2022-04-12 14:30:58,211 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-04-12 14:31:44,503 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.8650741577148438 
2022-04-12 14:31:44,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 14:31:44,503 reid_baseline.train INFO: Val Accuracy: 78.8% Mean Entropy: 186.5%
2022-04-12 14:32:00,384 reid_baseline.train INFO: normal accuracy 0.8806224443434802 1.319311261177063 
2022-04-12 14:32:00,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 14:32:00,384 reid_baseline.train INFO: Train Accuracy: 88.1% Mean Entropy: 131.9%
2022-04-12 14:33:02,479 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.123, Acc: 0.964, Base Lr: 7.78e-04
2022-04-12 14:34:03,475 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.121, Acc: 0.964, Base Lr: 7.78e-04
2022-04-12 14:34:47,778 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-04-12 14:35:32,714 reid_baseline.train INFO: normal accuracy 0.7868889389502141 1.844698190689087 
2022-04-12 14:35:32,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 14:35:32,715 reid_baseline.train INFO: Val Accuracy: 78.7% Mean Entropy: 184.5%
2022-04-12 14:35:48,501 reid_baseline.train INFO: normal accuracy 0.8801681054066334 1.2978020906448364 
2022-04-12 14:35:48,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 14:35:48,502 reid_baseline.train INFO: Train Accuracy: 88.0% Mean Entropy: 129.8%
2022-04-12 14:36:51,633 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.125, Acc: 0.959, Base Lr: 4.51e-04
2022-04-12 14:37:52,397 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.119, Acc: 0.965, Base Lr: 4.51e-04
2022-04-12 14:38:36,596 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 14:39:21,445 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7872518301010132 
2022-04-12 14:39:24,534 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 14:39:24,535 reid_baseline.train INFO: Val Accuracy: 79.1% Mean Entropy: 178.7%
2022-04-12 14:39:40,496 reid_baseline.train INFO: normal accuracy 0.8823262153566561 1.2468154430389404 
2022-04-12 14:39:40,496 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 14:39:40,497 reid_baseline.train INFO: Train Accuracy: 88.2% Mean Entropy: 124.7%
2022-04-12 14:40:43,235 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.111, Acc: 0.972, Base Lr: 2.11e-04
2022-04-12 14:41:43,991 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.125, Acc: 0.967, Base Lr: 2.11e-04
2022-04-12 14:42:28,676 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 14:43:14,639 reid_baseline.train INFO: normal accuracy 0.787790042802433 1.7960671186447144 
2022-04-12 14:43:14,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 14:43:14,639 reid_baseline.train INFO: Val Accuracy: 78.8% Mean Entropy: 179.6%
2022-04-12 14:43:30,624 reid_baseline.train INFO: normal accuracy 0.8813039527487506 1.2545759677886963 
2022-04-12 14:43:30,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 14:43:30,624 reid_baseline.train INFO: Train Accuracy: 88.1% Mean Entropy: 125.5%
2022-04-12 14:44:33,583 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.112, Acc: 0.968, Base Lr: 6.51e-05
2022-04-12 14:45:34,343 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.115, Acc: 0.970, Base Lr: 6.51e-05
2022-04-12 14:46:18,557 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.615[s] Speed: 26.0[samples/s]
2022-04-12 14:47:04,512 reid_baseline.train INFO: normal accuracy 0.7880153187654877 1.8015073537826538 
2022-04-12 14:47:04,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 14:47:04,512 reid_baseline.train INFO: Val Accuracy: 78.8% Mean Entropy: 180.2%
2022-04-12 14:47:20,410 reid_baseline.train INFO: normal accuracy 0.8808496138119036 1.2577457427978516 
2022-04-12 14:47:20,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 14:47:20,410 reid_baseline.train INFO: Train Accuracy: 88.1% Mean Entropy: 125.8%
2022-04-12 14:48:23,462 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.089, Acc: 0.971, Base Lr: 1.60e-05
2022-04-12 14:49:24,410 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.116, Acc: 0.966, Base Lr: 1.60e-05
2022-04-12 14:50:08,901 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.617[s] Speed: 25.9[samples/s]
2022-04-12 14:50:57,377 reid_baseline.train INFO: normal accuracy 0.7895922505068709 1.8220752477645874 
2022-04-12 14:50:57,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 14:50:57,378 reid_baseline.train INFO: Val Accuracy: 79.0% Mean Entropy: 182.2%
2022-04-12 14:51:13,196 reid_baseline.train INFO: normal accuracy 0.8818718764198091 1.2766470909118652 
2022-04-12 14:51:13,196 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 14:51:13,196 reid_baseline.train INFO: Train Accuracy: 88.2% Mean Entropy: 127.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Product_patch_aug5_feature_mixup_global_feat/transformer_best_model.pth
2022-04-12 14:52:01,771 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7872518301010132 
2022-04-12 14:52:01,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 14:52:01,771 reid_baseline.train INFO: Accuracy: 79.1%
2022-04-12 14:52:17,617 reid_baseline.train INFO: normal accuracy 0.8823262153566561 1.2468154430389404 
2022-04-12 14:52:17,617 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 14:52:17,617 reid_baseline.train INFO: Train Accuracy: 88.2%
2022-04-12 14:52:23,781 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2Real_World_patch_aug5_feature_mixup_global_feat
2022-04-12 14:52:23,781 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2Real_World_patch_aug5_feature_mixup_global_feat', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Clipart_2Real_World_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False, lin_prot_path='../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_classifier/transformer_best_model.pth')
2022-04-12 14:52:23,781 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 14:52:23,782 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 14:52:23,782 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2Real_World_patch_aug5_feature_mixup_global_feat
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Real_World_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_classifier/transformer_best_model.pth
2022-04-12 14:52:31,138 reid_baseline.train INFO: start training
2022-04-12 14:53:35,429 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.318, Acc: 0.341, Base Lr: 8.72e-04
2022-04-12 14:54:36,493 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.202, Acc: 0.457, Base Lr: 8.72e-04
2022-04-12 14:55:21,354 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.623[s] Speed: 25.7[samples/s]
2022-04-12 14:57:37,206 reid_baseline.train INFO: normal accuracy 0.5799862290566904 4.16180419921875 
2022-04-12 14:57:40,210 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 14:57:40,210 reid_baseline.train INFO: Val Accuracy: 58.0% Mean Entropy: 416.2%
2022-04-12 14:57:56,014 reid_baseline.train INFO: normal accuracy 0.6185507911029581 4.155640125274658 
2022-04-12 14:57:56,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 14:57:56,014 reid_baseline.train INFO: Train Accuracy: 61.9% Mean Entropy: 415.6%
2022-04-12 14:58:58,572 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.637, Acc: 0.625, Base Lr: 1.66e-03
2022-04-12 14:59:59,917 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.467, Acc: 0.614, Base Lr: 1.66e-03
2022-04-12 15:00:44,311 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-12 15:02:59,215 reid_baseline.train INFO: normal accuracy 0.6155611659398669 3.9870994091033936 
2022-04-12 15:03:02,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 15:03:02,305 reid_baseline.train INFO: Val Accuracy: 61.6% Mean Entropy: 398.7%
2022-04-12 15:03:18,082 reid_baseline.train INFO: normal accuracy 0.6500802568218299 3.8813557624816895 
2022-04-12 15:03:18,083 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 15:03:18,083 reid_baseline.train INFO: Train Accuracy: 65.0% Mean Entropy: 388.1%
2022-04-12 15:04:20,800 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.706, Acc: 0.667, Base Lr: 2.46e-03
2022-04-12 15:05:21,665 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.554, Acc: 0.684, Base Lr: 2.46e-03
2022-04-12 15:06:06,084 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.615[s] Speed: 26.0[samples/s]
2022-04-12 15:08:22,425 reid_baseline.train INFO: normal accuracy 0.707137938948818 3.454850435256958 
2022-04-12 15:08:25,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 15:08:25,508 reid_baseline.train INFO: Val Accuracy: 70.7% Mean Entropy: 345.5%
2022-04-12 15:08:41,540 reid_baseline.train INFO: normal accuracy 0.7406558128869525 3.1687703132629395 
2022-04-12 15:08:41,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 15:08:41,540 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 316.9%
2022-04-12 15:09:44,661 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.054, Acc: 0.752, Base Lr: 3.25e-03
2022-04-12 15:10:46,182 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.963, Acc: 0.767, Base Lr: 3.25e-03
2022-04-12 15:11:30,831 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 15:13:46,360 reid_baseline.train INFO: normal accuracy 0.757401882028919 2.8298723697662354 
2022-04-12 15:13:49,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 15:13:49,446 reid_baseline.train INFO: Val Accuracy: 75.7% Mean Entropy: 283.0%
2022-04-12 15:14:05,345 reid_baseline.train INFO: normal accuracy 0.79763815638615 2.4349803924560547 
2022-04-12 15:14:05,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 15:14:05,346 reid_baseline.train INFO: Train Accuracy: 79.8% Mean Entropy: 243.5%
2022-04-12 15:15:08,286 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.689, Acc: 0.831, Base Lr: 4.04e-03
2022-04-12 15:16:09,593 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.679, Acc: 0.827, Base Lr: 4.04e-03
2022-04-12 15:16:54,294 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.619[s] Speed: 25.9[samples/s]
2022-04-12 15:19:08,506 reid_baseline.train INFO: normal accuracy 0.782419095708056 2.4358255863189697 
2022-04-12 15:19:11,608 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 15:19:11,608 reid_baseline.train INFO: Val Accuracy: 78.2% Mean Entropy: 243.6%
2022-04-12 15:19:27,583 reid_baseline.train INFO: normal accuracy 0.8316899793625315 1.9945611953735352 
2022-04-12 15:19:27,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 15:19:27,583 reid_baseline.train INFO: Train Accuracy: 83.2% Mean Entropy: 199.5%
2022-04-12 15:20:30,291 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.493, Acc: 0.870, Base Lr: 4.83e-03
2022-04-12 15:21:31,638 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.497, Acc: 0.860, Base Lr: 4.83e-03
2022-04-12 15:22:16,203 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-04-12 15:24:31,952 reid_baseline.train INFO: normal accuracy 0.7904521459719991 2.250001907348633 
2022-04-12 15:24:35,042 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 15:24:35,042 reid_baseline.train INFO: Val Accuracy: 79.0% Mean Entropy: 225.0%
2022-04-12 15:24:50,974 reid_baseline.train INFO: normal accuracy 0.8492318275624857 1.771406888961792 
2022-04-12 15:24:50,974 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 15:24:50,974 reid_baseline.train INFO: Train Accuracy: 84.9% Mean Entropy: 177.1%
2022-04-12 15:25:54,574 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.422, Acc: 0.886, Base Lr: 5.62e-03
2022-04-12 15:26:56,027 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.418, Acc: 0.888, Base Lr: 5.62e-03
2022-04-12 15:27:40,547 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.621[s] Speed: 25.8[samples/s]
2022-04-12 15:29:56,674 reid_baseline.train INFO: normal accuracy 0.7994032591232499 2.138672351837158 
2022-04-12 15:29:59,769 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 15:29:59,769 reid_baseline.train INFO: Val Accuracy: 79.9% Mean Entropy: 213.9%
2022-04-12 15:30:15,585 reid_baseline.train INFO: normal accuracy 0.8648245815180005 1.6337001323699951 
2022-04-12 15:30:15,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 15:30:15,586 reid_baseline.train INFO: Train Accuracy: 86.5% Mean Entropy: 163.4%
2022-04-12 15:31:18,539 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.307, Acc: 0.915, Base Lr: 6.42e-03
2022-04-12 15:32:20,497 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.327, Acc: 0.916, Base Lr: 6.42e-03
2022-04-12 15:33:05,346 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.622[s] Speed: 25.7[samples/s]
2022-04-12 15:35:22,331 reid_baseline.train INFO: normal accuracy 0.8023869635070002 2.01543927192688 
2022-04-12 15:35:25,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 15:35:25,434 reid_baseline.train INFO: Val Accuracy: 80.2% Mean Entropy: 201.5%
2022-04-12 15:35:41,228 reid_baseline.train INFO: normal accuracy 0.8744554001375832 1.4901992082595825 
2022-04-12 15:35:41,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 15:35:41,228 reid_baseline.train INFO: Train Accuracy: 87.4% Mean Entropy: 149.0%
2022-04-12 15:36:44,068 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.315, Acc: 0.927, Base Lr: 7.21e-03
2022-04-12 15:37:45,697 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.296, Acc: 0.928, Base Lr: 7.21e-03
2022-04-12 15:38:30,554 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-04-12 15:40:45,993 reid_baseline.train INFO: normal accuracy 0.8053706678907505 1.9452478885650635 
2022-04-12 15:40:49,085 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 15:40:49,085 reid_baseline.train INFO: Val Accuracy: 80.5% Mean Entropy: 194.5%
2022-04-12 15:41:05,173 reid_baseline.train INFO: normal accuracy 0.8817931667048842 1.3986059427261353 
2022-04-12 15:41:05,173 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 15:41:05,173 reid_baseline.train INFO: Train Accuracy: 88.2% Mean Entropy: 139.9%
2022-04-12 15:42:11,292 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.240, Acc: 0.939, Base Lr: 4.01e-03
2022-04-12 15:43:13,018 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.230, Acc: 0.944, Base Lr: 4.01e-03
2022-04-12 15:43:57,917 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.633[s] Speed: 25.3[samples/s]
2022-04-12 15:46:18,210 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.9067260026931763 
2022-04-12 15:46:21,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 15:46:21,513 reid_baseline.train INFO: Val Accuracy: 81.0% Mean Entropy: 190.7%
2022-04-12 15:46:37,591 reid_baseline.train INFO: normal accuracy 0.8869525338225178 1.3505711555480957 
2022-04-12 15:46:37,591 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 15:46:37,591 reid_baseline.train INFO: Train Accuracy: 88.7% Mean Entropy: 135.1%
2022-04-12 15:47:42,640 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.187, Acc: 0.951, Base Lr: 3.38e-03
2022-04-12 15:48:44,085 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.183, Acc: 0.952, Base Lr: 3.38e-03
2022-04-12 15:49:28,581 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.626[s] Speed: 25.5[samples/s]
2022-04-12 15:51:45,568 reid_baseline.train INFO: normal accuracy 0.8078953408308469 1.9171496629714966 
2022-04-12 15:51:45,568 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 15:51:45,568 reid_baseline.train INFO: Val Accuracy: 80.8% Mean Entropy: 191.7%
2022-04-12 15:52:01,840 reid_baseline.train INFO: normal accuracy 0.8872964916303601 1.3497554063796997 
2022-04-12 15:52:01,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 15:52:01,840 reid_baseline.train INFO: Train Accuracy: 88.7% Mean Entropy: 135.0%
2022-04-12 15:53:06,758 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.184, Acc: 0.959, Base Lr: 2.77e-03
2022-04-12 15:54:09,823 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.182, Acc: 0.956, Base Lr: 2.77e-03
2022-04-12 15:54:56,148 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.638[s] Speed: 25.1[samples/s]
2022-04-12 15:57:14,563 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.874485969543457 
2022-04-12 15:57:17,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 15:57:17,724 reid_baseline.train INFO: Val Accuracy: 80.8% Mean Entropy: 187.4%
2022-04-12 15:57:34,163 reid_baseline.train INFO: normal accuracy 0.8889016280669572 1.3062666654586792 
2022-04-12 15:57:34,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-12 15:57:34,163 reid_baseline.train INFO: Train Accuracy: 88.9% Mean Entropy: 130.6%
2022-04-12 15:58:37,012 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.147, Acc: 0.954, Base Lr: 2.20e-03
2022-04-12 15:59:38,329 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.160, Acc: 0.954, Base Lr: 2.20e-03
2022-04-12 16:00:22,614 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.617[s] Speed: 25.9[samples/s]
2022-04-12 16:02:37,645 reid_baseline.train INFO: normal accuracy 0.8056001836125775 1.9202669858932495 
2022-04-12 16:02:37,646 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 16:02:37,646 reid_baseline.train INFO: Val Accuracy: 80.6% Mean Entropy: 192.0%
2022-04-12 16:02:53,628 reid_baseline.train INFO: normal accuracy 0.8892455858747994 1.3373607397079468 
2022-04-12 16:02:53,628 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-12 16:02:53,628 reid_baseline.train INFO: Train Accuracy: 88.9% Mean Entropy: 133.7%
2022-04-12 16:03:57,244 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.136, Acc: 0.959, Base Lr: 1.66e-03
2022-04-12 16:04:58,637 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.137, Acc: 0.960, Base Lr: 1.66e-03
2022-04-12 16:05:43,454 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.622[s] Speed: 25.7[samples/s]
2022-04-12 16:07:59,495 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.8906872272491455 
2022-04-12 16:07:59,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 16:07:59,495 reid_baseline.train INFO: Val Accuracy: 80.8% Mean Entropy: 189.1%
2022-04-12 16:08:15,319 reid_baseline.train INFO: normal accuracy 0.8909653749140105 1.3059539794921875 
2022-04-12 16:08:15,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 16:08:15,320 reid_baseline.train INFO: Train Accuracy: 89.1% Mean Entropy: 130.6%
2022-04-12 16:09:18,659 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.129, Acc: 0.959, Base Lr: 1.19e-03
2022-04-12 16:10:20,217 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.133, Acc: 0.960, Base Lr: 1.19e-03
2022-04-12 16:11:05,171 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.622[s] Speed: 25.7[samples/s]
2022-04-12 16:13:23,061 reid_baseline.train INFO: normal accuracy 0.8078953408308469 1.9507043361663818 
2022-04-12 16:13:23,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 16:13:23,062 reid_baseline.train INFO: Val Accuracy: 80.8% Mean Entropy: 195.1%
2022-04-12 16:13:38,991 reid_baseline.train INFO: normal accuracy 0.8913093327218528 1.3571397066116333 
2022-04-12 16:13:38,991 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 16:13:38,991 reid_baseline.train INFO: Train Accuracy: 89.1% Mean Entropy: 135.7%
2022-04-12 16:14:42,191 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.123, Acc: 0.964, Base Lr: 7.78e-04
2022-04-12 16:15:43,756 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.121, Acc: 0.963, Base Lr: 7.78e-04
2022-04-12 16:16:28,783 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.622[s] Speed: 25.7[samples/s]
2022-04-12 16:18:46,325 reid_baseline.train INFO: normal accuracy 0.807436309387193 1.9198399782180786 
2022-04-12 16:18:46,326 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 16:18:46,326 reid_baseline.train INFO: Val Accuracy: 80.7% Mean Entropy: 192.0%
2022-04-12 16:19:02,265 reid_baseline.train INFO: normal accuracy 0.8911946801192387 1.3303744792938232 
2022-04-12 16:19:02,265 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 16:19:02,265 reid_baseline.train INFO: Train Accuracy: 89.1% Mean Entropy: 133.0%
2022-04-12 16:20:05,732 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.125, Acc: 0.959, Base Lr: 4.51e-04
2022-04-12 16:21:07,487 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.119, Acc: 0.965, Base Lr: 4.51e-04
2022-04-12 16:21:52,670 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.624[s] Speed: 25.6[samples/s]
2022-04-12 16:24:09,195 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.8662153482437134 
2022-04-12 16:24:12,300 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 16:24:12,300 reid_baseline.train INFO: Val Accuracy: 81.0% Mean Entropy: 186.6%
2022-04-12 16:24:28,308 reid_baseline.train INFO: normal accuracy 0.8925705113506076 1.281269907951355 
2022-04-12 16:24:28,308 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 16:24:28,308 reid_baseline.train INFO: Train Accuracy: 89.3% Mean Entropy: 128.1%
2022-04-12 16:25:31,592 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.112, Acc: 0.972, Base Lr: 2.11e-04
2022-04-12 16:26:33,545 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.125, Acc: 0.967, Base Lr: 2.11e-04
2022-04-12 16:27:18,411 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.623[s] Speed: 25.7[samples/s]
2022-04-12 16:29:36,838 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.8717265129089355 
2022-04-12 16:29:36,838 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 16:29:36,838 reid_baseline.train INFO: Val Accuracy: 80.9% Mean Entropy: 187.2%
2022-04-12 16:29:53,038 reid_baseline.train INFO: normal accuracy 0.8923412061453795 1.2874486446380615 
2022-04-12 16:29:53,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 16:29:53,038 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 128.7%
2022-04-12 16:30:56,261 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.113, Acc: 0.969, Base Lr: 6.51e-05
2022-04-12 16:31:58,411 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.115, Acc: 0.971, Base Lr: 6.51e-05
2022-04-12 16:32:43,361 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.624[s] Speed: 25.6[samples/s]
2022-04-12 16:35:01,177 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.8817903995513916 
2022-04-12 16:35:01,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 16:35:01,177 reid_baseline.train INFO: Val Accuracy: 80.9% Mean Entropy: 188.2%
2022-04-12 16:35:17,343 reid_baseline.train INFO: normal accuracy 0.8918825957349232 1.2928171157836914 
2022-04-12 16:35:17,344 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 16:35:17,344 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 129.3%
2022-04-12 16:36:22,024 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.089, Acc: 0.971, Base Lr: 1.60e-05
2022-04-12 16:37:26,024 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.117, Acc: 0.966, Base Lr: 1.60e-05
2022-04-12 16:38:11,317 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.637[s] Speed: 25.1[samples/s]
2022-04-12 16:40:35,593 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.9025517702102661 
2022-04-12 16:40:35,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 16:40:35,594 reid_baseline.train INFO: Val Accuracy: 81.0% Mean Entropy: 190.3%
2022-04-12 16:40:51,542 reid_baseline.train INFO: normal accuracy 0.8929144691584499 1.3117878437042236 
2022-04-12 16:40:51,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 16:40:51,542 reid_baseline.train INFO: Train Accuracy: 89.3% Mean Entropy: 131.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Real_World_patch_aug5_feature_mixup_global_feat/transformer_best_model.pth
2022-04-12 16:43:16,752 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.8662153482437134 
2022-04-12 16:43:16,752 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 16:43:16,752 reid_baseline.train INFO: Accuracy: 81.0%
2022-04-12 16:43:41,804 reid_baseline.train INFO: normal accuracy 0.8925705113506076 1.281269907951355 
2022-04-12 16:43:41,804 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 16:43:41,804 reid_baseline.train INFO: Train Accuracy: 89.3%
