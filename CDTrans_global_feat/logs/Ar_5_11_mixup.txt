2022-04-11 21:31:29,540 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits
2022-04-11 21:31:29,541 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False)
2022-04-11 21:31:29,541 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-11 21:31:29,541 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-11 21:31:29,541 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth
2022-04-11 21:31:42,898 reid_baseline.train INFO: start training
2022-04-11 21:34:27,082 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-11 21:35:51,281 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.629[s] Speed: 9.8[samples/s]
2022-04-11 21:37:06,723 reid_baseline.train INFO: normal accuracy 0.3411225658648339 4.169779300689697 
2022-04-11 21:37:07,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-11 21:37:07,713 reid_baseline.train INFO: Val Accuracy: 34.1% Mean Entropy: 417.0%
2022-04-11 21:37:28,368 reid_baseline.train INFO: normal accuracy 0.4905771495877503 4.1691131591796875 
2022-04-11 21:37:28,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-11 21:37:28,368 reid_baseline.train INFO: Train Accuracy: 49.1% Mean Entropy: 416.9%
2022-04-11 21:40:14,223 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.986, Acc: 0.722, Base Lr: 1.66e-03
2022-04-11 21:41:37,540 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.639[s] Speed: 9.8[samples/s]
2022-04-11 21:42:50,620 reid_baseline.train INFO: normal accuracy 0.3743413516609393 4.130284309387207 
2022-04-11 21:42:51,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-11 21:42:51,592 reid_baseline.train INFO: Val Accuracy: 37.4% Mean Entropy: 413.0%
2022-04-11 21:43:12,903 reid_baseline.train INFO: normal accuracy 0.5237043580683156 4.1085381507873535 
2022-04-11 21:43:12,904 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-11 21:43:12,904 reid_baseline.train INFO: Train Accuracy: 52.4% Mean Entropy: 410.9%
2022-04-11 21:45:28,618 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-11 21:46:37,151 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.344[s] Speed: 11.9[samples/s]
2022-04-11 21:47:42,819 reid_baseline.train INFO: normal accuracy 0.41878579610538375 3.9074037075042725 
2022-04-11 21:47:43,799 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-11 21:47:43,799 reid_baseline.train INFO: Val Accuracy: 41.9% Mean Entropy: 390.7%
2022-04-11 21:48:02,512 reid_baseline.train INFO: normal accuracy 0.5565371024734982 3.784968376159668 
2022-04-11 21:48:02,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-11 21:48:02,513 reid_baseline.train INFO: Train Accuracy: 55.7% Mean Entropy: 378.5%
2022-04-11 21:50:06,298 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-11 21:51:06,488 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.210[s] Speed: 13.2[samples/s]
2022-04-11 21:52:04,724 reid_baseline.train INFO: normal accuracy 0.47743413516609395 3.379098415374756 
2022-04-11 21:52:05,532 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-11 21:52:05,532 reid_baseline.train INFO: Val Accuracy: 47.7% Mean Entropy: 337.9%
2022-04-11 21:52:23,188 reid_baseline.train INFO: normal accuracy 0.6121908127208481 3.1330392360687256 
2022-04-11 21:52:23,189 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-11 21:52:23,189 reid_baseline.train INFO: Train Accuracy: 61.2% Mean Entropy: 313.3%
2022-04-11 21:54:24,304 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.854, Base Lr: 4.04e-03
2022-04-11 21:55:25,452 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.199[s] Speed: 13.3[samples/s]
2022-04-11 21:56:23,127 reid_baseline.train INFO: normal accuracy 0.5516609392898053 2.942263603210449 
2022-04-11 21:56:23,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-11 21:56:24,000 reid_baseline.train INFO: Val Accuracy: 55.2% Mean Entropy: 294.2%
2022-04-11 21:56:41,821 reid_baseline.train INFO: normal accuracy 0.6780035335689046 2.6120152473449707 
2022-04-11 21:56:41,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-11 21:56:41,822 reid_baseline.train INFO: Train Accuracy: 67.8% Mean Entropy: 261.2%
2022-04-11 21:58:41,869 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.647, Acc: 0.899, Base Lr: 4.83e-03
2022-04-11 21:59:42,421 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.187[s] Speed: 13.5[samples/s]
2022-04-11 22:00:39,965 reid_baseline.train INFO: normal accuracy 0.581901489117984 2.662064790725708 
2022-04-11 22:00:40,821 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-11 22:00:40,821 reid_baseline.train INFO: Val Accuracy: 58.2% Mean Entropy: 266.2%
2022-04-11 22:00:58,283 reid_baseline.train INFO: normal accuracy 0.7115724381625441 2.2945716381073 
2022-04-11 22:00:58,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-11 22:00:58,283 reid_baseline.train INFO: Train Accuracy: 71.2% Mean Entropy: 229.5%
2022-04-11 22:02:58,682 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.448, Acc: 0.932, Base Lr: 5.62e-03
2022-04-11 22:03:59,236 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.190[s] Speed: 13.4[samples/s]
2022-04-11 22:04:57,712 reid_baseline.train INFO: normal accuracy 0.5979381443298969 2.4100356101989746 
2022-04-11 22:04:58,564 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-11 22:04:58,564 reid_baseline.train INFO: Val Accuracy: 59.8% Mean Entropy: 241.0%
2022-04-11 22:05:15,895 reid_baseline.train INFO: normal accuracy 0.7279151943462897 2.038989305496216 
2022-04-11 22:05:15,895 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-11 22:05:15,895 reid_baseline.train INFO: Train Accuracy: 72.8% Mean Entropy: 203.9%
2022-04-11 22:07:16,284 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.950, Base Lr: 6.42e-03
2022-04-11 22:08:16,522 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.188[s] Speed: 13.5[samples/s]
2022-04-11 22:09:15,521 reid_baseline.train INFO: normal accuracy 0.5981672394043528 2.293440341949463 
2022-04-11 22:09:16,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-11 22:09:16,409 reid_baseline.train INFO: Val Accuracy: 59.8% Mean Entropy: 229.3%
2022-04-11 22:09:34,186 reid_baseline.train INFO: normal accuracy 0.7324793875147232 1.874410629272461 
2022-04-11 22:09:34,187 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-11 22:09:34,187 reid_baseline.train INFO: Train Accuracy: 73.2% Mean Entropy: 187.4%
2022-04-11 22:11:34,714 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.969, Base Lr: 7.21e-03
2022-04-11 22:12:34,886 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.189[s] Speed: 13.5[samples/s]
2022-04-11 22:13:33,697 reid_baseline.train INFO: normal accuracy 0.5986254295532646 2.19197154045105 
2022-04-11 22:13:34,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-11 22:13:34,571 reid_baseline.train INFO: Val Accuracy: 59.9% Mean Entropy: 219.2%
2022-04-11 22:13:52,591 reid_baseline.train INFO: normal accuracy 0.7364546525323911 1.7423173189163208 
2022-04-11 22:13:52,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-11 22:13:52,592 reid_baseline.train INFO: Train Accuracy: 73.6% Mean Entropy: 174.2%
2022-04-11 22:15:53,145 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.978, Base Lr: 4.01e-03
2022-04-11 22:16:53,635 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.191[s] Speed: 13.4[samples/s]
2022-04-11 22:17:52,264 reid_baseline.train INFO: normal accuracy 0.604581901489118 2.189228057861328 
2022-04-11 22:17:53,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-11 22:17:53,061 reid_baseline.train INFO: Val Accuracy: 60.5% Mean Entropy: 218.9%
2022-04-11 22:18:10,255 reid_baseline.train INFO: normal accuracy 0.7416077738515902 1.7376540899276733 
2022-04-11 22:18:10,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-11 22:18:10,255 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 173.8%
2022-04-11 22:20:11,024 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.152, Acc: 0.984, Base Lr: 3.38e-03
2022-04-11 22:21:11,758 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.194[s] Speed: 13.4[samples/s]
2022-04-11 22:22:09,485 reid_baseline.train INFO: normal accuracy 0.6020618556701031 2.1568052768707275 
2022-04-11 22:22:10,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-11 22:22:10,305 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 215.7%
2022-04-11 22:22:27,852 reid_baseline.train INFO: normal accuracy 0.7410188457008245 1.7011511325836182 
2022-04-11 22:22:27,852 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-11 22:22:27,852 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 170.1%
2022-04-11 22:24:29,721 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.100, Acc: 0.987, Base Lr: 2.77e-03
2022-04-11 22:25:30,045 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.199[s] Speed: 13.3[samples/s]
2022-04-11 22:26:28,540 reid_baseline.train INFO: normal accuracy 0.6018327605956472 2.1414895057678223 
2022-04-11 22:26:29,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-11 22:26:29,347 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 214.1%
2022-04-11 22:26:47,122 reid_baseline.train INFO: normal accuracy 0.741166077738516 1.67635178565979 
2022-04-11 22:26:47,123 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-11 22:26:47,123 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 167.6%
2022-04-11 22:28:47,307 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.092, Acc: 0.985, Base Lr: 2.20e-03
2022-04-11 22:29:48,398 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.193[s] Speed: 13.4[samples/s]
2022-04-11 22:30:46,456 reid_baseline.train INFO: normal accuracy 0.6004581901489118 2.1009433269500732 
2022-04-11 22:30:47,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-11 22:30:47,286 reid_baseline.train INFO: Val Accuracy: 60.0% Mean Entropy: 210.1%
2022-04-11 22:31:04,913 reid_baseline.train INFO: normal accuracy 0.7405771495877503 1.6280603408813477 
2022-04-11 22:31:04,913 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-11 22:31:04,913 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 162.8%
2022-04-11 22:33:05,187 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.063, Acc: 0.991, Base Lr: 1.66e-03
2022-04-11 22:34:05,657 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.189[s] Speed: 13.5[samples/s]
2022-04-11 22:35:05,187 reid_baseline.train INFO: normal accuracy 0.6013745704467354 2.079718828201294 
2022-04-11 22:35:06,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-11 22:35:06,082 reid_baseline.train INFO: Val Accuracy: 60.1% Mean Entropy: 208.0%
2022-04-11 22:35:23,408 reid_baseline.train INFO: normal accuracy 0.741166077738516 1.6061540842056274 
2022-04-11 22:35:23,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-11 22:35:23,409 reid_baseline.train INFO: Train Accuracy: 74.1% Mean Entropy: 160.6%
2022-04-11 22:37:23,943 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.065, Acc: 0.991, Base Lr: 1.19e-03
2022-04-11 22:38:23,553 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.184[s] Speed: 13.5[samples/s]
2022-04-11 22:39:23,368 reid_baseline.train INFO: normal accuracy 0.6027491408934708 2.1312339305877686 
2022-04-11 22:39:23,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-11 22:39:23,368 reid_baseline.train INFO: Val Accuracy: 60.3% Mean Entropy: 213.1%
2022-04-11 22:39:41,670 reid_baseline.train INFO: normal accuracy 0.7420494699646644 1.653749942779541 
2022-04-11 22:39:41,670 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-11 22:39:41,671 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 165.4%
2022-04-11 22:41:41,662 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.065, Acc: 0.993, Base Lr: 7.78e-04
2022-04-11 22:42:42,369 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.189[s] Speed: 13.5[samples/s]
2022-04-11 22:43:41,524 reid_baseline.train INFO: normal accuracy 0.6052691867124856 2.1547977924346924 
2022-04-11 22:43:41,525 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-11 22:43:41,525 reid_baseline.train INFO: Val Accuracy: 60.5% Mean Entropy: 215.5%
2022-04-11 22:43:59,597 reid_baseline.train INFO: normal accuracy 0.7439634864546525 1.6785237789154053 
2022-04-11 22:43:59,598 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-11 22:43:59,598 reid_baseline.train INFO: Train Accuracy: 74.4% Mean Entropy: 167.9%
2022-04-11 22:46:00,008 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.051, Acc: 0.988, Base Lr: 4.51e-04
2022-04-11 22:47:00,735 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.192[s] Speed: 13.4[samples/s]
2022-04-11 22:47:58,447 reid_baseline.train INFO: normal accuracy 0.6064146620847651 2.0934696197509766 
2022-04-11 22:47:58,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-11 22:47:58,447 reid_baseline.train INFO: Val Accuracy: 60.6% Mean Entropy: 209.3%
2022-04-11 22:48:16,080 reid_baseline.train INFO: normal accuracy 0.7448468786808009 1.6157639026641846 
2022-04-11 22:48:16,080 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-11 22:48:16,080 reid_baseline.train INFO: Train Accuracy: 74.5% Mean Entropy: 161.6%
2022-04-11 22:50:15,819 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.063, Acc: 0.993, Base Lr: 2.11e-04
2022-04-11 22:51:16,554 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.187[s] Speed: 13.5[samples/s]
2022-04-11 22:52:15,027 reid_baseline.train INFO: normal accuracy 0.6038946162657503 2.090620517730713 
2022-04-11 22:52:15,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-11 22:52:15,027 reid_baseline.train INFO: Val Accuracy: 60.4% Mean Entropy: 209.1%
2022-04-11 22:52:32,510 reid_baseline.train INFO: normal accuracy 0.7433745583038869 1.6129664182662964 
2022-04-11 22:52:32,510 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-11 22:52:32,511 reid_baseline.train INFO: Train Accuracy: 74.3% Mean Entropy: 161.3%
2022-04-11 22:54:33,478 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.057, Acc: 0.991, Base Lr: 6.51e-05
2022-04-11 22:55:34,327 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.196[s] Speed: 13.4[samples/s]
2022-04-11 22:56:32,346 reid_baseline.train INFO: normal accuracy 0.6020618556701031 2.107545852661133 
2022-04-11 22:56:32,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-11 22:56:32,347 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 210.8%
2022-04-11 22:56:49,940 reid_baseline.train INFO: normal accuracy 0.7421967020023557 1.6309658288955688 
2022-04-11 22:56:49,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-11 22:56:49,941 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 163.1%
2022-04-11 22:58:50,396 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.061, Acc: 0.988, Base Lr: 1.60e-05
2022-04-11 22:59:51,392 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.194[s] Speed: 13.4[samples/s]
2022-04-11 23:00:51,716 reid_baseline.train INFO: normal accuracy 0.6018327605956472 2.0824875831604004 
2022-04-11 23:00:51,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-11 23:00:51,717 reid_baseline.train INFO: Val Accuracy: 60.2% Mean Entropy: 208.2%
2022-04-11 23:01:09,122 reid_baseline.train INFO: normal accuracy 0.7420494699646644 1.6065393686294556 
2022-04-11 23:01:09,122 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-11 23:01:09,122 reid_baseline.train INFO: Train Accuracy: 74.2% Mean Entropy: 160.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart_patch_aug5_feature_mixup_logits/transformer_best_model.pth
2022-04-11 23:02:07,656 reid_baseline.train INFO: normal accuracy 0.6013745704467354 2.079718828201294 
2022-04-11 23:02:07,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-11 23:02:07,656 reid_baseline.train INFO: Accuracy: 60.1%
2022-04-11 23:02:25,012 reid_baseline.train INFO: normal accuracy 0.741166077738516 1.6061540842056274 
2022-04-11 23:02:25,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-11 23:02:25,013 reid_baseline.train INFO: Train Accuracy: 74.1%
2022-04-11 23:02:29,901 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits
2022-04-11 23:02:29,901 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False)
2022-04-11 23:02:29,901 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-11 23:02:29,901 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-11 23:02:29,901 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth
2022-04-11 23:02:39,934 reid_baseline.train INFO: start training
2022-04-11 23:04:41,431 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-11 23:05:44,231 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.208[s] Speed: 13.3[samples/s]
2022-04-11 23:06:44,271 reid_baseline.train INFO: normal accuracy 0.5465194863708043 4.1707072257995605 
2022-04-11 23:06:45,034 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-11 23:06:45,034 reid_baseline.train INFO: Val Accuracy: 54.7% Mean Entropy: 417.1%
2022-04-11 23:07:02,249 reid_baseline.train INFO: normal accuracy 0.6219050393242063 4.16972017288208 
2022-04-11 23:07:02,249 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-11 23:07:02,249 reid_baseline.train INFO: Train Accuracy: 62.2% Mean Entropy: 417.0%
2022-04-11 23:09:03,038 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.985, Acc: 0.722, Base Lr: 1.66e-03
2022-04-11 23:10:03,222 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.191[s] Speed: 13.4[samples/s]
2022-04-11 23:11:03,876 reid_baseline.train INFO: normal accuracy 0.5841405722009462 4.136083126068115 
2022-04-11 23:11:04,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-11 23:11:04,711 reid_baseline.train INFO: Val Accuracy: 58.4% Mean Entropy: 413.6%
2022-04-11 23:11:22,328 reid_baseline.train INFO: normal accuracy 0.6577337605592776 4.112520694732666 
2022-04-11 23:11:22,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-11 23:11:22,329 reid_baseline.train INFO: Train Accuracy: 65.8% Mean Entropy: 411.3%
2022-04-11 23:13:22,054 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-11 23:14:22,700 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.186[s] Speed: 13.5[samples/s]
2022-04-11 23:15:22,479 reid_baseline.train INFO: normal accuracy 0.5938274386123 3.8907394409179688 
2022-04-11 23:15:23,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-11 23:15:23,313 reid_baseline.train INFO: Val Accuracy: 59.4% Mean Entropy: 389.1%
2022-04-11 23:15:40,776 reid_baseline.train INFO: normal accuracy 0.6682202155549083 3.775503396987915 
2022-04-11 23:15:40,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-11 23:15:40,776 reid_baseline.train INFO: Train Accuracy: 66.8% Mean Entropy: 377.6%
2022-04-11 23:17:41,048 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-11 23:18:41,918 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.192[s] Speed: 13.4[samples/s]
2022-04-11 23:19:41,795 reid_baseline.train INFO: normal accuracy 0.6560036044154088 3.2681949138641357 
2022-04-11 23:19:42,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-11 23:19:42,609 reid_baseline.train INFO: Val Accuracy: 65.6% Mean Entropy: 326.8%
2022-04-11 23:20:00,149 reid_baseline.train INFO: normal accuracy 0.7261870084474221 3.0639424324035645 
2022-04-11 23:20:00,149 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-11 23:20:00,149 reid_baseline.train INFO: Train Accuracy: 72.6% Mean Entropy: 306.4%
2022-04-11 23:22:00,058 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.855, Base Lr: 4.04e-03
2022-04-11 23:23:00,950 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.189[s] Speed: 13.5[samples/s]
2022-04-11 23:23:59,410 reid_baseline.train INFO: normal accuracy 0.7368776751520613 2.7245469093322754 
2022-04-11 23:24:00,258 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-11 23:24:00,258 reid_baseline.train INFO: Val Accuracy: 73.7% Mean Entropy: 272.5%
2022-04-11 23:24:18,113 reid_baseline.train INFO: normal accuracy 0.7963879988348384 2.4747254848480225 
2022-04-11 23:24:18,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-11 23:24:18,113 reid_baseline.train INFO: Train Accuracy: 79.6% Mean Entropy: 247.5%
2022-04-11 23:26:23,071 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.646, Acc: 0.900, Base Lr: 4.83e-03
2022-04-11 23:27:24,530 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.225[s] Speed: 13.1[samples/s]
2022-04-11 23:28:24,168 reid_baseline.train INFO: normal accuracy 0.7679657580536157 2.3931331634521484 
2022-04-11 23:28:24,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-11 23:28:24,986 reid_baseline.train INFO: Val Accuracy: 76.8% Mean Entropy: 239.3%
2022-04-11 23:28:42,621 reid_baseline.train INFO: normal accuracy 0.8306146227789106 2.124757766723633 
2022-04-11 23:28:42,622 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-11 23:28:42,622 reid_baseline.train INFO: Train Accuracy: 83.1% Mean Entropy: 212.5%
2022-04-11 23:30:41,823 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.448, Acc: 0.932, Base Lr: 5.62e-03
2022-04-11 23:31:41,946 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.180[s] Speed: 13.6[samples/s]
2022-04-11 23:32:42,058 reid_baseline.train INFO: normal accuracy 0.7873394908763235 2.1541311740875244 
2022-04-11 23:32:42,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-11 23:32:42,883 reid_baseline.train INFO: Val Accuracy: 78.7% Mean Entropy: 215.4%
2022-04-11 23:33:00,386 reid_baseline.train INFO: normal accuracy 0.8492572094378095 1.8779593706130981 
2022-04-11 23:33:00,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-11 23:33:00,386 reid_baseline.train INFO: Train Accuracy: 84.9% Mean Entropy: 187.8%
2022-04-11 23:35:00,342 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.949, Base Lr: 6.42e-03
2022-04-11 23:36:01,505 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.192[s] Speed: 13.4[samples/s]
2022-04-11 23:37:02,149 reid_baseline.train INFO: normal accuracy 0.7913944582113088 1.9504454135894775 
2022-04-11 23:37:03,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-11 23:37:03,061 reid_baseline.train INFO: Val Accuracy: 79.1% Mean Entropy: 195.0%
2022-04-11 23:37:20,686 reid_baseline.train INFO: normal accuracy 0.8558112438100787 1.6569366455078125 
2022-04-11 23:37:20,687 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-11 23:37:20,687 reid_baseline.train INFO: Train Accuracy: 85.6% Mean Entropy: 165.7%
2022-04-11 23:39:22,079 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.234, Acc: 0.969, Base Lr: 7.21e-03
2022-04-11 23:40:22,243 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.194[s] Speed: 13.4[samples/s]
2022-04-11 23:41:21,925 reid_baseline.train INFO: normal accuracy 0.7977021851768417 1.8540592193603516 
2022-04-11 23:41:22,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-11 23:41:22,737 reid_baseline.train INFO: Val Accuracy: 79.8% Mean Entropy: 185.4%
2022-04-11 23:41:40,791 reid_baseline.train INFO: normal accuracy 0.863530439848529 1.5295299291610718 
2022-04-11 23:41:40,792 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-11 23:41:40,792 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 153.0%
2022-04-11 23:43:38,847 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.978, Base Lr: 4.01e-03
2022-04-11 23:44:38,629 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.170[s] Speed: 13.7[samples/s]
2022-04-11 23:45:39,274 reid_baseline.train INFO: normal accuracy 0.7961252534354585 1.8676151037216187 
2022-04-11 23:45:39,274 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-11 23:45:39,274 reid_baseline.train INFO: Val Accuracy: 79.6% Mean Entropy: 186.8%
2022-04-11 23:45:56,383 reid_baseline.train INFO: normal accuracy 0.8639673754733469 1.5346310138702393 
2022-04-11 23:45:56,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-11 23:45:56,383 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 153.5%
2022-04-11 23:47:56,571 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.152, Acc: 0.984, Base Lr: 3.38e-03
2022-04-11 23:48:56,755 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.187[s] Speed: 13.5[samples/s]
2022-04-11 23:49:56,487 reid_baseline.train INFO: normal accuracy 0.7943230457310205 1.8351309299468994 
2022-04-11 23:49:57,308 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-11 23:49:57,308 reid_baseline.train INFO: Val Accuracy: 79.4% Mean Entropy: 183.5%
2022-04-11 23:50:14,764 reid_baseline.train INFO: normal accuracy 0.8638217302650743 1.4977221488952637 
2022-04-11 23:50:14,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-11 23:50:14,764 reid_baseline.train INFO: Train Accuracy: 86.4% Mean Entropy: 149.8%
2022-04-11 23:52:14,921 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.100, Acc: 0.987, Base Lr: 2.77e-03
2022-04-11 23:53:14,578 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.183[s] Speed: 13.5[samples/s]
2022-04-11 23:54:14,188 reid_baseline.train INFO: normal accuracy 0.7995043928812796 1.81253981590271 
2022-04-11 23:54:15,010 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-11 23:54:15,011 reid_baseline.train INFO: Val Accuracy: 80.0% Mean Entropy: 181.3%
2022-04-11 23:54:32,615 reid_baseline.train INFO: normal accuracy 0.8674628604718905 1.4685461521148682 
2022-04-11 23:54:32,615 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-11 23:54:32,615 reid_baseline.train INFO: Train Accuracy: 86.7% Mean Entropy: 146.9%
2022-04-11 23:56:33,064 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.092, Acc: 0.985, Base Lr: 2.20e-03
2022-04-11 23:57:35,044 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.200[s] Speed: 13.3[samples/s]
2022-04-11 23:58:35,416 reid_baseline.train INFO: normal accuracy 0.8028835323271007 1.7698134183883667 
2022-04-11 23:58:36,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-11 23:58:36,227 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 177.0%
2022-04-11 23:58:53,834 reid_baseline.train INFO: normal accuracy 0.8699388290125255 1.419043779373169 
2022-04-11 23:58:53,834 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-11 23:58:53,834 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 141.9%
2022-04-12 00:00:53,177 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.063, Acc: 0.991, Base Lr: 1.66e-03
2022-04-12 00:01:54,038 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.186[s] Speed: 13.5[samples/s]
2022-04-12 00:02:54,302 reid_baseline.train INFO: normal accuracy 0.802658256364046 1.7461754083633423 
2022-04-12 00:02:55,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 00:02:55,158 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 174.6%
2022-04-12 00:03:12,485 reid_baseline.train INFO: normal accuracy 0.8697931838042529 1.395702600479126 
2022-04-12 00:03:12,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-12 00:03:12,485 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 139.6%
2022-04-12 00:05:12,229 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.064, Acc: 0.991, Base Lr: 1.19e-03
2022-04-12 00:06:12,309 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.183[s] Speed: 13.5[samples/s]
2022-04-12 00:07:13,384 reid_baseline.train INFO: normal accuracy 0.8033340842532102 1.8051059246063232 
2022-04-12 00:07:13,385 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 00:07:13,385 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 180.5%
2022-04-12 00:07:30,629 reid_baseline.train INFO: normal accuracy 0.8702301194290708 1.448071837425232 
2022-04-12 00:07:30,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-12 00:07:30,629 reid_baseline.train INFO: Train Accuracy: 87.0% Mean Entropy: 144.8%
2022-04-12 00:09:30,059 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.065, Acc: 0.993, Base Lr: 7.78e-04
2022-04-12 00:10:30,192 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.181[s] Speed: 13.5[samples/s]
2022-04-12 00:11:29,955 reid_baseline.train INFO: normal accuracy 0.8001802207704438 1.8303099870681763 
2022-04-12 00:11:29,955 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 00:11:29,955 reid_baseline.train INFO: Val Accuracy: 80.0% Mean Entropy: 183.0%
2022-04-12 00:11:48,118 reid_baseline.train INFO: normal accuracy 0.868482376929799 1.4736881256103516 
2022-04-12 00:11:48,119 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-12 00:11:48,119 reid_baseline.train INFO: Train Accuracy: 86.8% Mean Entropy: 147.4%
2022-04-12 00:13:48,006 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.051, Acc: 0.988, Base Lr: 4.51e-04
2022-04-12 00:14:48,563 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.187[s] Speed: 13.5[samples/s]
2022-04-12 00:15:47,815 reid_baseline.train INFO: normal accuracy 0.7974769092137869 1.757079839706421 
2022-04-12 00:15:47,816 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 00:15:47,816 reid_baseline.train INFO: Val Accuracy: 79.7% Mean Entropy: 175.7%
2022-04-12 00:16:05,794 reid_baseline.train INFO: normal accuracy 0.8668802796387999 1.4033235311508179 
2022-04-12 00:16:05,794 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-12 00:16:05,794 reid_baseline.train INFO: Train Accuracy: 86.7% Mean Entropy: 140.3%
2022-04-12 00:18:05,700 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.063, Acc: 0.993, Base Lr: 2.11e-04
2022-04-12 00:19:05,890 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.185[s] Speed: 13.5[samples/s]
2022-04-12 00:20:06,456 reid_baseline.train INFO: normal accuracy 0.800856048659608 1.759837031364441 
2022-04-12 00:20:06,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 00:20:06,456 reid_baseline.train INFO: Val Accuracy: 80.1% Mean Entropy: 176.0%
2022-04-12 00:20:24,061 reid_baseline.train INFO: normal accuracy 0.8692106029711623 1.4042547941207886 
2022-04-12 00:20:24,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-12 00:20:24,061 reid_baseline.train INFO: Train Accuracy: 86.9% Mean Entropy: 140.4%
2022-04-12 00:22:24,643 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.057, Acc: 0.991, Base Lr: 6.51e-05
2022-04-12 00:23:25,651 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.195[s] Speed: 13.4[samples/s]
2022-04-12 00:24:25,281 reid_baseline.train INFO: normal accuracy 0.8033340842532102 1.7827908992767334 
2022-04-12 00:24:25,282 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 00:24:25,282 reid_baseline.train INFO: Val Accuracy: 80.3% Mean Entropy: 178.3%
2022-04-12 00:24:43,178 reid_baseline.train INFO: normal accuracy 0.8706670550538887 1.4259281158447266 
2022-04-12 00:24:43,179 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-12 00:24:43,179 reid_baseline.train INFO: Train Accuracy: 87.1% Mean Entropy: 142.6%
2022-04-12 00:26:44,071 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.061, Acc: 0.988, Base Lr: 1.60e-05
2022-04-12 00:27:44,912 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.196[s] Speed: 13.4[samples/s]
2022-04-12 00:28:45,959 reid_baseline.train INFO: normal accuracy 0.8044604640684839 1.7481834888458252 
2022-04-12 00:28:45,959 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 00:28:45,959 reid_baseline.train INFO: Val Accuracy: 80.4% Mean Entropy: 174.8%
2022-04-12 00:29:03,630 reid_baseline.train INFO: normal accuracy 0.8715409263035246 1.3954236507415771 
2022-04-12 00:29:03,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-12 00:29:03,631 reid_baseline.train INFO: Train Accuracy: 87.2% Mean Entropy: 139.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product_patch_aug5_feature_mixup_logits/transformer_best_model.pth
2022-04-12 00:30:04,134 reid_baseline.train INFO: normal accuracy 0.802658256364046 1.7461754083633423 
2022-04-12 00:30:04,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 00:30:04,135 reid_baseline.train INFO: Accuracy: 80.3%
2022-04-12 00:30:21,646 reid_baseline.train INFO: normal accuracy 0.8697931838042529 1.395702600479126 
2022-04-12 00:30:21,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-12 00:30:21,647 reid_baseline.train INFO: Train Accuracy: 87.0%
2022-04-12 00:30:26,459 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits
2022-04-12 00:30:26,459 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, augs=False, freeze_4=False, freeze_MHSA=False, preload_path=None, feature_mixup=False, aug_type=None, feature_model_path='../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth', num_patch_wise=5, layer_num=11, only_classifier=False)
2022-04-12 00:30:26,459 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-12 00:30:26,459 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-12 00:30:26,460 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2Real_World_patch_aug5_feature_mixup_logits
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
1 1
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Real_World_augs/transformer_best_model.pth
patch wise training
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_only_classifier/transformer_best_model.pth
2022-04-12 00:30:36,880 reid_baseline.train INFO: start training
2022-04-12 00:32:39,526 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 5.727, Acc: 0.367, Base Lr: 8.72e-04
2022-04-12 00:33:42,989 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.220[s] Speed: 13.1[samples/s]
2022-04-12 00:36:11,862 reid_baseline.train INFO: normal accuracy 0.6366766123479458 4.169925212860107 
2022-04-12 00:36:12,637 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 00:36:12,637 reid_baseline.train INFO: Val Accuracy: 63.7% Mean Entropy: 417.0%
2022-04-12 00:36:29,876 reid_baseline.train INFO: normal accuracy 0.6807193396226415 4.169206142425537 
2022-04-12 00:36:29,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-12 00:36:29,876 reid_baseline.train INFO: Train Accuracy: 68.1% Mean Entropy: 416.9%
2022-04-12 00:38:32,180 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.985, Acc: 0.722, Base Lr: 1.66e-03
2022-04-12 00:39:34,372 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.214[s] Speed: 13.2[samples/s]
2022-04-12 00:42:02,179 reid_baseline.train INFO: normal accuracy 0.6669726876291026 4.112787246704102 
2022-04-12 00:42:02,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 00:42:02,983 reid_baseline.train INFO: Val Accuracy: 66.7% Mean Entropy: 411.3%
2022-04-12 00:42:20,263 reid_baseline.train INFO: normal accuracy 0.7118219339622641 4.0972723960876465 
2022-04-12 00:42:20,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-12 00:42:20,264 reid_baseline.train INFO: Train Accuracy: 71.2% Mean Entropy: 409.7%
2022-04-12 00:44:21,370 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.889, Acc: 0.757, Base Lr: 2.46e-03
2022-04-12 00:45:22,058 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.196[s] Speed: 13.4[samples/s]
2022-04-12 00:47:48,444 reid_baseline.train INFO: normal accuracy 0.6867110397062198 3.7704215049743652 
2022-04-12 00:47:49,271 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 00:47:49,272 reid_baseline.train INFO: Val Accuracy: 68.7% Mean Entropy: 377.0%
2022-04-12 00:48:06,381 reid_baseline.train INFO: normal accuracy 0.7286261792452831 3.6968424320220947 
2022-04-12 00:48:06,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-12 00:48:06,382 reid_baseline.train INFO: Train Accuracy: 72.9% Mean Entropy: 369.7%
2022-04-12 00:50:36,073 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.731, Acc: 0.784, Base Lr: 3.25e-03
2022-04-12 00:52:25,030 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.702[s] Speed: 9.4[samples/s]
2022-04-12 00:54:59,056 reid_baseline.train INFO: normal accuracy 0.7411062657792059 3.0443382263183594 
2022-04-12 00:54:59,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 00:54:59,990 reid_baseline.train INFO: Val Accuracy: 74.1% Mean Entropy: 304.4%
2022-04-12 00:55:24,587 reid_baseline.train INFO: normal accuracy 0.7816922169811321 2.9177398681640625 
2022-04-12 00:55:24,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-12 00:55:24,588 reid_baseline.train INFO: Train Accuracy: 78.2% Mean Entropy: 291.8%
2022-04-12 01:00:41,132 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.024, Acc: 0.854, Base Lr: 4.04e-03
2022-04-12 01:03:20,246 reid_baseline.train INFO: Epoch 5 done. Time per batch: 3.129[s] Speed: 5.1[samples/s]
2022-04-12 01:06:00,377 reid_baseline.train INFO: normal accuracy 0.798944227679596 2.4652109146118164 
2022-04-12 01:06:01,240 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 01:06:01,240 reid_baseline.train INFO: Val Accuracy: 79.9% Mean Entropy: 246.5%
2022-04-12 01:06:26,342 reid_baseline.train INFO: normal accuracy 0.8369693396226415 2.305011749267578 
2022-04-12 01:06:26,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-12 01:06:26,343 reid_baseline.train INFO: Train Accuracy: 83.7% Mean Entropy: 230.5%
2022-04-12 01:11:37,925 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.647, Acc: 0.898, Base Lr: 4.83e-03
2022-04-12 01:14:19,616 reid_baseline.train INFO: Epoch 6 done. Time per batch: 3.114[s] Speed: 5.1[samples/s]
2022-04-12 01:17:14,211 reid_baseline.train INFO: normal accuracy 0.8255680514115217 2.1200366020202637 
2022-04-12 01:17:15,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 01:17:15,213 reid_baseline.train INFO: Val Accuracy: 82.6% Mean Entropy: 212.0%
2022-04-12 01:17:40,704 reid_baseline.train INFO: normal accuracy 0.8682193396226415 1.9464157819747925 
2022-04-12 01:17:40,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-12 01:17:40,704 reid_baseline.train INFO: Train Accuracy: 86.8% Mean Entropy: 194.6%
2022-04-12 01:23:07,354 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.447, Acc: 0.932, Base Lr: 5.62e-03
2022-04-12 01:25:51,881 reid_baseline.train INFO: Epoch 7 done. Time per batch: 3.231[s] Speed: 5.0[samples/s]
2022-04-12 01:28:50,916 reid_baseline.train INFO: normal accuracy 0.8372733532246959 1.8970988988876343 
2022-04-12 01:28:51,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 01:28:51,805 reid_baseline.train INFO: Val Accuracy: 83.7% Mean Entropy: 189.7%
2022-04-12 01:29:17,349 reid_baseline.train INFO: normal accuracy 0.8819280660377359 1.709201455116272 
2022-04-12 01:29:17,349 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-12 01:29:17,350 reid_baseline.train INFO: Train Accuracy: 88.2% Mean Entropy: 170.9%
2022-04-12 01:34:41,746 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.326, Acc: 0.951, Base Lr: 6.42e-03
2022-04-12 01:37:26,905 reid_baseline.train INFO: Epoch 8 done. Time per batch: 3.220[s] Speed: 5.0[samples/s]
2022-04-12 01:40:25,282 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.699792504310608 
2022-04-12 01:40:26,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 01:40:26,179 reid_baseline.train INFO: Val Accuracy: 84.1% Mean Entropy: 170.0%
2022-04-12 01:40:51,111 reid_baseline.train INFO: normal accuracy 0.8884139150943396 1.49249267578125 
2022-04-12 01:40:51,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-12 01:40:51,111 reid_baseline.train INFO: Train Accuracy: 88.8% Mean Entropy: 149.2%
2022-04-12 01:46:11,149 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.235, Acc: 0.968, Base Lr: 7.21e-03
2022-04-12 01:48:52,312 reid_baseline.train INFO: Epoch 9 done. Time per batch: 3.166[s] Speed: 5.1[samples/s]
2022-04-12 01:51:48,693 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.599646806716919 
2022-04-12 01:51:49,563 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 01:51:49,563 reid_baseline.train INFO: Val Accuracy: 84.1% Mean Entropy: 160.0%
2022-04-12 01:52:14,678 reid_baseline.train INFO: normal accuracy 0.8920990566037735 1.3627532720565796 
2022-04-12 01:52:14,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-12 01:52:14,679 reid_baseline.train INFO: Train Accuracy: 89.2% Mean Entropy: 136.3%
2022-04-12 01:57:36,779 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.172, Acc: 0.977, Base Lr: 4.01e-03
2022-04-12 02:00:20,686 reid_baseline.train INFO: Epoch 10 done. Time per batch: 3.197[s] Speed: 5.0[samples/s]
2022-04-12 02:03:18,316 reid_baseline.train INFO: normal accuracy 0.8436997934358503 1.6142574548721313 
2022-04-12 02:03:18,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 02:03:18,319 reid_baseline.train INFO: Val Accuracy: 84.4% Mean Entropy: 161.4%
2022-04-12 02:03:43,808 reid_baseline.train INFO: normal accuracy 0.8954893867924528 1.368246078491211 
2022-04-12 02:03:43,808 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-12 02:03:43,808 reid_baseline.train INFO: Train Accuracy: 89.5% Mean Entropy: 136.8%
2022-04-12 02:09:02,756 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.152, Acc: 0.984, Base Lr: 3.38e-03
2022-04-12 02:11:44,825 reid_baseline.train INFO: Epoch 11 done. Time per batch: 3.165[s] Speed: 5.1[samples/s]
2022-04-12 02:14:42,218 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.58810293674469 
2022-04-12 02:14:43,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 02:14:43,137 reid_baseline.train INFO: Val Accuracy: 84.3% Mean Entropy: 158.8%
2022-04-12 02:15:08,269 reid_baseline.train INFO: normal accuracy 0.8962264150943396 1.3348854780197144 
2022-04-12 02:15:08,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-12 02:15:08,270 reid_baseline.train INFO: Train Accuracy: 89.6% Mean Entropy: 133.5%
