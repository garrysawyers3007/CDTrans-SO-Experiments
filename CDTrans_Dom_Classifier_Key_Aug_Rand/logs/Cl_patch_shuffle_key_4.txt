2022-04-15 16:13:54,776 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
2022-04-15 16:13:54,776 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-15 16:13:54,776 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 16:13:54,777 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 16:13:54,777 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 16:13:58,460 reid_baseline.train INFO: start training
2022-04-15 16:14:07,250 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.258, Base Lr: 4.76e-04
2022-04-15 16:14:15,348 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.388, Base Lr: 4.76e-04
2022-04-15 16:14:21,402 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.084[s] Speed: 190.7[samples/s]
2022-04-15 16:14:28,906 reid_baseline.train INFO: normal accuracy 0.48866913885455293 4.170638084411621 
2022-04-15 16:14:32,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 16:14:32,020 reid_baseline.train INFO: Accuracy: 48.9% Mean Entropy: 417.1%
2022-04-15 16:14:40,736 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.606, Base Lr: 8.72e-04
2022-04-15 16:14:48,833 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.667, Acc: 0.610, Base Lr: 8.72e-04
2022-04-15 16:14:54,809 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.083[s] Speed: 191.7[samples/s]
2022-04-15 16:15:02,358 reid_baseline.train INFO: normal accuracy 0.519159456118665 4.142978668212891 
2022-04-15 16:15:05,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 16:15:05,515 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 414.3%
2022-04-15 16:15:14,293 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.144, Acc: 0.623, Base Lr: 1.27e-03
2022-04-15 16:15:22,439 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.007, Acc: 0.628, Base Lr: 1.27e-03
2022-04-15 16:15:28,479 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.084[s] Speed: 190.3[samples/s]
2022-04-15 16:15:35,990 reid_baseline.train INFO: normal accuracy 0.5512978986402967 3.9838550090789795 
2022-04-15 16:15:39,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 16:15:39,982 reid_baseline.train INFO: Accuracy: 55.1% Mean Entropy: 398.4%
2022-04-15 16:15:48,729 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.382, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 16:15:56,870 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.310, Acc: 0.680, Base Lr: 1.66e-03
2022-04-15 16:16:02,912 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.084[s] Speed: 190.6[samples/s]
2022-04-15 16:16:10,510 reid_baseline.train INFO: normal accuracy 0.6444169756901524 3.630953073501587 
2022-04-15 16:16:13,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 16:16:13,606 reid_baseline.train INFO: Accuracy: 64.4% Mean Entropy: 363.1%
2022-04-15 16:16:22,391 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.905, Acc: 0.728, Base Lr: 2.06e-03
2022-04-15 16:16:30,539 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.826, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 16:16:36,565 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.084[s] Speed: 190.3[samples/s]
2022-04-15 16:16:44,215 reid_baseline.train INFO: normal accuracy 0.6893283889575608 3.20501971244812 
2022-04-15 16:16:47,342 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 16:16:47,342 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 320.5%
2022-04-15 16:16:56,155 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.607, Acc: 0.780, Base Lr: 2.46e-03
2022-04-15 16:17:04,341 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.794, Base Lr: 2.46e-03
2022-04-15 16:17:10,384 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.084[s] Speed: 189.6[samples/s]
2022-04-15 16:17:17,961 reid_baseline.train INFO: normal accuracy 0.7041615162752369 2.913018226623535 
2022-04-15 16:17:21,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 16:17:21,692 reid_baseline.train INFO: Accuracy: 70.4% Mean Entropy: 291.3%
2022-04-15 16:17:30,459 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.362, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 16:17:38,603 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.359, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 16:17:44,616 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.084[s] Speed: 190.6[samples/s]
2022-04-15 16:17:52,260 reid_baseline.train INFO: normal accuracy 0.7268232385661311 2.6735424995422363 
2022-04-15 16:17:55,416 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 16:17:55,417 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 267.4%
2022-04-15 16:18:04,368 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.243, Acc: 0.873, Base Lr: 3.25e-03
2022-04-15 16:18:16,282 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.249, Acc: 0.865, Base Lr: 3.25e-03
2022-04-15 16:18:28,356 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.121[s] Speed: 132.6[samples/s]
2022-04-15 16:18:40,348 reid_baseline.train INFO: normal accuracy 0.7338277709105891 2.504298210144043 
2022-04-15 16:18:43,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 16:18:43,514 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 250.4%
2022-04-15 16:18:59,332 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.189, Acc: 0.881, Base Lr: 3.64e-03
2022-04-15 16:19:14,630 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.887, Base Lr: 3.64e-03
2022-04-15 16:19:26,763 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.158[s] Speed: 101.0[samples/s]
2022-04-15 16:19:38,717 reid_baseline.train INFO: normal accuracy 0.7391841779975278 2.34719181060791 
2022-04-15 16:19:41,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 16:19:41,874 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 234.7%
2022-04-15 16:19:57,707 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.111, Acc: 0.905, Base Lr: 4.04e-03
2022-04-15 16:20:13,770 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.118, Acc: 0.904, Base Lr: 4.04e-03
2022-04-15 16:20:25,883 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.161[s] Speed: 99.3[samples/s]
2022-04-15 16:20:41,085 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.1729114055633545 
2022-04-15 16:20:44,233 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 16:20:44,234 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 217.3%
2022-04-15 16:20:59,533 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.081, Acc: 0.911, Base Lr: 4.44e-03
2022-04-15 16:21:15,541 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.075, Acc: 0.915, Base Lr: 4.44e-03
2022-04-15 16:21:27,618 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.159[s] Speed: 100.7[samples/s]
2022-04-15 16:21:39,633 reid_baseline.train INFO: normal accuracy 0.746188710341986 2.1483824253082275 
2022-04-15 16:21:42,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 16:21:42,717 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 214.8%
2022-04-15 16:21:57,795 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.004, Acc: 0.940, Base Lr: 4.83e-03
2022-04-15 16:22:14,455 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.015, Acc: 0.933, Base Lr: 4.83e-03
2022-04-15 16:22:26,535 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.160[s] Speed: 99.7[samples/s]
2022-04-15 16:22:38,534 reid_baseline.train INFO: normal accuracy 0.7478368355995055 2.0692527294158936 
2022-04-15 16:22:41,621 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 16:22:41,621 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 206.9%
2022-04-15 16:22:57,075 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.994, Acc: 0.943, Base Lr: 5.23e-03
2022-04-15 16:23:13,466 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.990, Acc: 0.945, Base Lr: 5.23e-03
2022-04-15 16:23:25,505 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.161[s] Speed: 99.6[samples/s]
2022-04-15 16:23:37,570 reid_baseline.train INFO: normal accuracy 0.7536052740008241 2.000689744949341 
2022-04-15 16:23:40,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 16:23:40,691 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 200.1%
2022-04-15 16:23:55,671 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.969, Acc: 0.945, Base Lr: 5.62e-03
2022-04-15 16:24:11,358 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.962, Acc: 0.949, Base Lr: 5.62e-03
2022-04-15 16:24:23,438 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.157[s] Speed: 102.2[samples/s]
2022-04-15 16:24:35,406 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9856207370758057 
2022-04-15 16:24:38,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 16:24:38,507 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 198.6%
2022-04-15 16:24:53,200 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.932, Acc: 0.956, Base Lr: 6.02e-03
2022-04-15 16:25:10,706 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.939, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 16:25:22,767 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 16:25:34,929 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.8863422870635986 
2022-04-15 16:25:38,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 16:25:38,060 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 188.6%
2022-04-15 16:25:53,845 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.917, Acc: 0.961, Base Lr: 6.42e-03
2022-04-15 16:26:09,868 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.918, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 16:26:21,943 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.161[s] Speed: 99.6[samples/s]
2022-04-15 16:26:33,993 reid_baseline.train INFO: normal accuracy 0.7490729295426453 2.0477654933929443 
2022-04-15 16:26:33,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 16:26:33,994 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 204.8%
2022-04-15 16:26:49,993 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.899, Acc: 0.967, Base Lr: 6.81e-03
2022-04-15 16:27:04,376 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.907, Acc: 0.962, Base Lr: 6.81e-03
2022-04-15 16:27:16,494 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.156[s] Speed: 102.8[samples/s]
2022-04-15 16:27:28,722 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9162954092025757 
2022-04-15 16:27:28,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 16:27:28,722 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 191.6%
2022-04-15 16:27:42,369 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.889, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 16:27:57,052 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.897, Acc: 0.963, Base Lr: 7.21e-03
2022-04-15 16:28:09,174 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.148[s] Speed: 108.0[samples/s]
2022-04-15 16:28:21,212 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.9280353784561157 
2022-04-15 16:28:21,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 16:28:21,213 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 192.8%
2022-04-15 16:28:38,387 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.973, Base Lr: 7.60e-03
2022-04-15 16:28:52,784 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.884, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 16:29:03,819 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.156[s] Speed: 102.5[samples/s]
2022-04-15 16:29:15,799 reid_baseline.train INFO: normal accuracy 0.7523691800576844 1.9233462810516357 
2022-04-15 16:29:15,802 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 16:29:15,802 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 192.3%
2022-04-15 16:29:32,905 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.879, Acc: 0.966, Base Lr: 4.01e-03
2022-04-15 16:29:47,957 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.867, Acc: 0.973, Base Lr: 4.01e-03
2022-04-15 16:29:58,186 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.155[s] Speed: 103.1[samples/s]
2022-04-15 16:30:14,608 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.9844993352890015 
2022-04-15 16:30:14,610 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 16:30:14,610 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 198.4%
2022-04-15 16:30:31,807 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.979, Base Lr: 3.69e-03
2022-04-15 16:30:46,830 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.852, Acc: 0.976, Base Lr: 3.69e-03
2022-04-15 16:30:57,098 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.156[s] Speed: 102.8[samples/s]
2022-04-15 16:31:09,076 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9705103635787964 
2022-04-15 16:31:09,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 16:31:09,078 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 197.1%
2022-04-15 16:31:26,276 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 16:31:41,063 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.844, Acc: 0.980, Base Lr: 3.38e-03
2022-04-15 16:31:53,104 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.161[s] Speed: 99.2[samples/s]
2022-04-15 16:32:05,227 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9826667308807373 
2022-04-15 16:32:05,230 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 16:32:05,230 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 198.3%
2022-04-15 16:32:22,417 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.978, Base Lr: 3.08e-03
2022-04-15 16:32:37,169 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.843, Acc: 0.980, Base Lr: 3.08e-03
2022-04-15 16:32:47,900 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.156[s] Speed: 102.4[samples/s]
2022-04-15 16:33:00,030 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.9749962091445923 
2022-04-15 16:33:00,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 16:33:00,032 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 197.5%
2022-04-15 16:33:17,176 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.833, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 16:33:32,740 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.835, Acc: 0.982, Base Lr: 2.77e-03
2022-04-15 16:33:44,361 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-15 16:33:56,449 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.9671432971954346 
2022-04-15 16:33:56,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 16:33:56,451 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 196.7%
2022-04-15 16:34:13,602 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.840, Acc: 0.977, Base Lr: 2.48e-03
2022-04-15 16:34:29,051 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.837, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 16:34:40,669 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 16:34:52,799 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.9494531154632568 
2022-04-15 16:34:52,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 16:34:52,801 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 194.9%
2022-04-15 16:35:09,997 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.827, Acc: 0.982, Base Lr: 2.20e-03
2022-04-15 16:35:25,412 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.832, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 16:35:37,029 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 16:35:49,218 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.9646164178848267 
2022-04-15 16:35:49,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 16:35:49,220 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 196.5%
2022-04-15 16:36:06,448 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.835, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 16:36:21,676 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.837, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 16:36:33,242 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.161[s] Speed: 99.2[samples/s]
2022-04-15 16:36:46,381 reid_baseline.train INFO: normal accuracy 0.7437165224557066 2.006714105606079 
2022-04-15 16:36:46,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 16:36:46,384 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 200.7%
2022-04-15 16:37:03,515 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.830, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 16:37:19,948 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 16:37:28,100 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.153[s] Speed: 104.7[samples/s]
2022-04-15 16:37:40,222 reid_baseline.train INFO: normal accuracy 0.7482488669138855 2.0023539066314697 
2022-04-15 16:37:40,224 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 16:37:40,224 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 200.2%
2022-04-15 16:37:57,309 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.832, Acc: 0.978, Base Lr: 1.42e-03
2022-04-15 16:38:18,311 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.826, Acc: 0.980, Base Lr: 1.42e-03
2022-04-15 16:38:36,783 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-15 16:38:54,438 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.9663563966751099 
2022-04-15 16:38:54,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 16:38:54,443 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 196.6%
2022-04-15 16:39:21,023 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.831, Acc: 0.980, Base Lr: 1.19e-03
2022-04-15 16:39:46,907 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.824, Acc: 0.982, Base Lr: 1.19e-03
2022-04-15 16:40:04,118 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-15 16:40:25,414 reid_baseline.train INFO: normal accuracy 0.7515451174289246 1.957978367805481 
2022-04-15 16:40:25,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 16:40:25,419 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 195.8%
2022-04-15 16:40:52,032 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.819, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 16:41:17,896 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 9.72e-04
2022-04-15 16:41:36,504 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-15 16:41:53,616 reid_baseline.train INFO: normal accuracy 0.7453646477132262 2.0400428771972656 
2022-04-15 16:41:53,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 16:41:53,620 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 204.0%
2022-04-15 16:42:18,134 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.812, Acc: 0.986, Base Lr: 7.78e-04
2022-04-15 16:42:44,042 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.820, Acc: 0.981, Base Lr: 7.78e-04
2022-04-15 16:43:02,688 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 16:43:19,791 reid_baseline.train INFO: normal accuracy 0.7474248042851257 2.014876365661621 
2022-04-15 16:43:19,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 16:43:19,796 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 201.5%
2022-04-15 16:43:46,450 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.819, Acc: 0.983, Base Lr: 6.04e-04
2022-04-15 16:44:10,336 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.823, Acc: 0.981, Base Lr: 6.04e-04
2022-04-15 16:44:28,972 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-15 16:44:46,136 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.026153087615967 
2022-04-15 16:44:46,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 16:44:46,140 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 202.6%
2022-04-15 16:45:12,787 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.822, Acc: 0.977, Base Lr: 4.51e-04
2022-04-15 16:45:38,744 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.820, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 16:45:57,283 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.261[s] Speed: 61.4[samples/s]
2022-04-15 16:46:16,301 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.009185791015625 
2022-04-15 16:46:16,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 16:46:16,305 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 200.9%
2022-04-15 16:46:42,920 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.815, Acc: 0.980, Base Lr: 3.20e-04
2022-04-15 16:47:08,793 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.819, Acc: 0.981, Base Lr: 3.20e-04
2022-04-15 16:47:25,103 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-15 16:47:44,468 reid_baseline.train INFO: normal accuracy 0.7445405850844664 2.0291266441345215 
2022-04-15 16:47:44,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 16:47:44,471 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 202.9%
2022-04-15 16:48:09,081 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.810, Acc: 0.986, Base Lr: 2.11e-04
2022-04-15 16:48:34,956 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.811, Acc: 0.985, Base Lr: 2.11e-04
2022-04-15 16:48:53,418 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.253[s] Speed: 63.4[samples/s]
2022-04-15 16:49:10,914 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.9914435148239136 
2022-04-15 16:49:10,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 16:49:10,919 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 199.1%
2022-04-15 16:49:37,504 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.826, Acc: 0.979, Base Lr: 1.26e-04
2022-04-15 16:50:01,358 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.819, Acc: 0.984, Base Lr: 1.26e-04
2022-04-15 16:50:19,794 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-15 16:50:37,405 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.005283832550049 
2022-04-15 16:50:37,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 16:50:37,410 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 200.5%
2022-04-15 16:51:04,005 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.819, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 16:51:29,890 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.821, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 16:51:46,767 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.254[s] Speed: 63.0[samples/s]
2022-04-15 16:52:04,563 reid_baseline.train INFO: normal accuracy 0.7494849608570251 1.9981844425201416 
2022-04-15 16:52:04,567 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 16:52:04,568 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 199.8%
2022-04-15 16:52:31,159 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.815, Acc: 0.985, Base Lr: 2.83e-05
2022-04-15 16:52:57,113 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 16:53:15,541 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.260[s] Speed: 61.6[samples/s]
2022-04-15 16:53:33,222 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9914745092391968 
2022-04-15 16:53:33,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 16:53:33,227 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 199.1%
2022-04-15 16:53:57,920 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.826, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 16:54:23,811 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.818, Acc: 0.980, Base Lr: 1.60e-05
2022-04-15 16:54:42,222 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 16:55:02,587 reid_baseline.train INFO: normal accuracy 0.7478368355995055 2.021069288253784 
2022-04-15 16:55:02,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 16:55:02,592 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 202.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1/transformer_best_model.pth
2022-04-15 16:55:23,521 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.8863422870635986 
2022-04-15 16:55:23,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:55:23,522 reid_baseline.train INFO: Accuracy: 74.6%
2022-04-15 16:55:41,003 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.8863422870635986 
2022-04-15 16:55:41,003 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:55:41,003 reid_baseline.train INFO: Shuffled Accuracy: 74.6%
2022-04-15 16:56:07,803 reid_baseline.train INFO: normal accuracy 0.9690721649484536 0.6696273684501648 
2022-04-15 16:56:07,803 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:56:07,803 reid_baseline.train INFO: Source Clean Accuracy: 96.9%
2022-04-15 16:56:13,144 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
2022-04-15 16:56:13,144 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-15 16:56:13,144 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 16:56:13,145 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 16:56:13,145 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 16:56:23,218 reid_baseline.train INFO: start training
2022-04-15 16:56:50,321 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.258, Base Lr: 4.76e-04
2022-04-15 16:57:16,232 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.388, Base Lr: 4.76e-04
2022-04-15 16:57:35,087 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 16:58:09,483 reid_baseline.train INFO: normal accuracy 0.564838191416112 4.170404434204102 
2022-04-15 16:58:13,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 16:58:13,097 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 417.0%
2022-04-15 16:58:39,711 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.606, Base Lr: 8.72e-04
2022-04-15 16:59:05,435 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.667, Acc: 0.610, Base Lr: 8.72e-04
2022-04-15 16:59:24,374 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.261[s] Speed: 61.3[samples/s]
2022-04-15 16:59:59,327 reid_baseline.train INFO: normal accuracy 0.5861831535460179 4.136321544647217 
2022-04-15 17:00:03,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 17:00:03,906 reid_baseline.train INFO: Accuracy: 58.6% Mean Entropy: 413.6%
2022-04-15 17:00:30,303 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.144, Acc: 0.623, Base Lr: 1.27e-03
2022-04-15 17:00:56,240 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.007, Acc: 0.628, Base Lr: 1.27e-03
2022-04-15 17:01:15,213 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.261[s] Speed: 61.3[samples/s]
2022-04-15 17:01:50,765 reid_baseline.train INFO: normal accuracy 0.6203809960982327 3.9263741970062256 
2022-04-15 17:01:56,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 17:01:56,143 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 392.6%
2022-04-15 17:02:22,899 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.382, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 17:02:48,794 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.310, Acc: 0.680, Base Lr: 1.66e-03
2022-04-15 17:03:06,999 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.259[s] Speed: 61.7[samples/s]
2022-04-15 17:03:41,832 reid_baseline.train INFO: normal accuracy 0.7018590773467983 3.4693286418914795 
2022-04-15 17:03:44,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 17:03:44,941 reid_baseline.train INFO: Accuracy: 70.2% Mean Entropy: 346.9%
2022-04-15 17:04:11,606 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.905, Acc: 0.728, Base Lr: 2.06e-03
2022-04-15 17:04:36,847 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.826, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 17:04:56,215 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.261[s] Speed: 61.4[samples/s]
2022-04-15 17:05:30,613 reid_baseline.train INFO: normal accuracy 0.7493688317649759 2.974005937576294 
2022-04-15 17:05:35,115 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 17:05:35,115 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 297.4%
2022-04-15 17:05:59,211 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.607, Acc: 0.780, Base Lr: 2.46e-03
2022-04-15 17:06:23,656 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.794, Base Lr: 2.46e-03
2022-04-15 17:06:42,771 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.248[s] Speed: 64.6[samples/s]
2022-04-15 17:07:18,558 reid_baseline.train INFO: normal accuracy 0.7686481523984393 2.652357578277588 
2022-04-15 17:07:21,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 17:07:21,641 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 265.2%
2022-04-15 17:07:43,056 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.362, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 17:08:08,990 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.359, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 17:08:27,992 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-15 17:09:04,977 reid_baseline.train INFO: normal accuracy 0.7899931145283452 2.404620885848999 
2022-04-15 17:09:08,120 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 17:09:08,122 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 240.5%
2022-04-15 17:09:33,081 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.243, Acc: 0.873, Base Lr: 3.25e-03
2022-04-15 17:09:58,998 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.249, Acc: 0.865, Base Lr: 3.25e-03
2022-04-15 17:10:17,988 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.256[s] Speed: 62.6[samples/s]
2022-04-15 17:10:54,654 reid_baseline.train INFO: normal accuracy 0.7984851962359422 2.2424819469451904 
2022-04-15 17:10:57,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 17:10:57,814 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 224.2%
2022-04-15 17:11:23,575 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.189, Acc: 0.881, Base Lr: 3.64e-03
2022-04-15 17:11:49,524 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.887, Base Lr: 3.64e-03
2022-04-15 17:12:08,482 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.259[s] Speed: 61.9[samples/s]
2022-04-15 17:12:45,055 reid_baseline.train INFO: normal accuracy 0.803534542116135 2.0979745388031006 
2022-04-15 17:12:48,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 17:12:48,168 reid_baseline.train INFO: Accuracy: 80.4% Mean Entropy: 209.8%
2022-04-15 17:13:14,061 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.111, Acc: 0.905, Base Lr: 4.04e-03
2022-04-15 17:13:39,977 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.118, Acc: 0.904, Base Lr: 4.04e-03
2022-04-15 17:13:58,965 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.259[s] Speed: 61.8[samples/s]
2022-04-15 17:14:42,171 reid_baseline.train INFO: normal accuracy 0.8101904980491164 1.9367231130599976 
2022-04-15 17:14:45,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 17:14:45,286 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 193.7%
2022-04-15 17:15:09,953 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.081, Acc: 0.911, Base Lr: 4.44e-03
2022-04-15 17:15:35,872 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.075, Acc: 0.915, Base Lr: 4.44e-03
2022-04-15 17:15:54,377 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 17:16:35,475 reid_baseline.train INFO: normal accuracy 0.8072067936653661 1.9287868738174438 
2022-04-15 17:16:38,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 17:16:38,561 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 192.9%
2022-04-15 17:17:03,519 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.004, Acc: 0.940, Base Lr: 4.83e-03
2022-04-15 17:17:29,386 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.015, Acc: 0.933, Base Lr: 4.83e-03
2022-04-15 17:17:45,586 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-15 17:18:24,206 reid_baseline.train INFO: normal accuracy 0.8129446867110397 1.8522032499313354 
2022-04-15 17:18:27,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 17:18:27,354 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 185.2%
2022-04-15 17:18:52,239 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.994, Acc: 0.943, Base Lr: 5.23e-03
2022-04-15 17:19:18,125 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.990, Acc: 0.945, Base Lr: 5.23e-03
2022-04-15 17:19:35,095 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.248[s] Speed: 64.6[samples/s]
2022-04-15 17:20:14,251 reid_baseline.train INFO: normal accuracy 0.8120266238237319 1.802187204360962 
2022-04-15 17:20:17,385 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 17:20:17,385 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 180.2%
2022-04-15 17:20:42,303 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.969, Acc: 0.945, Base Lr: 5.62e-03
2022-04-15 17:21:06,227 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.962, Acc: 0.949, Base Lr: 5.62e-03
2022-04-15 17:21:25,188 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-15 17:22:03,187 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.7904666662216187 
2022-04-15 17:22:06,300 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 17:22:06,301 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 179.0%
2022-04-15 17:22:31,213 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.932, Acc: 0.956, Base Lr: 6.02e-03
2022-04-15 17:22:55,157 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.939, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 17:23:14,112 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-15 17:23:50,845 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.6836835145950317 
2022-04-15 17:23:54,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 17:23:54,656 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 168.4%
2022-04-15 17:24:18,760 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.917, Acc: 0.961, Base Lr: 6.42e-03
2022-04-15 17:24:42,256 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.918, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 17:25:01,266 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.244[s] Speed: 65.7[samples/s]
2022-04-15 17:25:43,651 reid_baseline.train INFO: normal accuracy 0.8138627495983475 1.8151837587356567 
2022-04-15 17:25:43,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 17:25:43,656 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 181.5%
2022-04-15 17:26:07,940 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.899, Acc: 0.967, Base Lr: 6.81e-03
2022-04-15 17:26:33,372 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.907, Acc: 0.962, Base Lr: 6.81e-03
2022-04-15 17:26:52,317 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-15 17:27:27,064 reid_baseline.train INFO: normal accuracy 0.8078953408308469 1.7073806524276733 
2022-04-15 17:27:27,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 17:27:27,068 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 170.7%
2022-04-15 17:27:52,450 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.889, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 17:28:16,626 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.897, Acc: 0.963, Base Lr: 7.21e-03
2022-04-15 17:28:35,581 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-15 17:29:08,374 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.6921327114105225 
2022-04-15 17:29:08,376 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 17:29:08,377 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 169.2%
2022-04-15 17:29:35,298 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.973, Base Lr: 7.60e-03
2022-04-15 17:29:57,929 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.884, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 17:30:16,944 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-15 17:30:48,751 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7143430709838867 
2022-04-15 17:30:48,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 17:30:48,754 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 171.4%
2022-04-15 17:31:15,932 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.879, Acc: 0.966, Base Lr: 4.01e-03
2022-04-15 17:31:40,303 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.867, Acc: 0.973, Base Lr: 4.01e-03
2022-04-15 17:31:57,166 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-15 17:32:32,854 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.7666627168655396 
2022-04-15 17:32:32,856 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 17:32:32,856 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 176.7%
2022-04-15 17:33:00,893 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.979, Base Lr: 3.69e-03
2022-04-15 17:33:26,486 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.852, Acc: 0.976, Base Lr: 3.69e-03
2022-04-15 17:33:44,663 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.263[s] Speed: 60.9[samples/s]
2022-04-15 17:34:19,719 reid_baseline.train INFO: normal accuracy 0.8056001836125775 1.7468575239181519 
2022-04-15 17:34:19,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 17:34:19,724 reid_baseline.train INFO: Accuracy: 80.6% Mean Entropy: 174.7%
2022-04-15 17:34:46,197 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 17:35:11,813 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.844, Acc: 0.980, Base Lr: 3.38e-03
2022-04-15 17:35:30,777 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-15 17:36:08,366 reid_baseline.train INFO: normal accuracy 0.8095019508836355 1.737892746925354 
2022-04-15 17:36:08,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 17:36:08,370 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 173.8%
2022-04-15 17:36:35,748 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.978, Base Lr: 3.08e-03
2022-04-15 17:37:01,652 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.843, Acc: 0.980, Base Lr: 3.08e-03
2022-04-15 17:37:20,621 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.264[s] Speed: 60.5[samples/s]
2022-04-15 17:38:02,347 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.7497044801712036 
2022-04-15 17:38:02,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 17:38:02,351 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 175.0%
2022-04-15 17:38:29,202 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.833, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 17:38:55,127 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.835, Acc: 0.982, Base Lr: 2.77e-03
2022-04-15 17:39:14,122 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.263[s] Speed: 60.9[samples/s]
2022-04-15 17:39:55,265 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7557320594787598 
2022-04-15 17:39:55,269 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 17:39:55,269 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 175.6%
2022-04-15 17:40:21,934 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.840, Acc: 0.977, Base Lr: 2.48e-03
2022-04-15 17:40:47,831 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.837, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 17:41:06,775 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.262[s] Speed: 61.2[samples/s]
2022-04-15 17:41:49,343 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.7125718593597412 
2022-04-15 17:41:49,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 17:41:49,348 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 171.3%
2022-04-15 17:42:14,036 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.827, Acc: 0.982, Base Lr: 2.20e-03
2022-04-15 17:42:39,904 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.832, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 17:42:58,904 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.255[s] Speed: 62.9[samples/s]
2022-04-15 17:43:43,974 reid_baseline.train INFO: normal accuracy 0.8136332338765205 1.725117802619934 
2022-04-15 17:43:43,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 17:43:43,979 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 172.5%
2022-04-15 17:44:10,349 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.835, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 17:44:36,225 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.837, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 17:44:53,121 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-15 17:45:32,299 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.7715246677398682 
2022-04-15 17:45:32,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 17:45:32,304 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 177.2%
2022-04-15 17:45:58,633 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.830, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 17:46:24,525 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 17:46:41,490 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-15 17:47:19,585 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.754088044166565 
2022-04-15 17:47:19,589 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 17:47:19,589 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 175.4%
2022-04-15 17:47:45,975 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.832, Acc: 0.978, Base Lr: 1.42e-03
2022-04-15 17:48:11,876 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.826, Acc: 0.980, Base Lr: 1.42e-03
2022-04-15 17:48:28,694 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 17:49:08,577 reid_baseline.train INFO: normal accuracy 0.8124856552673858 1.726388692855835 
2022-04-15 17:49:08,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 17:49:08,582 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 172.6%
2022-04-15 17:49:34,914 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.831, Acc: 0.980, Base Lr: 1.19e-03
2022-04-15 17:50:00,812 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.824, Acc: 0.982, Base Lr: 1.19e-03
2022-04-15 17:50:17,809 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-15 17:51:00,484 reid_baseline.train INFO: normal accuracy 0.8140922653201744 1.7202247381210327 
2022-04-15 17:51:00,489 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 17:51:00,489 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 172.0%
2022-04-15 17:51:27,255 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.819, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 17:51:50,982 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 9.72e-04
2022-04-15 17:52:09,444 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-15 17:52:49,044 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.805387020111084 
2022-04-15 17:52:49,049 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 17:52:49,049 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 180.5%
2022-04-15 17:53:15,722 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.812, Acc: 0.986, Base Lr: 7.78e-04
2022-04-15 17:53:39,626 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.820, Acc: 0.981, Base Lr: 7.78e-04
2022-04-15 17:53:58,005 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-15 17:54:37,390 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.7823511362075806 
2022-04-15 17:54:37,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 17:54:37,393 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 178.2%
2022-04-15 17:55:04,244 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.819, Acc: 0.983, Base Lr: 6.04e-04
2022-04-15 17:55:28,160 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.823, Acc: 0.981, Base Lr: 6.04e-04
2022-04-15 17:55:46,962 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.255[s] Speed: 62.9[samples/s]
2022-04-15 17:56:26,491 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7917732000350952 
2022-04-15 17:56:26,493 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 17:56:26,493 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 179.2%
2022-04-15 17:56:53,193 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.822, Acc: 0.977, Base Lr: 4.51e-04
2022-04-15 17:57:16,930 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.820, Acc: 0.981, Base Lr: 4.51e-04
2022-04-15 17:57:35,589 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 17:58:15,631 reid_baseline.train INFO: normal accuracy 0.8120266238237319 1.7673225402832031 
2022-04-15 17:58:15,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 17:58:15,636 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 176.7%
2022-04-15 17:58:42,306 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.815, Acc: 0.980, Base Lr: 3.20e-04
2022-04-15 17:59:06,171 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.819, Acc: 0.981, Base Lr: 3.20e-04
2022-04-15 17:59:24,338 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-15 18:00:04,550 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.792800784111023 
2022-04-15 18:00:04,555 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 18:00:04,555 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 179.3%
2022-04-15 18:00:31,293 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.810, Acc: 0.986, Base Lr: 2.11e-04
2022-04-15 18:00:55,017 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.811, Acc: 0.985, Base Lr: 2.11e-04
2022-04-15 18:01:12,954 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-15 18:02:08,308 reid_baseline.train INFO: normal accuracy 0.8120266238237319 1.7468903064727783 
2022-04-15 18:02:08,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 18:02:08,313 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 174.7%
2022-04-15 18:02:34,762 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.826, Acc: 0.979, Base Lr: 1.26e-04
2022-04-15 18:03:00,713 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.819, Acc: 0.984, Base Lr: 1.26e-04
2022-04-15 18:03:19,709 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.261[s] Speed: 61.2[samples/s]
2022-04-15 18:04:00,981 reid_baseline.train INFO: normal accuracy 0.8134037181546936 1.7605301141738892 
2022-04-15 18:04:00,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 18:04:00,983 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 176.1%
2022-04-15 18:04:27,807 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.819, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 18:04:53,689 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.821, Acc: 0.982, Base Lr: 6.51e-05
2022-04-15 18:05:12,531 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:05:53,001 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.7523475885391235 
2022-04-15 18:05:53,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 18:05:53,006 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 175.2%
2022-04-15 18:06:19,530 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.815, Acc: 0.985, Base Lr: 2.83e-05
2022-04-15 18:06:45,545 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 18:07:04,572 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:07:47,004 reid_baseline.train INFO: normal accuracy 0.8113380766582511 1.7470319271087646 
2022-04-15 18:07:47,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 18:07:47,007 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 174.7%
2022-04-15 18:08:13,856 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.826, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 18:08:39,810 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.818, Acc: 0.980, Base Lr: 1.60e-05
2022-04-15 18:08:58,774 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.262[s] Speed: 61.0[samples/s]
2022-04-15 18:09:42,599 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.7793446779251099 
2022-04-15 18:09:42,604 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 18:09:42,604 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 177.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1/transformer_best_model.pth
2022-04-15 18:10:19,046 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.6836835145950317 
2022-04-15 18:10:19,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:10:19,046 reid_baseline.train INFO: Accuracy: 80.9%
2022-04-15 18:10:53,055 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.6836835145950317 
2022-04-15 18:10:53,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:10:53,055 reid_baseline.train INFO: Shuffled Accuracy: 80.9%
2022-04-15 18:11:23,715 reid_baseline.train INFO: normal accuracy 0.9690721649484536 0.6696273684501648 
2022-04-15 18:11:23,715 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:11:23,715 reid_baseline.train INFO: Source Clean Accuracy: 96.9%
2022-04-15 18:11:26,555 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2
2022-04-15 18:11:26,556 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-15 18:11:26,556 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 18:11:26,556 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 18:11:26,556 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 18:11:36,795 reid_baseline.train INFO: start training
2022-04-15 18:12:03,977 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.130, Acc: 0.267, Base Lr: 4.76e-04
2022-04-15 18:12:29,947 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.077, Acc: 0.393, Base Lr: 4.76e-04
2022-04-15 18:12:42,226 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.238[s] Speed: 67.2[samples/s]
2022-04-15 18:13:00,134 reid_baseline.train INFO: normal accuracy 0.48825710754017304 4.170660018920898 
2022-04-15 18:13:03,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 18:13:03,541 reid_baseline.train INFO: Accuracy: 48.8% Mean Entropy: 417.1%
2022-04-15 18:13:29,886 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.610, Base Lr: 8.72e-04
2022-04-15 18:13:55,945 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.665, Acc: 0.609, Base Lr: 8.72e-04
2022-04-15 18:14:15,028 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:14:28,401 reid_baseline.train INFO: normal accuracy 0.5166872682323856 4.14261531829834 
2022-04-15 18:14:33,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 18:14:33,875 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 414.3%
2022-04-15 18:15:01,428 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.140, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 18:15:27,403 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.003, Acc: 0.634, Base Lr: 1.27e-03
2022-04-15 18:15:46,404 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.266[s] Speed: 60.2[samples/s]
2022-04-15 18:16:03,701 reid_baseline.train INFO: normal accuracy 0.5558302430984755 3.981259346008301 
2022-04-15 18:16:07,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 18:16:07,447 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 398.1%
2022-04-15 18:16:29,936 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.380, Acc: 0.691, Base Lr: 1.66e-03
2022-04-15 18:16:56,222 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.309, Acc: 0.682, Base Lr: 1.66e-03
2022-04-15 18:17:15,316 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.249[s] Speed: 64.4[samples/s]
2022-04-15 18:17:32,644 reid_baseline.train INFO: normal accuracy 0.6452410383189122 3.6288371086120605 
2022-04-15 18:17:35,742 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 18:17:35,742 reid_baseline.train INFO: Accuracy: 64.5% Mean Entropy: 362.9%
2022-04-15 18:18:00,650 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.898, Acc: 0.728, Base Lr: 2.06e-03
2022-04-15 18:18:23,146 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.823, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 18:18:42,117 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.243[s] Speed: 65.8[samples/s]
2022-04-15 18:18:59,502 reid_baseline.train INFO: normal accuracy 0.6918005768438401 3.193950653076172 
2022-04-15 18:19:02,613 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 18:19:02,613 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 319.4%
2022-04-15 18:19:29,264 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.603, Acc: 0.786, Base Lr: 2.46e-03
2022-04-15 18:19:52,116 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.794, Base Lr: 2.46e-03
2022-04-15 18:20:12,250 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-15 18:20:29,885 reid_baseline.train INFO: normal accuracy 0.7119901112484549 2.9105329513549805 
2022-04-15 18:20:34,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 18:20:34,482 reid_baseline.train INFO: Accuracy: 71.2% Mean Entropy: 291.1%
2022-04-15 18:21:00,652 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.361, Acc: 0.847, Base Lr: 2.85e-03
2022-04-15 18:21:27,688 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.356, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 18:21:47,145 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.266[s] Speed: 60.1[samples/s]
2022-04-15 18:22:01,726 reid_baseline.train INFO: normal accuracy 0.7268232385661311 2.6822614669799805 
2022-04-15 18:22:08,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 18:22:08,433 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 268.2%
2022-04-15 18:22:35,175 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.236, Acc: 0.881, Base Lr: 3.25e-03
2022-04-15 18:23:01,245 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.243, Acc: 0.874, Base Lr: 3.25e-03
2022-04-15 18:23:19,831 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.261[s] Speed: 61.2[samples/s]
2022-04-15 18:23:37,725 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.456686496734619 
2022-04-15 18:23:42,187 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 18:23:42,188 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 245.7%
2022-04-15 18:24:07,398 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.184, Acc: 0.883, Base Lr: 3.64e-03
2022-04-15 18:24:33,370 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.171, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 18:24:52,179 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.256[s] Speed: 62.4[samples/s]
2022-04-15 18:25:10,480 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.3405723571777344 
2022-04-15 18:25:16,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 18:25:16,796 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 234.1%
2022-04-15 18:25:42,629 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.109, Acc: 0.906, Base Lr: 4.04e-03
2022-04-15 18:26:06,825 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.114, Acc: 0.905, Base Lr: 4.04e-03
2022-04-15 18:26:25,611 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-15 18:26:46,521 reid_baseline.train INFO: normal accuracy 0.7449526163988464 2.187211513519287 
2022-04-15 18:26:53,069 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 18:26:53,070 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 218.7%
2022-04-15 18:27:19,868 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.081, Acc: 0.913, Base Lr: 4.44e-03
2022-04-15 18:27:43,492 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.073, Acc: 0.918, Base Lr: 4.44e-03
2022-04-15 18:28:02,313 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.254[s] Speed: 63.1[samples/s]
2022-04-15 18:28:20,547 reid_baseline.train INFO: normal accuracy 0.7544293366295839 2.1549692153930664 
2022-04-15 18:28:26,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 18:28:26,242 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 215.5%
2022-04-15 18:28:53,112 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.999, Acc: 0.941, Base Lr: 4.83e-03
2022-04-15 18:29:16,997 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.008, Acc: 0.935, Base Lr: 4.83e-03
2022-04-15 18:29:35,816 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.255[s] Speed: 62.8[samples/s]
2022-04-15 18:29:54,079 reid_baseline.train INFO: normal accuracy 0.7470127729707458 2.0529685020446777 
2022-04-15 18:29:59,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 18:29:59,313 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 205.3%
2022-04-15 18:30:26,083 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.998, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 18:30:52,068 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.991, Acc: 0.941, Base Lr: 5.23e-03
2022-04-15 18:31:08,370 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 18:31:26,636 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9960060119628906 
2022-04-15 18:31:32,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 18:31:32,828 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 199.6%
2022-04-15 18:31:59,596 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.966, Acc: 0.946, Base Lr: 5.62e-03
2022-04-15 18:32:25,565 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.964, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 18:32:44,324 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:33:04,827 reid_baseline.train INFO: normal accuracy 0.7503090234857849 1.9739482402801514 
2022-04-15 18:33:11,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 18:33:11,787 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 197.4%
2022-04-15 18:33:38,515 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.936, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 18:34:04,491 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.942, Acc: 0.951, Base Lr: 6.02e-03
2022-04-15 18:34:23,232 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:34:39,543 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.9104076623916626 
2022-04-15 18:34:46,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 18:34:46,969 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 191.0%
2022-04-15 18:35:13,719 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.919, Acc: 0.963, Base Lr: 6.42e-03
2022-04-15 18:35:39,682 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.916, Acc: 0.962, Base Lr: 6.42e-03
2022-04-15 18:35:58,444 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-15 18:36:16,023 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9644142389297485 
2022-04-15 18:36:16,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 18:36:16,024 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 196.4%
2022-04-15 18:36:44,834 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.898, Acc: 0.967, Base Lr: 6.81e-03
2022-04-15 18:37:10,880 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.906, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 18:37:29,953 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-04-15 18:37:47,580 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.9415422677993774 
2022-04-15 18:37:47,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 18:37:47,585 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 194.2%
2022-04-15 18:38:12,281 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.880, Acc: 0.969, Base Lr: 7.21e-03
2022-04-15 18:38:36,093 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.892, Acc: 0.967, Base Lr: 7.21e-03
2022-04-15 18:38:55,111 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.247[s] Speed: 64.7[samples/s]
2022-04-15 18:39:18,588 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.918190836906433 
2022-04-15 18:39:18,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 18:39:18,593 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 191.8%
2022-04-15 18:39:44,614 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.880, Acc: 0.971, Base Lr: 7.60e-03
2022-04-15 18:40:08,598 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 18:40:27,574 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-15 18:40:44,301 reid_baseline.train INFO: normal accuracy 0.7507210548001648 1.8723210096359253 
2022-04-15 18:40:47,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 18:40:47,718 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 187.2%
2022-04-15 18:41:12,931 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.876, Acc: 0.968, Base Lr: 4.01e-03
2022-04-15 18:41:38,997 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.869, Acc: 0.972, Base Lr: 4.01e-03
2022-04-15 18:41:58,081 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.258[s] Speed: 62.1[samples/s]
2022-04-15 18:42:22,128 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9391717910766602 
2022-04-15 18:42:22,133 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 18:42:22,133 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 193.9%
2022-04-15 18:42:46,854 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.849, Acc: 0.979, Base Lr: 3.69e-03
2022-04-15 18:43:12,764 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.851, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 18:43:31,773 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-15 18:43:48,651 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.937576413154602 
2022-04-15 18:43:48,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 18:43:48,656 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 193.8%
2022-04-15 18:44:13,416 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.844, Acc: 0.976, Base Lr: 3.38e-03
2022-04-15 18:44:39,438 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.844, Acc: 0.978, Base Lr: 3.38e-03
2022-04-15 18:44:58,544 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-15 18:45:15,550 reid_bas