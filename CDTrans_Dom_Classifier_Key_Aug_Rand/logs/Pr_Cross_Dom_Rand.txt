2022-05-06 13:36:58,073 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_small/office-home/Product_2_Art_shuffled_Cross_Domain_key_layer_rand
2022-05-06 13:36:58,073 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_small/office-home/Product_2_Art_shuffled_Cross_Domain_key_layer_rand', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_small_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=2)
2022-05-06 13:36:58,074 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-06 13:36:58,076 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-06 13:36:58,077 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_small_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_small/office-home/Product_2_Art_shuffled_Cross_Domain_key_layer_rand
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_small_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 384 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 384]) torch.Size([1, 197, 384])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-06 13:37:02,864 reid_baseline.train INFO: start training
2022-05-06 13:37:45,058 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.107, Acc: 0.371, Base Lr: 8.72e-04
2022-05-06 13:38:21,697 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 4.022, Acc: 0.494, Base Lr: 8.72e-04
2022-05-06 13:38:50,515 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-05-06 13:40:06,719 reid_baseline.train INFO: normal accuracy 0.511742892459827 4.164906024932861 
2022-05-06 13:40:39,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-06 13:40:39,978 reid_baseline.train INFO: Accuracy: 51.2% Mean Entropy: 416.5%
2022-05-06 13:41:19,446 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 3.476, Acc: 0.663, Base Lr: 1.66e-03
2022-05-06 13:41:56,106 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 3.297, Acc: 0.659, Base Lr: 1.66e-03
2022-05-06 13:42:23,332 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-05-06 13:43:21,381 reid_baseline.train INFO: normal accuracy 0.5084466419447878 3.9875400066375732 
2022-05-06 13:43:30,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-06 13:43:30,253 reid_baseline.train INFO: Accuracy: 50.8% Mean Entropy: 398.8%
2022-05-06 13:44:09,406 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 2.431, Acc: 0.675, Base Lr: 2.46e-03
2022-05-06 13:44:45,433 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 2.322, Acc: 0.680, Base Lr: 2.46e-03
2022-05-06 13:45:11,951 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-05-06 13:46:05,532 reid_baseline.train INFO: normal accuracy 0.5620107128141739 3.481909990310669 
2022-05-06 13:46:14,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-06 13:46:14,399 reid_baseline.train INFO: Accuracy: 56.2% Mean Entropy: 348.2%
2022-05-06 13:46:53,771 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.819, Acc: 0.744, Base Lr: 3.25e-03
2022-05-06 13:47:30,201 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 1.778, Acc: 0.746, Base Lr: 3.25e-03
2022-05-06 13:47:57,013 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.369[s] Speed: 43.3[samples/s]
2022-05-06 13:48:52,710 reid_baseline.train INFO: normal accuracy 0.6184590028842192 2.9798309803009033 
2022-05-06 13:49:02,075 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-06 13:49:02,076 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 298.0%
2022-05-06 13:49:42,674 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 1.536, Acc: 0.797, Base Lr: 4.04e-03
2022-05-06 13:50:18,467 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 1.490, Acc: 0.807, Base Lr: 4.04e-03
2022-05-06 13:50:45,781 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-05-06 13:51:34,677 reid_baseline.train INFO: normal accuracy 0.6505974454058508 2.664687395095825 
2022-05-06 13:51:43,546 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-06 13:51:43,546 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 266.5%
2022-05-06 13:52:22,880 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 1.361, Acc: 0.834, Base Lr: 4.83e-03
2022-05-06 13:52:59,602 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 1.332, Acc: 0.843, Base Lr: 4.83e-03
2022-05-06 13:53:26,333 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-05-06 13:54:16,420 reid_baseline.train INFO: normal accuracy 0.6551297898640297 2.394017219543457 
2022-05-06 13:54:25,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-06 13:54:25,337 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 239.4%
2022-05-06 13:55:04,629 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 1.249, Acc: 0.853, Base Lr: 5.62e-03
2022-05-06 13:55:40,516 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 1.253, Acc: 0.857, Base Lr: 5.62e-03
2022-05-06 13:56:06,994 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.366[s] Speed: 43.8[samples/s]
2022-05-06 13:56:54,368 reid_baseline.train INFO: normal accuracy 0.6567779151215493 2.260927200317383 
2022-05-06 13:57:03,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-06 13:57:03,264 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 226.1%
2022-05-06 13:57:41,798 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 1.182, Acc: 0.880, Base Lr: 6.42e-03
2022-05-06 13:58:17,650 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 1.180, Acc: 0.883, Base Lr: 6.42e-03
2022-05-06 13:58:44,631 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.365[s] Speed: 43.9[samples/s]
2022-05-06 13:59:37,520 reid_baseline.train INFO: normal accuracy 0.6604861969509682 2.1557350158691406 
2022-05-06 13:59:46,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-06 13:59:46,483 reid_baseline.train INFO: Accuracy: 66.0% Mean Entropy: 215.6%
2022-05-06 14:00:26,048 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 1.136, Acc: 0.899, Base Lr: 7.21e-03
2022-05-06 14:01:02,730 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 1.121, Acc: 0.900, Base Lr: 7.21e-03
2022-05-06 14:01:30,051 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-05-06 14:02:19,763 reid_baseline.train INFO: normal accuracy 0.657601977750309 2.0594475269317627 
2022-05-06 14:02:28,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-06 14:02:28,332 reid_baseline.train INFO: Accuracy: 65.8% Mean Entropy: 205.9%
2022-05-06 14:03:07,285 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 1.057, Acc: 0.922, Base Lr: 4.01e-03
2022-05-06 14:03:42,402 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 1.065, Acc: 0.917, Base Lr: 4.01e-03
2022-05-06 14:04:08,897 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-05-06 14:05:06,499 reid_baseline.train INFO: normal accuracy 0.6588380716934487 1.9198530912399292 
2022-05-06 14:05:15,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-06 14:05:15,481 reid_baseline.train INFO: Accuracy: 65.9% Mean Entropy: 192.0%
2022-05-06 14:05:54,718 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 1.031, Acc: 0.927, Base Lr: 3.38e-03
2022-05-06 14:06:30,890 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 1.029, Acc: 0.926, Base Lr: 3.38e-03
2022-05-06 14:06:57,997 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.369[s] Speed: 43.4[samples/s]
2022-05-06 14:07:46,990 reid_baseline.train INFO: normal accuracy 0.657601977750309 1.9608728885650635 
2022-05-06 14:07:46,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-06 14:07:46,990 reid_baseline.train INFO: Accuracy: 65.8% Mean Entropy: 196.1%
2022-05-06 14:08:27,555 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 1.029, Acc: 0.931, Base Lr: 2.77e-03
2022-05-06 14:09:02,952 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 1.034, Acc: 0.928, Base Lr: 2.77e-03
2022-05-06 14:09:29,952 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-05-06 14:10:21,030 reid_baseline.train INFO: normal accuracy 0.6683147919241862 1.871576189994812 
2022-05-06 14:10:29,787 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-06 14:10:29,788 reid_baseline.train INFO: Accuracy: 66.8% Mean Entropy: 187.2%
2022-05-06 14:11:09,365 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 1.017, Acc: 0.924, Base Lr: 2.20e-03
2022-05-06 14:11:45,564 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 1.017, Acc: 0.928, Base Lr: 2.20e-03
2022-05-06 14:12:12,190 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.368[s] Speed: 43.4[samples/s]
2022-05-06 14:13:01,094 reid_baseline.train INFO: normal accuracy 0.6707869798104656 1.8418139219284058 
2022-05-06 14:13:09,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-06 14:13:09,889 reid_baseline.train INFO: Accuracy: 67.1% Mean Entropy: 184.2%
2022-05-06 14:13:49,120 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.994, Acc: 0.926, Base Lr: 1.66e-03
2022-05-06 14:14:24,486 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.993, Acc: 0.930, Base Lr: 1.66e-03
2022-05-06 14:14:50,525 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-05-06 14:15:41,851 reid_baseline.train INFO: normal accuracy 0.6650185414091471 1.9982376098632812 
2022-05-06 14:15:41,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-06 14:15:41,851 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 199.8%
2022-05-06 14:16:20,741 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.973, Acc: 0.945, Base Lr: 1.19e-03
2022-05-06 14:16:57,059 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.980, Acc: 0.938, Base Lr: 1.19e-03
2022-05-06 14:17:23,997 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.367[s] Speed: 43.5[samples/s]
2022-05-06 14:18:11,923 reid_baseline.train INFO: normal accuracy 0.6650185414091471 1.9281560182571411 
2022-05-06 14:18:11,924 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-06 14:18:11,924 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 192.8%
2022-05-06 14:18:51,957 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.972, Acc: 0.947, Base Lr: 7.78e-04
2022-05-06 14:19:28,324 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.970, Acc: 0.947, Base Lr: 7.78e-04
2022-05-06 14:19:54,794 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-05-06 14:20:45,129 reid_baseline.train INFO: normal accuracy 0.665430572723527 1.884188175201416 
2022-05-06 14:20:45,130 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-06 14:20:45,130 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 188.4%
2022-05-06 14:21:25,116 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.969, Acc: 0.950, Base Lr: 4.51e-04
2022-05-06 14:22:00,893 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.963, Acc: 0.951, Base Lr: 4.51e-04
2022-05-06 14:22:28,411 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.372[s] Speed: 43.1[samples/s]
2022-05-06 14:23:18,182 reid_baseline.train INFO: normal accuracy 0.6670786979810466 1.9436144828796387 
2022-05-06 14:23:18,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-06 14:23:18,183 reid_baseline.train INFO: Accuracy: 66.7% Mean Entropy: 194.4%
2022-05-06 14:23:59,057 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.961, Acc: 0.944, Base Lr: 2.11e-04
2022-05-06 14:24:35,166 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.965, Acc: 0.945, Base Lr: 2.11e-04
2022-05-06 14:25:01,421 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.371[s] Speed: 43.1[samples/s]
2022-05-06 14:25:51,803 reid_baseline.train INFO: normal accuracy 0.669138854552946 1.9254629611968994 
2022-05-06 14:25:51,803 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-06 14:25:51,803 reid_baseline.train INFO: Accuracy: 66.9% Mean Entropy: 192.5%
2022-05-06 14:26:30,619 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.957, Acc: 0.949, Base Lr: 6.51e-05
2022-05-06 14:27:07,159 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.966, Acc: 0.946, Base Lr: 6.51e-05
2022-05-06 14:27:34,336 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.369[s] Speed: 43.4[samples/s]
2022-05-06 14:28:24,282 reid_baseline.train INFO: normal accuracy 0.6695508858673259 1.869189739227295 
2022-05-06 14:28:24,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-06 14:28:24,283 reid_baseline.train INFO: Accuracy: 67.0% Mean Entropy: 186.9%
2022-05-06 14:29:04,767 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.961, Acc: 0.949, Base Lr: 1.60e-05
2022-05-06 14:29:40,598 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.959, Acc: 0.950, Base Lr: 1.60e-05
2022-05-06 14:30:07,418 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.371[s] Speed: 43.1[samples/s]
2022-05-06 14:31:04,517 reid_baseline.train INFO: normal accuracy 0.6703749484960857 1.8709577322006226 
2022-05-06 14:31:04,518 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-06 14:31:04,518 reid_baseline.train INFO: Accuracy: 67.0% Mean Entropy: 187.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_small/office-home/Product_2_Art_shuffled_Cross_Domain_key_layer_rand/transformer_best_model.pth
2022-05-06 14:32:02,480 reid_baseline.train INFO: normal accuracy 0.6707869798104656 1.8418139219284058 
2022-05-06 14:32:02,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 14:32:02,481 reid_baseline.train INFO: Accuracy: 67.1%
2022-05-06 14:32:54,079 reid_baseline.train INFO: normal accuracy 0.6707869798104656 1.8418139219284058 
2022-05-06 14:32:54,079 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 14:32:54,080 reid_baseline.train INFO: Shuffled Accuracy: 67.1%
2022-05-06 14:34:05,015 reid_baseline.train INFO: normal accuracy 0.9794998873620184 0.7042968273162842 
2022-05-06 14:34:05,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 14:34:05,016 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
2022-05-06 14:34:10,008 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_small/office-home/Product_2_Clipart_shuffled_Cross_Domain_key_layer_rand
2022-05-06 14:34:10,008 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_small/office-home/Product_2_Clipart_shuffled_Cross_Domain_key_layer_rand', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_small_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=2)
2022-05-06 14:34:10,009 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-06 14:34:10,010 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-06 14:34:10,011 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_small_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_small/office-home/Product_2_Clipart_shuffled_Cross_Domain_key_layer_rand
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_small_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 384 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 384]) torch.Size([1, 197, 384])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-06 14:34:14,637 reid_baseline.train INFO: start training
2022-05-06 14:34:56,900 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.107, Acc: 0.371, Base Lr: 8.72e-04
2022-05-06 14:35:33,085 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 4.022, Acc: 0.494, Base Lr: 8.72e-04
2022-05-06 14:36:01,784 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.384[s] Speed: 41.6[samples/s]
2022-05-06 14:37:20,617 reid_baseline.train INFO: normal accuracy 0.41214203894616264 4.161876201629639 
2022-05-06 14:37:28,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-06 14:37:28,980 reid_baseline.train INFO: Accuracy: 41.2% Mean Entropy: 416.2%
2022-05-06 14:38:07,903 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 3.476, Acc: 0.663, Base Lr: 1.66e-03
2022-05-06 14:38:43,626 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 3.297, Acc: 0.659, Base Lr: 1.66e-03
2022-05-06 14:39:11,217 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.368[s] Speed: 43.5[samples/s]
2022-05-06 14:40:18,911 reid_baseline.train INFO: normal accuracy 0.4348224513172967 3.9567346572875977 
2022-05-06 14:40:27,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-06 14:40:27,228 reid_baseline.train INFO: Accuracy: 43.5% Mean Entropy: 395.7%
2022-05-06 14:41:05,730 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 2.431, Acc: 0.675, Base Lr: 2.46e-03
2022-05-06 14:41:42,290 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 2.322, Acc: 0.680, Base Lr: 2.46e-03
2022-05-06 14:42:08,718 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.365[s] Speed: 43.8[samples/s]
2022-05-06 14:43:16,993 reid_baseline.train INFO: normal accuracy 0.4746849942726231 3.3625001907348633 
2022-05-06 14:43:25,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-06 14:43:25,135 reid_baseline.train INFO: Accuracy: 47.5% Mean Entropy: 336.3%
2022-05-06 14:44:04,523 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.819, Acc: 0.744, Base Lr: 3.25e-03
2022-05-06 14:44:40,930 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 1.778, Acc: 0.745, Base Lr: 3.25e-03
2022-05-06 14:45:07,976 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-05-06 14:46:16,406 reid_baseline.train INFO: normal accuracy 0.5083619702176403 2.8280014991760254 
2022-05-06 14:46:24,455 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-06 14:46:24,456 reid_baseline.train INFO: Accuracy: 50.8% Mean Entropy: 282.8%
2022-05-06 14:47:05,984 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 1.536, Acc: 0.797, Base Lr: 4.04e-03
2022-05-06 14:47:42,218 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 1.490, Acc: 0.807, Base Lr: 4.04e-03
2022-05-06 14:48:09,651 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.378[s] Speed: 42.3[samples/s]
2022-05-06 14:49:12,487 reid_baseline.train INFO: normal accuracy 0.52737686139748 2.516343832015991 
2022-05-06 14:49:20,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-06 14:49:20,851 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 251.6%
2022-05-06 14:50:00,449 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 1.361, Acc: 0.833, Base Lr: 4.83e-03
2022-05-06 14:50:36,735 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 1.332, Acc: 0.843, Base Lr: 4.83e-03
2022-05-06 14:51:02,794 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.367[s] Speed: 43.6[samples/s]
2022-05-06 14:52:09,359 reid_baseline.train INFO: normal accuracy 0.5253150057273769 2.303920030593872 
2022-05-06 14:52:17,905 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-06 14:52:17,905 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 230.4%
2022-05-06 14:52:57,442 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 1.249, Acc: 0.853, Base Lr: 5.62e-03
2022-05-06 14:53:33,534 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 1.253, Acc: 0.856, Base Lr: 5.62e-03
2022-05-06 14:53:59,774 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-05-06 14:55:08,126 reid_baseline.train INFO: normal accuracy 0.5305841924398625 2.1730446815490723 
2022-05-06 14:55:16,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-06 14:55:16,103 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 217.3%
2022-05-06 14:55:54,846 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 1.182, Acc: 0.879, Base Lr: 6.42e-03
2022-05-06 14:56:30,230 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 1.180, Acc: 0.883, Base Lr: 6.42e-03
2022-05-06 14:56:57,478 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.365[s] Speed: 43.9[samples/s]
2022-05-06 14:57:59,015 reid_baseline.train INFO: normal accuracy 0.5232531500572738 2.104675531387329 
2022-05-06 14:58:06,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-06 14:58:06,857 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 210.5%
2022-05-06 14:58:45,479 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 1.136, Acc: 0.899, Base Lr: 7.21e-03
2022-05-06 14:59:22,245 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 1.121, Acc: 0.901, Base Lr: 7.21e-03
2022-05-06 14:59:50,252 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-05-06 15:00:58,039 reid_baseline.train INFO: normal accuracy 0.5390607101947308 2.045278310775757 
2022-05-06 15:01:05,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-06 15:01:05,940 reid_baseline.train INFO: Accuracy: 53.9% Mean Entropy: 204.5%
2022-05-06 15:01:44,947 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 1.057, Acc: 0.923, Base Lr: 4.01e-03
2022-05-06 15:02:20,411 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 1.065, Acc: 0.917, Base Lr: 4.01e-03
2022-05-06 15:02:46,959 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.363[s] Speed: 44.0[samples/s]
2022-05-06 15:03:59,643 reid_baseline.train INFO: normal accuracy 0.5390607101947308 1.8928108215332031 
2022-05-06 15:04:07,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-06 15:04:07,805 reid_baseline.train INFO: Accuracy: 53.9% Mean Entropy: 189.3%
2022-05-06 15:04:47,581 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 1.031, Acc: 0.927, Base Lr: 3.38e-03
2022-05-06 15:05:23,443 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 1.029, Acc: 0.926, Base Lr: 3.38e-03
2022-05-06 15:05:50,608 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-05-06 15:06:58,005 reid_baseline.train INFO: normal accuracy 0.5422680412371134 1.937227487564087 
2022-05-06 15:06:58,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-06 15:06:58,006 reid_baseline.train INFO: Accuracy: 54.2% Mean Entropy: 193.7%
2022-05-06 15:07:38,374 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 1.029, Acc: 0.930, Base Lr: 2.77e-03
2022-05-06 15:08:14,514 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 1.034, Acc: 0.926, Base Lr: 2.77e-03
2022-05-06 15:08:40,982 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-05-06 15:09:48,260 reid_baseline.train INFO: normal accuracy 0.5434135166093929 1.8507559299468994 
2022-05-06 15:09:56,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-06 15:09:56,489 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 185.1%
2022-05-06 15:10:36,397 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 1.017, Acc: 0.924, Base Lr: 2.20e-03
2022-05-06 15:11:12,966 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 1.017, Acc: 0.929, Base Lr: 2.20e-03
2022-05-06 15:11:39,773 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.372[s] Speed: 43.1[samples/s]
2022-05-06 15:12:53,954 reid_baseline.train INFO: normal accuracy 0.5466208476517754 1.8184818029403687 
2022-05-06 15:13:02,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-06 15:13:02,233 reid_baseline.train INFO: Accuracy: 54.7% Mean Entropy: 181.8%
2022-05-06 15:13:41,081 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.994, Acc: 0.927, Base Lr: 1.66e-03
2022-05-06 15:14:16,923 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.993, Acc: 0.931, Base Lr: 1.66e-03
2022-05-06 15:14:43,025 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-05-06 15:15:49,883 reid_baseline.train INFO: normal accuracy 0.5463917525773195 1.959998369216919 
2022-05-06 15:15:49,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-06 15:15:49,884 reid_baseline.train INFO: Accuracy: 54.6% Mean Entropy: 196.0%
2022-05-06 15:16:28,044 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.973, Acc: 0.945, Base Lr: 1.19e-03
2022-05-06 15:17:04,395 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.980, Acc: 0.938, Base Lr: 1.19e-03
2022-05-06 15:17:30,856 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-05-06 15:18:41,016 reid_baseline.train INFO: normal accuracy 0.5434135166093929 1.8920899629592896 
2022-05-06 15:18:41,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-06 15:18:41,016 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 189.2%
2022-05-06 15:19:20,758 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.972, Acc: 0.945, Base Lr: 7.78e-04
2022-05-06 15:19:57,584 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.970, Acc: 0.946, Base Lr: 7.78e-04
2022-05-06 15:20:24,497 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-05-06 15:21:28,327 reid_baseline.train INFO: normal accuracy 0.5479954180985109 1.8582464456558228 
2022-05-06 15:21:28,328 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-06 15:21:28,328 reid_baseline.train INFO: Accuracy: 54.8% Mean Entropy: 185.8%
2022-05-06 15:22:08,119 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.969, Acc: 0.950, Base Lr: 4.51e-04
2022-05-06 15:22:43,518 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.963, Acc: 0.951, Base Lr: 4.51e-04
2022-05-06 15:23:11,081 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-05-06 15:24:16,589 reid_baseline.train INFO: normal accuracy 0.547766323024055 1.9145019054412842 
2022-05-06 15:24:16,590 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-06 15:24:16,590 reid_baseline.train INFO: Accuracy: 54.8% Mean Entropy: 191.5%
2022-05-06 15:24:56,029 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.961, Acc: 0.943, Base Lr: 2.11e-04
2022-05-06 15:25:32,169 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.965, Acc: 0.944, Base Lr: 2.11e-04
2022-05-06 15:25:58,885 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.368[s] Speed: 43.5[samples/s]
2022-05-06 15:27:06,693 reid_baseline.train INFO: normal accuracy 0.547766323024055 1.8953089714050293 
2022-05-06 15:27:06,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-06 15:27:06,694 reid_baseline.train INFO: Accuracy: 54.8% Mean Entropy: 189.5%
2022-05-06 15:27:46,557 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.957, Acc: 0.949, Base Lr: 6.51e-05
2022-05-06 15:28:22,490 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.966, Acc: 0.946, Base Lr: 6.51e-05
2022-05-06 15:28:49,731 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.371[s] Speed: 43.2[samples/s]
2022-05-06 15:29:54,350 reid_baseline.train INFO: normal accuracy 0.5450171821305841 1.8495378494262695 
2022-05-06 15:29:54,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-06 15:29:54,351 reid_baseline.train INFO: Accuracy: 54.5% Mean Entropy: 185.0%
2022-05-06 15:30:34,056 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.961, Acc: 0.949, Base Lr: 1.60e-05
2022-05-06 15:31:10,342 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.959, Acc: 0.950, Base Lr: 1.60e-05
2022-05-06 15:31:37,243 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-05-06 15:32:49,327 reid_baseline.train INFO: normal accuracy 0.5441008018327605 1.849183440208435 
2022-05-06 15:32:49,328 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-06 15:32:49,328 reid_baseline.train INFO: Accuracy: 54.4% Mean Entropy: 184.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_small/office-home/Product_2_Clipart_shuffled_Cross_Domain_key_layer_rand/transformer_best_model.pth
2022-05-06 15:34:00,131 reid_baseline.train INFO: normal accuracy 0.5466208476517754 1.8184818029403687 
2022-05-06 15:34:00,131 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 15:34:00,132 reid_baseline.train INFO: Accuracy: 54.7%
2022-05-06 15:35:06,601 reid_baseline.train INFO: normal accuracy 0.5466208476517754 1.8184818029403687 
2022-05-06 15:35:06,601 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 15:35:06,601 reid_baseline.train INFO: Shuffled Accuracy: 54.7%
2022-05-06 15:36:14,107 reid_baseline.train INFO: normal accuracy 0.9794998873620184 0.7047750949859619 
2022-05-06 15:36:14,107 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 15:36:14,107 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
2022-05-06 15:36:18,860 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_small/office-home/Product_2_Real_World_shuffled_Cross_Domain_key_layer_rand
2022-05-06 15:36:18,860 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('2')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_small/office-home/Product_2_Real_World_shuffled_Cross_Domain_key_layer_rand', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_small_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=2)
2022-05-06 15:36:18,860 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-06 15:36:18,861 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-06 15:36:18,862 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 2
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_small_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_small/office-home/Product_2_Real_World_shuffled_Cross_Domain_key_layer_rand
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_small_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 384 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 384]) torch.Size([1, 197, 384])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_small_distilled_patch16_224-649709d9.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-06 15:36:23,447 reid_baseline.train INFO: start training
2022-05-06 15:37:05,180 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.107, Acc: 0.371, Base Lr: 8.72e-04
2022-05-06 15:37:41,547 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 4.022, Acc: 0.494, Base Lr: 8.72e-04
2022-05-06 15:38:10,444 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.384[s] Speed: 41.7[samples/s]
2022-05-06 15:42:39,210 reid_baseline.train INFO: normal accuracy 0.6369061280697728 4.161867618560791 
2022-05-06 15:42:47,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-06 15:42:47,001 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 416.2%
2022-05-06 15:43:25,057 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 3.476, Acc: 0.663, Base Lr: 1.66e-03
2022-05-06 15:44:01,074 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 3.297, Acc: 0.658, Base Lr: 1.66e-03
2022-05-06 15:44:28,417 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.365[s] Speed: 43.9[samples/s]
2022-05-06 15:47:22,899 reid_baseline.train INFO: normal accuracy 0.6330043607987147 3.8904759883880615 
2022-05-06 15:47:30,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-06 15:47:30,868 reid_baseline.train INFO: Accuracy: 63.3% Mean Entropy: 389.0%
2022-05-06 15:48:09,502 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 2.431, Acc: 0.675, Base Lr: 2.46e-03
2022-05-06 15:48:45,683 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 2.322, Acc: 0.680, Base Lr: 2.46e-03
2022-05-06 15:49:12,545 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-05-06 15:51:54,560 reid_baseline.train INFO: normal accuracy 0.6814321781042001 3.15748929977417 
2022-05-06 15:52:02,357 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-06 15:52:02,358 reid_baseline.train INFO: Accuracy: 68.1% Mean Entropy: 315.7%
2022-05-06 15:52:41,380 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.819, Acc: 0.744, Base Lr: 3.25e-03
2022-05-06 15:53:17,423 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 1.778, Acc: 0.746, Base Lr: 3.25e-03
2022-05-06 15:53:44,109 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-05-06 15:56:17,165 reid_baseline.train INFO: normal accuracy 0.7424833601101676 2.5578105449676514 
2022-05-06 15:56:25,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-06 15:56:25,058 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 255.8%
2022-05-06 15:57:05,890 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 1.536, Acc: 0.797, Base Lr: 4.04e-03
2022-05-06 15:57:41,692 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 1.490, Acc: 0.807, Base Lr: 4.04e-03
2022-05-06 15:58:08,777 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-05-06 16:00:42,042 reid_baseline.train INFO: normal accuracy 0.7619921964654579 2.1900529861450195 
2022-05-06 16:00:49,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-06 16:00:49,953 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 219.0%
2022-05-06 16:01:29,307 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 1.361, Acc: 0.834, Base Lr: 4.83e-03
2022-05-06 16:02:05,840 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 1.332, Acc: 0.843, Base Lr: 4.83e-03
2022-05-06 16:02:32,173 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.368[s] Speed: 43.5[samples/s]
2022-05-06 16:05:02,679 reid_baseline.train INFO: normal accuracy 0.7787468441588249 1.9107584953308105 
2022-05-06 16:05:10,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-06 16:05:10,754 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 191.1%
2022-05-06 16:05:50,610 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 1.249, Acc: 0.853, Base Lr: 5.62e-03
2022-05-06 16:06:26,906 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 1.253, Acc: 0.857, Base Lr: 5.62e-03
2022-05-06 16:06:53,519 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-05-06 16:09:25,484 reid_baseline.train INFO: normal accuracy 0.786550378700941 1.7870014905929565 
2022-05-06 16:09:33,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-06 16:09:33,724 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 178.7%
2022-05-06 16:10:12,382 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 1.182, Acc: 0.879, Base Lr: 6.42e-03
2022-05-06 16:10:48,199 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 1.180, Acc: 0.883, Base Lr: 6.42e-03
2022-05-06 16:11:15,037 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.364[s] Speed: 43.9[samples/s]
2022-05-06 16:13:45,080 reid_baseline.train INFO: normal accuracy 0.7927473031902685 1.689623236656189 
2022-05-06 16:13:53,325 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-06 16:13:53,325 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 169.0%
2022-05-06 16:14:32,847 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 1.136, Acc: 0.899, Base Lr: 7.21e-03
2022-05-06 16:15:09,717 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 1.121, Acc: 0.901, Base Lr: 7.21e-03
2022-05-06 16:15:37,480 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-05-06 16:18:07,027 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.6264891624450684 
2022-05-06 16:18:14,895 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-06 16:18:14,895 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 162.6%
2022-05-06 16:18:52,958 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 1.058, Acc: 0.924, Base Lr: 4.01e-03
2022-05-06 16:19:28,117 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 1.065, Acc: 0.917, Base Lr: 4.01e-03
2022-05-06 16:19:54,814 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.359[s] Speed: 44.5[samples/s]
2022-05-06 16:22:27,958 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.4867873191833496 
2022-05-06 16:22:35,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-06 16:22:35,829 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 148.7%
2022-05-06 16:23:15,493 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 1.031, Acc: 0.926, Base Lr: 3.38e-03
2022-05-06 16:23:51,701 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 1.029, Acc: 0.925, Base Lr: 3.38e-03
2022-05-06 16:24:19,173 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-05-06 16:26:56,746 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.5213159322738647 
2022-05-06 16:26:56,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-06 16:26:56,747 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 152.1%
2022-05-06 16:28:00,291 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 1.029, Acc: 0.931, Base Lr: 2.77e-03
2022-05-06 16:28:58,890 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 1.034, Acc: 0.927, Base Lr: 2.77e-03
2022-05-06 16:29:45,134 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.606[s] Speed: 26.4[samples/s]
2022-05-06 16:34:14,475 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.4401549100875854 
2022-05-06 16:34:33,815 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-06 16:34:33,815 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 144.0%
2022-05-06 16:35:36,887 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 1.016, Acc: 0.924, Base Lr: 2.20e-03
2022-05-06 16:36:34,346 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 1.017, Acc: 0.928, Base Lr: 2.20e-03
2022-05-06 16:37:19,753 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-05-06 16:41:53,643 reid_baseline.train INFO: normal accuracy 0.7987147119577691 1.4210387468338013 
2022-05-06 16:42:14,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-06 16:42:14,275 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 142.1%
2022-05-06 16:43:18,370 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.994, Acc: 0.927, Base Lr: 1.66e-03
2022-05-06 16:44:16,117 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.993, Acc: 0.931, Base Lr: 1.66e-03
2022-05-06 16:45:04,023 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.611[s] Speed: 26.2[samples/s]
2022-05-06 16:49:31,446 reid_baseline.train INFO: normal accuracy 0.7982556805141152 1.5574400424957275 
2022-05-06 16:49:31,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-06 16:49:31,447 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 155.7%
2022-05-06 16:50:36,080 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.973, Acc: 0.946, Base Lr: 1.19e-03
2022-05-06 16:51:33,122 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.980, Acc: 0.939, Base Lr: 1.19e-03
2022-05-06 16:52:18,775 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-05-06 16:56:43,280 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.488041877746582 
2022-05-06 16:56:43,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-06 16:56:43,281 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 148.8%
2022-05-06 16:57:44,817 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.972, Acc: 0.945, Base Lr: 7.78e-04
2022-05-06 16:58:41,853 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.970, Acc: 0.945, Base Lr: 7.78e-04
2022-05-06 16:59:28,839 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.596[s] Speed: 26.9[samples/s]
2022-05-06 17:03:17,404 reid_baseline.train INFO: normal accuracy 0.7987147119577691 1.4620890617370605 
2022-05-06 17:03:17,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-06 17:03:17,405 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 146.2%
2022-05-06 17:03:57,907 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.969, Acc: 0.948, Base Lr: 4.51e-04
2022-05-06 17:04:33,785 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.962, Acc: 0.950, Base Lr: 4.51e-04
2022-05-06 17:05:01,603 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-05-06 17:07:27,253 reid_baseline.train INFO: normal accuracy 0.8021574477851733 1.513733148574829 
2022-05-06 17:07:27,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-06 17:07:27,253 reid_baseline.train INFO: Accuracy: 80.2% Mean Entropy: 151.4%
2022-05-06 17:08:07,553 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.961, Acc: 0.944, Base Lr: 2.11e-04
2022-05-06 17:08:44,409 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.965, Acc: 0.944, Base Lr: 2.11e-04
2022-05-06 17:09:11,068 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.373[s] Speed: 42.8[samples/s]
2022-05-06 17:11:29,899 reid_baseline.train INFO: normal accuracy 0.8012393848978655 1.4941810369491577 
2022-05-06 17:11:29,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-06 17:11:29,900 reid_baseline.train INFO: Accuracy: 80.1% Mean Entropy: 149.4%
2022-05-06 17:12:09,223 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.957, Acc: 0.949, Base Lr: 6.51e-05
2022-05-06 17:12:45,955 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.966, Acc: 0.946, Base Lr: 6.51e-05
2022-05-06 17:13:13,443 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-05-06 17:15:41,425 reid_baseline.train INFO: normal accuracy 0.7982556805141152 1.4443950653076172 
2022-05-06 17:15:41,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-06 17:15:41,426 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 144.4%
2022-05-06 17:16:21,347 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.961, Acc: 0.949, Base Lr: 1.60e-05
2022-05-06 17:16:57,221 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.959, Acc: 0.949, Base Lr: 1.60e-05
2022-05-06 17:17:24,368 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-05-06 17:19:50,384 reid_baseline.train INFO: normal accuracy 0.7998622905669038 1.4449628591537476 
2022-05-06 17:19:50,385 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-06 17:19:50,385 reid_baseline.train INFO: Accuracy: 80.0% Mean Entropy: 144.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_small/office-home/Product_2_Real_World_shuffled_Cross_Domain_key_layer_rand/transformer_best_model.pth
2022-05-06 17:22:23,468 reid_baseline.train INFO: normal accuracy 0.7987147119577691 1.4210387468338013 
2022-05-06 17:22:23,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 17:22:23,468 reid_baseline.train INFO: Accuracy: 79.9%
2022-05-06 17:24:47,722 reid_baseline.train INFO: normal accuracy 0.7987147119577691 1.4210387468338013 
2022-05-06 17:24:47,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 17:24:47,723 reid_baseline.train INFO: Shuffled Accuracy: 79.9%
2022-05-06 17:25:50,623 reid_baseline.train INFO: normal accuracy 0.979049335435909 0.7028601169586182 
2022-05-06 17:25:50,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-06 17:25:50,624 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
