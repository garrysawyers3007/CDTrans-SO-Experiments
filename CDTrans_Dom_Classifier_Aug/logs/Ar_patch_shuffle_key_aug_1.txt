2022-04-16 15:32:08,006 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_1
2022-04-16 15:32:08,006 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-16 15:32:08,006 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 15:32:08,006 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 15:32:08,006 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 15:32:25,674 reid_baseline.train INFO: start training
2022-04-16 15:33:52,712 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.145, Acc: 0.198, Base Lr: 4.76e-04
2022-04-16 15:34:23,847 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.741[s] Speed: 21.6[samples/s]
2022-04-16 15:35:29,508 reid_baseline.train INFO: normal accuracy 0.43478260869565216 4.173008441925049 
2022-04-16 15:35:30,425 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 15:35:30,425 reid_baseline.train INFO: Accuracy: 43.5% Mean Entropy: 417.3%
2022-04-16 15:36:28,640 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.985, Acc: 0.562, Base Lr: 8.72e-04
2022-04-16 15:37:02,844 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.608[s] Speed: 26.3[samples/s]
2022-04-16 15:38:08,259 reid_baseline.train INFO: normal accuracy 0.5282721333633701 4.169052600860596 
2022-04-16 15:38:09,115 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 15:38:09,116 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 416.9%
2022-04-16 15:39:08,790 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.696, Acc: 0.613, Base Lr: 1.27e-03
2022-04-16 15:39:39,169 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 15:40:44,699 reid_baseline.train INFO: normal accuracy 0.5262446496958775 4.148040771484375 
2022-04-16 15:40:45,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 15:40:45,620 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 414.8%
2022-04-16 15:41:46,162 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.257, Acc: 0.629, Base Lr: 1.66e-03
2022-04-16 15:42:15,689 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-04-16 15:43:20,792 reid_baseline.train INFO: normal accuracy 0.5354809641811219 4.04079532623291 
2022-04-16 15:43:21,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 15:43:21,657 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 404.1%
2022-04-16 15:44:19,582 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.700, Acc: 0.644, Base Lr: 2.06e-03
2022-04-16 15:44:51,113 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 15:45:56,810 reid_baseline.train INFO: normal accuracy 0.5593602162649245 3.7499465942382812 
2022-04-16 15:45:57,650 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 15:45:57,650 reid_baseline.train INFO: Accuracy: 55.9% Mean Entropy: 375.0%
2022-04-16 15:46:57,562 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.252, Acc: 0.668, Base Lr: 2.46e-03
2022-04-16 15:47:30,503 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.609[s] Speed: 26.3[samples/s]
2022-04-16 15:48:35,894 reid_baseline.train INFO: normal accuracy 0.6028384771344898 3.322160005569458 
2022-04-16 15:48:36,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 15:48:36,744 reid_baseline.train INFO: Accuracy: 60.3% Mean Entropy: 332.2%
2022-04-16 15:49:37,390 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.942, Acc: 0.721, Base Lr: 2.85e-03
2022-04-16 15:50:06,147 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 15:51:11,326 reid_baseline.train INFO: normal accuracy 0.6636629871592701 2.977634906768799 
2022-04-16 15:51:12,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 15:51:12,218 reid_baseline.train INFO: Accuracy: 66.4% Mean Entropy: 297.8%
2022-04-16 15:52:09,905 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.686, Acc: 0.764, Base Lr: 3.25e-03
2022-04-16 15:52:40,283 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.579[s] Speed: 27.6[samples/s]
2022-04-16 15:53:45,814 reid_baseline.train INFO: normal accuracy 0.6974543816174814 2.5887911319732666 
2022-04-16 15:53:46,638 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 15:53:46,638 reid_baseline.train INFO: Accuracy: 69.7% Mean Entropy: 258.9%
2022-04-16 15:54:47,460 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.548, Acc: 0.799, Base Lr: 3.64e-03
2022-04-16 15:55:18,095 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-04-16 15:56:23,715 reid_baseline.train INFO: normal accuracy 0.731921603964857 2.358158588409424 
2022-04-16 15:56:24,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 15:56:24,607 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 235.8%
2022-04-16 15:57:22,943 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.397, Acc: 0.827, Base Lr: 4.04e-03
2022-04-16 15:57:52,388 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.577[s] Speed: 27.7[samples/s]
2022-04-16 15:58:59,340 reid_baseline.train INFO: normal accuracy 0.7542239243072764 2.17610502243042 
2022-04-16 15:59:00,189 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 15:59:00,189 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 217.6%
2022-04-16 15:59:59,929 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.334, Acc: 0.850, Base Lr: 4.44e-03
2022-04-16 16:00:28,285 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 16:01:33,915 reid_baseline.train INFO: normal accuracy 0.7600810993466998 1.9775861501693726 
2022-04-16 16:01:34,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 16:01:34,780 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 197.8%
2022-04-16 16:02:35,714 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.284, Acc: 0.853, Base Lr: 4.83e-03
2022-04-16 16:03:06,569 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.604[s] Speed: 26.5[samples/s]
2022-04-16 16:04:11,731 reid_baseline.train INFO: normal accuracy 0.7652624464969587 1.8310520648956299 
2022-04-16 16:04:12,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 16:04:12,625 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 183.1%
2022-04-16 16:05:13,746 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.217, Acc: 0.882, Base Lr: 5.23e-03
2022-04-16 16:05:44,207 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-04-16 16:06:49,750 reid_baseline.train INFO: normal accuracy 0.7708943455733274 1.7336962223052979 
2022-04-16 16:06:52,042 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 16:06:52,042 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 173.4%
2022-04-16 16:07:51,511 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.180, Acc: 0.887, Base Lr: 5.62e-03
2022-04-16 16:08:21,735 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-04-16 16:09:27,509 reid_baseline.train INFO: normal accuracy 0.7706690696102726 1.7657699584960938 
2022-04-16 16:09:27,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 16:09:27,513 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 176.6%
2022-04-16 16:10:27,729 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.120, Acc: 0.911, Base Lr: 6.02e-03
2022-04-16 16:10:57,968 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 16:12:03,022 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.7660863399505615 
2022-04-16 16:12:03,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 16:12:03,027 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 176.6%
2022-04-16 16:13:02,705 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.091, Acc: 0.914, Base Lr: 6.42e-03
2022-04-16 16:13:32,313 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.587[s] Speed: 27.2[samples/s]
2022-04-16 16:14:38,073 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.7043181657791138 
2022-04-16 16:14:38,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 16:14:38,966 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 170.4%
2022-04-16 16:15:39,378 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.063, Acc: 0.922, Base Lr: 6.81e-03
2022-04-16 16:16:08,816 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-04-16 16:17:14,605 reid_baseline.train INFO: normal accuracy 0.779004280243298 1.6455689668655396 
2022-04-16 16:17:16,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 16:17:16,381 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 164.6%
2022-04-16 16:18:16,745 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.059, Acc: 0.926, Base Lr: 7.21e-03
2022-04-16 16:18:47,852 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-04-16 16:19:53,342 reid_baseline.train INFO: normal accuracy 0.7805812119846812 1.6825639009475708 
2022-04-16 16:19:53,345 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 16:19:53,345 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 168.3%
2022-04-16 16:20:54,164 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.021, Acc: 0.939, Base Lr: 7.60e-03
2022-04-16 16:21:23,637 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-04-16 16:22:29,540 reid_baseline.train INFO: normal accuracy 0.7781031763910791 1.5721179246902466 
2022-04-16 16:22:30,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 16:22:30,579 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 157.2%
2022-04-16 16:23:28,100 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.981, Acc: 0.953, Base Lr: 4.01e-03
2022-04-16 16:23:57,533 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.571[s] Speed: 28.0[samples/s]
2022-04-16 16:25:03,122 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.6793664693832397 
2022-04-16 16:25:03,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 16:25:03,126 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 167.9%
2022-04-16 16:26:02,965 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.964, Acc: 0.955, Base Lr: 3.69e-03
2022-04-16 16:26:32,957 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-04-16 16:27:38,484 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.7212120294570923 
2022-04-16 16:27:38,489 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 16:27:38,489 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 172.1%
2022-04-16 16:28:37,548 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.953, Acc: 0.956, Base Lr: 3.38e-03
2022-04-16 16:29:07,257 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-04-16 16:30:12,705 reid_baseline.train INFO: normal accuracy 0.7805812119846812 1.7017475366592407 
2022-04-16 16:30:12,709 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 16:30:12,710 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 170.2%
2022-04-16 16:31:12,582 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.951, Acc: 0.958, Base Lr: 3.08e-03
2022-04-16 16:31:43,130 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 16:32:48,060 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.652571678161621 
2022-04-16 16:32:48,065 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 16:32:48,065 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 165.3%
2022-04-16 16:33:46,834 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.939, Acc: 0.965, Base Lr: 2.77e-03
2022-04-16 16:34:17,193 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 16:35:22,708 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.682504653930664 
2022-04-16 16:35:22,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 16:35:22,713 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 168.3%
2022-04-16 16:36:22,673 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.931, Acc: 0.965, Base Lr: 2.48e-03
2022-04-16 16:36:52,819 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-04-16 16:37:58,237 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.7509592771530151 
2022-04-16 16:37:58,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 16:37:58,241 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 175.1%
2022-04-16 16:38:57,702 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.914, Acc: 0.972, Base Lr: 2.20e-03
2022-04-16 16:39:28,279 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 16:40:33,463 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.68941330909729 
2022-04-16 16:40:33,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 16:40:33,465 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 168.9%
2022-04-16 16:41:33,545 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.912, Acc: 0.969, Base Lr: 1.92e-03
2022-04-16 16:42:02,410 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.585[s] Speed: 27.4[samples/s]
2022-04-16 16:43:07,801 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.7441636323928833 
2022-04-16 16:43:07,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 16:43:07,806 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 174.4%
2022-04-16 16:44:08,047 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.908, Acc: 0.972, Base Lr: 1.66e-03
2022-04-16 16:44:38,035 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.594[s] Speed: 27.0[samples/s]
2022-04-16 16:45:43,546 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.7089009284973145 
2022-04-16 16:45:43,550 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 16:45:43,550 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 170.9%
2022-04-16 16:46:42,388 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.902, Acc: 0.974, Base Lr: 1.42e-03
2022-04-16 16:47:12,088 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.582[s] Speed: 27.5[samples/s]
2022-04-16 16:48:17,619 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.765053153038025 
2022-04-16 16:48:17,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 16:48:17,624 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 176.5%
2022-04-16 16:49:16,668 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.891, Acc: 0.973, Base Lr: 1.19e-03
2022-04-16 16:49:46,443 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 16:50:52,793 reid_baseline.train INFO: normal accuracy 0.7868889389502141 1.6098905801773071 
2022-04-16 16:50:52,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 16:50:52,796 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 161.0%
2022-04-16 16:51:53,449 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.902, Acc: 0.967, Base Lr: 9.72e-04
2022-04-16 16:52:23,935 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 16:53:29,393 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.7086281776428223 
2022-04-16 16:53:29,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 16:53:29,395 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 170.9%
2022-04-16 16:54:28,788 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.894, Acc: 0.971, Base Lr: 7.78e-04
2022-04-16 16:54:58,426 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.585[s] Speed: 27.4[samples/s]
2022-04-16 16:56:03,406 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.6973016262054443 
2022-04-16 16:56:03,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 16:56:03,411 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 169.7%
2022-04-16 16:57:03,147 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.912, Acc: 0.968, Base Lr: 6.04e-04
2022-04-16 16:57:32,784 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 16:58:37,748 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.6888718605041504 
2022-04-16 16:58:37,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 16:58:37,753 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 168.9%
2022-04-16 16:59:37,335 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.902, Acc: 0.972, Base Lr: 4.51e-04
2022-04-16 17:00:06,252 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.582[s] Speed: 27.5[samples/s]
2022-04-16 17:01:10,757 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.6785889863967896 
2022-04-16 17:01:10,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 17:01:10,762 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 167.9%
2022-04-16 17:02:11,855 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.884, Acc: 0.977, Base Lr: 3.20e-04
2022-04-16 17:02:41,858 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.599[s] Speed: 26.7[samples/s]
2022-04-16 17:03:47,797 reid_baseline.train INFO: normal accuracy 0.7871142149132687 1.7077020406723022 
2022-04-16 17:03:47,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 17:03:47,802 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 170.8%
2022-04-16 17:04:47,047 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.902, Acc: 0.973, Base Lr: 2.11e-04
2022-04-16 17:05:16,829 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-04-16 17:06:22,625 reid_baseline.train INFO: normal accuracy 0.7864383870241045 1.6685070991516113 
2022-04-16 17:06:22,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 17:06:22,630 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 166.9%
2022-04-16 17:07:22,852 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.893, Acc: 0.976, Base Lr: 1.26e-04
2022-04-16 17:07:53,320 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 17:08:58,394 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.7181905508041382 
2022-04-16 17:08:58,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 17:08:58,399 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 171.8%
2022-04-16 17:09:56,949 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.889, Acc: 0.974, Base Lr: 6.51e-05
2022-04-16 17:10:27,059 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 17:11:32,676 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.7400325536727905 
2022-04-16 17:11:32,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 17:11:32,679 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 174.0%
2022-04-16 17:12:32,058 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.901, Acc: 0.973, Base Lr: 2.83e-05
2022-04-16 17:13:00,855 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 17:14:06,172 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.7292283773422241 
2022-04-16 17:14:06,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 17:14:06,177 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 172.9%
2022-04-16 17:15:06,956 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.878, Acc: 0.982, Base Lr: 1.60e-05
2022-04-16 17:15:35,594 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 17:16:41,510 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.6577317714691162 
2022-04-16 17:16:41,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 17:16:41,515 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 165.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_1/transformer_best_model.pth
2022-04-16 17:17:48,760 reid_baseline.train INFO: normal accuracy 0.7781031763910791 1.5721179246902466 
2022-04-16 17:17:48,761 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:17:48,761 reid_baseline.train INFO: Accuracy: 77.8%
2022-04-16 17:18:54,009 reid_baseline.train INFO: normal accuracy 0.7781031763910791 1.5721179246902466 
2022-04-16 17:18:54,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:18:54,009 reid_baseline.train INFO: Shuffled Accuracy: 77.8%
2022-04-16 17:19:33,254 reid_baseline.train INFO: normal accuracy 0.9905232797692625 0.7144483327865601 
2022-04-16 17:19:33,254 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 17:19:33,254 reid_baseline.train INFO: Source Clean Accuracy: 99.1%
2022-04-16 17:19:38,202 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_1
2022-04-16 17:19:38,203 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-16 17:19:38,203 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 17:19:38,203 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 17:19:38,203 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 17:19:52,939 reid_baseline.train INFO: start training
2022-04-16 17:21:16,686 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.145, Acc: 0.199, Base Lr: 4.76e-04
2022-04-16 17:21:47,405 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.720[s] Speed: 22.2[samples/s]
2022-04-16 17:23:23,206 reid_baseline.train INFO: normal accuracy 0.5134266697268763 4.172957420349121 
2022-04-16 17:23:25,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 17:23:25,074 reid_baseline.train INFO: Accuracy: 51.3% Mean Entropy: 417.3%
2022-04-16 17:24:23,572 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.985, Acc: 0.562, Base Lr: 8.72e-04
2022-04-16 17:24:57,248 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.606[s] Speed: 26.4[samples/s]
2022-04-16 17:26:35,447 reid_baseline.train INFO: normal accuracy 0.6089052100068855 4.168156147003174 
2022-04-16 17:26:37,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 17:26:37,887 reid_baseline.train INFO: Accuracy: 60.9% Mean Entropy: 416.8%
2022-04-16 17:27:37,220 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.696, Acc: 0.613, Base Lr: 1.27e-03
2022-04-16 17:28:07,504 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 17:29:48,572 reid_baseline.train INFO: normal accuracy 0.6102823043378471 4.138021469116211 
2022-04-16 17:29:49,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 17:29:49,475 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 413.8%
2022-04-16 17:30:50,399 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.257, Acc: 0.629, Base Lr: 1.66e-03
2022-04-16 17:31:19,980 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 17:32:59,808 reid_baseline.train INFO: normal accuracy 0.6300206564149644 3.9807896614074707 
2022-04-16 17:33:00,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 17:33:00,724 reid_baseline.train INFO: Accuracy: 63.0% Mean Entropy: 398.1%
2022-04-16 17:33:59,206 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.700, Acc: 0.644, Base Lr: 2.06e-03
2022-04-16 17:34:30,791 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 17:36:07,045 reid_baseline.train INFO: normal accuracy 0.6495294927702547 3.564883232116699 
2022-04-16 17:36:07,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 17:36:07,916 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 356.5%
2022-04-16 17:37:07,754 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.252, Acc: 0.668, Base Lr: 2.46e-03
2022-04-16 17:37:40,038 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.605[s] Speed: 26.4[samples/s]
2022-04-16 17:39:17,807 reid_baseline.train INFO: normal accuracy 0.6896947440899701 3.0579166412353516 
2022-04-16 17:39:18,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 17:39:18,699 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 305.8%
2022-04-16 17:40:19,438 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.942, Acc: 0.721, Base Lr: 2.85e-03
2022-04-16 17:40:48,495 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-04-16 17:42:25,162 reid_baseline.train INFO: normal accuracy 0.7307780582969934 2.695756196975708 
2022-04-16 17:42:26,080 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 17:42:26,080 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 269.6%
2022-04-16 17:43:23,896 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.686, Acc: 0.763, Base Lr: 3.25e-03
2022-04-16 17:43:54,233 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 17:45:30,924 reid_baseline.train INFO: normal accuracy 0.7661234794583429 2.2945592403411865 
2022-04-16 17:45:33,222 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 17:45:33,223 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 229.5%
2022-04-16 17:46:33,684 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.547, Acc: 0.799, Base Lr: 3.64e-03
2022-04-16 17:47:04,252 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.599[s] Speed: 26.7[samples/s]
2022-04-16 17:48:42,521 reid_baseline.train INFO: normal accuracy 0.7941243975212302 2.0762622356414795 
2022-04-16 17:48:43,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 17:48:43,433 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 207.6%
2022-04-16 17:49:42,147 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.397, Acc: 0.826, Base Lr: 4.04e-03
2022-04-16 17:50:11,436 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.579[s] Speed: 27.6[samples/s]
2022-04-16 17:51:53,906 reid_baseline.train INFO: normal accuracy 0.8095019508836355 1.9000945091247559 
2022-04-16 17:51:54,816 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 17:51:54,816 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 190.0%
2022-04-16 17:52:54,719 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.334, Acc: 0.847, Base Lr: 4.44e-03
2022-04-16 17:53:24,691 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-04-16 17:55:02,399 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.7178428173065186 
2022-04-16 17:55:03,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 17:55:03,250 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 171.8%
2022-04-16 17:56:04,193 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.284, Acc: 0.853, Base Lr: 4.83e-03
2022-04-16 17:56:35,189 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.605[s] Speed: 26.5[samples/s]
2022-04-16 17:58:12,171 reid_baseline.train INFO: normal accuracy 0.8186825797567133 1.6011173725128174 
2022-04-16 17:58:13,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 17:58:13,051 reid_baseline.train INFO: Accuracy: 81.9% Mean Entropy: 160.1%
2022-04-16 17:59:14,353 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.218, Acc: 0.883, Base Lr: 5.23e-03
2022-04-16 17:59:44,444 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 18:01:29,652 reid_baseline.train INFO: normal accuracy 0.82419095708056 1.5011188983917236 
2022-04-16 18:01:30,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 18:01:30,509 reid_baseline.train INFO: Accuracy: 82.4% Mean Entropy: 150.1%
2022-04-16 18:02:30,354 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.180, Acc: 0.886, Base Lr: 5.62e-03
2022-04-16 18:03:00,745 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.594[s] Speed: 27.0[samples/s]
2022-04-16 18:04:36,705 reid_baseline.train INFO: normal accuracy 0.8287812715170989 1.5409661531448364 
2022-04-16 18:04:36,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 18:04:36,710 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 154.1%
2022-04-16 18:05:37,204 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.120, Acc: 0.911, Base Lr: 6.02e-03
2022-04-16 18:06:07,393 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 18:07:41,537 reid_baseline.train INFO: normal accuracy 0.832683038788157 1.5534154176712036 
2022-04-16 18:07:41,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 18:07:41,543 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 155.3%
2022-04-16 18:08:40,808 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.090, Acc: 0.916, Base Lr: 6.42e-03
2022-04-16 18:09:10,426 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.585[s] Speed: 27.4[samples/s]
2022-04-16 18:10:50,518 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.46198308467865 
2022-04-16 18:10:51,436 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 18:10:51,436 reid_baseline.train INFO: Accuracy: 82.8% Mean Entropy: 146.2%
2022-04-16 18:11:51,728 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.063, Acc: 0.921, Base Lr: 6.81e-03
2022-04-16 18:12:21,291 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 18:13:57,116 reid_baseline.train INFO: normal accuracy 0.8287812715170989 1.4141621589660645 
2022-04-16 18:13:57,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 18:13:57,934 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 141.4%
2022-04-16 18:14:56,474 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.059, Acc: 0.926, Base Lr: 7.21e-03
2022-04-16 18:15:27,242 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.587[s] Speed: 27.2[samples/s]
2022-04-16 18:17:11,140 reid_baseline.train INFO: normal accuracy 0.8301583658480606 1.438920259475708 
2022-04-16 18:17:11,144 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 18:17:11,145 reid_baseline.train INFO: Accuracy: 83.0% Mean Entropy: 143.9%
2022-04-16 18:18:12,600 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.021, Acc: 0.939, Base Lr: 7.60e-03
2022-04-16 18:18:42,383 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 18:20:26,850 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.3385205268859863 
2022-04-16 18:20:27,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 18:20:27,767 reid_baseline.train INFO: Accuracy: 82.8% Mean Entropy: 133.9%
2022-04-16 18:21:26,102 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.982, Acc: 0.952, Base Lr: 4.01e-03
2022-04-16 18:21:56,105 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.581[s] Speed: 27.5[samples/s]
2022-04-16 18:23:33,107 reid_baseline.train INFO: normal accuracy 0.8315354601790222 1.4238204956054688 
2022-04-16 18:23:33,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 18:23:33,112 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 142.4%
2022-04-16 18:24:32,985 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.965, Acc: 0.952, Base Lr: 3.69e-03
2022-04-16 18:25:02,850 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 18:26:37,980 reid_baseline.train INFO: normal accuracy 0.8319944916226761 1.475473165512085 
2022-04-16 18:26:37,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 18:26:37,984 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 147.5%
2022-04-16 18:27:37,326 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.952, Acc: 0.953, Base Lr: 3.38e-03
2022-04-16 18:28:07,251 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 18:29:42,647 reid_baseline.train INFO: normal accuracy 0.8313059444571953 1.4571629762649536 
2022-04-16 18:29:42,652 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 18:29:42,652 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 145.7%
2022-04-16 18:30:42,381 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.950, Acc: 0.958, Base Lr: 3.08e-03
2022-04-16 18:31:12,724 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 18:32:47,334 reid_baseline.train INFO: normal accuracy 0.8306173972917145 1.416887640953064 
2022-04-16 18:32:47,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 18:32:47,339 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 141.7%
2022-04-16 18:33:45,664 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.940, Acc: 0.963, Base Lr: 2.77e-03
2022-04-16 18:34:16,021 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 18:35:47,851 reid_baseline.train INFO: normal accuracy 0.8352077117282534 1.461283802986145 
2022-04-16 18:35:47,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 18:35:47,855 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 146.1%
2022-04-16 18:36:48,488 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.930, Acc: 0.965, Base Lr: 2.48e-03
2022-04-16 18:37:18,728 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 18:38:52,423 reid_baseline.train INFO: normal accuracy 0.8331420702318109 1.5151731967926025 
2022-04-16 18:38:52,428 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 18:38:52,428 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 151.5%
2022-04-16 18:39:52,113 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.912, Acc: 0.973, Base Lr: 2.20e-03
2022-04-16 18:40:22,944 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 18:42:02,576 reid_baseline.train INFO: normal accuracy 0.8331420702318109 1.4526203870773315 
2022-04-16 18:42:02,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 18:42:02,578 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 145.3%
2022-04-16 18:43:03,192 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.912, Acc: 0.968, Base Lr: 1.92e-03
2022-04-16 18:43:32,243 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-04-16 18:45:12,251 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.5084408521652222 
2022-04-16 18:45:12,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 18:45:12,256 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 150.8%
2022-04-16 18:46:12,510 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.907, Acc: 0.972, Base Lr: 1.66e-03
2022-04-16 18:46:42,584 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 18:48:25,867 reid_baseline.train INFO: normal accuracy 0.8361257746155611 1.4851957559585571 
2022-04-16 18:48:25,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 18:48:25,871 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 148.5%
2022-04-16 18:49:24,319 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.902, Acc: 0.973, Base Lr: 1.42e-03
2022-04-16 18:49:53,695 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-04-16 18:51:25,273 reid_baseline.train INFO: normal accuracy 0.8347486802845995 1.5211127996444702 
2022-04-16 18:51:25,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 18:51:25,278 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 152.1%
2022-04-16 18:52:23,416 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.891, Acc: 0.976, Base Lr: 1.19e-03
2022-04-16 18:52:53,391 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 18:54:32,424 reid_baseline.train INFO: normal accuracy 0.8361257746155611 1.3615002632141113 
2022-04-16 18:54:32,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 18:54:32,429 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 136.2%
2022-04-16 18:55:33,060 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.903, Acc: 0.968, Base Lr: 9.72e-04
2022-04-16 18:56:04,183 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.603[s] Speed: 26.5[samples/s]
2022-04-16 18:57:43,849 reid_baseline.train INFO: normal accuracy 0.8347486802845995 1.465632677078247 
2022-04-16 18:57:43,854 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 18:57:43,854 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 146.6%
2022-04-16 18:58:43,489 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.894, Acc: 0.972, Base Lr: 7.78e-04
2022-04-16 18:59:13,100 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.587[s] Speed: 27.3[samples/s]
2022-04-16 19:00:49,500 reid_baseline.train INFO: normal accuracy 0.8352077117282534 1.4529780149459839 
2022-04-16 19:00:49,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 19:00:49,505 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 145.3%
2022-04-16 19:01:49,160 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.911, Acc: 0.968, Base Lr: 6.04e-04
2022-04-16 19:02:18,917 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 19:03:50,958 reid_baseline.train INFO: normal accuracy 0.8361257746155611 1.443606972694397 
2022-04-16 19:03:50,963 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 19:03:50,963 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 144.4%
2022-04-16 19:04:50,229 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.902, Acc: 0.974, Base Lr: 4.51e-04
2022-04-16 19:05:20,299 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.587[s] Speed: 27.3[samples/s]
2022-04-16 19:06:54,843 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4311004877090454 
2022-04-16 19:06:54,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 19:06:54,847 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 143.1%
2022-04-16 19:07:56,297 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.885, Acc: 0.977, Base Lr: 3.20e-04
2022-04-16 19:08:26,040 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.599[s] Speed: 26.7[samples/s]
2022-04-16 19:10:00,867 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4616189002990723 
2022-04-16 19:10:00,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 19:10:00,871 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 146.2%
2022-04-16 19:11:00,426 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.902, Acc: 0.973, Base Lr: 2.11e-04
2022-04-16 19:11:30,175 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.587[s] Speed: 27.2[samples/s]
2022-04-16 19:13:09,961 reid_baseline.train INFO: normal accuracy 0.8356667431719073 1.4292532205581665 
2022-04-16 19:13:09,965 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 19:13:09,965 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 142.9%
2022-04-16 19:14:10,307 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.892, Acc: 0.975, Base Lr: 1.26e-04
2022-04-16 19:14:40,763 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 19:16:17,256 reid_baseline.train INFO: normal accuracy 0.8352077117282534 1.478095293045044 
2022-04-16 19:16:17,261 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 19:16:17,261 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 147.8%
2022-04-16 19:17:16,084 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.889, Acc: 0.975, Base Lr: 6.51e-05
2022-04-16 19:17:45,911 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 19:19:23,929 reid_baseline.train INFO: normal accuracy 0.8361257746155611 1.4952224493026733 
2022-04-16 19:19:23,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 19:19:23,934 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 149.5%
2022-04-16 19:20:23,770 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.901, Acc: 0.972, Base Lr: 2.83e-05
2022-04-16 19:20:52,819 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.585[s] Speed: 27.4[samples/s]
2022-04-16 19:22:30,257 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4829052686691284 
2022-04-16 19:22:30,262 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 19:22:30,262 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 148.3%
2022-04-16 19:23:30,418 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.878, Acc: 0.982, Base Lr: 1.60e-05
2022-04-16 19:23:59,094 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-04-16 19:25:39,578 reid_baseline.train INFO: normal accuracy 0.836814321781042 1.4122015237808228 
2022-04-16 19:25:39,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 19:25:39,583 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 141.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_1/transformer_best_model.pth
2022-04-16 19:27:20,241 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.3385205268859863 
2022-04-16 19:27:20,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:27:20,241 reid_baseline.train INFO: Accuracy: 82.8%
2022-04-16 19:28:59,014 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.3385205268859863 
2022-04-16 19:28:59,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:28:59,015 reid_baseline.train INFO: Shuffled Accuracy: 82.8%
2022-04-16 19:29:38,304 reid_baseline.train INFO: normal accuracy 0.9892871858261227 0.7077944874763489 
2022-04-16 19:29:38,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:29:38,304 reid_baseline.train INFO: Source Clean Accuracy: 98.9%
2022-04-16 19:29:43,156 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_2
2022-04-16 19:29:43,156 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-16 19:29:43,156 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 19:29:43,156 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 19:29:43,156 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 19:29:58,073 reid_baseline.train INFO: start training
2022-04-16 19:31:21,357 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.145, Acc: 0.192, Base Lr: 4.76e-04
2022-04-16 19:31:52,269 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.717[s] Speed: 22.3[samples/s]
2022-04-16 19:32:57,774 reid_baseline.train INFO: normal accuracy 0.4444694751070061 4.1730122566223145 
2022-04-16 19:32:58,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 19:32:58,570 reid_baseline.train INFO: Accuracy: 44.4% Mean Entropy: 417.3%
2022-04-16 19:33:57,390 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.983, Acc: 0.566, Base Lr: 8.72e-04
2022-04-16 19:34:31,026 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.608[s] Speed: 26.3[samples/s]
2022-04-16 19:35:36,523 reid_baseline.train INFO: normal accuracy 0.5312007208830818 4.169075965881348 
2022-04-16 19:35:37,473 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 19:35:37,473 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 416.9%
2022-04-16 19:36:37,006 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.696, Acc: 0.608, Base Lr: 1.27e-03
2022-04-16 19:37:07,543 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 19:38:13,540 reid_baseline.train INFO: normal accuracy 0.5275963054742059 4.147968292236328 
2022-04-16 19:38:14,479 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 19:38:14,479 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 414.8%
2022-04-16 19:39:14,643 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.261, Acc: 0.623, Base Lr: 1.66e-03
2022-04-16 19:39:44,576 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 19:40:49,805 reid_baseline.train INFO: normal accuracy 0.5404370353683262 4.041325092315674 
2022-04-16 19:40:50,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 19:40:50,743 reid_baseline.train INFO: Accuracy: 54.0% Mean Entropy: 404.1%
2022-04-16 19:41:48,812 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.702, Acc: 0.647, Base Lr: 2.06e-03
2022-04-16 19:42:20,114 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 19:43:25,839 reid_baseline.train INFO: normal accuracy 0.5636404595629646 3.7468998432159424 
2022-04-16 19:43:28,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 19:43:28,213 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 374.7%
2022-04-16 19:44:28,328 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.251, Acc: 0.678, Base Lr: 2.46e-03
2022-04-16 19:45:00,616 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.607[s] Speed: 26.3[samples/s]
2022-04-16 19:46:06,274 reid_baseline.train INFO: normal accuracy 0.6062176165803109 3.313596248626709 
2022-04-16 19:46:07,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 19:46:07,278 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 331.4%
2022-04-16 19:47:07,831 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.942, Acc: 0.716, Base Lr: 2.85e-03
2022-04-16 19:47:36,851 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-04-16 19:48:41,931 reid_baseline.train INFO: normal accuracy 0.65938274386123 2.9778025150299072 
2022-04-16 19:48:42,779 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 19:48:42,779 reid_baseline.train INFO: Accuracy: 65.9% Mean Entropy: 297.8%
2022-04-16 19:49:40,747 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.688, Acc: 0.765, Base Lr: 3.25e-03
2022-04-16 19:50:11,272 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.582[s] Speed: 27.5[samples/s]
2022-04-16 19:51:16,314 reid_baseline.train INFO: normal accuracy 0.6985807614327552 2.581328868865967 
2022-04-16 19:51:17,209 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 19:51:17,209 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 258.1%
2022-04-16 19:52:17,791 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.553, Acc: 0.800, Base Lr: 3.64e-03
2022-04-16 19:52:48,308 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.599[s] Speed: 26.7[samples/s]
2022-04-16 19:53:53,908 reid_baseline.train INFO: normal accuracy 0.7316963280018022 2.3817453384399414 
2022-04-16 19:53:56,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 19:53:56,471 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 238.2%
2022-04-16 19:54:54,585 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.392, Acc: 0.838, Base Lr: 4.04e-03
2022-04-16 19:55:24,117 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.577[s] Speed: 27.7[samples/s]
2022-04-16 19:56:29,935 reid_baseline.train INFO: normal accuracy 0.751971164676729 2.154123067855835 
2022-04-16 19:56:32,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 19:56:32,738 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 215.4%
2022-04-16 19:57:32,914 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.336, Acc: 0.848, Base Lr: 4.44e-03
2022-04-16 19:58:02,770 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 19:59:07,897 reid_baseline.train INFO: normal accuracy 0.7551250281594953 1.9685072898864746 
2022-04-16 19:59:08,821 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 19:59:08,821 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 196.9%
2022-04-16 20:00:09,777 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.270, Acc: 0.869, Base Lr: 4.83e-03
2022-04-16 20:00:40,832 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.604[s] Speed: 26.5[samples/s]
2022-04-16 20:01:46,097 reid_baseline.train INFO: normal accuracy 0.7623338589772471 1.8327375650405884 
2022-04-16 20:01:46,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 20:01:46,951 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 183.3%
2022-04-16 20:02:47,742 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.216, Acc: 0.878, Base Lr: 5.23e-03
2022-04-16 20:03:18,042 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.599[s] Speed: 26.7[samples/s]
2022-04-16 20:04:23,703 reid_baseline.train INFO: normal accuracy 0.7679657580536157 1.689604640007019 
2022-04-16 20:04:24,518 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 20:04:24,518 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 169.0%
2022-04-16 20:05:22,674 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.178, Acc: 0.885, Base Lr: 5.62e-03
2022-04-16 20:05:53,216 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-04-16 20:06:58,600 reid_baseline.train INFO: normal accuracy 0.770218517684163 1.7537530660629272 
2022-04-16 20:06:58,605 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 20:06:58,605 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 175.4%
2022-04-16 20:07:58,666 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.112, Acc: 0.909, Base Lr: 6.02e-03
2022-04-16 20:08:28,838 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-04-16 20:09:34,094 reid_baseline.train INFO: normal accuracy 0.7726965532777652 1.7266401052474976 
2022-04-16 20:09:34,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 20:09:34,097 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 172.7%
2022-04-16 20:10:33,119 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.090, Acc: 0.909, Base Lr: 6.42e-03
2022-04-16 20:11:02,352 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.581[s] Speed: 27.6[samples/s]
2022-04-16 20:12:08,057 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.7123286724090576 
2022-04-16 20:12:08,062 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 20:12:08,062 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 171.2%
2022-04-16 20:13:08,115 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.061, Acc: 0.923, Base Lr: 6.81e-03
2022-04-16 20:13:37,899 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 20:14:43,272 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.6503183841705322 
2022-04-16 20:14:44,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 20:14:44,336 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 165.0%
2022-04-16 20:15:43,738 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.049, Acc: 0.930, Base Lr: 7.21e-03
2022-04-16 20:16:14,772 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 20:17:20,440 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.6839781999588013 
2022-04-16 20:17:20,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 20:17:20,444 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 168.4%
2022-04-16 20:18:20,748 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.023, Acc: 0.939, Base Lr: 7.60e-03
2022-04-16 20:18:50,222 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 20:19:56,127 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.5459171533584595 
2022-04-16 20:19:57,063 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 20:19:57,063 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 154.6%
2022-04-16 20:20:55,261 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.990, Acc: 0.938, Base Lr: 4.01e-03
2022-04-16 20:21:25,209 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 20:22:30,675 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6534254550933838 
2022-04-16 20:22:30,680 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 20:22:30,680 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 165.3%
2022-04-16 20:23:30,315 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.969, Acc: 0.956, Base Lr: 3.69e-03
2022-04-16 20:24:00,382 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-04-16 20:25:05,880 reid_baseline.train INFO: normal accuracy 0.7805812119846812 1.7287095785140991 
2022-04-16 20:25:05,885 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 20:25:05,885 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 172.9%
2022-04-16 20:26:05,069 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.947, Acc: 0.961, Base Lr: 3.38e-03
2022-04-16 20:26:34,492 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 20:27:39,625 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6923035383224487 
2022-04-16 20:27:39,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 20:27:39,630 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 169.2%
2022-04-16 20:28:39,488 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.948, Acc: 0.960, Base Lr: 3.08e-03
2022-04-16 20:29:10,090 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-04-16 20:30:15,031 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.6188687086105347 
2022-04-16 20:30:15,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 20:30:15,036 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 161.9%
2022-04-16 20:31:13,215 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.935, Acc: 0.962, Base Lr: 2.77e-03
2022-04-16 20:31:43,656 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 20:32:48,927 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.7172126770019531 
2022-04-16 20:32:48,932 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 20:32:48,932 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 171.7%
2022-04-16 20:33:49,051 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.932, Acc: 0.961, Base Lr: 2.48e-03
2022-04-16 20:34:19,001 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 20:35:24,527 reid_baseline.train INFO: normal accuracy 0.7846361793196666 1.7563101053237915 
2022-04-16 20:35:24,532 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 20:35:24,532 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 175.6%
2022-04-16 20:36:24,245 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.915, Acc: 0.969, Base Lr: 2.20e-03
2022-04-16 20:36:54,806 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 20:38:00,405 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.716897964477539 
2022-04-16 20:38:00,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 20:38:00,409 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 171.7%
2022-04-16 20:39:00,249 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.913, Acc: 0.968, Base Lr: 1.92e-03
2022-04-16 20:39:29,115 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 20:40:34,459 reid_baseline.train INFO: normal accuracy 0.7846361793196666 1.7393769025802612 
2022-04-16 20:40:34,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 20:40:34,464 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 173.9%
2022-04-16 20:41:33,544 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.909, Acc: 0.972, Base Lr: 1.66e-03
2022-04-16 20:42:03,201 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-04-16 20:43:08,213 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.6985366344451904 
2022-04-16 20:43:08,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 20:43:08,218 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 169.9%
2022-04-16 20:44:06,592 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.902, Acc: 0.968, Base Lr: 1.42e-03
2022-04-16 20:44:36,488 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.580[s] Speed: 27.6[samples/s]
2022-04-16 20:45:41,962 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7645028829574585 
2022-04-16 20:45:41,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 20:45:41,967 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 176.5%
2022-04-16 20:46:39,875 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.890, Acc: 0.977, Base Lr: 1.19e-03
2022-04-16 20:47:09,847 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-04-16 20:48:15,948 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.5771807432174683 
2022-04-16 20:48:15,950 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 20:48:15,950 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 157.7%
2022-04-16 20:49:16,196 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.900, Acc: 0.970, Base Lr: 9.72e-04
2022-04-16 20:49:47,145 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 20:50:51,909 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.6799958944320679 
2022-04-16 20:50:51,913 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 20:50:51,914 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 168.0%
2022-04-16 20:51:50,996 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.896, Acc: 0.972, Base Lr: 7.78e-04
2022-04-16 20:52:20,662 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-04-16 20:53:25,517 reid_baseline.train INFO: normal accuracy 0.7855372831718855 1.7222267389297485 
2022-04-16 20:53:25,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 20:53:25,522 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 172.2%
2022-04-16 20:54:24,613 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.911, Acc: 0.970, Base Lr: 6.04e-04
2022-04-16 20:54:54,111 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-04-16 20:55:59,025 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.6550699472427368 
2022-04-16 20:55:59,028 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 20:55:59,028 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 165.5%
2022-04-16 20:56:57,944 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.908, Acc: 0.966, Base Lr: 4.51e-04
2022-04-16 20:57:28,121 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 20:58:32,597 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.6731986999511719 
2022-04-16 20:58:32,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 20:58:32,600 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 167.3%
2022-04-16 20:59:33,362 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.889, Acc: 0.977, Base Lr: 3.20e-04
2022-04-16 21:00:02,989 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 21:01:08,652 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.726317286491394 
2022-04-16 21:01:08,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 21:01:08,657 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 172.6%
2022-04-16 21:02:08,070 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.896, Acc: 0.974, Base Lr: 2.11e-04
2022-04-16 21:02:37,628 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.585[s] Speed: 27.3[samples/s]
2022-04-16 21:03:43,221 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.6577732563018799 
2022-04-16 21:03:43,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 21:03:43,226 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 165.8%
2022-04-16 21:04:43,115 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.892, Acc: 0.974, Base Lr: 1.26e-04
2022-04-16 21:05:13,527 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 21:06:18,550 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.6959314346313477 
2022-04-16 21:06:18,555 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 21:06:18,555 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 169.6%
2022-04-16 21:07:17,135 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.882, Acc: 0.975, Base Lr: 6.51e-05
2022-04-16 21:07:47,130 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-04-16 21:08:52,777 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7105218172073364 
2022-04-16 21:08:52,781 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 21:08:52,781 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 171.1%
2022-04-16 21:09:52,521 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.909, Acc: 0.970, Base Lr: 2.83e-05
2022-04-16 21:10:23,622 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.598[s] Speed: 26.8[samples/s]
2022-04-16 21:11:28,969 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.7416912317276 
2022-04-16 21:11:28,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 21:11:28,973 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 174.2%
2022-04-16 21:12:29,513 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.879, Acc: 0.978, Base Lr: 1.60e-05
2022-04-16 21:12:58,102 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 21:14:05,570 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.6638020277023315 
2022-04-16 21:14:05,575 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 21:14:05,575 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 166.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_2/transformer_best_model.pth
2022-04-16 21:15:13,819 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.5459171533584595 
2022-04-16 21:15:13,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:15:13,820 reid_baseline.train INFO: Accuracy: 77.9%
2022-04-16 21:16:19,900 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.5459171533584595 
2022-04-16 21:16:19,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:16:19,900 reid_baseline.train INFO: Shuffled Accuracy: 77.9%
2022-04-16 21:16:59,999 reid_baseline.train INFO: normal accuracy 0.9872270292542233 0.6994788646697998 
2022-04-16 21:16:59,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:16:59,999 reid_baseline.train INFO: Source Clean Accuracy: 98.7%
2022-04-16 21:17:05,022 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_2
2022-04-16 21:17:05,023 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-16 21:17:05,023 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 21:17:05,023 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 21:17:05,023 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 21:17:17,478 reid_baseline.train INFO: start training
2022-04-16 21:18:37,040 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.145, Acc: 0.192, Base Lr: 4.76e-04
2022-04-16 21:19:08,219 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.696[s] Speed: 23.0[samples/s]
2022-04-16 21:20:45,780 reid_baseline.train INFO: normal accuracy 0.518935047050723 4.172959804534912 
2022-04-16 21:20:49,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 21:20:49,073 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 417.3%
2022-04-16 21:21:49,169 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.983, Acc: 0.566, Base Lr: 8.72e-04
2022-04-16 21:22:22,339 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.614[s] Speed: 26.1[samples/s]
2022-04-16 21:24:02,575 reid_baseline.train INFO: normal accuracy 0.6098232728941932 4.1681413650512695 
2022-04-16 21:24:03,487 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 21:24:03,487 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 416.8%
2022-04-16 21:25:04,358 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.696, Acc: 0.608, Base Lr: 1.27e-03
2022-04-16 21:25:35,667 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.606[s] Speed: 26.4[samples/s]
2022-04-16 21:27:19,899 reid_baseline.train INFO: normal accuracy 0.6125774615561166 4.137689590454102 
2022-04-16 21:27:20,872 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 21:27:20,872 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 413.8%
2022-04-16 21:28:23,271 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.261, Acc: 0.623, Base Lr: 1.66e-03
2022-04-16 21:28:53,823 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.612[s] Speed: 26.2[samples/s]
2022-04-16 21:30:36,675 reid_baseline.train INFO: normal accuracy 0.6304796878586183 3.9817750453948975 
2022-04-16 21:30:37,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 21:30:37,527 reid_baseline.train INFO: Accuracy: 63.0% Mean Entropy: 398.2%
2022-04-16 21:31:36,915 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.702, Acc: 0.647, Base Lr: 2.06e-03
2022-04-16 21:32:09,182 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.603[s] Speed: 26.5[samples/s]
2022-04-16 21:33:46,643 reid_baseline.train INFO: normal accuracy 0.6515951342666972 3.56632661819458 
2022-04-16 21:33:47,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 21:33:47,585 reid_baseline.train INFO: Accuracy: 65.2% Mean Entropy: 356.6%
2022-04-16 21:34:48,821 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.251, Acc: 0.678, Base Lr: 2.46e-03
2022-04-16 21:35:21,713 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.619[s] Speed: 25.8[samples/s]
2022-04-16 21:37:04,238 reid_baseline.train INFO: normal accuracy 0.6913013541427587 3.055774211883545 
2022-04-16 21:37:05,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 21:37:05,176 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 305.6%
2022-04-16 21:38:06,860 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.942, Acc: 0.715, Base Lr: 2.85e-03
2022-04-16 21:38:36,388 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 21:40:13,225 reid_baseline.train INFO: normal accuracy 0.7296304796878587 2.695169448852539 
2022-04-16 21:40:16,293 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 21:40:16,294 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 269.5%
2022-04-16 21:41:15,233 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.688, Acc: 0.766, Base Lr: 3.25e-03
2022-04-16 21:41:46,344 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 21:43:25,635 reid_baseline.train INFO: normal accuracy 0.761762680743631 2.2984859943389893 
2022-04-16 21:43:26,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 21:43:26,602 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 229.8%
2022-04-16 21:44:28,749 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.553, Acc: 0.800, Base Lr: 3.64e-03
2022-04-16 21:45:00,198 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-04-16 21:46:41,771 reid_baseline.train INFO: normal accuracy 0.795042460408538 2.0967466831207275 
2022-04-16 21:46:42,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 21:46:42,730 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 209.7%
2022-04-16 21:47:42,689 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.392, Acc: 0.835, Base Lr: 4.04e-03
2022-04-16 21:48:13,101 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 21:49:56,806 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.8884057998657227 
2022-04-16 21:49:57,742 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 21:49:57,742 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 188.8%
2022-04-16 21:50:58,851 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.337, Acc: 0.848, Base Lr: 4.44e-03
2022-04-16 21:51:29,465 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.603[s] Speed: 26.5[samples/s]
2022-04-16 21:53:04,513 reid_baseline.train INFO: normal accuracy 0.8120266238237319 1.7132906913757324 
2022-04-16 21:53:05,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 21:53:05,484 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 171.3%
2022-04-16 21:54:07,656 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.270, Acc: 0.867, Base Lr: 4.83e-03
2022-04-16 21:54:39,307 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.617[s] Speed: 25.9[samples/s]
2022-04-16 21:56:16,708 reid_baseline.train INFO: normal accuracy 0.8182235483130594 1.5971012115478516 
2022-04-16 21:56:17,551 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 21:56:17,551 reid_baseline.train INFO: Accuracy: 81.8% Mean Entropy: 159.7%
2022-04-16 21:57:18,446 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.215, Acc: 0.878, Base Lr: 5.23e-03
2022-04-16 21:57:49,792 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.606[s] Speed: 26.4[samples/s]
2022-04-16 21:59:30,754 reid_baseline.train INFO: normal accuracy 0.8260270828551756 1.4666838645935059 
2022-04-16 21:59:31,752 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 21:59:31,752 reid_baseline.train INFO: Accuracy: 82.6% Mean Entropy: 146.7%
2022-04-16 22:00:32,108 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.179, Acc: 0.883, Base Lr: 5.62e-03
2022-04-16 22:01:03,134 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.601[s] Speed: 26.6[samples/s]
2022-04-16 22:02:41,029 reid_baseline.train INFO: normal accuracy 0.8274041771861372 1.5395355224609375 
2022-04-16 22:02:41,034 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 22:02:41,034 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 154.0%
2022-04-16 22:03:42,699 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.111, Acc: 0.910, Base Lr: 6.02e-03
2022-04-16 22:04:13,664 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.609[s] Speed: 26.3[samples/s]
2022-04-16 22:05:55,553 reid_baseline.train INFO: normal accuracy 0.8292403029607528 1.5120950937271118 
2022-04-16 22:05:55,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 22:05:55,558 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 151.2%
2022-04-16 22:06:56,873 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.090, Acc: 0.908, Base Lr: 6.42e-03
2022-04-16 22:07:27,107 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-04-16 22:09:07,265 reid_baseline.train INFO: normal accuracy 0.8338306173972917 1.4856263399124146 
2022-04-16 22:09:07,269 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 22:09:07,270 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 148.6%
2022-04-16 22:10:08,514 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.062, Acc: 0.924, Base Lr: 6.81e-03
2022-04-16 22:10:39,002 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.603[s] Speed: 26.5[samples/s]
2022-04-16 22:12:18,207 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.4368797540664673 
2022-04-16 22:12:20,298 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 22:12:20,298 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 143.7%
2022-04-16 22:13:21,025 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.049, Acc: 0.927, Base Lr: 7.21e-03
2022-04-16 22:13:53,034 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.610[s] Speed: 26.2[samples/s]
2022-04-16 22:15:37,688 reid_baseline.train INFO: normal accuracy 0.8308469130135414 1.4652938842773438 
2022-04-16 22:15:37,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 22:15:37,692 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 146.5%
2022-04-16 22:16:39,933 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.025, Acc: 0.939, Base Lr: 7.60e-03
2022-04-16 22:17:10,020 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.607[s] Speed: 26.3[samples/s]
2022-04-16 22:18:49,664 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.33202064037323 
2022-04-16 22:18:50,545 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 22:18:50,545 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 133.2%
2022-04-16 22:19:50,311 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.991, Acc: 0.939, Base Lr: 4.01e-03
2022-04-16 22:20:20,778 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-04-16 22:22:04,279 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.4040093421936035 
2022-04-16 22:22:04,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 22:22:04,284 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 140.4%
2022-04-16 22:23:05,187 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.968, Acc: 0.955, Base Lr: 3.69e-03
2022-04-16 22:23:36,010 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.603[s] Speed: 26.5[samples/s]
2022-04-16 22:25:15,594 reid_baseline.train INFO: normal accuracy 0.8313059444571953 1.4736195802688599 
2022-04-16 22:25:15,599 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 22:25:15,599 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 147.4%
2022-04-16 22:26:16,434 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.946, Acc: 0.962, Base Lr: 3.38e-03
2022-04-16 22:26:47,003 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.601[s] Speed: 26.6[samples/s]
2022-04-16 22:28:26,965 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.4453511238098145 
2022-04-16 22:28:26,970 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 22:28:26,970 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 144.5%
2022-04-16 22:29:28,372 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.949, Acc: 0.959, Base Lr: 3.08e-03
2022-04-16 22:29:59,579 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.608[s] Speed: 26.3[samples/s]
2022-04-16 22:31:43,308 reid_baseline.train INFO: normal accuracy 0.8352077117282534 1.3922412395477295 
2022-04-16 22:31:43,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 22:31:43,313 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 139.2%
2022-04-16 22:32:42,796 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.934, Acc: 0.963, Base Lr: 2.77e-03
2022-04-16 22:33:13,648 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-04-16 22:34:47,543 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.4953553676605225 
2022-04-16 22:34:47,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 22:34:47,548 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 149.5%
2022-04-16 22:35:47,580 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.931, Acc: 0.961, Base Lr: 2.48e-03
2022-04-16 22:36:18,772 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-04-16 22:37:53,894 reid_baseline.train INFO: normal accuracy 0.8347486802845995 1.5253260135650635 
2022-04-16 22:37:53,899 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 22:37:53,899 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 152.5%
2022-04-16 22:38:55,809 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.915, Acc: 0.969, Base Lr: 2.20e-03
2022-04-16 22:39:27,071 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-04-16 22:41:09,232 reid_baseline.train INFO: normal accuracy 0.8347486802845995 1.4739702939987183 
2022-04-16 22:41:09,234 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 22:41:09,235 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 147.4%
2022-04-16 22:42:11,027 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.914, Acc: 0.967, Base Lr: 1.92e-03
2022-04-16 22:42:40,590 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.601[s] Speed: 26.6[samples/s]
2022-04-16 22:44:17,133 reid_baseline.train INFO: normal accuracy 0.8400275418866192 1.4974561929702759 
2022-04-16 22:44:17,138 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 22:44:17,138 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 149.7%
2022-04-16 22:45:18,883 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.909, Acc: 0.971, Base Lr: 1.66e-03
2022-04-16 22:45:49,925 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.610[s] Speed: 26.2[samples/s]
2022-04-16 22:47:31,902 reid_baseline.train INFO: normal accuracy 0.8361257746155611 1.4667716026306152 
2022-04-16 22:47:31,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 22:47:31,906 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 146.7%
2022-04-16 22:48:31,514 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.903, Acc: 0.970, Base Lr: 1.42e-03
2022-04-16 22:49:01,826 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-04-16 22:50:39,651 reid_baseline.train INFO: normal accuracy 0.8356667431719073 1.5180684328079224 
2022-04-16 22:50:39,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 22:50:39,656 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 151.8%
2022-04-16 22:51:39,117 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.890, Acc: 0.976, Base Lr: 1.19e-03
2022-04-16 22:52:09,549 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-04-16 22:53:37,701 reid_baseline.train INFO: normal accuracy 0.8391094789993114 1.3333090543746948 
2022-04-16 22:53:37,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 22:53:37,705 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 133.3%
2022-04-16 22:54:38,414 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.899, Acc: 0.971, Base Lr: 9.72e-04
2022-04-16 22:55:09,226 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-04-16 22:56:38,891 reid_baseline.train INFO: normal accuracy 0.8349781960064264 1.4408949613571167 
2022-04-16 22:56:38,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 22:56:38,894 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 144.1%
2022-04-16 22:57:38,372 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.896, Acc: 0.973, Base Lr: 7.78e-04
2022-04-16 22:58:08,117 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 22:59:35,962 reid_baseline.train INFO: normal accuracy 0.8377323846683498 1.4796299934387207 
2022-04-16 22:59:35,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 22:59:35,967 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 148.0%
2022-04-16 23:00:35,506 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.911, Acc: 0.968, Base Lr: 6.04e-04
2022-04-16 23:01:05,177 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.587[s] Speed: 27.3[samples/s]
2022-04-16 23:02:36,270 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.414846658706665 
2022-04-16 23:02:36,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 23:02:36,275 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 141.5%
2022-04-16 23:03:35,691 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.907, Acc: 0.968, Base Lr: 4.51e-04
2022-04-16 23:04:05,944 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-04-16 23:05:33,029 reid_baseline.train INFO: normal accuracy 0.8397980261647923 1.4291096925735474 
2022-04-16 23:05:33,034 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 23:05:33,034 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 142.9%
2022-04-16 23:06:33,789 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.889, Acc: 0.981, Base Lr: 3.20e-04
2022-04-16 23:07:03,838 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 23:08:30,262 reid_baseline.train INFO: normal accuracy 0.8377323846683498 1.4810993671417236 
2022-04-16 23:08:30,267 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 23:08:30,267 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 148.1%
2022-04-16 23:09:29,581 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.896, Acc: 0.973, Base Lr: 2.11e-04
2022-04-16 23:09:59,432 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 23:11:29,250 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4171161651611328 
2022-04-16 23:11:29,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 23:11:29,255 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 141.7%
2022-04-16 23:12:29,520 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.892, Acc: 0.976, Base Lr: 1.26e-04
2022-04-16 23:12:59,993 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.597[s] Speed: 26.8[samples/s]
2022-04-16 23:14:34,325 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.4556671380996704 
2022-04-16 23:14:34,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 23:14:34,330 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 145.6%
2022-04-16 23:15:32,971 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.883, Acc: 0.977, Base Lr: 6.51e-05
2022-04-16 23:16:02,913 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-04-16 23:17:35,077 reid_baseline.train INFO: normal accuracy 0.8384209318338306 1.4681299924850464 
2022-04-16 23:17:35,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 23:17:35,082 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 146.8%
2022-04-16 23:18:34,841 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.909, Acc: 0.969, Base Lr: 2.83e-05
2022-04-16 23:19:03,651 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-04-16 23:20:30,980 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.498526930809021 
2022-04-16 23:20:30,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 23:20:30,984 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 149.9%
2022-04-16 23:21:31,395 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.880, Acc: 0.979, Base Lr: 1.60e-05
2022-04-16 23:22:00,048 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 23:23:29,866 reid_baseline.train INFO: normal accuracy 0.8381914161120037 1.414203405380249 
2022-04-16 23:23:29,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 23:23:29,871 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 141.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_2/transformer_best_model.pth
2022-04-16 23:25:05,480 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.33202064037323 
2022-04-16 23:25:05,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:25:05,480 reid_baseline.train INFO: Accuracy: 83.2%
2022-04-16 23:26:32,461 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.33202064037323 
2022-04-16 23:26:32,461 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:26:32,461 reid_baseline.train INFO: Shuffled Accuracy: 83.2%
2022-04-16 23:27:12,322 reid_baseline.train INFO: normal accuracy 0.9872270292542233 0.6991708874702454 
2022-04-16 23:27:12,322 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 23:27:12,322 reid_baseline.train INFO: Source Clean Accuracy: 98.7%
2022-04-16 23:27:16,903 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_3
2022-04-16 23:27:16,904 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-16 23:27:16,904 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 23:27:16,904 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 23:27:16,904 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 23:27:30,335 reid_baseline.train INFO: start training
2022-04-16 23:28:51,900 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.145, Acc: 0.198, Base Lr: 4.76e-04
2022-04-16 23:29:22,788 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-04-16 23:30:29,540 reid_baseline.train INFO: normal accuracy 0.4372606442892543 4.1730146408081055 
2022-04-16 23:30:30,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 23:30:30,309 reid_baseline.train INFO: Accuracy: 43.7% Mean Entropy: 417.3%
2022-04-16 23:31:28,741 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.984, Acc: 0.569, Base Lr: 8.72e-04
2022-04-16 23:32:02,267 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.605[s] Speed: 26.4[samples/s]
2022-04-16 23:33:09,056 reid_baseline.train INFO: normal accuracy 0.5266952016219869 4.169122695922852 
2022-04-16 23:33:09,909 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 23:33:09,909 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 416.9%
2022-04-16 23:34:08,875 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.698, Acc: 0.602, Base Lr: 1.27e-03
2022-04-16 23:34:39,066 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-04-16 23:35:45,450 reid_baseline.train INFO: normal accuracy 0.5271457535480965 4.1482157707214355 
2022-04-16 23:35:46,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 23:35:46,319 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 414.8%
2022-04-16 23:36:45,977 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.261, Acc: 0.624, Base Lr: 1.66e-03
2022-04-16 23:37:15,344 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.585[s] Speed: 27.3[samples/s]
2022-04-16 23:38:08,449 reid_baseline.train INFO: normal accuracy 0.5350304122550124 4.042071342468262 
