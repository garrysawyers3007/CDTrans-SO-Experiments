2022-05-18 13:00:03,510 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_ArtSO_W_k
2022-05-18 13:00:03,510 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_ArtSO_W_k', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2_ArtSO_Dom_Cls/transformer_best_model.pth')
2022-05-18 13:00:03,510 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-18 13:00:03,510 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-18 13:00:03,510 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_ArtSO_W_k
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-18 13:00:14,635 reid_baseline.train INFO: start training
2022-05-18 13:00:42,778 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.140, Acc: 0.042, Base Lr: 8.72e-04
2022-05-18 13:01:08,132 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 3.948, Acc: 0.112, Base Lr: 8.72e-04
2022-05-18 13:01:29,396 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-05-18 13:01:57,002 reid_baseline.train INFO: normal accuracy 0.19942315615986814 3.938779830932617 
2022-05-18 13:01:59,036 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-18 13:01:59,037 reid_baseline.train INFO: Accuracy: 19.9% Mean Entropy: 393.9%
2022-05-18 13:02:24,642 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 2.930, Acc: 0.589, Base Lr: 1.66e-03
2022-05-18 13:02:52,011 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 2.651, Acc: 0.666, Base Lr: 1.66e-03
2022-05-18 13:03:12,454 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-05-18 13:03:40,735 reid_baseline.train INFO: normal accuracy 0.5241038318912238 3.5893611907958984 
2022-05-18 13:03:41,521 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-18 13:03:41,522 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 358.9%
2022-05-18 13:04:09,065 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 1.577, Acc: 0.891, Base Lr: 2.46e-03
2022-05-18 13:04:36,142 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 1.436, Acc: 0.904, Base Lr: 2.46e-03
2022-05-18 13:04:55,360 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.266[s] Speed: 60.2[samples/s]
2022-05-18 13:05:23,535 reid_baseline.train INFO: normal accuracy 0.6411207251751133 2.833064556121826 
2022-05-18 13:05:24,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-18 13:05:24,465 reid_baseline.train INFO: Accuracy: 64.1% Mean Entropy: 283.3%
2022-05-18 13:05:53,085 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.029, Acc: 0.961, Base Lr: 3.25e-03
2022-05-18 13:06:18,451 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 1.004, Acc: 0.958, Base Lr: 3.25e-03
2022-05-18 13:06:38,474 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.266[s] Speed: 60.1[samples/s]
2022-05-18 13:07:07,108 reid_baseline.train INFO: normal accuracy 0.6716110424392254 2.43149471282959 
2022-05-18 13:07:07,899 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-18 13:07:07,900 reid_baseline.train INFO: Accuracy: 67.2% Mean Entropy: 243.1%
2022-05-18 13:07:36,303 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.910, Acc: 0.977, Base Lr: 4.04e-03
2022-05-18 13:08:01,721 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.900, Acc: 0.977, Base Lr: 4.04e-03
2022-05-18 13:08:21,729 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.265[s] Speed: 60.4[samples/s]
2022-05-18 13:08:51,494 reid_baseline.train INFO: normal accuracy 0.6749072929542645 2.0778305530548096 
2022-05-18 13:08:52,308 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-18 13:08:52,308 reid_baseline.train INFO: Accuracy: 67.5% Mean Entropy: 207.8%
2022-05-18 13:09:20,456 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.859, Acc: 0.986, Base Lr: 4.83e-03
2022-05-18 13:09:45,441 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.865, Acc: 0.980, Base Lr: 4.83e-03
2022-05-18 13:10:05,075 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-05-18 13:10:35,791 reid_baseline.train INFO: normal accuracy 0.6868562010712814 2.070195436477661 
2022-05-18 13:10:36,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-18 13:10:36,583 reid_baseline.train INFO: Accuracy: 68.7% Mean Entropy: 207.0%
2022-05-18 13:11:01,371 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.834, Acc: 0.989, Base Lr: 5.62e-03
2022-05-18 13:11:26,976 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.841, Acc: 0.988, Base Lr: 5.62e-03
2022-05-18 13:11:46,836 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-05-18 13:12:17,135 reid_baseline.train INFO: normal accuracy 0.6835599505562423 2.0073890686035156 
2022-05-18 13:12:17,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-18 13:12:17,915 reid_baseline.train INFO: Accuracy: 68.4% Mean Entropy: 200.7%
2022-05-18 13:12:44,756 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.820, Acc: 0.991, Base Lr: 6.42e-03
2022-05-18 13:13:10,090 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.821, Acc: 0.990, Base Lr: 6.42e-03
2022-05-18 13:13:31,332 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-05-18 13:14:00,568 reid_baseline.train INFO: normal accuracy 0.6856201071281417 2.068523406982422 
2022-05-18 13:14:00,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-18 13:14:00,573 reid_baseline.train INFO: Accuracy: 68.6% Mean Entropy: 206.9%
2022-05-18 13:14:27,157 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.812, Acc: 0.993, Base Lr: 7.21e-03
2022-05-18 13:14:53,306 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.810, Acc: 0.994, Base Lr: 7.21e-03
2022-05-18 13:15:14,498 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.266[s] Speed: 60.2[samples/s]
2022-05-18 13:15:43,098 reid_baseline.train INFO: normal accuracy 0.6934487021013597 2.064584493637085 
2022-05-18 13:15:43,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-18 13:15:43,102 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 206.5%
2022-05-18 13:16:09,302 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.803, Acc: 0.992, Base Lr: 4.01e-03
2022-05-18 13:16:36,440 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.801, Acc: 0.993, Base Lr: 4.01e-03
2022-05-18 13:16:57,155 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.266[s] Speed: 60.1[samples/s]
2022-05-18 13:17:26,526 reid_baseline.train INFO: normal accuracy 0.6934487021013597 2.0969839096069336 
2022-05-18 13:17:26,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-18 13:17:26,531 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 209.7%
2022-05-18 13:17:53,995 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.795, Acc: 0.994, Base Lr: 3.38e-03
2022-05-18 13:18:21,166 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.798, Acc: 0.993, Base Lr: 3.38e-03
2022-05-18 13:18:41,201 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.269[s] Speed: 59.6[samples/s]
2022-05-18 13:19:09,590 reid_baseline.train INFO: normal accuracy 0.6950968273588792 2.075805187225342 
2022-05-18 13:19:09,595 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-18 13:19:09,595 reid_baseline.train INFO: Accuracy: 69.5% Mean Entropy: 207.6%
2022-05-18 13:19:38,241 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.788, Acc: 0.993, Base Lr: 2.77e-03
2022-05-18 13:20:04,527 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.789, Acc: 0.994, Base Lr: 2.77e-03
2022-05-18 13:20:24,556 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.270[s] Speed: 59.3[samples/s]
2022-05-18 13:20:52,757 reid_baseline.train INFO: normal accuracy 0.6934487021013597 2.063263177871704 
2022-05-18 13:20:52,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-18 13:20:52,762 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 206.3%
2022-05-18 13:21:21,200 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.788, Acc: 0.996, Base Lr: 2.20e-03
2022-05-18 13:21:46,954 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.787, Acc: 0.995, Base Lr: 2.20e-03
2022-05-18 13:22:06,945 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.267[s] Speed: 60.0[samples/s]
2022-05-18 13:22:36,852 reid_baseline.train INFO: normal accuracy 0.7004532344458179 2.0991265773773193 
2022-05-18 13:22:36,856 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-18 13:22:36,857 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 209.9%
2022-05-18 13:23:04,390 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.784, Acc: 0.997, Base Lr: 1.66e-03
2022-05-18 13:23:29,974 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.783, Acc: 0.997, Base Lr: 1.66e-03
2022-05-18 13:23:49,791 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.262[s] Speed: 61.0[samples/s]
2022-05-18 13:24:20,473 reid_baseline.train INFO: normal accuracy 0.696332921302019 2.1544413566589355 
2022-05-18 13:24:20,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-18 13:24:20,478 reid_baseline.train INFO: Accuracy: 69.6% Mean Entropy: 215.4%
2022-05-18 13:24:47,663 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.776, Acc: 0.997, Base Lr: 1.19e-03
2022-05-18 13:25:13,246 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.782, Acc: 0.995, Base Lr: 1.19e-03
2022-05-18 13:25:33,779 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.264[s] Speed: 60.7[samples/s]
2022-05-18 13:26:04,744 reid_baseline.train INFO: normal accuracy 0.6983930778739185 2.089451789855957 
2022-05-18 13:26:04,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-18 13:26:04,749 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 208.9%
2022-05-18 13:26:30,955 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.780, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 13:26:56,065 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.778, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 13:27:17,333 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.261[s] Speed: 61.3[samples/s]
2022-05-18 13:27:46,983 reid_baseline.train INFO: normal accuracy 0.6967449526163988 2.10726261138916 
2022-05-18 13:27:46,987 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-18 13:27:46,988 reid_baseline.train INFO: Accuracy: 69.7% Mean Entropy: 210.7%
2022-05-18 13:28:15,309 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.778, Acc: 0.999, Base Lr: 4.51e-04
2022-05-18 13:28:41,884 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.780, Acc: 0.997, Base Lr: 4.51e-04
2022-05-18 13:29:03,099 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.273[s] Speed: 58.5[samples/s]
2022-05-18 13:29:33,213 reid_baseline.train INFO: normal accuracy 0.6992171405026782 2.0570805072784424 
2022-05-18 13:29:33,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-18 13:29:33,218 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 205.7%
2022-05-18 13:29:57,799 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.776, Acc: 0.996, Base Lr: 2.11e-04
2022-05-18 13:30:17,807 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.780, Acc: 0.996, Base Lr: 2.11e-04
2022-05-18 13:30:37,824 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.232[s] Speed: 68.9[samples/s]
2022-05-18 13:31:05,180 reid_baseline.train INFO: normal accuracy 0.6967449526163988 2.067289352416992 
2022-05-18 13:31:05,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-18 13:31:05,185 reid_baseline.train INFO: Accuracy: 69.7% Mean Entropy: 206.7%
2022-05-18 13:31:33,141 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.782, Acc: 0.994, Base Lr: 6.51e-05
2022-05-18 13:31:59,235 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.779, Acc: 0.995, Base Lr: 6.51e-05
2022-05-18 13:32:19,900 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 13:32:51,626 reid_baseline.train INFO: normal accuracy 0.6975690152451587 2.078066110610962 
2022-05-18 13:32:51,631 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-18 13:32:51,631 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 207.8%
2022-05-18 13:33:16,903 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.778, Acc: 0.997, Base Lr: 1.60e-05
2022-05-18 13:33:36,452 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.778, Acc: 0.997, Base Lr: 1.60e-05
2022-05-18 13:33:56,043 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.232[s] Speed: 69.1[samples/s]
2022-05-18 13:34:27,215 reid_baseline.train INFO: normal accuracy 0.6975690152451587 2.1357269287109375 
2022-05-18 13:34:27,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-18 13:34:27,220 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 213.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_ArtSO_W_k/transformer_best_model.pth
2022-05-18 13:34:57,640 reid_baseline.train INFO: normal accuracy 0.6835599505562423 2.0073890686035156 
2022-05-18 13:34:57,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 13:34:57,641 reid_baseline.train INFO: Accuracy: 68.4%
2022-05-18 13:35:28,005 reid_baseline.train INFO: normal accuracy 0.6835599505562423 2.0073890686035156 
2022-05-18 13:35:28,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 13:35:28,006 reid_baseline.train INFO: Shuffled Accuracy: 68.4%
2022-05-18 13:36:21,902 reid_baseline.train INFO: normal accuracy 0.9932417211083577 0.5657796263694763 
2022-05-18 13:36:21,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 13:36:21,903 reid_baseline.train INFO: Source Clean Accuracy: 99.3%
2022-05-18 13:36:26,449 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_W_k
2022-05-18 13:36:26,450 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_W_k', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_Dom_Cls/transformer_best_model.pth')
2022-05-18 13:36:26,450 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-18 13:36:26,450 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-18 13:36:26,450 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_W_k
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-18 13:36:37,460 reid_baseline.train INFO: start training
2022-05-18 13:37:05,443 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.151, Acc: 0.039, Base Lr: 8.72e-04
2022-05-18 13:37:33,793 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 3.954, Acc: 0.105, Base Lr: 8.72e-04
2022-05-18 13:37:54,143 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.274[s] Speed: 58.4[samples/s]
2022-05-18 13:38:45,209 reid_baseline.train INFO: normal accuracy 0.17502863688430698 3.9730403423309326 
2022-05-18 13:38:45,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-18 13:38:45,953 reid_baseline.train INFO: Accuracy: 17.5% Mean Entropy: 397.3%
2022-05-18 13:39:14,497 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 2.912, Acc: 0.605, Base Lr: 1.66e-03
2022-05-18 13:39:40,857 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 2.634, Acc: 0.675, Base Lr: 1.66e-03
2022-05-18 13:40:00,452 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-05-18 13:40:53,222 reid_baseline.train INFO: normal accuracy 0.41305841924398623 3.6610114574432373 
2022-05-18 13:40:54,025 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-18 13:40:54,025 reid_baseline.train INFO: Accuracy: 41.3% Mean Entropy: 366.1%
2022-05-18 13:41:19,608 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 1.564, Acc: 0.896, Base Lr: 2.46e-03
2022-05-18 13:41:46,796 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 1.424, Acc: 0.908, Base Lr: 2.46e-03
2022-05-18 13:42:07,456 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-05-18 13:42:58,244 reid_baseline.train INFO: normal accuracy 0.488659793814433 2.984058380126953 
2022-05-18 13:42:58,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-18 13:42:58,989 reid_baseline.train INFO: Accuracy: 48.9% Mean Entropy: 298.4%
2022-05-18 13:43:26,334 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.021, Acc: 0.961, Base Lr: 3.25e-03
2022-05-18 13:43:55,031 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 0.998, Acc: 0.959, Base Lr: 3.25e-03
2022-05-18 13:44:14,194 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.270[s] Speed: 59.2[samples/s]
2022-05-18 13:45:05,189 reid_baseline.train INFO: normal accuracy 0.5097365406643757 2.6218056678771973 
2022-05-18 13:45:07,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-18 13:45:07,442 reid_baseline.train INFO: Accuracy: 51.0% Mean Entropy: 262.2%
2022-05-18 13:45:36,689 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.910, Acc: 0.976, Base Lr: 4.04e-03
2022-05-18 13:46:02,677 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.901, Acc: 0.976, Base Lr: 4.04e-03
2022-05-18 13:46:22,277 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 13:47:14,942 reid_baseline.train INFO: normal accuracy 0.5063001145475372 2.302980422973633 
2022-05-18 13:47:15,759 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-18 13:47:15,759 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 230.3%
2022-05-18 13:47:43,143 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.858, Acc: 0.987, Base Lr: 4.83e-03
2022-05-18 13:48:09,886 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.865, Acc: 0.981, Base Lr: 4.83e-03
2022-05-18 13:48:31,094 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 13:49:21,676 reid_baseline.train INFO: normal accuracy 0.5131729667812142 2.192342758178711 
2022-05-18 13:49:22,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-18 13:49:22,440 reid_baseline.train INFO: Accuracy: 51.3% Mean Entropy: 219.2%
2022-05-18 13:49:50,606 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.835, Acc: 0.989, Base Lr: 5.62e-03
2022-05-18 13:50:18,026 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.842, Acc: 0.988, Base Lr: 5.62e-03
2022-05-18 13:50:37,710 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 13:51:29,120 reid_baseline.train INFO: normal accuracy 0.5150057273768613 2.2091357707977295 
2022-05-18 13:51:29,125 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-18 13:51:29,125 reid_baseline.train INFO: Accuracy: 51.5% Mean Entropy: 220.9%
2022-05-18 13:51:56,962 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.821, Acc: 0.991, Base Lr: 6.42e-03
2022-05-18 13:52:23,555 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.823, Acc: 0.991, Base Lr: 6.42e-03
2022-05-18 13:52:43,510 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.267[s] Speed: 59.8[samples/s]
2022-05-18 13:53:35,554 reid_baseline.train INFO: normal accuracy 0.509049255441008 2.2527434825897217 
2022-05-18 13:53:35,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-18 13:53:35,554 reid_baseline.train INFO: Accuracy: 50.9% Mean Entropy: 225.3%
2022-05-18 13:54:02,161 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.812, Acc: 0.994, Base Lr: 7.21e-03
2022-05-18 13:54:30,041 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.811, Acc: 0.993, Base Lr: 7.21e-03
2022-05-18 13:54:50,884 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 13:55:40,313 reid_baseline.train INFO: normal accuracy 0.518213058419244 2.182164192199707 
2022-05-18 13:55:41,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-18 13:55:41,048 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 218.2%
2022-05-18 13:56:09,775 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.804, Acc: 0.992, Base Lr: 4.01e-03
2022-05-18 13:56:37,233 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.802, Acc: 0.993, Base Lr: 4.01e-03
2022-05-18 13:56:57,092 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.273[s] Speed: 58.6[samples/s]
2022-05-18 13:57:49,283 reid_baseline.train INFO: normal accuracy 0.515922107674685 2.2909960746765137 
2022-05-18 13:57:49,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-18 13:57:49,286 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 229.1%
2022-05-18 13:58:17,065 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.795, Acc: 0.995, Base Lr: 3.38e-03
2022-05-18 13:58:43,323 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.797, Acc: 0.994, Base Lr: 3.38e-03
2022-05-18 13:59:04,103 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 13:59:55,144 reid_baseline.train INFO: normal accuracy 0.5108820160366552 2.2877707481384277 
2022-05-18 13:59:55,147 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-18 13:59:55,147 reid_baseline.train INFO: Accuracy: 51.1% Mean Entropy: 228.8%
2022-05-18 14:00:21,783 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.789, Acc: 0.994, Base Lr: 2.77e-03
2022-05-18 14:00:49,897 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.790, Acc: 0.994, Base Lr: 2.77e-03
2022-05-18 14:01:09,966 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 14:02:02,402 reid_baseline.train INFO: normal accuracy 0.5248568155784651 2.2414422035217285 
2022-05-18 14:02:02,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-18 14:02:02,404 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 224.1%
2022-05-18 14:02:31,961 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.788, Acc: 0.996, Base Lr: 2.20e-03
2022-05-18 14:02:59,050 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.786, Acc: 0.995, Base Lr: 2.20e-03
2022-05-18 14:03:20,142 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-05-18 14:04:02,224 reid_baseline.train INFO: normal accuracy 0.5337915234822451 2.2979257106781006 
2022-05-18 14:04:02,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-18 14:04:02,229 reid_baseline.train INFO: Accuracy: 53.4% Mean Entropy: 229.8%
2022-05-18 14:04:29,396 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.784, Acc: 0.997, Base Lr: 1.66e-03
2022-05-18 14:04:57,392 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.783, Acc: 0.997, Base Lr: 1.66e-03
2022-05-18 14:05:17,208 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 14:06:06,511 reid_baseline.train INFO: normal accuracy 0.5257731958762887 2.3380866050720215 
2022-05-18 14:06:06,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-18 14:06:06,514 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 233.8%
2022-05-18 14:06:35,587 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.776, Acc: 0.998, Base Lr: 1.19e-03
2022-05-18 14:07:01,808 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.782, Acc: 0.995, Base Lr: 1.19e-03
2022-05-18 14:07:21,723 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.270[s] Speed: 59.2[samples/s]
2022-05-18 14:08:12,976 reid_baseline.train INFO: normal accuracy 0.5276059564719359 2.279339075088501 
2022-05-18 14:08:12,978 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-18 14:08:12,978 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 227.9%
2022-05-18 14:08:40,412 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.781, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 14:09:05,659 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.779, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 14:09:26,749 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.265[s] Speed: 60.4[samples/s]
2022-05-18 14:10:16,624 reid_baseline.train INFO: normal accuracy 0.5271477663230241 2.3099281787872314 
2022-05-18 14:10:16,626 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-18 14:10:16,626 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 231.0%
2022-05-18 14:10:44,182 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.779, Acc: 0.998, Base Lr: 4.51e-04
2022-05-18 14:11:12,249 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.780, Acc: 0.997, Base Lr: 4.51e-04
2022-05-18 14:11:31,921 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 14:12:20,798 reid_baseline.train INFO: normal accuracy 0.5262313860252005 2.2645463943481445 
2022-05-18 14:12:20,800 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-18 14:12:20,801 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 226.5%
2022-05-18 14:12:50,257 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.776, Acc: 0.996, Base Lr: 2.11e-04
2022-05-18 14:13:16,351 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.780, Acc: 0.995, Base Lr: 2.11e-04
2022-05-18 14:13:36,220 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 14:14:26,809 reid_baseline.train INFO: normal accuracy 0.5234822451317297 2.2623114585876465 
2022-05-18 14:14:26,811 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-18 14:14:26,811 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 226.2%
2022-05-18 14:14:54,150 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.781, Acc: 0.996, Base Lr: 6.51e-05
2022-05-18 14:15:18,072 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.778, Acc: 0.996, Base Lr: 6.51e-05
2022-05-18 14:15:40,387 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-05-18 14:16:31,965 reid_baseline.train INFO: normal accuracy 0.5243986254295533 2.281219482421875 
2022-05-18 14:16:31,968 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-18 14:16:31,968 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 228.1%
2022-05-18 14:16:58,880 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.778, Acc: 0.997, Base Lr: 1.60e-05
2022-05-18 14:17:26,985 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.778, Acc: 0.996, Base Lr: 1.60e-05
2022-05-18 14:17:48,384 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-05-18 14:18:29,906 reid_baseline.train INFO: normal accuracy 0.5239404352806415 2.321638345718384 
2022-05-18 14:18:29,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-18 14:18:29,911 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 232.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_W_k/transformer_best_model.pth
2022-05-18 14:19:22,394 reid_baseline.train INFO: normal accuracy 0.518213058419244 2.182164192199707 
2022-05-18 14:19:22,394 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:19:22,394 reid_baseline.train INFO: Accuracy: 51.8%
2022-05-18 14:20:14,258 reid_baseline.train INFO: normal accuracy 0.518213058419244 2.182164192199707 
2022-05-18 14:20:14,258 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:20:14,258 reid_baseline.train INFO: Shuffled Accuracy: 51.8%
2022-05-18 14:21:05,406 reid_baseline.train INFO: normal accuracy 0.9954944807389051 0.5269936919212341 
2022-05-18 14:21:05,406 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:21:05,407 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-05-18 14:21:09,858 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_W_k
2022-05-18 14:21:09,859 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_W_k', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_Dom_Cls/transformer_best_model.pth')
2022-05-18 14:21:09,859 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-18 14:21:09,859 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-18 14:21:09,859 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_W_k
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-18 14:21:20,856 reid_baseline.train INFO: start training
2022-05-18 14:21:47,045 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 4.137, Acc: 0.046, Base Lr: 8.72e-04
2022-05-18 14:22:15,708 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 3.937, Acc: 0.118, Base Lr: 8.72e-04
2022-05-18 14:22:34,058 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.262[s] Speed: 61.2[samples/s]
2022-05-18 14:23:25,205 reid_baseline.train INFO: normal accuracy 0.342896488409456 3.9700794219970703 
2022-05-18 14:23:25,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-18 14:23:25,918 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 397.0%
2022-05-18 14:23:53,147 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 2.870, Acc: 0.611, Base Lr: 1.66e-03
2022-05-18 14:24:19,935 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 2.577, Acc: 0.690, Base Lr: 1.66e-03
2022-05-18 14:24:38,550 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.261[s] Speed: 61.2[samples/s]
2022-05-18 14:25:30,772 reid_baseline.train INFO: normal accuracy 0.7069084232269911 3.3179712295532227 
2022-05-18 14:25:31,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-18 14:25:31,531 reid_baseline.train INFO: Accuracy: 70.7% Mean Entropy: 331.8%
2022-05-18 14:25:58,191 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 1.505, Acc: 0.900, Base Lr: 2.46e-03
2022-05-18 14:26:25,209 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 1.375, Acc: 0.912, Base Lr: 2.46e-03
2022-05-18 14:26:46,146 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-05-18 14:27:35,780 reid_baseline.train INFO: normal accuracy 0.7936653660775763 2.2224159240722656 
2022-05-18 14:27:36,556 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-18 14:27:36,556 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 222.2%
2022-05-18 14:28:05,434 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 1.001, Acc: 0.969, Base Lr: 3.25e-03
2022-05-18 14:28:31,884 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 0.981, Acc: 0.964, Base Lr: 3.25e-03
2022-05-18 14:28:51,810 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.271[s] Speed: 59.1[samples/s]
2022-05-18 14:29:43,911 reid_baseline.train INFO: normal accuracy 0.8120266238237319 1.7999236583709717 
2022-05-18 14:29:44,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-18 14:29:44,681 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 180.0%
2022-05-18 14:30:12,115 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.903, Acc: 0.978, Base Lr: 4.04e-03
2022-05-18 14:30:36,573 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.895, Acc: 0.977, Base Lr: 4.04e-03
2022-05-18 14:30:57,675 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.262[s] Speed: 61.0[samples/s]
2022-05-18 14:31:49,305 reid_baseline.train INFO: normal accuracy 0.8209777369749828 1.4791978597640991 
2022-05-18 14:31:50,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-18 14:31:50,108 reid_baseline.train INFO: Accuracy: 82.1% Mean Entropy: 147.9%
2022-05-18 14:32:17,460 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.855, Acc: 0.986, Base Lr: 4.83e-03
2022-05-18 14:32:44,967 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.860, Acc: 0.982, Base Lr: 4.83e-03
2022-05-18 14:33:04,870 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-05-18 14:33:54,896 reid_baseline.train INFO: normal accuracy 0.8251090199678678 1.4655624628067017 
2022-05-18 14:33:55,932 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-18 14:33:55,932 reid_baseline.train INFO: Accuracy: 82.5% Mean Entropy: 146.6%
2022-05-18 14:34:24,891 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.833, Acc: 0.990, Base Lr: 5.62e-03
2022-05-18 14:34:51,775 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.839, Acc: 0.988, Base Lr: 5.62e-03
2022-05-18 14:35:12,869 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.277[s] Speed: 57.8[samples/s]
2022-05-18 14:36:05,415 reid_baseline.train INFO: normal accuracy 0.8235024099150792 1.4400864839553833 
2022-05-18 14:36:06,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-18 14:36:06,214 reid_baseline.train INFO: Accuracy: 82.4% Mean Entropy: 144.0%
2022-05-18 14:36:35,181 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.818, Acc: 0.991, Base Lr: 6.42e-03
2022-05-18 14:36:53,400 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.820, Acc: 0.991, Base Lr: 6.42e-03
2022-05-18 14:37:06,723 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.217[s] Speed: 73.6[samples/s]
2022-05-18 14:37:39,239 reid_baseline.train INFO: normal accuracy 0.8186825797567133 1.4660464525222778 
2022-05-18 14:37:39,242 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-18 14:37:39,242 reid_baseline.train INFO: Accuracy: 81.9% Mean Entropy: 146.6%
2022-05-18 14:37:59,693 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.812, Acc: 0.994, Base Lr: 7.21e-03
2022-05-18 14:38:16,200 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.810, Acc: 0.993, Base Lr: 7.21e-03
2022-05-18 14:38:29,501 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.179[s] Speed: 89.4[samples/s]
2022-05-18 14:39:02,710 reid_baseline.train INFO: normal accuracy 0.8218957998622906 1.4776415824890137 
2022-05-18 14:39:02,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-18 14:39:02,710 reid_baseline.train INFO: Accuracy: 82.2% Mean Entropy: 147.8%
2022-05-18 14:39:22,415 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.804, Acc: 0.991, Base Lr: 4.01e-03
2022-05-18 14:39:39,037 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.801, Acc: 0.993, Base Lr: 4.01e-03
2022-05-18 14:39:52,277 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.178[s] Speed: 89.9[samples/s]
2022-05-18 14:40:26,364 reid_baseline.train INFO: normal accuracy 0.8294698186825797 1.5093096494674683 
2022-05-18 14:40:26,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-18 14:40:26,365 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 150.9%
2022-05-18 14:40:45,925 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.794, Acc: 0.995, Base Lr: 3.38e-03
2022-05-18 14:41:03,468 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.797, Acc: 0.993, Base Lr: 3.38e-03
2022-05-18 14:41:16,829 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.181[s] Speed: 88.2[samples/s]
2022-05-18 14:41:50,023 reid_baseline.train INFO: normal accuracy 0.8333715859536378 1.484212875366211 
2022-05-18 14:41:50,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-18 14:41:50,024 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 148.4%
2022-05-18 14:42:09,692 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.787, Acc: 0.994, Base Lr: 2.77e-03
2022-05-18 14:42:26,994 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.788, Acc: 0.995, Base Lr: 2.77e-03
2022-05-18 14:42:40,238 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.180[s] Speed: 88.8[samples/s]
2022-05-18 14:43:13,428 reid_baseline.train INFO: normal accuracy 0.8306173972917145 1.4749714136123657 
2022-05-18 14:43:13,428 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-18 14:43:13,428 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 147.5%
2022-05-18 14:43:33,134 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.787, Acc: 0.996, Base Lr: 2.20e-03
2022-05-18 14:43:50,506 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.786, Acc: 0.995, Base Lr: 2.20e-03
2022-05-18 14:44:03,741 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.181[s] Speed: 88.5[samples/s]
2022-05-18 14:44:36,782 reid_baseline.train INFO: normal accuracy 0.8296993344044067 1.5046411752700806 
2022-05-18 14:44:36,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-18 14:44:36,785 reid_baseline.train INFO: Accuracy: 83.0% Mean Entropy: 150.5%
2022-05-18 14:44:56,721 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.783, Acc: 0.997, Base Lr: 1.66e-03
2022-05-18 14:45:13,412 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.783, Acc: 0.996, Base Lr: 1.66e-03
2022-05-18 14:45:26,625 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.178[s] Speed: 89.8[samples/s]
2022-05-18 14:45:59,650 reid_baseline.train INFO: normal accuracy 0.8287812715170989 1.5491573810577393 
2022-05-18 14:45:59,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-18 14:45:59,653 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 154.9%
2022-05-18 14:46:19,387 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.776, Acc: 0.997, Base Lr: 1.19e-03
2022-05-18 14:46:36,599 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.781, Acc: 0.995, Base Lr: 1.19e-03
2022-05-18 14:46:49,924 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.180[s] Speed: 88.7[samples/s]
2022-05-18 14:47:22,909 reid_baseline.train INFO: normal accuracy 0.8313059444571953 1.4782990217208862 
2022-05-18 14:47:22,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-18 14:47:22,912 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 147.8%
2022-05-18 14:47:42,803 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.781, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 14:48:00,139 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.778, Acc: 0.997, Base Lr: 7.78e-04
2022-05-18 14:48:13,355 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.181[s] Speed: 88.2[samples/s]
2022-05-18 14:48:46,391 reid_baseline.train INFO: normal accuracy 0.8303878815698875 1.512300968170166 
2022-05-18 14:48:46,393 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-18 14:48:46,393 reid_baseline.train INFO: Accuracy: 83.0% Mean Entropy: 151.2%
2022-05-18 14:49:06,366 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.778, Acc: 0.999, Base Lr: 4.51e-04
2022-05-18 14:49:23,596 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.779, Acc: 0.997, Base Lr: 4.51e-04
2022-05-18 14:49:36,805 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.180[s] Speed: 88.6[samples/s]
2022-05-18 14:50:09,983 reid_baseline.train INFO: normal accuracy 0.8292403029607528 1.4581893682479858 
2022-05-18 14:50:09,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-18 14:50:09,986 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 145.8%
2022-05-18 14:50:29,597 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.775, Acc: 0.996, Base Lr: 2.11e-04
2022-05-18 14:50:46,498 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.779, Acc: 0.996, Base Lr: 2.11e-04
2022-05-18 14:50:59,735 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.179[s] Speed: 89.5[samples/s]
2022-05-18 14:51:31,973 reid_baseline.train INFO: normal accuracy 0.8299288501262336 1.4600874185562134 
2022-05-18 14:51:31,976 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-18 14:51:31,976 reid_baseline.train INFO: Accuracy: 83.0% Mean Entropy: 146.0%
2022-05-18 14:51:51,569 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.782, Acc: 0.994, Base Lr: 6.51e-05
2022-05-18 14:52:06,900 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.778, Acc: 0.996, Base Lr: 6.51e-05
2022-05-18 14:52:21,624 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.178[s] Speed: 89.7[samples/s]
2022-05-18 14:52:57,133 reid_baseline.train INFO: normal accuracy 0.8306173972917145 1.4820359945297241 
2022-05-18 14:52:57,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-18 14:52:57,136 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 148.2%
2022-05-18 14:53:15,914 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.778, Acc: 0.997, Base Lr: 1.60e-05
2022-05-18 14:53:34,670 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.778, Acc: 0.997, Base Lr: 1.60e-05
2022-05-18 14:53:48,209 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.184[s] Speed: 87.2[samples/s]
2022-05-18 14:54:08,114 reid_baseline.train INFO: normal accuracy 0.8315354601790222 1.5315272808074951 
2022-05-18 14:54:08,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-18 14:54:08,114 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 153.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_W_k/transformer_best_model.pth
2022-05-18 14:54:28,368 reid_baseline.train INFO: normal accuracy 0.8235024099150792 1.4400864839553833 
2022-05-18 14:54:28,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:54:28,368 reid_baseline.train INFO: Accuracy: 82.4%
2022-05-18 14:54:47,476 reid_baseline.train INFO: normal accuracy 0.8235024099150792 1.4400864839553833 
2022-05-18 14:54:47,477 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:54:47,477 reid_baseline.train INFO: Shuffled Accuracy: 82.4%
2022-05-18 14:55:04,989 reid_baseline.train INFO: normal accuracy 0.9936922730344673 0.5617942214012146 
2022-05-18 14:55:04,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 14:55:04,990 reid_baseline.train INFO: Source Clean Accuracy: 99.4%
