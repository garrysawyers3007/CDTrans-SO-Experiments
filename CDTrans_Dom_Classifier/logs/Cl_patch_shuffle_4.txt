2022-04-13 20:25:20,611 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_7
2022-04-13 20:25:20,611 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=7, dom_cls=False)
2022-04-13 20:25:20,612 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-13 20:25:20,612 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-13 20:25:20,612 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-13 20:25:33,165 reid_baseline.train INFO: start training
2022-04-13 20:25:53,125 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.111, Acc: 0.173, Base Lr: 8.72e-04
2022-04-13 20:26:17,317 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.040, Acc: 0.215, Base Lr: 8.72e-04
2022-04-13 20:26:31,257 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.212[s] Speed: 75.5[samples/s]
2022-04-13 20:27:00,476 reid_baseline.train INFO: normal accuracy 0.11556656904708268 4.159090995788574 
2022-04-13 20:27:01,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-13 20:27:01,767 reid_baseline.train INFO: Accuracy: 11.6% Mean Entropy: 415.9%
2022-04-13 20:27:23,100 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.659, Acc: 0.326, Base Lr: 1.66e-03
2022-04-13 20:27:41,874 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.542, Acc: 0.330, Base Lr: 1.66e-03
2022-04-13 20:27:55,646 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.197[s] Speed: 81.1[samples/s]
2022-04-13 20:28:30,005 reid_baseline.train INFO: normal accuracy 0.1360666816850642 4.022688388824463 
2022-04-13 20:28:34,829 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-13 20:28:34,830 reid_baseline.train INFO: Accuracy: 13.6% Mean Entropy: 402.3%
2022-04-13 20:28:54,766 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.026, Acc: 0.415, Base Lr: 2.46e-03
2022-04-13 20:29:13,398 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.949, Acc: 0.423, Base Lr: 2.46e-03
2022-04-13 20:29:29,326 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-13 20:29:58,996 reid_baseline.train INFO: normal accuracy 0.2703311556656905 3.765463352203369 
2022-04-13 20:30:00,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-13 20:30:00,498 reid_baseline.train INFO: Accuracy: 27.0% Mean Entropy: 376.5%
2022-04-13 20:30:22,927 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.578, Acc: 0.497, Base Lr: 3.25e-03
2022-04-13 20:30:42,733 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.523, Acc: 0.510, Base Lr: 3.25e-03
2022-04-13 20:30:56,631 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.205[s] Speed: 77.9[samples/s]
2022-04-13 20:31:25,185 reid_baseline.train INFO: normal accuracy 0.4151835999098896 3.5611069202423096 
2022-04-13 20:31:26,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-13 20:31:26,498 reid_baseline.train INFO: Accuracy: 41.5% Mean Entropy: 356.1%
2022-04-13 20:31:47,085 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.225, Acc: 0.589, Base Lr: 4.04e-03
2022-04-13 20:32:05,578 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.191, Acc: 0.591, Base Lr: 4.04e-03
2022-04-13 20:32:18,578 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.191[s] Speed: 83.9[samples/s]
2022-04-13 20:32:51,833 reid_baseline.train INFO: normal accuracy 0.5273710295111511 3.28700852394104 
2022-04-13 20:32:53,080 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-13 20:32:53,080 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 328.7%
2022-04-13 20:33:12,707 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.927, Acc: 0.656, Base Lr: 4.83e-03
2022-04-13 20:33:31,400 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.917, Acc: 0.661, Base Lr: 4.83e-03
2022-04-13 20:33:48,372 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-13 20:34:19,370 reid_baseline.train INFO: normal accuracy 0.6152286551025006 3.096003293991089 
2022-04-13 20:34:20,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-13 20:34:20,600 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 309.6%
2022-04-13 20:34:41,076 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.766, Acc: 0.712, Base Lr: 5.62e-03
2022-04-13 20:34:59,962 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.735, Acc: 0.715, Base Lr: 5.62e-03
2022-04-13 20:35:13,458 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.194[s] Speed: 82.7[samples/s]
2022-04-13 20:35:43,210 reid_baseline.train INFO: normal accuracy 0.6530750168956972 2.8430838584899902 
2022-04-13 20:35:45,783 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-13 20:35:45,784 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 284.3%
2022-04-13 20:36:06,281 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.597, Acc: 0.767, Base Lr: 6.42e-03
2022-04-13 20:36:24,617 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.597, Acc: 0.766, Base Lr: 6.42e-03
2022-04-13 20:36:37,812 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.190[s] Speed: 84.2[samples/s]
2022-04-13 20:37:09,013 reid_baseline.train INFO: normal accuracy 0.6690696102725839 2.760668992996216 
2022-04-13 20:37:10,334 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-13 20:37:10,334 reid_baseline.train INFO: Accuracy: 66.9% Mean Entropy: 276.1%
2022-04-13 20:37:30,706 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.431, Acc: 0.821, Base Lr: 7.21e-03
2022-04-13 20:37:52,278 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.446, Acc: 0.808, Base Lr: 7.21e-03
2022-04-13 20:38:07,337 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-13 20:38:37,928 reid_baseline.train INFO: normal accuracy 0.674250957422843 2.6283888816833496 
2022-04-13 20:38:39,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-13 20:38:39,178 reid_baseline.train INFO: Accuracy: 67.4% Mean Entropy: 262.8%
2022-04-13 20:39:01,417 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.330, Acc: 0.846, Base Lr: 4.01e-03
2022-04-13 20:39:19,956 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.342, Acc: 0.843, Base Lr: 4.01e-03
2022-04-13 20:39:33,683 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.199[s] Speed: 80.2[samples/s]
2022-04-13 20:40:10,369 reid_baseline.train INFO: normal accuracy 0.6859653075016896 2.6005187034606934 
2022-04-13 20:40:11,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-13 20:40:11,594 reid_baseline.train INFO: Accuracy: 68.6% Mean Entropy: 260.1%
2022-04-13 20:40:31,273 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.288, Acc: 0.856, Base Lr: 3.38e-03
2022-04-13 20:40:49,707 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.282, Acc: 0.859, Base Lr: 3.38e-03
2022-04-13 20:41:05,418 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.197[s] Speed: 81.2[samples/s]
2022-04-13 20:41:35,698 reid_baseline.train INFO: normal accuracy 0.688218067132237 2.5319318771362305 
2022-04-13 20:41:37,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-13 20:41:37,020 reid_baseline.train INFO: Accuracy: 68.8% Mean Entropy: 253.2%
2022-04-13 20:41:57,340 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.239, Acc: 0.870, Base Lr: 2.77e-03
2022-04-13 20:42:18,421 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.244, Acc: 0.871, Base Lr: 2.77e-03
2022-04-13 20:42:31,898 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.201[s] Speed: 79.6[samples/s]
2022-04-13 20:43:04,021 reid_baseline.train INFO: normal accuracy 0.6886686190583464 2.5328361988067627 
2022-04-13 20:43:04,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-13 20:43:04,024 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 253.3%
2022-04-13 20:43:25,094 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.183, Acc: 0.909, Base Lr: 2.20e-03
2022-04-13 20:43:43,372 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.194, Acc: 0.899, Base Lr: 2.20e-03
2022-04-13 20:43:57,145 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.194[s] Speed: 82.3[samples/s]
2022-04-13 20:44:30,261 reid_baseline.train INFO: normal accuracy 0.689119170984456 2.5095508098602295 
2022-04-13 20:44:31,396 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-13 20:44:31,396 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 251.0%
2022-04-13 20:44:50,126 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.183, Acc: 0.897, Base Lr: 1.66e-03
2022-04-13 20:45:11,384 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.165, Acc: 0.902, Base Lr: 1.66e-03
2022-04-13 20:45:25,093 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.196[s] Speed: 81.6[samples/s]
2022-04-13 20:45:55,238 reid_baseline.train INFO: normal accuracy 0.6893444469475107 2.5108611583709717 
2022-04-13 20:45:55,239 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-13 20:45:55,240 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 251.1%
2022-04-13 20:46:20,115 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.146, Acc: 0.899, Base Lr: 1.19e-03
2022-04-13 20:46:39,235 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.152, Acc: 0.901, Base Lr: 1.19e-03
2022-04-13 20:46:55,740 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.222[s] Speed: 72.2[samples/s]
2022-04-13 20:47:31,903 reid_baseline.train INFO: normal accuracy 0.6902455507997297 2.4817614555358887 
2022-04-13 20:47:34,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-13 20:47:34,057 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 248.2%
2022-04-13 20:47:53,842 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.152, Acc: 0.901, Base Lr: 7.78e-04
2022-04-13 20:48:06,669 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.144, Acc: 0.904, Base Lr: 7.78e-04
2022-04-13 20:48:20,597 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.170[s] Speed: 93.9[samples/s]
2022-04-13 20:48:49,367 reid_baseline.train INFO: normal accuracy 0.6920477585041676 2.531710147857666 
2022-04-13 20:48:49,369 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-13 20:48:49,370 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 253.2%
2022-04-13 20:49:12,962 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.129, Acc: 0.906, Base Lr: 4.51e-04
2022-04-13 20:49:31,933 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.124, Acc: 0.907, Base Lr: 4.51e-04
2022-04-13 20:49:45,772 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.206[s] Speed: 77.5[samples/s]
2022-04-13 20:50:21,748 reid_baseline.train INFO: normal accuracy 0.6911466546519487 2.447605609893799 
2022-04-13 20:50:23,115 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-13 20:50:23,115 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 244.8%
2022-04-13 20:50:43,250 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.127, Acc: 0.912, Base Lr: 2.11e-04
2022-04-13 20:51:04,290 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.116, Acc: 0.913, Base Lr: 2.11e-04
2022-04-13 20:51:19,912 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.208[s] Speed: 76.9[samples/s]
2022-04-13 20:51:51,482 reid_baseline.train INFO: normal accuracy 0.6949763460238793 2.486755132675171 
2022-04-13 20:51:51,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-13 20:51:51,485 reid_baseline.train INFO: Accuracy: 69.5% Mean Entropy: 248.7%
2022-04-13 20:52:11,896 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.120, Acc: 0.911, Base Lr: 6.51e-05
2022-04-13 20:52:32,454 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.113, Acc: 0.916, Base Lr: 6.51e-05
2022-04-13 20:52:46,627 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.202[s] Speed: 79.2[samples/s]
2022-04-13 20:53:15,580 reid_baseline.train INFO: normal accuracy 0.6922730344672223 2.4841270446777344 
2022-04-13 20:53:15,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-13 20:53:15,581 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 248.4%
2022-04-13 20:53:37,963 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.129, Acc: 0.909, Base Lr: 1.60e-05
2022-04-13 20:53:57,366 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.124, Acc: 0.911, Base Lr: 1.60e-05
2022-04-13 20:54:09,821 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.199[s] Speed: 80.6[samples/s]
2022-04-13 20:54:44,752 reid_baseline.train INFO: normal accuracy 0.6924983104302771 2.494096040725708 
2022-04-13 20:54:44,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-13 20:54:44,776 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 249.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_7/transformer_best_model.pth
2022-04-13 20:55:16,801 reid_baseline.train INFO: normal accuracy 0.6911466546519487 2.447605609893799 
2022-04-13 20:55:16,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 20:55:16,801 reid_baseline.train INFO: Accuracy: 69.1%
2022-04-13 20:55:52,181 reid_baseline.train INFO: normal accuracy 0.6068934444694751 2.2486932277679443 
2022-04-13 20:55:52,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 20:55:52,182 reid_baseline.train INFO: Shuffled Accuracy: 60.7%
2022-04-13 20:56:24,497 reid_baseline.train INFO: normal accuracy 0.9134020618556701 1.3337255716323853 
2022-04-13 20:56:24,499 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 20:56:24,499 reid_baseline.train INFO: Source Clean Accuracy: 91.3%
2022-04-13 20:56:31,136 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_8
2022-04-13 20:56:31,136 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-13 20:56:31,136 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-13 20:56:31,137 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-13 20:56:31,137 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-13 20:56:51,590 reid_baseline.train INFO: start training
2022-04-13 20:57:11,425 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.118, Acc: 0.153, Base Lr: 8.72e-04
2022-04-13 20:57:30,061 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.055, Acc: 0.186, Base Lr: 8.72e-04
2022-04-13 20:57:46,151 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.199[s] Speed: 80.3[samples/s]
2022-04-13 20:58:15,885 reid_baseline.train INFO: normal accuracy 0.08785762559134941 4.159266471862793 
2022-04-13 20:58:17,096 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-13 20:58:17,097 reid_baseline.train INFO: Accuracy: 8.8% Mean Entropy: 415.9%
2022-04-13 20:58:36,597 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.714, Acc: 0.289, Base Lr: 1.66e-03
2022-04-13 20:58:56,720 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.609, Acc: 0.287, Base Lr: 1.66e-03
2022-04-13 20:59:10,351 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-13 20:59:40,065 reid_baseline.train INFO: normal accuracy 0.0975444920027033 4.041032791137695 
2022-04-13 20:59:41,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-13 20:59:41,250 reid_baseline.train INFO: Accuracy: 9.8% Mean Entropy: 404.1%
2022-04-13 21:00:01,419 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.133, Acc: 0.351, Base Lr: 2.46e-03
2022-04-13 21:00:20,664 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.069, Acc: 0.364, Base Lr: 2.46e-03
2022-04-13 21:00:33,591 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.192[s] Speed: 83.5[samples/s]
2022-04-13 21:01:09,237 reid_baseline.train INFO: normal accuracy 0.18607794548321693 3.8491952419281006 
2022-04-13 21:01:10,119 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-13 21:01:10,119 reid_baseline.train INFO: Accuracy: 18.6% Mean Entropy: 384.9%
2022-04-13 21:01:29,569 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.717, Acc: 0.449, Base Lr: 3.25e-03
2022-04-13 21:01:49,326 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.674, Acc: 0.457, Base Lr: 3.25e-03
2022-04-13 21:02:05,539 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.203[s] Speed: 78.9[samples/s]
2022-04-13 21:02:38,722 reid_baseline.train INFO: normal accuracy 0.32101824735300744 3.6988155841827393 
2022-04-13 21:02:40,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-13 21:02:40,056 reid_baseline.train INFO: Accuracy: 32.1% Mean Entropy: 369.9%
2022-04-13 21:03:02,397 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.406, Acc: 0.536, Base Lr: 4.04e-03
2022-04-13 21:03:20,429 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.362, Acc: 0.543, Base Lr: 4.04e-03
2022-04-13 21:03:34,083 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.198[s] Speed: 80.9[samples/s]
2022-04-13 21:04:06,481 reid_baseline.train INFO: normal accuracy 0.40932642487046633 3.4963767528533936 
2022-04-13 21:04:07,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-13 21:04:07,807 reid_baseline.train INFO: Accuracy: 40.9% Mean Entropy: 349.6%
2022-04-13 21:04:27,992 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.105, Acc: 0.601, Base Lr: 4.83e-03
2022-04-13 21:04:45,798 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.098, Acc: 0.600, Base Lr: 4.83e-03
2022-04-13 21:05:00,114 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.191[s] Speed: 83.6[samples/s]
2022-04-13 21:05:32,701 reid_baseline.train INFO: normal accuracy 0.5149808515431403 3.343776226043701 
2022-04-13 21:05:34,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-13 21:05:34,079 reid_baseline.train INFO: Accuracy: 51.5% Mean Entropy: 334.4%
2022-04-13 21:05:53,397 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.938, Acc: 0.662, Base Lr: 5.62e-03
2022-04-13 21:06:15,513 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.908, Acc: 0.660, Base Lr: 5.62e-03
2022-04-13 21:06:29,623 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.203[s] Speed: 78.7[samples/s]
2022-04-13 21:06:58,687 reid_baseline.train INFO: normal accuracy 0.5821130885334534 3.109772205352783 
2022-04-13 21:07:00,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-13 21:07:00,393 reid_baseline.train INFO: Accuracy: 58.2% Mean Entropy: 311.0%
2022-04-13 21:07:22,461 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.776, Acc: 0.699, Base Lr: 6.42e-03
2022-04-13 21:07:40,496 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.764, Acc: 0.702, Base Lr: 6.42e-03
2022-04-13 21:07:53,869 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-13 21:08:27,925 reid_baseline.train INFO: normal accuracy 0.6159044829916648 3.0093536376953125 
2022-04-13 21:08:29,757 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-13 21:08:29,757 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 300.9%
2022-04-13 21:08:50,465 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.579, Acc: 0.755, Base Lr: 7.21e-03
2022-04-13 21:09:09,106 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.607, Acc: 0.749, Base Lr: 7.21e-03
2022-04-13 21:09:24,452 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.200[s] Speed: 80.0[samples/s]
2022-04-13 21:09:57,222 reid_baseline.train INFO: normal accuracy 0.622662761883307 2.8490641117095947 
2022-04-13 21:09:58,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-13 21:09:58,344 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 284.9%
2022-04-13 21:10:21,044 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.487, Acc: 0.800, Base Lr: 4.01e-03
2022-04-13 21:10:40,529 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.492, Acc: 0.795, Base Lr: 4.01e-03
2022-04-13 21:10:56,539 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.213[s] Speed: 75.1[samples/s]
2022-04-13 21:11:19,519 reid_baseline.train INFO: normal accuracy 0.6424870466321243 2.8175559043884277 
2022-04-13 21:11:20,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-13 21:11:20,786 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 281.8%
2022-04-13 21:11:40,247 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.447, Acc: 0.814, Base Lr: 3.38e-03
2022-04-13 21:11:58,845 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.440, Acc: 0.814, Base Lr: 3.38e-03
2022-04-13 21:12:16,019 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-13 21:12:45,888 reid_baseline.train INFO: normal accuracy 0.6487947735976571 2.758693218231201 
2022-04-13 21:12:47,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-13 21:12:47,112 reid_baseline.train INFO: Accuracy: 64.9% Mean Entropy: 275.9%
2022-04-13 21:13:08,529 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.385, Acc: 0.817, Base Lr: 2.77e-03
2022-04-13 21:13:29,332 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.392, Acc: 0.817, Base Lr: 2.77e-03
2022-04-13 21:13:43,700 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-13 21:14:14,876 reid_baseline.train INFO: normal accuracy 0.653300292858752 2.7130486965179443 
2022-04-13 21:14:16,243 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-13 21:14:16,243 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 271.3%
2022-04-13 21:14:37,655 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.325, Acc: 0.858, Base Lr: 2.20e-03
2022-04-13 21:14:56,154 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.341, Acc: 0.846, Base Lr: 2.20e-03
2022-04-13 21:15:09,664 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-13 21:15:42,170 reid_baseline.train INFO: normal accuracy 0.6512728091912593 2.734224557876587 
2022-04-13 21:15:42,173 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-13 21:15:42,173 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 273.4%
2022-04-13 21:16:01,991 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.334, Acc: 0.841, Base Lr: 1.66e-03
2022-04-13 21:16:21,208 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.315, Acc: 0.852, Base Lr: 1.66e-03
2022-04-13 21:16:35,899 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.197[s] Speed: 81.4[samples/s]
2022-04-13 21:17:08,542 reid_baseline.train INFO: normal accuracy 0.6587069159720658 2.7102200984954834 
2022-04-13 21:17:09,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-13 21:17:09,640 reid_baseline.train INFO: Accuracy: 65.9% Mean Entropy: 271.0%
2022-04-13 21:17:31,703 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.280, Acc: 0.862, Base Lr: 1.19e-03
2022-04-13 21:17:50,676 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.285, Acc: 0.867, Base Lr: 1.19e-03
2022-04-13 21:18:04,103 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.199[s] Speed: 80.2[samples/s]
2022-04-13 21:18:36,520 reid_baseline.train INFO: normal accuracy 0.6566794323045732 2.6910312175750732 
2022-04-13 21:18:39,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-13 21:18:39,505 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 269.1%
2022-04-13 21:18:56,414 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.285, Acc: 0.859, Base Lr: 7.78e-04
2022-04-13 21:19:14,723 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.275, Acc: 0.861, Base Lr: 7.78e-04
2022-04-13 21:19:29,432 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.182[s] Speed: 87.9[samples/s]
2022-04-13 21:20:01,951 reid_baseline.train INFO: normal accuracy 0.6569047082676278 2.7023842334747314 
2022-04-13 21:20:01,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-13 21:20:01,951 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 270.2%
2022-04-13 21:20:20,165 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.259, Acc: 0.866, Base Lr: 4.51e-04
2022-04-13 21:20:41,065 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.257, Acc: 0.869, Base Lr: 4.51e-04
2022-04-13 21:20:54,696 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-13 21:21:24,416 reid_baseline.train INFO: normal accuracy 0.6591574678981753 2.6439192295074463 
2022-04-13 21:21:27,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-13 21:21:27,505 reid_baseline.train INFO: Accuracy: 65.9% Mean Entropy: 264.4%
2022-04-13 21:21:52,644 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.264, Acc: 0.876, Base Lr: 2.11e-04
2022-04-13 21:22:10,065 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.253, Acc: 0.873, Base Lr: 2.11e-04
2022-04-13 21:22:23,548 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-13 21:23:00,531 reid_baseline.train INFO: normal accuracy 0.6573552601937374 2.6850035190582275 
2022-04-13 21:23:00,532 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-13 21:23:00,532 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 268.5%
2022-04-13 21:23:19,276 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.252, Acc: 0.876, Base Lr: 6.51e-05
2022-04-13 21:23:36,772 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.247, Acc: 0.877, Base Lr: 6.51e-05
2022-04-13 21:23:53,126 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.193[s] Speed: 83.1[samples/s]
2022-04-13 21:24:23,862 reid_baseline.train INFO: normal accuracy 0.6526244649695877 2.6908860206604004 
2022-04-13 21:24:23,864 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-13 21:24:23,864 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 269.1%
2022-04-13 21:24:43,433 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.259, Acc: 0.869, Base Lr: 1.60e-05
2022-04-13 21:25:04,469 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.259, Acc: 0.871, Base Lr: 1.60e-05
2022-04-13 21:25:16,834 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.194[s] Speed: 82.5[samples/s]
2022-04-13 21:25:47,843 reid_baseline.train INFO: normal accuracy 0.6548772246001352 2.687272071838379 
2022-04-13 21:25:47,846 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-13 21:25:47,846 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 268.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_8/transformer_best_model.pth
2022-04-13 21:26:22,241 reid_baseline.train INFO: normal accuracy 0.6591574678981753 2.6439192295074463 
2022-04-13 21:26:22,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:26:22,860 reid_baseline.train INFO: Accuracy: 65.9%
2022-04-13 21:26:52,771 reid_baseline.train INFO: normal accuracy 0.553728317188556 2.3628315925598145 
2022-04-13 21:26:52,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:26:52,771 reid_baseline.train INFO: Shuffled Accuracy: 55.4%
2022-04-13 21:27:23,493 reid_baseline.train INFO: normal accuracy 0.8536082474226804 1.6514925956726074 
2022-04-13 21:27:23,493 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:27:23,493 reid_baseline.train INFO: Source Clean Accuracy: 85.4%
2022-04-13 21:27:30,165 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_9
2022-04-13 21:27:30,165 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_9', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=9, dom_cls=False)
2022-04-13 21:27:30,165 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-13 21:27:30,165 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-13 21:27:30,166 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_9
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-13 21:27:44,036 reid_baseline.train INFO: start training
2022-04-13 21:28:08,885 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.117, Acc: 0.155, Base Lr: 8.72e-04
2022-04-13 21:28:26,967 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.180, Base Lr: 8.72e-04
2022-04-13 21:28:41,013 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.208[s] Speed: 76.9[samples/s]
2022-04-13 21:29:18,038 reid_baseline.train INFO: normal accuracy 0.0723135841405722 4.158865451812744 
2022-04-13 21:29:20,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-13 21:29:20,052 reid_baseline.train INFO: Accuracy: 7.2% Mean Entropy: 415.9%
2022-04-13 21:29:40,046 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.711, Acc: 0.271, Base Lr: 1.66e-03
2022-04-13 21:30:00,411 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.609, Acc: 0.270, Base Lr: 1.66e-03
2022-04-13 21:30:16,273 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.206[s] Speed: 77.7[samples/s]
2022-04-13 21:30:48,145 reid_baseline.train INFO: normal accuracy 0.08673124577607569 4.039555072784424 
2022-04-13 21:30:49,183 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-13 21:30:49,184 reid_baseline.train INFO: Accuracy: 8.7% Mean Entropy: 404.0%
2022-04-13 21:31:08,684 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.158, Acc: 0.339, Base Lr: 2.46e-03
2022-04-13 21:31:27,324 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.096, Acc: 0.349, Base Lr: 2.46e-03
2022-04-13 21:31:40,927 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.189[s] Speed: 84.4[samples/s]
2022-04-13 21:32:11,942 reid_baseline.train INFO: normal accuracy 0.14642937598558234 3.8301286697387695 
2022-04-13 21:32:13,290 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-13 21:32:13,290 reid_baseline.train INFO: Accuracy: 14.6% Mean Entropy: 383.0%
2022-04-13 21:32:34,052 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.754, Acc: 0.426, Base Lr: 3.25e-03
2022-04-13 21:32:55,916 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.715, Acc: 0.435, Base Lr: 3.25e-03
2022-04-13 21:33:11,992 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-13 21:33:42,820 reid_baseline.train INFO: normal accuracy 0.29060599234061724 3.7054572105407715 
2022-04-13 21:33:44,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-13 21:33:44,097 reid_baseline.train INFO: Accuracy: 29.1% Mean Entropy: 370.5%
2022-04-13 21:33:58,064 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.464, Acc: 0.512, Base Lr: 4.04e-03
2022-04-13 21:34:14,997 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.426, Acc: 0.518, Base Lr: 4.04e-03
2022-04-13 21:34:28,706 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.163[s] Speed: 98.0[samples/s]
2022-04-13 21:35:01,210 reid_baseline.train INFO: normal accuracy 0.35683712547871144 3.5430185794830322 
2022-04-13 21:35:02,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-13 21:35:02,875 reid_baseline.train INFO: Accuracy: 35.7% Mean Entropy: 354.3%
2022-04-13 21:35:23,328 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.178, Acc: 0.571, Base Lr: 4.83e-03
2022-04-13 21:35:41,641 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.164, Acc: 0.584, Base Lr: 4.83e-03
2022-04-13 21:35:59,444 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.207[s] Speed: 77.3[samples/s]
2022-04-13 21:36:27,888 reid_baseline.train INFO: normal accuracy 0.45167830592475783 3.4068942070007324 
2022-04-13 21:36:29,449 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-13 21:36:29,450 reid_baseline.train INFO: Accuracy: 45.2% Mean Entropy: 340.7%
2022-04-13 21:36:48,313 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.996, Acc: 0.633, Base Lr: 5.62e-03
2022-04-13 21:37:08,930 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.969, Acc: 0.635, Base Lr: 5.62e-03
2022-04-13 21:37:22,877 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-13 21:37:52,067 reid_baseline.train INFO: normal accuracy 0.5138544717278667 3.1958441734313965 
2022-04-13 21:37:53,339 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-13 21:37:53,339 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 319.6%
2022-04-13 21:38:15,402 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.843, Acc: 0.674, Base Lr: 6.42e-03
2022-04-13 21:38:33,472 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.826, Acc: 0.677, Base Lr: 6.42e-03
2022-04-13 21:38:47,198 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.197[s] Speed: 81.1[samples/s]
2022-04-13 21:39:22,341 reid_baseline.train INFO: normal accuracy 0.5649921153412931 3.099524736404419 
2022-04-13 21:39:23,466 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-13 21:39:23,466 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 310.0%
2022-04-13 21:39:42,041 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.642, Acc: 0.746, Base Lr: 7.21e-03
2022-04-13 21:39:59,253 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.669, Acc: 0.732, Base Lr: 7.21e-03
2022-04-13 21:40:17,115 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.196[s] Speed: 81.5[samples/s]
2022-04-13 21:40:46,994 reid_baseline.train INFO: normal accuracy 0.5794097769767966 2.9136574268341064 
2022-04-13 21:40:48,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-13 21:40:48,465 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 291.4%
2022-04-13 21:41:07,867 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.540, Acc: 0.772, Base Lr: 4.01e-03
2022-04-13 21:41:28,927 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.552, Acc: 0.766, Base Lr: 4.01e-03
2022-04-13 21:41:41,766 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-13 21:42:13,783 reid_baseline.train INFO: normal accuracy 0.5992340617256139 2.880122423171997 
2022-04-13 21:42:15,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-13 21:42:15,070 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 288.0%
2022-04-13 21:42:36,208 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.484, Acc: 0.803, Base Lr: 3.38e-03
2022-04-13 21:42:54,409 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.479, Acc: 0.802, Base Lr: 3.38e-03
2022-04-13 21:43:07,593 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.192[s] Speed: 83.2[samples/s]
2022-04-13 21:43:39,765 reid_baseline.train INFO: normal accuracy 0.6136517233611174 2.867070436477661 
2022-04-13 21:43:41,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-13 21:43:41,078 reid_baseline.train INFO: Accuracy: 61.4% Mean Entropy: 286.7%
2022-04-13 21:44:00,761 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.418, Acc: 0.806, Base Lr: 2.77e-03
2022-04-13 21:44:17,487 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.430, Acc: 0.809, Base Lr: 2.77e-03
2022-04-13 21:44:32,672 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.189[s] Speed: 84.7[samples/s]
2022-04-13 21:45:02,100 reid_baseline.train INFO: normal accuracy 0.6159044829916648 2.834331512451172 
2022-04-13 21:45:03,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-13 21:45:03,682 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 283.4%
2022-04-13 21:45:24,652 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.352, Acc: 0.841, Base Lr: 2.20e-03
2022-04-13 21:45:45,244 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.375, Acc: 0.834, Base Lr: 2.20e-03
2022-04-13 21:45:57,747 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.197[s] Speed: 81.1[samples/s]
2022-04-13 21:46:27,672 reid_baseline.train INFO: normal accuracy 0.61567920702861 2.7982964515686035 
2022-04-13 21:46:28,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-13 21:46:28,872 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 279.8%
2022-04-13 21:46:50,596 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.378, Acc: 0.834, Base Lr: 1.66e-03
2022-04-13 21:47:08,852 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.360, Acc: 0.839, Base Lr: 1.66e-03
2022-04-13 21:47:21,496 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.192[s] Speed: 83.4[samples/s]
2022-04-13 21:47:55,489 reid_baseline.train INFO: normal accuracy 0.6190583464744311 2.8304874897003174 
2022-04-13 21:47:55,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-13 21:47:55,492 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 283.0%
2022-04-13 21:48:14,459 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.316, Acc: 0.849, Base Lr: 1.19e-03
2022-04-13 21:48:32,100 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.321, Acc: 0.845, Base Lr: 1.19e-03
2022-04-13 21:48:47,528 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.191[s] Speed: 84.0[samples/s]
2022-04-13 21:49:18,071 reid_baseline.train INFO: normal accuracy 0.626267177292183 2.7949302196502686 
2022-04-13 21:49:19,389 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-13 21:49:19,389 reid_baseline.train INFO: Accuracy: 62.6% Mean Entropy: 279.5%
2022-04-13 21:49:39,625 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.309, Acc: 0.859, Base Lr: 7.78e-04
2022-04-13 21:49:59,201 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.312, Acc: 0.855, Base Lr: 7.78e-04
2022-04-13 21:50:12,828 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-13 21:50:40,980 reid_baseline.train INFO: normal accuracy 0.6224374859202523 2.802255153656006 
2022-04-13 21:50:40,982 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-13 21:50:40,982 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 280.2%
2022-04-13 21:51:02,696 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.296, Acc: 0.867, Base Lr: 4.51e-04
2022-04-13 21:51:19,853 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.294, Acc: 0.858, Base Lr: 4.51e-04
2022-04-13 21:51:33,480 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.192[s] Speed: 83.3[samples/s]
2022-04-13 21:52:09,718 reid_baseline.train INFO: normal accuracy 0.6282946609596756 2.774717330932617 
2022-04-13 21:52:10,978 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-13 21:52:10,978 reid_baseline.train INFO: Accuracy: 62.8% Mean Entropy: 277.5%
2022-04-13 21:52:30,406 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.296, Acc: 0.872, Base Lr: 2.11e-04
2022-04-13 21:52:48,647 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.285, Acc: 0.867, Base Lr: 2.11e-04
2022-04-13 21:53:04,548 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.196[s] Speed: 81.6[samples/s]
2022-04-13 21:53:35,454 reid_baseline.train INFO: normal accuracy 0.6307726965532777 2.8071742057800293 
2022-04-13 21:53:35,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-13 21:53:35,457 reid_baseline.train INFO: Accuracy: 63.1% Mean Entropy: 280.7%
2022-04-13 21:53:56,412 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.299, Acc: 0.856, Base Lr: 6.51e-05
2022-04-13 21:54:14,988 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.294, Acc: 0.859, Base Lr: 6.51e-05
2022-04-13 21:54:28,209 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-13 21:54:57,911 reid_baseline.train INFO: normal accuracy 0.6231133138094165 2.7932591438293457 
2022-04-13 21:54:57,913 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-13 21:54:57,913 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 279.3%
2022-04-13 21:55:18,496 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.291, Acc: 0.868, Base Lr: 1.60e-05
2022-04-13 21:55:37,709 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.288, Acc: 0.868, Base Lr: 1.60e-05
2022-04-13 21:55:52,403 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-13 21:56:26,427 reid_baseline.train INFO: normal accuracy 0.6249155215138544 2.7915167808532715 
2022-04-13 21:56:26,428 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-13 21:56:26,428 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 279.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_9/transformer_best_model.pth
2022-04-13 21:56:49,519 reid_baseline.train INFO: normal accuracy 0.6282946609596756 2.774717330932617 
2022-04-13 21:56:49,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:56:49,520 reid_baseline.train INFO: Accuracy: 62.8%
2022-04-13 21:57:06,599 reid_baseline.train INFO: normal accuracy 0.5102500563189908 2.4307618141174316 
2022-04-13 21:57:06,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:57:06,600 reid_baseline.train INFO: Shuffled Accuracy: 51.0%
2022-04-13 21:57:24,805 reid_baseline.train INFO: normal accuracy 0.8421534936998855 1.7930735349655151 
2022-04-13 21:57:24,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 21:57:24,805 reid_baseline.train INFO: Source Clean Accuracy: 84.2%
2022-04-13 21:57:30,061 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_10
2022-04-13 21:57:30,062 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=10, dom_cls=False)
2022-04-13 21:57:30,062 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-13 21:57:30,062 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-13 21:57:30,062 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-13 21:57:40,622 reid_baseline.train INFO: start training
2022-04-13 21:57:54,599 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.122, Acc: 0.143, Base Lr: 8.72e-04
2022-04-13 21:58:06,138 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.066, Acc: 0.168, Base Lr: 8.72e-04
2022-04-13 21:58:15,301 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.127[s] Speed: 126.4[samples/s]
2022-04-13 21:58:34,224 reid_baseline.train INFO: normal accuracy 0.06307726965532778 4.15516471862793 
2022-04-13 21:58:36,793 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-13 21:58:36,793 reid_baseline.train INFO: Accuracy: 6.3% Mean Entropy: 415.5%
2022-04-13 21:58:50,729 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.760, Acc: 0.248, Base Lr: 1.66e-03
2022-04-13 21:59:02,571 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.671, Acc: 0.245, Base Lr: 1.66e-03
2022-04-13 21:59:11,257 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.126[s] Speed: 126.8[samples/s]
2022-04-13 21:59:31,571 reid_baseline.train INFO: normal accuracy 0.07051137643613427 4.035922050476074 
2022-04-13 21:59:32,686 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-13 21:59:32,686 reid_baseline.train INFO: Accuracy: 7.1% Mean Entropy: 403.6%
2022-04-13 21:59:45,658 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.267, Acc: 0.291, Base Lr: 2.46e-03
2022-04-13 21:59:58,096 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.200, Acc: 0.307, Base Lr: 2.46e-03
2022-04-13 22:00:08,845 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.132[s] Speed: 120.9[samples/s]
2022-04-13 22:00:29,807 reid_baseline.train INFO: normal accuracy 0.10317639107907187 3.8640995025634766 
2022-04-13 22:00:31,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-13 22:00:31,112 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 386.4%
2022-04-13 22:00:45,154 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.865, Acc: 0.389, Base Lr: 3.25e-03
2022-04-13 22:00:56,950 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.838, Acc: 0.392, Base Lr: 3.25e-03
2022-04-13 22:01:06,268 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.129[s] Speed: 124.4[samples/s]
2022-04-13 22:01:27,986 reid_baseline.train INFO: normal accuracy 0.2025230907862131 3.765922784805298 
2022-04-13 22:01:29,171 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-13 22:01:29,171 reid_baseline.train INFO: Accuracy: 20.3% Mean Entropy: 376.6%
2022-04-13 22:01:42,557 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 2.597, Acc: 0.466, Base Lr: 4.04e-03
2022-04-13 22:01:54,941 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 2.564, Acc: 0.471, Base Lr: 4.04e-03
2022-04-13 22:02:03,915 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.127[s] Speed: 125.8[samples/s]
2022-04-13 22:02:24,270 reid_baseline.train INFO: normal accuracy 0.24847938724938048 3.614457368850708 
2022-04-13 22:02:25,436 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-13 22:02:25,436 reid_baseline.train INFO: Accuracy: 24.8% Mean Entropy: 361.4%
2022-04-13 22:02:38,532 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.313, Acc: 0.546, Base Lr: 4.83e-03
2022-04-13 22:02:50,523 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.313, Acc: 0.537, Base Lr: 4.83e-03
2022-04-13 22:02:58,992 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.123[s] Speed: 130.3[samples/s]
2022-04-13 22:03:18,974 reid_baseline.train INFO: normal accuracy 0.33115566569047084 3.539875030517578 
2022-04-13 22:03:19,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-13 22:03:19,979 reid_baseline.train INFO: Accuracy: 33.1% Mean Entropy: 354.0%
2022-04-13 22:03:32,810 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.145, Acc: 0.586, Base Lr: 5.62e-03
2022-04-13 22:03:45,303 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.119, Acc: 0.592, Base Lr: 5.62e-03
2022-04-13 22:03:53,987 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.125[s] Speed: 128.5[samples/s]
2022-04-13 22:04:15,108 reid_baseline.train INFO: normal accuracy 0.4016670421266051 3.3924801349639893 
2022-04-13 22:04:16,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-13 22:04:16,310 reid_baseline.train INFO: Accuracy: 40.2% Mean Entropy: 339.2%
2022-04-13 22:04:30,561 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.968, Acc: 0.645, Base Lr: 6.42e-03
2022-04-13 22:04:43,177 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.975, Acc: 0.634, Base Lr: 6.42e-03
2022-04-13 22:04:52,167 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.131[s] Speed: 121.9[samples/s]
2022-04-13 22:05:13,395 reid_baseline.train INFO: normal accuracy 0.4510024780355936 3.306682586669922 
2022-04-13 22:05:14,646 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-13 22:05:14,646 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 330.7%
2022-04-13 22:05:28,691 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.790, Acc: 0.699, Base Lr: 7.21e-03
2022-04-13 22:05:40,368 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.811, Acc: 0.687, Base Lr: 7.21e-03
2022-04-13 22:05:49,119 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.126[s] Speed: 127.0[samples/s]
2022-04-13 22:06:08,199 reid_baseline.train INFO: normal accuracy 0.4584365848164001 3.188993215560913 
2022-04-13 22:06:09,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-13 22:06:09,444 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 318.9%
2022-04-13 22:06:22,107 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.677, Acc: 0.742, Base Lr: 4.01e-03
2022-04-13 22:06:34,156 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.688, Acc: 0.731, Base Lr: 4.01e-03
2022-04-13 22:06:44,268 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.127[s] Speed: 125.5[samples/s]
2022-04-13 22:07:05,783 reid_baseline.train INFO: normal accuracy 0.5005631899076368 3.1808810234069824 
2022-04-13 22:07:07,191 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-13 22:07:07,192 reid_baseline.train INFO: Accuracy: 50.1% Mean Entropy: 318.1%
2022-04-13 22:07:21,397 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.635, Acc: 0.746, Base Lr: 3.38e-03
2022-04-13 22:07:35,074 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.622, Acc: 0.748, Base Lr: 3.38e-03
2022-04-13 22:07:44,805 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.138[s] Speed: 116.4[samples/s]
2022-04-13 22:08:05,057 reid_baseline.train INFO: normal accuracy 0.5156566794323045 3.1030046939849854 
2022-04-13 22:08:06,064 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-13 22:08:06,065 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 310.3%
2022-04-13 22:08:19,602 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.558, Acc: 0.761, Base Lr: 2.77e-03
2022-04-13 22:08:31,378 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.572, Acc: 0.757, Base Lr: 2.77e-03
2022-04-13 22:08:41,553 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.130[s] Speed: 123.4[samples/s]
2022-04-13 22:09:02,371 reid_baseline.train INFO: normal accuracy 0.5237666141022753 3.1026554107666016 
2022-04-13 22:09:03,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-13 22:09:03,471 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 310.3%
2022-04-13 22:09:18,139 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.494, Acc: 0.805, Base Lr: 2.20e-03
2022-04-13 22:09:31,375 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.512, Acc: 0.790, Base Lr: 2.20e-03
2022-04-13 22:09:40,806 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.137[s] Speed: 117.1[samples/s]
2022-04-13 22:10:00,793 reid_baseline.train INFO: normal accuracy 0.5174588871367425 3.0797314643859863 
2022-04-13 22:10:01,826 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-13 22:10:01,826 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 308.0%
2022-04-13 22:10:15,474 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.484, Acc: 0.803, Base Lr: 1.66e-03
2022-04-13 22:10:28,266 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.475, Acc: 0.807, Base Lr: 1.66e-03
2022-04-13 22:10:37,454 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.130[s] Speed: 122.7[samples/s]
2022-04-13 22:10:55,451 reid_baseline.train INFO: normal accuracy 0.5341293084027934 3.103369951248169 
2022-04-13 22:10:55,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-13 22:10:55,452 reid_baseline.train INFO: Accuracy: 53.4% Mean Entropy: 310.3%
2022-04-13 22:11:09,025 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.447, Acc: 0.806, Base Lr: 1.19e-03
2022-04-13 22:11:21,888 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.456, Acc: 0.802, Base Lr: 1.19e-03
2022-04-13 22:11:31,399 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.132[s] Speed: 121.6[samples/s]
2022-04-13 22:11:52,087 reid_baseline.train INFO: normal accuracy 0.5352556882180671 3.0834031105041504 
2022-04-13 22:11:52,087 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-13 22:11:52,087 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 308.3%
2022-04-13 22:12:06,485 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.448, Acc: 0.809, Base Lr: 7.78e-04
2022-04-13 22:12:20,461 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.441, Acc: 0.816, Base Lr: 7.78e-04
2022-04-13 22:12:29,860 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.138[s] Speed: 115.7[samples/s]
2022-04-13 22:12:50,143 reid_baseline.train INFO: normal accuracy 0.5273710295111511 3.067816734313965 
2022-04-13 22:12:51,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-13 22:12:51,357 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 306.8%
2022-04-13 22:13:06,134 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.419, Acc: 0.817, Base Lr: 4.51e-04
2022-04-13 22:13:18,229 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.417, Acc: 0.818, Base Lr: 4.51e-04
2022-04-13 22:13:27,425 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.132[s] Speed: 121.2[samples/s]
2022-04-13 22:13:47,354 reid_baseline.train INFO: normal accuracy 0.5262446496958775 3.0520129203796387 
2022-04-13 22:13:48,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-13 22:13:48,614 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 305.2%
2022-04-13 22:14:02,113 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.398, Acc: 0.832, Base Lr: 2.11e-04
2022-04-13 22:14:14,752 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.395, Acc: 0.830, Base Lr: 2.11e-04
2022-04-13 22:14:24,865 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.133[s] Speed: 120.7[samples/s]
2022-04-13 22:14:45,979 reid_baseline.train INFO: normal accuracy 0.5289479612525344 3.0699849128723145 
2022-04-13 22:14:45,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-13 22:14:45,980 reid_baseline.train INFO: Accuracy: 52.9% Mean Entropy: 307.0%
2022-04-13 22:14:58,522 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.421, Acc: 0.807, Base Lr: 6.51e-05
2022-04-13 22:15:09,872 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.412, Acc: 0.820, Base Lr: 6.51e-05
2022-04-13 22:15:19,108 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-13 22:15:38,674 reid_baseline.train INFO: normal accuracy 0.5271457535480965 3.062124252319336 
2022-04-13 22:15:38,675 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-13 22:15:38,675 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 306.2%
2022-04-13 22:15:51,819 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.418, Acc: 0.827, Base Lr: 1.60e-05
2022-04-13 22:16:03,692 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.414, Acc: 0.826, Base Lr: 1.60e-05
2022-04-13 22:16:14,440 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.131[s] Speed: 122.2[samples/s]
2022-04-13 22:16:38,491 reid_baseline.train INFO: normal accuracy 0.5264699256589322 3.067378044128418 
2022-04-13 22:16:38,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-13 22:16:38,492 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 306.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_2_10/transformer_best_model.pth
2022-04-13 22:17:00,227 reid_baseline.train INFO: normal accuracy 0.5262446496958775 3.0520129203796387 
2022-04-13 22:17:00,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 22:17:00,227 reid_baseline.train INFO: Accuracy: 52.6%
2022-04-13 22:17:17,635 reid_baseline.train INFO: normal accuracy 0.4413156116242397 2.5484201908111572 
2022-04-13 22:17:17,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 22:17:17,635 reid_baseline.train INFO: Shuffled Accuracy: 44.1%
2022-04-13 22:17:34,972 reid_baseline.train INFO: normal accuracy 0.7603665521191294 2.2096667289733887 
2022-04-13 22:17:34,972 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-13 22:17:34,972 reid_baseline.train INFO: Source Clean Accuracy: 76.0%
