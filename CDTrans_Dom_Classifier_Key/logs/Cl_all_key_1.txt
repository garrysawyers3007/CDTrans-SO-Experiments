2022-04-25 18:53:15,382 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_1
2022-04-25 18:53:15,383 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 18:53:15,383 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 18:53:15,383 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 18:53:15,383 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 18:53:28,543 reid_baseline.train INFO: start training
2022-04-25 18:53:43,405 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.152, Acc: 0.082, Base Lr: 4.76e-04
2022-04-25 18:53:56,595 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.125, Acc: 0.119, Base Lr: 4.76e-04
2022-04-25 18:54:06,361 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.136[s] Speed: 118.0[samples/s]
2022-04-25 18:54:26,487 reid_baseline.train INFO: normal accuracy 0.09517923362175525 4.169007778167725 
2022-04-25 18:54:27,303 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 18:54:27,303 reid_baseline.train INFO: Accuracy: 9.5% Mean Entropy: 416.9%
2022-04-25 18:54:41,678 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.971, Acc: 0.211, Base Lr: 8.72e-04
2022-04-25 18:54:55,435 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.919, Acc: 0.215, Base Lr: 8.72e-04
2022-04-25 18:55:05,661 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.140[s] Speed: 114.1[samples/s]
2022-04-25 18:55:24,385 reid_baseline.train INFO: normal accuracy 0.09971157807993407 4.130615711212158 
2022-04-25 18:55:25,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 18:55:25,760 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 413.1%
2022-04-25 18:55:37,971 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.693, Acc: 0.212, Base Lr: 1.27e-03
2022-04-25 18:55:49,076 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.634, Acc: 0.227, Base Lr: 1.27e-03
2022-04-25 18:55:57,680 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.117[s] Speed: 136.9[samples/s]
2022-04-25 18:56:15,239 reid_baseline.train INFO: normal accuracy 0.12525751957148742 4.021700859069824 
2022-04-25 18:56:16,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 18:56:16,013 reid_baseline.train INFO: Accuracy: 12.5% Mean Entropy: 402.2%
2022-04-25 18:56:31,268 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.344, Acc: 0.285, Base Lr: 1.66e-03
2022-04-25 18:56:43,115 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.326, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 18:56:57,865 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.153[s] Speed: 104.7[samples/s]
2022-04-25 18:57:28,153 reid_baseline.train INFO: normal accuracy 0.1557478368355995 3.863725423812866 
2022-04-25 18:57:28,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 18:57:28,999 reid_baseline.train INFO: Accuracy: 15.6% Mean Entropy: 386.4%
2022-04-25 18:57:51,054 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.103, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 18:58:13,880 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.037, Acc: 0.356, Base Lr: 2.06e-03
2022-04-25 18:58:30,849 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.227[s] Speed: 70.6[samples/s]
2022-04-25 18:59:00,923 reid_baseline.train INFO: normal accuracy 0.1796456530696333 3.7136127948760986 
2022-04-25 18:59:01,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 18:59:01,814 reid_baseline.train INFO: Accuracy: 18.0% Mean Entropy: 371.4%
2022-04-25 18:59:27,366 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.846, Acc: 0.407, Base Lr: 2.46e-03
2022-04-25 18:59:49,290 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.801, Acc: 0.416, Base Lr: 2.46e-03
2022-04-25 19:00:05,468 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 19:00:34,768 reid_baseline.train INFO: normal accuracy 0.21054800164812526 3.5638065338134766 
2022-04-25 19:00:35,622 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 19:00:35,622 reid_baseline.train INFO: Accuracy: 21.1% Mean Entropy: 356.4%
2022-04-25 19:01:01,947 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.586, Acc: 0.487, Base Lr: 2.85e-03
2022-04-25 19:01:24,056 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.575, Acc: 0.477, Base Lr: 2.85e-03
2022-04-25 19:01:42,121 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.244[s] Speed: 65.7[samples/s]
2022-04-25 19:02:11,327 reid_baseline.train INFO: normal accuracy 0.23897816234033786 3.4524357318878174 
2022-04-25 19:02:12,198 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 19:02:12,198 reid_baseline.train INFO: Accuracy: 23.9% Mean Entropy: 345.2%
2022-04-25 19:02:36,225 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.379, Acc: 0.534, Base Lr: 3.25e-03
2022-04-25 19:02:58,588 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.376, Acc: 0.531, Base Lr: 3.25e-03
2022-04-25 19:03:17,853 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-25 19:03:49,914 reid_baseline.train INFO: normal accuracy 0.261639884631232 3.3252365589141846 
2022-04-25 19:03:50,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 19:03:50,828 reid_baseline.train INFO: Accuracy: 26.2% Mean Entropy: 332.5%
2022-04-25 19:04:16,747 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.242, Acc: 0.561, Base Lr: 3.64e-03
2022-04-25 19:04:39,345 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.212, Acc: 0.579, Base Lr: 3.64e-03
2022-04-25 19:04:57,530 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.244[s] Speed: 65.5[samples/s]
2022-04-25 19:05:27,057 reid_baseline.train INFO: normal accuracy 0.27441285537700866 3.1941299438476562 
2022-04-25 19:05:28,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 19:05:28,503 reid_baseline.train INFO: Accuracy: 27.4% Mean Entropy: 319.4%
2022-04-25 19:05:53,727 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.072, Acc: 0.619, Base Lr: 4.04e-03
2022-04-25 19:06:15,661 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.076, Acc: 0.615, Base Lr: 4.04e-03
2022-04-25 19:06:32,545 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.235[s] Speed: 68.2[samples/s]
2022-04-25 19:07:04,063 reid_baseline.train INFO: normal accuracy 0.2896580140090647 3.103346347808838 
2022-04-25 19:07:04,881 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 19:07:04,881 reid_baseline.train INFO: Accuracy: 29.0% Mean Entropy: 310.3%
2022-04-25 19:07:28,567 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.966, Acc: 0.641, Base Lr: 4.44e-03
2022-04-25 19:07:52,385 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.945, Acc: 0.645, Base Lr: 4.44e-03
2022-04-25 19:08:09,506 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.236[s] Speed: 67.7[samples/s]
2022-04-25 19:08:39,946 reid_baseline.train INFO: normal accuracy 0.30284301606922126 2.975707769393921 
2022-04-25 19:08:42,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 19:08:42,048 reid_baseline.train INFO: Accuracy: 30.3% Mean Entropy: 297.6%
2022-04-25 19:09:06,268 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.800, Acc: 0.695, Base Lr: 4.83e-03
2022-04-25 19:09:31,524 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.818, Acc: 0.692, Base Lr: 4.83e-03
2022-04-25 19:09:48,968 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.245[s] Speed: 65.3[samples/s]
2022-04-25 19:10:19,637 reid_baseline.train INFO: normal accuracy 0.3057272352698805 2.9450855255126953 
2022-04-25 19:10:21,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 19:10:21,152 reid_baseline.train INFO: Accuracy: 30.6% Mean Entropy: 294.5%
2022-04-25 19:10:43,464 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.714, Base Lr: 5.23e-03
2022-04-25 19:11:08,066 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.725, Acc: 0.719, Base Lr: 5.23e-03
2022-04-25 19:11:23,483 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.228[s] Speed: 70.1[samples/s]
2022-04-25 19:11:52,102 reid_baseline.train INFO: normal accuracy 0.3110836423568191 2.8226141929626465 
2022-04-25 19:11:52,925 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 19:11:52,925 reid_baseline.train INFO: Accuracy: 31.1% Mean Entropy: 282.3%
2022-04-25 19:12:11,605 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.684, Acc: 0.731, Base Lr: 5.62e-03
2022-04-25 19:12:34,555 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.662, Acc: 0.736, Base Lr: 5.62e-03
2022-04-25 19:12:49,814 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.208[s] Speed: 76.8[samples/s]
2022-04-25 19:13:18,788 reid_baseline.train INFO: normal accuracy 0.3119077049855789 2.7538390159606934 
2022-04-25 19:13:19,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 19:13:19,755 reid_baseline.train INFO: Accuracy: 31.2% Mean Entropy: 275.4%
2022-04-25 19:13:43,207 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.544, Acc: 0.781, Base Lr: 6.02e-03
2022-04-25 19:14:06,731 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.565, Acc: 0.768, Base Lr: 6.02e-03
2022-04-25 19:14:22,388 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.229[s] Speed: 69.7[samples/s]
2022-04-25 19:14:52,606 reid_baseline.train INFO: normal accuracy 0.3238566131025958 2.7144224643707275 
2022-04-25 19:14:53,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 19:14:53,722 reid_baseline.train INFO: Accuracy: 32.4% Mean Entropy: 271.4%
2022-04-25 19:15:17,731 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.485, Acc: 0.792, Base Lr: 6.42e-03
2022-04-25 19:15:43,254 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.486, Acc: 0.793, Base Lr: 6.42e-03
2022-04-25 19:16:00,421 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.244[s] Speed: 65.5[samples/s]
2022-04-25 19:16:31,023 reid_baseline.train INFO: normal accuracy 0.323032550473836 2.6495392322540283 
2022-04-25 19:16:32,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 19:16:32,241 reid_baseline.train INFO: Accuracy: 32.3% Mean Entropy: 265.0%
2022-04-25 19:16:55,189 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.445, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 19:17:19,232 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.451, Acc: 0.800, Base Lr: 6.81e-03
2022-04-25 19:17:34,774 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.229[s] Speed: 69.9[samples/s]
2022-04-25 19:18:04,743 reid_baseline.train INFO: normal accuracy 0.3300370828182942 2.6507694721221924 
2022-04-25 19:18:04,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 19:18:04,748 reid_baseline.train INFO: Accuracy: 33.0% Mean Entropy: 265.1%
2022-04-25 19:18:29,549 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.367, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 19:18:49,394 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.382, Acc: 0.818, Base Lr: 7.21e-03
2022-04-25 19:19:05,966 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.224[s] Speed: 71.5[samples/s]
2022-04-25 19:19:37,171 reid_baseline.train INFO: normal accuracy 0.3288009888751545 2.593196392059326 
2022-04-25 19:19:39,005 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 19:19:39,005 reid_baseline.train INFO: Accuracy: 32.9% Mean Entropy: 259.3%
2022-04-25 19:20:04,850 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.320, Acc: 0.843, Base Lr: 7.60e-03
2022-04-25 19:20:25,502 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.348, Acc: 0.835, Base Lr: 7.60e-03
2022-04-25 19:20:43,233 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.235[s] Speed: 68.0[samples/s]
2022-04-25 19:21:14,448 reid_baseline.train INFO: normal accuracy 0.319324268644417 2.6661949157714844 
2022-04-25 19:21:14,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 19:21:14,451 reid_baseline.train INFO: Accuracy: 31.9% Mean Entropy: 266.6%
2022-04-25 19:21:40,258 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.259, Acc: 0.864, Base Lr: 4.01e-03
2022-04-25 19:22:01,652 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.243, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 19:22:20,978 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.243[s] Speed: 65.7[samples/s]
2022-04-25 19:22:51,844 reid_baseline.train INFO: normal accuracy 0.3341573959620931 2.582362651824951 
2022-04-25 19:22:52,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 19:22:52,656 reid_baseline.train INFO: Accuracy: 33.4% Mean Entropy: 258.2%
2022-04-25 19:23:17,009 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.198, Acc: 0.892, Base Lr: 3.69e-03
2022-04-25 19:23:38,111 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.190, Acc: 0.891, Base Lr: 3.69e-03
2022-04-25 19:23:54,798 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.227[s] Speed: 70.3[samples/s]
2022-04-25 19:24:24,673 reid_baseline.train INFO: normal accuracy 0.3395138030490317 2.5401198863983154 
2022-04-25 19:24:26,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 19:24:26,399 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 254.0%
2022-04-25 19:24:51,831 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.182, Acc: 0.888, Base Lr: 3.38e-03
2022-04-25 19:25:12,315 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.178, Acc: 0.895, Base Lr: 3.38e-03
2022-04-25 19:25:30,856 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.236[s] Speed: 67.8[samples/s]
2022-04-25 19:26:01,717 reid_baseline.train INFO: normal accuracy 0.3263288009888752 2.5657076835632324 
2022-04-25 19:26:01,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 19:26:01,722 reid_baseline.train INFO: Accuracy: 32.6% Mean Entropy: 256.6%
2022-04-25 19:26:27,612 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.159, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 19:26:49,209 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.164, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 19:27:07,794 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-25 19:27:39,603 reid_baseline.train INFO: normal accuracy 0.33498145859085293 2.5369632244110107 
2022-04-25 19:27:41,261 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 19:27:41,262 reid_baseline.train INFO: Accuracy: 33.5% Mean Entropy: 253.7%
2022-04-25 19:28:05,222 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.111, Acc: 0.919, Base Lr: 2.77e-03
2022-04-25 19:28:23,394 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.127, Acc: 0.915, Base Lr: 2.77e-03
2022-04-25 19:28:38,803 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.211[s] Speed: 75.9[samples/s]
2022-04-25 19:29:05,969 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.4704713821411133 
2022-04-25 19:29:06,759 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 19:29:06,759 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 247.0%
2022-04-25 19:29:33,929 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.123, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 19:29:54,524 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.119, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 19:30:11,137 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.236[s] Speed: 67.9[samples/s]
2022-04-25 19:30:42,281 reid_baseline.train INFO: normal accuracy 0.33127317676143386 2.4865598678588867 
2022-04-25 19:30:42,282 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 19:30:42,282 reid_baseline.train INFO: Accuracy: 33.1% Mean Entropy: 248.7%
2022-04-25 19:31:08,142 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.092, Acc: 0.932, Base Lr: 2.20e-03
2022-04-25 19:31:29,960 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.093, Acc: 0.922, Base Lr: 2.20e-03
2022-04-25 19:31:46,889 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.237[s] Speed: 67.6[samples/s]
2022-04-25 19:32:16,926 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.538588762283325 
2022-04-25 19:32:16,928 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 19:32:16,929 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 253.9%
2022-04-25 19:32:43,615 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.090, Acc: 0.924, Base Lr: 1.92e-03
2022-04-25 19:33:06,095 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 19:33:23,516 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.244[s] Speed: 65.6[samples/s]
2022-04-25 19:33:54,937 reid_baseline.train INFO: normal accuracy 0.3366295838483725 2.487049102783203 
2022-04-25 19:33:54,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 19:33:54,940 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 248.7%
2022-04-25 19:34:21,509 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.089, Acc: 0.921, Base Lr: 1.66e-03
2022-04-25 19:34:41,565 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.077, Acc: 0.927, Base Lr: 1.66e-03
2022-04-25 19:34:59,872 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 19:35:27,623 reid_baseline.train INFO: normal accuracy 0.3366295838483725 2.516362428665161 
2022-04-25 19:35:27,628 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 19:35:27,628 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 251.6%
2022-04-25 19:35:53,200 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.057, Acc: 0.936, Base Lr: 1.42e-03
2022-04-25 19:36:14,526 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.058, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 19:36:34,050 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.243[s] Speed: 65.8[samples/s]
2022-04-25 19:37:04,365 reid_baseline.train INFO: normal accuracy 0.3399258343634116 2.510101079940796 
2022-04-25 19:37:04,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 19:37:04,371 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 251.0%
2022-04-25 19:37:29,765 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.060, Acc: 0.936, Base Lr: 1.19e-03
2022-04-25 19:37:50,439 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.050, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 19:38:10,319 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 19:38:40,151 reid_baseline.train INFO: normal accuracy 0.33827770910589205 2.524209499359131 
2022-04-25 19:38:40,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 19:38:40,153 reid_baseline.train INFO: Accuracy: 33.8% Mean Entropy: 252.4%
2022-04-25 19:39:05,339 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 19:39:25,170 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.035, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 19:39:45,874 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-25 19:40:15,172 reid_baseline.train INFO: normal accuracy 0.3374536464771323 2.5106263160705566 
2022-04-25 19:40:15,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 19:40:15,175 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 251.1%
2022-04-25 19:40:39,381 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.043, Acc: 0.943, Base Lr: 7.78e-04
2022-04-25 19:41:01,313 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.043, Acc: 0.941, Base Lr: 7.78e-04
2022-04-25 19:41:20,230 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.238[s] Speed: 67.4[samples/s]
2022-04-25 19:41:48,764 reid_baseline.train INFO: normal accuracy 0.34363411619283063 2.5201773643493652 
2022-04-25 19:41:48,769 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 19:41:48,769 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 252.0%
2022-04-25 19:42:14,407 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.025, Acc: 0.951, Base Lr: 6.04e-04
2022-04-25 19:42:35,891 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.026, Acc: 0.949, Base Lr: 6.04e-04
2022-04-25 19:42:54,501 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.241[s] Speed: 66.5[samples/s]
2022-04-25 19:43:25,203 reid_baseline.train INFO: normal accuracy 0.34239802224969096 2.515040636062622 
2022-04-25 19:43:25,208 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 19:43:25,208 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 251.5%
2022-04-25 19:43:51,509 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.022, Acc: 0.950, Base Lr: 4.51e-04
2022-04-25 19:44:12,112 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.021, Acc: 0.952, Base Lr: 4.51e-04
2022-04-25 19:44:28,903 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 19:44:54,491 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.5230038166046143 
2022-04-25 19:44:54,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 19:44:54,494 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 252.3%
2022-04-25 19:45:16,229 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.039, Acc: 0.936, Base Lr: 3.20e-04
2022-04-25 19:45:39,194 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.034, Acc: 0.940, Base Lr: 3.20e-04
2022-04-25 19:45:58,396 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.234[s] Speed: 68.4[samples/s]
2022-04-25 19:46:27,361 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5021514892578125 
2022-04-25 19:46:27,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 19:46:27,364 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.2%
2022-04-25 19:46:52,207 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.010, Acc: 0.949, Base Lr: 2.11e-04
2022-04-25 19:47:13,347 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.023, Acc: 0.948, Base Lr: 2.11e-04
2022-04-25 19:47:32,162 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 19:48:03,114 reid_baseline.train INFO: normal accuracy 0.34363411619283063 2.5057015419006348 
2022-04-25 19:48:03,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 19:48:03,119 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 250.6%
2022-04-25 19:48:28,557 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.038, Acc: 0.942, Base Lr: 1.26e-04
2022-04-25 19:48:49,641 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.028, Acc: 0.947, Base Lr: 1.26e-04
2022-04-25 19:49:08,402 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.239[s] Speed: 67.1[samples/s]
2022-04-25 19:49:37,955 reid_baseline.train INFO: normal accuracy 0.3395138030490317 2.4746334552764893 
2022-04-25 19:49:37,959 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 19:49:37,960 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 247.5%
2022-04-25 19:50:04,749 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.025, Acc: 0.944, Base Lr: 6.51e-05
2022-04-25 19:50:26,492 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 6.51e-05
2022-04-25 19:50:45,068 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 19:51:13,954 reid_baseline.train INFO: normal accuracy 0.3399258343634116 2.5071473121643066 
2022-04-25 19:51:13,956 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 19:51:13,956 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 250.7%
2022-04-25 19:51:39,059 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.004, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 19:52:00,880 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.017, Acc: 0.947, Base Lr: 2.83e-05
2022-04-25 19:52:19,317 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.239[s] Speed: 66.9[samples/s]
2022-04-25 19:52:48,148 reid_baseline.train INFO: normal accuracy 0.3411619283065513 2.488529682159424 
2022-04-25 19:52:48,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 19:52:48,153 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 248.9%
2022-04-25 19:53:13,568 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.035, Acc: 0.931, Base Lr: 1.60e-05
2022-04-25 19:53:35,776 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.939, Base Lr: 1.60e-05
2022-04-25 19:53:54,167 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 19:54:21,780 reid_baseline.train INFO: normal accuracy 0.33868974042027195 2.478785276412964 
2022-04-25 19:54:21,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 19:54:21,785 reid_baseline.train INFO: Accuracy: 33.9% Mean Entropy: 247.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 19:54:53,698 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.4704713821411133 
2022-04-25 19:54:53,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:54:53,699 reid_baseline.train INFO: Accuracy: 34.5%
2022-04-25 19:55:20,579 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.4704713821411133 
2022-04-25 19:55:20,579 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:55:20,579 reid_baseline.train INFO: Shuffled Accuracy: 34.5%
2022-04-25 19:56:13,629 reid_baseline.train INFO: normal accuracy 0.8877434135166093 1.2689359188079834 
2022-04-25 19:56:13,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:56:13,630 reid_baseline.train INFO: Source Clean Accuracy: 88.8%
2022-04-25 19:56:18,709 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_1
2022-04-25 19:56:18,709 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 19:56:18,709 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 19:56:18,709 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 19:56:18,709 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 19:56:32,342 reid_baseline.train INFO: start training
2022-04-25 19:56:55,301 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.152, Acc: 0.082, Base Lr: 4.76e-04
2022-04-25 19:57:18,676 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.125, Acc: 0.119, Base Lr: 4.76e-04
2022-04-25 19:57:37,099 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.236[s] Speed: 67.9[samples/s]
2022-04-25 19:58:23,119 reid_baseline.train INFO: normal accuracy 0.11353908537959 4.169488430023193 
2022-04-25 19:58:24,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 19:58:24,025 reid_baseline.train INFO: Accuracy: 11.4% Mean Entropy: 416.9%
2022-04-25 19:58:50,242 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.971, Acc: 0.211, Base Lr: 8.72e-04
2022-04-25 19:59:13,663 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.919, Acc: 0.215, Base Lr: 8.72e-04
2022-04-25 19:59:32,797 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-25 20:00:22,581 reid_baseline.train INFO: normal accuracy 0.10047307952241495 4.132722854614258 
2022-04-25 20:00:23,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 20:00:23,729 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 413.3%
2022-04-25 20:00:48,106 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.693, Acc: 0.212, Base Lr: 1.27e-03
2022-04-25 20:01:07,913 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.634, Acc: 0.227, Base Lr: 1.27e-03
2022-04-25 20:01:22,084 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.213[s] Speed: 75.1[samples/s]
2022-04-25 20:02:12,471 reid_baseline.train INFO: normal accuracy 0.1380941653525569 4.028823375701904 
2022-04-25 20:02:13,493 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:02:13,493 reid_baseline.train INFO: Accuracy: 13.8% Mean Entropy: 402.9%
2022-04-25 20:02:31,750 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.344, Acc: 0.285, Base Lr: 1.66e-03
2022-04-25 20:02:55,021 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.326, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 20:03:13,198 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.218[s] Speed: 73.4[samples/s]
2022-04-25 20:04:04,723 reid_baseline.train INFO: normal accuracy 0.18878125703987383 3.8710625171661377 
2022-04-25 20:04:05,525 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:04:05,526 reid_baseline.train INFO: Accuracy: 18.9% Mean Entropy: 387.1%
2022-04-25 20:04:32,314 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.103, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 20:04:55,989 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.037, Acc: 0.356, Base Lr: 2.06e-03
2022-04-25 20:05:13,472 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.249[s] Speed: 64.3[samples/s]
2022-04-25 20:06:05,718 reid_baseline.train INFO: normal accuracy 0.22212209957197568 3.720670461654663 
2022-04-25 20:06:06,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:06:06,508 reid_baseline.train INFO: Accuracy: 22.2% Mean Entropy: 372.1%
2022-04-25 20:06:30,228 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.846, Acc: 0.407, Base Lr: 2.46e-03
2022-04-25 20:06:53,803 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.801, Acc: 0.416, Base Lr: 2.46e-03
2022-04-25 20:07:10,923 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.236[s] Speed: 67.9[samples/s]
2022-04-25 20:08:00,439 reid_baseline.train INFO: normal accuracy 0.30569948186528495 3.495267391204834 
2022-04-25 20:08:01,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 20:08:01,236 reid_baseline.train INFO: Accuracy: 30.6% Mean Entropy: 349.5%
2022-04-25 20:08:27,101 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.586, Acc: 0.487, Base Lr: 2.85e-03
2022-04-25 20:08:52,097 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.575, Acc: 0.477, Base Lr: 2.85e-03
2022-04-25 20:09:09,056 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 20:10:00,219 reid_baseline.train INFO: normal accuracy 0.32912818202297817 3.407700538635254 
2022-04-25 20:10:01,427 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 20:10:01,427 reid_baseline.train INFO: Accuracy: 32.9% Mean Entropy: 340.8%
2022-04-25 20:10:28,063 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.379, Acc: 0.534, Base Lr: 3.25e-03
2022-04-25 20:10:52,714 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.376, Acc: 0.531, Base Lr: 3.25e-03
2022-04-25 20:11:10,882 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.254[s] Speed: 62.9[samples/s]
2022-04-25 20:12:02,918 reid_baseline.train INFO: normal accuracy 0.3737328227078171 3.1685898303985596 
2022-04-25 20:12:04,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 20:12:04,142 reid_baseline.train INFO: Accuracy: 37.4% Mean Entropy: 316.9%
2022-04-25 20:12:30,681 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.242, Acc: 0.561, Base Lr: 3.64e-03
2022-04-25 20:12:55,568 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.212, Acc: 0.579, Base Lr: 3.64e-03
2022-04-25 20:13:13,012 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-25 20:14:08,412 reid_baseline.train INFO: normal accuracy 0.3962604190132913 3.0543878078460693 
2022-04-25 20:14:09,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 20:14:09,481 reid_baseline.train INFO: Accuracy: 39.6% Mean Entropy: 305.4%
2022-04-25 20:14:35,289 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.072, Acc: 0.619, Base Lr: 4.04e-03
2022-04-25 20:15:00,459 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.076, Acc: 0.615, Base Lr: 4.04e-03
2022-04-25 20:15:19,736 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.257[s] Speed: 62.3[samples/s]
2022-04-25 20:16:09,205 reid_baseline.train INFO: normal accuracy 0.4075242171660284 2.949812650680542 
2022-04-25 20:16:09,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 20:16:09,995 reid_baseline.train INFO: Accuracy: 40.8% Mean Entropy: 295.0%
2022-04-25 20:16:31,997 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.966, Acc: 0.641, Base Lr: 4.44e-03
2022-04-25 20:16:54,778 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.945, Acc: 0.645, Base Lr: 4.44e-03
2022-04-25 20:17:13,929 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.234[s] Speed: 68.4[samples/s]
2022-04-25 20:18:08,298 reid_baseline.train INFO: normal accuracy 0.43568371254787114 2.7186403274536133 
2022-04-25 20:18:09,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 20:18:09,140 reid_baseline.train INFO: Accuracy: 43.6% Mean Entropy: 271.9%
2022-04-25 20:18:33,616 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.800, Acc: 0.695, Base Lr: 4.83e-03
2022-04-25 20:18:59,265 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.818, Acc: 0.692, Base Lr: 4.83e-03
2022-04-25 20:19:17,931 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-25 20:20:11,223 reid_baseline.train INFO: normal accuracy 0.43951340391980176 2.7472565174102783 
2022-04-25 20:20:11,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 20:20:11,228 reid_baseline.train INFO: Accuracy: 44.0% Mean Entropy: 274.7%
2022-04-25 20:20:37,141 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.714, Base Lr: 5.23e-03
2022-04-25 20:21:02,660 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.725, Acc: 0.719, Base Lr: 5.23e-03
2022-04-25 20:21:20,609 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.254[s] Speed: 63.1[samples/s]
2022-04-25 20:22:13,598 reid_baseline.train INFO: normal accuracy 0.4514530299617031 2.5746724605560303 
2022-04-25 20:22:14,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 20:22:14,648 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 257.5%
2022-04-25 20:22:42,131 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.684, Acc: 0.731, Base Lr: 5.62e-03
2022-04-25 20:23:05,579 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.662, Acc: 0.736, Base Lr: 5.62e-03
2022-04-25 20:23:24,972 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.256[s] Speed: 62.6[samples/s]
2022-04-25 20:24:19,472 reid_baseline.train INFO: normal accuracy 0.45010137418337465 2.5227224826812744 
2022-04-25 20:24:20,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 20:24:20,318 reid_baseline.train INFO: Accuracy: 45.0% Mean Entropy: 252.3%
2022-04-25 20:24:48,268 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.544, Acc: 0.781, Base Lr: 6.02e-03
2022-04-25 20:25:13,134 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.565, Acc: 0.768, Base Lr: 6.02e-03
2022-04-25 20:25:31,432 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-25 20:26:26,703 reid_baseline.train INFO: normal accuracy 0.4618157242622212 2.318225145339966 
2022-04-25 20:26:27,720 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 20:26:27,720 reid_baseline.train INFO: Accuracy: 46.2% Mean Entropy: 231.8%
2022-04-25 20:26:54,560 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.485, Acc: 0.792, Base Lr: 6.42e-03
2022-04-25 20:27:17,663 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.486, Acc: 0.793, Base Lr: 6.42e-03
2022-04-25 20:27:35,681 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.249[s] Speed: 64.3[samples/s]
2022-04-25 20:28:30,304 reid_baseline.train INFO: normal accuracy 0.47060148682135616 2.3383994102478027 
2022-04-25 20:28:30,306 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 20:28:30,307 reid_baseline.train INFO: Accuracy: 47.1% Mean Entropy: 233.8%
2022-04-25 20:28:55,211 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.445, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 20:29:20,914 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.451, Acc: 0.800, Base Lr: 6.81e-03
2022-04-25 20:29:39,002 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.251[s] Speed: 63.6[samples/s]
2022-04-25 20:30:26,814 reid_baseline.train INFO: normal accuracy 0.4537057895922505 2.3571789264678955 
2022-04-25 20:30:26,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 20:30:26,818 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 235.7%
2022-04-25 20:30:49,204 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.367, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 20:31:15,013 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.382, Acc: 0.818, Base Lr: 7.21e-03
2022-04-25 20:31:32,609 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.239[s] Speed: 66.8[samples/s]
2022-04-25 20:32:27,286 reid_baseline.train INFO: normal accuracy 0.4739806262671773 2.2571964263916016 
2022-04-25 20:32:28,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 20:32:28,420 reid_baseline.train INFO: Accuracy: 47.4% Mean Entropy: 225.7%
2022-04-25 20:32:52,602 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.320, Acc: 0.843, Base Lr: 7.60e-03
2022-04-25 20:33:17,782 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.348, Acc: 0.835, Base Lr: 7.60e-03
2022-04-25 20:33:36,147 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 20:34:33,494 reid_baseline.train INFO: normal accuracy 0.4633926560036044 2.373192071914673 
2022-04-25 20:34:33,497 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 20:34:33,497 reid_baseline.train INFO: Accuracy: 46.3% Mean Entropy: 237.3%
2022-04-25 20:35:00,002 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.259, Acc: 0.864, Base Lr: 4.01e-03
2022-04-25 20:35:26,285 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.243, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 20:35:43,651 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.257[s] Speed: 62.3[samples/s]
2022-04-25 20:36:39,263 reid_baseline.train INFO: normal accuracy 0.4728542464519036 2.1919186115264893 
2022-04-25 20:36:40,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 20:36:40,045 reid_baseline.train INFO: Accuracy: 47.3% Mean Entropy: 219.2%
2022-04-25 20:37:04,577 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.198, Acc: 0.892, Base Lr: 3.69e-03
2022-04-25 20:37:28,337 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.190, Acc: 0.891, Base Lr: 3.69e-03
2022-04-25 20:37:46,158 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 20:38:39,978 reid_baseline.train INFO: normal accuracy 0.4836674926785312 2.1369788646698 
2022-04-25 20:38:40,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 20:38:40,761 reid_baseline.train INFO: Accuracy: 48.4% Mean Entropy: 213.7%
2022-04-25 20:39:05,637 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.182, Acc: 0.888, Base Lr: 3.38e-03
2022-04-25 20:39:31,394 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.178, Acc: 0.895, Base Lr: 3.38e-03
2022-04-25 20:39:49,999 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-25 20:40:43,164 reid_baseline.train INFO: normal accuracy 0.4784861455282721 2.1987218856811523 
2022-04-25 20:40:43,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 20:40:43,168 reid_baseline.train INFO: Accuracy: 47.8% Mean Entropy: 219.9%
2022-04-25 20:41:09,424 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.159, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 20:41:35,048 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.164, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 20:41:53,845 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.258[s] Speed: 62.0[samples/s]
2022-04-25 20:42:46,804 reid_baseline.train INFO: normal accuracy 0.49357963505293984 2.1499130725860596 
2022-04-25 20:42:46,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 20:42:46,806 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 215.0%
2022-04-25 20:43:12,532 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.111, Acc: 0.919, Base Lr: 2.77e-03
2022-04-25 20:43:37,562 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.127, Acc: 0.915, Base Lr: 2.77e-03
2022-04-25 20:43:56,075 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.254[s] Speed: 63.1[samples/s]
2022-04-25 20:44:44,860 reid_baseline.train INFO: normal accuracy 0.5014642937598558 2.0998542308807373 
2022-04-25 20:44:45,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 20:44:45,660 reid_baseline.train INFO: Accuracy: 50.1% Mean Entropy: 210.0%
2022-04-25 20:45:06,634 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.123, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 20:45:28,649 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.119, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 20:45:48,357 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.230[s] Speed: 69.7[samples/s]
2022-04-25 20:46:44,028 reid_baseline.train INFO: normal accuracy 0.48659608019824285 2.0773532390594482 
2022-04-25 20:46:45,235 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 20:46:45,236 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 207.7%
2022-04-25 20:47:13,155 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.092, Acc: 0.932, Base Lr: 2.20e-03
2022-04-25 20:47:36,102 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.093, Acc: 0.922, Base Lr: 2.20e-03
2022-04-25 20:47:54,583 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.253[s] Speed: 63.1[samples/s]
2022-04-25 20:48:50,438 reid_baseline.train INFO: normal accuracy 0.496057670646542 2.124727964401245 
2022-04-25 20:48:50,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 20:48:50,443 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 212.5%
2022-04-25 20:49:15,722 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.090, Acc: 0.924, Base Lr: 1.92e-03
2022-04-25 20:49:40,659 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 20:49:59,591 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-25 20:50:53,049 reid_baseline.train INFO: normal accuracy 0.49357963505293984 2.0900719165802 
2022-04-25 20:50:53,052 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 20:50:53,052 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 209.0%
2022-04-25 20:51:19,713 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.089, Acc: 0.921, Base Lr: 1.66e-03
2022-04-25 20:51:42,770 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.077, Acc: 0.927, Base Lr: 1.66e-03
2022-04-25 20:52:01,921 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-25 20:52:53,690 reid_baseline.train INFO: normal accuracy 0.4958323946834873 2.09065318107605 
2022-04-25 20:52:53,694 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 20:52:53,695 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 209.1%
2022-04-25 20:53:17,834 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.057, Acc: 0.936, Base Lr: 1.42e-03
2022-04-25 20:53:41,744 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.058, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 20:53:59,429 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.241[s] Speed: 66.5[samples/s]
2022-04-25 20:54:53,614 reid_baseline.train INFO: normal accuracy 0.49673349853570625 2.11674165725708 
2022-04-25 20:54:53,616 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 20:54:53,616 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 211.7%
2022-04-25 20:55:17,642 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.060, Acc: 0.936, Base Lr: 1.19e-03
2022-04-25 20:55:42,562 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.050, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 20:56:00,940 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.246[s] Speed: 64.9[samples/s]
2022-04-25 20:56:49,473 reid_baseline.train INFO: normal accuracy 0.4911015994593377 2.1160781383514404 
2022-04-25 20:56:49,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 20:56:49,478 reid_baseline.train INFO: Accuracy: 49.1% Mean Entropy: 211.6%
2022-04-25 20:57:14,914 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 20:57:36,750 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.035, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 20:57:54,998 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.239[s] Speed: 66.9[samples/s]
2022-04-25 20:58:49,762 reid_baseline.train INFO: normal accuracy 0.4940301869790493 2.131439447402954 
2022-04-25 20:58:49,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 20:58:49,776 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 213.1%
2022-04-25 20:59:16,523 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.043, Acc: 0.943, Base Lr: 7.78e-04
2022-04-25 20:59:39,905 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.043, Acc: 0.941, Base Lr: 7.78e-04
2022-04-25 20:59:55,235 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 21:00:38,257 reid_baseline.train INFO: normal accuracy 0.49853570624014415 2.1374855041503906 
2022-04-25 21:00:38,259 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 21:00:38,260 reid_baseline.train INFO: Accuracy: 49.9% Mean Entropy: 213.7%
2022-04-25 21:01:04,645 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.025, Acc: 0.951, Base Lr: 6.04e-04
2022-04-25 21:01:29,672 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.026, Acc: 0.949, Base Lr: 6.04e-04
2022-04-25 21:01:46,803 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-25 21:02:38,805 reid_baseline.train INFO: normal accuracy 0.5007884658706916 2.1149063110351562 
2022-04-25 21:02:38,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 21:02:38,810 reid_baseline.train INFO: Accuracy: 50.1% Mean Entropy: 211.5%
2022-04-25 21:03:05,196 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.022, Acc: 0.950, Base Lr: 4.51e-04
2022-04-25 21:03:27,045 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.021, Acc: 0.952, Base Lr: 4.51e-04
2022-04-25 21:03:44,136 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.239[s] Speed: 66.9[samples/s]
2022-04-25 21:04:38,448 reid_baseline.train INFO: normal accuracy 0.5019148456859653 2.1127724647521973 
2022-04-25 21:04:38,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 21:04:38,450 reid_baseline.train INFO: Accuracy: 50.2% Mean Entropy: 211.3%
2022-04-25 21:05:04,128 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.039, Acc: 0.936, Base Lr: 3.20e-04
2022-04-25 21:05:29,915 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.034, Acc: 0.940, Base Lr: 3.20e-04
2022-04-25 21:05:47,855 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.253[s] Speed: 63.3[samples/s]
2022-04-25 21:06:39,125 reid_baseline.train INFO: normal accuracy 0.4958323946834873 2.094761848449707 
2022-04-25 21:06:39,129 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 21:06:39,129 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 209.5%
2022-04-25 21:07:06,076 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.010, Acc: 0.949, Base Lr: 2.11e-04
2022-04-25 21:07:30,625 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.023, Acc: 0.948, Base Lr: 2.11e-04
2022-04-25 21:07:47,678 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 21:08:40,682 reid_baseline.train INFO: normal accuracy 0.4944807389051588 2.105222225189209 
2022-04-25 21:08:40,686 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 21:08:40,687 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 210.5%
2022-04-25 21:09:05,290 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.038, Acc: 0.942, Base Lr: 1.26e-04
2022-04-25 21:09:28,797 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.028, Acc: 0.947, Base Lr: 1.26e-04
2022-04-25 21:09:47,345 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.244[s] Speed: 65.6[samples/s]
2022-04-25 21:10:37,685 reid_baseline.train INFO: normal accuracy 0.50214012164902 2.0782768726348877 
2022-04-25 21:10:37,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 21:10:37,690 reid_baseline.train INFO: Accuracy: 50.2% Mean Entropy: 207.8%
2022-04-25 21:11:05,044 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.025, Acc: 0.944, Base Lr: 6.51e-05
2022-04-25 21:11:29,086 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 6.51e-05
2022-04-25 21:11:47,614 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-25 21:12:39,428 reid_baseline.train INFO: normal accuracy 0.4980851543140347 2.097219228744507 
2022-04-25 21:12:39,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 21:12:39,433 reid_baseline.train INFO: Accuracy: 49.8% Mean Entropy: 209.7%
2022-04-25 21:13:05,754 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.004, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 21:13:29,384 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.017, Acc: 0.947, Base Lr: 2.83e-05
2022-04-25 21:13:46,120 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.244[s] Speed: 65.5[samples/s]
2022-04-25 21:14:41,133 reid_baseline.train INFO: normal accuracy 0.4965082225726515 2.095045804977417 
2022-04-25 21:14:41,135 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 21:14:41,135 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 209.5%
2022-04-25 21:15:05,114 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.035, Acc: 0.931, Base Lr: 1.60e-05
2022-04-25 21:15:28,575 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.939, Base Lr: 1.60e-05
2022-04-25 21:15:47,048 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-25 21:16:30,255 reid_baseline.train INFO: normal accuracy 0.49673349853570625 2.0848026275634766 
2022-04-25 21:16:30,257 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 21:16:30,258 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 208.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 21:17:21,795 reid_baseline.train INFO: normal accuracy 0.48659608019824285 2.0773532390594482 
2022-04-25 21:17:21,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:17:21,796 reid_baseline.train INFO: Accuracy: 48.7%
2022-04-25 21:18:09,617 reid_baseline.train INFO: normal accuracy 0.48659608019824285 2.0773532390594482 
2022-04-25 21:18:09,617 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:18:09,618 reid_baseline.train INFO: Shuffled Accuracy: 48.7%
2022-04-25 21:19:02,960 reid_baseline.train INFO: normal accuracy 0.8996563573883162 1.2117550373077393 
2022-04-25 21:19:02,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:19:02,961 reid_baseline.train INFO: Source Clean Accuracy: 90.0%
2022-04-25 21:19:09,879 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_1
2022-04-25 21:19:09,879 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 21:19:09,879 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 21:19:09,879 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 21:19:09,880 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 21:19:27,805 reid_baseline.train INFO: start training
2022-04-25 21:19:52,918 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.152, Acc: 0.082, Base Lr: 4.76e-04
2022-04-25 21:20:18,732 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.125, Acc: 0.119, Base Lr: 4.76e-04
2022-04-25 21:20:38,320 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.255[s] Speed: 62.8[samples/s]
2022-04-25 21:21:33,665 reid_baseline.train INFO: normal accuracy 0.13380766582510903 4.168881893157959 
2022-04-25 21:21:34,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 21:21:34,830 reid_baseline.train INFO: Accuracy: 13.4% Mean Entropy: 416.9%
2022-04-25 21:22:04,102 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.971, Acc: 0.211, Base Lr: 8.72e-04
2022-04-25 21:22:26,605 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.919, Acc: 0.215, Base Lr: 8.72e-04
2022-04-25 21:22:46,318 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.261[s] Speed: 61.3[samples/s]
2022-04-25 21:23:49,761 reid_baseline.train INFO: normal accuracy 0.1351847601560707 4.126594543457031 
2022-04-25 21:23:50,548 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 21:23:50,548 reid_baseline.train INFO: Accuracy: 13.5% Mean Entropy: 412.7%
2022-04-25 21:24:16,663 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.693, Acc: 0.212, Base Lr: 1.27e-03
2022-04-25 21:24:44,101 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.634, Acc: 0.227, Base Lr: 1.27e-03
2022-04-25 21:24:54,267 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 21:25:49,940 reid_baseline.train INFO: normal accuracy 0.17374340142299746 4.009926795959473 
2022-04-25 21:25:52,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 21:25:52,220 reid_baseline.train INFO: Accuracy: 17.4% Mean Entropy: 401.0%
2022-04-25 21:26:16,273 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.344, Acc: 0.285, Base Lr: 1.66e-03
2022-04-25 21:26:33,304 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.326, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 21:26:48,686 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.207[s] Speed: 77.4[samples/s]
2022-04-25 21:27:45,805 reid_baseline.train INFO: normal accuracy 0.21367913702088592 3.819768190383911 
2022-04-25 21:27:46,793 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 21:27:46,793 reid_baseline.train INFO: Accuracy: 21.4% Mean Entropy: 382.0%
2022-04-25 21:28:10,859 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.103, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 21:28:28,129 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.037, Acc: 0.356, Base Lr: 2.06e-03
2022-04-25 21:28:49,403 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.228[s] Speed: 70.1[samples/s]
2022-04-25 21:29:55,495 reid_baseline.train INFO: normal accuracy 0.2556805141152169 3.654770612716675 
2022-04-25 21:29:56,373 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 21:29:56,374 reid_baseline.train INFO: Accuracy: 25.6% Mean Entropy: 365.5%
2022-04-25 21:30:22,132 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.846, Acc: 0.407, Base Lr: 2.46e-03
2022-04-25 21:30:38,328 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.801, Acc: 0.416, Base Lr: 2.46e-03
2022-04-25 21:30:54,847 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.214[s] Speed: 74.7[samples/s]
2022-04-25 21:31:55,192 reid_baseline.train INFO: normal accuracy 0.3036492999770484 3.432997465133667 
2022-04-25 21:31:56,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 21:31:56,481 reid_baseline.train INFO: Accuracy: 30.4% Mean Entropy: 343.3%
2022-04-25 21:32:21,901 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.586, Acc: 0.487, Base Lr: 2.85e-03
2022-04-25 21:32:39,987 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.575, Acc: 0.477, Base Lr: 2.85e-03
2022-04-25 21:32:58,068 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.225[s] Speed: 71.1[samples/s]
2022-04-25 21:33:59,860 reid_baseline.train INFO: normal accuracy 0.34955244434243743 3.3023295402526855 
2022-04-25 21:34:01,204 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 21:34:01,204 reid_baseline.train INFO: Accuracy: 35.0% Mean Entropy: 330.2%
2022-04-25 21:34:24,330 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.379, Acc: 0.534, Base Lr: 3.25e-03
2022-04-25 21:34:45,244 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.376, Acc: 0.531, Base Lr: 3.25e-03
2022-04-25 21:35:03,186 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.227[s] Speed: 70.6[samples/s]
2022-04-25 21:36:05,064 reid_baseline.train INFO: normal accuracy 0.380766582510902 3.1129746437072754 
2022-04-25 21:36:06,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 21:36:06,001 reid_baseline.train INFO: Accuracy: 38.1% Mean Entropy: 311.3%
2022-04-25 21:36:31,648 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.242, Acc: 0.561, Base Lr: 3.64e-03
2022-04-25 21:36:48,304 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.212, Acc: 0.579, Base Lr: 3.64e-03
2022-04-25 21:37:02,359 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.206[s] Speed: 77.6[samples/s]
2022-04-25 21:37:59,593 reid_baseline.train INFO: normal accuracy 0.39568510442965343 2.9649369716644287 
2022-04-25 21:38:00,739 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 21:38:00,740 reid_baseline.train INFO: Accuracy: 39.6% Mean Entropy: 296.5%
2022-04-25 21:38:24,865 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.072, Acc: 0.619, Base Lr: 4.04e-03
2022-04-25 21:38:45,222 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.076, Acc: 0.615, Base Lr: 4.04e-03
2022-04-25 21:39:01,022 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.220[s] Speed: 72.7[samples/s]
2022-04-25 21:40:06,579 reid_baseline.train INFO: normal accuracy 0.42070231810879044 2.860412359237671 
2022-04-25 21:40:07,425 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 21:40:07,425 reid_baseline.train INFO: Accuracy: 42.1% Mean Entropy: 286.0%
2022-04-25 21:40:33,854 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.966, Acc: 0.641, Base Lr: 4.44e-03
2022-04-25 21:40:52,620 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.945, Acc: 0.645, Base Lr: 4.44e-03
2022-04-25 21:41:08,373 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.223[s] Speed: 71.7[samples/s]
2022-04-25 21:42:13,343 reid_baseline.train INFO: normal accuracy 0.43607987147119576 2.695936441421509 
2022-04-25 21:42:14,349 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 21:42:14,350 reid_baseline.train INFO: Accuracy: 43.6% Mean Entropy: 269.6%
2022-04-25 21:42:39,348 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.800, Acc: 0.695, Base Lr: 4.83e-03
2022-04-25 21:43:00,980 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.818, Acc: 0.692, Base Lr: 4.83e-03
2022-04-25 21:43:15,177 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.222[s] Speed: 71.9[samples/s]
2022-04-25 21:44:15,787 reid_baseline.train INFO: normal accuracy 0.4539820977736975 2.6689841747283936 
2022-04-25 21:44:17,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 21:44:17,137 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 266.9%
2022-04-25 21:44:42,925 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.714, Base Lr: 5.23e-03
2022-04-25 21:45:05,299 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.725, Acc: 0.719, Base Lr: 5.23e-03
2022-04-25 21:45:18,551 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.225[s] Speed: 71.3[samples/s]
2022-04-25 21:46:21,338 reid_baseline.train INFO: normal accuracy 0.46637594675235255 2.5224552154541016 
2022-04-25 21:46:22,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 21:46:22,229 reid_baseline.train INFO: Accuracy: 46.6% Mean Entropy: 252.2%
2022-04-25 21:46:47,663 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.684, Acc: 0.731, Base Lr: 5.62e-03
2022-04-25 21:47:12,327 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.662, Acc: 0.736, Base Lr: 5.62e-03
2022-04-25 21:47:23,289 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.223[s] Speed: 71.7[samples/s]
2022-04-25 21:48:27,780 reid_baseline.train INFO: normal accuracy 0.46890061969244895 2.4639053344726562 
2022-04-25 21:48:28,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 21:48:28,642 reid_baseline.train INFO: Accuracy: 46.9% Mean Entropy: 246.4%
2022-04-25 21:48:54,041 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.544, Acc: 0.781, Base Lr: 6.02e-03
2022-04-25 21:49:16,464 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.565, Acc: 0.768, Base Lr: 6.02e-03
2022-04-25 21:49:28,131 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.218[s] Speed: 73.5[samples/s]
2022-04-25 21:50:30,148 reid_baseline.train INFO: normal accuracy 0.4787697957310076 2.364691972732544 
2022-04-25 21:50:31,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 21:50:31,108 reid_baseline.train INFO: Accuracy: 47.9% Mean Entropy: 236.5%
2022-04-25 21:50:56,912 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.485, Acc: 0.792, Base Lr: 6.42e-03
2022-04-25 21:51:17,125 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.486, Acc: 0.793, Base Lr: 6.42e-03
2022-04-25 21:51:28,507 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.209[s] Speed: 76.4[samples/s]
2022-04-25 21:52:30,564 reid_baseline.train INFO: normal accuracy 0.48175350011475787 2.328552722930908 
2022-04-25 21:52:32,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 21:52:32,509 reid_baseline.train INFO: Accuracy: 48.2% Mean Entropy: 232.9%
2022-04-25 21:52:57,513 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.445, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 21:53:22,828 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.451, Acc: 0.800, Base Lr: 6.81e-03
2022-04-25 21:53:38,020 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-25 21:54:37,684 reid_baseline.train INFO: normal accuracy 0.48634381455129677 2.3434391021728516 
2022-04-25 21:54:37,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 21:54:37,685 reid_baseline.train INFO: Accuracy: 48.6% Mean Entropy: 234.3%
2022-04-25 21:55:04,530 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.367, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 21:55:27,861 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.382, Acc: 0.818, Base Lr: 7.21e-03
2022-04-25 21:55:44,943 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.246[s] Speed: 65.2[samples/s]
2022-04-25 21:56:45,365 reid_baseline.train INFO: normal accuracy 0.48978655037870095 2.284588575363159 
2022-04-25 21:56:47,053 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 21:56:47,053 reid_baseline.train INFO: Accuracy: 49.0% Mean Entropy: 228.5%
2022-04-25 21:57:14,755 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.320, Acc: 0.843, Base Lr: 7.60e-03
2022-04-25 21:57:40,573 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.348, Acc: 0.835, Base Lr: 7.60e-03
2022-04-25 21:57:55,998 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-25 21:58:57,264 reid_baseline.train INFO: normal accuracy 0.4874913931604315 2.3579905033111572 
2022-04-25 21:58:57,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 21:58:57,266 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 235.8%
2022-04-25 21:59:22,857 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.259, Acc: 0.864, Base Lr: 4.01e-03
2022-04-25 21:59:48,210 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.243, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 22:00:03,579 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-25 22:01:02,096 reid_baseline.train INFO: normal accuracy 0.5040165251319716 2.245103120803833 
2022-04-25 22:01:04,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 22:01:04,010 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 224.5%
2022-04-25 22:01:31,512 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.198, Acc: 0.892, Base Lr: 3.69e-03
2022-04-25 22:01:57,210 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.190, Acc: 0.891, Base Lr: 3.69e-03
2022-04-25 22:02:10,979 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.245[s] Speed: 65.3[samples/s]
2022-04-25 22:03:10,080 reid_baseline.train INFO: normal accuracy 0.5012623364700483 2.204038619995117 
2022-04-25 22:03:12,194 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 22:03:12,194 reid_baseline.train INFO: Accuracy: 50.1% Mean Entropy: 220.4%
2022-04-25 22:03:39,099 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.182, Acc: 0.888, Base Lr: 3.38e-03
2022-04-25 22:04:03,926 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.178, Acc: 0.895, Base Lr: 3.38e-03
2022-04-25 22:04:20,472 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.250[s] Speed: 64.1[samples/s]
2022-04-25 22:05:19,422 reid_baseline.train INFO: normal accuracy 0.5047050722974524 2.2281076908111572 
2022-04-25 22:05:19,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 22:05:19,426 reid_baseline.train INFO: Accuracy: 50.5% Mean Entropy: 222.8%
2022-04-25 22:05:45,416 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.159, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 22:06:10,367 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.164, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 22:06:25,657 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-25 22:07:22,100 reid_baseline.train INFO: normal accuracy 0.5136561854487033 2.2123348712921143 
2022-04-25 22:07:22,104 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 22:07:22,104 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 221.2%
2022-04-25 22:07:49,605 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.111, Acc: 0.919, Base Lr: 2.77e-03
2022-04-25 22:08:14,537 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.127, Acc: 0.915, Base Lr: 2.77e-03
2022-04-25 22:08:30,902 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-25 22:09:31,216 reid_baseline.train INFO: normal accuracy 0.5143447326141841 2.150057077407837 
2022-04-25 22:09:33,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 22:09:33,296 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 215.0%
2022-04-25 22:09:58,534 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.123, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 22:10:23,767 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.119, Acc: 0.914, Base Lr: 2.48e-03
2022-04-25 22:10:40,437 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 22:11:39,347 reid_baseline.train INFO: normal accuracy 0.5074592609593758 2.155066967010498 
2022-04-25 22:11:39,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 22:11:39,348 reid_baseline.train INFO: Accuracy: 50.7% Mean Entropy: 215.5%
2022-04-25 22:12:04,765 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.092, Acc: 0.932, Base Lr: 2.20e-03
2022-04-25 22:12:30,669 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.093, Acc: 0.922, Base Lr: 2.20e-03
2022-04-25 22:12:48,584 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-25 22:13:48,213 reid_baseline.train INFO: normal accuracy 0.5175579527197613 2.196807861328125 
2022-04-25 22:13:48,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 22:13:48,218 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 219.7%
2022-04-25 22:14:14,345 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.090, Acc: 0.924, Base Lr: 1.92e-03
2022-04-25 22:14:39,139 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 22:14:58,127 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-25 22:15:57,252 reid_baseline.train INFO: normal accuracy 0.5184760156070691 2.1643593311309814 
2022-04-25 22:15:57,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 22:15:57,255 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 216.4%
2022-04-25 22:16:22,370 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.089, Acc: 0.921, Base Lr: 1.66e-03
2022-04-25 22:16:47,200 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.077, Acc: 0.927, Base Lr: 1.66e-03
2022-04-25 22:17:06,066 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.251[s] Speed: 63.6[samples/s]
2022-04-25 22:18:06,678 reid_baseline.train INFO: normal accuracy 0.5180169841634152 2.169919967651367 
2022-04-25 22:18:06,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 22:18:06,682 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 217.0%
2022-04-25 22:18:32,410 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.057, Acc: 0.936, Base Lr: 1.42e-03
2022-04-25 22:18:57,931 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.058, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 22:19:16,487 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:20:15,280 reid_baseline.train INFO: normal accuracy 0.5221482671563002 2.1790528297424316 
2022-04-25 22:20:15,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 22:20:15,285 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 217.9%
2022-04-25 22:20:39,535 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.060, Acc: 0.936, Base Lr: 1.19e-03
2022-04-25 22:21:05,157 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.050, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 22:21:22,536 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.246[s] Speed: 65.0[samples/s]
2022-04-25 22:22:22,265 reid_baseline.train INFO: normal accuracy 0.5175579527197613 2.196712017059326 
2022-04-25 22:22:22,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 22:22:22,266 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 219.7%
2022-04-25 22:22:43,171 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 22:23:03,930 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.035, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 22:23:23,851 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.225[s] Speed: 71.0[samples/s]
2022-04-25 22:24:24,068 reid_baseline.train INFO: normal accuracy 0.5221482671563002 2.1952643394470215 
2022-04-25 22:24:24,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 22:24:24,073 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 219.5%
2022-04-25 22:24:50,220 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.043, Acc: 0.943, Base Lr: 7.78e-04
2022-04-25 22:25:14,650 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.043, Acc: 0.941, Base Lr: 7.78e-04
2022-04-25 22:25:33,622 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.255[s] Speed: 62.9[samples/s]
2022-04-25 22:26:33,360 reid_baseline.train INFO: normal accuracy 0.5170989212761075 2.203770160675049 
2022-04-25 22:26:33,363 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 22:26:33,363 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 220.4%
2022-04-25 22:27:00,164 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.025, Acc: 0.951, Base Lr: 6.04e-04
2022-04-25 22:27:23,839 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.026, Acc: 0.949, Base Lr: 6.04e-04
2022-04-25 22:27:43,410 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-25 22:28:45,972 reid_baseline.train INFO: normal accuracy 0.5184760156070691 2.1890218257904053 
2022-04-25 22:28:45,974 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 22:28:45,975 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 218.9%
2022-04-25 22:29:12,255 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.022, Acc: 0.950, Base Lr: 4.51e-04
2022-04-25 22:29:37,349 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.021, Acc: 0.952, Base Lr: 4.51e-04
2022-04-25 22:29:55,838 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.256[s] Speed: 62.6[samples/s]
2022-04-25 22:30:55,626 reid_baseline.train INFO: normal accuracy 0.5187055313288961 2.1878738403320312 
2022-04-25 22:30:55,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 22:30:55,630 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 218.8%
2022-04-25 22:31:20,063 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.039, Acc: 0.936, Base Lr: 3.20e-04
2022-04-25 22:31:45,236 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.034, Acc: 0.940, Base Lr: 3.20e-04
2022-04-25 22:32:01,872 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-25 22:33:04,527 reid_baseline.train INFO: normal accuracy 0.5161808583887997 2.1649348735809326 
2022-04-25 22:33:04,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 22:33:04,527 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 216.5%
2022-04-25 22:33:32,099 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.010, Acc: 0.949, Base Lr: 2.11e-04
2022-04-25 22:33:56,428 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.023, Acc: 0.948, Base Lr: 2.11e-04
2022-04-25 22:34:15,004 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.258[s] Speed: 62.1[samples/s]
2022-04-25 22:35:16,918 reid_baseline.train INFO: normal accuracy 0.5184760156070691 2.174525260925293 
2022-04-25 22:35:16,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 22:35:16,921 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 217.5%
2022-04-25 22:35:43,904 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.038, Acc: 0.942, Base Lr: 1.26e-04
2022-04-25 22:36:09,292 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.028, Acc: 0.947, Base Lr: 1.26e-04
2022-04-25 22:36:26,608 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.254[s] Speed: 62.9[samples/s]
2022-04-25 22:37:24,538 reid_baseline.train INFO: normal accuracy 0.5239843929309158 2.142791986465454 
2022-04-25 22:37:25,463 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 22:37:25,463 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 214.3%
2022-04-25 22:37:49,839 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.025, Acc: 0.944, Base Lr: 6.51e-05
2022-04-25 22:38:10,155 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 6.51e-05
2022-04-25 22:38:23,798 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.213[s] Speed: 75.3[samples/s]
2022-04-25 22:39:24,760 reid_baseline.train INFO: normal accuracy 0.5177874684415883 2.1708178520202637 
2022-04-25 22:39:24,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 22:39:24,762 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 217.1%
2022-04-25 22:39:52,223 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.004, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 22:40:16,237 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.017, Acc: 0.947, Base Lr: 2.83e-05
2022-04-25 22:40:33,038 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.249[s] Speed: 64.2[samples/s]
2022-04-25 22:41:32,388 reid_baseline.train INFO: normal accuracy 0.5138857011705302 2.165276288986206 
2022-04-25 22:41:32,390 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 22:41:32,391 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 216.5%
2022-04-25 22:42:00,229 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.035, Acc: 0.931, Base Lr: 1.60e-05
2022-04-25 22:42:24,700 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.939, Base Lr: 1.60e-05
2022-04-25 22:42:40,615 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.250[s] Speed: 64.1[samples/s]
2022-04-25 22:43:38,331 reid_baseline.train INFO: normal accuracy 0.5164103741106266 2.1533241271972656 
2022-04-25 22:43:38,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 22:43:38,331 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 215.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 22:44:38,268 reid_baseline.train INFO: normal accuracy 0.5239843929309158 2.142791986465454 
2022-04-25 22:44:38,268 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:44:38,268 reid_baseline.train INFO: Accuracy: 52.4%
2022-04-25 22:45:40,089 reid_baseline.train INFO: normal accuracy 0.5239843929309158 2.142791986465454 
2022-04-25 22:45:40,089 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:45:40,089 reid_baseline.train INFO: Shuffled Accuracy: 52.4%
2022-04-25 22:46:31,677 reid_baseline.train INFO: normal accuracy 0.929667812142039 1.0774507522583008 
2022-04-25 22:46:31,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:46:31,677 reid_baseline.train INFO: Source Clean Accuracy: 93.0%
2022-04-25 22:46:37,014 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_2
2022-04-25 22:46:37,014 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-25 22:46:37,014 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 22:46:37,015 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 22:46:37,015 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 22:46:49,411 reid_baseline.train INFO: start training
2022-04-25 22:47:17,077 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.091, Base Lr: 4.76e-04
2022-04-25 22:47:41,815 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.127, Base Lr: 4.76e-04
2022-04-25 22:47:59,251 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:48:29,881 reid_baseline.train INFO: normal accuracy 0.09765142150803462 4.168731689453125 
2022-04-25 22:48:30,711 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 22:48:30,711 reid_baseline.train INFO: Accuracy: 9.8% Mean Entropy: 416.9%
2022-04-25 22:48:52,940 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.962, Acc: 0.220, Base Lr: 8.72e-04
2022-04-25 22:49:19,267 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.909, Acc: 0.216, Base Lr: 8.72e-04
2022-04-25 22:49:39,322 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-25 22:50:06,179 reid_baseline.train INFO: normal accuracy 0.09559126493613515 4.130186557769775 
2022-04-25 22:50:07,036 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 22:50:07,036 reid_baseline.train INFO: Accuracy: 9.6% Mean Entropy: 413.0%
2022-04-25 22:50:35,351 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.682, Acc: 0.220, Base Lr: 1.27e-03
2022-04-25 22:50:56,293 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.623, Acc: 0.230, Base Lr: 1.27e-03
2022-04-25 22:51:16,676 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:51:47,454 reid_baseline.train INFO: normal accuracy 0.12566955088586731 4.022171497344971 
2022-04-25 22:51:49,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 22:51:49,434 reid_baseline.train INFO: Accuracy: 12.6% Mean Entropy: 402.2%
2022-04-25 22:52:18,294 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.324, Acc: 0.295, Base Lr: 1.66e-03
2022-04-25 22:52:34,006 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.308, Acc: 0.291, Base Lr: 1.66e-03
2022-04-25 22:52:45,685 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.206[s] Speed: 77.7[samples/s]
2022-04-25 22:53:14,159 reid_baseline.train INFO: normal accuracy 0.15327564894932014 3.8600871562957764 
2022-04-25 22:53:15,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 22:53:15,213 reid_baseline.train INFO: Accuracy: 15.3% Mean Entropy: 386.0%
2022-04-25 22:53:36,724 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.087, Acc: 0.333, Base Lr: 2.06e-03
2022-04-25 22:53:54,899 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.021, Acc: 0.361, Base Lr: 2.06e-03
2022-04-25 22:54:09,952 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.200[s] Speed: 79.9[samples/s]
2022-04-25 22:54:40,259 reid_baseline.train INFO: normal accuracy 0.17840955912649362 3.7060396671295166 
2022-04-25 22:54:41,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 22:54:41,305 reid_baseline.train INFO: Accuracy: 17.8% Mean Entropy: 370.6%
2022-04-25 22:55:08,483 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.831, Acc: 0.404, Base Lr: 2.46e-03
2022-04-25 22:55:31,253 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.792, Acc: 0.407, Base Lr: 2.46e-03
2022-04-25 22:55:51,188 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:56:23,973 reid_baseline.train INFO: normal accuracy 0.2146683147919242 3.578143358230591 
2022-04-25 22:56:24,779 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 22:56:24,779 reid_baseline.train INFO: Accuracy: 21.5% Mean Entropy: 357.8%
2022-04-25 22:56:51,058 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.573, Acc: 0.472, Base Lr: 2.85e-03
2022-04-25 22:57:14,271 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.560, Acc: 0.478, Base Lr: 2.85e-03
2022-04-25 22:57:32,583 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.248[s] Speed: 64.4[samples/s]
2022-04-25 22:58:04,231 reid_baseline.train INFO: normal accuracy 0.23939019365471775 3.44665265083313 
2022-04-25 22:58:05,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 22:58:05,020 reid_baseline.train INFO: Accuracy: 23.9% Mean Entropy: 344.7%
2022-04-25 22:58:29,523 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.371, Acc: 0.534, Base Lr: 3.25e-03
2022-04-25 22:58:51,114 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.368, Acc: 0.528, Base Lr: 3.25e-03
2022-04-25 22:59:11,353 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-25 22:59:44,034 reid_baseline.train INFO: normal accuracy 0.2591676967449526 3.3529438972473145 
2022-04-25 22:59:44,834 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 22:59:44,834 reid_baseline.train INFO: Accuracy: 25.9% Mean Entropy: 335.3%
2022-04-25 23:00:12,057 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.228, Acc: 0.567, Base Lr: 3.64e-03
2022-04-25 23:00:33,145 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.201, Acc: 0.584, Base Lr: 3.64e-03
2022-04-25 23:00:52,115 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 23:01:22,639 reid_baseline.train INFO: normal accuracy 0.28100535640708696 3.194368600845337 
2022-04-25 23:01:23,612 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 23:01:23,612 reid_baseline.train INFO: Accuracy: 28.1% Mean Entropy: 319.4%
2022-04-25 23:01:50,075 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.073, Acc: 0.607, Base Lr: 4.04e-03
2022-04-25 23:02:13,618 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.068, Acc: 0.615, Base Lr: 4.04e-03
2022-04-25 23:02:32,540 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.252[s] Speed: 63.5[samples/s]
2022-04-25 23:03:01,542 reid_baseline.train INFO: normal accuracy 0.288421920065925 3.091840982437134 
2022-04-25 23:03:02,344 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 23:03:02,344 reid_baseline.train INFO: Accuracy: 28.8% Mean Entropy: 309.2%
2022-04-25 23:03:29,635 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.936, Acc: 0.650, Base Lr: 4.44e-03
2022-04-25 23:03:53,632 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.925, Acc: 0.652, Base Lr: 4.44e-03
2022-04-25 23:04:11,463 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.253[s] Speed: 63.4[samples/s]
2022-04-25 23:04:43,260 reid_baseline.train INFO: normal accuracy 0.29831067161104247 3.006307363510132 
2022-04-25 23:04:44,174 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 23:04:44,175 reid_baseline.train INFO: Accuracy: 29.8% Mean Entropy: 300.6%
2022-04-25 23:05:09,859 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.782, Acc: 0.694, Base Lr: 4.83e-03
2022-04-25 23:05:33,847 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.804, Acc: 0.694, Base Lr: 4.83e-03
2022-04-25 23:05:53,393 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-25 23:06:24,051 reid_baseline.train INFO: normal accuracy 0.30325504738360115 2.933382987976074 
2022-04-25 23:06:24,936 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 23:06:24,936 reid_baseline.train INFO: Accuracy: 30.3% Mean Entropy: 293.3%
2022-04-25 23:06:50,941 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.752, Acc: 0.714, Base Lr: 5.23e-03
2022-04-25 23:07:15,437 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.714, Acc: 0.719, Base Lr: 5.23e-03
2022-04-25 23:07:29,451 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.236[s] Speed: 67.7[samples/s]
2022-04-25 23:07:56,963 reid_baseline.train INFO: normal accuracy 0.3156159868149979 2.810831308364868 
2022-04-25 23:07:57,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 23:07:57,777 reid_baseline.train INFO: Accuracy: 31.6% Mean Entropy: 281.1%
2022-04-25 23:08:17,756 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.687, Acc: 0.737, Base Lr: 5.62e-03
2022-04-25 23:08:46,681 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.652, Acc: 0.745, Base Lr: 5.62e-03
2022-04-25 23:09:04,468 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.244[s] Speed: 65.5[samples/s]
2022-04-25 23:09:36,513 reid_baseline.train INFO: normal accuracy 0.3180881747012773 2.70317006111145 
2022-04-25 23:09:37,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 23:09:37,404 reid_baseline.train INFO: Accuracy: 31.8% Mean Entropy: 270.3%
2022-04-25 23:09:59,415 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.534, Acc: 0.781, Base Lr: 6.02e-03
2022-04-25 23:10:27,174 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.557, Acc: 0.764, Base Lr: 6.02e-03
2022-04-25 23:10:45,139 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 23:11:16,198 reid_baseline.train INFO: normal accuracy 0.3234445817882159 2.701241970062256 
2022-04-25 23:11:16,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 23:11:16,988 reid_baseline.train INFO: Accuracy: 32.3% Mean Entropy: 270.1%
2022-04-25 23:11:40,700 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.475, Acc: 0.803, Base Lr: 6.42e-03
2022-04-25 23:12:08,630 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.473, Acc: 0.801, Base Lr: 6.42e-03
2022-04-25 23:12:27,134 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.256[s] Speed: 62.6[samples/s]
2022-04-25 23:12:56,956 reid_baseline.train INFO: normal accuracy 0.33127317676143386 2.654641628265381 
2022-04-25 23:12:58,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 23:12:58,018 reid_baseline.train INFO: Accuracy: 33.1% Mean Entropy: 265.5%
2022-04-25 23:13:22,578 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.430, Acc: 0.814, Base Lr: 6.81e-03
2022-04-25 23:13:48,820 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.441, Acc: 0.808, Base Lr: 6.81e-03
2022-04-25 23:14:07,932 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-25 23:14:39,435 reid_baseline.train INFO: normal accuracy 0.32468067573135556 2.6354129314422607 
2022-04-25 23:14:40,613 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 23:14:40,613 reid_baseline.train INFO: Accuracy: 32.5% Mean Entropy: 263.5%
2022-04-25 23:15:03,064 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.360, Acc: 0.822, Base Lr: 7.21e-03
2022-04-25 23:15:27,595 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.377, Acc: 0.824, Base Lr: 7.21e-03
2022-04-25 23:15:44,825 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.234[s] Speed: 68.4[samples/s]
2022-04-25 23:16:15,756 reid_baseline.train INFO: normal accuracy 0.334569427276473 2.597466230392456 
2022-04-25 23:16:16,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 23:16:16,553 reid_baseline.train INFO: Accuracy: 33.5% Mean Entropy: 259.7%
2022-04-25 23:16:38,861 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.321, Acc: 0.843, Base Lr: 7.60e-03
2022-04-25 23:17:06,472 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.340, Acc: 0.835, Base Lr: 7.60e-03
2022-04-25 23:17:22,337 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.241[s] Speed: 66.4[samples/s]
2022-04-25 23:17:55,278 reid_baseline.train INFO: normal accuracy 0.32838895756077463 2.5787763595581055 
2022-04-25 23:17:56,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 23:17:56,119 reid_baseline.train INFO: Accuracy: 32.8% Mean Entropy: 257.9%
2022-04-25 23:18:19,211 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.251, Acc: 0.864, Base Lr: 4.01e-03
2022-04-25 23:18:46,034 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.243, Acc: 0.871, Base Lr: 4.01e-03
2022-04-25 23:19:03,916 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.248[s] Speed: 64.6[samples/s]
2022-04-25 23:19:34,495 reid_baseline.train INFO: normal accuracy 0.3395138030490317 2.5886025428771973 
2022-04-25 23:19:34,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 23:19:34,500 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 258.9%
2022-04-25 23:19:57,357 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.191, Acc: 0.897, Base Lr: 3.69e-03
2022-04-25 23:20:26,481 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.182, Acc: 0.895, Base Lr: 3.69e-03
2022-04-25 23:20:44,155 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 23:21:16,373 reid_baseline.train INFO: normal accuracy 0.34198599093531107 2.572239637374878 
2022-04-25 23:21:17,291 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 23:21:17,292 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 257.2%
2022-04-25 23:21:36,084 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.169, Acc: 0.898, Base Lr: 3.38e-03
2022-04-25 23:21:58,668 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.173, Acc: 0.900, Base Lr: 3.38e-03
2022-04-25 23:22:13,014 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-25 23:22:44,830 reid_baseline.train INFO: normal accuracy 0.3292130201895344 2.5663256645202637 
2022-04-25 23:22:45,663 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 23:22:45,663 reid_baseline.train INFO: Accuracy: 32.9% Mean Entropy: 256.6%
2022-04-25 23:23:08,511 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.168, Acc: 0.902, Base Lr: 3.08e-03
2022-04-25 23:23:35,756 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.161, Acc: 0.903, Base Lr: 3.08e-03
2022-04-25 23:23:54,132 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-25 23:24:23,961 reid_baseline.train INFO: normal accuracy 0.3304491141326741 2.5150933265686035 
2022-04-25 23:24:25,011 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 23:24:25,012 reid_baseline.train INFO: Accuracy: 33.0% Mean Entropy: 251.5%
2022-04-25 23:24:47,765 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.110, Acc: 0.921, Base Lr: 2.77e-03
2022-04-25 23:25:14,988 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.122, Acc: 0.919, Base Lr: 2.77e-03
2022-04-25 23:25:33,468 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 23:26:05,475 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.4800281524658203 
2022-04-25 23:26:06,268 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 23:26:06,268 reid_baseline.train INFO: Accuracy: 33.8% Mean Entropy: 248.0%
2022-04-25 23:26:29,861 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.131, Acc: 0.919, Base Lr: 2.48e-03
2022-04-25 23:26:56,374 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.123, Acc: 0.916, Base Lr: 2.48e-03
2022-04-25 23:27:13,629 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.246[s] Speed: 65.0[samples/s]
2022-04-25 23:27:45,878 reid_baseline.train INFO: normal accuracy 0.3333333333333333 2.4888193607330322 
2022-04-25 23:27:45,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 23:27:45,879 reid_baseline.train INFO: Accuracy: 33.3% Mean Entropy: 248.9%
2022-04-25 23:28:10,891 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.079, Acc: 0.932, Base Lr: 2.20e-03
2022-04-25 23:28:36,356 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.086, Acc: 0.928, Base Lr: 2.20e-03
2022-04-25 23:28:54,980 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-25 23:29:26,364 reid_baseline.train INFO: normal accuracy 0.3415739596209312 2.518031597137451 
2022-04-25 23:29:26,366 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 23:29:26,367 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 251.8%
2022-04-25 23:29:47,729 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.078, Acc: 0.934, Base Lr: 1.92e-03
2022-04-25 23:30:13,591 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.078, Acc: 0.930, Base Lr: 1.92e-03
2022-04-25 23:30:33,439 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 23:31:05,589 reid_baseline.train INFO: normal accuracy 0.3358055212196127 2.517660140991211 
2022-04-25 23:31:05,591 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 23:31:05,591 reid_baseline.train INFO: Accuracy: 33.6% Mean Entropy: 251.8%
2022-04-25 23:31:29,340 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.085, Acc: 0.924, Base Lr: 1.66e-03
2022-04-25 23:31:52,842 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.070, Acc: 0.931, Base Lr: 1.66e-03
2022-04-25 23:32:11,073 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.239[s] Speed: 66.9[samples/s]
2022-04-25 23:32:41,877 reid_baseline.train INFO: normal accuracy 0.3366295838483725 2.5214779376983643 
2022-04-25 23:32:41,878 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 23:32:41,878 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 252.1%
2022-04-25 23:33:04,953 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.057, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 23:33:30,640 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.057, Acc: 0.936, Base Lr: 1.42e-03
2022-04-25 23:33:47,915 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 23:34:17,809 reid_baseline.train INFO: normal accuracy 0.3411619283065513 2.5034737586975098 
2022-04-25 23:34:17,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 23:34:17,812 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 250.3%
2022-04-25 23:34:40,977 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.066, Acc: 0.936, Base Lr: 1.19e-03
2022-04-25 23:35:05,399 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.056, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 23:35:23,213 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-25 23:35:55,707 reid_baseline.train INFO: normal accuracy 0.3362175525339926 2.518782615661621 
2022-04-25 23:35:55,709 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 23:35:55,709 reid_baseline.train INFO: Accuracy: 33.6% Mean Entropy: 251.9%
2022-04-25 23:36:18,417 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.043, Acc: 0.938, Base Lr: 9.72e-04
2022-04-25 23:36:39,401 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.034, Acc: 0.941, Base Lr: 9.72e-04
2022-04-25 23:36:54,505 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.215[s] Speed: 74.3[samples/s]
2022-04-25 23:37:22,105 reid_baseline.train INFO: normal accuracy 0.3333333333333333 2.518561840057373 
2022-04-25 23:37:22,110 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 23:37:22,110 reid_baseline.train INFO: Accuracy: 33.3% Mean Entropy: 251.9%
2022-04-25 23:37:45,811 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.039, Acc: 0.945, Base Lr: 7.78e-04
2022-04-25 23:38:09,067 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.041, Acc: 0.942, Base Lr: 7.78e-04
2022-04-25 23:38:27,449 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 23:38:58,591 reid_baseline.train INFO: normal accuracy 0.34239802224969096 2.5127785205841064 
2022-04-25 23:38:58,595 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 23:38:58,596 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 251.3%
2022-04-25 23:39:21,728 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.022, Acc: 0.953, Base Lr: 6.04e-04
2022-04-25 23:39:47,687 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.026, Acc: 0.949, Base Lr: 6.04e-04
2022-04-25 23:40:05,494 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.245[s] Speed: 65.3[samples/s]
2022-04-25 23:40:35,855 reid_baseline.train INFO: normal accuracy 0.3374536464771323 2.5153164863586426 
2022-04-25 23:40:35,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 23:40:35,855 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 251.5%
2022-04-25 23:40:58,517 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.020, Acc: 0.951, Base Lr: 4.51e-04
2022-04-25 23:41:24,132 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.018, Acc: 0.950, Base Lr: 4.51e-04
2022-04-25 23:41:41,928 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-25 23:42:12,035 reid_baseline.train INFO: normal accuracy 0.3399258343634116 2.53421688079834 
2022-04-25 23:42:12,037 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 23:42:12,038 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 253.4%
2022-04-25 23:42:37,779 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.030, Acc: 0.938, Base Lr: 3.20e-04
2022-04-25 23:43:01,586 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.027, Acc: 0.940, Base Lr: 3.20e-04
2022-04-25 23:43:18,950 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.245[s] Speed: 65.3[samples/s]
2022-04-25 23:43:48,944 reid_baseline.train INFO: normal accuracy 0.34239802224969096 2.5240871906280518 
2022-04-25 23:43:48,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 23:43:48,945 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 252.4%
2022-04-25 23:44:15,832 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.020, Acc: 0.952, Base Lr: 2.11e-04
2022-04-25 23:44:38,992 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.025, Acc: 0.951, Base Lr: 2.11e-04
2022-04-25 23:44:56,251 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.247[s] Speed: 64.9[samples/s]
2022-04-25 23:45:25,552 reid_baseline.train INFO: normal accuracy 0.3374536464771323 2.512347936630249 
2022-04-25 23:45:25,553 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 23:45:25,553 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 251.2%
2022-04-25 23:45:56,351 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.033, Acc: 0.939, Base Lr: 1.26e-04
2022-04-25 23:46:20,474 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.023, Acc: 0.946, Base Lr: 1.26e-04
2022-04-25 23:46:38,880 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.269[s] Speed: 59.6[samples/s]
2022-04-25 23:47:11,431 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.495170831680298 
2022-04-25 23:47:11,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 23:47:11,434 reid_baseline.train INFO: Accuracy: 33.8% Mean Entropy: 249.5%
2022-04-25 23:47:41,945 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.019, Acc: 0.948, Base Lr: 6.51e-05
2022-04-25 23:48:10,622 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.018, Acc: 0.948, Base Lr: 6.51e-05
2022-04-25 23:48:31,462 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.293[s] Speed: 54.6[samples/s]
2022-04-25 23:49:00,453 reid_baseline.train INFO: normal accuracy 0.3395138030490317 2.5183603763580322 
2022-04-25 23:49:00,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 23:49:00,466 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 251.8%
2022-04-25 23:49:31,466 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.014, Acc: 0.946, Base Lr: 2.83e-05
2022-04-25 23:49:59,353 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.014, Acc: 0.947, Base Lr: 2.83e-05
2022-04-25 23:50:20,640 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.294[s] Speed: 54.5[samples/s]
2022-04-25 23:50:49,613 reid_baseline.train INFO: normal accuracy 0.33868974042027195 2.486721992492676 
2022-04-25 23:50:49,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 23:50:49,630 reid_baseline.train INFO: Accuracy: 33.9% Mean Entropy: 248.7%
2022-04-25 23:51:20,096 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.025, Acc: 0.947, Base Lr: 1.60e-05
2022-04-25 23:51:46,298 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.016, Acc: 0.946, Base Lr: 1.60e-05
2022-04-25 23:52:07,647 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-25 23:52:36,812 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.4930543899536133 
2022-04-25 23:52:36,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 23:52:36,812 reid_baseline.train INFO: Accuracy: 33.8% Mean Entropy: 249.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_2/transformer_best_model.pth
2022-04-25 23:53:11,620 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.4800281524658203 
2022-04-25 23:53:11,621 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:53:11,621 reid_baseline.train INFO: Accuracy: 33.8%
2022-04-25 23:53:42,880 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.4800281524658203 
2022-04-25 23:53:42,881 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:53:42,881 reid_baseline.train INFO: Shuffled Accuracy: 33.8%
2022-04-25 23:54:36,374 reid_baseline.train INFO: normal accuracy 0.8893470790378006 1.2886340618133545 
2022-04-25 23:54:36,375 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:54:36,376 reid_baseline.train INFO: Source Clean Accuracy: 88.9%
2022-04-25 23:54:43,394 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_2
2022-04-25 23:54:43,394 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-25 23:54:43,395 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 23:54:43,395 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 23:54:43,395 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 23:55:08,724 reid_baseline.train INFO: start training
2022-04-25 23:55:39,748 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.091, Base Lr: 4.76e-04
2022-04-25 23:56:04,553 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.127, Base Lr: 4.76e-04
2022-04-25 23:56:25,976 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.282[s] Speed: 56.8[samples/s]
2022-04-25 23:57:19,416 reid_baseline.train INFO: normal accuracy 0.10587970263572877 4.169342994689941 
2022-04-25 23:57:20,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 23:57:20,821 reid_baseline.train INFO: Accuracy: 10.6% Mean Entropy: 416.9%
2022-04-25 23:57:50,484 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.962, Acc: 0.220, Base Lr: 8.72e-04
2022-04-25 23:58:16,566 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.909, Acc: 0.216, Base Lr: 8.72e-04
2022-04-25 23:58:33,073 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.265[s] Speed: 60.5[samples/s]
2022-04-25 23:59:26,144 reid_baseline.train INFO: normal accuracy 0.10723135841405722 4.133110046386719 
2022-04-25 23:59:28,156 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 23:59:28,157 reid_baseline.train INFO: Accuracy: 10.7% Mean Entropy: 413.3%
2022-04-25 23:59:57,492 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.682, Acc: 0.220, Base Lr: 1.27e-03
2022-04-26 00:00:26,745 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.623, Acc: 0.230, Base Lr: 1.27e-03
2022-04-26 00:00:37,664 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.254[s] Speed: 62.9[samples/s]
2022-04-26 00:01:09,982 reid_baseline.train INFO: normal accuracy 0.14823158369002026 4.024856090545654 
2022-04-26 00:01:11,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:01:11,411 reid_baseline.train INFO: Accuracy: 14.8% Mean Entropy: 402.5%
2022-04-26 00:01:33,513 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.324, Acc: 0.295, Base Lr: 1.66e-03
2022-04-26 00:01:59,274 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.308, Acc: 0.291, Base Lr: 1.66e-03
2022-04-26 00:02:18,952 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-26 00:03:03,072 reid_baseline.train INFO: normal accuracy 0.1822482541112863 3.866863489151001 
2022-04-26 00:03:05,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:03:05,238 reid_baseline.train INFO: Accuracy: 18.2% Mean Entropy: 386.7%
2022-04-26 00:03:32,623 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.087, Acc: 0.333, Base Lr: 2.06e-03
2022-04-26 00:03:54,599 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.021, Acc: 0.361, Base Lr: 2.06e-03
2022-04-26 00:04:16,009 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.259[s] Speed: 61.7[samples/s]
2022-04-26 00:05:12,824 reid_baseline.train INFO: normal accuracy 0.24082000450551927 3.732276201248169 
2022-04-26 00:05:14,159 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 00:05:14,159 reid_baseline.train INFO: Accuracy: 24.1% Mean Entropy: 373.2%
2022-04-26 00:05:44,696 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.831, Acc: 0.404, Base Lr: 2.46e-03
2022-04-26 00:06:09,827 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.792, Acc: 0.407, Base Lr: 2.46e-03
2022-04-26 00:06:28,189 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.271[s] Speed: 59.0[samples/s]
2022-04-26 00:07:23,178 reid_baseline.train INFO: normal accuracy 0.30502365397612075 3.5055296421051025 
2022-04-26 00:07:24,413 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 00:07:24,414 reid_baseline.train INFO: Accuracy: 30.5% Mean Entropy: 350.6%
2022-04-26 00:07:52,607 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.573, Acc: 0.472, Base Lr: 2.85e-03
2022-04-26 00:08:16,699 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.560, Acc: 0.478, Base Lr: 2.85e-03
2022-04-26 00:08:34,790 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.258[s] Speed: 62.1[samples/s]
2022-04-26 00:09:28,898 reid_baseline.train INFO: normal accuracy 0.3401667042126605 3.3472225666046143 
2022-04-26 00:09:30,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 00:09:30,886 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 334.7%
2022-04-26 00:09:58,265 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.371, Acc: 0.534, Base Lr: 3.25e-03
2022-04-26 00:10:26,386 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.368, Acc: 0.528, Base Lr: 3.25e-03
2022-04-26 00:10:42,946 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-04-26 00:11:04,181 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_2
2022-04-26 00:11:04,181 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-26 00:11:04,182 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:11:04,182 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:11:04,182 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:11:22,772 reid_baseline.train INFO: start training
2022-04-26 00:11:50,206 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.091, Base Lr: 4.76e-04
2022-04-26 00:12:15,498 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.127, Base Lr: 4.76e-04
2022-04-26 00:12:35,919 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.267[s] Speed: 60.0[samples/s]
2022-04-26 00:13:56,307 reid_baseline.train INFO: normal accuracy 0.12967638283222402 4.168622970581055 
2022-04-26 00:13:57,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:13:57,501 reid_baseline.train INFO: Accuracy: 13.0% Mean Entropy: 416.9%
2022-04-26 00:14:26,691 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.962, Acc: 0.220, Base Lr: 8.72e-04
2022-04-26 00:14:54,296 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.909, Acc: 0.216, Base Lr: 8.72e-04
2022-04-26 00:15:10,699 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-04-26 00:15:39,045 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_3
2022-04-26 00:15:39,045 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 00:15:39,045 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:15:39,045 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:15:39,046 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:15:53,952 reid_baseline.train INFO: start training
2022-04-26 00:16:22,871 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.092, Base Lr: 4.76e-04
2022-04-26 00:16:48,138 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.127, Base Lr: 4.76e-04
2022-04-26 00:17:09,187 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.274[s] Speed: 58.4[samples/s]
2022-04-26 00:17:42,786 reid_baseline.train INFO: normal accuracy 0.09353110836423568 4.1685261726379395 
2022-04-26 00:17:43,793 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:17:43,793 reid_baseline.train INFO: Accuracy: 9.4% Mean Entropy: 416.9%
2022-04-26 00:18:11,483 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.963, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 00:18:35,754 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.910, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 00:18:58,202 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.273[s] Speed: 58.7[samples/s]
2022-04-26 00:19:35,743 reid_baseline.train INFO: normal accuracy 0.0980634528224145 4.128268241882324 
2022-04-26 00:19:37,189 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 00:19:37,190 reid_baseline.train INFO: Accuracy: 9.8% Mean Entropy: 412.8%
2022-04-26 00:20:06,646 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.686, Acc: 0.221, Base Lr: 1.27e-03
2022-04-26 00:20:32,093 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.629, Acc: 0.233, Base Lr: 1.27e-03
2022-04-26 00:20:54,289 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.282[s] Speed: 56.7[samples/s]
2022-04-26 00:21:25,558 reid_baseline.train INFO: normal accuracy 0.12237330037082818 4.014621257781982 
2022-04-26 00:21:26,774 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:21:26,774 reid_baseline.train INFO: Accuracy: 12.2% Mean Entropy: 401.5%
2022-04-26 00:21:54,412 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.339, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 00:22:17,402 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.322, Acc: 0.282, Base Lr: 1.66e-03
2022-04-26 00:22:38,886 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.264[s] Speed: 60.6[samples/s]
2022-04-26 00:23:15,805 reid_baseline.train INFO: normal accuracy 0.15327564894932014 3.865734815597534 
2022-04-26 00:23:17,066 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:23:17,067 reid_baseline.train INFO: Accuracy: 15.3% Mean Entropy: 386.6%
2022-04-26 00:23:44,758 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.107, Acc: 0.324, Base Lr: 2.06e-03
2022-04-26 00:24:07,502 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.045, Acc: 0.352, Base Lr: 2.06e-03
2022-04-26 00:24:30,342 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.268[s] Speed: 59.8[samples/s]
2022-04-26 00:25:06,056 reid_baseline.train INFO: normal accuracy 0.18088174701277296 3.7115859985351562 
2022-04-26 00:25:07,173 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 00:25:07,174 reid_baseline.train INFO: Accuracy: 18.1% Mean Entropy: 371.2%
2022-04-26 00:25:35,467 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.862, Acc: 0.401, Base Lr: 2.46e-03
2022-04-26 00:25:59,800 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.816, Acc: 0.407, Base Lr: 2.46e-03
2022-04-26 00:26:21,863 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.274[s] Speed: 58.5[samples/s]
2022-04-26 00:26:56,827 reid_baseline.train INFO: normal accuracy 0.2126081582200247 3.565807819366455 
2022-04-26 00:26:58,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 00:26:58,061 reid_baseline.train INFO: Accuracy: 21.3% Mean Entropy: 356.6%
2022-04-26 00:27:26,354 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.598, Acc: 0.476, Base Lr: 2.85e-03
2022-04-26 00:27:53,983 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.593, Acc: 0.473, Base Lr: 2.85e-03
2022-04-26 00:28:16,115 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-26 00:28:52,277 reid_baseline.train INFO: normal accuracy 0.23897816234033786 3.467885971069336 
2022-04-26 00:28:53,357 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 00:28:53,357 reid_baseline.train INFO: Accuracy: 23.9% Mean Entropy: 346.8%
2022-04-26 00:29:22,072 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.404, Acc: 0.523, Base Lr: 3.25e-03
2022-04-26 00:29:48,598 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.399, Acc: 0.527, Base Lr: 3.25e-03
2022-04-26 00:30:09,471 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-26 00:30:41,773 reid_baseline.train INFO: normal accuracy 0.24927894519983518 3.3411684036254883 
2022-04-26 00:30:42,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 00:30:42,907 reid_baseline.train INFO: Accuracy: 24.9% Mean Entropy: 334.1%
2022-04-26 00:31:12,026 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.256, Acc: 0.562, Base Lr: 3.64e-03
2022-04-26 00:31:36,625 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.219, Acc: 0.577, Base Lr: 3.64e-03
2022-04-26 00:31:59,158 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-26 00:32:33,044 reid_baseline.train INFO: normal accuracy 0.276885043263288 3.190669298171997 
2022-04-26 00:32:34,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 00:32:34,819 reid_baseline.train INFO: Accuracy: 27.7% Mean Entropy: 319.1%
2022-04-26 00:33:02,932 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.091, Acc: 0.613, Base Lr: 4.04e-03
2022-04-26 00:33:27,848 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.086, Acc: 0.612, Base Lr: 4.04e-03
2022-04-26 00:33:51,414 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-26 00:34:24,062 reid_baseline.train INFO: normal accuracy 0.2843016069221261 3.0953474044799805 
2022-04-26 00:34:25,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 00:34:25,281 reid_baseline.train INFO: Accuracy: 28.4% Mean Entropy: 309.5%
2022-04-26 00:34:55,035 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.953, Acc: 0.647, Base Lr: 4.44e-03
2022-04-26 00:35:22,988 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.952, Acc: 0.641, Base Lr: 4.44e-03
2022-04-26 00:35:45,570 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.293[s] Speed: 54.5[samples/s]
2022-04-26 00:36:20,240 reid_baseline.train INFO: normal accuracy 0.30243098475484137 2.9826948642730713 
2022-04-26 00:36:21,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 00:36:21,573 reid_baseline.train INFO: Accuracy: 30.2% Mean Entropy: 298.3%
2022-04-26 00:36:49,475 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.816, Acc: 0.690, Base Lr: 4.83e-03
2022-04-26 00:37:14,643 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.839, Acc: 0.685, Base Lr: 4.83e-03
2022-04-26 00:37:37,601 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.278[s] Speed: 57.6[samples/s]
2022-04-26 00:38:09,233 reid_baseline.train INFO: normal accuracy 0.3164400494437577 2.948134660720825 
2022-04-26 00:38:11,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 00:38:11,232 reid_baseline.train INFO: Accuracy: 31.6% Mean Entropy: 294.8%
2022-04-26 00:38:41,093 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.762, Acc: 0.707, Base Lr: 5.23e-03
2022-04-26 00:39:07,200 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.727, Acc: 0.715, Base Lr: 5.23e-03
2022-04-26 00:39:29,397 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-26 00:40:01,494 reid_baseline.train INFO: normal accuracy 0.31685208075813764 2.8128039836883545 
2022-04-26 00:40:02,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 00:40:02,721 reid_baseline.train INFO: Accuracy: 31.7% Mean Entropy: 281.3%
2022-04-26 00:40:32,295 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.673, Acc: 0.740, Base Lr: 5.62e-03
2022-04-26 00:40:59,498 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.661, Acc: 0.738, Base Lr: 5.62e-03
2022-04-26 00:41:18,253 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.277[s] Speed: 57.8[samples/s]
2022-04-26 00:41:55,541 reid_baseline.train INFO: normal accuracy 0.3180881747012773 2.7321908473968506 
2022-04-26 00:41:56,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 00:41:56,777 reid_baseline.train INFO: Accuracy: 31.8% Mean Entropy: 273.2%
2022-04-26 00:42:22,807 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.560, Acc: 0.769, Base Lr: 6.02e-03
2022-04-26 00:42:49,523 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.568, Acc: 0.764, Base Lr: 6.02e-03
2022-04-26 00:43:10,428 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.270[s] Speed: 59.3[samples/s]
2022-04-26 00:43:44,876 reid_baseline.train INFO: normal accuracy 0.32797692624639474 2.6870527267456055 
2022-04-26 00:43:46,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 00:43:46,027 reid_baseline.train INFO: Accuracy: 32.8% Mean Entropy: 268.7%
2022-04-26 00:44:14,706 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.489, Acc: 0.801, Base Lr: 6.42e-03
2022-04-26 00:44:41,138 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.491, Acc: 0.794, Base Lr: 6.42e-03
2022-04-26 00:45:02,341 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-26 00:45:38,631 reid_baseline.train INFO: normal accuracy 0.33168520807581375 2.686495780944824 
2022-04-26 00:45:39,708 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 00:45:39,708 reid_baseline.train INFO: Accuracy: 33.2% Mean Entropy: 268.6%
2022-04-26 00:46:07,382 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.446, Acc: 0.808, Base Lr: 6.81e-03
2022-04-26 00:46:34,810 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.456, Acc: 0.804, Base Lr: 6.81e-03
2022-04-26 00:46:55,645 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.278[s] Speed: 57.6[samples/s]
2022-04-26 00:47:32,355 reid_baseline.train INFO: normal accuracy 0.32838895756077463 2.6439361572265625 
2022-04-26 00:47:33,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 00:47:33,561 reid_baseline.train INFO: Accuracy: 32.8% Mean Entropy: 264.4%
2022-04-26 00:48:02,453 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.386, Acc: 0.821, Base Lr: 7.21e-03
2022-04-26 00:48:27,901 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.399, Acc: 0.815, Base Lr: 7.21e-03
2022-04-26 00:48:48,740 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-04-26 00:49:25,118 reid_baseline.train INFO: normal accuracy 0.32674083230325507 2.6130027770996094 
2022-04-26 00:49:26,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 00:49:26,426 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 261.3%
2022-04-26 00:49:54,521 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.339, Acc: 0.837, Base Lr: 7.60e-03
2022-04-26 00:50:16,198 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.361, Acc: 0.831, Base Lr: 7.60e-03
2022-04-26 00:50:36,733 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.258[s] Speed: 62.1[samples/s]
2022-04-26 00:51:11,507 reid_baseline.train INFO: normal accuracy 0.32509270704573545 2.619105815887451 
2022-04-26 00:51:11,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 00:51:11,512 reid_baseline.train INFO: Accuracy: 32.5% Mean Entropy: 261.9%
2022-04-26 00:51:41,021 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.270, Acc: 0.865, Base Lr: 4.01e-03
2022-04-26 00:52:07,650 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.259, Acc: 0.871, Base Lr: 4.01e-03
2022-04-26 00:52:27,901 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.280[s] Speed: 57.2[samples/s]
2022-04-26 00:53:01,998 reid_baseline.train INFO: normal accuracy 0.33250927070457353 2.6063783168792725 
2022-04-26 00:53:03,397 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 00:53:03,398 reid_baseline.train INFO: Accuracy: 33.3% Mean Entropy: 260.6%
2022-04-26 00:53:34,108 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.202, Acc: 0.889, Base Lr: 3.69e-03
2022-04-26 00:53:57,633 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.191, Acc: 0.892, Base Lr: 3.69e-03
2022-04-26 00:54:19,414 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.278[s] Speed: 57.6[samples/s]
2022-04-26 00:54:52,713 reid_baseline.train INFO: normal accuracy 0.34445817882159047 2.594679832458496 
2022-04-26 00:54:53,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 00:54:53,917 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 259.5%
2022-04-26 00:55:24,270 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.190, Acc: 0.894, Base Lr: 3.38e-03
2022-04-26 00:55:50,414 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.188, Acc: 0.896, Base Lr: 3.38e-03
2022-04-26 00:56:12,310 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.287[s] Speed: 55.7[samples/s]
2022-04-26 00:56:46,646 reid_baseline.train INFO: normal accuracy 0.3304491141326741 2.5760414600372314 
2022-04-26 00:56:47,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 00:56:47,858 reid_baseline.train INFO: Accuracy: 33.0% Mean Entropy: 257.6%
2022-04-26 00:57:17,074 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.161, Acc: 0.899, Base Lr: 3.08e-03
2022-04-26 00:57:41,752 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.161, Acc: 0.901, Base Lr: 3.08e-03
2022-04-26 00:58:03,031 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-04-26 00:58:40,503 reid_baseline.train INFO: normal accuracy 0.33127317676143386 2.5310494899749756 
2022-04-26 00:58:41,591 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 00:58:41,591 reid_baseline.train INFO: Accuracy: 33.1% Mean Entropy: 253.1%
2022-04-26 00:59:10,379 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.120, Acc: 0.921, Base Lr: 2.77e-03
2022-04-26 00:59:37,171 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.130, Acc: 0.913, Base Lr: 2.77e-03
2022-04-26 00:59:57,582 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.278[s] Speed: 57.5[samples/s]
2022-04-26 01:00:32,409 reid_baseline.train INFO: normal accuracy 0.33910177173465184 2.507260322570801 
2022-04-26 01:00:33,633 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 01:00:33,633 reid_baseline.train INFO: Accuracy: 33.9% Mean Entropy: 250.7%
2022-04-26 01:01:03,079 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.142, Acc: 0.906, Base Lr: 2.48e-03
2022-04-26 01:01:28,486 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.129, Acc: 0.910, Base Lr: 2.48e-03
2022-04-26 01:01:47,673 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.271[s] Speed: 59.0[samples/s]
2022-04-26 01:02:21,024 reid_baseline.train INFO: normal accuracy 0.33786567779151216 2.500735282897949 
2022-04-26 01:02:22,269 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 01:02:22,270 reid_baseline.train INFO: Accuracy: 33.8% Mean Entropy: 250.1%
2022-04-26 01:02:49,467 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.094, Acc: 0.926, Base Lr: 2.20e-03
2022-04-26 01:03:15,983 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.102, Acc: 0.920, Base Lr: 2.20e-03
2022-04-26 01:03:37,643 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 01:04:12,284 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.555152416229248 
2022-04-26 01:04:12,291 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 01:04:12,291 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 255.5%
2022-04-26 01:04:41,874 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.087, Acc: 0.928, Base Lr: 1.92e-03
2022-04-26 01:05:08,796 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.091, Acc: 0.926, Base Lr: 1.92e-03
2022-04-26 01:05:27,687 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 01:06:01,129 reid_baseline.train INFO: normal accuracy 0.3465183353934899 2.503948926925659 
2022-04-26 01:06:01,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 01:06:01,134 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 250.4%
2022-04-26 01:06:29,378 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.087, Acc: 0.923, Base Lr: 1.66e-03
2022-04-26 01:06:56,436 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.080, Acc: 0.927, Base Lr: 1.66e-03
2022-04-26 01:07:17,324 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-26 01:07:49,815 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.528944492340088 
2022-04-26 01:07:49,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 01:07:49,823 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 252.9%
2022-04-26 01:08:19,748 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.055, Acc: 0.936, Base Lr: 1.42e-03
2022-04-26 01:08:47,598 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.059, Acc: 0.935, Base Lr: 1.42e-03
2022-04-26 01:09:07,966 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-26 01:09:38,912 reid_baseline.train INFO: normal accuracy 0.3440461475072106 2.507591485977173 
2022-04-26 01:09:38,912 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 01:09:38,912 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 250.8%
2022-04-26 01:10:07,665 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.060, Acc: 0.933, Base Lr: 1.19e-03
2022-04-26 01:10:35,012 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.052, Acc: 0.938, Base Lr: 1.19e-03
2022-04-26 01:10:55,604 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-26 01:11:30,510 reid_baseline.train INFO: normal accuracy 0.3415739596209312 2.533940315246582 
2022-04-26 01:11:30,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 01:11:30,513 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 253.4%
2022-04-26 01:11:59,374 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.042, Acc: 0.942, Base Lr: 9.72e-04
2022-04-26 01:12:26,844 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.040, Acc: 0.941, Base Lr: 9.72e-04
2022-04-26 01:12:49,732 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.289[s] Speed: 55.3[samples/s]
2022-04-26 01:13:21,033 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.496490478515625 
2022-04-26 01:13:22,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 01:13:22,232 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 249.6%
2022-04-26 01:13:51,436 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.051, Acc: 0.934, Base Lr: 7.78e-04
2022-04-26 01:14:16,673 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.054, Acc: 0.933, Base Lr: 7.78e-04
2022-04-26 01:14:37,997 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.278[s] Speed: 57.7[samples/s]
2022-04-26 01:15:14,931 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.5114917755126953 
2022-04-26 01:15:14,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 01:15:14,938 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 251.1%
2022-04-26 01:15:46,207 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.027, Acc: 0.946, Base Lr: 6.04e-04
2022-04-26 01:16:11,676 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.037, Acc: 0.941, Base Lr: 6.04e-04
2022-04-26 01:16:33,391 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.287[s] Speed: 55.7[samples/s]
2022-04-26 01:17:07,585 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.5230278968811035 
2022-04-26 01:17:07,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 01:17:07,587 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 252.3%
2022-04-26 01:17:34,154 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.032, Acc: 0.947, Base Lr: 4.51e-04
2022-04-26 01:18:01,383 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.031, Acc: 0.945, Base Lr: 4.51e-04
2022-04-26 01:18:21,835 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.272[s] Speed: 58.8[samples/s]
2022-04-26 01:18:56,709 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.5316665172576904 
2022-04-26 01:18:56,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 01:18:56,714 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 253.2%
2022-04-26 01:19:26,764 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.050, Acc: 0.935, Base Lr: 3.20e-04
2022-04-26 01:19:51,880 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.043, Acc: 0.939, Base Lr: 3.20e-04
2022-04-26 01:20:11,737 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-04-26 01:20:47,791 reid_baseline.train INFO: normal accuracy 0.3473423980222497 2.5167782306671143 
2022-04-26 01:20:47,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 01:20:47,798 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 251.7%
2022-04-26 01:21:16,737 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.020, Acc: 0.953, Base Lr: 2.11e-04
2022-04-26 01:21:40,197 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.030, Acc: 0.948, Base Lr: 2.11e-04
2022-04-26 01:22:01,233 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.269[s] Speed: 59.5[samples/s]
2022-04-26 01:22:35,534 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.499871253967285 
2022-04-26 01:22:35,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 01:22:35,537 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.0%
2022-04-26 01:23:04,846 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.040, Acc: 0.942, Base Lr: 1.26e-04
2022-04-26 01:23:28,838 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.032, Acc: 0.943, Base Lr: 1.26e-04
2022-04-26 01:23:51,183 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.277[s] Speed: 57.7[samples/s]
2022-04-26 01:24:24,487 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.5037827491760254 
2022-04-26 01:24:24,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 01:24:24,492 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 250.4%
2022-04-26 01:24:52,051 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.031, Acc: 0.941, Base Lr: 6.51e-05
2022-04-26 01:25:17,078 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.031, Acc: 0.947, Base Lr: 6.51e-05
2022-04-26 01:25:36,905 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.265[s] Speed: 60.3[samples/s]
2022-04-26 01:26:09,326 reid_baseline.train INFO: normal accuracy 0.34281005356407085 2.527578115463257 
2022-04-26 01:26:09,331 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 01:26:09,331 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 252.8%
2022-04-26 01:26:38,027 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.011, Acc: 0.946, Base Lr: 2.83e-05
2022-04-26 01:27:05,094 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.023, Acc: 0.946, Base Lr: 2.83e-05
2022-04-26 01:27:26,718 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.283[s] Speed: 56.5[samples/s]
2022-04-26 01:28:01,435 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.4993808269500732 
2022-04-26 01:28:01,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 01:28:01,451 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 249.9%
2022-04-26 01:28:32,149 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.036, Acc: 0.941, Base Lr: 1.60e-05
2022-04-26 01:29:01,230 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.025, Acc: 0.946, Base Lr: 1.60e-05
2022-04-26 01:29:23,556 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.300[s] Speed: 53.4[samples/s]
2022-04-26 01:29:47,411 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5017383098602295 
2022-04-26 01:29:47,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 01:29:47,411 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_3/transformer_best_model.pth
2022-04-26 01:30:20,213 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.496490478515625 
2022-04-26 01:30:20,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:30:20,214 reid_baseline.train INFO: Accuracy: 34.0%
2022-04-26 01:30:52,421 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.496490478515625 
2022-04-26 01:30:52,422 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:30:52,422 reid_baseline.train INFO: Shuffled Accuracy: 34.0%
2022-04-26 01:31:50,125 reid_baseline.train INFO: normal accuracy 0.9246277205040092 1.1522419452667236 
2022-04-26 01:31:50,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:31:50,127 reid_baseline.train INFO: Source Clean Accuracy: 92.5%
2022-04-26 01:31:58,005 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_3
2022-04-26 01:31:58,006 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 01:31:58,006 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 01:31:58,006 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 01:31:58,007 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 01:32:13,073 reid_baseline.train INFO: start training
2022-04-26 01:32:42,908 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.092, Base Lr: 4.76e-04
2022-04-26 01:33:12,283 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.127, Base Lr: 4.76e-04
2022-04-26 01:33:32,180 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.287[s] Speed: 55.8[samples/s]
2022-04-26 01:34:30,598 reid_baseline.train INFO: normal accuracy 0.1076819103401667 4.169184684753418 
2022-04-26 01:34:31,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 01:34:31,760 reid_baseline.train INFO: Accuracy: 10.8% Mean Entropy: 416.9%
2022-04-26 01:35:01,103 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.963, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 01:35:30,323 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.910, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 01:35:49,170 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.283[s] Speed: 56.4[samples/s]
2022-04-26 01:36:05,144 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_3
2022-04-26 01:36:05,144 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 01:36:05,144 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 01:36:05,144 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 01:36:05,145 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 01:36:22,841 reid_baseline.train INFO: start training
2022-04-26 01:36:52,762 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.092, Base Lr: 4.76e-04
2022-04-26 01:37:20,631 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.127, Base Lr: 4.76e-04
2022-04-26 01:37:40,874 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.280[s] Speed: 57.1[samples/s]
2022-04-26 01:38:50,810 reid_baseline.train INFO: normal accuracy 0.12898783566674318 4.168457508087158 
2022-04-26 01:38:52,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 01:38:52,094 reid_baseline.train INFO: Accuracy: 12.9% Mean Entropy: 416.8%
2022-04-26 01:39:20,170 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.963, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 01:39:48,480 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.910, Acc: 0.203, Base Lr: 8.72e-04
2022-04-26 01:40:11,942 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.292[s] Speed: 54.7[samples/s]
2022-04-26 01:41:21,971 reid_baseline.train INFO: normal accuracy 0.13587330732155153 4.124295234680176 
2022-04-26 01:41:23,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 01:41:23,014 reid_baseline.train INFO: Accuracy: 13.6% Mean Entropy: 412.4%
2022-04-26 01:41:51,990 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.686, Acc: 0.221, Base Lr: 1.27e-03
2022-04-26 01:42:21,305 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.629, Acc: 0.233, Base Lr: 1.27e-03
2022-04-26 01:42:40,949 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.285[s] Speed: 56.1[samples/s]
2022-04-26 01:43:49,818 reid_baseline.train INFO: normal accuracy 0.17420243286665135 4.004275321960449 
2022-04-26 01:43:51,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 01:43:51,422 reid_baseline.train INFO: Accuracy: 17.4% Mean Entropy: 400.4%
2022-04-26 01:44:26,097 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.339, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 01:44:53,295 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.322, Acc: 0.282, Base Lr: 1.66e-03
2022-04-26 01:45:14,280 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.303[s] Speed: 52.7[samples/s]
2022-04-26 01:46:29,298 reid_baseline.train INFO: normal accuracy 0.20977736974982786 3.826939582824707 
2022-04-26 01:46:30,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 01:46:30,514 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 382.7%
2022-04-26 01:46:55,664 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.107, Acc: 0.324, Base Lr: 2.06e-03
2022-04-26 01:47:24,820 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.045, Acc: 0.352, Base Lr: 2.06e-03
2022-04-26 01:47:44,828 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.272[s] Speed: 58.9[samples/s]
2022-04-26 01:49:00,787 reid_baseline.train INFO: normal accuracy 0.259582281386275 3.668975830078125 
2022-04-26 01:49:02,080 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 01:49:02,080 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 366.9%
2022-04-26 01:49:31,044 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.862, Acc: 0.401, Base Lr: 2.46e-03
2022-04-26 01:49:57,445 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.816, Acc: 0.407, Base Lr: 2.46e-03
2022-04-26 01:50:16,755 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.273[s] Speed: 58.5[samples/s]
