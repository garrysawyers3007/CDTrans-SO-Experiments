2022-04-25 18:45:30,772 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_1
2022-04-25 18:45:30,772 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 18:45:30,772 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 18:45:30,772 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 18:45:30,773 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 18:45:42,123 reid_baseline.train INFO: start training
2022-04-25 18:46:03,095 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.099, Base Lr: 4.76e-04
2022-04-25 18:46:14,409 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.212[s] Speed: 75.5[samples/s]
2022-04-25 18:46:55,320 reid_baseline.train INFO: normal accuracy 0.08728522336769759 4.172665596008301 
2022-04-25 18:46:56,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 18:46:56,078 reid_baseline.train INFO: Accuracy: 8.7% Mean Entropy: 417.3%
2022-04-25 18:47:14,325 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.035, Acc: 0.220, Base Lr: 8.72e-04
2022-04-25 18:47:21,737 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.169[s] Speed: 94.9[samples/s]
2022-04-25 18:47:51,675 reid_baseline.train INFO: normal accuracy 0.09965635738831616 4.166989803314209 
2022-04-25 18:47:52,477 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 18:47:52,477 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 416.7%
2022-04-25 18:48:13,692 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.847, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 18:48:24,594 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.211[s] Speed: 75.9[samples/s]
2022-04-25 18:49:23,837 reid_baseline.train INFO: normal accuracy 0.10446735395189004 4.146336078643799 
2022-04-25 18:49:24,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 18:49:24,611 reid_baseline.train INFO: Accuracy: 10.4% Mean Entropy: 414.6%
2022-04-25 18:49:54,739 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.608, Acc: 0.277, Base Lr: 1.66e-03
2022-04-25 18:50:10,265 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.300[s] Speed: 53.4[samples/s]
2022-04-25 18:51:12,706 reid_baseline.train INFO: normal accuracy 0.10263459335624284 4.101791858673096 
2022-04-25 18:51:13,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 18:51:13,483 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 410.2%
2022-04-25 18:51:40,367 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.416, Acc: 0.287, Base Lr: 2.06e-03
2022-04-25 18:51:55,613 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.277[s] Speed: 57.8[samples/s]
2022-04-25 18:52:58,564 reid_baseline.train INFO: normal accuracy 0.1145475372279496 4.046262264251709 
2022-04-25 18:52:59,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 18:52:59,400 reid_baseline.train INFO: Accuracy: 11.5% Mean Entropy: 404.6%
2022-04-25 18:53:30,071 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.184, Acc: 0.316, Base Lr: 2.46e-03
2022-04-25 18:53:45,553 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.303[s] Speed: 52.8[samples/s]
2022-04-25 18:54:47,416 reid_baseline.train INFO: normal accuracy 0.12989690721649486 3.9539635181427 
2022-04-25 18:54:48,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 18:54:48,409 reid_baseline.train INFO: Accuracy: 13.0% Mean Entropy: 395.4%
2022-04-25 18:55:18,424 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.975, Acc: 0.373, Base Lr: 2.85e-03
2022-04-25 18:55:33,700 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.297[s] Speed: 53.9[samples/s]
2022-04-25 18:56:37,127 reid_baseline.train INFO: normal accuracy 0.13631156930126 3.857206344604492 
2022-04-25 18:56:38,087 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 18:56:38,088 reid_baseline.train INFO: Accuracy: 13.6% Mean Entropy: 385.7%
2022-04-25 18:57:07,137 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.778, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 18:57:22,772 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.292[s] Speed: 54.8[samples/s]
2022-04-25 18:58:12,578 reid_baseline.train INFO: normal accuracy 0.15670103092783505 3.788252592086792 
2022-04-25 18:58:13,367 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 18:58:13,367 reid_baseline.train INFO: Accuracy: 15.7% Mean Entropy: 378.8%
2022-04-25 18:58:33,990 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.596, Acc: 0.463, Base Lr: 3.64e-03
2022-04-25 18:58:44,604 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.205[s] Speed: 78.1[samples/s]
2022-04-25 18:59:41,024 reid_baseline.train INFO: normal accuracy 0.16380297823596793 3.673572063446045 
2022-04-25 18:59:41,996 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 18:59:41,997 reid_baseline.train INFO: Accuracy: 16.4% Mean Entropy: 367.4%
2022-04-25 19:00:12,570 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.414, Acc: 0.518, Base Lr: 4.04e-03
2022-04-25 19:00:26,370 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.291[s] Speed: 55.0[samples/s]
2022-04-25 19:01:29,724 reid_baseline.train INFO: normal accuracy 0.1722794959908362 3.5827548503875732 
2022-04-25 19:01:30,517 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 19:01:30,517 reid_baseline.train INFO: Accuracy: 17.2% Mean Entropy: 358.3%
2022-04-25 19:01:57,978 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.558, Base Lr: 4.44e-03
2022-04-25 19:02:13,317 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.281[s] Speed: 56.9[samples/s]
2022-04-25 19:03:15,571 reid_baseline.train INFO: normal accuracy 0.1961053837342497 3.4617810249328613 
2022-04-25 19:03:16,377 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 19:03:16,377 reid_baseline.train INFO: Accuracy: 19.6% Mean Entropy: 346.2%
2022-04-25 19:03:46,437 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.088, Acc: 0.618, Base Lr: 4.83e-03
2022-04-25 19:04:02,059 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.300[s] Speed: 53.3[samples/s]
2022-04-25 19:05:04,962 reid_baseline.train INFO: normal accuracy 0.1967926689576174 3.406733512878418 
2022-04-25 19:05:06,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 19:05:06,152 reid_baseline.train INFO: Accuracy: 19.7% Mean Entropy: 340.7%
2022-04-25 19:05:36,170 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.679, Base Lr: 5.23e-03
2022-04-25 19:05:51,776 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.298[s] Speed: 53.8[samples/s]
2022-04-25 19:06:54,272 reid_baseline.train INFO: normal accuracy 0.21947308132875143 3.2998886108398438 
2022-04-25 19:06:55,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 19:06:55,097 reid_baseline.train INFO: Accuracy: 21.9% Mean Entropy: 330.0%
2022-04-25 19:07:24,428 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.843, Acc: 0.687, Base Lr: 5.62e-03
2022-04-25 19:07:40,099 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.295[s] Speed: 54.2[samples/s]
2022-04-25 19:08:35,199 reid_baseline.train INFO: normal accuracy 0.2265750286368843 3.2722785472869873 
2022-04-25 19:08:35,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 19:08:35,997 reid_baseline.train INFO: Accuracy: 22.7% Mean Entropy: 327.2%
2022-04-25 19:08:55,980 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.736, Acc: 0.727, Base Lr: 6.02e-03
2022-04-25 19:09:06,676 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.201[s] Speed: 79.4[samples/s]
2022-04-25 19:10:01,978 reid_baseline.train INFO: normal accuracy 0.21512027491408936 3.132544755935669 
2022-04-25 19:10:02,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 19:10:02,818 reid_baseline.train INFO: Accuracy: 21.5% Mean Entropy: 313.3%
2022-04-25 19:10:32,267 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.626, Acc: 0.764, Base Lr: 6.42e-03
2022-04-25 19:10:47,433 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.292[s] Speed: 54.8[samples/s]
2022-04-25 19:11:50,826 reid_baseline.train INFO: normal accuracy 0.23986254295532647 3.0358481407165527 
2022-04-25 19:11:51,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 19:11:51,625 reid_baseline.train INFO: Accuracy: 24.0% Mean Entropy: 303.6%
2022-04-25 19:12:21,514 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 19:12:34,456 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-25 19:13:36,689 reid_baseline.train INFO: normal accuracy 0.24971363115693013 2.9474895000457764 
2022-04-25 19:13:37,489 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 19:13:37,489 reid_baseline.train INFO: Accuracy: 25.0% Mean Entropy: 294.7%
2022-04-25 19:14:07,384 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.452, Acc: 0.824, Base Lr: 7.21e-03
2022-04-25 19:14:23,053 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.300[s] Speed: 53.4[samples/s]
2022-04-25 19:15:24,041 reid_baseline.train INFO: normal accuracy 0.25773195876288657 2.8728015422821045 
2022-04-25 19:15:25,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 19:15:25,229 reid_baseline.train INFO: Accuracy: 25.8% Mean Entropy: 287.3%
2022-04-25 19:15:53,572 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.388, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 19:16:09,321 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.288[s] Speed: 55.5[samples/s]
2022-04-25 19:17:13,123 reid_baseline.train INFO: normal accuracy 0.24765177548682704 2.845292568206787 
2022-04-25 19:17:14,039 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 19:17:14,039 reid_baseline.train INFO: Accuracy: 24.8% Mean Entropy: 284.5%
2022-04-25 19:17:43,749 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.277, Acc: 0.892, Base Lr: 4.01e-03
2022-04-25 19:17:59,445 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.298[s] Speed: 53.6[samples/s]
2022-04-25 19:18:56,235 reid_baseline.train INFO: normal accuracy 0.2616265750286369 2.731821060180664 
2022-04-25 19:18:57,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 19:18:57,050 reid_baseline.train INFO: Accuracy: 26.2% Mean Entropy: 273.2%
2022-04-25 19:19:17,194 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.237, Acc: 0.902, Base Lr: 3.69e-03
2022-04-25 19:19:28,017 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.203[s] Speed: 78.9[samples/s]
2022-04-25 19:20:19,282 reid_baseline.train INFO: normal accuracy 0.2552119129438717 2.672999143600464 
2022-04-25 19:20:20,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 19:20:20,506 reid_baseline.train INFO: Accuracy: 25.5% Mean Entropy: 267.3%
2022-04-25 19:20:49,960 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.191, Acc: 0.925, Base Lr: 3.38e-03
2022-04-25 19:21:05,633 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.297[s] Speed: 54.0[samples/s]
2022-04-25 19:22:09,255 reid_baseline.train INFO: normal accuracy 0.2641466208476518 2.6933255195617676 
2022-04-25 19:22:09,259 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 19:22:09,260 reid_baseline.train INFO: Accuracy: 26.4% Mean Entropy: 269.3%
2022-04-25 19:22:39,588 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.166, Acc: 0.936, Base Lr: 3.08e-03
2022-04-25 19:22:54,270 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.296[s] Speed: 54.1[samples/s]
2022-04-25 19:23:53,310 reid_baseline.train INFO: normal accuracy 0.2600229095074456 2.712599992752075 
2022-04-25 19:23:53,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 19:23:53,313 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 271.3%
2022-04-25 19:24:24,113 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.157, Acc: 0.926, Base Lr: 2.77e-03
2022-04-25 19:24:39,806 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.306[s] Speed: 52.4[samples/s]
2022-04-25 19:25:42,119 reid_baseline.train INFO: normal accuracy 0.2609392898052692 2.6170403957366943 
2022-04-25 19:25:43,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 19:25:43,217 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 261.7%
2022-04-25 19:26:14,518 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.121, Acc: 0.948, Base Lr: 2.48e-03
2022-04-25 19:26:27,901 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.294[s] Speed: 54.5[samples/s]
2022-04-25 19:27:29,415 reid_baseline.train INFO: normal accuracy 0.2652920962199313 2.5719308853149414 
2022-04-25 19:27:30,265 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 19:27:30,265 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 257.2%
2022-04-25 19:28:00,511 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.953, Base Lr: 2.20e-03
2022-04-25 19:28:16,206 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.302[s] Speed: 53.0[samples/s]
2022-04-25 19:29:17,451 reid_baseline.train INFO: normal accuracy 0.2627720504009164 2.5985007286071777 
2022-04-25 19:29:17,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 19:29:17,453 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 259.9%
2022-04-25 19:29:38,162 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.074, Acc: 0.953, Base Lr: 1.92e-03
2022-04-25 19:29:48,803 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.206[s] Speed: 77.8[samples/s]
2022-04-25 19:30:40,685 reid_baseline.train INFO: normal accuracy 0.261397479954181 2.584811210632324 
2022-04-25 19:30:40,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 19:30:40,690 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 258.5%
2022-04-25 19:31:09,029 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.061, Acc: 0.955, Base Lr: 1.66e-03
2022-04-25 19:31:24,734 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.289[s] Speed: 55.4[samples/s]
2022-04-25 19:32:28,417 reid_baseline.train INFO: normal accuracy 0.2630011454753723 2.557802200317383 
2022-04-25 19:32:29,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 19:32:29,429 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 255.8%
2022-04-25 19:33:00,287 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.036, Acc: 0.966, Base Lr: 1.42e-03
2022-04-25 19:33:14,814 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.298[s] Speed: 53.6[samples/s]
2022-04-25 19:34:16,132 reid_baseline.train INFO: normal accuracy 0.2634593356242841 2.4982759952545166 
2022-04-25 19:34:16,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 19:34:16,941 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 249.8%
2022-04-25 19:34:47,333 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.040, Acc: 0.965, Base Lr: 1.19e-03
2022-04-25 19:35:02,974 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.302[s] Speed: 52.9[samples/s]
2022-04-25 19:36:02,066 reid_baseline.train INFO: normal accuracy 0.26689576174112256 2.5898289680480957 
2022-04-25 19:36:02,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 19:36:02,071 reid_baseline.train INFO: Accuracy: 26.7% Mean Entropy: 259.0%
2022-04-25 19:36:32,658 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.023, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 19:36:48,396 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.304[s] Speed: 52.6[samples/s]
2022-04-25 19:37:48,034 reid_baseline.train INFO: normal accuracy 0.26918671248568155 2.5680174827575684 
2022-04-25 19:37:48,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 19:37:48,039 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 256.8%
2022-04-25 19:38:20,434 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.017, Acc: 0.974, Base Lr: 7.78e-04
2022-04-25 19:38:36,023 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.315[s] Speed: 50.7[samples/s]
2022-04-25 19:39:37,323 reid_baseline.train INFO: normal accuracy 0.2721649484536082 2.5435097217559814 
2022-04-25 19:39:37,325 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 19:39:37,326 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 254.4%
2022-04-25 19:39:59,318 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.969, Base Lr: 6.04e-04
2022-04-25 19:40:10,037 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-25 19:40:58,971 reid_baseline.train INFO: normal accuracy 0.26712485681557846 2.513134002685547 
2022-04-25 19:40:58,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 19:40:58,976 reid_baseline.train INFO: Accuracy: 26.7% Mean Entropy: 251.3%
2022-04-25 19:41:26,811 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 4.51e-04
2022-04-25 19:41:42,412 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.285[s] Speed: 56.2[samples/s]
2022-04-25 19:42:45,529 reid_baseline.train INFO: normal accuracy 0.26620847651775487 2.501614570617676 
2022-04-25 19:42:45,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 19:42:45,531 reid_baseline.train INFO: Accuracy: 26.6% Mean Entropy: 250.2%
2022-04-25 19:43:15,716 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 3.20e-04
2022-04-25 19:43:31,387 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-25 19:44:32,458 reid_baseline.train INFO: normal accuracy 0.26643757159221076 2.540168285369873 
2022-04-25 19:44:32,462 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 19:44:32,463 reid_baseline.train INFO: Accuracy: 26.6% Mean Entropy: 254.0%
2022-04-25 19:45:04,345 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.002, Acc: 0.975, Base Lr: 2.11e-04
2022-04-25 19:45:20,022 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.311[s] Speed: 51.4[samples/s]
2022-04-25 19:46:20,383 reid_baseline.train INFO: normal accuracy 0.26735395189003436 2.536705732345581 
2022-04-25 19:46:20,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 19:46:20,388 reid_baseline.train INFO: Accuracy: 26.7% Mean Entropy: 253.7%
2022-04-25 19:46:51,436 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.997, Acc: 0.969, Base Lr: 1.26e-04
2022-04-25 19:47:07,102 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.307[s] Speed: 52.1[samples/s]
2022-04-25 19:48:03,742 reid_baseline.train INFO: normal accuracy 0.26735395189003436 2.5309805870056152 
2022-04-25 19:48:03,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 19:48:03,747 reid_baseline.train INFO: Accuracy: 26.7% Mean Entropy: 253.1%
2022-04-25 19:48:35,340 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.999, Acc: 0.977, Base Lr: 6.51e-05
2022-04-25 19:48:51,060 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.311[s] Speed: 51.5[samples/s]
2022-04-25 19:49:53,321 reid_baseline.train INFO: normal accuracy 0.26895761741122565 2.533696174621582 
2022-04-25 19:49:53,326 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 19:49:53,326 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 253.4%
2022-04-25 19:50:17,870 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.008, Acc: 0.973, Base Lr: 2.83e-05
2022-04-25 19:50:28,572 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.232[s] Speed: 69.1[samples/s]
2022-04-25 19:51:12,270 reid_baseline.train INFO: normal accuracy 0.2641466208476518 2.5017952919006348 
2022-04-25 19:51:12,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 19:51:12,273 reid_baseline.train INFO: Accuracy: 26.4% Mean Entropy: 250.2%
2022-04-25 19:51:43,917 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.985, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 19:51:58,383 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.302[s] Speed: 52.9[samples/s]
2022-04-25 19:53:01,262 reid_baseline.train INFO: normal accuracy 0.26781214203894615 2.5625510215759277 
2022-04-25 19:53:01,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 19:53:01,267 reid_baseline.train INFO: Accuracy: 26.8% Mean Entropy: 256.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 19:54:02,832 reid_baseline.train INFO: normal accuracy 0.2634593356242841 2.4982759952545166 
2022-04-25 19:54:02,832 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:54:02,832 reid_baseline.train INFO: Accuracy: 26.3%
2022-04-25 19:55:06,980 reid_baseline.train INFO: normal accuracy 0.2634593356242841 2.4982759952545166 
2022-04-25 19:55:06,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:55:06,981 reid_baseline.train INFO: Shuffled Accuracy: 26.3%
2022-04-25 19:55:38,946 reid_baseline.train INFO: normal accuracy 0.9728059332509271 1.1182137727737427 
2022-04-25 19:55:38,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:55:38,947 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-25 19:55:44,888 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_1
2022-04-25 19:55:44,888 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 19:55:44,888 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 19:55:44,888 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 19:55:44,888 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 19:55:58,822 reid_baseline.train INFO: start training
2022-04-25 19:56:32,609 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.099, Base Lr: 4.76e-04
2022-04-25 19:56:47,990 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-25 19:57:53,881 reid_baseline.train INFO: normal accuracy 0.1092588420815499 4.172657012939453 
2022-04-25 19:57:54,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 19:57:54,747 reid_baseline.train INFO: Accuracy: 10.9% Mean Entropy: 417.3%
2022-04-25 19:58:25,030 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.035, Acc: 0.220, Base Lr: 8.72e-04
2022-04-25 19:58:41,386 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.307[s] Speed: 52.2[samples/s]
2022-04-25 19:59:35,364 reid_baseline.train INFO: normal accuracy 0.1302095066456409 4.166522979736328 
2022-04-25 19:59:36,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 19:59:36,316 reid_baseline.train INFO: Accuracy: 13.0% Mean Entropy: 416.7%
2022-04-25 20:00:02,450 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.847, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 20:00:16,352 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.262[s] Speed: 61.0[samples/s]
2022-04-25 20:01:05,887 reid_baseline.train INFO: normal accuracy 0.12592926334760082 4.141743183135986 
2022-04-25 20:01:06,652 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:01:06,652 reid_baseline.train INFO: Accuracy: 12.6% Mean Entropy: 414.2%
2022-04-25 20:01:27,060 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.608, Acc: 0.277, Base Lr: 1.66e-03
2022-04-25 20:01:37,777 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.205[s] Speed: 78.2[samples/s]
2022-04-25 20:02:40,515 reid_baseline.train INFO: normal accuracy 0.12840729894120298 4.080955505371094 
2022-04-25 20:02:41,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:02:41,335 reid_baseline.train INFO: Accuracy: 12.8% Mean Entropy: 408.1%
2022-04-25 20:03:11,956 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.416, Acc: 0.287, Base Lr: 2.06e-03
2022-04-25 20:03:27,507 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.302[s] Speed: 52.9[samples/s]
2022-04-25 20:04:31,016 reid_baseline.train INFO: normal accuracy 0.13719306150033792 4.014502048492432 
2022-04-25 20:04:32,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:04:32,721 reid_baseline.train INFO: Accuracy: 13.7% Mean Entropy: 401.5%
2022-04-25 20:05:03,216 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.184, Acc: 0.316, Base Lr: 2.46e-03
2022-04-25 20:05:18,427 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-25 20:06:19,992 reid_baseline.train INFO: normal accuracy 0.16017120973192162 3.8880932331085205 
2022-04-25 20:06:20,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 20:06:20,828 reid_baseline.train INFO: Accuracy: 16.0% Mean Entropy: 388.8%
2022-04-25 20:06:51,217 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.975, Acc: 0.373, Base Lr: 2.85e-03
2022-04-25 20:07:06,515 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.300[s] Speed: 53.4[samples/s]
2022-04-25 20:08:09,409 reid_baseline.train INFO: normal accuracy 0.18022077044379364 3.740025281906128 
2022-04-25 20:08:10,497 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 20:08:10,497 reid_baseline.train INFO: Accuracy: 18.0% Mean Entropy: 374.0%
2022-04-25 20:08:40,755 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.778, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 20:08:54,177 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.287[s] Speed: 55.7[samples/s]
2022-04-25 20:09:57,767 reid_baseline.train INFO: normal accuracy 0.21784185627393557 3.6618309020996094 
2022-04-25 20:09:58,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 20:09:58,596 reid_baseline.train INFO: Accuracy: 21.8% Mean Entropy: 366.2%
2022-04-25 20:10:28,221 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.596, Acc: 0.463, Base Lr: 3.64e-03
2022-04-25 20:10:43,639 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.295[s] Speed: 54.3[samples/s]
2022-04-25 20:11:28,824 reid_baseline.train INFO: normal accuracy 0.24983104302770895 3.4822282791137695 
2022-04-25 20:11:29,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 20:11:29,949 reid_baseline.train INFO: Accuracy: 25.0% Mean Entropy: 348.2%
2022-04-25 20:11:51,434 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.414, Acc: 0.518, Base Lr: 4.04e-03
2022-04-25 20:12:01,820 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.210[s] Speed: 76.4[samples/s]
2022-04-25 20:12:43,587 reid_baseline.train INFO: normal accuracy 0.2694300518134715 3.365926504135132 
2022-04-25 20:12:44,377 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 20:12:44,378 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 336.6%
2022-04-25 20:13:02,401 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.558, Base Lr: 4.44e-03
2022-04-25 20:13:12,287 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.182[s] Speed: 87.8[samples/s]
2022-04-25 20:13:52,989 reid_baseline.train INFO: normal accuracy 0.30412255012390177 3.161937952041626 
2022-04-25 20:13:53,786 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 20:13:53,786 reid_baseline.train INFO: Accuracy: 30.4% Mean Entropy: 316.2%
2022-04-25 20:14:13,800 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.088, Acc: 0.618, Base Lr: 4.83e-03
2022-04-25 20:14:23,673 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.194[s] Speed: 82.4[samples/s]
2022-04-25 20:15:04,359 reid_baseline.train INFO: normal accuracy 0.3167380040549673 3.1402981281280518 
2022-04-25 20:15:05,215 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 20:15:05,215 reid_baseline.train INFO: Accuracy: 31.7% Mean Entropy: 314.0%
2022-04-25 20:15:25,087 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.679, Base Lr: 5.23e-03
2022-04-25 20:15:34,947 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 20:16:15,157 reid_baseline.train INFO: normal accuracy 0.3593151610723136 2.9439194202423096 
2022-04-25 20:16:15,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 20:16:15,994 reid_baseline.train INFO: Accuracy: 35.9% Mean Entropy: 294.4%
2022-04-25 20:16:35,601 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.843, Acc: 0.687, Base Lr: 5.62e-03
2022-04-25 20:16:45,412 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 20:17:25,443 reid_baseline.train INFO: normal accuracy 0.3696778553728317 2.885982036590576 
2022-04-25 20:17:26,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 20:17:26,393 reid_baseline.train INFO: Accuracy: 37.0% Mean Entropy: 288.6%
2022-04-25 20:17:46,269 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.736, Acc: 0.727, Base Lr: 6.02e-03
2022-04-25 20:17:56,162 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-25 20:18:37,094 reid_baseline.train INFO: normal accuracy 0.36111736877675155 2.7686705589294434 
2022-04-25 20:18:38,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 20:18:38,680 reid_baseline.train INFO: Accuracy: 36.1% Mean Entropy: 276.9%
2022-04-25 20:18:57,210 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.626, Acc: 0.764, Base Lr: 6.42e-03
2022-04-25 20:19:06,992 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.186[s] Speed: 86.1[samples/s]
2022-04-25 20:19:47,695 reid_baseline.train INFO: normal accuracy 0.404370353683262 2.5981485843658447 
2022-04-25 20:19:48,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 20:19:48,743 reid_baseline.train INFO: Accuracy: 40.4% Mean Entropy: 259.8%
2022-04-25 20:20:08,721 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 20:20:18,532 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-25 20:20:59,073 reid_baseline.train INFO: normal accuracy 0.4178869114665465 2.4821290969848633 
2022-04-25 20:20:59,881 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 20:20:59,881 reid_baseline.train INFO: Accuracy: 41.8% Mean Entropy: 248.2%
2022-04-25 20:21:19,622 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.452, Acc: 0.824, Base Lr: 7.21e-03
2022-04-25 20:21:29,522 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.195[s] Speed: 82.2[samples/s]
2022-04-25 20:22:09,976 reid_baseline.train INFO: normal accuracy 0.41450777202072536 2.4497575759887695 
2022-04-25 20:22:10,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 20:22:10,745 reid_baseline.train INFO: Accuracy: 41.5% Mean Entropy: 245.0%
2022-04-25 20:22:30,173 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.388, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 20:22:39,979 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.192[s] Speed: 83.4[samples/s]
2022-04-25 20:23:21,006 reid_baseline.train INFO: normal accuracy 0.41315611624239695 2.496572971343994 
2022-04-25 20:23:21,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 20:23:21,009 reid_baseline.train INFO: Accuracy: 41.3% Mean Entropy: 249.7%
2022-04-25 20:23:41,098 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.277, Acc: 0.892, Base Lr: 4.01e-03
2022-04-25 20:23:51,159 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-25 20:24:31,963 reid_baseline.train INFO: normal accuracy 0.43095291732372154 2.329183578491211 
2022-04-25 20:24:32,735 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 20:24:32,735 reid_baseline.train INFO: Accuracy: 43.1% Mean Entropy: 232.9%
2022-04-25 20:24:53,327 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.237, Acc: 0.902, Base Lr: 3.69e-03
2022-04-25 20:25:03,148 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.200[s] Speed: 80.0[samples/s]
2022-04-25 20:25:44,063 reid_baseline.train INFO: normal accuracy 0.43951340391980176 2.2902932167053223 
2022-04-25 20:25:44,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 20:25:44,840 reid_baseline.train INFO: Accuracy: 44.0% Mean Entropy: 229.0%
2022-04-25 20:26:04,589 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.191, Acc: 0.925, Base Lr: 3.38e-03
2022-04-25 20:26:14,411 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.193[s] Speed: 82.7[samples/s]
2022-04-25 20:26:55,186 reid_baseline.train INFO: normal accuracy 0.433205676954269 2.345440626144409 
2022-04-25 20:26:55,188 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 20:26:55,189 reid_baseline.train INFO: Accuracy: 43.3% Mean Entropy: 234.5%
2022-04-25 20:27:15,023 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.166, Acc: 0.936, Base Lr: 3.08e-03
2022-04-25 20:27:24,800 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.195[s] Speed: 82.2[samples/s]
2022-04-25 20:28:05,218 reid_baseline.train INFO: normal accuracy 0.43635954043703534 2.3372485637664795 
2022-04-25 20:28:05,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 20:28:05,220 reid_baseline.train INFO: Accuracy: 43.6% Mean Entropy: 233.7%
2022-04-25 20:28:26,102 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.157, Acc: 0.926, Base Lr: 2.77e-03
2022-04-25 20:28:35,941 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.200[s] Speed: 80.0[samples/s]
2022-04-25 20:29:15,989 reid_baseline.train INFO: normal accuracy 0.4514530299617031 2.242614269256592 
2022-04-25 20:29:16,769 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 20:29:16,769 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 224.3%
2022-04-25 20:29:36,966 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.121, Acc: 0.948, Base Lr: 2.48e-03
2022-04-25 20:29:46,765 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.196[s] Speed: 81.4[samples/s]
2022-04-25 20:30:26,393 reid_baseline.train INFO: normal accuracy 0.4444694751070061 2.219156503677368 
2022-04-25 20:30:27,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 20:30:27,178 reid_baseline.train INFO: Accuracy: 44.4% Mean Entropy: 221.9%
2022-04-25 20:30:46,959 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.953, Base Lr: 2.20e-03
2022-04-25 20:30:56,819 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.194[s] Speed: 82.3[samples/s]
2022-04-25 20:31:36,401 reid_baseline.train INFO: normal accuracy 0.44582113088533454 2.2412824630737305 
2022-04-25 20:31:36,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 20:31:36,404 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 224.1%
2022-04-25 20:31:57,678 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.074, Acc: 0.953, Base Lr: 1.92e-03
2022-04-25 20:32:06,866 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.200[s] Speed: 79.9[samples/s]
2022-04-25 20:32:46,264 reid_baseline.train INFO: normal accuracy 0.44920027033115567 2.2143399715423584 
2022-04-25 20:32:48,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 20:32:48,277 reid_baseline.train INFO: Accuracy: 44.9% Mean Entropy: 221.4%
2022-04-25 20:33:08,631 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.061, Acc: 0.955, Base Lr: 1.66e-03
2022-04-25 20:33:17,693 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 20:33:57,542 reid_baseline.train INFO: normal accuracy 0.44920027033115567 2.209541082382202 
2022-04-25 20:33:58,324 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 20:33:58,324 reid_baseline.train INFO: Accuracy: 44.9% Mean Entropy: 221.0%
2022-04-25 20:34:19,848 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.036, Acc: 0.966, Base Lr: 1.42e-03
2022-04-25 20:34:29,610 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.204[s] Speed: 78.3[samples/s]
2022-04-25 20:35:09,439 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.161965847015381 
2022-04-25 20:35:10,223 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 20:35:10,224 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 216.2%
2022-04-25 20:35:31,151 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.040, Acc: 0.965, Base Lr: 1.19e-03
2022-04-25 20:35:40,959 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.201[s] Speed: 79.7[samples/s]
2022-04-25 20:36:21,002 reid_baseline.train INFO: normal accuracy 0.4573102050011264 2.24798846244812 
2022-04-25 20:36:21,004 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 20:36:21,004 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 224.8%
2022-04-25 20:36:41,838 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.023, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 20:36:51,476 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.200[s] Speed: 80.2[samples/s]
2022-04-25 20:37:31,224 reid_baseline.train INFO: normal accuracy 0.45595854922279794 2.211832284927368 
2022-04-25 20:37:31,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 20:37:31,226 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 221.2%
2022-04-25 20:37:52,814 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.017, Acc: 0.974, Base Lr: 7.78e-04
2022-04-25 20:38:01,868 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.201[s] Speed: 79.5[samples/s]
2022-04-25 20:38:41,942 reid_baseline.train INFO: normal accuracy 0.4586618607794548 2.213855743408203 
2022-04-25 20:38:41,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 20:38:41,944 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 221.4%
2022-04-25 20:39:04,054 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.969, Base Lr: 6.04e-04
2022-04-25 20:39:13,208 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-25 20:39:52,914 reid_baseline.train INFO: normal accuracy 0.4552827213336337 2.177783966064453 
2022-04-25 20:39:52,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 20:39:52,917 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 217.8%
2022-04-25 20:40:15,044 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 4.51e-04
2022-04-25 20:40:24,239 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.206[s] Speed: 77.7[samples/s]
2022-04-25 20:41:03,195 reid_baseline.train INFO: normal accuracy 0.4530299617030863 2.1841468811035156 
2022-04-25 20:41:03,197 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 20:41:03,197 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 218.4%
2022-04-25 20:41:26,019 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 3.20e-04
2022-04-25 20:41:35,077 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.208[s] Speed: 77.0[samples/s]
2022-04-25 20:42:14,977 reid_baseline.train INFO: normal accuracy 0.4573102050011264 2.2260899543762207 
2022-04-25 20:42:14,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 20:42:14,979 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 222.6%
2022-04-25 20:42:37,059 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.002, Acc: 0.975, Base Lr: 2.11e-04
2022-04-25 20:42:46,131 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.204[s] Speed: 78.4[samples/s]
2022-04-25 20:43:26,038 reid_baseline.train INFO: normal accuracy 0.45618382518585265 2.220123291015625 
2022-04-25 20:43:26,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 20:43:26,041 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 222.0%
2022-04-25 20:43:48,060 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.997, Acc: 0.969, Base Lr: 1.26e-04
2022-04-25 20:43:57,601 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-25 20:44:37,534 reid_baseline.train INFO: normal accuracy 0.45708492903807163 2.204730987548828 
2022-04-25 20:44:37,537 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 20:44:37,537 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 220.5%
2022-04-25 20:44:59,265 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.999, Acc: 0.977, Base Lr: 6.51e-05
2022-04-25 20:45:08,393 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.203[s] Speed: 79.0[samples/s]
2022-04-25 20:45:47,493 reid_baseline.train INFO: normal accuracy 0.45550799729668845 2.196239948272705 
2022-04-25 20:45:47,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 20:45:47,496 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 219.6%
2022-04-25 20:46:10,094 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.008, Acc: 0.973, Base Lr: 2.83e-05
2022-04-25 20:46:18,958 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.207[s] Speed: 77.4[samples/s]
2022-04-25 20:46:58,258 reid_baseline.train INFO: normal accuracy 0.453255237666141 2.1653332710266113 
2022-04-25 20:46:58,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 20:46:58,261 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 216.5%
2022-04-25 20:47:20,786 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.985, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 20:47:29,689 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.207[s] Speed: 77.5[samples/s]
2022-04-25 20:48:08,644 reid_baseline.train INFO: normal accuracy 0.4564091011489074 2.229243040084839 
2022-04-25 20:48:08,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 20:48:08,647 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 222.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 20:48:51,628 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.161965847015381 
2022-04-25 20:48:51,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:48:51,629 reid_baseline.train INFO: Accuracy: 45.1%
2022-04-25 20:49:32,684 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.161965847015381 
2022-04-25 20:49:32,684 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:49:32,684 reid_baseline.train INFO: Shuffled Accuracy: 45.1%
2022-04-25 20:49:56,414 reid_baseline.train INFO: normal accuracy 0.9728059332509271 1.1182137727737427 
2022-04-25 20:49:56,415 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:49:56,415 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-25 20:50:01,280 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_1
2022-04-25 20:50:01,280 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-25 20:50:01,281 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 20:50:01,281 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 20:50:01,281 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 20:50:15,362 reid_baseline.train INFO: start training
2022-04-25 20:50:40,356 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.099, Base Lr: 4.76e-04
2022-04-25 20:50:48,787 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.214[s] Speed: 74.9[samples/s]
2022-04-25 20:51:39,760 reid_baseline.train INFO: normal accuracy 0.17580904291944 4.172292232513428 
2022-04-25 20:51:40,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 20:51:40,514 reid_baseline.train INFO: Accuracy: 17.6% Mean Entropy: 417.2%
2022-04-25 20:51:59,491 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.035, Acc: 0.220, Base Lr: 8.72e-04
2022-04-25 20:52:10,864 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-25 20:53:00,521 reid_baseline.train INFO: normal accuracy 0.196694973605692 4.1634416580200195 
2022-04-25 20:53:01,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 20:53:01,362 reid_baseline.train INFO: Accuracy: 19.7% Mean Entropy: 416.3%
2022-04-25 20:53:16,058 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.847, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 20:53:25,462 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.158[s] Speed: 101.3[samples/s]
2022-04-25 20:54:18,797 reid_baseline.train INFO: normal accuracy 0.20197383520771173 4.12439489364624 
2022-04-25 20:54:19,663 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:54:19,663 reid_baseline.train INFO: Accuracy: 20.2% Mean Entropy: 412.4%
2022-04-25 20:54:35,902 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.608, Acc: 0.277, Base Lr: 1.66e-03
2022-04-25 20:54:44,077 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.160[s] Speed: 99.9[samples/s]
2022-04-25 20:55:36,908 reid_baseline.train INFO: normal accuracy 0.20702318108790452 4.027039527893066 
2022-04-25 20:55:37,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:55:37,722 reid_baseline.train INFO: Accuracy: 20.7% Mean Entropy: 402.7%
2022-04-25 20:55:55,678 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.416, Acc: 0.287, Base Lr: 2.06e-03
2022-04-25 20:56:02,924 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.165[s] Speed: 97.2[samples/s]
2022-04-25 20:56:59,857 reid_baseline.train INFO: normal accuracy 0.230204268992426 3.9284493923187256 
2022-04-25 20:57:00,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:57:00,711 reid_baseline.train INFO: Accuracy: 23.0% Mean Entropy: 392.8%
2022-04-25 20:57:19,306 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.184, Acc: 0.316, Base Lr: 2.46e-03
2022-04-25 20:57:26,470 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.169[s] Speed: 94.6[samples/s]
2022-04-25 20:58:23,140 reid_baseline.train INFO: normal accuracy 0.2575166398898325 3.739597797393799 
2022-04-25 20:58:23,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 20:58:23,993 reid_baseline.train INFO: Accuracy: 25.8% Mean Entropy: 374.0%
2022-04-25 20:58:44,053 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.975, Acc: 0.373, Base Lr: 2.85e-03
2022-04-25 20:58:50,080 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.170[s] Speed: 94.1[samples/s]
2022-04-25 20:59:45,313 reid_baseline.train INFO: normal accuracy 0.280468212072527 3.5658552646636963 
2022-04-25 20:59:46,198 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 20:59:46,198 reid_baseline.train INFO: Accuracy: 28.0% Mean Entropy: 356.6%
2022-04-25 21:00:06,084 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.778, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 21:00:12,058 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.168[s] Speed: 95.2[samples/s]
2022-04-25 21:01:06,899 reid_baseline.train INFO: normal accuracy 0.32568280927243515 3.4246904850006104 
2022-04-25 21:01:07,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 21:01:07,728 reid_baseline.train INFO: Accuracy: 32.6% Mean Entropy: 342.5%
2022-04-25 21:01:27,573 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.596, Acc: 0.463, Base Lr: 3.64e-03
2022-04-25 21:01:33,658 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.169[s] Speed: 94.6[samples/s]
2022-04-25 21:02:28,320 reid_baseline.train INFO: normal accuracy 0.35184760156070694 3.2181167602539062 
2022-04-25 21:02:29,133 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 21:02:29,134 reid_baseline.train INFO: Accuracy: 35.2% Mean Entropy: 321.8%
2022-04-25 21:02:49,782 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.414, Acc: 0.518, Base Lr: 4.04e-03
2022-04-25 21:02:57,728 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.186[s] Speed: 85.9[samples/s]
2022-04-25 21:03:49,990 reid_baseline.train INFO: normal accuracy 0.3913243057149415 3.063119888305664 
2022-04-25 21:03:50,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 21:03:50,902 reid_baseline.train INFO: Accuracy: 39.1% Mean Entropy: 306.3%
2022-04-25 21:04:10,902 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.558, Base Lr: 4.44e-03
2022-04-25 21:04:20,018 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 21:05:14,965 reid_baseline.train INFO: normal accuracy 0.42116134955244433 2.8484902381896973 
2022-04-25 21:05:15,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 21:05:15,849 reid_baseline.train INFO: Accuracy: 42.1% Mean Entropy: 284.8%
2022-04-25 21:05:36,418 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.088, Acc: 0.618, Base Lr: 4.83e-03
2022-04-25 21:05:44,995 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.191[s] Speed: 83.9[samples/s]
2022-04-25 21:06:41,295 reid_baseline.train INFO: normal accuracy 0.44526050034427356 2.767230987548828 
2022-04-25 21:06:42,391 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 21:06:42,391 reid_baseline.train INFO: Accuracy: 44.5% Mean Entropy: 276.7%
2022-04-25 21:07:02,586 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.679, Base Lr: 5.23e-03
2022-04-25 21:07:11,941 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.194[s] Speed: 82.4[samples/s]
2022-04-25 21:08:08,606 reid_baseline.train INFO: normal accuracy 0.47050722974523757 2.6086034774780273 
2022-04-25 21:08:09,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 21:08:09,400 reid_baseline.train INFO: Accuracy: 47.1% Mean Entropy: 260.9%
2022-04-25 21:08:29,245 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.843, Acc: 0.687, Base Lr: 5.62e-03
2022-04-25 21:08:39,059 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-25 21:09:33,829 reid_baseline.train INFO: normal accuracy 0.49093412898783567 2.526263475418091 
2022-04-25 21:09:34,619 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 21:09:34,620 reid_baseline.train INFO: Accuracy: 49.1% Mean Entropy: 252.6%
2022-04-25 21:09:54,474 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.736, Acc: 0.727, Base Lr: 6.02e-03
2022-04-25 21:10:04,326 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-25 21:11:00,072 reid_baseline.train INFO: normal accuracy 0.5017213679137021 2.412275552749634 
2022-04-25 21:11:00,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 21:11:00,908 reid_baseline.train INFO: Accuracy: 50.2% Mean Entropy: 241.2%
2022-04-25 21:11:20,681 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.626, Acc: 0.764, Base Lr: 6.42e-03
2022-04-25 21:11:30,514 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 21:12:28,377 reid_baseline.train INFO: normal accuracy 0.5267385815928392 2.3144001960754395 
2022-04-25 21:12:29,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 21:12:29,515 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 231.4%
2022-04-25 21:12:49,920 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 21:12:59,392 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 21:13:52,171 reid_baseline.train INFO: normal accuracy 0.5292632545329355 2.2288029193878174 
2022-04-25 21:13:53,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 21:13:53,273 reid_baseline.train INFO: Accuracy: 52.9% Mean Entropy: 222.9%
2022-04-25 21:14:13,925 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.452, Acc: 0.824, Base Lr: 7.21e-03
2022-04-25 21:14:22,633 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-25 21:15:16,795 reid_baseline.train INFO: normal accuracy 0.5375258205187056 2.1854732036590576 
2022-04-25 21:15:18,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 21:15:18,459 reid_baseline.train INFO: Accuracy: 53.8% Mean Entropy: 218.5%
2022-04-25 21:15:39,279 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.388, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 21:15:47,145 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.186[s] Speed: 86.0[samples/s]
2022-04-25 21:16:46,441 reid_baseline.train INFO: normal accuracy 0.5347716318567822 2.1936416625976562 
2022-04-25 21:16:46,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 21:16:46,442 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 219.4%
2022-04-25 21:17:06,951 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.277, Acc: 0.892, Base Lr: 4.01e-03
2022-04-25 21:17:14,628 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.183[s] Speed: 87.5[samples/s]
2022-04-25 21:18:10,482 reid_baseline.train INFO: normal accuracy 0.5490016066100528 2.058274507522583 
2022-04-25 21:18:11,545 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 21:18:11,545 reid_baseline.train INFO: Accuracy: 54.9% Mean Entropy: 205.8%
2022-04-25 21:18:32,288 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.237, Acc: 0.902, Base Lr: 3.69e-03
2022-04-25 21:18:39,520 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.184[s] Speed: 87.1[samples/s]
2022-04-25 21:19:31,682 reid_baseline.train INFO: normal accuracy 0.5563461097085151 2.0338122844696045 
2022-04-25 21:19:32,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 21:19:32,570 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 203.4%
2022-04-25 21:19:52,546 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.191, Acc: 0.925, Base Lr: 3.38e-03
2022-04-25 21:20:01,139 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.188[s] Speed: 85.3[samples/s]
2022-04-25 21:20:57,677 reid_baseline.train INFO: normal accuracy 0.5529033738811109 2.0637545585632324 
2022-04-25 21:20:57,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 21:20:57,678 reid_baseline.train INFO: Accuracy: 55.3% Mean Entropy: 206.4%
2022-04-25 21:21:18,639 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.166, Acc: 0.936, Base Lr: 3.08e-03
2022-04-25 21:21:27,206 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 21:22:22,737 reid_baseline.train INFO: normal accuracy 0.5602478769795731 2.0689399242401123 
2022-04-25 21:22:22,738 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 21:22:22,738 reid_baseline.train INFO: Accuracy: 56.0% Mean Entropy: 206.9%
2022-04-25 21:22:43,775 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.157, Acc: 0.926, Base Lr: 2.77e-03
2022-04-25 21:22:53,304 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-25 21:23:53,839 reid_baseline.train INFO: normal accuracy 0.5646086756942851 1.9954694509506226 
2022-04-25 21:23:54,787 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 21:23:54,787 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 199.5%
2022-04-25 21:24:15,455 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.121, Acc: 0.948, Base Lr: 2.48e-03
2022-04-25 21:24:24,516 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-25 21:25:20,046 reid_baseline.train INFO: normal accuracy 0.5634610970851504 1.9653578996658325 
2022-04-25 21:25:21,160 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 21:25:21,160 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 196.5%
2022-04-25 21:25:40,581 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.953, Base Lr: 2.20e-03
2022-04-25 21:25:50,450 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.192[s] Speed: 83.3[samples/s]
2022-04-25 21:26:50,616 reid_baseline.train INFO: normal accuracy 0.5623135184760156 1.9973270893096924 
2022-04-25 21:26:50,616 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 21:26:50,617 reid_baseline.train INFO: Accuracy: 56.2% Mean Entropy: 199.7%
2022-04-25 21:27:10,242 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.074, Acc: 0.953, Base Lr: 1.92e-03
2022-04-25 21:27:20,083 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.193[s] Speed: 82.7[samples/s]
2022-04-25 21:28:16,726 reid_baseline.train INFO: normal accuracy 0.5671333486343815 1.9855866432189941 
2022-04-25 21:28:16,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 21:28:16,728 reid_baseline.train INFO: Accuracy: 56.7% Mean Entropy: 198.6%
2022-04-25 21:28:35,975 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.061, Acc: 0.955, Base Lr: 1.66e-03
2022-04-25 21:28:45,849 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 21:29:47,716 reid_baseline.train INFO: normal accuracy 0.5678218957998623 1.991420865058899 
2022-04-25 21:29:47,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 21:29:47,716 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 199.1%
2022-04-25 21:30:06,916 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.036, Acc: 0.966, Base Lr: 1.42e-03
2022-04-25 21:30:16,750 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.191[s] Speed: 83.9[samples/s]
2022-04-25 21:31:17,896 reid_baseline.train INFO: normal accuracy 0.5717236630709204 1.9428648948669434 
2022-04-25 21:31:18,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 21:31:18,729 reid_baseline.train INFO: Accuracy: 57.2% Mean Entropy: 194.3%
2022-04-25 21:31:38,931 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.040, Acc: 0.965, Base Lr: 1.19e-03
2022-04-25 21:31:48,712 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 21:32:45,352 reid_baseline.train INFO: normal accuracy 0.5728712416800551 2.0260045528411865 
2022-04-25 21:32:45,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 21:32:45,352 reid_baseline.train INFO: Accuracy: 57.3% Mean Entropy: 202.6%
2022-04-25 21:33:05,903 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.023, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 21:33:15,817 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.200[s] Speed: 80.1[samples/s]
2022-04-25 21:34:13,567 reid_baseline.train INFO: normal accuracy 0.577461556116594 1.9964123964309692 
2022-04-25 21:34:13,568 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 21:34:13,568 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 199.6%
2022-04-25 21:34:33,901 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.017, Acc: 0.974, Base Lr: 7.78e-04
2022-04-25 21:34:43,858 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.198[s] Speed: 80.6[samples/s]
2022-04-25 21:35:45,987 reid_baseline.train INFO: normal accuracy 0.5767730089511132 1.993019700050354 
2022-04-25 21:35:45,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 21:35:45,988 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 199.3%
2022-04-25 21:36:06,584 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.969, Base Lr: 6.04e-04
2022-04-25 21:36:15,897 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.196[s] Speed: 81.5[samples/s]
2022-04-25 21:37:15,867 reid_baseline.train INFO: normal accuracy 0.5749368831764976 1.963578701019287 
2022-04-25 21:37:15,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 21:37:15,867 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 196.4%
2022-04-25 21:37:37,247 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 4.51e-04
2022-04-25 21:37:46,104 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.197[s] Speed: 81.2[samples/s]
2022-04-25 21:38:38,561 reid_baseline.train INFO: normal accuracy 0.5765434932292862 1.9709769487380981 
2022-04-25 21:38:38,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 21:38:38,562 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 197.1%
2022-04-25 21:38:58,711 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.000, Acc: 0.974, Base Lr: 3.20e-04
2022-04-25 21:39:07,641 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.191[s] Speed: 83.9[samples/s]
2022-04-25 21:40:10,319 reid_baseline.train INFO: normal accuracy 0.5776910718384209 2.0036377906799316 
2022-04-25 21:40:10,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 21:40:10,320 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 200.4%
2022-04-25 21:40:31,138 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.002, Acc: 0.975, Base Lr: 2.11e-04
2022-04-25 21:40:39,299 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.190[s] Speed: 84.1[samples/s]
2022-04-25 21:41:42,087 reid_baseline.train INFO: normal accuracy 0.5756254303419784 2.007092237472534 
2022-04-25 21:41:42,089 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 21:41:42,089 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 200.7%
2022-04-25 21:42:03,010 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.997, Acc: 0.969, Base Lr: 1.26e-04
2022-04-25 21:42:11,250 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.191[s] Speed: 83.6[samples/s]
2022-04-25 21:43:06,591 reid_baseline.train INFO: normal accuracy 0.5742483360110168 1.997520089149475 
2022-04-25 21:43:06,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 21:43:06,594 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 199.8%
2022-04-25 21:43:27,563 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.999, Acc: 0.977, Base Lr: 6.51e-05
2022-04-25 21:43:37,380 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-25 21:44:34,734 reid_baseline.train INFO: normal accuracy 0.5747073674546707 1.9913052320480347 
2022-04-25 21:44:34,735 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 21:44:34,735 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 199.1%
2022-04-25 21:44:55,356 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.008, Acc: 0.973, Base Lr: 2.83e-05
2022-04-25 21:45:04,372 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 21:46:10,891 reid_baseline.train INFO: normal accuracy 0.5735597888455359 1.9581341743469238 
2022-04-25 21:46:10,893 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 21:46:10,894 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 195.8%
2022-04-25 21:46:31,468 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.985, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 21:46:38,887 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.184[s] Speed: 87.1[samples/s]
2022-04-25 21:47:39,939 reid_baseline.train INFO: normal accuracy 0.5765434932292862 2.0185413360595703 
2022-04-25 21:47:39,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 21:47:39,942 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 201.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_1/transformer_best_model.pth
2022-04-25 21:48:42,311 reid_baseline.train INFO: normal accuracy 0.5717236630709204 1.9428648948669434 
2022-04-25 21:48:42,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:48:42,311 reid_baseline.train INFO: Accuracy: 57.2%
2022-04-25 21:49:32,908 reid_baseline.train INFO: normal accuracy 0.5717236630709204 1.9428648948669434 
2022-04-25 21:49:32,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:49:32,909 reid_baseline.train INFO: Shuffled Accuracy: 57.2%
2022-04-25 21:49:56,482 reid_baseline.train INFO: normal accuracy 0.9728059332509271 1.1182137727737427 
2022-04-25 21:49:56,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:49:56,483 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-25 21:50:03,202 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_2
2022-04-25 21:50:03,202 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-25 21:50:03,203 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 21:50:03,203 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 21:50:03,203 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 21:50:22,225 reid_baseline.train INFO: start training
2022-04-25 21:50:38,093 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.096, Base Lr: 4.76e-04
2022-04-25 21:50:48,073 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.166[s] Speed: 96.6[samples/s]
2022-04-25 21:51:22,300 reid_baseline.train INFO: normal accuracy 0.08980526918671249 4.172659397125244 
2022-04-25 21:51:23,124 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 21:51:23,125 reid_baseline.train INFO: Accuracy: 9.0% Mean Entropy: 417.3%
2022-04-25 21:51:43,783 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.034, Acc: 0.224, Base Lr: 8.72e-04
2022-04-25 21:51:52,391 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.192[s] Speed: 83.1[samples/s]
2022-04-25 21:52:28,631 reid_baseline.train INFO: normal accuracy 0.09507445589919816 4.166627407073975 
2022-04-25 21:52:29,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 21:52:29,506 reid_baseline.train INFO: Accuracy: 9.5% Mean Entropy: 416.7%
2022-04-25 21:52:43,836 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.241, Base Lr: 1.27e-03
2022-04-25 21:52:49,403 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.130[s] Speed: 122.8[samples/s]
2022-04-25 21:53:26,677 reid_baseline.train INFO: normal accuracy 0.09965635738831616 4.145781517028809 
2022-04-25 21:53:27,564 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 21:53:27,564 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 414.6%
2022-04-25 21:53:49,907 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.598, Acc: 0.271, Base Lr: 1.66e-03
2022-04-25 21:54:01,334 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.222[s] Speed: 72.1[samples/s]
2022-04-25 21:54:39,796 reid_baseline.train INFO: normal accuracy 0.09965635738831616 4.101430892944336 
2022-04-25 21:54:40,767 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 21:54:40,767 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 410.1%
2022-04-25 21:55:03,739 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.292, Base Lr: 2.06e-03
2022-04-25 21:55:14,839 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.223[s] Speed: 71.6[samples/s]
2022-04-25 21:55:52,711 reid_baseline.train INFO: normal accuracy 0.11271477663230241 4.0384039878845215 
2022-04-25 21:55:53,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 21:55:53,941 reid_baseline.train INFO: Accuracy: 11.3% Mean Entropy: 403.8%
2022-04-25 21:56:17,900 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.166, Acc: 0.325, Base Lr: 2.46e-03
2022-04-25 21:56:29,333 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.232[s] Speed: 68.8[samples/s]
2022-04-25 21:57:07,849 reid_baseline.train INFO: normal accuracy 0.12394043528064147 3.9439103603363037 
2022-04-25 21:57:09,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 21:57:09,515 reid_baseline.train INFO: Accuracy: 12.4% Mean Entropy: 394.4%
2022-04-25 21:57:32,924 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.369, Base Lr: 2.85e-03
2022-04-25 21:57:43,853 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.224[s] Speed: 71.3[samples/s]
2022-04-25 21:58:21,100 reid_baseline.train INFO: normal accuracy 0.13860252004581902 3.8549318313598633 
2022-04-25 21:58:22,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 21:58:22,354 reid_baseline.train INFO: Accuracy: 13.9% Mean Entropy: 385.5%
2022-04-25 21:58:46,403 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.761, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 21:58:56,802 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.225[s] Speed: 71.1[samples/s]
2022-04-25 21:59:34,972 reid_baseline.train INFO: normal accuracy 0.15624284077892325 3.7922422885894775 
2022-04-25 21:59:36,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 21:59:36,048 reid_baseline.train INFO: Accuracy: 15.6% Mean Entropy: 379.2%
2022-04-25 21:59:59,179 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.584, Acc: 0.474, Base Lr: 3.64e-03
2022-04-25 22:00:08,751 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-25 22:00:45,869 reid_baseline.train INFO: normal accuracy 0.1672394043528064 3.6913509368896484 
2022-04-25 22:00:47,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 22:00:47,032 reid_baseline.train INFO: Accuracy: 16.7% Mean Entropy: 369.1%
2022-04-25 22:01:10,462 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.395, Acc: 0.532, Base Lr: 4.04e-03
2022-04-25 22:01:20,003 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.216[s] Speed: 74.0[samples/s]
2022-04-25 22:01:58,156 reid_baseline.train INFO: normal accuracy 0.17869415807560138 3.582671880722046 
2022-04-25 22:01:58,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 22:01:58,953 reid_baseline.train INFO: Accuracy: 17.9% Mean Entropy: 358.3%
2022-04-25 22:02:22,038 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.249, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 22:02:31,962 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.216[s] Speed: 74.0[samples/s]
2022-04-25 22:03:10,534 reid_baseline.train INFO: normal accuracy 0.1986254295532646 3.481004238128662 
2022-04-25 22:03:12,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 22:03:12,586 reid_baseline.train INFO: Accuracy: 19.9% Mean Entropy: 348.1%
2022-04-25 22:03:35,662 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.077, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 22:03:43,718 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.202[s] Speed: 79.3[samples/s]
2022-04-25 22:04:22,818 reid_baseline.train INFO: normal accuracy 0.20618556701030927 3.4030914306640625 
2022-04-25 22:04:24,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 22:04:24,095 reid_baseline.train INFO: Accuracy: 20.6% Mean Entropy: 340.3%
2022-04-25 22:04:48,190 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.924, Acc: 0.684, Base Lr: 5.23e-03
2022-04-25 22:04:55,822 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.208[s] Speed: 77.0[samples/s]
2022-04-25 22:05:33,850 reid_baseline.train INFO: normal accuracy 0.21328751431844215 3.3268916606903076 
2022-04-25 22:05:34,632 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 22:05:34,632 reid_baseline.train INFO: Accuracy: 21.3% Mean Entropy: 332.7%
2022-04-25 22:05:57,509 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.820, Acc: 0.701, Base Lr: 5.62e-03
2022-04-25 22:06:06,083 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.206[s] Speed: 77.6[samples/s]
2022-04-25 22:06:43,464 reid_baseline.train INFO: normal accuracy 0.23573883161512027 3.2649149894714355 
2022-04-25 22:06:44,706 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 22:06:44,707 reid_baseline.train INFO: Accuracy: 23.6% Mean Entropy: 326.5%
2022-04-25 22:07:08,938 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.723, Acc: 0.726, Base Lr: 6.02e-03
2022-04-25 22:07:17,255 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.212[s] Speed: 75.4[samples/s]
2022-04-25 22:07:55,971 reid_baseline.train INFO: normal accuracy 0.22474226804123712 3.078418254852295 
2022-04-25 22:07:56,799 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 22:07:56,800 reid_baseline.train INFO: Accuracy: 22.5% Mean Entropy: 307.8%
2022-04-25 22:08:19,578 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.613, Acc: 0.770, Base Lr: 6.42e-03
2022-04-25 22:08:27,593 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.202[s] Speed: 79.2[samples/s]
2022-04-25 22:09:05,258 reid_baseline.train INFO: normal accuracy 0.24513172966781213 3.040863275527954 
2022-04-25 22:09:06,473 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 22:09:06,473 reid_baseline.train INFO: Accuracy: 24.5% Mean Entropy: 304.1%
2022-04-25 22:09:30,157 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.527, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 22:09:37,293 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.202[s] Speed: 79.2[samples/s]
2022-04-25 22:10:15,546 reid_baseline.train INFO: normal accuracy 0.24994272623138603 2.9397685527801514 
2022-04-25 22:10:16,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 22:10:16,399 reid_baseline.train INFO: Accuracy: 25.0% Mean Entropy: 294.0%
2022-04-25 22:10:39,131 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.453, Acc: 0.815, Base Lr: 7.21e-03
2022-04-25 22:10:47,410 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.203[s] Speed: 78.7[samples/s]
2022-04-25 22:11:24,716 reid_baseline.train INFO: normal accuracy 0.2588774341351661 2.87437105178833 
2022-04-25 22:11:26,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 22:11:26,012 reid_baseline.train INFO: Accuracy: 25.9% Mean Entropy: 287.4%
2022-04-25 22:11:49,357 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.386, Acc: 0.851, Base Lr: 7.60e-03
2022-04-25 22:11:58,059 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.209[s] Speed: 76.6[samples/s]
2022-04-25 22:12:36,806 reid_baseline.train INFO: normal accuracy 0.2558991981672394 2.817958116531372 
2022-04-25 22:12:37,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 22:12:37,619 reid_baseline.train INFO: Accuracy: 25.6% Mean Entropy: 281.8%
2022-04-25 22:13:00,751 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.275, Acc: 0.887, Base Lr: 4.01e-03
2022-04-25 22:13:09,219 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.206[s] Speed: 77.5[samples/s]
2022-04-25 22:13:46,726 reid_baseline.train INFO: normal accuracy 0.2547537227949599 2.7654759883880615 
2022-04-25 22:13:47,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 22:13:47,557 reid_baseline.train INFO: Accuracy: 25.5% Mean Entropy: 276.5%
2022-04-25 22:14:10,666 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.229, Acc: 0.902, Base Lr: 3.69e-03
2022-04-25 22:14:19,231 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.206[s] Speed: 77.5[samples/s]
2022-04-25 22:14:57,314 reid_baseline.train INFO: normal accuracy 0.24169530355097366 2.724691867828369 
2022-04-25 22:14:58,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 22:14:58,503 reid_baseline.train INFO: Accuracy: 24.2% Mean Entropy: 272.5%
2022-04-25 22:15:22,143 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.183, Acc: 0.923, Base Lr: 3.38e-03
2022-04-25 22:15:30,460 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.210[s] Speed: 76.3[samples/s]
2022-04-25 22:16:09,131 reid_baseline.train INFO: normal accuracy 0.27033218785796104 2.673926591873169 
2022-04-25 22:16:09,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 22:16:09,927 reid_baseline.train INFO: Accuracy: 27.0% Mean Entropy: 267.4%
2022-04-25 22:16:32,618 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.165, Acc: 0.925, Base Lr: 3.08e-03
2022-04-25 22:16:41,204 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.205[s] Speed: 78.2[samples/s]
2022-04-25 22:17:19,220 reid_baseline.train INFO: normal accuracy 0.2597938144329897 2.6928131580352783 
2022-04-25 22:17:19,222 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 22:17:19,222 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 269.3%
2022-04-25 22:17:43,113 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.153, Acc: 0.929, Base Lr: 2.77e-03
2022-04-25 22:17:51,220 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.208[s] Speed: 76.8[samples/s]
2022-04-25 22:18:30,297 reid_baseline.train INFO: normal accuracy 0.256815578465063 2.61618709564209 
2022-04-25 22:18:31,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 22:18:31,138 reid_baseline.train INFO: Accuracy: 25.7% Mean Entropy: 261.6%
2022-04-25 22:18:54,136 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.117, Acc: 0.939, Base Lr: 2.48e-03
2022-04-25 22:19:03,291 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.207[s] Speed: 77.3[samples/s]
2022-04-25 22:19:40,355 reid_baseline.train INFO: normal accuracy 0.26758304696449026 2.63173770904541 
2022-04-25 22:19:40,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 22:19:40,358 reid_baseline.train INFO: Accuracy: 26.8% Mean Entropy: 263.2%
2022-04-25 22:20:04,819 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.095, Acc: 0.948, Base Lr: 2.20e-03
2022-04-25 22:20:13,812 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.218[s] Speed: 73.4[samples/s]
2022-04-25 22:20:52,914 reid_baseline.train INFO: normal accuracy 0.2593356242840779 2.5967671871185303 
2022-04-25 22:20:53,802 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 22:20:53,802 reid_baseline.train INFO: Accuracy: 25.9% Mean Entropy: 259.7%
2022-04-25 22:21:16,336 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.071, Acc: 0.956, Base Lr: 1.92e-03
2022-04-25 22:21:24,663 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-25 22:22:02,375 reid_baseline.train INFO: normal accuracy 0.2620847651775487 2.5910017490386963 
2022-04-25 22:22:03,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 22:22:03,683 reid_baseline.train INFO: Accuracy: 26.2% Mean Entropy: 259.1%
2022-04-25 22:22:27,284 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.056, Acc: 0.960, Base Lr: 1.66e-03
2022-04-25 22:22:35,746 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.211[s] Speed: 76.0[samples/s]
2022-04-25 22:23:14,634 reid_baseline.train INFO: normal accuracy 0.2604810996563574 2.563828229904175 
2022-04-25 22:23:15,461 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 22:23:15,461 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 256.4%
2022-04-25 22:23:37,805 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.042, Acc: 0.962, Base Lr: 1.42e-03
2022-04-25 22:23:46,646 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.203[s] Speed: 78.8[samples/s]
2022-04-25 22:24:25,098 reid_baseline.train INFO: normal accuracy 0.2600229095074456 2.504406213760376 
2022-04-25 22:24:26,144 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 22:24:26,144 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 250.4%
2022-04-25 22:24:48,568 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.025, Acc: 0.968, Base Lr: 1.19e-03
2022-04-25 22:24:57,199 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.203[s] Speed: 78.7[samples/s]
2022-04-25 22:25:35,845 reid_baseline.train INFO: normal accuracy 0.2627720504009164 2.588771104812622 
2022-04-25 22:25:35,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 22:25:35,848 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 258.9%
2022-04-25 22:25:58,964 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.017, Acc: 0.976, Base Lr: 9.72e-04
2022-04-25 22:26:07,239 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-25 22:26:46,355 reid_baseline.train INFO: normal accuracy 0.26552119129438717 2.5532970428466797 
2022-04-25 22:26:46,357 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 22:26:46,357 reid_baseline.train INFO: Accuracy: 26.6% Mean Entropy: 255.3%
2022-04-25 22:27:09,388 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.013, Acc: 0.973, Base Lr: 7.78e-04
2022-04-25 22:27:18,018 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-25 22:27:56,165 reid_baseline.train INFO: normal accuracy 0.26804123711340205 2.5501160621643066 
2022-04-25 22:27:56,167 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 22:27:56,167 reid_baseline.train INFO: Accuracy: 26.8% Mean Entropy: 255.0%
2022-04-25 22:28:20,622 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.000, Acc: 0.977, Base Lr: 6.04e-04
2022-04-25 22:28:29,827 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.219[s] Speed: 73.1[samples/s]
2022-04-25 22:29:08,795 reid_baseline.train INFO: normal accuracy 0.26575028636884307 2.5252819061279297 
2022-04-25 22:29:08,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 22:29:08,798 reid_baseline.train INFO: Accuracy: 26.6% Mean Entropy: 252.5%
2022-04-25 22:29:31,196 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.994, Acc: 0.973, Base Lr: 4.51e-04
2022-04-25 22:29:40,267 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.207[s] Speed: 77.4[samples/s]
2022-04-25 22:30:18,539 reid_baseline.train INFO: normal accuracy 0.2650630011454754 2.520963191986084 
2022-04-25 22:30:18,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 22:30:18,541 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 252.1%
2022-04-25 22:30:42,338 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.002, Acc: 0.977, Base Lr: 3.20e-04
2022-04-25 22:30:51,037 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.213[s] Speed: 75.2[samples/s]
2022-04-25 22:31:30,071 reid_baseline.train INFO: normal accuracy 0.2611683848797251 2.537140130996704 
2022-04-25 22:31:30,071 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 22:31:30,071 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 253.7%
2022-04-25 22:31:52,427 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.003, Acc: 0.976, Base Lr: 2.11e-04
2022-04-25 22:32:01,270 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-25 22:32:38,051 reid_baseline.train INFO: normal accuracy 0.2627720504009164 2.5538008213043213 
2022-04-25 22:32:38,054 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 22:32:38,054 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 255.4%
2022-04-25 22:33:01,396 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.990, Acc: 0.979, Base Lr: 1.26e-04
2022-04-25 22:33:10,115 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.210[s] Speed: 76.1[samples/s]
2022-04-25 22:33:48,156 reid_baseline.train INFO: normal accuracy 0.2620847651775487 2.527918577194214 
2022-04-25 22:33:48,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 22:33:48,158 reid_baseline.train INFO: Accuracy: 26.2% Mean Entropy: 252.8%
2022-04-25 22:34:11,289 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.999, Acc: 0.977, Base Lr: 6.51e-05
2022-04-25 22:34:20,380 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-25 22:34:58,130 reid_baseline.train INFO: normal accuracy 0.2630011454753723 2.5392260551452637 
2022-04-25 22:34:58,132 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 22:34:58,133 reid_baseline.train INFO: Accuracy: 26.3% Mean Entropy: 253.9%
2022-04-25 22:35:22,000 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.002, Acc: 0.979, Base Lr: 2.83e-05
2022-04-25 22:35:31,223 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.217[s] Speed: 73.7[samples/s]
2022-04-25 22:36:09,273 reid_baseline.train INFO: normal accuracy 0.2620847651775487 2.5042037963867188 
2022-04-25 22:36:10,210 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 22:36:10,210 reid_baseline.train INFO: Accuracy: 26.2% Mean Entropy: 250.4%
2022-04-25 22:36:33,337 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.981, Acc: 0.979, Base Lr: 1.60e-05
2022-04-25 22:36:42,759 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.213[s] Speed: 75.2[samples/s]
2022-04-25 22:37:20,015 reid_baseline.train INFO: normal accuracy 0.2650630011454754 2.5663087368011475 
2022-04-25 22:37:20,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 22:37:20,017 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 256.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_2/transformer_best_model.pth
2022-04-25 22:38:03,081 reid_baseline.train INFO: normal accuracy 0.2620847651775487 2.5042037963867188 
2022-04-25 22:38:03,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:38:03,082 reid_baseline.train INFO: Accuracy: 26.2%
2022-04-25 22:38:42,235 reid_baseline.train INFO: normal accuracy 0.2620847651775487 2.5042037963867188 
2022-04-25 22:38:42,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:38:42,236 reid_baseline.train INFO: Shuffled Accuracy: 26.2%
2022-04-25 22:39:06,783 reid_baseline.train INFO: normal accuracy 0.9789864029666254 1.1043429374694824 
2022-04-25 22:39:06,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:39:06,784 reid_baseline.train INFO: Source Clean Accuracy: 97.9%
2022-04-25 22:39:13,463 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_2
2022-04-25 22:39:13,463 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-25 22:39:13,463 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 22:39:13,464 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 22:39:13,464 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 22:39:26,611 reid_baseline.train INFO: start training
2022-04-25 22:39:50,108 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.096, Base Lr: 4.76e-04
2022-04-25 22:39:58,584 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-25 22:40:41,964 reid_baseline.train INFO: normal accuracy 0.10723135841405722 4.172662258148193 
2022-04-25 22:40:43,211 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 22:40:43,211 reid_baseline.train INFO: Accuracy: 10.7% Mean Entropy: 417.3%
2022-04-25 22:41:06,467 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.034, Acc: 0.224, Base Lr: 8.72e-04
2022-04-25 22:41:16,454 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.219[s] Speed: 73.2[samples/s]
2022-04-25 22:41:51,942 reid_baseline.train INFO: normal accuracy 0.12300067582788916 4.166023254394531 
2022-04-25 22:41:52,741 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 22:41:52,741 reid_baseline.train INFO: Accuracy: 12.3% Mean Entropy: 416.6%
2022-04-25 22:42:05,740 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.241, Base Lr: 1.27e-03
2022-04-25 22:42:15,522 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.150[s] Speed: 106.8[samples/s]
2022-04-25 22:42:54,959 reid_baseline.train INFO: normal accuracy 0.11669294886235639 4.140530109405518 
2022-04-25 22:42:55,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 22:42:55,918 reid_baseline.train INFO: Accuracy: 11.7% Mean Entropy: 414.1%
2022-04-25 22:43:16,798 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.598, Acc: 0.271, Base Lr: 1.66e-03
2022-04-25 22:43:26,849 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.203[s] Speed: 78.8[samples/s]
2022-04-25 22:44:07,837 reid_baseline.train INFO: normal accuracy 0.12277539986483442 4.08040189743042 
2022-04-25 22:44:08,954 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 22:44:08,954 reid_baseline.train INFO: Accuracy: 12.3% Mean Entropy: 408.0%
2022-04-25 22:44:29,073 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.292, Base Lr: 2.06e-03
2022-04-25 22:44:38,996 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.196[s] Speed: 81.7[samples/s]
2022-04-25 22:45:18,898 reid_baseline.train INFO: normal accuracy 0.1380941653525569 4.009016990661621 
2022-04-25 22:45:20,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 22:45:20,141 reid_baseline.train INFO: Accuracy: 13.8% Mean Entropy: 400.9%
2022-04-25 22:45:40,908 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.166, Acc: 0.325, Base Lr: 2.46e-03
2022-04-25 22:45:50,704 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.200[s] Speed: 79.8[samples/s]
2022-04-25 22:46:32,205 reid_baseline.train INFO: normal accuracy 0.15544041450777202 3.879673480987549 
2022-04-25 22:46:32,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 22:46:32,997 reid_baseline.train INFO: Accuracy: 15.5% Mean Entropy: 388.0%
2022-04-25 22:46:52,578 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.369, Base Lr: 2.85e-03
2022-04-25 22:47:02,481 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 22:47:43,417 reid_baseline.train INFO: normal accuracy 0.17774273485019149 3.7585084438323975 
2022-04-25 22:47:44,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 22:47:44,264 reid_baseline.train INFO: Accuracy: 17.8% Mean Entropy: 375.9%
2022-04-25 22:48:03,757 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.761, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 22:48:13,631 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-25 22:48:55,360 reid_baseline.train INFO: normal accuracy 0.21784185627393557 3.6526355743408203 
2022-04-25 22:48:56,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 22:48:56,237 reid_baseline.train INFO: Accuracy: 21.8% Mean Entropy: 365.3%
2022-04-25 22:49:15,791 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.584, Acc: 0.474, Base Lr: 3.64e-03
2022-04-25 22:49:25,882 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.195[s] Speed: 82.1[samples/s]
2022-04-25 22:50:07,641 reid_baseline.train INFO: normal accuracy 0.25253435458436585 3.4883604049682617 
2022-04-25 22:50:08,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 22:50:08,664 reid_baseline.train INFO: Accuracy: 25.3% Mean Entropy: 348.8%
2022-04-25 22:50:26,715 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.395, Acc: 0.532, Base Lr: 4.04e-03
2022-04-25 22:50:36,611 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.183[s] Speed: 87.4[samples/s]
2022-04-25 22:51:16,945 reid_baseline.train INFO: normal accuracy 0.28294660959675605 3.352064847946167 
2022-04-25 22:51:18,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 22:51:18,042 reid_baseline.train INFO: Accuracy: 28.3% Mean Entropy: 335.2%
2022-04-25 22:51:38,721 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.249, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 22:51:48,633 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.198[s] Speed: 80.9[samples/s]
2022-04-25 22:52:30,379 reid_baseline.train INFO: normal accuracy 0.3185402117594053 3.190702438354492 
2022-04-25 22:52:31,210 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 22:52:31,210 reid_baseline.train INFO: Accuracy: 31.9% Mean Entropy: 319.1%
2022-04-25 22:52:50,162 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.077, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 22:53:00,027 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.189[s] Speed: 84.6[samples/s]
2022-04-25 22:53:41,141 reid_baseline.train INFO: normal accuracy 0.326650146429376 3.1089229583740234 
2022-04-25 22:53:42,036 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 22:53:42,037 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 310.9%
2022-04-25 22:54:01,097 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.924, Acc: 0.684, Base Lr: 5.23e-03
2022-04-25 22:54:11,049 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.190[s] Speed: 84.0[samples/s]
2022-04-25 22:54:53,114 reid_baseline.train INFO: normal accuracy 0.3541338139220545 3.0286149978637695 
2022-04-25 22:54:53,901 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 22:54:53,901 reid_baseline.train INFO: Accuracy: 35.4% Mean Entropy: 302.9%
2022-04-25 22:55:12,559 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.820, Acc: 0.701, Base Lr: 5.62e-03
2022-04-25 22:55:22,374 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.187[s] Speed: 85.5[samples/s]
2022-04-25 22:56:03,312 reid_baseline.train INFO: normal accuracy 0.3710295111511602 2.9356067180633545 
2022-04-25 22:56:04,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 22:56:04,117 reid_baseline.train INFO: Accuracy: 37.1% Mean Entropy: 293.6%
2022-04-25 22:56:23,766 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.723, Acc: 0.726, Base Lr: 6.02e-03
2022-04-25 22:56:33,645 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.192[s] Speed: 83.2[samples/s]
2022-04-25 22:57:15,039 reid_baseline.train INFO: normal accuracy 0.3800405496733499 2.6997621059417725 
2022-04-25 22:57:15,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 22:57:15,879 reid_baseline.train INFO: Accuracy: 38.0% Mean Entropy: 270.0%
2022-04-25 22:57:35,131 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.613, Acc: 0.770, Base Lr: 6.42e-03
2022-04-25 22:57:45,070 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.190[s] Speed: 84.0[samples/s]
2022-04-25 22:58:26,517 reid_baseline.train INFO: normal accuracy 0.40391980175715253 2.6265721321105957 
2022-04-25 22:58:27,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 22:58:27,347 reid_baseline.train INFO: Accuracy: 40.4% Mean Entropy: 262.7%
2022-04-25 22:58:46,392 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.527, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 22:58:56,267 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.190[s] Speed: 84.2[samples/s]
2022-04-25 22:59:38,162 reid_baseline.train INFO: normal accuracy 0.4219418788015319 2.525038242340088 
2022-04-25 22:59:38,950 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 22:59:38,950 reid_baseline.train INFO: Accuracy: 42.2% Mean Entropy: 252.5%
2022-04-25 22:59:57,308 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.453, Acc: 0.815, Base Lr: 7.21e-03
2022-04-25 23:00:07,179 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.185[s] Speed: 86.5[samples/s]
2022-04-25 23:00:48,478 reid_baseline.train INFO: normal accuracy 0.42396936246902456 2.5195364952087402 
2022-04-25 23:00:49,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 23:00:49,571 reid_baseline.train INFO: Accuracy: 42.4% Mean Entropy: 252.0%
2022-04-25 23:01:08,326 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.386, Acc: 0.851, Base Lr: 7.60e-03
2022-04-25 23:01:18,164 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.188[s] Speed: 85.1[samples/s]
2022-04-25 23:01:59,235 reid_baseline.train INFO: normal accuracy 0.4129308402793422 2.5121688842773438 
2022-04-25 23:02:00,293 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 23:02:00,293 reid_baseline.train INFO: Accuracy: 41.3% Mean Entropy: 251.2%
2022-04-25 23:02:20,300 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.275, Acc: 0.887, Base Lr: 4.01e-03
2022-04-25 23:02:30,106 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.196[s] Speed: 81.7[samples/s]
2022-04-25 23:03:10,624 reid_baseline.train INFO: normal accuracy 0.4354584365848164 2.3855135440826416 
2022-04-25 23:03:12,086 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 23:03:12,086 reid_baseline.train INFO: Accuracy: 43.5% Mean Entropy: 238.6%
2022-04-25 23:03:30,673 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.229, Acc: 0.902, Base Lr: 3.69e-03
2022-04-25 23:03:40,590 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.187[s] Speed: 85.8[samples/s]
2022-04-25 23:04:21,481 reid_baseline.train INFO: normal accuracy 0.4365848164000901 2.392261266708374 
2022-04-25 23:04:21,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 23:04:21,484 reid_baseline.train INFO: Accuracy: 43.7% Mean Entropy: 239.2%
2022-04-25 23:04:40,988 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.183, Acc: 0.923, Base Lr: 3.38e-03
2022-04-25 23:04:50,889 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 23:05:31,053 reid_baseline.train INFO: normal accuracy 0.4489749943681009 2.3403267860412598 
2022-04-25 23:05:31,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 23:05:31,906 reid_baseline.train INFO: Accuracy: 44.9% Mean Entropy: 234.0%
2022-04-25 23:05:50,967 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.165, Acc: 0.925, Base Lr: 3.08e-03
2022-04-25 23:06:00,823 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.190[s] Speed: 84.4[samples/s]
2022-04-25 23:06:42,193 reid_baseline.train INFO: normal accuracy 0.4379364721784186 2.3455958366394043 
2022-04-25 23:06:42,195 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 23:06:42,195 reid_baseline.train INFO: Accuracy: 43.8% Mean Entropy: 234.6%
2022-04-25 23:07:02,396 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.153, Acc: 0.929, Base Lr: 2.77e-03
2022-04-25 23:07:12,203 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.196[s] Speed: 81.6[samples/s]
2022-04-25 23:07:52,198 reid_baseline.train INFO: normal accuracy 0.45415634151836 2.278181791305542 
2022-04-25 23:07:52,991 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 23:07:52,991 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 227.8%
2022-04-25 23:08:13,070 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.117, Acc: 0.939, Base Lr: 2.48e-03
2022-04-25 23:08:23,005 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-25 23:09:03,543 reid_baseline.train INFO: normal accuracy 0.43996395584591125 2.323469877243042 
2022-04-25 23:09:03,546 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 23:09:03,546 reid_baseline.train INFO: Accuracy: 44.0% Mean Entropy: 232.3%
2022-04-25 23:09:23,857 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.095, Acc: 0.948, Base Lr: 2.20e-03
2022-04-25 23:09:33,673 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.196[s] Speed: 81.4[samples/s]
2022-04-25 23:10:13,038 reid_baseline.train INFO: normal accuracy 0.44604640684838925 2.264575958251953 
2022-04-25 23:10:13,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 23:10:13,828 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 226.5%
2022-04-25 23:10:34,007 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.071, Acc: 0.956, Base Lr: 1.92e-03
2022-04-25 23:10:42,843 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.191[s] Speed: 84.0[samples/s]
2022-04-25 23:11:22,282 reid_baseline.train INFO: normal accuracy 0.448073890515882 2.247116804122925 
2022-04-25 23:11:23,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 23:11:23,069 reid_baseline.train INFO: Accuracy: 44.8% Mean Entropy: 224.7%
2022-04-25 23:11:45,003 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.056, Acc: 0.960, Base Lr: 1.66e-03
2022-04-25 23:11:53,009 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-25 23:12:32,016 reid_baseline.train INFO: normal accuracy 0.4537057895922505 2.2228758335113525 
2022-04-25 23:12:32,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 23:12:32,916 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 222.3%
2022-04-25 23:12:55,803 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.042, Acc: 0.962, Base Lr: 1.42e-03
2022-04-25 23:13:03,885 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.203[s] Speed: 78.9[samples/s]
2022-04-25 23:13:43,392 reid_baseline.train INFO: normal accuracy 0.4546068934444695 2.161890983581543 
2022-04-25 23:13:44,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 23:13:44,166 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 216.2%
2022-04-25 23:14:06,607 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.025, Acc: 0.968, Base Lr: 1.19e-03
2022-04-25 23:14:15,724 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.207[s] Speed: 77.1[samples/s]
2022-04-25 23:14:55,493 reid_baseline.train INFO: normal accuracy 0.45055192610948414 2.248385190963745 
2022-04-25 23:14:55,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 23:14:55,496 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 224.8%
2022-04-25 23:15:18,123 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.017, Acc: 0.976, Base Lr: 9.72e-04
2022-04-25 23:15:26,108 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.201[s] Speed: 79.5[samples/s]
2022-04-25 23:16:05,115 reid_baseline.train INFO: normal accuracy 0.4573102050011264 2.21793794631958 
2022-04-25 23:16:05,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 23:16:05,118 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 221.8%
2022-04-25 23:16:27,960 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.013, Acc: 0.973, Base Lr: 7.78e-04
2022-04-25 23:16:36,511 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.206[s] Speed: 77.7[samples/s]
2022-04-25 23:17:16,376 reid_baseline.train INFO: normal accuracy 0.4584365848164001 2.2180211544036865 
2022-04-25 23:17:16,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 23:17:16,378 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 221.8%
2022-04-25 23:17:39,056 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.000, Acc: 0.977, Base Lr: 6.04e-04
2022-04-25 23:17:48,116 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-25 23:18:27,283 reid_baseline.train INFO: normal accuracy 0.4552827213336337 2.182805299758911 
2022-04-25 23:18:27,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 23:18:27,286 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 218.3%
2022-04-25 23:18:49,747 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.994, Acc: 0.973, Base Lr: 4.51e-04
2022-04-25 23:18:58,893 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.207[s] Speed: 77.4[samples/s]
2022-04-25 23:19:37,630 reid_baseline.train INFO: normal accuracy 0.45077720207253885 2.2004764080047607 
2022-04-25 23:19:37,632 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 23:19:37,633 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 220.0%
2022-04-25 23:20:00,482 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.002, Acc: 0.977, Base Lr: 3.20e-04
2022-04-25 23:20:09,718 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-25 23:20:49,063 reid_baseline.train INFO: normal accuracy 0.4564091011489074 2.223959445953369 
2022-04-25 23:20:49,065 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 23:20:49,065 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 222.4%
2022-04-25 23:21:11,940 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.003, Acc: 0.976, Base Lr: 2.11e-04
2022-04-25 23:21:21,220 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.210[s] Speed: 76.2[samples/s]
2022-04-25 23:22:00,052 reid_baseline.train INFO: normal accuracy 0.4579860328902906 2.2406110763549805 
2022-04-25 23:22:00,054 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 23:22:00,054 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 224.1%
2022-04-25 23:22:22,871 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.990, Acc: 0.979, Base Lr: 1.26e-04
2022-04-25 23:22:31,924 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.207[s] Speed: 77.3[samples/s]
2022-04-25 23:23:10,915 reid_baseline.train INFO: normal accuracy 0.45663437711196214 2.21035099029541 
2022-04-25 23:23:10,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 23:23:10,917 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 221.0%
2022-04-25 23:23:34,211 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.999, Acc: 0.977, Base Lr: 6.51e-05
2022-04-25 23:23:43,228 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.209[s] Speed: 76.4[samples/s]
2022-04-25 23:24:22,559 reid_baseline.train INFO: normal accuracy 0.45663437711196214 2.208357095718384 
2022-04-25 23:24:22,562 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 23:24:22,562 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 220.8%
2022-04-25 23:24:45,119 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.002, Acc: 0.979, Base Lr: 2.83e-05
2022-04-25 23:24:54,229 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.207[s] Speed: 77.3[samples/s]
2022-04-25 23:25:34,295 reid_baseline.train INFO: normal accuracy 0.4514530299617031 2.1825454235076904 
2022-04-25 23:25:34,298 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 23:25:34,298 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 218.3%
2022-04-25 23:25:57,379 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.981, Acc: 0.979, Base Lr: 1.60e-05
2022-04-25 23:26:06,501 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.209[s] Speed: 76.5[samples/s]
2022-04-25 23:26:45,695 reid_baseline.train INFO: normal accuracy 0.45708492903807163 2.2443482875823975 
2022-04-25 23:26:45,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 23:26:45,697 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 224.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_2/transformer_best_model.pth
2022-04-25 23:27:28,270 reid_baseline.train INFO: normal accuracy 0.4546068934444695 2.161890983581543 
2022-04-25 23:27:28,271 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:27:28,271 reid_baseline.train INFO: Accuracy: 45.5%
2022-04-25 23:28:09,022 reid_baseline.train INFO: normal accuracy 0.4546068934444695 2.161890983581543 
2022-04-25 23:28:09,022 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:28:09,022 reid_baseline.train INFO: Shuffled Accuracy: 45.5%
2022-04-25 23:28:33,695 reid_baseline.train INFO: normal accuracy 0.9736299958796869 1.1301828622817993 
2022-04-25 23:28:33,695 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:28:33,696 reid_baseline.train INFO: Source Clean Accuracy: 97.4%
2022-04-25 23:28:38,836 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_2
2022-04-25 23:28:38,836 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-25 23:28:38,836 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 23:28:38,836 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 23:28:38,836 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 23:28:51,010 reid_baseline.train INFO: start training
2022-04-25 23:29:14,532 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.096, Base Lr: 4.76e-04
2022-04-25 23:29:22,658 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-25 23:30:17,847 reid_baseline.train INFO: normal accuracy 0.17718613725040167 4.172281742095947 
2022-04-25 23:30:18,649 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 23:30:18,649 reid_baseline.train INFO: Accuracy: 17.7% Mean Entropy: 417.2%
2022-04-25 23:30:36,816 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.034, Acc: 0.224, Base Lr: 8.72e-04
2022-04-25 23:30:48,000 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 23:31:37,625 reid_baseline.train INFO: normal accuracy 0.19554739499655727 4.163049221038818 
2022-04-25 23:31:38,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 23:31:38,481 reid_baseline.train INFO: Accuracy: 19.6% Mean Entropy: 416.3%
2022-04-25 23:31:57,959 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.241, Base Lr: 1.27e-03
2022-04-25 23:32:07,694 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.192[s] Speed: 83.5[samples/s]
2022-04-25 23:32:57,511 reid_baseline.train INFO: normal accuracy 0.1983015836584806 4.12251615524292 
2022-04-25 23:32:58,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 23:32:58,309 reid_baseline.train INFO: Accuracy: 19.8% Mean Entropy: 412.3%
2022-04-25 23:33:13,349 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.598, Acc: 0.271, Base Lr: 1.66e-03
2022-04-25 23:33:24,539 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.172[s] Speed: 93.3[samples/s]
2022-04-25 23:34:15,669 reid_baseline.train INFO: normal accuracy 0.2095478540280009 4.024598598480225 
2022-04-25 23:34:16,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 23:34:16,494 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 402.5%
2022-04-25 23:34:31,345 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.292, Base Lr: 2.06e-03
2022-04-25 23:34:40,441 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.156[s] Speed: 102.5[samples/s]
2022-04-25 23:35:31,169 reid_baseline.train INFO: normal accuracy 0.23135184760156072 3.9171462059020996 
2022-04-25 23:35:32,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 23:35:32,168 reid_baseline.train INFO: Accuracy: 23.1% Mean Entropy: 391.7%
2022-04-25 23:35:47,591 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.166, Acc: 0.325, Base Lr: 2.46e-03
2022-04-25 23:35:56,943 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.162[s] Speed: 98.9[samples/s]
2022-04-25 23:36:50,630 reid_baseline.train INFO: normal accuracy 0.24902455818223548 3.720794916152954 
2022-04-25 23:36:51,457 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 23:36:51,458 reid_baseline.train INFO: Accuracy: 24.9% Mean Entropy: 372.1%
2022-04-25 23:37:07,969 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.369, Base Lr: 2.85e-03
2022-04-25 23:37:16,109 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.161[s] Speed: 99.3[samples/s]
2022-04-25 23:38:07,654 reid_baseline.train INFO: normal accuracy 0.2896488409456048 3.564544439315796 
2022-04-25 23:38:08,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 23:38:08,443 reid_baseline.train INFO: Accuracy: 29.0% Mean Entropy: 356.5%
2022-04-25 23:38:28,170 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.761, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 23:38:33,957 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.167[s] Speed: 95.7[samples/s]
2022-04-25 23:39:33,564 reid_baseline.train INFO: normal accuracy 0.3268303878815699 3.425706148147583 
2022-04-25 23:39:34,484 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 23:39:34,485 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 342.6%
2022-04-25 23:39:54,657 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.584, Acc: 0.474, Base Lr: 3.64e-03
2022-04-25 23:40:00,344 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.170[s] Speed: 94.3[samples/s]
2022-04-25 23:40:57,982 reid_baseline.train INFO: normal accuracy 0.3591921046591692 3.2199742794036865 
2022-04-25 23:40:58,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 23:40:58,809 reid_baseline.train INFO: Accuracy: 35.9% Mean Entropy: 322.0%
2022-04-25 23:41:18,746 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.395, Acc: 0.532, Base Lr: 4.04e-03
2022-04-25 23:41:24,904 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.171[s] Speed: 93.3[samples/s]
2022-04-25 23:42:18,506 reid_baseline.train INFO: normal accuracy 0.3904062428276337 3.0453155040740967 
2022-04-25 23:42:19,397 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 23:42:19,397 reid_baseline.train INFO: Accuracy: 39.0% Mean Entropy: 304.5%
2022-04-25 23:42:40,475 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.249, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 23:42:48,928 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 23:43:43,306 reid_baseline.train INFO: normal accuracy 0.4305714941473491 2.8700568675994873 
2022-04-25 23:43:44,159 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 23:43:44,160 reid_baseline.train INFO: Accuracy: 43.1% Mean Entropy: 287.0%
2022-04-25 23:44:04,164 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.077, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 23:44:12,471 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.185[s] Speed: 86.5[samples/s]
2022-04-25 23:45:18,478 reid_baseline.train INFO: normal accuracy 0.4523754877209089 2.729682445526123 
2022-04-25 23:45:19,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 23:45:19,714 reid_baseline.train INFO: Accuracy: 45.2% Mean Entropy: 273.0%
2022-04-25 23:45:50,165 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.924, Acc: 0.684, Base Lr: 5.23e-03
2022-04-25 23:46:04,985 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.297[s] Speed: 53.8[samples/s]
2022-04-25 23:47:25,204 reid_baseline.train INFO: normal accuracy 0.468671103970622 2.6400067806243896 
2022-04-25 23:47:26,749 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 23:47:26,749 reid_baseline.train INFO: Accuracy: 46.9% Mean Entropy: 264.0%
2022-04-25 23:48:00,772 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.820, Acc: 0.701, Base Lr: 5.62e-03
2022-04-25 23:48:16,111 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.324[s] Speed: 49.4[samples/s]
2022-04-25 23:49:37,200 reid_baseline.train INFO: normal accuracy 0.49552444342437457 2.535757303237915 
2022-04-25 23:49:38,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 23:49:38,475 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 253.6%
2022-04-25 23:50:12,256 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.723, Acc: 0.726, Base Lr: 6.02e-03
2022-04-25 23:50:27,786 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-25 23:51:51,918 reid_baseline.train INFO: normal accuracy 0.5042460408537985 2.3631622791290283 
2022-04-25 23:51:53,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 23:51:53,094 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 236.3%
2022-04-25 23:52:23,097 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.613, Acc: 0.770, Base Lr: 6.42e-03
2022-04-25 23:52:38,473 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.298[s] Speed: 53.6[samples/s]
2022-04-25 23:53:59,195 reid_baseline.train INFO: normal accuracy 0.5310993803075511 2.299006938934326 
2022-04-25 23:54:00,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 23:54:00,419 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 229.9%
2022-04-25 23:54:33,138 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.527, Acc: 0.792, Base Lr: 6.81e-03
2022-04-25 23:54:45,469 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.296[s] Speed: 54.0[samples/s]
2022-04-25 23:56:05,112 reid_baseline.train INFO: normal accuracy 0.5384438834060133 2.216252088546753 
2022-04-25 23:56:06,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 23:56:06,451 reid_baseline.train INFO: Accuracy: 53.8% Mean Entropy: 221.6%
2022-04-25 23:56:40,364 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.453, Acc: 0.815, Base Lr: 7.21e-03
2022-04-25 23:56:55,461 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-25 23:58:16,572 reid_baseline.train INFO: normal accuracy 0.5432637135643792 2.188422441482544 
2022-04-25 23:58:17,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 23:58:17,776 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 218.8%
2022-04-25 23:58:49,857 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.386, Acc: 0.851, Base Lr: 7.60e-03
2022-04-25 23:59:03,754 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.302[s] Speed: 53.0[samples/s]
2022-04-26 00:00:26,709 reid_baseline.train INFO: normal accuracy 0.5377553362405325 2.1748342514038086 
2022-04-26 00:00:27,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 00:00:28,000 reid_baseline.train INFO: Accuracy: 53.8% Mean Entropy: 217.5%
2022-04-26 00:00:59,882 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.275, Acc: 0.887, Base Lr: 4.01e-03
2022-04-26 00:01:14,983 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.309[s] Speed: 51.8[samples/s]
2022-04-26 00:02:29,030 reid_baseline.train INFO: normal accuracy 0.5561165939866881 2.0797150135040283 
2022-04-26 00:02:30,298 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 00:02:30,299 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 208.0%
2022-04-26 00:03:03,627 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.229, Acc: 0.902, Base Lr: 3.69e-03
2022-04-26 00:03:19,630 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-26 00:04:39,600 reid_baseline.train INFO: normal accuracy 0.5584117512049576 2.0708413124084473 
2022-04-26 00:04:40,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 00:04:40,822 reid_baseline.train INFO: Accuracy: 55.8% Mean Entropy: 207.1%
2022-04-26 00:05:11,940 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.183, Acc: 0.923, Base Lr: 3.38e-03
2022-04-26 00:05:27,857 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-26 00:06:52,173 reid_baseline.train INFO: normal accuracy 0.5643791599724581 2.036689281463623 
2022-04-26 00:06:54,534 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 00:06:54,535 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 203.7%
2022-04-26 00:07:29,717 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.165, Acc: 0.925, Base Lr: 3.08e-03
2022-04-26 00:07:43,978 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-26 00:09:12,032 reid_baseline.train INFO: normal accuracy 0.5662152857470737 2.0612893104553223 
2022-04-26 00:09:12,039 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 00:09:12,039 reid_baseline.train INFO: Accuracy: 56.6% Mean Entropy: 206.1%
2022-04-26 00:09:45,450 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.153, Acc: 0.929, Base Lr: 2.77e-03
2022-04-26 00:09:58,971 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.309[s] Speed: 51.8[samples/s]
2022-04-26 00:11:18,106 reid_baseline.train INFO: normal accuracy 0.5678218957998623 2.00065541267395 
2022-04-26 00:11:19,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 00:11:19,371 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 200.1%
2022-04-26 00:11:53,884 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.117, Acc: 0.939, Base Lr: 2.48e-03
2022-04-26 00:12:09,427 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-26 00:13:31,950 reid_baseline.train INFO: normal accuracy 0.5641496442506312 2.022385597229004 
2022-04-26 00:13:31,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 00:13:31,952 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 202.2%
2022-04-26 00:14:04,321 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.095, Acc: 0.948, Base Lr: 2.20e-03
2022-04-26 00:14:19,921 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.315[s] Speed: 50.7[samples/s]
2022-04-26 00:15:36,798 reid_baseline.train INFO: normal accuracy 0.5659857700252467 2.001220226287842 
2022-04-26 00:15:36,803 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 00:15:36,803 reid_baseline.train INFO: Accuracy: 56.6% Mean Entropy: 200.1%
2022-04-26 00:16:11,112 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.071, Acc: 0.956, Base Lr: 1.92e-03
2022-04-26 00:16:28,223 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-26 00:16:54,159 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_3
2022-04-26 00:16:54,159 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 00:16:54,159 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:16:54,159 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:16:54,160 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:17:10,584 reid_baseline.train INFO: start training
2022-04-26 00:17:42,663 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.105, Base Lr: 4.76e-04
2022-04-26 00:17:59,041 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.315[s] Speed: 50.9[samples/s]
2022-04-26 00:19:01,523 reid_baseline.train INFO: normal accuracy 0.0833906071019473 4.172622203826904 
2022-04-26 00:19:04,031 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:19:04,032 reid_baseline.train INFO: Accuracy: 8.3% Mean Entropy: 417.3%
2022-04-26 00:19:37,416 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.031, Acc: 0.225, Base Lr: 8.72e-04
2022-04-26 00:19:54,656 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-26 00:20:08,593 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_3
2022-04-26 00:20:08,593 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 00:20:08,593 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:20:08,593 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:20:08,594 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:20:24,057 reid_baseline.train INFO: start training
2022-04-26 00:20:58,347 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.105, Base Lr: 4.76e-04
2022-04-26 00:21:14,271 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-26 00:21:29,864 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_3
2022-04-26 00:21:29,864 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-26 00:21:29,865 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:21:29,865 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:21:29,865 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:21:45,346 reid_baseline.train INFO: start training
2022-04-26 00:22:21,686 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.105, Base Lr: 4.76e-04
2022-04-26 00:22:36,245 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-26 00:23:47,721 reid_baseline.train INFO: normal accuracy 0.17351388570117052 4.1722259521484375 
2022-04-26 00:23:48,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:23:48,859 reid_baseline.train INFO: Accuracy: 17.4% Mean Entropy: 417.2%
2022-04-26 00:24:23,385 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.031, Acc: 0.225, Base Lr: 8.72e-04
2022-04-26 00:24:40,612 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
