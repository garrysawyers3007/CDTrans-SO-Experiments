2022-04-25 18:56:32,391 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_4
2022-04-25 18:56:32,391 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 18:56:32,391 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 18:56:32,392 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 18:56:32,392 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 18:56:45,082 reid_baseline.train INFO: start training
2022-04-25 18:57:07,920 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.085, Base Lr: 4.76e-04
2022-04-25 18:57:32,612 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.122, Base Lr: 4.76e-04
2022-04-25 18:57:49,590 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.235[s] Speed: 68.0[samples/s]
2022-04-25 18:58:20,813 reid_baseline.train INFO: normal accuracy 0.09394313967861558 4.1685357093811035 
2022-04-25 18:58:22,359 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 18:58:22,360 reid_baseline.train INFO: Accuracy: 9.4% Mean Entropy: 416.9%
2022-04-25 18:58:46,533 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.961, Acc: 0.209, Base Lr: 8.72e-04
2022-04-25 18:59:09,909 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.907, Acc: 0.213, Base Lr: 8.72e-04
2022-04-25 18:59:27,967 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-25 18:59:57,475 reid_baseline.train INFO: normal accuracy 0.09971157807993407 4.12928581237793 
2022-04-25 18:59:59,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 18:59:59,421 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 412.9%
2022-04-25 19:00:22,060 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.685, Acc: 0.216, Base Lr: 1.27e-03
2022-04-25 19:00:45,952 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.629, Acc: 0.225, Base Lr: 1.27e-03
2022-04-25 19:01:03,613 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.235[s] Speed: 68.1[samples/s]
2022-04-25 19:01:35,111 reid_baseline.train INFO: normal accuracy 0.12319736299958797 4.024605751037598 
2022-04-25 19:01:36,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 19:01:36,176 reid_baseline.train INFO: Accuracy: 12.3% Mean Entropy: 402.5%
2022-04-25 19:01:57,911 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.329, Acc: 0.297, Base Lr: 1.66e-03
2022-04-25 19:02:21,216 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.315, Acc: 0.292, Base Lr: 1.66e-03
2022-04-25 19:02:38,760 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.229[s] Speed: 69.8[samples/s]
2022-04-25 19:03:09,973 reid_baseline.train INFO: normal accuracy 0.15492377420683973 3.8580660820007324 
2022-04-25 19:03:11,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 19:03:11,126 reid_baseline.train INFO: Accuracy: 15.5% Mean Entropy: 385.8%
2022-04-25 19:03:32,746 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.094, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 19:03:57,569 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.033, Acc: 0.357, Base Lr: 2.06e-03
2022-04-25 19:04:15,999 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.238[s] Speed: 67.4[samples/s]
2022-04-25 19:04:47,519 reid_baseline.train INFO: normal accuracy 0.17717346518335395 3.7046637535095215 
2022-04-25 19:04:48,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 19:04:48,435 reid_baseline.train INFO: Accuracy: 17.7% Mean Entropy: 370.5%
2022-04-25 19:05:12,032 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.840, Acc: 0.412, Base Lr: 2.46e-03
2022-04-25 19:05:35,018 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.799, Acc: 0.414, Base Lr: 2.46e-03
2022-04-25 19:05:52,819 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.236[s] Speed: 67.8[samples/s]
2022-04-25 19:06:22,546 reid_baseline.train INFO: normal accuracy 0.21343222084878452 3.567227840423584 
2022-04-25 19:06:23,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 19:06:23,587 reid_baseline.train INFO: Accuracy: 21.3% Mean Entropy: 356.7%
2022-04-25 19:06:45,425 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.585, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 19:07:08,634 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.583, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 19:07:26,935 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.232[s] Speed: 69.0[samples/s]
2022-04-25 19:07:57,039 reid_baseline.train INFO: normal accuracy 0.2377420683971982 3.46358060836792 
2022-04-25 19:07:57,991 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 19:07:57,991 reid_baseline.train INFO: Accuracy: 23.8% Mean Entropy: 346.4%
2022-04-25 19:08:20,337 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.387, Acc: 0.537, Base Lr: 3.25e-03
2022-04-25 19:08:45,003 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.378, Acc: 0.536, Base Lr: 3.25e-03
2022-04-25 19:09:03,064 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.238[s] Speed: 67.2[samples/s]
2022-04-25 19:09:33,879 reid_baseline.train INFO: normal accuracy 0.26122785331685205 3.3359906673431396 
2022-04-25 19:09:34,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 19:09:34,745 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 333.6%
2022-04-25 19:09:57,459 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.250, Acc: 0.555, Base Lr: 3.64e-03
2022-04-25 19:10:22,195 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.216, Acc: 0.571, Base Lr: 3.64e-03
2022-04-25 19:10:39,733 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.238[s] Speed: 67.2[samples/s]
2022-04-25 19:11:09,535 reid_baseline.train INFO: normal accuracy 0.2719406674907293 3.2053301334381104 
2022-04-25 19:11:10,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 19:11:10,611 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 320.5%
2022-04-25 19:11:30,778 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.084, Acc: 0.612, Base Lr: 4.04e-03
2022-04-25 19:11:53,390 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.083, Acc: 0.618, Base Lr: 4.04e-03
2022-04-25 19:12:07,812 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.210[s] Speed: 76.4[samples/s]
2022-04-25 19:12:34,419 reid_baseline.train INFO: normal accuracy 0.29254223320972395 3.103577136993408 
2022-04-25 19:12:35,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 19:12:35,520 reid_baseline.train INFO: Accuracy: 29.3% Mean Entropy: 310.4%
2022-04-25 19:12:58,969 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.957, Acc: 0.644, Base Lr: 4.44e-03
2022-04-25 19:13:22,915 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.946, Acc: 0.646, Base Lr: 4.44e-03
2022-04-25 19:13:41,383 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.241[s] Speed: 66.3[samples/s]
2022-04-25 19:14:10,760 reid_baseline.train INFO: normal accuracy 0.3003708281829419 2.986724376678467 
2022-04-25 19:14:11,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 19:14:11,685 reid_baseline.train INFO: Accuracy: 30.0% Mean Entropy: 298.7%
2022-04-25 19:14:33,963 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.802, Acc: 0.699, Base Lr: 4.83e-03
2022-04-25 19:14:58,330 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.825, Acc: 0.688, Base Lr: 4.83e-03
2022-04-25 19:15:16,883 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 19:15:47,954 reid_baseline.train INFO: normal accuracy 0.30943551709929956 2.930874824523926 
2022-04-25 19:15:48,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 19:15:48,817 reid_baseline.train INFO: Accuracy: 30.9% Mean Entropy: 293.1%
2022-04-25 19:16:11,141 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.702, Base Lr: 5.23e-03
2022-04-25 19:16:35,539 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.724, Acc: 0.710, Base Lr: 5.23e-03
2022-04-25 19:16:53,571 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.237[s] Speed: 67.6[samples/s]
2022-04-25 19:17:25,031 reid_baseline.train INFO: normal accuracy 0.3189122373300371 2.8454172611236572 
2022-04-25 19:17:27,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 19:17:27,281 reid_baseline.train INFO: Accuracy: 31.9% Mean Entropy: 284.5%
2022-04-25 19:17:49,073 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.696, Acc: 0.726, Base Lr: 5.62e-03
2022-04-25 19:18:13,266 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.671, Acc: 0.734, Base Lr: 5.62e-03
2022-04-25 19:18:30,804 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.232[s] Speed: 68.9[samples/s]
2022-04-25 19:19:01,733 reid_baseline.train INFO: normal accuracy 0.32715286361763496 2.7542874813079834 
2022-04-25 19:19:03,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 19:19:03,033 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 275.4%
2022-04-25 19:19:27,015 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.545, Acc: 0.770, Base Lr: 6.02e-03
2022-04-25 19:19:49,438 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.575, Acc: 0.762, Base Lr: 6.02e-03
2022-04-25 19:20:07,303 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.235[s] Speed: 68.0[samples/s]
2022-04-25 19:20:38,383 reid_baseline.train INFO: normal accuracy 0.3238566131025958 2.7035019397735596 
2022-04-25 19:20:40,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 19:20:40,365 reid_baseline.train INFO: Accuracy: 32.4% Mean Entropy: 270.4%
2022-04-25 19:21:02,305 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.479, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 19:21:27,560 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.480, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 19:21:45,777 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-25 19:22:17,206 reid_baseline.train INFO: normal accuracy 0.319324268644417 2.6992573738098145 
2022-04-25 19:22:18,187 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 19:22:18,187 reid_baseline.train INFO: Accuracy: 31.9% Mean Entropy: 269.9%
2022-04-25 19:22:41,105 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.442, Acc: 0.804, Base Lr: 6.81e-03
2022-04-25 19:23:04,283 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.456, Acc: 0.793, Base Lr: 6.81e-03
2022-04-25 19:23:22,114 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.234[s] Speed: 68.3[samples/s]
2022-04-25 19:23:52,005 reid_baseline.train INFO: normal accuracy 0.3292130201895344 2.624533176422119 
2022-04-25 19:23:52,899 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 19:23:52,899 reid_baseline.train INFO: Accuracy: 32.9% Mean Entropy: 262.5%
2022-04-25 19:24:16,377 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.379, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 19:24:38,656 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.395, Acc: 0.819, Base Lr: 7.21e-03
2022-04-25 19:24:57,305 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.236[s] Speed: 67.8[samples/s]
2022-04-25 19:25:28,160 reid_baseline.train INFO: normal accuracy 0.3370416151627524 2.5938732624053955 
2022-04-25 19:25:28,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 19:25:28,980 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 259.4%
2022-04-25 19:25:52,417 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.321, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 19:26:17,776 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.347, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 19:26:36,342 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-25 19:27:06,756 reid_baseline.train INFO: normal accuracy 0.33209723939019364 2.613983154296875 
2022-04-25 19:27:06,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 19:27:06,759 reid_baseline.train INFO: Accuracy: 33.2% Mean Entropy: 261.4%
2022-04-25 19:27:31,100 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.263, Acc: 0.870, Base Lr: 4.01e-03
2022-04-25 19:27:51,938 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.250, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 19:28:07,920 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.224[s] Speed: 71.4[samples/s]
2022-04-25 19:28:34,048 reid_baseline.train INFO: normal accuracy 0.3399258343634116 2.5945680141448975 
2022-04-25 19:28:34,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 19:28:34,050 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 259.5%
2022-04-25 19:28:53,621 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.213, Acc: 0.881, Base Lr: 3.69e-03
2022-04-25 19:29:19,066 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.195, Acc: 0.888, Base Lr: 3.69e-03
2022-04-25 19:29:37,286 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.232[s] Speed: 69.1[samples/s]
2022-04-25 19:30:04,511 reid_baseline.train INFO: normal accuracy 0.34198599093531107 2.576164960861206 
2022-04-25 19:30:05,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 19:30:05,310 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 257.6%
2022-04-25 19:30:27,566 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.178, Acc: 0.896, Base Lr: 3.38e-03
2022-04-25 19:30:53,471 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.177, Acc: 0.897, Base Lr: 3.38e-03
2022-04-25 19:31:10,561 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 19:31:40,645 reid_baseline.train INFO: normal accuracy 0.3362175525339926 2.557595729827881 
2022-04-25 19:31:41,845 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 19:31:41,845 reid_baseline.train INFO: Accuracy: 33.6% Mean Entropy: 255.8%
2022-04-25 19:32:04,129 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.163, Acc: 0.900, Base Lr: 3.08e-03
2022-04-25 19:32:29,071 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.897, Base Lr: 3.08e-03
2022-04-25 19:32:48,384 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.244[s] Speed: 65.7[samples/s]
2022-04-25 19:33:19,879 reid_baseline.train INFO: normal accuracy 0.3411619283065513 2.559882879257202 
2022-04-25 19:33:19,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 19:33:19,884 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 256.0%
2022-04-25 19:33:44,434 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.119, Acc: 0.921, Base Lr: 2.77e-03
2022-04-25 19:34:07,797 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.130, Acc: 0.914, Base Lr: 2.77e-03
2022-04-25 19:34:26,314 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-25 19:34:56,036 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.508509397506714 
2022-04-25 19:34:56,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 19:34:56,839 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.9%
2022-04-25 19:35:18,416 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.138, Acc: 0.912, Base Lr: 2.48e-03
2022-04-25 19:35:43,136 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.124, Acc: 0.916, Base Lr: 2.48e-03
2022-04-25 19:36:01,822 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.238[s] Speed: 67.2[samples/s]
2022-04-25 19:36:33,317 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5002167224884033 
2022-04-25 19:36:34,129 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 19:36:34,129 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.0%
2022-04-25 19:36:57,711 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.088, Acc: 0.926, Base Lr: 2.20e-03
2022-04-25 19:37:21,865 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.098, Acc: 0.921, Base Lr: 2.20e-03
2022-04-25 19:37:40,139 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 19:38:10,721 reid_baseline.train INFO: normal accuracy 0.353934899052328 2.5432209968566895 
2022-04-25 19:38:10,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 19:38:10,724 reid_baseline.train INFO: Accuracy: 35.4% Mean Entropy: 254.3%
2022-04-25 19:38:35,476 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 19:38:58,774 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.089, Acc: 0.920, Base Lr: 1.92e-03
2022-04-25 19:39:17,415 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.244[s] Speed: 65.5[samples/s]
2022-04-25 19:39:49,113 reid_baseline.train INFO: normal accuracy 0.35022661722290893 2.5195131301879883 
2022-04-25 19:39:49,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 19:39:49,115 reid_baseline.train INFO: Accuracy: 35.0% Mean Entropy: 252.0%
2022-04-25 19:40:15,591 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.088, Acc: 0.928, Base Lr: 1.66e-03
2022-04-25 19:40:36,645 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.075, Acc: 0.932, Base Lr: 1.66e-03
2022-04-25 19:40:55,257 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-25 19:41:23,761 reid_baseline.train INFO: normal accuracy 0.34445817882159047 2.5486252307891846 
2022-04-25 19:41:23,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 19:41:23,763 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 254.9%
2022-04-25 19:41:51,308 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.061, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 19:42:15,004 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.059, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 19:42:32,398 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 19:42:57,208 reid_baseline.train INFO: normal accuracy 0.3477544293366296 2.5249135494232178 
2022-04-25 19:42:57,209 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 19:42:57,209 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 252.5%
2022-04-25 19:43:25,010 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.053, Acc: 0.944, Base Lr: 1.19e-03
2022-04-25 19:43:49,192 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.052, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 19:44:07,695 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.258[s] Speed: 62.0[samples/s]
2022-04-25 19:44:31,659 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.5429394245147705 
2022-04-25 19:44:31,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 19:44:31,659 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 254.3%
2022-04-25 19:44:55,242 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.054, Acc: 0.934, Base Lr: 9.72e-04
2022-04-25 19:45:15,329 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.042, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 19:45:34,540 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.230[s] Speed: 69.5[samples/s]
2022-04-25 19:46:02,029 reid_baseline.train INFO: normal accuracy 0.3473423980222497 2.5258359909057617 
2022-04-25 19:46:02,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 19:46:02,029 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 252.6%
2022-04-25 19:46:28,179 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.057, Acc: 0.929, Base Lr: 7.78e-04
2022-04-25 19:46:51,342 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.052, Acc: 0.935, Base Lr: 7.78e-04
2022-04-25 19:47:09,945 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.249[s] Speed: 64.3[samples/s]
2022-04-25 19:47:36,479 reid_baseline.train INFO: normal accuracy 0.3477544293366296 2.5385360717773438 
2022-04-25 19:47:36,484 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 19:47:36,484 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 253.9%
2022-04-25 19:48:04,570 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.031, Acc: 0.948, Base Lr: 6.04e-04
2022-04-25 19:48:28,484 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.034, Acc: 0.943, Base Lr: 6.04e-04
2022-04-25 19:48:45,540 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-25 19:49:12,202 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.5355827808380127 
2022-04-25 19:49:12,204 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 19:49:12,205 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 253.6%
2022-04-25 19:49:38,661 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.025, Acc: 0.947, Base Lr: 4.51e-04
2022-04-25 19:50:03,599 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 4.51e-04
2022-04-25 19:50:23,032 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.259[s] Speed: 61.8[samples/s]
2022-04-25 19:50:49,513 reid_baseline.train INFO: normal accuracy 0.34857849196538937 2.5450263023376465 
2022-04-25 19:50:49,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 19:50:49,515 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 254.5%
2022-04-25 19:51:16,564 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.040, Acc: 0.932, Base Lr: 3.20e-04
2022-04-25 19:51:39,742 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.036, Acc: 0.939, Base Lr: 3.20e-04
2022-04-25 19:51:57,353 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.248[s] Speed: 64.4[samples/s]
2022-04-25 19:52:24,558 reid_baseline.train INFO: normal accuracy 0.35022661722290893 2.526334524154663 
2022-04-25 19:52:24,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 19:52:24,561 reid_baseline.train INFO: Accuracy: 35.0% Mean Entropy: 252.6%
2022-04-25 19:52:52,253 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.018, Acc: 0.947, Base Lr: 2.11e-04
2022-04-25 19:53:16,015 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.025, Acc: 0.945, Base Lr: 2.11e-04
2022-04-25 19:53:34,301 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.255[s] Speed: 62.6[samples/s]
2022-04-25 19:54:02,788 reid_baseline.train INFO: normal accuracy 0.34940255459414915 2.5065691471099854 
2022-04-25 19:54:02,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 19:54:02,790 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 250.7%
2022-04-25 19:54:26,615 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.039, Acc: 0.935, Base Lr: 1.26e-04
2022-04-25 19:54:53,860 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.026, Acc: 0.943, Base Lr: 1.26e-04
2022-04-25 19:55:10,746 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 19:55:40,848 reid_baseline.train INFO: normal accuracy 0.34528224145035025 2.5033695697784424 
2022-04-25 19:55:40,853 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 19:55:40,853 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 250.3%
2022-04-25 19:56:08,129 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.028, Acc: 0.943, Base Lr: 6.51e-05
2022-04-25 19:56:23,660 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.027, Acc: 0.947, Base Lr: 6.51e-05
2022-04-25 19:56:34,343 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.196[s] Speed: 81.7[samples/s]
2022-04-25 19:57:02,504 reid_baseline.train INFO: normal accuracy 0.3518747424804285 2.5358145236968994 
2022-04-25 19:57:02,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 19:57:02,507 reid_baseline.train INFO: Accuracy: 35.2% Mean Entropy: 253.6%
2022-04-25 19:57:27,369 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.009, Acc: 0.956, Base Lr: 2.83e-05
2022-04-25 19:57:50,895 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.015, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 19:58:10,572 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.249[s] Speed: 64.2[samples/s]
2022-04-25 19:58:42,005 reid_baseline.train INFO: normal accuracy 0.34899052327976926 2.5007998943328857 
2022-04-25 19:58:42,008 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 19:58:42,008 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 250.1%
2022-04-25 19:59:06,077 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.033, Acc: 0.941, Base Lr: 1.60e-05
2022-04-25 19:59:31,064 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.946, Base Lr: 1.60e-05
2022-04-25 19:59:47,468 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.240[s] Speed: 66.7[samples/s]
2022-04-25 20:00:21,382 reid_baseline.train INFO: normal accuracy 0.3506386485372888 2.502864122390747 
2022-04-25 20:00:21,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 20:00:21,387 reid_baseline.train INFO: Accuracy: 35.1% Mean Entropy: 250.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 20:00:48,264 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5002167224884033 
2022-04-25 20:00:48,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:00:48,264 reid_baseline.train INFO: Accuracy: 34.6%
2022-04-25 20:01:14,078 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5002167224884033 
2022-04-25 20:01:14,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:01:14,079 reid_baseline.train INFO: Shuffled Accuracy: 34.6%
2022-04-25 20:02:04,748 reid_baseline.train INFO: normal accuracy 0.9010309278350516 1.2239502668380737 
2022-04-25 20:02:04,749 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:02:04,749 reid_baseline.train INFO: Source Clean Accuracy: 90.1%
2022-04-25 20:02:09,768 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_4
2022-04-25 20:02:09,768 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 20:02:09,768 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 20:02:09,769 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 20:02:09,769 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 20:02:22,948 reid_baseline.train INFO: start training
2022-04-25 20:02:49,537 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.085, Base Lr: 4.76e-04
2022-04-25 20:03:13,006 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.122, Base Lr: 4.76e-04
2022-04-25 20:03:30,079 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-25 20:04:22,487 reid_baseline.train INFO: normal accuracy 0.10317639107907187 4.16914701461792 
2022-04-25 20:04:23,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 20:04:23,335 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 416.9%
2022-04-25 20:04:48,183 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.961, Acc: 0.209, Base Lr: 8.72e-04
2022-04-25 20:05:11,626 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.907, Acc: 0.213, Base Lr: 8.72e-04
2022-04-25 20:05:28,227 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 20:06:23,312 reid_baseline.train INFO: normal accuracy 0.10362694300518134 4.131688594818115 
2022-04-25 20:06:25,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 20:06:25,472 reid_baseline.train INFO: Accuracy: 10.4% Mean Entropy: 413.2%
2022-04-25 20:06:51,297 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.685, Acc: 0.216, Base Lr: 1.27e-03
2022-04-25 20:07:13,469 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.629, Acc: 0.225, Base Lr: 1.27e-03
2022-04-25 20:07:31,611 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 20:08:22,649 reid_baseline.train INFO: normal accuracy 0.13989637305699482 4.031518459320068 
2022-04-25 20:08:23,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:08:23,468 reid_baseline.train INFO: Accuracy: 14.0% Mean Entropy: 403.2%
2022-04-25 20:08:48,930 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.329, Acc: 0.297, Base Lr: 1.66e-03
2022-04-25 20:09:10,776 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.315, Acc: 0.292, Base Lr: 1.66e-03
2022-04-25 20:09:28,966 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.240[s] Speed: 66.7[samples/s]
2022-04-25 20:10:23,022 reid_baseline.train INFO: normal accuracy 0.1923856724487497 3.865800142288208 
2022-04-25 20:10:23,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:10:23,875 reid_baseline.train INFO: Accuracy: 19.2% Mean Entropy: 386.6%
2022-04-25 20:10:49,598 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.094, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 20:11:12,058 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.033, Acc: 0.357, Base Lr: 2.06e-03
2022-04-25 20:11:29,885 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.241[s] Speed: 66.3[samples/s]
2022-04-25 20:12:24,362 reid_baseline.train INFO: normal accuracy 0.21986933994142824 3.7281394004821777 
2022-04-25 20:12:25,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:12:25,151 reid_baseline.train INFO: Accuracy: 22.0% Mean Entropy: 372.8%
2022-04-25 20:12:52,451 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.840, Acc: 0.412, Base Lr: 2.46e-03
2022-04-25 20:13:14,852 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.799, Acc: 0.414, Base Lr: 2.46e-03
2022-04-25 20:13:32,626 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-25 20:14:27,896 reid_baseline.train INFO: normal accuracy 0.3072764136066682 3.507593870162964 
2022-04-25 20:14:29,960 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 20:14:29,960 reid_baseline.train INFO: Accuracy: 30.7% Mean Entropy: 350.8%
2022-04-25 20:14:54,938 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.585, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 20:15:20,555 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.583, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 20:15:38,587 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 20:16:25,155 reid_baseline.train INFO: normal accuracy 0.34061725613877 3.3730132579803467 
2022-04-25 20:16:25,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 20:16:25,953 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 337.3%
2022-04-25 20:16:47,719 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.387, Acc: 0.537, Base Lr: 3.25e-03
2022-04-25 20:17:14,219 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.378, Acc: 0.536, Base Lr: 3.25e-03
2022-04-25 20:17:32,155 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-25 20:18:25,791 reid_baseline.train INFO: normal accuracy 0.3701284072989412 3.20192551612854 
2022-04-25 20:18:26,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 20:18:26,597 reid_baseline.train INFO: Accuracy: 37.0% Mean Entropy: 320.2%
2022-04-25 20:18:53,939 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.250, Acc: 0.555, Base Lr: 3.64e-03
2022-04-25 20:19:18,435 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.216, Acc: 0.571, Base Lr: 3.64e-03
2022-04-25 20:19:37,391 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.258[s] Speed: 62.0[samples/s]
2022-04-25 20:20:33,702 reid_baseline.train INFO: normal accuracy 0.39243072764136067 3.066178321838379 
2022-04-25 20:20:34,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 20:20:34,914 reid_baseline.train INFO: Accuracy: 39.2% Mean Entropy: 306.6%
2022-04-25 20:21:01,694 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.084, Acc: 0.612, Base Lr: 4.04e-03
2022-04-25 20:21:24,911 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.083, Acc: 0.618, Base Lr: 4.04e-03
2022-04-25 20:21:45,766 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.259[s] Speed: 61.8[samples/s]
2022-04-25 20:22:39,644 reid_baseline.train INFO: normal accuracy 0.40797476909213787 2.9701342582702637 
2022-04-25 20:22:40,462 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 20:22:40,462 reid_baseline.train INFO: Accuracy: 40.8% Mean Entropy: 297.0%
2022-04-25 20:23:04,404 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.957, Acc: 0.644, Base Lr: 4.44e-03
2022-04-25 20:23:27,998 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.946, Acc: 0.646, Base Lr: 4.44e-03
2022-04-25 20:23:48,995 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 20:24:41,933 reid_baseline.train INFO: normal accuracy 0.42870015769317416 2.7704989910125732 
2022-04-25 20:24:42,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 20:24:42,716 reid_baseline.train INFO: Accuracy: 42.9% Mean Entropy: 277.0%
2022-04-25 20:25:08,634 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.802, Acc: 0.699, Base Lr: 4.83e-03
2022-04-25 20:25:32,838 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.825, Acc: 0.688, Base Lr: 4.83e-03
2022-04-25 20:25:51,041 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.250[s] Speed: 64.0[samples/s]
2022-04-25 20:26:45,306 reid_baseline.train INFO: normal accuracy 0.4318540211759405 2.7003071308135986 
2022-04-25 20:26:46,115 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 20:26:46,116 reid_baseline.train INFO: Accuracy: 43.2% Mean Entropy: 270.0%
2022-04-25 20:27:11,396 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.702, Base Lr: 5.23e-03
2022-04-25 20:27:34,833 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.724, Acc: 0.710, Base Lr: 5.23e-03
2022-04-25 20:27:51,100 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.237[s] Speed: 67.5[samples/s]
2022-04-25 20:28:47,526 reid_baseline.train INFO: normal accuracy 0.446271682811444 2.611815929412842 
2022-04-25 20:28:48,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 20:28:48,400 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 261.2%
2022-04-25 20:29:14,915 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.696, Acc: 0.726, Base Lr: 5.62e-03
2022-04-25 20:29:39,506 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.671, Acc: 0.734, Base Lr: 5.62e-03
2022-04-25 20:29:56,475 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.249[s] Speed: 64.2[samples/s]
2022-04-25 20:30:42,071 reid_baseline.train INFO: normal accuracy 0.4408650596981302 2.4912281036376953 
2022-04-25 20:30:42,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 20:30:42,861 reid_baseline.train INFO: Accuracy: 44.1% Mean Entropy: 249.1%
2022-04-25 20:31:08,059 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.545, Acc: 0.770, Base Lr: 6.02e-03
2022-04-25 20:31:32,892 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.575, Acc: 0.762, Base Lr: 6.02e-03
2022-04-25 20:31:49,869 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-25 20:32:42,771 reid_baseline.train INFO: normal accuracy 0.4514530299617031 2.351408004760742 
2022-04-25 20:32:43,575 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 20:32:43,576 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 235.1%
2022-04-25 20:33:07,894 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.479, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 20:33:33,479 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.480, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 20:33:47,726 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.235[s] Speed: 68.2[samples/s]
2022-04-25 20:34:44,372 reid_baseline.train INFO: normal accuracy 0.45167830592475783 2.3961076736450195 
2022-04-25 20:34:44,376 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 20:34:44,377 reid_baseline.train INFO: Accuracy: 45.2% Mean Entropy: 239.6%
2022-04-25 20:35:10,600 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.442, Acc: 0.804, Base Lr: 6.81e-03
2022-04-25 20:35:35,721 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.456, Acc: 0.793, Base Lr: 6.81e-03
2022-04-25 20:35:51,182 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.245[s] Speed: 65.4[samples/s]
2022-04-25 20:36:48,397 reid_baseline.train INFO: normal accuracy 0.46947510700608247 2.355072259902954 
2022-04-25 20:36:48,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 20:36:48,400 reid_baseline.train INFO: Accuracy: 46.9% Mean Entropy: 235.5%
2022-04-25 20:37:13,958 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.379, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 20:37:37,384 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.395, Acc: 0.819, Base Lr: 7.21e-03
2022-04-25 20:37:54,574 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-25 20:38:48,944 reid_baseline.train INFO: normal accuracy 0.4904257715701735 2.2576327323913574 
2022-04-25 20:38:49,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 20:38:49,953 reid_baseline.train INFO: Accuracy: 49.0% Mean Entropy: 225.8%
2022-04-25 20:39:16,918 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.321, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 20:39:41,953 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.347, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 20:39:59,642 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.254[s] Speed: 62.9[samples/s]
2022-04-25 20:40:56,464 reid_baseline.train INFO: normal accuracy 0.4755575580085605 2.306993007659912 
2022-04-25 20:40:56,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 20:40:56,469 reid_baseline.train INFO: Accuracy: 47.6% Mean Entropy: 230.7%
2022-04-25 20:41:22,391 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.263, Acc: 0.870, Base Lr: 4.01e-03
2022-04-25 20:41:47,721 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.250, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 20:42:01,333 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 20:42:58,820 reid_baseline.train INFO: normal accuracy 0.48749718405046183 2.211136817932129 
2022-04-25 20:42:59,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 20:42:59,720 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 221.1%
2022-04-25 20:43:25,334 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.213, Acc: 0.881, Base Lr: 3.69e-03
2022-04-25 20:43:49,969 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.195, Acc: 0.888, Base Lr: 3.69e-03
2022-04-25 20:44:07,217 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.247[s] Speed: 64.7[samples/s]
2022-04-25 20:44:56,499 reid_baseline.train INFO: normal accuracy 0.4892993917548997 2.160364866256714 
2022-04-25 20:44:57,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 20:44:57,284 reid_baseline.train INFO: Accuracy: 48.9% Mean Entropy: 216.0%
2022-04-25 20:45:19,251 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.178, Acc: 0.896, Base Lr: 3.38e-03
2022-04-25 20:45:44,856 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.177, Acc: 0.897, Base Lr: 3.38e-03
2022-04-25 20:46:00,135 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.230[s] Speed: 69.5[samples/s]
2022-04-25 20:46:54,260 reid_baseline.train INFO: normal accuracy 0.48118945708492905 2.193155288696289 
2022-04-25 20:46:54,265 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 20:46:54,265 reid_baseline.train INFO: Accuracy: 48.1% Mean Entropy: 219.3%
2022-04-25 20:47:20,351 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.163, Acc: 0.900, Base Lr: 3.08e-03
2022-04-25 20:47:43,321 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.897, Base Lr: 3.08e-03
2022-04-25 20:47:58,802 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.236[s] Speed: 67.9[samples/s]
2022-04-25 20:48:56,938 reid_baseline.train INFO: normal accuracy 0.47713448974994366 2.1843297481536865 
2022-04-25 20:48:56,943 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 20:48:56,943 reid_baseline.train INFO: Accuracy: 47.7% Mean Entropy: 218.4%
2022-04-25 20:49:21,825 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.119, Acc: 0.921, Base Lr: 2.77e-03
2022-04-25 20:49:46,652 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.130, Acc: 0.914, Base Lr: 2.77e-03
2022-04-25 20:50:04,249 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 20:51:01,386 reid_baseline.train INFO: normal accuracy 0.4832169407524217 2.161971092224121 
2022-04-25 20:51:01,387 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 20:51:01,387 reid_baseline.train INFO: Accuracy: 48.3% Mean Entropy: 216.2%
2022-04-25 20:51:27,087 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.138, Acc: 0.912, Base Lr: 2.48e-03
2022-04-25 20:51:50,707 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.124, Acc: 0.916, Base Lr: 2.48e-03
2022-04-25 20:52:06,390 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.238[s] Speed: 67.3[samples/s]
2022-04-25 20:53:04,052 reid_baseline.train INFO: normal accuracy 0.48704663212435234 2.127619743347168 
2022-04-25 20:53:05,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 20:53:05,021 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 212.8%
2022-04-25 20:53:29,299 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.088, Acc: 0.926, Base Lr: 2.20e-03
2022-04-25 20:53:54,360 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.098, Acc: 0.921, Base Lr: 2.20e-03
2022-04-25 20:54:10,163 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.238[s] Speed: 67.1[samples/s]
2022-04-25 20:55:03,961 reid_baseline.train INFO: normal accuracy 0.49695877449876097 2.1501786708831787 
2022-04-25 20:55:03,963 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 20:55:03,964 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 215.0%
2022-04-25 20:55:30,117 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 20:55:54,008 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.089, Acc: 0.920, Base Lr: 1.92e-03
2022-04-25 20:56:10,370 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-25 20:57:05,317 reid_baseline.train INFO: normal accuracy 0.48772246001351655 2.121302604675293 
2022-04-25 20:57:07,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 20:57:07,157 reid_baseline.train INFO: Accuracy: 48.8% Mean Entropy: 212.1%
2022-04-25 20:57:29,419 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.088, Acc: 0.928, Base Lr: 1.66e-03
2022-04-25 20:57:53,621 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.075, Acc: 0.932, Base Lr: 1.66e-03
2022-04-25 20:58:09,434 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.227[s] Speed: 70.3[samples/s]
2022-04-25 20:59:04,228 reid_baseline.train INFO: normal accuracy 0.4904257715701735 2.12693452835083 
2022-04-25 20:59:04,230 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 20:59:04,230 reid_baseline.train INFO: Accuracy: 49.0% Mean Entropy: 212.7%
2022-04-25 20:59:29,261 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.061, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 20:59:51,628 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.059, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 21:00:05,456 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.222[s] Speed: 71.9[samples/s]
2022-04-25 21:00:51,309 reid_baseline.train INFO: normal accuracy 0.5003379139445822 2.1575255393981934 
2022-04-25 21:00:51,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 21:00:51,312 reid_baseline.train INFO: Accuracy: 50.0% Mean Entropy: 215.8%
2022-04-25 21:01:19,545 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.053, Acc: 0.944, Base Lr: 1.19e-03
2022-04-25 21:01:43,212 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.052, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 21:01:58,452 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.246[s] Speed: 65.2[samples/s]
2022-04-25 21:02:55,963 reid_baseline.train INFO: normal accuracy 0.4942554629421041 2.157453775405884 
2022-04-25 21:02:55,968 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 21:02:55,968 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 215.7%
2022-04-25 21:03:20,437 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.054, Acc: 0.934, Base Lr: 9.72e-04
2022-04-25 21:03:42,681 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.042, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 21:03:59,503 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.232[s] Speed: 68.9[samples/s]
2022-04-25 21:04:51,794 reid_baseline.train INFO: normal accuracy 0.4942554629421041 2.14792799949646 
2022-04-25 21:04:51,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 21:04:51,797 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 214.8%
2022-04-25 21:05:18,240 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.057, Acc: 0.929, Base Lr: 7.78e-04
2022-04-25 21:05:42,614 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.052, Acc: 0.935, Base Lr: 7.78e-04
2022-04-25 21:05:58,213 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.242[s] Speed: 66.2[samples/s]
2022-04-25 21:06:51,078 reid_baseline.train INFO: normal accuracy 0.4944807389051588 2.1427524089813232 
2022-04-25 21:06:51,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 21:06:51,083 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 214.3%
2022-04-25 21:07:17,845 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.031, Acc: 0.948, Base Lr: 6.04e-04
2022-04-25 21:07:41,175 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.034, Acc: 0.943, Base Lr: 6.04e-04
2022-04-25 21:07:57,783 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.244[s] Speed: 65.7[samples/s]
2022-04-25 21:08:52,458 reid_baseline.train INFO: normal accuracy 0.4947060148682136 2.145911931991577 
2022-04-25 21:08:52,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 21:08:52,461 reid_baseline.train INFO: Accuracy: 49.5% Mean Entropy: 214.6%
2022-04-25 21:09:16,901 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.025, Acc: 0.947, Base Lr: 4.51e-04
2022-04-25 21:09:41,804 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 4.51e-04
2022-04-25 21:09:58,938 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-25 21:10:52,056 reid_baseline.train INFO: normal accuracy 0.4998873620184726 2.1500096321105957 
2022-04-25 21:10:52,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 21:10:52,061 reid_baseline.train INFO: Accuracy: 50.0% Mean Entropy: 215.0%
2022-04-25 21:11:17,223 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.040, Acc: 0.932, Base Lr: 3.20e-04
2022-04-25 21:11:41,961 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.036, Acc: 0.939, Base Lr: 3.20e-04
2022-04-25 21:11:55,757 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 21:12:52,294 reid_baseline.train INFO: normal accuracy 0.49898625816625364 2.1261632442474365 
2022-04-25 21:12:52,297 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 21:12:52,297 reid_baseline.train INFO: Accuracy: 49.9% Mean Entropy: 212.6%
2022-04-25 21:13:18,020 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.018, Acc: 0.947, Base Lr: 2.11e-04
2022-04-25 21:13:40,580 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.025, Acc: 0.945, Base Lr: 2.11e-04
2022-04-25 21:13:54,152 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.226[s] Speed: 70.7[samples/s]
2022-04-25 21:14:49,120 reid_baseline.train INFO: normal accuracy 0.49785987835097995 2.1167972087860107 
2022-04-25 21:14:50,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 21:14:50,381 reid_baseline.train INFO: Accuracy: 49.8% Mean Entropy: 211.7%
2022-04-25 21:15:15,163 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.039, Acc: 0.935, Base Lr: 1.26e-04
2022-04-25 21:15:39,794 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.026, Acc: 0.943, Base Lr: 1.26e-04
2022-04-25 21:15:56,016 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-25 21:16:40,195 reid_baseline.train INFO: normal accuracy 0.5025906735751295 2.1149656772613525 
2022-04-25 21:16:40,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 21:16:40,984 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 211.5%
2022-04-25 21:17:07,927 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.028, Acc: 0.943, Base Lr: 6.51e-05
2022-04-25 21:17:33,240 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.027, Acc: 0.947, Base Lr: 6.51e-05
2022-04-25 21:17:52,166 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-25 21:18:48,110 reid_baseline.train INFO: normal accuracy 0.5003379139445822 2.132044553756714 
2022-04-25 21:18:48,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 21:18:48,115 reid_baseline.train INFO: Accuracy: 50.0% Mean Entropy: 213.2%
2022-04-25 21:19:09,449 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.009, Acc: 0.956, Base Lr: 2.83e-05
2022-04-25 21:19:23,313 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.015, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 21:19:35,505 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.173[s] Speed: 92.7[samples/s]
2022-04-25 21:20:26,715 reid_baseline.train INFO: normal accuracy 0.49695877449876097 2.1151511669158936 
2022-04-25 21:20:26,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 21:20:26,720 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 211.5%
2022-04-25 21:20:46,825 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.033, Acc: 0.941, Base Lr: 1.60e-05
2022-04-25 21:21:11,663 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.946, Base Lr: 1.60e-05
2022-04-25 21:21:30,813 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.235[s] Speed: 68.2[samples/s]
2022-04-25 21:22:19,561 reid_baseline.train INFO: normal accuracy 0.49628294660959676 2.1159722805023193 
2022-04-25 21:22:19,563 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 21:22:19,563 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 211.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 21:23:04,606 reid_baseline.train INFO: normal accuracy 0.5025906735751295 2.1149656772613525 
2022-04-25 21:23:04,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:23:04,607 reid_baseline.train INFO: Accuracy: 50.3%
2022-04-25 21:23:53,153 reid_baseline.train INFO: normal accuracy 0.5025906735751295 2.1149656772613525 
2022-04-25 21:23:53,154 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:23:53,154 reid_baseline.train INFO: Shuffled Accuracy: 50.3%
2022-04-25 21:24:44,786 reid_baseline.train INFO: normal accuracy 0.9287514318442154 1.1182960271835327 
2022-04-25 21:24:44,786 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:24:44,786 reid_baseline.train INFO: Source Clean Accuracy: 92.9%
2022-04-25 21:24:51,432 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_4
2022-04-25 21:24:51,432 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 21:24:51,432 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 21:24:51,432 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 21:24:51,432 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 21:25:08,152 reid_baseline.train INFO: start training
2022-04-25 21:25:34,003 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.085, Base Lr: 4.76e-04
2022-04-25 21:25:56,619 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.123, Acc: 0.122, Base Lr: 4.76e-04
2022-04-25 21:26:16,021 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-25 21:27:15,679 reid_baseline.train INFO: normal accuracy 0.1285288042230893 4.168453693389893 
2022-04-25 21:27:16,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 21:27:16,758 reid_baseline.train INFO: Accuracy: 12.9% Mean Entropy: 416.8%
2022-04-25 21:27:42,662 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.961, Acc: 0.209, Base Lr: 8.72e-04
2022-04-25 21:28:03,352 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.907, Acc: 0.213, Base Lr: 8.72e-04
2022-04-25 21:28:20,310 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.233[s] Speed: 68.7[samples/s]
2022-04-25 21:29:19,830 reid_baseline.train INFO: normal accuracy 0.13610282304337848 4.125113010406494 
2022-04-25 21:29:21,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 21:29:21,166 reid_baseline.train INFO: Accuracy: 13.6% Mean Entropy: 412.5%
2022-04-25 21:29:43,508 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.685, Acc: 0.216, Base Lr: 1.27e-03
2022-04-25 21:30:06,866 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.629, Acc: 0.225, Base Lr: 1.27e-03
2022-04-25 21:30:24,814 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.232[s] Speed: 69.0[samples/s]
2022-04-25 21:31:25,909 reid_baseline.train INFO: normal accuracy 0.1774156529722286 4.012887954711914 
2022-04-25 21:31:27,954 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 21:31:27,954 reid_baseline.train INFO: Accuracy: 17.7% Mean Entropy: 401.3%
2022-04-25 21:31:55,562 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.329, Acc: 0.297, Base Lr: 1.66e-03
2022-04-25 21:32:16,073 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.315, Acc: 0.292, Base Lr: 1.66e-03
2022-04-25 21:32:33,084 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.238[s] Speed: 67.3[samples/s]
2022-04-25 21:33:28,885 reid_baseline.train INFO: normal accuracy 0.21023640119348175 3.8171279430389404 
2022-04-25 21:33:30,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 21:33:30,167 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 381.7%
2022-04-25 21:33:49,516 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.094, Acc: 0.327, Base Lr: 2.06e-03
2022-04-25 21:34:06,242 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.033, Acc: 0.357, Base Lr: 2.06e-03
2022-04-25 21:34:22,230 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.189[s] Speed: 84.6[samples/s]
2022-04-25 21:35:24,158 reid_baseline.train INFO: normal accuracy 0.25591002983704386 3.6614792346954346 
2022-04-25 21:35:25,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 21:35:25,506 reid_baseline.train INFO: Accuracy: 25.6% Mean Entropy: 366.1%
2022-04-25 21:35:50,846 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.840, Acc: 0.412, Base Lr: 2.46e-03
2022-04-25 21:36:16,004 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.799, Acc: 0.414, Base Lr: 2.46e-03
2022-04-25 21:36:33,447 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 21:37:37,024 reid_baseline.train INFO: normal accuracy 0.3080100986917604 3.44551944732666 
2022-04-25 21:37:38,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 21:37:38,072 reid_baseline.train INFO: Accuracy: 30.8% Mean Entropy: 344.6%
2022-04-25 21:38:01,566 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.585, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 21:38:22,560 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.583, Acc: 0.466, Base Lr: 2.85e-03
2022-04-25 21:38:39,919 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.225[s] Speed: 71.1[samples/s]
2022-04-25 21:39:38,649 reid_baseline.train INFO: normal accuracy 0.34817535001147576 3.298330068588257 
2022-04-25 21:39:39,720 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 21:39:39,720 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 329.8%
2022-04-25 21:40:01,613 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.387, Acc: 0.537, Base Lr: 3.25e-03
2022-04-25 21:40:24,162 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.378, Acc: 0.536, Base Lr: 3.25e-03
2022-04-25 21:40:43,797 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.234[s] Speed: 68.3[samples/s]
2022-04-25 21:41:51,364 reid_baseline.train INFO: normal accuracy 0.3752582051870553 3.1302220821380615 
2022-04-25 21:41:52,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 21:41:52,382 reid_baseline.train INFO: Accuracy: 37.5% Mean Entropy: 313.0%
2022-04-25 21:42:17,630 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.250, Acc: 0.555, Base Lr: 3.64e-03
2022-04-25 21:42:41,050 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.216, Acc: 0.571, Base Lr: 3.64e-03
2022-04-25 21:42:57,847 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-25 21:43:55,287 reid_baseline.train INFO: normal accuracy 0.3970621987606151 2.983729362487793 
2022-04-25 21:43:56,637 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 21:43:56,637 reid_baseline.train INFO: Accuracy: 39.7% Mean Entropy: 298.4%
2022-04-25 21:44:18,186 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.084, Acc: 0.612, Base Lr: 4.04e-03
2022-04-25 21:44:42,080 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.083, Acc: 0.618, Base Lr: 4.04e-03
2022-04-25 21:45:01,499 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 21:46:07,107 reid_baseline.train INFO: normal accuracy 0.41863667661234794 2.873053550720215 
2022-04-25 21:46:08,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 21:46:08,312 reid_baseline.train INFO: Accuracy: 41.9% Mean Entropy: 287.3%
2022-04-25 21:46:32,417 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.957, Acc: 0.644, Base Lr: 4.44e-03
2022-04-25 21:46:55,869 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.946, Acc: 0.646, Base Lr: 4.44e-03
2022-04-25 21:47:14,143 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.241[s] Speed: 66.5[samples/s]
2022-04-25 21:48:18,121 reid_baseline.train INFO: normal accuracy 0.43240761992196464 2.709839344024658 
2022-04-25 21:48:19,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 21:48:19,057 reid_baseline.train INFO: Accuracy: 43.2% Mean Entropy: 271.0%
2022-04-25 21:48:40,694 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.802, Acc: 0.699, Base Lr: 4.83e-03
2022-04-25 21:49:04,552 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.825, Acc: 0.688, Base Lr: 4.83e-03
2022-04-25 21:49:20,365 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.224[s] Speed: 71.5[samples/s]
2022-04-25 21:50:22,809 reid_baseline.train INFO: normal accuracy 0.4484737204498508 2.643620729446411 
2022-04-25 21:50:23,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 21:50:23,639 reid_baseline.train INFO: Accuracy: 44.8% Mean Entropy: 264.4%
2022-04-25 21:50:46,785 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.759, Acc: 0.702, Base Lr: 5.23e-03
2022-04-25 21:51:08,666 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.724, Acc: 0.710, Base Lr: 5.23e-03
2022-04-25 21:51:23,775 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.220[s] Speed: 72.7[samples/s]
2022-04-25 21:52:26,754 reid_baseline.train INFO: normal accuracy 0.46063805370667893 2.5512242317199707 
2022-04-25 21:52:27,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 21:52:27,593 reid_baseline.train INFO: Accuracy: 46.1% Mean Entropy: 255.1%
2022-04-25 21:52:50,123 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.696, Acc: 0.726, Base Lr: 5.62e-03
2022-04-25 21:53:14,922 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.671, Acc: 0.734, Base Lr: 5.62e-03
2022-04-25 21:53:33,481 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.241[s] Speed: 66.4[samples/s]
2022-04-25 21:54:33,717 reid_baseline.train INFO: normal accuracy 0.46844158824879506 2.4544100761413574 
2022-04-25 21:54:34,550 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 21:54:34,551 reid_baseline.train INFO: Accuracy: 46.8% Mean Entropy: 245.4%
2022-04-25 21:54:59,522 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.545, Acc: 0.770, Base Lr: 6.02e-03
2022-04-25 21:55:24,749 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.575, Acc: 0.762, Base Lr: 6.02e-03
2022-04-25 21:55:42,688 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.248[s] Speed: 64.5[samples/s]
2022-04-25 21:56:43,136 reid_baseline.train INFO: normal accuracy 0.4792288271746615 2.372333526611328 
2022-04-25 21:56:43,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 21:56:43,938 reid_baseline.train INFO: Accuracy: 47.9% Mean Entropy: 237.2%
2022-04-25 21:57:07,645 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.479, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 21:57:32,980 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.480, Acc: 0.797, Base Lr: 6.42e-03
2022-04-25 21:57:51,552 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.247[s] Speed: 64.9[samples/s]
2022-04-25 21:58:49,806 reid_baseline.train INFO: normal accuracy 0.4803764057837962 2.3787918090820312 
2022-04-25 21:58:49,810 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 21:58:49,811 reid_baseline.train INFO: Accuracy: 48.0% Mean Entropy: 237.9%
2022-04-25 21:59:15,257 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.442, Acc: 0.804, Base Lr: 6.81e-03
2022-04-25 21:59:40,383 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.456, Acc: 0.793, Base Lr: 6.81e-03
2022-04-25 21:59:59,527 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:00:58,246 reid_baseline.train INFO: normal accuracy 0.48680284599495066 2.3220670223236084 
2022-04-25 22:00:59,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 22:00:59,095 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 232.2%
2022-04-25 22:01:22,468 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.379, Acc: 0.826, Base Lr: 7.21e-03
2022-04-25 22:01:47,602 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.395, Acc: 0.819, Base Lr: 7.21e-03
2022-04-25 22:02:05,833 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.244[s] Speed: 65.6[samples/s]
2022-04-25 22:03:08,216 reid_baseline.train INFO: normal accuracy 0.4957539591462015 2.277968645095825 
2022-04-25 22:03:09,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 22:03:09,015 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 227.8%
2022-04-25 22:03:33,392 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.321, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 22:03:58,290 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.347, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 22:04:16,720 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-25 22:05:14,887 reid_baseline.train INFO: normal accuracy 0.5026394308010099 2.297417402267456 
2022-04-25 22:05:14,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 22:05:14,890 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 229.7%
2022-04-25 22:05:40,438 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.263, Acc: 0.870, Base Lr: 4.01e-03
2022-04-25 22:06:05,792 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.250, Acc: 0.872, Base Lr: 4.01e-03
2022-04-25 22:06:23,199 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.250[s] Speed: 64.0[samples/s]
2022-04-25 22:07:19,923 reid_baseline.train INFO: normal accuracy 0.5049345880192794 2.258960723876953 
2022-04-25 22:07:20,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 22:07:20,737 reid_baseline.train INFO: Accuracy: 50.5% Mean Entropy: 225.9%
2022-04-25 22:07:43,942 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.213, Acc: 0.881, Base Lr: 3.69e-03
2022-04-25 22:08:09,026 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.195, Acc: 0.888, Base Lr: 3.69e-03
2022-04-25 22:08:27,918 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-25 22:09:29,532 reid_baseline.train INFO: normal accuracy 0.5090658710121644 2.2230143547058105 
2022-04-25 22:09:30,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 22:09:30,310 reid_baseline.train INFO: Accuracy: 50.9% Mean Entropy: 222.3%
2022-04-25 22:09:54,518 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.178, Acc: 0.896, Base Lr: 3.38e-03
2022-04-25 22:10:19,423 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.177, Acc: 0.897, Base Lr: 3.38e-03
2022-04-25 22:10:38,763 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-25 22:11:37,534 reid_baseline.train INFO: normal accuracy 0.5070002295157219 2.216768741607666 
2022-04-25 22:11:38,317 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 22:11:38,317 reid_baseline.train INFO: Accuracy: 50.7% Mean Entropy: 221.7%
2022-04-25 22:12:02,608 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.163, Acc: 0.900, Base Lr: 3.08e-03
2022-04-25 22:12:28,682 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.897, Base Lr: 3.08e-03
2022-04-25 22:12:47,137 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.251[s] Speed: 63.6[samples/s]
2022-04-25 22:13:45,977 reid_baseline.train INFO: normal accuracy 0.5122790911177416 2.22930908203125 
2022-04-25 22:13:45,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 22:13:45,979 reid_baseline.train INFO: Accuracy: 51.2% Mean Entropy: 222.9%
2022-04-25 22:14:12,307 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.119, Acc: 0.921, Base Lr: 2.77e-03
2022-04-25 22:14:36,951 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.130, Acc: 0.914, Base Lr: 2.77e-03
2022-04-25 22:14:55,871 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.254[s] Speed: 62.9[samples/s]
2022-04-25 22:15:56,942 reid_baseline.train INFO: normal accuracy 0.5145742483360111 2.192368507385254 
2022-04-25 22:15:57,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 22:15:57,848 reid_baseline.train INFO: Accuracy: 51.5% Mean Entropy: 219.2%
2022-04-25 22:16:23,433 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.138, Acc: 0.912, Base Lr: 2.48e-03
2022-04-25 22:16:48,771 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.124, Acc: 0.916, Base Lr: 2.48e-03
2022-04-25 22:17:07,131 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-25 22:18:07,502 reid_baseline.train INFO: normal accuracy 0.5141152168923572 2.1807076930999756 
2022-04-25 22:18:08,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 22:18:08,578 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 218.1%
2022-04-25 22:18:35,140 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.088, Acc: 0.926, Base Lr: 2.20e-03
2022-04-25 22:19:01,163 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.098, Acc: 0.921, Base Lr: 2.20e-03
2022-04-25 22:19:18,554 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-25 22:20:19,113 reid_baseline.train INFO: normal accuracy 0.5166398898324536 2.2049288749694824 
2022-04-25 22:20:19,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 22:20:19,113 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 220.5%
2022-04-25 22:20:45,460 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.091, Acc: 0.922, Base Lr: 1.92e-03
2022-04-25 22:21:09,593 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.089, Acc: 0.920, Base Lr: 1.92e-03
2022-04-25 22:21:25,243 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-25 22:22:25,225 reid_baseline.train INFO: normal accuracy 0.5173284369979344 2.184536933898926 
2022-04-25 22:22:25,230 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 22:22:25,230 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 218.5%
2022-04-25 22:22:47,154 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.088, Acc: 0.928, Base Lr: 1.66e-03
2022-04-25 22:23:08,149 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.075, Acc: 0.932, Base Lr: 1.66e-03
2022-04-25 22:23:26,936 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.226[s] Speed: 70.8[samples/s]
2022-04-25 22:24:27,264 reid_baseline.train INFO: normal accuracy 0.5210006885471655 2.2030258178710938 
2022-04-25 22:24:27,265 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 22:24:27,265 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 220.3%
2022-04-25 22:24:55,058 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.061, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 22:25:20,294 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.059, Acc: 0.935, Base Lr: 1.42e-03
2022-04-25 22:25:36,294 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-25 22:26:34,666 reid_baseline.train INFO: normal accuracy 0.5216892357126464 2.1969640254974365 
2022-04-25 22:26:34,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 22:26:34,667 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 219.7%
2022-04-25 22:27:02,218 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.053, Acc: 0.944, Base Lr: 1.19e-03
2022-04-25 22:27:25,571 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.052, Acc: 0.938, Base Lr: 1.19e-03
2022-04-25 22:27:44,277 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.255[s] Speed: 62.8[samples/s]
2022-04-25 22:28:46,280 reid_baseline.train INFO: normal accuracy 0.5196235942162039 2.222006320953369 
2022-04-25 22:28:46,280 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 22:28:46,281 reid_baseline.train INFO: Accuracy: 52.0% Mean Entropy: 222.2%
2022-04-25 22:29:12,871 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.054, Acc: 0.934, Base Lr: 9.72e-04
2022-04-25 22:29:37,752 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.042, Acc: 0.939, Base Lr: 9.72e-04
2022-04-25 22:29:56,274 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.255[s] Speed: 62.6[samples/s]
2022-04-25 22:30:57,116 reid_baseline.train INFO: normal accuracy 0.5210006885471655 2.203552722930908 
2022-04-25 22:30:57,120 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 22:30:57,120 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 220.4%
2022-04-25 22:31:23,557 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.057, Acc: 0.929, Base Lr: 7.78e-04
2022-04-25 22:31:48,559 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.052, Acc: 0.935, Base Lr: 7.78e-04
2022-04-25 22:32:04,311 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.246[s] Speed: 65.2[samples/s]
2022-04-25 22:33:03,633 reid_baseline.train INFO: normal accuracy 0.5212302042689925 2.2089176177978516 
2022-04-25 22:33:03,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 22:33:03,636 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 220.9%
2022-04-25 22:33:30,594 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.031, Acc: 0.948, Base Lr: 6.04e-04
2022-04-25 22:33:55,206 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.034, Acc: 0.943, Base Lr: 6.04e-04
2022-04-25 22:34:14,150 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.258[s] Speed: 62.1[samples/s]
2022-04-25 22:35:14,052 reid_baseline.train INFO: normal accuracy 0.5216892357126464 2.211338758468628 
2022-04-25 22:35:14,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 22:35:14,057 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 221.1%
2022-04-25 22:35:40,232 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.025, Acc: 0.947, Base Lr: 4.51e-04
2022-04-25 22:36:05,499 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.024, Acc: 0.949, Base Lr: 4.51e-04
2022-04-25 22:36:24,834 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.259[s] Speed: 61.8[samples/s]
2022-04-25 22:37:23,133 reid_baseline.train INFO: normal accuracy 0.5228368143217811 2.2164101600646973 
2022-04-25 22:37:23,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 22:37:23,138 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 221.6%
2022-04-25 22:37:46,103 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.040, Acc: 0.932, Base Lr: 3.20e-04
2022-04-25 22:38:06,375 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.036, Acc: 0.939, Base Lr: 3.20e-04
2022-04-25 22:38:21,655 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.213[s] Speed: 74.9[samples/s]
2022-04-25 22:39:22,033 reid_baseline.train INFO: normal accuracy 0.5193940784943769 2.1910104751586914 
2022-04-25 22:39:22,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 22:39:22,038 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 219.1%
2022-04-25 22:39:47,379 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.018, Acc: 0.947, Base Lr: 2.11e-04
2022-04-25 22:40:11,445 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.025, Acc: 0.945, Base Lr: 2.11e-04
2022-04-25 22:40:29,913 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.248[s] Speed: 64.4[samples/s]
2022-04-25 22:41:27,320 reid_baseline.train INFO: normal accuracy 0.51916456277255 2.177482843399048 
2022-04-25 22:41:28,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 22:41:28,213 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 217.7%
2022-04-25 22:41:53,768 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.039, Acc: 0.935, Base Lr: 1.26e-04
2022-04-25 22:42:19,052 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.026, Acc: 0.943, Base Lr: 1.26e-04
2022-04-25 22:42:37,211 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-25 22:43:36,856 reid_baseline.train INFO: normal accuracy 0.5214597199908194 2.1730844974517822 
2022-04-25 22:43:37,645 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 22:43:37,645 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 217.3%
2022-04-25 22:43:54,291 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.028, Acc: 0.943, Base Lr: 6.51e-05
2022-04-25 22:44:21,609 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.027, Acc: 0.947, Base Lr: 6.51e-05
2022-04-25 22:44:39,720 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.227[s] Speed: 70.5[samples/s]
2022-04-25 22:45:39,791 reid_baseline.train INFO: normal accuracy 0.523066330043608 2.1986796855926514 
2022-04-25 22:45:39,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 22:45:39,795 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 219.9%
2022-04-25 22:46:06,738 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.009, Acc: 0.956, Base Lr: 2.83e-05
2022-04-25 22:46:33,029 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.015, Acc: 0.952, Base Lr: 2.83e-05
2022-04-25 22:46:43,432 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.232[s] Speed: 68.8[samples/s]
2022-04-25 22:47:41,313 reid_baseline.train INFO: normal accuracy 0.5173284369979344 2.1760363578796387 
2022-04-25 22:47:41,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 22:47:41,318 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 217.6%
2022-04-25 22:48:02,335 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.033, Acc: 0.941, Base Lr: 1.60e-05
2022-04-25 22:48:28,620 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.022, Acc: 0.946, Base Lr: 1.60e-05
2022-04-25 22:48:45,602 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.234[s] Speed: 68.5[samples/s]
2022-04-25 22:49:39,905 reid_baseline.train INFO: normal accuracy 0.5200826256598577 2.175748825073242 
2022-04-25 22:49:39,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 22:49:39,907 reid_baseline.train INFO: Accuracy: 52.0% Mean Entropy: 217.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 22:50:38,738 reid_baseline.train INFO: normal accuracy 0.5214597199908194 2.1730844974517822 
2022-04-25 22:50:38,739 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:50:38,739 reid_baseline.train INFO: Accuracy: 52.1%
2022-04-25 22:51:31,194 reid_baseline.train INFO: normal accuracy 0.5214597199908194 2.1730844974517822 
2022-04-25 22:51:31,194 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:51:31,194 reid_baseline.train INFO: Shuffled Accuracy: 52.1%
2022-04-25 22:52:23,235 reid_baseline.train INFO: normal accuracy 0.9287514318442154 1.1182960271835327 
2022-04-25 22:52:23,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:52:23,236 reid_baseline.train INFO: Source Clean Accuracy: 92.9%
2022-04-25 22:52:27,758 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_6
2022-04-25 22:52:27,758 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-25 22:52:27,758 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 22:52:27,758 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 22:52:27,759 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 22:52:40,246 reid_baseline.train INFO: start training
2022-04-25 22:53:04,389 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.089, Base Lr: 4.76e-04
2022-04-25 22:53:25,120 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.127, Base Lr: 4.76e-04
2022-04-25 22:53:40,965 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.222[s] Speed: 72.2[samples/s]
2022-04-25 22:54:08,049 reid_baseline.train INFO: normal accuracy 0.09105892047795633 4.168301105499268 
2022-04-25 22:54:09,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 22:54:09,847 reid_baseline.train INFO: Accuracy: 9.1% Mean Entropy: 416.8%
2022-04-25 22:54:35,471 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.959, Acc: 0.213, Base Lr: 8.72e-04
2022-04-25 22:54:59,861 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.906, Acc: 0.212, Base Lr: 8.72e-04
2022-04-25 22:55:19,490 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-25 22:55:49,523 reid_baseline.train INFO: normal accuracy 0.09641532756489493 4.126412391662598 
2022-04-25 22:55:50,302 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 22:55:50,303 reid_baseline.train INFO: Accuracy: 9.6% Mean Entropy: 412.6%
2022-04-25 22:56:13,333 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.683, Acc: 0.221, Base Lr: 1.27e-03
2022-04-25 22:56:38,770 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.630, Acc: 0.223, Base Lr: 1.27e-03
2022-04-25 22:56:57,279 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-25 22:57:29,936 reid_baseline.train INFO: normal accuracy 0.12525751957148742 4.01430606842041 
2022-04-25 22:57:31,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 22:57:31,409 reid_baseline.train INFO: Accuracy: 12.5% Mean Entropy: 401.4%
2022-04-25 22:57:56,299 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.347, Acc: 0.281, Base Lr: 1.66e-03
2022-04-25 22:58:17,920 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.333, Acc: 0.283, Base Lr: 1.66e-03
2022-04-25 22:58:36,938 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.240[s] Speed: 66.7[samples/s]
2022-04-25 22:59:08,319 reid_baseline.train INFO: normal accuracy 0.15286361763494025 3.8679802417755127 
2022-04-25 22:59:09,128 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 22:59:09,128 reid_baseline.train INFO: Accuracy: 15.3% Mean Entropy: 386.8%
2022-04-25 22:59:32,142 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.122, Acc: 0.316, Base Lr: 2.06e-03
2022-04-25 22:59:56,933 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.059, Acc: 0.345, Base Lr: 2.06e-03
2022-04-25 23:00:16,270 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 23:00:48,102 reid_baseline.train INFO: normal accuracy 0.1796456530696333 3.71549916267395 
2022-04-25 23:00:48,905 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 23:00:48,905 reid_baseline.train INFO: Accuracy: 18.0% Mean Entropy: 371.5%
2022-04-25 23:01:14,245 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.876, Acc: 0.386, Base Lr: 2.46e-03
2022-04-25 23:01:38,289 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.829, Acc: 0.400, Base Lr: 2.46e-03
2022-04-25 23:01:57,513 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-25 23:02:27,769 reid_baseline.train INFO: normal accuracy 0.21013597033374537 3.5828826427459717 
2022-04-25 23:02:28,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 23:02:28,885 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 358.3%
2022-04-25 23:02:50,315 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.614, Acc: 0.467, Base Lr: 2.85e-03
2022-04-25 23:03:15,389 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.605, Acc: 0.465, Base Lr: 2.85e-03
2022-04-25 23:03:34,768 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.241[s] Speed: 66.3[samples/s]
2022-04-25 23:04:03,992 reid_baseline.train INFO: normal accuracy 0.2323856613102596 3.470625877380371 
2022-04-25 23:04:04,782 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 23:04:04,783 reid_baseline.train INFO: Accuracy: 23.2% Mean Entropy: 347.1%
2022-04-25 23:04:30,298 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.418, Acc: 0.527, Base Lr: 3.25e-03
2022-04-25 23:04:54,311 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.414, Acc: 0.523, Base Lr: 3.25e-03
2022-04-25 23:05:12,799 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.249[s] Speed: 64.2[samples/s]
2022-04-25 23:05:43,729 reid_baseline.train INFO: normal accuracy 0.2550473836011537 3.3559584617614746 
2022-04-25 23:05:44,518 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 23:05:44,518 reid_baseline.train INFO: Accuracy: 25.5% Mean Entropy: 335.6%
2022-04-25 23:06:09,343 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.274, Acc: 0.552, Base Lr: 3.64e-03
2022-04-25 23:06:33,063 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.241, Acc: 0.567, Base Lr: 3.64e-03
2022-04-25 23:06:51,146 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.244[s] Speed: 65.6[samples/s]
2022-04-25 23:07:19,478 reid_baseline.train INFO: normal accuracy 0.2723526988051092 3.202958345413208 
2022-04-25 23:07:20,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 23:07:20,400 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 320.3%
2022-04-25 23:07:38,340 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.107, Acc: 0.614, Base Lr: 4.04e-03
2022-04-25 23:07:59,187 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.108, Acc: 0.611, Base Lr: 4.04e-03
2022-04-25 23:08:14,696 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.199[s] Speed: 80.5[samples/s]
2022-04-25 23:08:47,193 reid_baseline.train INFO: normal accuracy 0.2875978574371652 3.143921375274658 
2022-04-25 23:08:47,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 23:08:47,980 reid_baseline.train INFO: Accuracy: 28.8% Mean Entropy: 314.4%
2022-04-25 23:09:12,235 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.979, Acc: 0.639, Base Lr: 4.44e-03
2022-04-25 23:09:37,935 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.973, Acc: 0.635, Base Lr: 4.44e-03
2022-04-25 23:09:55,511 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.247[s] Speed: 64.7[samples/s]
2022-04-25 23:10:28,725 reid_baseline.train INFO: normal accuracy 0.2937783271528636 2.9860315322875977 
2022-04-25 23:10:29,517 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 23:10:29,517 reid_baseline.train INFO: Accuracy: 29.4% Mean Entropy: 298.6%
2022-04-25 23:10:50,511 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.835, Acc: 0.678, Base Lr: 4.83e-03
2022-04-25 23:11:16,912 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.850, Acc: 0.681, Base Lr: 4.83e-03
2022-04-25 23:11:33,711 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.235[s] Speed: 68.1[samples/s]
2022-04-25 23:12:06,924 reid_baseline.train INFO: normal accuracy 0.30366707869798104 2.9363508224487305 
2022-04-25 23:12:07,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 23:12:07,858 reid_baseline.train INFO: Accuracy: 30.4% Mean Entropy: 293.6%
2022-04-25 23:12:31,665 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.786, Acc: 0.703, Base Lr: 5.23e-03
2022-04-25 23:12:57,299 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.749, Acc: 0.710, Base Lr: 5.23e-03
2022-04-25 23:13:15,025 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 23:13:46,297 reid_baseline.train INFO: normal accuracy 0.31437989287185825 2.824267625808716 
2022-04-25 23:13:47,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 23:13:47,263 reid_baseline.train INFO: Accuracy: 31.4% Mean Entropy: 282.4%
2022-04-25 23:14:11,516 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.709, Acc: 0.720, Base Lr: 5.62e-03
2022-04-25 23:14:38,840 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.691, Acc: 0.727, Base Lr: 5.62e-03
2022-04-25 23:14:55,420 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.250[s] Speed: 64.1[samples/s]
2022-04-25 23:15:26,462 reid_baseline.train INFO: normal accuracy 0.3197362999587969 2.7388980388641357 
2022-04-25 23:15:27,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 23:15:27,343 reid_baseline.train INFO: Accuracy: 32.0% Mean Entropy: 273.9%
2022-04-25 23:15:51,126 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.567, Acc: 0.769, Base Lr: 6.02e-03
2022-04-25 23:16:17,236 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.588, Acc: 0.754, Base Lr: 6.02e-03
2022-04-25 23:16:34,769 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-25 23:17:06,159 reid_baseline.train INFO: normal accuracy 0.3259167696744953 2.7306344509124756 
2022-04-25 23:17:06,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 23:17:06,976 reid_baseline.train INFO: Accuracy: 32.6% Mean Entropy: 273.1%
2022-04-25 23:17:28,411 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.488, Acc: 0.793, Base Lr: 6.42e-03
2022-04-25 23:17:55,937 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.495, Acc: 0.786, Base Lr: 6.42e-03
2022-04-25 23:18:13,365 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.243[s] Speed: 65.8[samples/s]
2022-04-25 23:18:45,271 reid_baseline.train INFO: normal accuracy 0.3300370828182942 2.6626389026641846 
2022-04-25 23:18:46,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 23:18:46,057 reid_baseline.train INFO: Accuracy: 33.0% Mean Entropy: 266.3%
2022-04-25 23:19:09,153 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.466, Acc: 0.800, Base Lr: 6.81e-03
2022-04-25 23:19:35,468 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.474, Acc: 0.790, Base Lr: 6.81e-03
2022-04-25 23:19:53,165 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.246[s] Speed: 65.1[samples/s]
2022-04-25 23:20:27,248 reid_baseline.train INFO: normal accuracy 0.3333333333333333 2.6568472385406494 
2022-04-25 23:20:28,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 23:20:28,155 reid_baseline.train INFO: Accuracy: 33.3% Mean Entropy: 265.7%
2022-04-25 23:20:50,939 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.405, Acc: 0.812, Base Lr: 7.21e-03
2022-04-25 23:21:17,702 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.421, Acc: 0.809, Base Lr: 7.21e-03
2022-04-25 23:21:31,791 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 23:21:58,191 reid_baseline.train INFO: normal accuracy 0.3440461475072106 2.598778486251831 
2022-04-25 23:21:59,003 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 23:21:59,003 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 259.9%
2022-04-25 23:22:19,829 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.336, Acc: 0.846, Base Lr: 7.60e-03
2022-04-25 23:22:46,312 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.356, Acc: 0.837, Base Lr: 7.60e-03
2022-04-25 23:23:03,808 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.237[s] Speed: 67.4[samples/s]
2022-04-25 23:23:34,641 reid_baseline.train INFO: normal accuracy 0.3288009888751545 2.6095621585845947 
2022-04-25 23:23:34,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 23:23:34,642 reid_baseline.train INFO: Accuracy: 32.9% Mean Entropy: 261.0%
2022-04-25 23:23:57,821 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.271, Acc: 0.866, Base Lr: 4.01e-03
2022-04-25 23:24:23,519 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.265, Acc: 0.869, Base Lr: 4.01e-03
2022-04-25 23:24:40,986 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-25 23:25:12,115 reid_baseline.train INFO: normal accuracy 0.34569427276473014 2.5779387950897217 
2022-04-25 23:25:13,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 23:25:13,058 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 257.8%
2022-04-25 23:25:36,506 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.210, Acc: 0.888, Base Lr: 3.69e-03
2022-04-25 23:26:02,543 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.199, Acc: 0.887, Base Lr: 3.69e-03
2022-04-25 23:26:19,996 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.245[s] Speed: 65.3[samples/s]
2022-04-25 23:26:51,800 reid_baseline.train INFO: normal accuracy 0.34322208487845074 2.5755603313446045 
2022-04-25 23:26:52,603 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 23:26:52,603 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 257.6%
2022-04-25 23:27:15,207 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.186, Acc: 0.892, Base Lr: 3.38e-03
2022-04-25 23:27:40,633 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.186, Acc: 0.895, Base Lr: 3.38e-03
2022-04-25 23:27:58,498 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.241[s] Speed: 66.5[samples/s]
2022-04-25 23:28:28,648 reid_baseline.train INFO: normal accuracy 0.34239802224969096 2.5391838550567627 
2022-04-25 23:28:29,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 23:28:29,442 reid_baseline.train INFO: Accuracy: 34.2% Mean Entropy: 253.9%
2022-04-25 23:28:55,171 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.174, Acc: 0.897, Base Lr: 3.08e-03
2022-04-25 23:29:19,788 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.175, Acc: 0.896, Base Lr: 3.08e-03
2022-04-25 23:29:36,338 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.245[s] Speed: 65.4[samples/s]
2022-04-25 23:30:06,624 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.534292221069336 
2022-04-25 23:30:07,752 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 23:30:07,752 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 253.4%
2022-04-25 23:30:33,805 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.128, Acc: 0.913, Base Lr: 2.77e-03
2022-04-25 23:30:57,378 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.144, Acc: 0.907, Base Lr: 2.77e-03
2022-04-25 23:31:15,746 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.249[s] Speed: 64.3[samples/s]
2022-04-25 23:31:45,374 reid_baseline.train INFO: normal accuracy 0.35022661722290893 2.4900307655334473 
2022-04-25 23:31:46,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 23:31:46,400 reid_baseline.train INFO: Accuracy: 35.0% Mean Entropy: 249.0%
2022-04-25 23:32:12,066 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.139, Acc: 0.912, Base Lr: 2.48e-03
2022-04-25 23:32:33,712 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.129, Acc: 0.912, Base Lr: 2.48e-03
2022-04-25 23:32:50,799 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.236[s] Speed: 67.8[samples/s]
2022-04-25 23:33:21,013 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.510206937789917 
2022-04-25 23:33:21,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 23:33:21,017 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 251.0%
2022-04-25 23:33:45,574 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.094, Acc: 0.933, Base Lr: 2.20e-03
2022-04-25 23:34:07,203 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.108, Acc: 0.919, Base Lr: 2.20e-03
2022-04-25 23:34:25,646 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.237[s] Speed: 67.6[samples/s]
2022-04-25 23:34:54,431 reid_baseline.train INFO: normal accuracy 0.3522867737948084 2.551377058029175 
2022-04-25 23:34:54,435 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 23:34:54,435 reid_baseline.train INFO: Accuracy: 35.2% Mean Entropy: 255.1%
2022-04-25 23:35:19,318 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.092, Acc: 0.918, Base Lr: 1.92e-03
2022-04-25 23:35:43,022 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.092, Acc: 0.921, Base Lr: 1.92e-03
2022-04-25 23:36:02,007 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.247[s] Speed: 64.7[samples/s]
2022-04-25 23:36:28,573 reid_baseline.train INFO: normal accuracy 0.34940255459414915 2.4940004348754883 
2022-04-25 23:36:28,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 23:36:28,576 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 249.4%
2022-04-25 23:36:50,152 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.105, Acc: 0.926, Base Lr: 1.66e-03
2022-04-25 23:37:08,604 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.089, Acc: 0.930, Base Lr: 1.66e-03
2022-04-25 23:37:27,189 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-25 23:37:55,007 reid_baseline.train INFO: normal accuracy 0.3440461475072106 2.504833936691284 
2022-04-25 23:37:55,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 23:37:55,010 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 250.5%
2022-04-25 23:38:19,363 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.072, Acc: 0.933, Base Lr: 1.42e-03
2022-04-25 23:38:40,918 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.070, Acc: 0.931, Base Lr: 1.42e-03
2022-04-25 23:39:00,222 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 23:39:30,781 reid_baseline.train INFO: normal accuracy 0.3440461475072106 2.5155508518218994 
2022-04-25 23:39:30,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 23:39:30,785 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 251.6%
2022-04-25 23:39:56,985 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.063, Acc: 0.936, Base Lr: 1.19e-03
2022-04-25 23:40:17,932 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.062, Acc: 0.933, Base Lr: 1.19e-03
2022-04-25 23:40:37,154 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.243[s] Speed: 65.8[samples/s]
2022-04-25 23:41:07,250 reid_baseline.train INFO: normal accuracy 0.3403378656777915 2.5292046070098877 
2022-04-25 23:41:07,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 23:41:07,253 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 252.9%
2022-04-25 23:41:32,495 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.056, Acc: 0.936, Base Lr: 9.72e-04
2022-04-25 23:41:53,463 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.047, Acc: 0.935, Base Lr: 9.72e-04
2022-04-25 23:42:12,426 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-25 23:42:44,970 reid_baseline.train INFO: normal accuracy 0.3481664606510095 2.506429433822632 
2022-04-25 23:42:44,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 23:42:44,973 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 250.6%
2022-04-25 23:43:07,739 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.054, Acc: 0.934, Base Lr: 7.78e-04
2022-04-25 23:43:28,570 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.054, Acc: 0.933, Base Lr: 7.78e-04
2022-04-25 23:43:48,686 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.233[s] Speed: 68.6[samples/s]
2022-04-25 23:44:19,966 reid_baseline.train INFO: normal accuracy 0.34363411619283063 2.509986400604248 
2022-04-25 23:44:19,971 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 23:44:19,971 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 251.0%
2022-04-25 23:44:44,491 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.039, Acc: 0.943, Base Lr: 6.04e-04
2022-04-25 23:45:05,599 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.041, Acc: 0.943, Base Lr: 6.04e-04
2022-04-25 23:45:24,531 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.236[s] Speed: 67.7[samples/s]
2022-04-25 23:45:57,924 reid_baseline.train INFO: normal accuracy 0.34528224145035025 2.5107674598693848 
2022-04-25 23:45:57,928 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 23:45:57,928 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 251.1%
2022-04-25 23:46:23,343 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.030, Acc: 0.942, Base Lr: 4.51e-04
2022-04-25 23:46:46,513 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.031, Acc: 0.944, Base Lr: 4.51e-04
2022-04-25 23:47:06,866 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-25 23:47:39,741 reid_baseline.train INFO: normal accuracy 0.3481664606510095 2.5324792861938477 
2022-04-25 23:47:39,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 23:47:39,743 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 253.2%
2022-04-25 23:48:09,692 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.049, Acc: 0.931, Base Lr: 3.20e-04
2022-04-25 23:48:35,944 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.043, Acc: 0.936, Base Lr: 3.20e-04
2022-04-25 23:48:56,159 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.280[s] Speed: 57.2[samples/s]
2022-04-25 23:49:29,113 reid_baseline.train INFO: normal accuracy 0.34528224145035025 2.509418249130249 
2022-04-25 23:49:29,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 23:49:29,118 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 250.9%
2022-04-25 23:49:58,071 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.024, Acc: 0.942, Base Lr: 2.11e-04
2022-04-25 23:50:23,737 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.029, Acc: 0.945, Base Lr: 2.11e-04
2022-04-25 23:50:45,689 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.280[s] Speed: 57.0[samples/s]
2022-04-25 23:51:18,148 reid_baseline.train INFO: normal accuracy 0.34857849196538937 2.4987874031066895 
2022-04-25 23:51:18,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 23:51:18,153 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 249.9%
2022-04-25 23:51:46,193 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.041, Acc: 0.945, Base Lr: 1.26e-04
2022-04-25 23:52:11,796 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.030, Acc: 0.946, Base Lr: 1.26e-04
2022-04-25 23:52:33,318 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.275[s] Speed: 58.1[samples/s]
2022-04-25 23:53:08,268 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.4806482791900635 
2022-04-25 23:53:10,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 23:53:10,319 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 248.1%
2022-04-25 23:53:40,929 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.037, Acc: 0.938, Base Lr: 6.51e-05
2022-04-25 23:54:08,974 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.032, Acc: 0.943, Base Lr: 6.51e-05
2022-04-25 23:54:28,605 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-25 23:54:51,663 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.517881393432617 
2022-04-25 23:54:51,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 23:54:51,664 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 251.8%
2022-04-25 23:55:13,050 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.019, Acc: 0.949, Base Lr: 2.83e-05
2022-04-25 23:55:40,194 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.023, Acc: 0.947, Base Lr: 2.83e-05
2022-04-25 23:55:59,602 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.249[s] Speed: 64.4[samples/s]
2022-04-25 23:56:29,183 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.499526262283325 
2022-04-25 23:56:29,183 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 23:56:29,183 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 250.0%
2022-04-25 23:57:01,838 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.044, Acc: 0.940, Base Lr: 1.60e-05
2022-04-25 23:57:29,425 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.032, Acc: 0.942, Base Lr: 1.60e-05
2022-04-25 23:57:49,418 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.294[s] Speed: 54.5[samples/s]
2022-04-25 23:58:24,946 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.4910237789154053 
2022-04-25 23:58:24,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 23:58:24,949 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 249.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_6/transformer_best_model.pth
2022-04-25 23:58:57,064 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.4806482791900635 
2022-04-25 23:58:57,065 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:58:57,065 reid_baseline.train INFO: Accuracy: 34.7%
2022-04-25 23:59:29,930 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.4806482791900635 
2022-04-25 23:59:29,931 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:59:29,931 reid_baseline.train INFO: Shuffled Accuracy: 34.7%
2022-04-26 00:00:22,211 reid_baseline.train INFO: normal accuracy 0.9310423825887744 1.0953397750854492 
2022-04-26 00:00:22,211 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 00:00:22,211 reid_baseline.train INFO: Source Clean Accuracy: 93.1%
2022-04-26 00:00:28,922 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_6
2022-04-26 00:00:28,922 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-26 00:00:28,922 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:00:28,922 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:00:28,923 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:00:44,856 reid_baseline.train INFO: start training
2022-04-26 00:00:55,395 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_6
2022-04-26 00:00:55,396 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-26 00:00:55,396 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:00:55,396 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:00:55,397 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:01:18,238 reid_baseline.train INFO: start training
2022-04-26 00:01:47,613 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.089, Base Lr: 4.76e-04
2022-04-26 00:02:12,967 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.127, Base Lr: 4.76e-04
2022-04-26 00:02:30,685 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.263[s] Speed: 60.8[samples/s]
2022-04-26 00:03:49,111 reid_baseline.train INFO: normal accuracy 0.1264631627266468 4.168277263641357 
2022-04-26 00:03:50,564 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:03:50,564 reid_baseline.train INFO: Accuracy: 12.6% Mean Entropy: 416.8%
2022-04-26 00:04:19,121 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.959, Acc: 0.213, Base Lr: 8.72e-04
2022-04-26 00:04:47,595 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.906, Acc: 0.212, Base Lr: 8.72e-04
2022-04-26 00:05:10,556 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.293[s] Speed: 54.7[samples/s]
2022-04-26 00:06:32,175 reid_baseline.train INFO: normal accuracy 0.13426669726876292 4.122837543487549 
2022-04-26 00:06:34,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 00:06:34,467 reid_baseline.train INFO: Accuracy: 13.4% Mean Entropy: 412.3%
2022-04-26 00:07:08,075 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.683, Acc: 0.221, Base Lr: 1.27e-03
2022-04-26 00:07:37,582 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.630, Acc: 0.223, Base Lr: 1.27e-03
2022-04-26 00:07:57,418 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.303[s] Speed: 52.7[samples/s]
2022-04-26 00:09:20,300 reid_baseline.train INFO: normal accuracy 0.17053018131742023 4.003573417663574 
2022-04-26 00:09:21,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:09:21,514 reid_baseline.train INFO: Accuracy: 17.1% Mean Entropy: 400.4%
2022-04-26 00:09:46,590 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.347, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 00:10:14,838 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.333, Acc: 0.283, Base Lr: 1.66e-03
2022-04-26 00:10:34,770 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.268[s] Speed: 59.6[samples/s]
2022-04-26 00:11:49,785 reid_baseline.train INFO: normal accuracy 0.20908882258434702 3.8330416679382324 
2022-04-26 00:11:51,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:11:51,593 reid_baseline.train INFO: Accuracy: 20.9% Mean Entropy: 383.3%
2022-04-26 00:12:19,904 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.122, Acc: 0.316, Base Lr: 2.06e-03
2022-04-26 00:12:43,070 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.059, Acc: 0.345, Base Lr: 2.06e-03
2022-04-26 00:12:58,329 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.244[s] Speed: 65.6[samples/s]
2022-04-26 00:13:31,707 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_8
2022-04-26 00:13:31,707 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 00:13:31,708 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:13:31,708 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:13:31,708 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:13:51,172 reid_baseline.train INFO: start training
2022-04-26 00:14:20,165 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.088, Base Lr: 4.76e-04
2022-04-26 00:14:46,571 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.123, Base Lr: 4.76e-04
2022-04-26 00:15:06,620 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-04-26 00:15:32,926 reid_baseline.train INFO: normal accuracy 0.09105892047795633 4.168499946594238 
2022-04-26 00:15:34,071 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:15:34,071 reid_baseline.train INFO: Accuracy: 9.1% Mean Entropy: 416.8%
2022-04-26 00:15:51,602 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.960, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 00:16:14,403 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.906, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 00:16:34,694 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.222[s] Speed: 72.1[samples/s]
2022-04-26 00:17:07,702 reid_baseline.train INFO: normal accuracy 0.09723939019365471 4.129143714904785 
2022-04-26 00:17:09,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 00:17:09,012 reid_baseline.train INFO: Accuracy: 9.7% Mean Entropy: 412.9%
2022-04-26 00:17:36,883 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.678, Acc: 0.219, Base Lr: 1.27e-03
2022-04-26 00:18:02,448 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.622, Acc: 0.235, Base Lr: 1.27e-03
2022-04-26 00:18:23,659 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.273[s] Speed: 58.5[samples/s]
2022-04-26 00:18:58,324 reid_baseline.train INFO: normal accuracy 0.12484548825710753 4.014577388763428 
2022-04-26 00:18:59,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:18:59,542 reid_baseline.train INFO: Accuracy: 12.5% Mean Entropy: 401.5%
2022-04-26 00:19:33,025 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.332, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 00:20:00,631 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.313, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 00:20:21,590 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-26 00:20:55,090 reid_baseline.train INFO: normal accuracy 0.15327564894932014 3.855537176132202 
2022-04-26 00:20:56,535 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:20:56,536 reid_baseline.train INFO: Accuracy: 15.3% Mean Entropy: 385.6%
2022-04-26 00:21:26,519 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.095, Acc: 0.318, Base Lr: 2.06e-03
2022-04-26 00:21:53,336 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.031, Acc: 0.351, Base Lr: 2.06e-03
2022-04-26 00:22:11,101 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.273[s] Speed: 58.7[samples/s]
2022-04-26 00:22:41,893 reid_baseline.train INFO: normal accuracy 0.17593737124021425 3.70076060295105 
2022-04-26 00:22:43,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 00:22:43,323 reid_baseline.train INFO: Accuracy: 17.6% Mean Entropy: 370.1%
2022-04-26 00:23:16,801 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.853, Acc: 0.395, Base Lr: 2.46e-03
2022-04-26 00:23:40,812 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.809, Acc: 0.403, Base Lr: 2.46e-03
2022-04-26 00:24:00,430 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.282[s] Speed: 56.7[samples/s]
2022-04-26 00:24:31,442 reid_baseline.train INFO: normal accuracy 0.20642768850432633 3.5553340911865234 
2022-04-26 00:24:32,673 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 00:24:32,674 reid_baseline.train INFO: Accuracy: 20.6% Mean Entropy: 355.5%
2022-04-26 00:25:05,687 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.593, Acc: 0.468, Base Lr: 2.85e-03
2022-04-26 00:25:31,469 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.588, Acc: 0.467, Base Lr: 2.85e-03
2022-04-26 00:25:50,198 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.284[s] Speed: 56.4[samples/s]
2022-04-26 00:26:22,472 reid_baseline.train INFO: normal accuracy 0.24186238154099712 3.445253610610962 
2022-04-26 00:26:23,680 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 00:26:23,681 reid_baseline.train INFO: Accuracy: 24.2% Mean Entropy: 344.5%
2022-04-26 00:26:55,199 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.401, Acc: 0.541, Base Lr: 3.25e-03
2022-04-26 00:27:21,564 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.395, Acc: 0.533, Base Lr: 3.25e-03
2022-04-26 00:27:42,555 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.289[s] Speed: 55.4[samples/s]
2022-04-26 00:28:14,748 reid_baseline.train INFO: normal accuracy 0.2595797280593325 3.329765558242798 
2022-04-26 00:28:15,920 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 00:28:15,921 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 333.0%
2022-04-26 00:28:45,186 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.270, Acc: 0.541, Base Lr: 3.64e-03
2022-04-26 00:29:11,805 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.229, Acc: 0.563, Base Lr: 3.64e-03
2022-04-26 00:29:33,045 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.282[s] Speed: 56.6[samples/s]
2022-04-26 00:30:08,227 reid_baseline.train INFO: normal accuracy 0.2723526988051092 3.1704163551330566 
2022-04-26 00:30:09,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 00:30:09,028 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 317.0%
2022-04-26 00:30:35,782 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.089, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 00:31:03,439 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.094, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 00:31:24,395 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 00:31:59,184 reid_baseline.train INFO: normal accuracy 0.2937783271528636 3.11226487159729 
2022-04-26 00:32:00,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 00:32:00,261 reid_baseline.train INFO: Accuracy: 29.4% Mean Entropy: 311.2%
2022-04-26 00:32:30,377 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.961, Acc: 0.640, Base Lr: 4.44e-03
2022-04-26 00:32:56,579 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.956, Acc: 0.642, Base Lr: 4.44e-03
2022-04-26 00:33:16,309 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-26 00:33:52,640 reid_baseline.train INFO: normal accuracy 0.3073753605274001 2.9737393856048584 
2022-04-26 00:33:54,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 00:33:54,239 reid_baseline.train INFO: Accuracy: 30.7% Mean Entropy: 297.4%
2022-04-26 00:34:24,055 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.826, Acc: 0.676, Base Lr: 4.83e-03
2022-04-26 00:34:48,433 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.846, Acc: 0.669, Base Lr: 4.83e-03
2022-04-26 00:35:09,266 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.274[s] Speed: 58.3[samples/s]
2022-04-26 00:35:43,580 reid_baseline.train INFO: normal accuracy 0.31396786155747836 2.9291868209838867 
2022-04-26 00:35:44,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 00:35:44,880 reid_baseline.train INFO: Accuracy: 31.4% Mean Entropy: 292.9%
2022-04-26 00:36:13,838 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.765, Acc: 0.708, Base Lr: 5.23e-03
2022-04-26 00:36:39,466 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.737, Acc: 0.713, Base Lr: 5.23e-03
2022-04-26 00:37:00,241 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 00:37:36,063 reid_baseline.train INFO: normal accuracy 0.3180881747012773 2.8262410163879395 
2022-04-26 00:37:37,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 00:37:37,182 reid_baseline.train INFO: Accuracy: 31.8% Mean Entropy: 282.6%
2022-04-26 00:38:03,645 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.699, Acc: 0.723, Base Lr: 5.62e-03
2022-04-26 00:38:28,720 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.669, Acc: 0.734, Base Lr: 5.62e-03
2022-04-26 00:38:47,988 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.259[s] Speed: 61.7[samples/s]
2022-04-26 00:39:21,415 reid_baseline.train INFO: normal accuracy 0.3222084878450762 2.7281529903411865 
2022-04-26 00:39:22,686 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 00:39:22,686 reid_baseline.train INFO: Accuracy: 32.2% Mean Entropy: 272.8%
2022-04-26 00:39:48,573 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.558, Acc: 0.766, Base Lr: 6.02e-03
2022-04-26 00:40:15,750 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.579, Acc: 0.758, Base Lr: 6.02e-03
2022-04-26 00:40:37,544 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.274[s] Speed: 58.4[samples/s]
2022-04-26 00:41:13,691 reid_baseline.train INFO: normal accuracy 0.32715286361763496 2.6879987716674805 
2022-04-26 00:41:14,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 00:41:14,908 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 268.8%
2022-04-26 00:41:42,625 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.490, Acc: 0.794, Base Lr: 6.42e-03
2022-04-26 00:42:10,482 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.494, Acc: 0.791, Base Lr: 6.42e-03
2022-04-26 00:42:31,142 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-26 00:43:06,229 reid_baseline.train INFO: normal accuracy 0.334569427276473 2.619915723800659 
2022-04-26 00:43:07,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 00:43:07,453 reid_baseline.train INFO: Accuracy: 33.5% Mean Entropy: 262.0%
2022-04-26 00:43:33,960 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.447, Acc: 0.798, Base Lr: 6.81e-03
2022-04-26 00:43:58,298 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.467, Acc: 0.791, Base Lr: 6.81e-03
2022-04-26 00:44:18,124 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.259[s] Speed: 61.8[samples/s]
2022-04-26 00:44:55,129 reid_baseline.train INFO: normal accuracy 0.3337453646477132 2.649898052215576 
2022-04-26 00:44:55,133 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 00:44:55,134 reid_baseline.train INFO: Accuracy: 33.4% Mean Entropy: 265.0%
2022-04-26 00:45:22,401 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.383, Acc: 0.824, Base Lr: 7.21e-03
2022-04-26 00:45:51,439 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.404, Acc: 0.823, Base Lr: 7.21e-03
2022-04-26 00:46:10,478 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 00:46:47,172 reid_baseline.train INFO: normal accuracy 0.3407498969921714 2.6094329357147217 
2022-04-26 00:46:48,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 00:46:48,505 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 260.9%
2022-04-26 00:47:16,094 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.341, Acc: 0.833, Base Lr: 7.60e-03
2022-04-26 00:47:46,839 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.362, Acc: 0.830, Base Lr: 7.60e-03
2022-04-26 00:48:08,023 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.290[s] Speed: 55.1[samples/s]
2022-04-26 00:48:40,545 reid_baseline.train INFO: normal accuracy 0.3407498969921714 2.6051392555236816 
2022-04-26 00:48:41,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 00:48:41,747 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 260.5%
2022-04-26 00:49:11,114 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.274, Acc: 0.851, Base Lr: 4.01e-03
2022-04-26 00:49:39,040 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.260, Acc: 0.858, Base Lr: 4.01e-03
2022-04-26 00:49:57,571 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.278[s] Speed: 57.6[samples/s]
2022-04-26 00:50:32,695 reid_baseline.train INFO: normal accuracy 0.34528224145035025 2.598564624786377 
2022-04-26 00:50:33,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 00:50:33,934 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 259.9%
2022-04-26 00:51:00,987 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.197, Acc: 0.893, Base Lr: 3.69e-03
2022-04-26 00:51:29,931 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.188, Acc: 0.895, Base Lr: 3.69e-03
2022-04-26 00:51:49,678 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.277[s] Speed: 57.7[samples/s]
2022-04-26 00:52:25,487 reid_baseline.train INFO: normal accuracy 0.3469303667078698 2.5664892196655273 
2022-04-26 00:52:26,599 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 00:52:26,599 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 256.6%
2022-04-26 00:52:54,241 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.207, Acc: 0.869, Base Lr: 3.38e-03
2022-04-26 00:53:22,222 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.195, Acc: 0.887, Base Lr: 3.38e-03
2022-04-26 00:53:42,697 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-26 00:54:16,025 reid_baseline.train INFO: normal accuracy 0.3407498969921714 2.571788787841797 
2022-04-26 00:54:16,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 00:54:16,030 reid_baseline.train INFO: Accuracy: 34.1% Mean Entropy: 257.2%
2022-04-26 00:54:44,003 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.174, Acc: 0.899, Base Lr: 3.08e-03
2022-04-26 00:55:14,449 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.902, Base Lr: 3.08e-03
2022-04-26 00:55:35,740 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.292[s] Speed: 54.8[samples/s]
2022-04-26 00:56:09,195 reid_baseline.train INFO: normal accuracy 0.34445817882159047 2.536836624145508 
2022-04-26 00:56:10,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 00:56:10,410 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 253.7%
2022-04-26 00:56:34,590 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.130, Acc: 0.910, Base Lr: 2.77e-03
2022-04-26 00:57:02,869 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.139, Acc: 0.906, Base Lr: 2.77e-03
2022-04-26 00:57:25,236 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.274[s] Speed: 58.4[samples/s]
2022-04-26 00:58:00,042 reid_baseline.train INFO: normal accuracy 0.34981458590852904 2.4702727794647217 
2022-04-26 00:58:01,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 00:58:01,255 reid_baseline.train INFO: Accuracy: 35.0% Mean Entropy: 247.0%
2022-04-26 00:58:28,267 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.143, Acc: 0.902, Base Lr: 2.48e-03
2022-04-26 00:58:57,063 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.130, Acc: 0.907, Base Lr: 2.48e-03
2022-04-26 00:59:17,525 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-26 00:59:51,887 reid_baseline.train INFO: normal accuracy 0.3395138030490317 2.5078938007354736 
2022-04-26 00:59:51,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 00:59:51,890 reid_baseline.train INFO: Accuracy: 34.0% Mean Entropy: 250.8%
2022-04-26 01:00:19,867 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.090, Acc: 0.926, Base Lr: 2.20e-03
2022-04-26 01:00:46,946 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.103, Acc: 0.920, Base Lr: 2.20e-03
2022-04-26 01:01:07,892 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.278[s] Speed: 57.5[samples/s]
2022-04-26 01:01:41,793 reid_baseline.train INFO: normal accuracy 0.3514627111660486 2.527911424636841 
2022-04-26 01:01:41,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 01:01:41,796 reid_baseline.train INFO: Accuracy: 35.1% Mean Entropy: 252.8%
2022-04-26 01:02:07,788 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.095, Acc: 0.918, Base Lr: 1.92e-03
2022-04-26 01:02:34,555 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.093, Acc: 0.919, Base Lr: 1.92e-03
2022-04-26 01:02:53,551 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.263[s] Speed: 60.9[samples/s]
2022-04-26 01:03:29,934 reid_baseline.train INFO: normal accuracy 0.3481664606510095 2.495086193084717 
2022-04-26 01:03:29,937 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 01:03:29,937 reid_baseline.train INFO: Accuracy: 34.8% Mean Entropy: 249.5%
2022-04-26 01:03:57,787 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.098, Acc: 0.921, Base Lr: 1.66e-03
2022-04-26 01:04:26,315 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.086, Acc: 0.927, Base Lr: 1.66e-03
2022-04-26 01:04:46,360 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.280[s] Speed: 57.2[samples/s]
2022-04-26 01:05:18,683 reid_baseline.train INFO: normal accuracy 0.34445817882159047 2.5249383449554443 
2022-04-26 01:05:18,687 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 01:05:18,688 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 252.5%
2022-04-26 01:05:42,804 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.064, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 01:06:12,976 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.065, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 01:06:31,960 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.268[s] Speed: 59.6[samples/s]
2022-04-26 01:07:07,934 reid_baseline.train INFO: normal accuracy 0.34528224145035025 2.5123629570007324 
2022-04-26 01:07:07,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 01:07:07,941 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 251.2%
2022-04-26 01:07:34,590 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.063, Acc: 0.939, Base Lr: 1.19e-03
2022-04-26 01:08:05,194 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.057, Acc: 0.938, Base Lr: 1.19e-03
2022-04-26 01:08:25,903 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-26 01:09:02,371 reid_baseline.train INFO: normal accuracy 0.34857849196538937 2.532808303833008 
2022-04-26 01:09:02,376 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 01:09:02,376 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 253.3%
2022-04-26 01:09:27,346 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.059, Acc: 0.934, Base Lr: 9.72e-04
2022-04-26 01:09:55,047 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.050, Acc: 0.936, Base Lr: 9.72e-04
2022-04-26 01:10:17,643 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-26 01:10:53,109 reid_baseline.train INFO: normal accuracy 0.3440461475072106 2.507200002670288 
2022-04-26 01:10:53,110 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 01:10:53,110 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 250.7%
2022-04-26 01:11:22,051 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.051, Acc: 0.938, Base Lr: 7.78e-04
2022-04-26 01:11:50,561 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.055, Acc: 0.937, Base Lr: 7.78e-04
2022-04-26 01:12:11,704 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.288[s] Speed: 55.6[samples/s]
2022-04-26 01:12:47,244 reid_baseline.train INFO: normal accuracy 0.34281005356407085 2.513780117034912 
2022-04-26 01:12:47,251 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 01:12:47,252 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 251.4%
2022-04-26 01:13:13,542 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.037, Acc: 0.948, Base Lr: 6.04e-04
2022-04-26 01:13:39,148 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.039, Acc: 0.943, Base Lr: 6.04e-04
2022-04-26 01:13:59,189 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.263[s] Speed: 60.7[samples/s]
2022-04-26 01:14:33,269 reid_baseline.train INFO: normal accuracy 0.34322208487845074 2.524766445159912 
2022-04-26 01:14:33,271 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 01:14:33,272 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 252.5%
2022-04-26 01:15:05,045 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.033, Acc: 0.942, Base Lr: 4.51e-04
2022-04-26 01:15:36,158 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.030, Acc: 0.943, Base Lr: 4.51e-04
2022-04-26 01:15:56,836 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.306[s] Speed: 52.3[samples/s]
2022-04-26 01:16:29,961 reid_baseline.train INFO: normal accuracy 0.3465183353934899 2.535712957382202 
2022-04-26 01:16:29,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 01:16:29,966 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 253.6%
2022-04-26 01:16:59,528 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.042, Acc: 0.938, Base Lr: 3.20e-04
2022-04-26 01:17:26,697 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.038, Acc: 0.943, Base Lr: 3.20e-04
2022-04-26 01:17:46,073 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.278[s] Speed: 57.5[samples/s]
2022-04-26 01:18:18,955 reid_baseline.train INFO: normal accuracy 0.3465183353934899 2.5245256423950195 
2022-04-26 01:18:18,956 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 01:18:18,956 reid_baseline.train INFO: Accuracy: 34.7% Mean Entropy: 252.5%
2022-04-26 01:18:45,839 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.026, Acc: 0.944, Base Lr: 2.11e-04
2022-04-26 01:19:15,432 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.031, Acc: 0.945, Base Lr: 2.11e-04
2022-04-26 01:19:35,520 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.280[s] Speed: 57.1[samples/s]
2022-04-26 01:20:07,423 reid_baseline.train INFO: normal accuracy 0.34857849196538937 2.520228624343872 
2022-04-26 01:20:07,426 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 01:20:07,426 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 252.0%
2022-04-26 01:20:36,998 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.041, Acc: 0.944, Base Lr: 1.26e-04
2022-04-26 01:21:06,028 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.031, Acc: 0.946, Base Lr: 1.26e-04
2022-04-26 01:21:24,466 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.282[s] Speed: 56.7[samples/s]
2022-04-26 01:21:57,645 reid_baseline.train INFO: normal accuracy 0.34281005356407085 2.4963793754577637 
2022-04-26 01:21:57,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 01:21:57,648 reid_baseline.train INFO: Accuracy: 34.3% Mean Entropy: 249.6%
2022-04-26 01:22:25,277 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.023, Acc: 0.951, Base Lr: 6.51e-05
2022-04-26 01:22:53,136 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.022, Acc: 0.952, Base Lr: 6.51e-05
2022-04-26 01:23:12,057 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.273[s] Speed: 58.7[samples/s]
2022-04-26 01:23:46,186 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.526765823364258 
2022-04-26 01:23:46,191 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 01:23:46,192 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 252.7%
2022-04-26 01:24:12,889 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.019, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 01:24:39,037 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.021, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 01:24:59,072 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.267[s] Speed: 59.9[samples/s]
2022-04-26 01:25:32,721 reid_baseline.train INFO: normal accuracy 0.34487021013597036 2.5058481693267822 
2022-04-26 01:25:32,726 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 01:25:32,726 reid_baseline.train INFO: Accuracy: 34.5% Mean Entropy: 250.6%
2022-04-26 01:25:57,995 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 1.60e-05
2022-04-26 01:26:26,506 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.030, Acc: 0.945, Base Lr: 1.60e-05
2022-04-26 01:26:48,179 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.276[s] Speed: 57.9[samples/s]
2022-04-26 01:27:24,117 reid_baseline.train INFO: normal accuracy 0.34610630407911 2.4918389320373535 
2022-04-26 01:27:24,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 01:27:24,121 reid_baseline.train INFO: Accuracy: 34.6% Mean Entropy: 249.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_all_key_8/transformer_best_model.pth
2022-04-26 01:27:58,321 reid_baseline.train INFO: normal accuracy 0.34981458590852904 2.4702727794647217 
2022-04-26 01:27:58,321 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:27:58,321 reid_baseline.train INFO: Accuracy: 35.0%
2022-04-26 01:28:30,645 reid_baseline.train INFO: normal accuracy 0.34981458590852904 2.4702727794647217 
2022-04-26 01:28:30,645 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:28:30,645 reid_baseline.train INFO: Shuffled Accuracy: 35.0%
2022-04-26 01:29:26,254 reid_baseline.train INFO: normal accuracy 0.8893470790378006 1.3025598526000977 
2022-04-26 01:29:26,254 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:29:26,254 reid_baseline.train INFO: Source Clean Accuracy: 88.9%
2022-04-26 01:29:34,633 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_8
2022-04-26 01:29:34,633 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 01:29:34,634 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 01:29:34,634 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 01:29:34,634 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 01:29:52,675 reid_baseline.train INFO: start training
2022-04-26 01:30:25,971 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.088, Base Lr: 4.76e-04
2022-04-26 01:30:55,668 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.123, Base Lr: 4.76e-04
2022-04-26 01:31:17,709 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.310[s] Speed: 51.7[samples/s]
2022-04-26 01:32:06,029 reid_baseline.train INFO: normal accuracy 0.10678080648794773 4.169168949127197 
2022-04-26 01:32:06,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 01:32:06,949 reid_baseline.train INFO: Accuracy: 10.7% Mean Entropy: 416.9%
2022-04-26 01:32:29,690 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.960, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 01:32:58,396 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.906, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 01:33:19,369 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.265[s] Speed: 60.3[samples/s]
2022-04-26 01:34:15,352 reid_baseline.train INFO: normal accuracy 0.10678080648794773 4.132759094238281 
2022-04-26 01:34:16,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 01:34:16,596 reid_baseline.train INFO: Accuracy: 10.7% Mean Entropy: 413.3%
2022-04-26 01:34:44,277 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.678, Acc: 0.219, Base Lr: 1.27e-03
2022-04-26 01:35:12,092 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.622, Acc: 0.235, Base Lr: 1.27e-03
2022-04-26 01:35:32,704 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-26 01:36:10,662 reid_baseline.train INFO: normal accuracy 0.13629195764811894 4.023984909057617 
2022-04-26 01:36:12,043 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 01:36:12,043 reid_baseline.train INFO: Accuracy: 13.6% Mean Entropy: 402.4%
2022-04-26 01:36:31,225 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.332, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 01:36:58,720 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.313, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 01:37:20,133 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.249[s] Speed: 64.3[samples/s]
2022-04-26 01:38:04,786 reid_baseline.train INFO: normal accuracy 0.1874296012615454 3.8618521690368652 
2022-04-26 01:38:06,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 01:38:06,051 reid_baseline.train INFO: Accuracy: 18.7% Mean Entropy: 386.2%
2022-04-26 01:38:34,437 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.095, Acc: 0.318, Base Lr: 2.06e-03
2022-04-26 01:38:58,939 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.031, Acc: 0.351, Base Lr: 2.06e-03
2022-04-26 01:39:19,425 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-04-26 01:40:15,210 reid_baseline.train INFO: normal accuracy 0.22775399864834422 3.726977825164795 
2022-04-26 01:40:16,534 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 01:40:16,535 reid_baseline.train INFO: Accuracy: 22.8% Mean Entropy: 372.7%
2022-04-26 01:40:41,604 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.853, Acc: 0.395, Base Lr: 2.46e-03
2022-04-26 01:41:06,845 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.809, Acc: 0.403, Base Lr: 2.46e-03
2022-04-26 01:41:25,518 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.253[s] Speed: 63.4[samples/s]
2022-04-26 01:42:23,838 reid_baseline.train INFO: normal accuracy 0.29961703086280694 3.4954075813293457 
2022-04-26 01:42:24,929 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 01:42:24,930 reid_baseline.train INFO: Accuracy: 30.0% Mean Entropy: 349.5%
2022-04-26 01:42:51,774 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.593, Acc: 0.468, Base Lr: 2.85e-03
2022-04-26 01:43:18,995 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.588, Acc: 0.467, Base Lr: 2.85e-03
2022-04-26 01:43:36,969 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.264[s] Speed: 60.7[samples/s]
2022-04-26 01:44:30,780 reid_baseline.train INFO: normal accuracy 0.3439963955845911 3.3451952934265137 
2022-04-26 01:44:32,062 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 01:44:32,062 reid_baseline.train INFO: Accuracy: 34.4% Mean Entropy: 334.5%
2022-04-26 01:45:01,452 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.401, Acc: 0.541, Base Lr: 3.25e-03
2022-04-26 01:45:23,238 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.395, Acc: 0.533, Base Lr: 3.25e-03
2022-04-26 01:45:43,798 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.263[s] Speed: 60.9[samples/s]
2022-04-26 01:46:35,206 reid_baseline.train INFO: normal accuracy 0.3699031313358865 3.1877167224884033 
2022-04-26 01:46:36,420 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 01:46:36,420 reid_baseline.train INFO: Accuracy: 37.0% Mean Entropy: 318.8%
2022-04-26 01:47:06,301 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.270, Acc: 0.541, Base Lr: 3.64e-03
2022-04-26 01:47:33,877 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.229, Acc: 0.563, Base Lr: 3.64e-03
2022-04-26 01:47:51,244 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.274[s] Speed: 58.5[samples/s]
2022-04-26 01:48:43,976 reid_baseline.train INFO: normal accuracy 0.4005406623113314 3.040011167526245 
2022-04-26 01:48:45,373 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 01:48:45,374 reid_baseline.train INFO: Accuracy: 40.1% Mean Entropy: 304.0%
2022-04-26 01:49:09,936 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.089, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 01:49:36,585 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.094, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 01:49:56,492 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-26 01:50:34,490 reid_baseline.train INFO: normal accuracy 0.41856273935571076 2.880445718765259 
2022-04-26 01:50:35,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 01:50:35,733 reid_baseline.train INFO: Accuracy: 41.9% Mean Entropy: 288.0%
2022-04-26 01:50:55,421 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.961, Acc: 0.640, Base Lr: 4.44e-03
2022-04-26 01:51:09,200 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.956, Acc: 0.642, Base Lr: 4.44e-03
2022-04-26 01:51:21,247 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.167[s] Speed: 96.0[samples/s]
2022-04-26 01:51:53,946 reid_baseline.train INFO: normal accuracy 0.42396936246902456 2.820408344268799 
2022-04-26 01:51:55,180 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 01:51:55,181 reid_baseline.train INFO: Accuracy: 42.4% Mean Entropy: 282.0%
2022-04-26 01:52:11,724 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.826, Acc: 0.676, Base Lr: 4.83e-03
2022-04-26 01:52:28,051 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.846, Acc: 0.669, Base Lr: 4.83e-03
2022-04-26 01:52:40,235 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.165[s] Speed: 97.2[samples/s]
2022-04-26 01:53:13,079 reid_baseline.train INFO: normal accuracy 0.43838702410452807 2.6714820861816406 
2022-04-26 01:53:14,307 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 01:53:14,308 reid_baseline.train INFO: Accuracy: 43.8% Mean Entropy: 267.1%
2022-04-26 01:53:30,985 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.765, Acc: 0.708, Base Lr: 5.23e-03
2022-04-26 01:53:46,136 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.737, Acc: 0.713, Base Lr: 5.23e-03
2022-04-26 01:53:58,092 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.160[s] Speed: 100.1[samples/s]
2022-04-26 01:54:32,101 reid_baseline.train INFO: normal accuracy 0.46023879252083805 2.5446605682373047 
2022-04-26 01:54:33,379 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 01:54:33,380 reid_baseline.train INFO: Accuracy: 46.0% Mean Entropy: 254.5%
2022-04-26 01:54:49,182 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.699, Acc: 0.723, Base Lr: 5.62e-03
2022-04-26 01:55:04,146 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.669, Acc: 0.734, Base Lr: 5.62e-03
2022-04-26 01:55:15,970 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.155[s] Speed: 103.0[samples/s]
2022-04-26 01:55:47,220 reid_baseline.train INFO: normal accuracy 0.45415634151836 2.472701072692871 
2022-04-26 01:55:48,445 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 01:55:48,445 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 247.3%
2022-04-26 01:56:05,135 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.558, Acc: 0.766, Base Lr: 6.02e-03
2022-04-26 01:56:20,078 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.579, Acc: 0.758, Base Lr: 6.02e-03
2022-04-26 01:56:31,499 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.157[s] Speed: 102.0[samples/s]
2022-04-26 01:57:04,884 reid_baseline.train INFO: normal accuracy 0.46136517233611174 2.352501153945923 
2022-04-26 01:57:06,150 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 01:57:06,151 reid_baseline.train INFO: Accuracy: 46.1% Mean Entropy: 235.3%
2022-04-26 01:57:22,588 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.490, Acc: 0.794, Base Lr: 6.42e-03
2022-04-26 01:57:36,759 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.494, Acc: 0.791, Base Lr: 6.42e-03
2022-04-26 01:57:49,118 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.157[s] Speed: 101.7[samples/s]
2022-04-26 01:58:22,433 reid_baseline.train INFO: normal accuracy 0.4697003829691372 2.291334867477417 
2022-04-26 01:58:23,477 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 01:58:23,478 reid_baseline.train INFO: Accuracy: 47.0% Mean Entropy: 229.1%
2022-04-26 01:58:39,537 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.447, Acc: 0.798, Base Lr: 6.81e-03
2022-04-26 01:58:53,222 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.467, Acc: 0.791, Base Lr: 6.81e-03
2022-04-26 01:59:05,561 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.154[s] Speed: 104.0[samples/s]
2022-04-26 01:59:36,550 reid_baseline.train INFO: normal accuracy 0.4683487271908087 2.335968017578125 
2022-04-26 01:59:36,551 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 01:59:36,551 reid_baseline.train INFO: Accuracy: 46.8% Mean Entropy: 233.6%
2022-04-26 01:59:53,238 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.383, Acc: 0.824, Base Lr: 7.21e-03
2022-04-26 02:00:09,641 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.404, Acc: 0.823, Base Lr: 7.21e-03
2022-04-26 02:00:19,212 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.156[s] Speed: 102.5[samples/s]
2022-04-26 02:00:52,319 reid_baseline.train INFO: normal accuracy 0.4847938724938049 2.2644386291503906 
2022-04-26 02:00:53,300 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 02:00:53,300 reid_baseline.train INFO: Accuracy: 48.5% Mean Entropy: 226.4%
2022-04-26 02:01:09,775 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.341, Acc: 0.833, Base Lr: 7.60e-03
2022-04-26 02:01:24,849 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.362, Acc: 0.830, Base Lr: 7.60e-03
2022-04-26 02:01:37,357 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.161[s] Speed: 99.3[samples/s]
2022-04-26 02:02:07,412 reid_baseline.train INFO: normal accuracy 0.482090560937148 2.274901866912842 
2022-04-26 02:02:07,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 02:02:07,412 reid_baseline.train INFO: Accuracy: 48.2% Mean Entropy: 227.5%
2022-04-26 02:02:24,298 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.274, Acc: 0.851, Base Lr: 4.01e-03
2022-04-26 02:02:39,502 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.260, Acc: 0.858, Base Lr: 4.01e-03
2022-04-26 02:02:49,817 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.155[s] Speed: 103.2[samples/s]
2022-04-26 02:03:23,039 reid_baseline.train INFO: normal accuracy 0.47758504167605315 2.1915476322174072 
2022-04-26 02:03:24,247 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 02:03:24,247 reid_baseline.train INFO: Accuracy: 47.8% Mean Entropy: 219.2%
2022-04-26 02:03:43,695 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.197, Acc: 0.893, Base Lr: 3.69e-03
2022-04-26 02:03:59,405 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.188, Acc: 0.895, Base Lr: 3.69e-03
2022-04-26 02:04:10,132 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.168[s] Speed: 95.2[samples/s]
2022-04-26 02:04:42,724 reid_baseline.train INFO: normal accuracy 0.48817301193962603 2.180724620819092 
2022-04-26 02:04:43,792 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 02:04:43,793 reid_baseline.train INFO: Accuracy: 48.8% Mean Entropy: 218.1%
2022-04-26 02:05:00,193 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.207, Acc: 0.869, Base Lr: 3.38e-03
2022-04-26 02:05:15,320 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.195, Acc: 0.887, Base Lr: 3.38e-03
2022-04-26 02:05:27,445 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.160[s] Speed: 100.3[samples/s]
2022-04-26 02:06:01,274 reid_baseline.train INFO: normal accuracy 0.496057670646542 2.2121870517730713 
2022-04-26 02:06:01,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 02:06:01,276 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 221.2%
2022-04-26 02:06:17,753 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.174, Acc: 0.899, Base Lr: 3.08e-03
2022-04-26 02:06:30,977 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.902, Base Lr: 3.08e-03
2022-04-26 02:06:43,511 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.154[s] Speed: 104.0[samples/s]
2022-04-26 02:07:15,756 reid_baseline.train INFO: normal accuracy 0.4980851543140347 2.1527884006500244 
2022-04-26 02:07:16,816 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 02:07:16,816 reid_baseline.train INFO: Accuracy: 49.8% Mean Entropy: 215.3%
2022-04-26 02:07:33,082 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.130, Acc: 0.910, Base Lr: 2.77e-03
2022-04-26 02:07:49,489 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.139, Acc: 0.906, Base Lr: 2.77e-03
2022-04-26 02:08:01,296 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-26 02:08:32,536 reid_baseline.train INFO: normal accuracy 0.49718405046181574 2.1261813640594482 
2022-04-26 02:08:33,767 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 02:08:33,768 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 212.6%
2022-04-26 02:08:48,567 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.143, Acc: 0.902, Base Lr: 2.48e-03
2022-04-26 02:09:04,616 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.130, Acc: 0.907, Base Lr: 2.48e-03
2022-04-26 02:09:16,864 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.158[s] Speed: 101.5[samples/s]
2022-04-26 02:09:51,114 reid_baseline.train INFO: normal accuracy 0.49673349853570625 2.1126649379730225 
2022-04-26 02:09:52,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 02:09:52,393 reid_baseline.train INFO: Accuracy: 49.7% Mean Entropy: 211.3%
2022-04-26 02:10:09,589 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.090, Acc: 0.926, Base Lr: 2.20e-03
2022-04-26 02:10:23,842 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.103, Acc: 0.920, Base Lr: 2.20e-03
2022-04-26 02:10:33,906 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.152[s] Speed: 105.5[samples/s]
2022-04-26 02:11:06,774 reid_baseline.train INFO: normal accuracy 0.5070961928362244 2.1131865978240967 
2022-04-26 02:11:06,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 02:11:06,776 reid_baseline.train INFO: Accuracy: 50.7% Mean Entropy: 211.3%
2022-04-26 02:11:24,823 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.095, Acc: 0.918, Base Lr: 1.92e-03
2022-04-26 02:11:38,825 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.093, Acc: 0.919, Base Lr: 1.92e-03
2022-04-26 02:11:52,148 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.166[s] Speed: 96.4[samples/s]
2022-04-26 02:12:26,357 reid_baseline.train INFO: normal accuracy 0.4987609822031989 2.109168529510498 
2022-04-26 02:12:27,548 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 02:12:27,548 reid_baseline.train INFO: Accuracy: 49.9% Mean Entropy: 210.9%
2022-04-26 02:12:45,319 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.098, Acc: 0.921, Base Lr: 1.66e-03
2022-04-26 02:13:00,616 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.086, Acc: 0.927, Base Lr: 1.66e-03
2022-04-26 02:13:12,270 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.163[s] Speed: 98.0[samples/s]
2022-04-26 02:13:47,054 reid_baseline.train INFO: normal accuracy 0.5010137418337464 2.1179444789886475 
2022-04-26 02:13:47,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 02:13:47,057 reid_baseline.train INFO: Accuracy: 50.1% Mean Entropy: 211.8%
2022-04-26 02:14:04,226 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.064, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 02:14:20,097 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.065, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 02:14:31,126 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.161[s] Speed: 99.2[samples/s]
2022-04-26 02:15:04,520 reid_baseline.train INFO: normal accuracy 0.503942329353458 2.1428327560424805 
2022-04-26 02:15:04,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 02:15:04,523 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 214.3%
2022-04-26 02:15:21,297 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.063, Acc: 0.939, Base Lr: 1.19e-03
2022-04-26 02:15:36,548 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.057, Acc: 0.938, Base Lr: 1.19e-03
2022-04-26 02:15:48,385 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.160[s] Speed: 100.1[samples/s]
2022-04-26 02:16:19,896 reid_baseline.train INFO: normal accuracy 0.5050687091687317 2.142667055130005 
2022-04-26 02:16:19,897 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 02:16:19,897 reid_baseline.train INFO: Accuracy: 50.5% Mean Entropy: 214.3%
2022-04-26 02:16:37,367 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.059, Acc: 0.934, Base Lr: 9.72e-04
2022-04-26 02:16:53,368 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.050, Acc: 0.936, Base Lr: 9.72e-04
2022-04-26 02:17:04,959 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.165[s] Speed: 97.0[samples/s]
2022-04-26 02:17:37,109 reid_baseline.train INFO: normal accuracy 0.5032665014642937 2.140436887741089 
2022-04-26 02:17:37,109 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 02:17:37,109 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 214.0%
2022-04-26 02:17:53,564 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.051, Acc: 0.938, Base Lr: 7.78e-04
2022-04-26 02:18:08,582 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.055, Acc: 0.937, Base Lr: 7.78e-04
2022-04-26 02:18:19,379 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.155[s] Speed: 103.4[samples/s]
2022-04-26 02:18:52,657 reid_baseline.train INFO: normal accuracy 0.5043928812795675 2.134538173675537 
2022-04-26 02:18:52,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 02:18:52,659 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 213.5%
2022-04-26 02:19:09,697 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.037, Acc: 0.948, Base Lr: 6.04e-04
2022-04-26 02:19:24,132 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.039, Acc: 0.943, Base Lr: 6.04e-04
2022-04-26 02:19:35,996 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.158[s] Speed: 101.2[samples/s]
2022-04-26 02:20:09,388 reid_baseline.train INFO: normal accuracy 0.49853570624014415 2.1407341957092285 
2022-04-26 02:20:09,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 02:20:09,388 reid_baseline.train INFO: Accuracy: 49.9% Mean Entropy: 214.1%
2022-04-26 02:20:27,037 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.033, Acc: 0.942, Base Lr: 4.51e-04
2022-04-26 02:20:42,354 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.030, Acc: 0.943, Base Lr: 4.51e-04
2022-04-26 02:20:54,304 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.164[s] Speed: 97.4[samples/s]
2022-04-26 02:21:27,208 reid_baseline.train INFO: normal accuracy 0.5088984005406623 2.1441431045532227 
2022-04-26 02:21:27,209 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 02:21:27,209 reid_baseline.train INFO: Accuracy: 50.9% Mean Entropy: 214.4%
2022-04-26 02:21:45,589 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.042, Acc: 0.938, Base Lr: 3.20e-04
2022-04-26 02:22:01,553 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.038, Acc: 0.943, Base Lr: 3.20e-04
2022-04-26 02:22:11,767 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-26 02:22:45,675 reid_baseline.train INFO: normal accuracy 0.5034917774273485 2.118867874145508 
2022-04-26 02:22:45,676 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 02:22:45,676 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 211.9%
2022-04-26 02:23:03,967 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.026, Acc: 0.944, Base Lr: 2.11e-04
2022-04-26 02:23:19,820 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.031, Acc: 0.945, Base Lr: 2.11e-04
2022-04-26 02:23:33,071 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.173[s] Speed: 92.3[samples/s]
2022-04-26 02:24:08,883 reid_baseline.train INFO: normal accuracy 0.5032665014642937 2.1259984970092773 
2022-04-26 02:24:08,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 02:24:08,883 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 212.6%
2022-04-26 02:24:25,950 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.041, Acc: 0.944, Base Lr: 1.26e-04
2022-04-26 02:24:43,285 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.031, Acc: 0.946, Base Lr: 1.26e-04
2022-04-26 02:24:54,971 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.169[s] Speed: 94.9[samples/s]
2022-04-26 02:25:28,998 reid_baseline.train INFO: normal accuracy 0.5055192610948411 2.1063835620880127 
2022-04-26 02:25:30,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 02:25:30,176 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 210.6%
2022-04-26 02:25:46,085 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.023, Acc: 0.951, Base Lr: 6.51e-05
2022-04-26 02:26:02,339 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.022, Acc: 0.952, Base Lr: 6.51e-05
2022-04-26 02:26:16,134 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.168[s] Speed: 95.1[samples/s]
2022-04-26 02:26:47,944 reid_baseline.train INFO: normal accuracy 0.5057445370578959 2.1206741333007812 
2022-04-26 02:26:47,945 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 02:26:47,945 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 212.1%
2022-04-26 02:27:05,574 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.019, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 02:27:21,681 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.021, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 02:27:35,711 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.174[s] Speed: 91.9[samples/s]
2022-04-26 02:28:11,156 reid_baseline.train INFO: normal accuracy 0.503942329353458 2.1125285625457764 
2022-04-26 02:28:11,156 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 02:28:11,156 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 211.3%
2022-04-26 02:28:27,058 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 1.60e-05
2022-04-26 02:28:45,945 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.030, Acc: 0.945, Base Lr: 1.60e-05
2022-04-26 02:28:55,774 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.163[s] Speed: 98.2[samples/s]
2022-04-26 02:29:29,692 reid_baseline.train INFO: normal accuracy 0.503041225501239 2.101672410964966 
2022-04-26 02:29:30,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 02:29:30,737 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 210.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_all_key_8/transformer_best_model.pth
2022-04-26 02:30:04,893 reid_baseline.train INFO: normal accuracy 0.503041225501239 2.101672410964966 
2022-04-26 02:30:04,893 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:30:04,893 reid_baseline.train INFO: Accuracy: 50.3%
2022-04-26 02:30:41,183 reid_baseline.train INFO: normal accuracy 0.503041225501239 2.101672410964966 
2022-04-26 02:30:41,183 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:30:41,183 reid_baseline.train INFO: Shuffled Accuracy: 50.3%
2022-04-26 02:31:14,858 reid_baseline.train INFO: normal accuracy 0.9326460481099657 1.1213107109069824 
2022-04-26 02:31:14,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:31:14,858 reid_baseline.train INFO: Source Clean Accuracy: 93.3%
2022-04-26 02:31:20,898 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_8
2022-04-26 02:31:20,898 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 02:31:20,898 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 02:31:20,898 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 02:31:20,898 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 02:31:34,824 reid_baseline.train INFO: start training
2022-04-26 02:31:52,110 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.088, Base Lr: 4.76e-04
2022-04-26 02:32:09,383 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.122, Acc: 0.123, Base Lr: 4.76e-04
2022-04-26 02:32:20,480 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.167[s] Speed: 96.1[samples/s]
2022-04-26 02:33:18,300 reid_baseline.train INFO: normal accuracy 0.12784025705760846 4.168429374694824 
2022-04-26 02:33:19,420 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 02:33:19,420 reid_baseline.train INFO: Accuracy: 12.8% Mean Entropy: 416.8%
2022-04-26 02:33:37,174 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.960, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 02:33:53,950 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.906, Acc: 0.209, Base Lr: 8.72e-04
2022-04-26 02:34:05,649 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.169[s] Speed: 94.6[samples/s]
2022-04-26 02:35:04,103 reid_baseline.train INFO: normal accuracy 0.13885701170530182 4.125772953033447 
2022-04-26 02:35:05,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 02:35:05,012 reid_baseline.train INFO: Accuracy: 13.9% Mean Entropy: 412.6%
2022-04-26 02:35:22,934 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.678, Acc: 0.219, Base Lr: 1.27e-03
2022-04-26 02:35:40,085 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.622, Acc: 0.235, Base Lr: 1.27e-03
2022-04-26 02:35:50,642 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.167[s] Speed: 95.8[samples/s]
2022-04-26 02:36:49,106 reid_baseline.train INFO: normal accuracy 0.16708744549001606 4.003987789154053 
2022-04-26 02:36:50,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 02:36:50,309 reid_baseline.train INFO: Accuracy: 16.7% Mean Entropy: 400.4%
2022-04-26 02:37:08,891 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.332, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 02:37:24,811 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.313, Acc: 0.281, Base Lr: 1.66e-03
2022-04-26 02:37:37,521 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.173[s] Speed: 92.7[samples/s]
2022-04-26 02:38:34,867 reid_baseline.train INFO: normal accuracy 0.2095478540280009 3.815948009490967 
2022-04-26 02:38:35,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 02:38:35,855 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 381.6%
2022-04-26 02:38:53,765 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.095, Acc: 0.318, Base Lr: 2.06e-03
2022-04-26 02:39:08,005 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.031, Acc: 0.351, Base Lr: 2.06e-03
2022-04-26 02:39:19,179 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.158[s] Speed: 101.0[samples/s]
2022-04-26 02:40:19,295 reid_baseline.train INFO: normal accuracy 0.2598117971081019 3.6619627475738525 
2022-04-26 02:40:20,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 02:40:20,127 reid_baseline.train INFO: Accuracy: 26.0% Mean Entropy: 366.2%
2022-04-26 02:40:37,809 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 2.853, Acc: 0.395, Base Lr: 2.46e-03
2022-04-26 02:40:52,721 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 2.809, Acc: 0.403, Base Lr: 2.46e-03
2022-04-26 02:41:05,574 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-26 02:42:05,130 reid_baseline.train INFO: normal accuracy 0.30571494147349093 3.4351744651794434 
2022-04-26 02:42:06,340 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 02:42:06,341 reid_baseline.train INFO: Accuracy: 30.6% Mean Entropy: 343.5%
2022-04-26 02:42:24,406 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 2.593, Acc: 0.468, Base Lr: 2.85e-03
2022-04-26 02:42:39,512 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 2.588, Acc: 0.467, Base Lr: 2.85e-03
2022-04-26 02:42:51,471 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.165[s] Speed: 96.9[samples/s]
2022-04-26 02:43:51,313 reid_baseline.train INFO: normal accuracy 0.35092953867339916 3.284477472305298 
2022-04-26 02:43:52,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 02:43:52,522 reid_baseline.train INFO: Accuracy: 35.1% Mean Entropy: 328.4%
2022-04-26 02:44:08,562 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 2.401, Acc: 0.541, Base Lr: 3.25e-03
2022-04-26 02:44:26,874 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 2.395, Acc: 0.533, Base Lr: 3.25e-03
2022-04-26 02:44:38,192 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.167[s] Speed: 95.8[samples/s]
2022-04-26 02:45:36,334 reid_baseline.train INFO: normal accuracy 0.37640578379619005 3.130265712738037 
2022-04-26 02:45:37,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 02:45:37,525 reid_baseline.train INFO: Accuracy: 37.6% Mean Entropy: 313.0%
2022-04-26 02:45:53,598 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.270, Acc: 0.541, Base Lr: 3.64e-03
2022-04-26 02:46:09,698 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 2.229, Acc: 0.563, Base Lr: 3.64e-03
2022-04-26 02:46:22,238 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.164[s] Speed: 97.8[samples/s]
2022-04-26 02:47:21,507 reid_baseline.train INFO: normal accuracy 0.3970621987606151 2.9614014625549316 
2022-04-26 02:47:22,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 02:47:22,573 reid_baseline.train INFO: Accuracy: 39.7% Mean Entropy: 296.1%
2022-04-26 02:47:39,315 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.089, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 02:47:56,754 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.094, Acc: 0.607, Base Lr: 4.04e-03
2022-04-26 02:48:09,113 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.169[s] Speed: 94.5[samples/s]
2022-04-26 02:49:05,021 reid_baseline.train INFO: normal accuracy 0.42184989671792517 2.854357957839966 
2022-04-26 02:49:06,225 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 02:49:06,225 reid_baseline.train INFO: Accuracy: 42.2% Mean Entropy: 285.4%
2022-04-26 02:49:22,940 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.961, Acc: 0.640, Base Lr: 4.44e-03
2022-04-26 02:49:38,675 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.956, Acc: 0.642, Base Lr: 4.44e-03
2022-04-26 02:49:51,414 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.165[s] Speed: 96.7[samples/s]
2022-04-26 02:50:52,617 reid_baseline.train INFO: normal accuracy 0.4220794124397521 2.729863405227661 
2022-04-26 02:50:53,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 02:50:53,505 reid_baseline.train INFO: Accuracy: 42.2% Mean Entropy: 273.0%
2022-04-26 02:51:11,098 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.826, Acc: 0.676, Base Lr: 4.83e-03
2022-04-26 02:51:26,382 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.846, Acc: 0.669, Base Lr: 4.83e-03
2022-04-26 02:51:38,466 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.164[s] Speed: 97.5[samples/s]
2022-04-26 02:52:35,745 reid_baseline.train INFO: normal accuracy 0.4459490475097544 2.638075828552246 
2022-04-26 02:52:36,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 02:52:36,950 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 263.8%
2022-04-26 02:52:55,753 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.765, Acc: 0.708, Base Lr: 5.23e-03
2022-04-26 02:53:13,072 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.737, Acc: 0.713, Base Lr: 5.23e-03
2022-04-26 02:53:25,233 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.177[s] Speed: 90.6[samples/s]
2022-04-26 02:54:22,809 reid_baseline.train INFO: normal accuracy 0.46522836814321783 2.5255846977233887 
2022-04-26 02:54:23,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 02:54:23,629 reid_baseline.train INFO: Accuracy: 46.5% Mean Entropy: 252.6%
2022-04-26 02:54:41,491 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.699, Acc: 0.723, Base Lr: 5.62e-03
2022-04-26 02:54:57,682 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.669, Acc: 0.734, Base Lr: 5.62e-03
2022-04-26 02:55:09,891 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.168[s] Speed: 95.0[samples/s]
2022-04-26 02:56:04,988 reid_baseline.train INFO: normal accuracy 0.4707367454670645 2.4431326389312744 
2022-04-26 02:56:05,791 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 02:56:05,791 reid_baseline.train INFO: Accuracy: 47.1% Mean Entropy: 244.3%
2022-04-26 02:56:24,974 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.558, Acc: 0.766, Base Lr: 6.02e-03
2022-04-26 02:56:41,538 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.579, Acc: 0.758, Base Lr: 6.02e-03
2022-04-26 02:56:52,232 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.169[s] Speed: 94.7[samples/s]
2022-04-26 02:57:50,874 reid_baseline.train INFO: normal accuracy 0.4840486573330273 2.362349033355713 
2022-04-26 02:57:52,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 02:57:52,072 reid_baseline.train INFO: Accuracy: 48.4% Mean Entropy: 236.2%
2022-04-26 02:58:09,659 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.490, Acc: 0.794, Base Lr: 6.42e-03
2022-04-26 02:58:26,767 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.494, Acc: 0.791, Base Lr: 6.42e-03
2022-04-26 02:58:39,220 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.173[s] Speed: 92.7[samples/s]
2022-04-26 02:59:36,897 reid_baseline.train INFO: normal accuracy 0.4870323617167776 2.2966692447662354 
2022-04-26 02:59:37,864 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 02:59:37,864 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 229.7%
2022-04-26 02:59:56,765 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.447, Acc: 0.798, Base Lr: 6.81e-03
2022-04-26 03:00:15,055 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.467, Acc: 0.791, Base Lr: 6.81e-03
2022-04-26 03:00:26,784 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.179[s] Speed: 89.6[samples/s]
2022-04-26 03:01:27,138 reid_baseline.train INFO: normal accuracy 0.49552444342437457 2.334904670715332 
2022-04-26 03:01:27,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 03:01:27,141 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 233.5%
2022-04-26 03:01:45,029 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.383, Acc: 0.824, Base Lr: 7.21e-03
2022-04-26 03:02:02,580 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.404, Acc: 0.823, Base Lr: 7.21e-03
2022-04-26 03:02:14,692 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.174[s] Speed: 91.9[samples/s]
2022-04-26 03:03:13,793 reid_baseline.train INFO: normal accuracy 0.5042460408537985 2.2902848720550537 
2022-04-26 03:03:15,008 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 03:03:15,008 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 229.0%
2022-04-26 03:03:32,370 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.341, Acc: 0.833, Base Lr: 7.60e-03
2022-04-26 03:03:48,523 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.362, Acc: 0.830, Base Lr: 7.60e-03
2022-04-26 03:04:00,665 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.167[s] Speed: 95.9[samples/s]
2022-04-26 03:04:59,077 reid_baseline.train INFO: normal accuracy 0.5035574936883177 2.2861969470977783 
2022-04-26 03:05:00,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 03:05:00,279 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 228.6%
2022-04-26 03:05:18,718 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.274, Acc: 0.851, Base Lr: 4.01e-03
2022-04-26 03:05:35,984 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.260, Acc: 0.858, Base Lr: 4.01e-03
2022-04-26 03:05:47,703 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.174[s] Speed: 92.2[samples/s]
2022-04-26 03:06:45,629 reid_baseline.train INFO: normal accuracy 0.5076887766812027 2.251065492630005 
2022-04-26 03:06:46,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 03:06:46,514 reid_baseline.train INFO: Accuracy: 50.8% Mean Entropy: 225.1%
2022-04-26 03:07:01,822 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 1.197, Acc: 0.893, Base Lr: 3.69e-03
2022-04-26 03:07:20,452 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 1.188, Acc: 0.895, Base Lr: 3.69e-03
2022-04-26 03:07:32,155 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.166[s] Speed: 96.5[samples/s]
2022-04-26 03:08:31,265 reid_baseline.train INFO: normal accuracy 0.510672481064953 2.230513095855713 
2022-04-26 03:08:32,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 03:08:32,467 reid_baseline.train INFO: Accuracy: 51.1% Mean Entropy: 223.1%
2022-04-26 03:08:51,166 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 1.207, Acc: 0.869, Base Lr: 3.38e-03
2022-04-26 03:09:08,520 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 1.195, Acc: 0.887, Base Lr: 3.38e-03
2022-04-26 03:09:18,905 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.169[s] Speed: 94.5[samples/s]
2022-04-26 03:10:18,545 reid_baseline.train INFO: normal accuracy 0.5184760156070691 2.2322278022766113 
2022-04-26 03:10:18,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 03:10:18,548 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 223.2%
2022-04-26 03:10:36,158 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 1.174, Acc: 0.899, Base Lr: 3.08e-03
2022-04-26 03:10:52,017 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 1.169, Acc: 0.902, Base Lr: 3.08e-03
2022-04-26 03:11:03,890 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.166[s] Speed: 96.5[samples/s]
2022-04-26 03:12:02,727 reid_baseline.train INFO: normal accuracy 0.5159513426669727 2.211803436279297 
2022-04-26 03:12:03,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 03:12:03,851 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 221.2%
2022-04-26 03:12:18,900 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 1.130, Acc: 0.910, Base Lr: 2.77e-03
2022-04-26 03:12:36,028 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 1.139, Acc: 0.906, Base Lr: 2.77e-03
2022-04-26 03:12:46,160 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.154[s] Speed: 103.6[samples/s]
2022-04-26 03:13:43,714 reid_baseline.train INFO: normal accuracy 0.5170989212761075 2.1625685691833496 
2022-04-26 03:13:44,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 03:13:44,511 reid_baseline.train INFO: Accuracy: 51.7% Mean Entropy: 216.3%
2022-04-26 03:14:04,364 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 1.143, Acc: 0.902, Base Lr: 2.48e-03
2022-04-26 03:14:21,428 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 1.130, Acc: 0.907, Base Lr: 2.48e-03
2022-04-26 03:14:33,051 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.175[s] Speed: 91.6[samples/s]
2022-04-26 03:15:30,098 reid_baseline.train INFO: normal accuracy 0.5235253614872619 2.172776460647583 
2022-04-26 03:15:30,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 03:15:30,099 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 217.3%
2022-04-26 03:15:49,643 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 1.090, Acc: 0.926, Base Lr: 2.20e-03
2022-04-26 03:16:05,526 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 1.103, Acc: 0.920, Base Lr: 2.20e-03
2022-04-26 03:16:17,714 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.174[s] Speed: 92.0[samples/s]
2022-04-26 03:17:20,907 reid_baseline.train INFO: normal accuracy 0.5239843929309158 2.182548761367798 
2022-04-26 03:17:20,909 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 03:17:20,910 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 218.3%
2022-04-26 03:17:38,015 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 1.095, Acc: 0.918, Base Lr: 1.92e-03
2022-04-26 03:17:55,326 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 1.093, Acc: 0.919, Base Lr: 1.92e-03
2022-04-26 03:18:07,436 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.170[s] Speed: 94.2[samples/s]
2022-04-26 03:19:05,461 reid_baseline.train INFO: normal accuracy 0.527197613036493 2.167633295059204 
2022-04-26 03:19:05,462 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 03:19:05,462 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 216.8%
2022-04-26 03:19:21,689 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 1.098, Acc: 0.921, Base Lr: 1.66e-03
2022-04-26 03:19:39,300 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 1.086, Acc: 0.927, Base Lr: 1.66e-03
2022-04-26 03:19:50,451 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.165[s] Speed: 97.2[samples/s]
2022-04-26 03:20:49,333 reid_baseline.train INFO: normal accuracy 0.5262795501491853 2.1864938735961914 
2022-04-26 03:20:49,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 03:20:49,335 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 218.6%
2022-04-26 03:21:07,382 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 1.064, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 03:21:21,250 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 1.065, Acc: 0.934, Base Lr: 1.42e-03
2022-04-26 03:21:34,914 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.167[s] Speed: 96.1[samples/s]
2022-04-26 03:22:35,538 reid_baseline.train INFO: normal accuracy 0.5269680973146661 2.199173927307129 
2022-04-26 03:22:35,538 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 03:22:35,538 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 219.9%
2022-04-26 03:22:53,748 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 1.063, Acc: 0.939, Base Lr: 1.19e-03
2022-04-26 03:23:07,419 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 1.057, Acc: 0.938, Base Lr: 1.19e-03
2022-04-26 03:23:20,191 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.163[s] Speed: 98.0[samples/s]
2022-04-26 03:24:19,471 reid_baseline.train INFO: normal accuracy 0.5278861602019739 2.2162625789642334 
2022-04-26 03:24:19,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 03:24:19,471 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 221.6%
2022-04-26 03:24:37,266 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 1.059, Acc: 0.934, Base Lr: 9.72e-04
2022-04-26 03:24:54,212 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 1.050, Acc: 0.936, Base Lr: 9.72e-04
2022-04-26 03:25:06,048 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.170[s] Speed: 94.0[samples/s]
2022-04-26 03:26:00,706 reid_baseline.train INFO: normal accuracy 0.5262795501491853 2.1964950561523438 
2022-04-26 03:26:00,707 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 03:26:00,707 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 219.6%
2022-04-26 03:26:19,633 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 1.051, Acc: 0.938, Base Lr: 7.78e-04
2022-04-26 03:26:34,446 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 1.055, Acc: 0.937, Base Lr: 7.78e-04
2022-04-26 03:26:45,507 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-26 03:27:44,429 reid_baseline.train INFO: normal accuracy 0.5258205187055314 2.201470136642456 
2022-04-26 03:27:44,431 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 03:27:44,431 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 220.1%
2022-04-26 03:28:01,489 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 1.037, Acc: 0.948, Base Lr: 6.04e-04
2022-04-26 03:28:17,325 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 1.039, Acc: 0.943, Base Lr: 6.04e-04
2022-04-26 03:28:29,375 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.164[s] Speed: 97.7[samples/s]
2022-04-26 03:29:29,776 reid_baseline.train INFO: normal accuracy 0.5267385815928392 2.2061238288879395 
2022-04-26 03:29:29,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 03:29:29,777 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 220.6%
2022-04-26 03:29:47,387 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 1.033, Acc: 0.942, Base Lr: 4.51e-04
2022-04-26 03:30:02,480 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 1.030, Acc: 0.943, Base Lr: 4.51e-04
2022-04-26 03:30:14,342 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.162[s] Speed: 98.6[samples/s]
2022-04-26 03:31:12,940 reid_baseline.train INFO: normal accuracy 0.5253614872618775 2.214674711227417 
2022-04-26 03:31:12,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 03:31:12,943 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 221.5%
2022-04-26 03:31:32,398 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 1.042, Acc: 0.938, Base Lr: 3.20e-04
2022-04-26 03:31:49,309 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 1.038, Acc: 0.943, Base Lr: 3.20e-04
2022-04-26 03:32:00,858 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.175[s] Speed: 91.3[samples/s]
2022-04-26 03:32:59,009 reid_baseline.train INFO: normal accuracy 0.527197613036493 2.1911327838897705 
2022-04-26 03:32:59,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 03:32:59,012 reid_baseline.train INFO: Accuracy: 52.7% Mean Entropy: 219.1%
2022-04-26 03:33:14,897 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 1.026, Acc: 0.944, Base Lr: 2.11e-04
2022-04-26 03:33:31,211 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 1.031, Acc: 0.945, Base Lr: 2.11e-04
2022-04-26 03:33:43,909 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.164[s] Speed: 97.5[samples/s]
2022-04-26 03:34:43,224 reid_baseline.train INFO: normal accuracy 0.5297222859765894 2.1945559978485107 
2022-04-26 03:34:43,224 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 03:34:43,225 reid_baseline.train INFO: Accuracy: 53.0% Mean Entropy: 219.5%
2022-04-26 03:35:00,561 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 1.041, Acc: 0.944, Base Lr: 1.26e-04
2022-04-26 03:35:18,397 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 1.031, Acc: 0.946, Base Lr: 1.26e-04
2022-04-26 03:35:29,950 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.170[s] Speed: 94.0[samples/s]
2022-04-26 03:36:27,554 reid_baseline.train INFO: normal accuracy 0.5294927702547625 2.1688616275787354 
2022-04-26 03:36:27,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 03:36:27,555 reid_baseline.train INFO: Accuracy: 52.9% Mean Entropy: 216.9%
2022-04-26 03:36:45,327 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 1.023, Acc: 0.951, Base Lr: 6.51e-05
2022-04-26 03:37:00,176 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 1.022, Acc: 0.952, Base Lr: 6.51e-05
2022-04-26 03:37:13,987 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.169[s] Speed: 94.6[samples/s]
2022-04-26 03:38:12,640 reid_baseline.train INFO: normal accuracy 0.5306403488638972 2.1941452026367188 
2022-04-26 03:38:12,640 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 03:38:12,641 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 219.4%
2022-04-26 03:38:31,064 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 1.019, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 03:38:47,970 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 1.021, Acc: 0.949, Base Lr: 2.83e-05
2022-04-26 03:39:01,224 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.178[s] Speed: 90.1[samples/s]
2022-04-26 03:40:04,350 reid_baseline.train INFO: normal accuracy 0.5253614872618775 2.182243824005127 
2022-04-26 03:40:04,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 03:40:04,353 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 218.2%
2022-04-26 03:40:21,900 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 1.043, Acc: 0.939, Base Lr: 1.60e-05
2022-04-26 03:40:37,310 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 1.030, Acc: 0.945, Base Lr: 1.60e-05
2022-04-26 03:40:50,374 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.168[s] Speed: 95.1[samples/s]
2022-04-26 03:41:49,389 reid_baseline.train INFO: normal accuracy 0.5244434243745697 2.1675620079040527 
2022-04-26 03:41:49,390 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 03:41:49,390 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 216.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_all_key_8/transformer_best_model.pth
2022-04-26 03:42:51,779 reid_baseline.train INFO: normal accuracy 0.5170989212761075 2.1625685691833496 
2022-04-26 03:42:51,779 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 03:42:51,780 reid_baseline.train INFO: Accuracy: 51.7%
2022-04-26 03:43:37,558 reid_baseline.train INFO: normal accuracy 0.5170989212761075 2.1625685691833496 
2022-04-26 03:43:37,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 03:43:37,559 reid_baseline.train INFO: Shuffled Accuracy: 51.7%
2022-04-26 03:44:12,364 reid_baseline.train INFO: normal accuracy 0.8893470790378006 1.3025598526000977 
2022-04-26 03:44:12,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 03:44:12,364 reid_baseline.train INFO: Source Clean Accuracy: 88.9%
