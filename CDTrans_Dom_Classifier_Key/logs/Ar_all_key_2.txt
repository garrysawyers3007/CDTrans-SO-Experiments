2022-04-25 18:47:35,862 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_4
2022-04-25 18:47:35,863 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 18:47:35,863 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 18:47:35,863 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 18:47:35,863 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 18:47:53,156 reid_baseline.train INFO: start training
2022-04-25 18:48:15,674 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.098, Base Lr: 4.76e-04
2022-04-25 18:48:25,937 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.215[s] Speed: 74.4[samples/s]
2022-04-25 18:49:29,442 reid_baseline.train INFO: normal accuracy 0.09095074455899198 4.172651767730713 
2022-04-25 18:49:30,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 18:49:30,176 reid_baseline.train INFO: Accuracy: 9.1% Mean Entropy: 417.3%
2022-04-25 18:50:00,524 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.032, Acc: 0.225, Base Lr: 8.72e-04
2022-04-25 18:50:13,743 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-25 18:51:18,050 reid_baseline.train INFO: normal accuracy 0.10263459335624284 4.166804790496826 
2022-04-25 18:51:18,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 18:51:18,876 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 416.7%
2022-04-25 18:51:48,432 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.239, Base Lr: 1.27e-03
2022-04-25 18:52:02,945 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.290[s] Speed: 55.2[samples/s]
2022-04-25 18:53:05,215 reid_baseline.train INFO: normal accuracy 0.10492554410080183 4.145481109619141 
2022-04-25 18:53:06,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 18:53:06,012 reid_baseline.train INFO: Accuracy: 10.5% Mean Entropy: 414.5%
2022-04-25 18:53:36,576 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.597, Acc: 0.286, Base Lr: 1.66e-03
2022-04-25 18:53:50,752 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.294[s] Speed: 54.4[samples/s]
2022-04-25 18:54:50,748 reid_baseline.train INFO: normal accuracy 0.10263459335624284 4.101824760437012 
2022-04-25 18:54:52,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 18:54:52,766 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 410.2%
2022-04-25 18:55:23,832 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.396, Acc: 0.286, Base Lr: 2.06e-03
2022-04-25 18:55:38,184 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.297[s] Speed: 53.8[samples/s]
2022-04-25 18:56:41,945 reid_baseline.train INFO: normal accuracy 0.1140893470790378 4.043507099151611 
2022-04-25 18:56:44,090 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 18:56:44,090 reid_baseline.train INFO: Accuracy: 11.4% Mean Entropy: 404.4%
2022-04-25 18:57:14,555 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.163, Acc: 0.330, Base Lr: 2.46e-03
2022-04-25 18:57:28,966 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.294[s] Speed: 54.3[samples/s]
2022-04-25 18:58:17,828 reid_baseline.train INFO: normal accuracy 0.12187857961053837 3.946424961090088 
2022-04-25 18:58:18,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 18:58:18,643 reid_baseline.train INFO: Accuracy: 12.2% Mean Entropy: 394.6%
2022-04-25 18:58:40,092 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 18:58:48,079 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.193[s] Speed: 82.7[samples/s]
2022-04-25 18:59:49,971 reid_baseline.train INFO: normal accuracy 0.13883161512027492 3.859248399734497 
2022-04-25 18:59:50,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 18:59:50,849 reid_baseline.train INFO: Accuracy: 13.9% Mean Entropy: 385.9%
2022-04-25 19:00:21,275 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.763, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 19:00:33,899 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.283[s] Speed: 56.6[samples/s]
2022-04-25 19:01:38,097 reid_baseline.train INFO: normal accuracy 0.15372279495990837 3.795200824737549 
2022-04-25 19:01:40,091 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 19:01:40,092 reid_baseline.train INFO: Accuracy: 15.4% Mean Entropy: 379.5%
2022-04-25 19:02:08,306 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.591, Acc: 0.471, Base Lr: 3.64e-03
2022-04-25 19:02:22,882 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-25 19:03:25,973 reid_baseline.train INFO: normal accuracy 0.16540664375715922 3.7016541957855225 
2022-04-25 19:03:27,736 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 19:03:27,736 reid_baseline.train INFO: Accuracy: 16.5% Mean Entropy: 370.2%
2022-04-25 19:03:58,835 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.405, Acc: 0.525, Base Lr: 4.04e-03
2022-04-25 19:04:13,366 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.300[s] Speed: 53.3[samples/s]
2022-04-25 19:05:11,144 reid_baseline.train INFO: normal accuracy 0.1764032073310424 3.6013071537017822 
2022-04-25 19:05:12,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 19:05:12,212 reid_baseline.train INFO: Accuracy: 17.6% Mean Entropy: 360.1%
2022-04-25 19:05:42,793 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 19:05:57,299 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.296[s] Speed: 54.1[samples/s]
2022-04-25 19:07:01,126 reid_baseline.train INFO: normal accuracy 0.19152348224513174 3.504218339920044 
2022-04-25 19:07:01,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 19:07:01,968 reid_baseline.train INFO: Accuracy: 19.2% Mean Entropy: 350.4%
2022-04-25 19:07:31,688 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.078, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 19:07:45,898 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.288[s] Speed: 55.6[samples/s]
2022-04-25 19:08:38,280 reid_baseline.train INFO: normal accuracy 0.20641466208476517 3.4143741130828857 
2022-04-25 19:08:39,280 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 19:08:39,281 reid_baseline.train INFO: Accuracy: 20.6% Mean Entropy: 341.4%
2022-04-25 19:09:01,081 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.672, Base Lr: 5.23e-03
2022-04-25 19:09:09,485 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.197[s] Speed: 81.2[samples/s]
2022-04-25 19:10:09,211 reid_baseline.train INFO: normal accuracy 0.21741122565864834 3.326192617416382 
2022-04-25 19:10:10,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 19:10:10,153 reid_baseline.train INFO: Accuracy: 21.7% Mean Entropy: 332.6%
2022-04-25 19:10:39,892 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.833, Acc: 0.693, Base Lr: 5.62e-03
2022-04-25 19:10:54,244 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.289[s] Speed: 55.3[samples/s]
2022-04-25 19:11:58,877 reid_baseline.train INFO: normal accuracy 0.2327605956471936 3.2867443561553955 
2022-04-25 19:12:00,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 19:12:00,876 reid_baseline.train INFO: Accuracy: 23.3% Mean Entropy: 328.7%
2022-04-25 19:12:30,814 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.738, Acc: 0.722, Base Lr: 6.02e-03
2022-04-25 19:12:42,596 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.274[s] Speed: 58.5[samples/s]
2022-04-25 19:13:45,228 reid_baseline.train INFO: normal accuracy 0.22474226804123712 3.1218883991241455 
2022-04-25 19:13:46,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 19:13:46,309 reid_baseline.train INFO: Accuracy: 22.5% Mean Entropy: 312.2%
2022-04-25 19:14:17,560 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.635, Acc: 0.757, Base Lr: 6.42e-03
2022-04-25 19:14:32,109 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-25 19:15:34,343 reid_baseline.train INFO: normal accuracy 0.23802978235967925 3.026057243347168 
2022-04-25 19:15:35,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 19:15:35,500 reid_baseline.train INFO: Accuracy: 23.8% Mean Entropy: 302.6%
2022-04-25 19:16:04,550 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 19:16:19,090 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-25 19:17:21,936 reid_baseline.train INFO: normal accuracy 0.24879725085910653 2.9936890602111816 
2022-04-25 19:17:22,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 19:17:22,777 reid_baseline.train INFO: Accuracy: 24.9% Mean Entropy: 299.4%
2022-04-25 19:17:53,755 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.463, Acc: 0.817, Base Lr: 7.21e-03
2022-04-25 19:18:08,505 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-25 19:19:02,119 reid_baseline.train INFO: normal accuracy 0.24902634593356243 2.956300973892212 
2022-04-25 19:19:03,326 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 19:19:03,326 reid_baseline.train INFO: Accuracy: 24.9% Mean Entropy: 295.6%
2022-04-25 19:19:24,637 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.394, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 19:19:32,828 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-25 19:20:30,200 reid_baseline.train INFO: normal accuracy 0.2515463917525773 2.831726551055908 
2022-04-25 19:20:31,139 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 19:20:31,139 reid_baseline.train INFO: Accuracy: 25.2% Mean Entropy: 283.2%
2022-04-25 19:21:01,255 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.298, Acc: 0.879, Base Lr: 4.01e-03
2022-04-25 19:21:15,713 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.291[s] Speed: 55.0[samples/s]
2022-04-25 19:22:19,876 reid_baseline.train INFO: normal accuracy 0.256815578465063 2.7817118167877197 
2022-04-25 19:22:20,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 19:22:20,679 reid_baseline.train INFO: Accuracy: 25.7% Mean Entropy: 278.2%
2022-04-25 19:22:51,843 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.233, Acc: 0.899, Base Lr: 3.69e-03
2022-04-25 19:23:05,061 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.290[s] Speed: 55.2[samples/s]
2022-04-25 19:24:06,729 reid_baseline.train INFO: normal accuracy 0.2558991981672394 2.7037830352783203 
2022-04-25 19:24:07,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 19:24:07,734 reid_baseline.train INFO: Accuracy: 25.6% Mean Entropy: 270.4%
2022-04-25 19:24:38,899 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.194, Acc: 0.920, Base Lr: 3.38e-03
2022-04-25 19:24:53,747 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-25 19:25:55,871 reid_baseline.train INFO: normal accuracy 0.2611683848797251 2.7170467376708984 
2022-04-25 19:25:55,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 19:25:55,876 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 271.7%
2022-04-25 19:26:24,266 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.169, Acc: 0.939, Base Lr: 3.08e-03
2022-04-25 19:26:38,962 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.283[s] Speed: 56.6[samples/s]
2022-04-25 19:27:39,770 reid_baseline.train INFO: normal accuracy 0.26964490263459334 2.6848788261413574 
2022-04-25 19:27:41,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 19:27:41,690 reid_baseline.train INFO: Accuracy: 27.0% Mean Entropy: 268.5%
2022-04-25 19:28:12,601 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.166, Acc: 0.922, Base Lr: 2.77e-03
2022-04-25 19:28:27,223 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-25 19:29:23,126 reid_baseline.train INFO: normal accuracy 0.2652920962199313 2.659360408782959 
2022-04-25 19:29:24,133 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 19:29:24,133 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 265.9%
2022-04-25 19:29:45,982 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.111, Acc: 0.947, Base Lr: 2.48e-03
2022-04-25 19:29:54,059 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.195[s] Speed: 82.2[samples/s]
2022-04-25 19:30:49,987 reid_baseline.train INFO: normal accuracy 0.26643757159221076 2.6258208751678467 
2022-04-25 19:30:51,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 19:30:51,094 reid_baseline.train INFO: Accuracy: 26.6% Mean Entropy: 262.6%
2022-04-25 19:31:22,615 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.956, Base Lr: 2.20e-03
2022-04-25 19:31:37,348 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.303[s] Speed: 52.8[samples/s]
2022-04-25 19:32:39,824 reid_baseline.train INFO: normal accuracy 0.2641466208476518 2.63796067237854 
2022-04-25 19:32:39,829 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 19:32:39,829 reid_baseline.train INFO: Accuracy: 26.4% Mean Entropy: 263.8%
2022-04-25 19:33:09,710 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.082, Acc: 0.960, Base Lr: 1.92e-03
2022-04-25 19:33:24,104 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.291[s] Speed: 55.0[samples/s]
2022-04-25 19:34:26,806 reid_baseline.train INFO: normal accuracy 0.2652920962199313 2.6193912029266357 
2022-04-25 19:34:27,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 19:34:27,880 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 261.9%
2022-04-25 19:34:59,165 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.062, Acc: 0.953, Base Lr: 1.66e-03
2022-04-25 19:35:13,541 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.300[s] Speed: 53.3[samples/s]
2022-04-25 19:36:17,236 reid_baseline.train INFO: normal accuracy 0.26987399770904924 2.584615468978882 
2022-04-25 19:36:18,372 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 19:36:18,373 reid_baseline.train INFO: Accuracy: 27.0% Mean Entropy: 258.5%
2022-04-25 19:36:49,450 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.044, Acc: 0.961, Base Lr: 1.42e-03
2022-04-25 19:37:03,771 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.297[s] Speed: 53.9[samples/s]
2022-04-25 19:38:06,297 reid_baseline.train INFO: normal accuracy 0.27124856815578463 2.5499963760375977 
2022-04-25 19:38:07,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 19:38:07,141 reid_baseline.train INFO: Accuracy: 27.1% Mean Entropy: 255.0%
2022-04-25 19:38:37,195 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.035, Acc: 0.957, Base Lr: 1.19e-03
2022-04-25 19:38:52,593 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-25 19:39:47,031 reid_baseline.train INFO: normal accuracy 0.27262313860252 2.6129915714263916 
2022-04-25 19:39:47,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 19:39:47,032 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 261.3%
2022-04-25 19:40:08,583 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.027, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 19:40:17,757 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.200[s] Speed: 79.8[samples/s]
2022-04-25 19:41:13,819 reid_baseline.train INFO: normal accuracy 0.26872852233676975 2.5885183811187744 
2022-04-25 19:41:13,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 19:41:13,820 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 258.9%
2022-04-25 19:41:44,256 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.023, Acc: 0.972, Base Lr: 7.78e-04
2022-04-25 19:41:59,713 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-25 19:43:03,222 reid_baseline.train INFO: normal accuracy 0.27628865979381445 2.5781350135803223 
2022-04-25 19:43:03,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 19:43:03,227 reid_baseline.train INFO: Accuracy: 27.6% Mean Entropy: 257.8%
2022-04-25 19:43:32,307 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.979, Base Lr: 6.04e-04
2022-04-25 19:43:47,585 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.292[s] Speed: 54.9[samples/s]
2022-04-25 19:44:49,013 reid_baseline.train INFO: normal accuracy 0.27560137457044676 2.5633180141448975 
2022-04-25 19:44:49,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 19:44:49,018 reid_baseline.train INFO: Accuracy: 27.6% Mean Entropy: 256.3%
2022-04-25 19:45:20,135 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.999, Acc: 0.972, Base Lr: 4.51e-04
2022-04-25 19:45:33,608 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.293[s] Speed: 54.6[samples/s]
2022-04-25 19:46:37,778 reid_baseline.train INFO: normal accuracy 0.2733104238258877 2.5363593101501465 
2022-04-25 19:46:38,631 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 19:46:38,632 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 253.6%
2022-04-25 19:47:08,934 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.009, Acc: 0.969, Base Lr: 3.20e-04
2022-04-25 19:47:25,133 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.306[s] Speed: 52.3[samples/s]
2022-04-25 19:48:24,875 reid_baseline.train INFO: normal accuracy 0.27353951890034367 2.581897497177124 
2022-04-25 19:48:24,880 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 19:48:24,880 reid_baseline.train INFO: Accuracy: 27.4% Mean Entropy: 258.2%
2022-04-25 19:48:54,433 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.007, Acc: 0.973, Base Lr: 2.11e-04
2022-04-25 19:49:10,898 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-25 19:50:11,243 reid_baseline.train INFO: normal accuracy 0.27468499427262316 2.565122604370117 
2022-04-25 19:50:11,245 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 19:50:11,245 reid_baseline.train INFO: Accuracy: 27.5% Mean Entropy: 256.5%
2022-04-25 19:50:30,849 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.000, Acc: 0.973, Base Lr: 1.26e-04
2022-04-25 19:50:41,447 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.197[s] Speed: 81.2[samples/s]
2022-04-25 19:51:32,736 reid_baseline.train INFO: normal accuracy 0.27079037800687283 2.556671142578125 
2022-04-25 19:51:32,740 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 19:51:32,741 reid_baseline.train INFO: Accuracy: 27.1% Mean Entropy: 255.7%
2022-04-25 19:52:00,022 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.003, Acc: 0.974, Base Lr: 6.51e-05
2022-04-25 19:52:14,126 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.272[s] Speed: 58.9[samples/s]
2022-04-25 19:53:17,447 reid_baseline.train INFO: normal accuracy 0.2733104238258877 2.5582776069641113 
2022-04-25 19:53:17,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 19:53:17,452 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 255.8%
2022-04-25 19:53:49,347 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.002, Acc: 0.977, Base Lr: 2.83e-05
2022-04-25 19:54:05,107 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.311[s] Speed: 51.4[samples/s]
2022-04-25 19:55:09,616 reid_baseline.train INFO: normal accuracy 0.26918671248568155 2.5282440185546875 
2022-04-25 19:55:10,838 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 19:55:10,839 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 252.8%
2022-04-25 19:55:40,539 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.988, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 19:55:49,414 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.253[s] Speed: 63.2[samples/s]
2022-04-25 19:56:44,710 reid_baseline.train INFO: normal accuracy 0.27491408934707906 2.60007381439209 
2022-04-25 19:56:44,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 19:56:44,715 reid_baseline.train INFO: Accuracy: 27.5% Mean Entropy: 260.0%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 19:57:47,434 reid_baseline.train INFO: normal accuracy 0.26918671248568155 2.5282440185546875 
2022-04-25 19:57:47,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:57:47,435 reid_baseline.train INFO: Accuracy: 26.9%
2022-04-25 19:58:42,926 reid_baseline.train INFO: normal accuracy 0.26918671248568155 2.5282440185546875 
2022-04-25 19:58:42,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:58:42,927 reid_baseline.train INFO: Shuffled Accuracy: 26.9%
2022-04-25 19:59:21,678 reid_baseline.train INFO: normal accuracy 0.9810465595385249 1.11891508102417 
2022-04-25 19:59:21,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 19:59:21,679 reid_baseline.train INFO: Source Clean Accuracy: 98.1%
2022-04-25 19:59:27,008 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_4
2022-04-25 19:59:27,008 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 19:59:27,009 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 19:59:27,009 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 19:59:27,009 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 19:59:40,693 reid_baseline.train INFO: start training
2022-04-25 20:00:11,257 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.098, Base Lr: 4.76e-04
2022-04-25 20:00:25,805 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.292[s] Speed: 54.8[samples/s]
2022-04-25 20:01:13,216 reid_baseline.train INFO: normal accuracy 0.11038522189682361 4.172650337219238 
2022-04-25 20:01:14,153 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 20:01:14,154 reid_baseline.train INFO: Accuracy: 11.0% Mean Entropy: 417.3%
2022-04-25 20:01:35,936 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.032, Acc: 0.225, Base Lr: 8.72e-04
2022-04-25 20:01:48,843 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.228[s] Speed: 70.1[samples/s]
2022-04-25 20:02:52,224 reid_baseline.train INFO: normal accuracy 0.12300067582788916 4.166238307952881 
2022-04-25 20:02:54,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 20:02:54,024 reid_baseline.train INFO: Accuracy: 12.3% Mean Entropy: 416.6%
2022-04-25 20:03:25,115 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.239, Base Lr: 1.27e-03
2022-04-25 20:03:37,329 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.285[s] Speed: 56.2[samples/s]
2022-04-25 20:04:41,742 reid_baseline.train INFO: normal accuracy 0.1220995719756702 4.141010761260986 
2022-04-25 20:04:43,613 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:04:43,613 reid_baseline.train INFO: Accuracy: 12.2% Mean Entropy: 414.1%
2022-04-25 20:05:14,781 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.597, Acc: 0.286, Base Lr: 1.66e-03
2022-04-25 20:05:29,057 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.297[s] Speed: 53.8[samples/s]
2022-04-25 20:06:31,929 reid_baseline.train INFO: normal accuracy 0.127506195088984 4.08183479309082 
2022-04-25 20:06:33,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:06:33,997 reid_baseline.train INFO: Accuracy: 12.8% Mean Entropy: 408.2%
2022-04-25 20:07:04,972 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.396, Acc: 0.286, Base Lr: 2.06e-03
2022-04-25 20:07:19,985 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-25 20:08:23,929 reid_baseline.train INFO: normal accuracy 0.13696778553728317 4.010763168334961 
2022-04-25 20:08:25,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:08:25,806 reid_baseline.train INFO: Accuracy: 13.7% Mean Entropy: 401.1%
2022-04-25 20:08:54,397 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.163, Acc: 0.330, Base Lr: 2.46e-03
2022-04-25 20:09:09,486 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-25 20:10:13,483 reid_baseline.train INFO: normal accuracy 0.15972065780581213 3.8895843029022217 
2022-04-25 20:10:14,298 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 20:10:14,298 reid_baseline.train INFO: Accuracy: 16.0% Mean Entropy: 389.0%
2022-04-25 20:10:44,648 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 20:10:57,419 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.282[s] Speed: 56.6[samples/s]
2022-04-25 20:11:41,451 reid_baseline.train INFO: normal accuracy 0.17909439062851995 3.7803971767425537 
2022-04-25 20:11:42,595 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 20:11:42,595 reid_baseline.train INFO: Accuracy: 17.9% Mean Entropy: 378.0%
2022-04-25 20:12:02,879 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.763, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 20:12:11,991 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 20:12:53,720 reid_baseline.train INFO: normal accuracy 0.21333633701284074 3.678507089614868 
2022-04-25 20:12:55,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 20:12:55,889 reid_baseline.train INFO: Accuracy: 21.3% Mean Entropy: 367.9%
2022-04-25 20:13:14,360 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.591, Acc: 0.471, Base Lr: 3.64e-03
2022-04-25 20:13:24,580 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.187[s] Speed: 85.4[samples/s]
2022-04-25 20:14:05,884 reid_baseline.train INFO: normal accuracy 0.25140797476909216 3.5256447792053223 
2022-04-25 20:14:06,671 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 20:14:06,671 reid_baseline.train INFO: Accuracy: 25.1% Mean Entropy: 352.6%
2022-04-25 20:14:25,306 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.405, Acc: 0.525, Base Lr: 4.04e-03
2022-04-25 20:14:34,973 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.186[s] Speed: 86.1[samples/s]
2022-04-25 20:15:16,766 reid_baseline.train INFO: normal accuracy 0.2646992565893219 3.3929126262664795 
2022-04-25 20:15:17,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 20:15:17,572 reid_baseline.train INFO: Accuracy: 26.5% Mean Entropy: 339.3%
2022-04-25 20:15:36,297 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 20:15:46,115 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.188[s] Speed: 85.3[samples/s]
2022-04-25 20:16:27,958 reid_baseline.train INFO: normal accuracy 0.3129083126830367 3.203991174697876 
2022-04-25 20:16:29,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 20:16:29,409 reid_baseline.train INFO: Accuracy: 31.3% Mean Entropy: 320.4%
2022-04-25 20:16:47,485 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.078, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 20:16:58,071 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.188[s] Speed: 85.1[samples/s]
2022-04-25 20:17:39,592 reid_baseline.train INFO: normal accuracy 0.33678756476683935 3.064265251159668 
2022-04-25 20:17:40,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 20:17:40,392 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 306.4%
2022-04-25 20:17:58,464 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.672, Base Lr: 5.23e-03
2022-04-25 20:18:08,755 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.186[s] Speed: 85.8[samples/s]
2022-04-25 20:18:49,618 reid_baseline.train INFO: normal accuracy 0.35480964181121877 2.9732062816619873 
2022-04-25 20:18:51,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 20:18:51,313 reid_baseline.train INFO: Accuracy: 35.5% Mean Entropy: 297.3%
2022-04-25 20:19:09,704 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.833, Acc: 0.693, Base Lr: 5.62e-03
2022-04-25 20:19:20,405 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.189[s] Speed: 84.4[samples/s]
2022-04-25 20:20:01,603 reid_baseline.train INFO: normal accuracy 0.3638206803334084 2.9247524738311768 
2022-04-25 20:20:02,413 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 20:20:02,413 reid_baseline.train INFO: Accuracy: 36.4% Mean Entropy: 292.5%
2022-04-25 20:20:20,779 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.738, Acc: 0.722, Base Lr: 6.02e-03
2022-04-25 20:20:31,219 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.189[s] Speed: 84.6[samples/s]
2022-04-25 20:21:12,778 reid_baseline.train INFO: normal accuracy 0.38206803334084255 2.7380170822143555 
2022-04-25 20:21:13,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 20:21:13,598 reid_baseline.train INFO: Accuracy: 38.2% Mean Entropy: 273.8%
2022-04-25 20:21:31,903 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.635, Acc: 0.757, Base Lr: 6.42e-03
2022-04-25 20:21:42,172 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.187[s] Speed: 85.6[samples/s]
2022-04-25 20:22:23,863 reid_baseline.train INFO: normal accuracy 0.3915296237891417 2.612306594848633 
2022-04-25 20:22:25,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 20:22:25,636 reid_baseline.train INFO: Accuracy: 39.2% Mean Entropy: 261.2%
2022-04-25 20:22:43,348 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 20:22:54,491 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.190[s] Speed: 84.3[samples/s]
2022-04-25 20:23:36,063 reid_baseline.train INFO: normal accuracy 0.41856273935571076 2.5731008052825928 
2022-04-25 20:23:37,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 20:23:37,094 reid_baseline.train INFO: Accuracy: 41.9% Mean Entropy: 257.3%
2022-04-25 20:23:54,708 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.463, Acc: 0.817, Base Lr: 7.21e-03
2022-04-25 20:24:05,789 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.187[s] Speed: 85.4[samples/s]
2022-04-25 20:24:47,719 reid_baseline.train INFO: normal accuracy 0.4210407749493129 2.6155881881713867 
2022-04-25 20:24:47,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 20:24:47,722 reid_baseline.train INFO: Accuracy: 42.1% Mean Entropy: 261.6%
2022-04-25 20:25:05,753 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.394, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 20:25:16,799 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.190[s] Speed: 84.2[samples/s]
2022-04-25 20:25:57,288 reid_baseline.train INFO: normal accuracy 0.4016670421266051 2.4661152362823486 
2022-04-25 20:25:58,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 20:25:58,329 reid_baseline.train INFO: Accuracy: 40.2% Mean Entropy: 246.6%
2022-04-25 20:26:16,814 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.298, Acc: 0.879, Base Lr: 4.01e-03
2022-04-25 20:26:27,039 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.189[s] Speed: 84.8[samples/s]
2022-04-25 20:27:09,912 reid_baseline.train INFO: normal accuracy 0.4271232259517909 2.3726353645324707 
2022-04-25 20:27:10,742 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 20:27:10,743 reid_baseline.train INFO: Accuracy: 42.7% Mean Entropy: 237.3%
2022-04-25 20:27:28,090 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.233, Acc: 0.899, Base Lr: 3.69e-03
2022-04-25 20:27:39,310 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.188[s] Speed: 85.2[samples/s]
2022-04-25 20:28:21,060 reid_baseline.train INFO: normal accuracy 0.4316287452128858 2.3648757934570312 
2022-04-25 20:28:21,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 20:28:21,860 reid_baseline.train INFO: Accuracy: 43.2% Mean Entropy: 236.5%
2022-04-25 20:28:39,164 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.194, Acc: 0.920, Base Lr: 3.38e-03
2022-04-25 20:28:50,290 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.187[s] Speed: 85.6[samples/s]
2022-04-25 20:29:31,784 reid_baseline.train INFO: normal accuracy 0.4473980626267177 2.3409855365753174 
2022-04-25 20:29:32,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 20:29:32,594 reid_baseline.train INFO: Accuracy: 44.7% Mean Entropy: 234.1%
2022-04-25 20:29:50,676 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.169, Acc: 0.939, Base Lr: 3.08e-03
2022-04-25 20:30:01,870 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 20:30:43,235 reid_baseline.train INFO: normal accuracy 0.4408650596981302 2.323735237121582 
2022-04-25 20:30:45,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 20:30:45,114 reid_baseline.train INFO: Accuracy: 44.1% Mean Entropy: 232.4%
2022-04-25 20:31:03,383 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.166, Acc: 0.922, Base Lr: 2.77e-03
2022-04-25 20:31:14,463 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.192[s] Speed: 83.2[samples/s]
2022-04-25 20:31:55,968 reid_baseline.train INFO: normal accuracy 0.45077720207253885 2.2907557487487793 
2022-04-25 20:31:57,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 20:31:57,179 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 229.1%
2022-04-25 20:32:15,350 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.111, Acc: 0.947, Base Lr: 2.48e-03
2022-04-25 20:32:26,446 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.192[s] Speed: 83.2[samples/s]
2022-04-25 20:33:06,536 reid_baseline.train INFO: normal accuracy 0.44649695877449874 2.252305269241333 
2022-04-25 20:33:08,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 20:33:08,537 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 225.2%
2022-04-25 20:33:26,535 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.956, Base Lr: 2.20e-03
2022-04-25 20:33:37,622 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.191[s] Speed: 83.9[samples/s]
2022-04-25 20:34:18,380 reid_baseline.train INFO: normal accuracy 0.43951340391980176 2.295894145965576 
2022-04-25 20:34:18,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 20:34:18,383 reid_baseline.train INFO: Accuracy: 44.0% Mean Entropy: 229.6%
2022-04-25 20:34:37,112 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.082, Acc: 0.960, Base Lr: 1.92e-03
2022-04-25 20:34:48,206 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-25 20:35:28,846 reid_baseline.train INFO: normal accuracy 0.4422167154764587 2.267895221710205 
2022-04-25 20:35:28,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 20:35:28,849 reid_baseline.train INFO: Accuracy: 44.2% Mean Entropy: 226.8%
2022-04-25 20:35:47,095 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.062, Acc: 0.953, Base Lr: 1.66e-03
2022-04-25 20:35:58,436 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.194[s] Speed: 82.3[samples/s]
2022-04-25 20:36:40,055 reid_baseline.train INFO: normal accuracy 0.4478486145528272 2.2402634620666504 
2022-04-25 20:36:40,873 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 20:36:40,873 reid_baseline.train INFO: Accuracy: 44.8% Mean Entropy: 224.0%
2022-04-25 20:36:58,721 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.044, Acc: 0.961, Base Lr: 1.42e-03
2022-04-25 20:37:09,898 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.191[s] Speed: 83.8[samples/s]
2022-04-25 20:37:51,745 reid_baseline.train INFO: normal accuracy 0.45010137418337465 2.2199997901916504 
2022-04-25 20:37:52,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 20:37:52,576 reid_baseline.train INFO: Accuracy: 45.0% Mean Entropy: 222.0%
2022-04-25 20:38:10,906 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.035, Acc: 0.957, Base Lr: 1.19e-03
2022-04-25 20:38:22,140 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 20:39:03,371 reid_baseline.train INFO: normal accuracy 0.44694751070060823 2.287886142730713 
2022-04-25 20:39:03,373 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 20:39:03,374 reid_baseline.train INFO: Accuracy: 44.7% Mean Entropy: 228.8%
2022-04-25 20:39:21,526 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.027, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 20:39:32,665 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.192[s] Speed: 83.4[samples/s]
2022-04-25 20:40:14,344 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.2519192695617676 
2022-04-25 20:40:14,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 20:40:14,346 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 225.2%
2022-04-25 20:40:33,432 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.023, Acc: 0.972, Base Lr: 7.78e-04
2022-04-25 20:40:44,545 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.198[s] Speed: 80.7[samples/s]
2022-04-25 20:41:25,934 reid_baseline.train INFO: normal accuracy 0.45550799729668845 2.255537748336792 
2022-04-25 20:41:25,936 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 20:41:25,937 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 225.6%
2022-04-25 20:41:43,652 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.979, Base Lr: 6.04e-04
2022-04-25 20:41:54,657 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.188[s] Speed: 85.0[samples/s]
2022-04-25 20:42:36,196 reid_baseline.train INFO: normal accuracy 0.4584365848164001 2.2356173992156982 
2022-04-25 20:42:36,198 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 20:42:36,198 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 223.6%
2022-04-25 20:42:54,720 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.999, Acc: 0.972, Base Lr: 4.51e-04
2022-04-25 20:43:05,782 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.192[s] Speed: 83.3[samples/s]
2022-04-25 20:43:47,189 reid_baseline.train INFO: normal accuracy 0.4546068934444695 2.2295186519622803 
2022-04-25 20:43:47,191 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 20:43:47,191 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 223.0%
2022-04-25 20:44:05,108 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.009, Acc: 0.969, Base Lr: 3.20e-04
2022-04-25 20:44:16,334 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.191[s] Speed: 83.6[samples/s]
2022-04-25 20:44:58,843 reid_baseline.train INFO: normal accuracy 0.45618382518585265 2.278879404067993 
2022-04-25 20:44:58,846 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 20:44:58,846 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 227.9%
2022-04-25 20:45:17,402 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.007, Acc: 0.973, Base Lr: 2.11e-04
2022-04-25 20:45:28,443 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 20:46:10,356 reid_baseline.train INFO: normal accuracy 0.45550799729668845 2.262216091156006 
2022-04-25 20:46:10,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 20:46:10,359 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 226.2%
2022-04-25 20:46:28,946 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.000, Acc: 0.973, Base Lr: 1.26e-04
2022-04-25 20:46:40,085 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.195[s] Speed: 82.1[samples/s]
2022-04-25 20:47:21,570 reid_baseline.train INFO: normal accuracy 0.4530299617030863 2.2508342266082764 
2022-04-25 20:47:21,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 20:47:21,573 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 225.1%
2022-04-25 20:47:40,231 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.003, Acc: 0.974, Base Lr: 6.51e-05
2022-04-25 20:47:51,309 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 20:48:32,626 reid_baseline.train INFO: normal accuracy 0.45618382518585265 2.24168062210083 
2022-04-25 20:48:32,628 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 20:48:32,628 reid_baseline.train INFO: Accuracy: 45.6% Mean Entropy: 224.2%
2022-04-25 20:48:53,403 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.002, Acc: 0.977, Base Lr: 2.83e-05
2022-04-25 20:49:03,350 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.201[s] Speed: 79.5[samples/s]
2022-04-25 20:49:43,997 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.213996171951294 
2022-04-25 20:49:44,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 20:49:44,894 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 221.4%
2022-04-25 20:50:01,733 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.988, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 20:50:07,410 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.148[s] Speed: 108.3[samples/s]
2022-04-25 20:50:40,867 reid_baseline.train INFO: normal accuracy 0.45438161748141476 2.2888143062591553 
2022-04-25 20:50:40,870 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 20:50:40,870 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 228.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 20:51:15,370 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.213996171951294 
2022-04-25 20:51:15,377 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:51:15,377 reid_baseline.train INFO: Accuracy: 45.1%
2022-04-25 20:51:55,091 reid_baseline.train INFO: normal accuracy 0.4510024780355936 2.213996171951294 
2022-04-25 20:51:55,091 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:51:55,091 reid_baseline.train INFO: Shuffled Accuracy: 45.1%
2022-04-25 20:52:15,141 reid_baseline.train INFO: normal accuracy 0.9810465595385249 1.11891508102417 
2022-04-25 20:52:15,142 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 20:52:15,142 reid_baseline.train INFO: Source Clean Accuracy: 98.1%
2022-04-25 20:52:20,290 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_4
2022-04-25 20:52:20,290 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-25 20:52:20,290 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 20:52:20,290 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 20:52:20,290 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 20:52:35,250 reid_baseline.train INFO: start training
2022-04-25 20:52:55,335 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.098, Base Lr: 4.76e-04
2022-04-25 20:53:04,074 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.186[s] Speed: 86.0[samples/s]
2022-04-25 20:53:59,442 reid_baseline.train INFO: normal accuracy 0.17672710580674778 4.172266483306885 
2022-04-25 20:54:00,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 20:54:00,392 reid_baseline.train INFO: Accuracy: 17.7% Mean Entropy: 417.2%
2022-04-25 20:54:20,149 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.032, Acc: 0.225, Base Lr: 8.72e-04
2022-04-25 20:54:28,834 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.187[s] Speed: 85.5[samples/s]
2022-04-25 20:55:23,209 reid_baseline.train INFO: normal accuracy 0.19531787927473032 4.163070201873779 
2022-04-25 20:55:24,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 20:55:24,144 reid_baseline.train INFO: Accuracy: 19.5% Mean Entropy: 416.3%
2022-04-25 20:55:42,635 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.842, Acc: 0.239, Base Lr: 1.27e-03
2022-04-25 20:55:52,474 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.186[s] Speed: 86.0[samples/s]
2022-04-25 20:56:48,738 reid_baseline.train INFO: normal accuracy 0.20220335092953867 4.122245788574219 
2022-04-25 20:56:49,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 20:56:49,927 reid_baseline.train INFO: Accuracy: 20.2% Mean Entropy: 412.2%
2022-04-25 20:57:07,355 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.597, Acc: 0.286, Base Lr: 1.66e-03
2022-04-25 20:57:17,218 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.179[s] Speed: 89.2[samples/s]
2022-04-25 20:58:13,333 reid_baseline.train INFO: normal accuracy 0.21023640119348175 4.026134014129639 
2022-04-25 20:58:14,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 20:58:14,558 reid_baseline.train INFO: Accuracy: 21.0% Mean Entropy: 402.6%
2022-04-25 20:58:33,514 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.396, Acc: 0.286, Base Lr: 2.06e-03
2022-04-25 20:58:43,338 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.188[s] Speed: 85.3[samples/s]
2022-04-25 20:59:37,388 reid_baseline.train INFO: normal accuracy 0.23410603626348406 3.9219932556152344 
2022-04-25 20:59:38,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 20:59:38,280 reid_baseline.train INFO: Accuracy: 23.4% Mean Entropy: 392.2%
2022-04-25 20:59:55,513 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.163, Acc: 0.330, Base Lr: 2.46e-03
2022-04-25 21:00:05,319 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.176[s] Speed: 90.8[samples/s]
2022-04-25 21:00:59,138 reid_baseline.train INFO: normal accuracy 0.2536148726187744 3.729184865951538 
2022-04-25 21:00:59,924 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 21:00:59,924 reid_baseline.train INFO: Accuracy: 25.4% Mean Entropy: 372.9%
2022-04-25 21:01:17,409 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.963, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 21:01:27,174 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.179[s] Speed: 89.6[samples/s]
2022-04-25 21:02:25,861 reid_baseline.train INFO: normal accuracy 0.2866651365618545 3.578331232070923 
2022-04-25 21:02:26,633 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 21:02:26,633 reid_baseline.train INFO: Accuracy: 28.7% Mean Entropy: 357.8%
2022-04-25 21:02:45,206 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.763, Acc: 0.426, Base Lr: 3.25e-03
2022-04-25 21:02:55,035 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.186[s] Speed: 86.0[samples/s]
2022-04-25 21:03:48,706 reid_baseline.train INFO: normal accuracy 0.3238466834978196 3.4268951416015625 
2022-04-25 21:03:49,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 21:03:49,560 reid_baseline.train INFO: Accuracy: 32.4% Mean Entropy: 342.7%
2022-04-25 21:04:09,110 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.591, Acc: 0.471, Base Lr: 3.64e-03
2022-04-25 21:04:19,000 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-25 21:05:13,464 reid_baseline.train INFO: normal accuracy 0.355749368831765 3.242007255554199 
2022-04-25 21:05:14,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 21:05:14,248 reid_baseline.train INFO: Accuracy: 35.6% Mean Entropy: 324.2%
2022-04-25 21:05:33,674 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.405, Acc: 0.525, Base Lr: 4.04e-03
2022-04-25 21:05:43,470 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.190[s] Speed: 84.3[samples/s]
2022-04-25 21:06:40,968 reid_baseline.train INFO: normal accuracy 0.3924718843240762 3.0648488998413086 
2022-04-25 21:06:41,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 21:06:41,763 reid_baseline.train INFO: Accuracy: 39.2% Mean Entropy: 306.5%
2022-04-25 21:07:01,510 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.258, Acc: 0.569, Base Lr: 4.44e-03
2022-04-25 21:07:11,327 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.193[s] Speed: 82.7[samples/s]
2022-04-25 21:08:09,147 reid_baseline.train INFO: normal accuracy 0.4236860224925407 2.887533187866211 
2022-04-25 21:08:10,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 21:08:10,165 reid_baseline.train INFO: Accuracy: 42.4% Mean Entropy: 288.8%
2022-04-25 21:08:30,398 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.078, Acc: 0.627, Base Lr: 4.83e-03
2022-04-25 21:08:39,764 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-25 21:09:34,635 reid_baseline.train INFO: normal accuracy 0.4507688776681203 2.7232415676116943 
2022-04-25 21:09:35,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 21:09:35,469 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 272.3%
2022-04-25 21:09:55,464 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.935, Acc: 0.672, Base Lr: 5.23e-03
2022-04-25 21:10:04,876 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.193[s] Speed: 82.9[samples/s]
2022-04-25 21:11:00,700 reid_baseline.train INFO: normal accuracy 0.46981868257975673 2.617147922515869 
2022-04-25 21:11:01,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 21:11:01,665 reid_baseline.train INFO: Accuracy: 47.0% Mean Entropy: 261.7%
2022-04-25 21:11:22,210 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.833, Acc: 0.693, Base Lr: 5.62e-03
2022-04-25 21:11:31,369 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.194[s] Speed: 82.5[samples/s]
2022-04-25 21:12:28,431 reid_baseline.train INFO: normal accuracy 0.4957539591462015 2.5344274044036865 
2022-04-25 21:12:29,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 21:12:29,560 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 253.4%
2022-04-25 21:12:49,208 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.738, Acc: 0.722, Base Lr: 6.02e-03
2022-04-25 21:12:59,013 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-25 21:13:51,601 reid_baseline.train INFO: normal accuracy 0.49804911636447097 2.4008421897888184 
2022-04-25 21:13:52,455 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 21:13:52,455 reid_baseline.train INFO: Accuracy: 49.8% Mean Entropy: 240.1%
2022-04-25 21:14:11,284 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.635, Acc: 0.757, Base Lr: 6.42e-03
2022-04-25 21:14:21,062 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.188[s] Speed: 85.1[samples/s]
2022-04-25 21:15:15,882 reid_baseline.train INFO: normal accuracy 0.5221482671563002 2.3165862560272217 
2022-04-25 21:15:16,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 21:15:16,715 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 231.7%
2022-04-25 21:15:34,689 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.531, Acc: 0.806, Base Lr: 6.81e-03
2022-04-25 21:15:44,460 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.181[s] Speed: 88.2[samples/s]
2022-04-25 21:16:41,979 reid_baseline.train INFO: normal accuracy 0.5308698645857242 2.232088088989258 
2022-04-25 21:16:42,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 21:16:42,975 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 223.2%
2022-04-25 21:17:01,588 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.463, Acc: 0.817, Base Lr: 7.21e-03
2022-04-25 21:17:11,478 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.186[s] Speed: 86.2[samples/s]
2022-04-25 21:18:08,433 reid_baseline.train INFO: normal accuracy 0.5432637135643792 2.262678861618042 
2022-04-25 21:18:08,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 21:18:08,434 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 226.3%
2022-04-25 21:18:26,044 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.394, Acc: 0.839, Base Lr: 7.60e-03
2022-04-25 21:18:35,876 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.180[s] Speed: 88.7[samples/s]
2022-04-25 21:19:29,860 reid_baseline.train INFO: normal accuracy 0.531328896029378 2.1756491661071777 
2022-04-25 21:19:30,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 21:19:30,677 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 217.6%
2022-04-25 21:19:49,792 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.298, Acc: 0.879, Base Lr: 4.01e-03
2022-04-25 21:19:59,692 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.190[s] Speed: 84.1[samples/s]
2022-04-25 21:20:54,840 reid_baseline.train INFO: normal accuracy 0.5529033738811109 2.0949325561523438 
2022-04-25 21:20:56,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 21:20:56,060 reid_baseline.train INFO: Accuracy: 55.3% Mean Entropy: 209.5%
2022-04-25 21:21:15,380 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.233, Acc: 0.899, Base Lr: 3.69e-03
2022-04-25 21:21:25,292 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.190[s] Speed: 84.0[samples/s]
2022-04-25 21:22:21,705 reid_baseline.train INFO: normal accuracy 0.5572641725958228 2.072524309158325 
2022-04-25 21:22:22,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 21:22:22,817 reid_baseline.train INFO: Accuracy: 55.7% Mean Entropy: 207.3%
2022-04-25 21:22:42,879 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.194, Acc: 0.920, Base Lr: 3.38e-03
2022-04-25 21:22:52,831 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-25 21:23:54,173 reid_baseline.train INFO: normal accuracy 0.5627725499196695 2.074444532394409 
2022-04-25 21:23:54,174 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 21:23:54,174 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 207.4%
2022-04-25 21:24:13,657 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.169, Acc: 0.939, Base Lr: 3.08e-03
2022-04-25 21:24:23,456 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.192[s] Speed: 83.2[samples/s]
2022-04-25 21:25:21,041 reid_baseline.train INFO: normal accuracy 0.564838191416112 2.059260368347168 
2022-04-25 21:25:22,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 21:25:22,093 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 205.9%
2022-04-25 21:25:42,776 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.166, Acc: 0.922, Base Lr: 2.77e-03
2022-04-25 21:25:51,590 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 21:26:51,159 reid_baseline.train INFO: normal accuracy 0.5703465687399587 2.0359697341918945 
2022-04-25 21:26:52,466 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 21:26:52,466 reid_baseline.train INFO: Accuracy: 57.0% Mean Entropy: 203.6%
2022-04-25 21:27:13,118 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.111, Acc: 0.947, Base Lr: 2.48e-03
2022-04-25 21:27:21,711 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.192[s] Speed: 83.3[samples/s]
2022-04-25 21:28:17,254 reid_baseline.train INFO: normal accuracy 0.5652972228597659 2.0089967250823975 
2022-04-25 21:28:18,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 21:28:18,478 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 200.9%
2022-04-25 21:28:38,435 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.094, Acc: 0.956, Base Lr: 2.20e-03
2022-04-25 21:28:47,341 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.189[s] Speed: 84.5[samples/s]
2022-04-25 21:29:50,157 reid_baseline.train INFO: normal accuracy 0.5574936883176498 2.043724775314331 
2022-04-25 21:29:50,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 21:29:50,157 reid_baseline.train INFO: Accuracy: 55.7% Mean Entropy: 204.4%
2022-04-25 21:30:09,948 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.082, Acc: 0.960, Base Lr: 1.92e-03
2022-04-25 21:30:18,387 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.185[s] Speed: 86.5[samples/s]
2022-04-25 21:31:18,864 reid_baseline.train INFO: normal accuracy 0.5639201285288042 2.0088703632354736 
2022-04-25 21:31:20,042 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 21:31:20,042 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 200.9%
2022-04-25 21:31:40,645 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.062, Acc: 0.953, Base Lr: 1.66e-03
2022-04-25 21:31:49,638 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.194[s] Speed: 82.3[samples/s]
2022-04-25 21:32:43,926 reid_baseline.train INFO: normal accuracy 0.5726417259582282 1.9974640607833862 
2022-04-25 21:32:44,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 21:32:44,907 reid_baseline.train INFO: Accuracy: 57.3% Mean Entropy: 199.7%
2022-04-25 21:33:05,752 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.044, Acc: 0.961, Base Lr: 1.42e-03
2022-04-25 21:33:15,728 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.199[s] Speed: 80.3[samples/s]
2022-04-25 21:34:13,425 reid_baseline.train INFO: normal accuracy 0.5724122102364012 1.9785138368606567 
2022-04-25 21:34:14,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 21:34:14,279 reid_baseline.train INFO: Accuracy: 57.2% Mean Entropy: 197.9%
2022-04-25 21:34:34,766 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.035, Acc: 0.957, Base Lr: 1.19e-03
2022-04-25 21:34:44,322 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.197[s] Speed: 81.1[samples/s]
2022-04-25 21:35:45,575 reid_baseline.train INFO: normal accuracy 0.5744778517328437 2.0379302501678467 
2022-04-25 21:35:45,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 21:35:45,578 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 203.8%
2022-04-25 21:36:05,389 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.027, Acc: 0.967, Base Lr: 9.72e-04
2022-04-25 21:36:15,149 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.194[s] Speed: 82.7[samples/s]
2022-04-25 21:37:14,116 reid_baseline.train INFO: normal accuracy 0.5721826945145743 2.0045602321624756 
2022-04-25 21:37:14,116 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 21:37:14,117 reid_baseline.train INFO: Accuracy: 57.2% Mean Entropy: 200.5%
2022-04-25 21:37:34,685 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.023, Acc: 0.972, Base Lr: 7.78e-04
2022-04-25 21:37:44,601 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.199[s] Speed: 80.6[samples/s]
2022-04-25 21:38:37,423 reid_baseline.train INFO: normal accuracy 0.577232040394767 2.011798620223999 
2022-04-25 21:38:37,425 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 21:38:37,426 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 201.2%
2022-04-25 21:38:56,161 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.011, Acc: 0.979, Base Lr: 6.04e-04
2022-04-25 21:39:06,127 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.189[s] Speed: 84.9[samples/s]
2022-04-25 21:40:08,580 reid_baseline.train INFO: normal accuracy 0.5751663988983245 1.994834542274475 
2022-04-25 21:40:08,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 21:40:08,581 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 199.5%
2022-04-25 21:40:27,075 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.999, Acc: 0.972, Base Lr: 4.51e-04
2022-04-25 21:40:36,913 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.185[s] Speed: 86.5[samples/s]
2022-04-25 21:41:39,671 reid_baseline.train INFO: normal accuracy 0.5744778517328437 1.9905983209609985 
2022-04-25 21:41:39,671 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 21:41:39,671 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 199.1%
2022-04-25 21:41:59,105 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.009, Acc: 0.969, Base Lr: 3.20e-04
2022-04-25 21:42:08,941 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.190[s] Speed: 84.0[samples/s]
2022-04-25 21:43:06,900 reid_baseline.train INFO: normal accuracy 0.5763139775074593 2.034834623336792 
2022-04-25 21:43:06,901 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 21:43:06,901 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 203.5%
2022-04-25 21:43:27,237 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.007, Acc: 0.973, Base Lr: 2.11e-04
2022-04-25 21:43:37,216 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.198[s] Speed: 80.8[samples/s]
2022-04-25 21:44:33,920 reid_baseline.train INFO: normal accuracy 0.5753959146201515 2.0255608558654785 
2022-04-25 21:44:33,922 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 21:44:33,922 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 202.6%
2022-04-25 21:44:53,213 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.000, Acc: 0.973, Base Lr: 1.26e-04
2022-04-25 21:45:03,019 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 21:46:07,052 reid_baseline.train INFO: normal accuracy 0.5717236630709204 2.0204648971557617 
2022-04-25 21:46:07,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 21:46:07,055 reid_baseline.train INFO: Accuracy: 57.2% Mean Entropy: 202.0%
2022-04-25 21:46:25,513 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.003, Acc: 0.974, Base Lr: 6.51e-05
2022-04-25 21:46:35,339 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.186[s] Speed: 86.1[samples/s]
2022-04-25 21:47:34,130 reid_baseline.train INFO: normal accuracy 0.5758549460638054 2.013230323791504 
2022-04-25 21:47:34,133 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 21:47:34,133 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 201.3%
2022-04-25 21:47:49,180 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.002, Acc: 0.977, Base Lr: 2.83e-05
2022-04-25 21:47:57,573 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.153[s] Speed: 104.7[samples/s]
2022-04-25 21:48:55,534 reid_baseline.train INFO: normal accuracy 0.5740188202891898 1.9818189144134521 
2022-04-25 21:48:55,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 21:48:55,536 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 198.2%
2022-04-25 21:49:14,950 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.988, Acc: 0.977, Base Lr: 1.60e-05
2022-04-25 21:49:24,807 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.192[s] Speed: 83.4[samples/s]
2022-04-25 21:50:23,999 reid_baseline.train INFO: normal accuracy 0.5737893045673629 2.051217555999756 
2022-04-25 21:50:23,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 21:50:24,000 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 205.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_4/transformer_best_model.pth
2022-04-25 21:51:19,201 reid_baseline.train INFO: normal accuracy 0.5724122102364012 1.9785138368606567 
2022-04-25 21:51:19,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:51:19,202 reid_baseline.train INFO: Accuracy: 57.2%
2022-04-25 21:52:10,849 reid_baseline.train INFO: normal accuracy 0.5724122102364012 1.9785138368606567 
2022-04-25 21:52:10,850 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:52:10,850 reid_baseline.train INFO: Shuffled Accuracy: 57.2%
2022-04-25 21:52:36,057 reid_baseline.train INFO: normal accuracy 0.9740420271940667 1.1732879877090454 
2022-04-25 21:52:36,057 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 21:52:36,057 reid_baseline.train INFO: Source Clean Accuracy: 97.4%
2022-04-25 21:52:41,018 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_6
2022-04-25 21:52:41,019 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-25 21:52:41,019 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 21:52:41,019 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 21:52:41,019 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 21:52:52,249 reid_baseline.train INFO: start training
2022-04-25 21:53:16,099 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.102, Base Lr: 4.76e-04
2022-04-25 21:53:26,971 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.225[s] Speed: 71.1[samples/s]
2022-04-25 21:54:04,323 reid_baseline.train INFO: normal accuracy 0.0865979381443299 4.172597885131836 
2022-04-25 21:54:05,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 21:54:05,237 reid_baseline.train INFO: Accuracy: 8.7% Mean Entropy: 417.3%
2022-04-25 21:54:28,728 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.222, Base Lr: 8.72e-04
2022-04-25 21:54:39,786 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.227[s] Speed: 70.4[samples/s]
2022-04-25 21:55:17,457 reid_baseline.train INFO: normal accuracy 0.09667812142038947 4.166475296020508 
2022-04-25 21:55:18,414 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 21:55:18,414 reid_baseline.train INFO: Accuracy: 9.7% Mean Entropy: 416.6%
2022-04-25 21:55:40,764 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.835, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 21:55:51,891 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.220[s] Speed: 72.9[samples/s]
2022-04-25 21:56:30,586 reid_baseline.train INFO: normal accuracy 0.09942726231386025 4.14488410949707 
2022-04-25 21:56:31,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 21:56:31,813 reid_baseline.train INFO: Accuracy: 9.9% Mean Entropy: 414.5%
2022-04-25 21:56:55,021 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.592, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 21:57:06,087 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.225[s] Speed: 71.0[samples/s]
2022-04-25 21:57:43,618 reid_baseline.train INFO: normal accuracy 0.10309278350515463 4.102084159851074 
2022-04-25 21:57:44,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 21:57:44,434 reid_baseline.train INFO: Accuracy: 10.3% Mean Entropy: 410.2%
2022-04-25 21:58:06,570 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.406, Acc: 0.298, Base Lr: 2.06e-03
2022-04-25 21:58:17,979 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.219[s] Speed: 73.0[samples/s]
2022-04-25 21:58:56,090 reid_baseline.train INFO: normal accuracy 0.1143184421534937 4.047160625457764 
2022-04-25 21:58:56,856 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 21:58:56,857 reid_baseline.train INFO: Accuracy: 11.4% Mean Entropy: 404.7%
2022-04-25 21:59:18,034 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.171, Acc: 0.321, Base Lr: 2.46e-03
2022-04-25 21:59:29,141 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.212[s] Speed: 75.5[samples/s]
2022-04-25 22:00:06,819 reid_baseline.train INFO: normal accuracy 0.12233676975945017 3.949965715408325 
2022-04-25 22:00:07,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 22:00:07,755 reid_baseline.train INFO: Accuracy: 12.2% Mean Entropy: 395.0%
2022-04-25 22:00:28,972 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.978, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 22:00:40,406 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.214[s] Speed: 74.8[samples/s]
2022-04-25 22:01:18,622 reid_baseline.train INFO: normal accuracy 0.1406643757159221 3.8524539470672607 
2022-04-25 22:01:20,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 22:01:20,159 reid_baseline.train INFO: Accuracy: 14.1% Mean Entropy: 385.2%
2022-04-25 22:01:41,365 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.788, Acc: 0.412, Base Lr: 3.25e-03
2022-04-25 22:01:52,409 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.211[s] Speed: 75.7[samples/s]
2022-04-25 22:02:30,374 reid_baseline.train INFO: normal accuracy 0.15418098510882017 3.8045170307159424 
2022-04-25 22:02:31,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 22:02:31,305 reid_baseline.train INFO: Accuracy: 15.4% Mean Entropy: 380.5%
2022-04-25 22:02:52,742 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.595, Acc: 0.458, Base Lr: 3.64e-03
2022-04-25 22:03:03,981 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-25 22:03:40,764 reid_baseline.train INFO: normal accuracy 0.1665521191294387 3.705749273300171 
2022-04-25 22:03:42,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 22:03:42,643 reid_baseline.train INFO: Accuracy: 16.7% Mean Entropy: 370.6%
2022-04-25 22:04:02,345 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.426, Acc: 0.515, Base Lr: 4.04e-03
2022-04-25 22:04:13,333 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.202[s] Speed: 79.3[samples/s]
2022-04-25 22:04:50,002 reid_baseline.train INFO: normal accuracy 0.1768613974799542 3.57944655418396 
2022-04-25 22:04:51,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 22:04:51,316 reid_baseline.train INFO: Accuracy: 17.7% Mean Entropy: 357.9%
2022-04-25 22:05:11,314 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.271, Acc: 0.562, Base Lr: 4.44e-03
2022-04-25 22:05:22,368 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.203[s] Speed: 78.9[samples/s]
2022-04-25 22:06:01,746 reid_baseline.train INFO: normal accuracy 0.1981672394043528 3.5081310272216797 
2022-04-25 22:06:02,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 22:06:02,654 reid_baseline.train INFO: Accuracy: 19.8% Mean Entropy: 350.8%
2022-04-25 22:06:21,917 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.099, Acc: 0.620, Base Lr: 4.83e-03
2022-04-25 22:06:33,204 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.201[s] Speed: 79.7[samples/s]
2022-04-25 22:07:10,913 reid_baseline.train INFO: normal accuracy 0.21351660939289804 3.4181320667266846 
2022-04-25 22:07:12,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 22:07:12,238 reid_baseline.train INFO: Accuracy: 21.4% Mean Entropy: 341.8%
2022-04-25 22:07:31,577 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.946, Acc: 0.678, Base Lr: 5.23e-03
2022-04-25 22:07:42,732 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.200[s] Speed: 79.9[samples/s]
2022-04-25 22:08:21,638 reid_baseline.train INFO: normal accuracy 0.21603665521191295 3.32745099067688 
2022-04-25 22:08:22,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 22:08:22,543 reid_baseline.train INFO: Accuracy: 21.6% Mean Entropy: 332.7%
2022-04-25 22:08:41,523 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.855, Acc: 0.681, Base Lr: 5.62e-03
2022-04-25 22:08:52,973 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.199[s] Speed: 80.2[samples/s]
2022-04-25 22:09:31,834 reid_baseline.train INFO: normal accuracy 0.2320733104238259 3.264263868331909 
2022-04-25 22:09:33,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 22:09:33,875 reid_baseline.train INFO: Accuracy: 23.2% Mean Entropy: 326.4%
2022-04-25 22:09:52,841 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.753, Acc: 0.732, Base Lr: 6.02e-03
2022-04-25 22:10:03,867 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.196[s] Speed: 81.4[samples/s]
2022-04-25 22:10:43,016 reid_baseline.train INFO: normal accuracy 0.24054982817869416 3.109563112258911 
2022-04-25 22:10:44,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 22:10:44,072 reid_baseline.train INFO: Accuracy: 24.1% Mean Entropy: 311.0%
2022-04-25 22:11:04,347 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.642, Acc: 0.755, Base Lr: 6.42e-03
2022-04-25 22:11:15,704 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-25 22:11:54,211 reid_baseline.train INFO: normal accuracy 0.24513172966781213 3.0766069889068604 
2022-04-25 22:11:55,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 22:11:55,062 reid_baseline.train INFO: Accuracy: 24.5% Mean Entropy: 307.7%
2022-04-25 22:12:13,675 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.540, Acc: 0.801, Base Lr: 6.81e-03
2022-04-25 22:12:24,709 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.195[s] Speed: 82.1[samples/s]
2022-04-25 22:13:03,650 reid_baseline.train INFO: normal accuracy 0.24329896907216494 3.0212321281433105 
2022-04-25 22:13:04,756 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 22:13:04,756 reid_baseline.train INFO: Accuracy: 24.3% Mean Entropy: 302.1%
2022-04-25 22:13:24,726 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.468, Acc: 0.816, Base Lr: 7.21e-03
2022-04-25 22:13:36,082 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-25 22:14:15,325 reid_baseline.train INFO: normal accuracy 0.24925544100801833 2.9285361766815186 
2022-04-25 22:14:16,196 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 22:14:16,196 reid_baseline.train INFO: Accuracy: 24.9% Mean Entropy: 292.9%
2022-04-25 22:14:35,362 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.396, Acc: 0.844, Base Lr: 7.60e-03
2022-04-25 22:14:46,431 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.198[s] Speed: 81.0[samples/s]
2022-04-25 22:15:24,435 reid_baseline.train INFO: normal accuracy 0.2593356242840779 2.821117877960205 
2022-04-25 22:15:25,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 22:15:25,450 reid_baseline.train INFO: Accuracy: 25.9% Mean Entropy: 282.1%
2022-04-25 22:15:45,379 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.312, Acc: 0.871, Base Lr: 4.01e-03
2022-04-25 22:15:56,557 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.203[s] Speed: 78.7[samples/s]
2022-04-25 22:16:36,115 reid_baseline.train INFO: normal accuracy 0.2593356242840779 2.753756523132324 
2022-04-25 22:16:36,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 22:16:36,953 reid_baseline.train INFO: Accuracy: 25.9% Mean Entropy: 275.4%
2022-04-25 22:16:55,404 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.252, Acc: 0.900, Base Lr: 3.69e-03
2022-04-25 22:17:06,449 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-25 22:17:46,267 reid_baseline.train INFO: normal accuracy 0.2536082474226804 2.6882216930389404 
2022-04-25 22:17:47,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 22:17:47,541 reid_baseline.train INFO: Accuracy: 25.4% Mean Entropy: 268.8%
2022-04-25 22:18:07,977 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.200, Acc: 0.916, Base Lr: 3.38e-03
2022-04-25 22:18:19,155 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.206[s] Speed: 77.6[samples/s]
2022-04-25 22:18:57,837 reid_baseline.train INFO: normal accuracy 0.26849942726231385 2.71488094329834 
2022-04-25 22:18:57,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 22:18:57,840 reid_baseline.train INFO: Accuracy: 26.8% Mean Entropy: 271.5%
2022-04-25 22:19:16,536 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.195, Acc: 0.925, Base Lr: 3.08e-03
2022-04-25 22:19:27,815 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.197[s] Speed: 81.2[samples/s]
2022-04-25 22:20:07,596 reid_baseline.train INFO: normal accuracy 0.27056128293241694 2.697683572769165 
2022-04-25 22:20:07,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 22:20:07,597 reid_baseline.train INFO: Accuracy: 27.1% Mean Entropy: 269.8%
2022-04-25 22:20:26,934 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.171, Acc: 0.922, Base Lr: 2.77e-03
2022-04-25 22:20:38,023 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.199[s] Speed: 80.3[samples/s]
2022-04-25 22:21:17,290 reid_baseline.train INFO: normal accuracy 0.261397479954181 2.6361730098724365 
2022-04-25 22:21:18,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 22:21:18,113 reid_baseline.train INFO: Accuracy: 26.1% Mean Entropy: 263.6%
2022-04-25 22:21:36,439 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.125, Acc: 0.941, Base Lr: 2.48e-03
2022-04-25 22:21:47,901 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.196[s] Speed: 81.8[samples/s]
2022-04-25 22:22:27,257 reid_baseline.train INFO: normal accuracy 0.27445589919816726 2.641819715499878 
2022-04-25 22:22:27,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 22:22:27,260 reid_baseline.train INFO: Accuracy: 27.4% Mean Entropy: 264.2%
2022-04-25 22:22:45,805 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.115, Acc: 0.946, Base Lr: 2.20e-03
2022-04-25 22:22:56,810 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.193[s] Speed: 83.0[samples/s]
2022-04-25 22:23:36,045 reid_baseline.train INFO: normal accuracy 0.2717067583046964 2.6076509952545166 
2022-04-25 22:23:37,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 22:23:37,396 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 260.8%
2022-04-25 22:23:56,646 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.094, Acc: 0.952, Base Lr: 1.92e-03
2022-04-25 22:24:07,971 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.199[s] Speed: 80.3[samples/s]
2022-04-25 22:24:48,556 reid_baseline.train INFO: normal accuracy 0.26895761741122565 2.6209988594055176 
2022-04-25 22:24:48,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 22:24:48,558 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 262.1%
2022-04-25 22:25:07,320 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.076, Acc: 0.952, Base Lr: 1.66e-03
2022-04-25 22:25:18,484 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 22:25:58,525 reid_baseline.train INFO: normal accuracy 0.2723940435280641 2.5814857482910156 
2022-04-25 22:25:59,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 22:25:59,819 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 258.1%
2022-04-25 22:26:20,284 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.055, Acc: 0.967, Base Lr: 1.42e-03
2022-04-25 22:26:31,549 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.208[s] Speed: 76.9[samples/s]
2022-04-25 22:27:11,536 reid_baseline.train INFO: normal accuracy 0.26895761741122565 2.5450422763824463 
2022-04-25 22:27:12,431 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 22:27:12,431 reid_baseline.train INFO: Accuracy: 26.9% Mean Entropy: 254.5%
2022-04-25 22:27:31,117 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.043, Acc: 0.967, Base Lr: 1.19e-03
2022-04-25 22:27:42,144 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 22:28:21,272 reid_baseline.train INFO: normal accuracy 0.2733104238258877 2.606219530105591 
2022-04-25 22:28:21,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 22:28:21,273 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 260.6%
2022-04-25 22:28:41,120 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.035, Acc: 0.964, Base Lr: 9.72e-04
2022-04-25 22:28:52,128 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.203[s] Speed: 78.9[samples/s]
2022-04-25 22:29:33,444 reid_baseline.train INFO: normal accuracy 0.27262313860252 2.594921112060547 
2022-04-25 22:29:33,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 22:29:33,447 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 259.5%
2022-04-25 22:29:51,652 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.030, Acc: 0.967, Base Lr: 7.78e-04
2022-04-25 22:30:02,941 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.194[s] Speed: 82.5[samples/s]
2022-04-25 22:30:43,513 reid_baseline.train INFO: normal accuracy 0.27605956471935855 2.572634696960449 
2022-04-25 22:30:43,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 22:30:43,516 reid_baseline.train INFO: Accuracy: 27.6% Mean Entropy: 257.3%
2022-04-25 22:31:03,376 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.017, Acc: 0.975, Base Lr: 6.04e-04
2022-04-25 22:31:14,472 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-25 22:31:54,880 reid_baseline.train INFO: normal accuracy 0.27720504009163804 2.5614538192749023 
2022-04-25 22:31:54,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 22:31:54,882 reid_baseline.train INFO: Accuracy: 27.7% Mean Entropy: 256.1%
2022-04-25 22:32:14,351 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.015, Acc: 0.970, Base Lr: 4.51e-04
2022-04-25 22:32:25,830 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.202[s] Speed: 79.0[samples/s]
2022-04-25 22:33:06,208 reid_baseline.train INFO: normal accuracy 0.2721649484536082 2.543616771697998 
2022-04-25 22:33:07,103 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 22:33:07,103 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 254.4%
2022-04-25 22:33:26,165 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.010, Acc: 0.976, Base Lr: 3.20e-04
2022-04-25 22:33:37,244 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.198[s] Speed: 80.8[samples/s]
2022-04-25 22:34:16,569 reid_baseline.train INFO: normal accuracy 0.27147766323024053 2.5616466999053955 
2022-04-25 22:34:16,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 22:34:16,572 reid_baseline.train INFO: Accuracy: 27.1% Mean Entropy: 256.2%
2022-04-25 22:34:37,200 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.016, Acc: 0.972, Base Lr: 2.11e-04
2022-04-25 22:34:48,529 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.210[s] Speed: 76.2[samples/s]
2022-04-25 22:35:27,809 reid_baseline.train INFO: normal accuracy 0.27262313860252 2.562877655029297 
2022-04-25 22:35:27,810 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 22:35:27,810 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 256.3%
2022-04-25 22:35:47,481 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.014, Acc: 0.967, Base Lr: 1.26e-04
2022-04-25 22:35:58,510 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.201[s] Speed: 79.5[samples/s]
2022-04-25 22:36:37,014 reid_baseline.train INFO: normal accuracy 0.27262313860252 2.550328493118286 
2022-04-25 22:36:37,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 22:36:37,017 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 255.0%
2022-04-25 22:36:56,966 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.008, Acc: 0.974, Base Lr: 6.51e-05
2022-04-25 22:37:08,395 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.206[s] Speed: 77.6[samples/s]
2022-04-25 22:37:49,359 reid_baseline.train INFO: normal accuracy 0.27399770904925547 2.5597832202911377 
2022-04-25 22:37:49,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 22:37:49,361 reid_baseline.train INFO: Accuracy: 27.4% Mean Entropy: 256.0%
2022-04-25 22:38:09,859 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.017, Acc: 0.972, Base Lr: 2.83e-05
2022-04-25 22:38:20,791 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.205[s] Speed: 77.9[samples/s]
2022-04-25 22:38:58,873 reid_baseline.train INFO: normal accuracy 0.2719358533791523 2.5340635776519775 
2022-04-25 22:39:00,190 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 22:39:00,190 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 253.4%
2022-04-25 22:39:15,291 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.998, Acc: 0.973, Base Lr: 1.60e-05
2022-04-25 22:39:20,879 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.135[s] Speed: 118.4[samples/s]
2022-04-25 22:39:55,637 reid_baseline.train INFO: normal accuracy 0.2733104238258877 2.585634708404541 
2022-04-25 22:39:55,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 22:39:55,639 reid_baseline.train INFO: Accuracy: 27.3% Mean Entropy: 258.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_6/transformer_best_model.pth
2022-04-25 22:40:38,361 reid_baseline.train INFO: normal accuracy 0.2719358533791523 2.5340635776519775 
2022-04-25 22:40:38,362 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:40:38,362 reid_baseline.train INFO: Accuracy: 27.2%
2022-04-25 22:41:15,058 reid_baseline.train INFO: normal accuracy 0.2719358533791523 2.5340635776519775 
2022-04-25 22:41:15,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:41:15,059 reid_baseline.train INFO: Shuffled Accuracy: 27.2%
2022-04-25 22:41:43,354 reid_baseline.train INFO: normal accuracy 0.9777503090234858 1.1335716247558594 
2022-04-25 22:41:43,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 22:41:43,355 reid_baseline.train INFO: Source Clean Accuracy: 97.8%
2022-04-25 22:41:48,189 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_6
2022-04-25 22:41:48,189 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-25 22:41:48,189 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 22:41:48,190 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 22:41:48,190 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 22:42:01,019 reid_baseline.train INFO: start training
2022-04-25 22:42:19,517 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.102, Base Lr: 4.76e-04
2022-04-25 22:42:31,080 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.195[s] Speed: 82.0[samples/s]
2022-04-25 22:43:11,750 reid_baseline.train INFO: normal accuracy 0.10610497859878351 4.172581195831299 
2022-04-25 22:43:12,974 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 22:43:12,974 reid_baseline.train INFO: Accuracy: 10.6% Mean Entropy: 417.3%
2022-04-25 22:43:31,388 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.222, Base Lr: 8.72e-04
2022-04-25 22:43:42,441 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.193[s] Speed: 83.1[samples/s]
2022-04-25 22:44:22,705 reid_baseline.train INFO: normal accuracy 0.12683036719981977 4.165688991546631 
2022-04-25 22:44:23,890 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 22:44:23,890 reid_baseline.train INFO: Accuracy: 12.7% Mean Entropy: 416.6%
2022-04-25 22:44:41,898 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.835, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 22:44:52,913 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.190[s] Speed: 84.2[samples/s]
2022-04-25 22:45:33,952 reid_baseline.train INFO: normal accuracy 0.12007208830817752 4.13987398147583 
2022-04-25 22:45:34,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 22:45:34,754 reid_baseline.train INFO: Accuracy: 12.0% Mean Entropy: 414.0%
2022-04-25 22:45:52,801 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.592, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 22:46:03,031 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.186[s] Speed: 86.1[samples/s]
2022-04-25 22:46:44,128 reid_baseline.train INFO: normal accuracy 0.1252534354584366 4.081722259521484 
2022-04-25 22:46:45,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 22:46:45,352 reid_baseline.train INFO: Accuracy: 12.5% Mean Entropy: 408.2%
2022-04-25 22:47:04,001 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.406, Acc: 0.298, Base Lr: 2.06e-03
2022-04-25 22:47:13,245 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.183[s] Speed: 87.3[samples/s]
2022-04-25 22:47:55,694 reid_baseline.train INFO: normal accuracy 0.13899526920477584 4.014810085296631 
2022-04-25 22:47:56,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 22:47:56,478 reid_baseline.train INFO: Accuracy: 13.9% Mean Entropy: 401.5%
2022-04-25 22:48:15,251 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.171, Acc: 0.321, Base Lr: 2.46e-03
2022-04-25 22:48:24,641 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.184[s] Speed: 86.8[samples/s]
2022-04-25 22:49:05,891 reid_baseline.train INFO: normal accuracy 0.1509348952466772 3.9015190601348877 
2022-04-25 22:49:07,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 22:49:07,108 reid_baseline.train INFO: Accuracy: 15.1% Mean Entropy: 390.2%
2022-04-25 22:49:26,609 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.978, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 22:49:35,334 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.185[s] Speed: 86.3[samples/s]
2022-04-25 22:50:16,866 reid_baseline.train INFO: normal accuracy 0.1745888713674251 3.775724172592163 
2022-04-25 22:50:19,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 22:50:19,126 reid_baseline.train INFO: Accuracy: 17.5% Mean Entropy: 377.6%
2022-04-25 22:50:38,535 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.788, Acc: 0.412, Base Lr: 3.25e-03
2022-04-25 22:50:48,683 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.191[s] Speed: 84.0[samples/s]
2022-04-25 22:51:29,458 reid_baseline.train INFO: normal accuracy 0.2025230907862131 3.699493169784546 
2022-04-25 22:51:30,288 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 22:51:30,288 reid_baseline.train INFO: Accuracy: 20.3% Mean Entropy: 369.9%
2022-04-25 22:51:49,412 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.595, Acc: 0.458, Base Lr: 3.64e-03
2022-04-25 22:51:57,349 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.177[s] Speed: 90.2[samples/s]
2022-04-25 22:52:40,421 reid_baseline.train INFO: normal accuracy 0.24284748817301194 3.5595078468322754 
2022-04-25 22:52:41,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 22:52:41,255 reid_baseline.train INFO: Accuracy: 24.3% Mean Entropy: 356.0%
2022-04-25 22:53:00,687 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.426, Acc: 0.515, Base Lr: 4.04e-03
2022-04-25 22:53:09,942 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.188[s] Speed: 85.0[samples/s]
2022-04-25 22:53:51,523 reid_baseline.train INFO: normal accuracy 0.2764136066681685 3.3774991035461426 
2022-04-25 22:53:52,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 22:53:52,509 reid_baseline.train INFO: Accuracy: 27.6% Mean Entropy: 337.7%
2022-04-25 22:54:11,911 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.271, Acc: 0.562, Base Lr: 4.44e-03
2022-04-25 22:54:20,477 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.183[s] Speed: 87.6[samples/s]
2022-04-25 22:55:02,275 reid_baseline.train INFO: normal accuracy 0.3122324847938725 3.2364954948425293 
2022-04-25 22:55:04,067 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 22:55:04,068 reid_baseline.train INFO: Accuracy: 31.2% Mean Entropy: 323.6%
2022-04-25 22:55:23,279 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.099, Acc: 0.620, Base Lr: 4.83e-03
2022-04-25 22:55:32,185 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.185[s] Speed: 86.6[samples/s]
2022-04-25 22:56:13,930 reid_baseline.train INFO: normal accuracy 0.3284523541338139 3.103847026824951 
2022-04-25 22:56:15,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 22:56:15,316 reid_baseline.train INFO: Accuracy: 32.8% Mean Entropy: 310.4%
2022-04-25 22:56:34,342 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.946, Acc: 0.678, Base Lr: 5.23e-03
2022-04-25 22:56:43,288 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.184[s] Speed: 87.0[samples/s]
2022-04-25 22:57:24,966 reid_baseline.train INFO: normal accuracy 0.3487271908087407 3.0086348056793213 
2022-04-25 22:57:25,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 22:57:25,889 reid_baseline.train INFO: Accuracy: 34.9% Mean Entropy: 300.9%
2022-04-25 22:57:45,469 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.855, Acc: 0.681, Base Lr: 5.62e-03
2022-04-25 22:57:54,159 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.186[s] Speed: 86.2[samples/s]
2022-04-25 22:58:36,164 reid_baseline.train INFO: normal accuracy 0.3739580986708718 2.899545669555664 
2022-04-25 22:58:37,066 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 22:58:37,066 reid_baseline.train INFO: Accuracy: 37.4% Mean Entropy: 290.0%
2022-04-25 22:58:56,806 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.753, Acc: 0.732, Base Lr: 6.02e-03
2022-04-25 22:59:05,473 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.186[s] Speed: 85.9[samples/s]
2022-04-25 22:59:47,140 reid_baseline.train INFO: normal accuracy 0.3800405496733499 2.7190048694610596 
2022-04-25 22:59:49,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 22:59:49,163 reid_baseline.train INFO: Accuracy: 38.0% Mean Entropy: 271.9%
2022-04-25 23:00:08,118 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.642, Acc: 0.755, Base Lr: 6.42e-03
2022-04-25 23:00:16,886 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.182[s] Speed: 87.8[samples/s]
2022-04-25 23:00:58,712 reid_baseline.train INFO: normal accuracy 0.41473304798378013 2.671905994415283 
2022-04-25 23:01:00,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 23:01:00,387 reid_baseline.train INFO: Accuracy: 41.5% Mean Entropy: 267.2%
2022-04-25 23:01:19,396 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.540, Acc: 0.801, Base Lr: 6.81e-03
2022-04-25 23:01:29,170 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.189[s] Speed: 84.6[samples/s]
2022-04-25 23:02:09,941 reid_baseline.train INFO: normal accuracy 0.4007659382743861 2.6269681453704834 
2022-04-25 23:02:10,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-25 23:02:10,797 reid_baseline.train INFO: Accuracy: 40.1% Mean Entropy: 262.7%
2022-04-25 23:02:30,324 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.468, Acc: 0.816, Base Lr: 7.21e-03
2022-04-25 23:02:38,835 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.184[s] Speed: 86.8[samples/s]
2022-04-25 23:03:20,579 reid_baseline.train INFO: normal accuracy 0.42329353457986035 2.5415198802948 
2022-04-25 23:03:22,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-25 23:03:22,207 reid_baseline.train INFO: Accuracy: 42.3% Mean Entropy: 254.2%
2022-04-25 23:03:41,417 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.396, Acc: 0.844, Base Lr: 7.60e-03
2022-04-25 23:03:50,250 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.184[s] Speed: 86.9[samples/s]
2022-04-25 23:04:33,442 reid_baseline.train INFO: normal accuracy 0.41360666816850644 2.46651029586792 
2022-04-25 23:04:34,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-25 23:04:34,272 reid_baseline.train INFO: Accuracy: 41.4% Mean Entropy: 246.7%
2022-04-25 23:04:52,767 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.312, Acc: 0.871, Base Lr: 4.01e-03
2022-04-25 23:05:03,225 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.190[s] Speed: 84.3[samples/s]
2022-04-25 23:05:45,066 reid_baseline.train INFO: normal accuracy 0.41473304798378013 2.37174916267395 
2022-04-25 23:05:46,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-25 23:05:46,745 reid_baseline.train INFO: Accuracy: 41.5% Mean Entropy: 237.2%
2022-04-25 23:06:04,359 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.252, Acc: 0.900, Base Lr: 3.69e-03
2022-04-25 23:06:15,548 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.189[s] Speed: 84.7[samples/s]
2022-04-25 23:06:57,227 reid_baseline.train INFO: normal accuracy 0.44109033566118494 2.3440101146698 
2022-04-25 23:06:58,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-25 23:06:58,038 reid_baseline.train INFO: Accuracy: 44.1% Mean Entropy: 234.4%
2022-04-25 23:07:16,285 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.200, Acc: 0.916, Base Lr: 3.38e-03
2022-04-25 23:07:27,451 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.192[s] Speed: 83.3[samples/s]
2022-04-25 23:08:08,657 reid_baseline.train INFO: normal accuracy 0.44492002703311556 2.3374311923980713 
2022-04-25 23:08:09,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-25 23:08:09,527 reid_baseline.train INFO: Accuracy: 44.5% Mean Entropy: 233.7%
2022-04-25 23:08:26,937 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.195, Acc: 0.925, Base Lr: 3.08e-03
2022-04-25 23:08:38,099 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.187[s] Speed: 85.5[samples/s]
2022-04-25 23:09:20,454 reid_baseline.train INFO: normal accuracy 0.4419914395134039 2.3296611309051514 
2022-04-25 23:09:21,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-25 23:09:21,271 reid_baseline.train INFO: Accuracy: 44.2% Mean Entropy: 233.0%
2022-04-25 23:09:39,444 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.171, Acc: 0.922, Base Lr: 2.77e-03
2022-04-25 23:09:50,570 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.191[s] Speed: 83.6[samples/s]
2022-04-25 23:10:31,995 reid_baseline.train INFO: normal accuracy 0.453255237666141 2.2696118354797363 
2022-04-25 23:10:33,986 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-25 23:10:33,986 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 227.0%
2022-04-25 23:10:52,556 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.125, Acc: 0.941, Base Lr: 2.48e-03
2022-04-25 23:11:03,717 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-25 23:11:44,555 reid_baseline.train INFO: normal accuracy 0.45505744537057896 2.267683267593384 
2022-04-25 23:11:45,650 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-25 23:11:45,650 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 226.8%
2022-04-25 23:12:04,936 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.115, Acc: 0.946, Base Lr: 2.20e-03
2022-04-25 23:12:16,052 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.198[s] Speed: 80.8[samples/s]
2022-04-25 23:12:56,182 reid_baseline.train INFO: normal accuracy 0.4476233385897725 2.2579498291015625 
2022-04-25 23:12:56,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-25 23:12:56,970 reid_baseline.train INFO: Accuracy: 44.8% Mean Entropy: 225.8%
2022-04-25 23:13:15,386 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.094, Acc: 0.952, Base Lr: 1.92e-03
2022-04-25 23:13:26,633 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.194[s] Speed: 82.7[samples/s]
2022-04-25 23:14:07,335 reid_baseline.train INFO: normal accuracy 0.4525794097769768 2.2670445442199707 
2022-04-25 23:14:07,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-25 23:14:07,336 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 226.7%
2022-04-25 23:14:25,132 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.076, Acc: 0.952, Base Lr: 1.66e-03
2022-04-25 23:14:36,183 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.190[s] Speed: 84.4[samples/s]
2022-04-25 23:15:17,916 reid_baseline.train INFO: normal accuracy 0.4573102050011264 2.2444939613342285 
2022-04-25 23:15:18,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-25 23:15:18,718 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 224.4%
2022-04-25 23:15:37,848 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.055, Acc: 0.967, Base Lr: 1.42e-03
2022-04-25 23:15:48,957 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.196[s] Speed: 81.5[samples/s]
2022-04-25 23:16:30,311 reid_baseline.train INFO: normal accuracy 0.4537057895922505 2.2016892433166504 
2022-04-25 23:16:31,146 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-25 23:16:31,146 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 220.2%
2022-04-25 23:16:49,223 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.043, Acc: 0.967, Base Lr: 1.19e-03
2022-04-25 23:17:00,237 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-25 23:17:41,559 reid_baseline.train INFO: normal accuracy 0.4622662761883307 2.2677767276763916 
2022-04-25 23:17:41,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-25 23:17:41,561 reid_baseline.train INFO: Accuracy: 46.2% Mean Entropy: 226.8%
2022-04-25 23:18:00,851 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.035, Acc: 0.964, Base Lr: 9.72e-04
2022-04-25 23:18:11,844 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.199[s] Speed: 80.5[samples/s]
2022-04-25 23:18:52,964 reid_baseline.train INFO: normal accuracy 0.4584365848164001 2.2537496089935303 
2022-04-25 23:18:52,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-25 23:18:52,966 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 225.4%
2022-04-25 23:19:12,203 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.030, Acc: 0.967, Base Lr: 7.78e-04
2022-04-25 23:19:23,351 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.200[s] Speed: 80.2[samples/s]
2022-04-25 23:20:04,249 reid_baseline.train INFO: normal accuracy 0.4645190358188781 2.2465789318084717 
2022-04-25 23:20:04,252 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-25 23:20:04,252 reid_baseline.train INFO: Accuracy: 46.5% Mean Entropy: 224.7%
2022-04-25 23:20:22,649 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.017, Acc: 0.975, Base Lr: 6.04e-04
2022-04-25 23:20:33,727 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.194[s] Speed: 82.7[samples/s]
2022-04-25 23:21:14,839 reid_baseline.train INFO: normal accuracy 0.4595629646316738 2.222703218460083 
2022-04-25 23:21:14,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-25 23:21:14,840 reid_baseline.train INFO: Accuracy: 46.0% Mean Entropy: 222.3%
2022-04-25 23:21:33,015 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.015, Acc: 0.970, Base Lr: 4.51e-04
2022-04-25 23:21:44,269 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 23:22:25,485 reid_baseline.train INFO: normal accuracy 0.4546068934444695 2.219552516937256 
2022-04-25 23:22:25,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-25 23:22:25,488 reid_baseline.train INFO: Accuracy: 45.5% Mean Entropy: 222.0%
2022-04-25 23:22:44,518 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.010, Acc: 0.976, Base Lr: 3.20e-04
2022-04-25 23:22:55,578 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.197[s] Speed: 81.1[samples/s]
2022-04-25 23:23:36,167 reid_baseline.train INFO: normal accuracy 0.4591124127055643 2.244199752807617 
2022-04-25 23:23:36,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-25 23:23:36,170 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 224.4%
2022-04-25 23:23:54,329 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.016, Acc: 0.972, Base Lr: 2.11e-04
2022-04-25 23:24:05,579 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.193[s] Speed: 82.7[samples/s]
2022-04-25 23:24:47,343 reid_baseline.train INFO: normal accuracy 0.4586618607794548 2.2463936805725098 
2022-04-25 23:24:47,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-25 23:24:47,343 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 224.6%
2022-04-25 23:25:05,860 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.014, Acc: 0.967, Base Lr: 1.26e-04
2022-04-25 23:25:16,886 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-25 23:25:57,297 reid_baseline.train INFO: normal accuracy 0.4579860328902906 2.228633165359497 
2022-04-25 23:25:57,299 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-25 23:25:57,300 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 222.9%
2022-04-25 23:26:15,532 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.008, Acc: 0.974, Base Lr: 6.51e-05
2022-04-25 23:26:26,710 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-25 23:27:08,592 reid_baseline.train INFO: normal accuracy 0.46091462041000225 2.226269483566284 
2022-04-25 23:27:08,595 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-25 23:27:08,595 reid_baseline.train INFO: Accuracy: 46.1% Mean Entropy: 222.6%
2022-04-25 23:27:29,737 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.017, Acc: 0.972, Base Lr: 2.83e-05
2022-04-25 23:27:40,173 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.206[s] Speed: 77.5[samples/s]
2022-04-25 23:28:19,932 reid_baseline.train INFO: normal accuracy 0.4573102050011264 2.2093923091888428 
2022-04-25 23:28:19,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-25 23:28:19,934 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 220.9%
2022-04-25 23:28:37,924 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.998, Acc: 0.973, Base Lr: 1.60e-05
2022-04-25 23:28:43,332 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.151[s] Speed: 105.8[samples/s]
2022-04-25 23:29:16,936 reid_baseline.train INFO: normal accuracy 0.4568596530750169 2.2582991123199463 
2022-04-25 23:29:16,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-25 23:29:16,938 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 225.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_6/transformer_best_model.pth
2022-04-25 23:29:49,632 reid_baseline.train INFO: normal accuracy 0.4537057895922505 2.2016892433166504 
2022-04-25 23:29:49,632 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:29:49,632 reid_baseline.train INFO: Accuracy: 45.4%
2022-04-25 23:30:25,985 reid_baseline.train INFO: normal accuracy 0.4537057895922505 2.2016892433166504 
2022-04-25 23:30:25,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:30:25,985 reid_baseline.train INFO: Shuffled Accuracy: 45.4%
2022-04-25 23:30:49,512 reid_baseline.train INFO: normal accuracy 0.9740420271940667 1.1654367446899414 
2022-04-25 23:30:49,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-25 23:30:49,512 reid_baseline.train INFO: Source Clean Accuracy: 97.4%
2022-04-25 23:30:54,583 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_6
2022-04-25 23:30:54,583 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-25 23:30:54,583 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-25 23:30:54,583 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-25 23:30:54,584 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-25 23:31:07,546 reid_baseline.train INFO: start training
2022-04-25 23:31:27,411 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.152, Acc: 0.102, Base Lr: 4.76e-04
2022-04-25 23:31:36,008 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.187[s] Speed: 85.8[samples/s]
2022-04-25 23:32:26,628 reid_baseline.train INFO: normal accuracy 0.1744319485884783 4.172189235687256 
2022-04-25 23:32:27,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-25 23:32:27,512 reid_baseline.train INFO: Accuracy: 17.4% Mean Entropy: 417.2%
2022-04-25 23:32:50,110 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.222, Base Lr: 8.72e-04
2022-04-25 23:32:58,954 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.206[s] Speed: 77.5[samples/s]
2022-04-25 23:33:49,559 reid_baseline.train INFO: normal accuracy 0.1941703006655956 4.162424564361572 
2022-04-25 23:33:50,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-25 23:33:50,797 reid_baseline.train INFO: Accuracy: 19.4% Mean Entropy: 416.2%
2022-04-25 23:34:10,546 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.835, Acc: 0.236, Base Lr: 1.27e-03
2022-04-25 23:34:18,705 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.182[s] Speed: 87.8[samples/s]
2022-04-25 23:35:11,347 reid_baseline.train INFO: normal accuracy 0.20105577232040395 4.120759963989258 
2022-04-25 23:35:12,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-25 23:35:12,171 reid_baseline.train INFO: Accuracy: 20.1% Mean Entropy: 412.1%
2022-04-25 23:35:31,858 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.592, Acc: 0.279, Base Lr: 1.66e-03
2022-04-25 23:35:40,130 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.183[s] Speed: 87.5[samples/s]
2022-04-25 23:36:34,001 reid_baseline.train INFO: normal accuracy 0.2125315584117512 4.024967670440674 
2022-04-25 23:36:34,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-25 23:36:34,814 reid_baseline.train INFO: Accuracy: 21.3% Mean Entropy: 402.5%
2022-04-25 23:36:53,379 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.406, Acc: 0.298, Base Lr: 2.06e-03
2022-04-25 23:37:03,265 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.184[s] Speed: 86.8[samples/s]
2022-04-25 23:37:57,995 reid_baseline.train INFO: normal accuracy 0.234335551985311 3.9253041744232178 
2022-04-25 23:37:58,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-25 23:37:58,940 reid_baseline.train INFO: Accuracy: 23.4% Mean Entropy: 392.5%
2022-04-25 23:38:18,353 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.171, Acc: 0.321, Base Lr: 2.46e-03
2022-04-25 23:38:28,159 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.190[s] Speed: 84.0[samples/s]
2022-04-25 23:39:25,852 reid_baseline.train INFO: normal accuracy 0.25269680973146663 3.7457008361816406 
2022-04-25 23:39:26,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-25 23:39:26,635 reid_baseline.train INFO: Accuracy: 25.3% Mean Entropy: 374.6%
2022-04-25 23:39:44,795 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.978, Acc: 0.366, Base Lr: 2.85e-03
2022-04-25 23:39:54,607 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.183[s] Speed: 87.3[samples/s]
2022-04-25 23:40:49,459 reid_baseline.train INFO: normal accuracy 0.2832224007344503 3.572551965713501 
2022-04-25 23:40:50,579 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-25 23:40:50,579 reid_baseline.train INFO: Accuracy: 28.3% Mean Entropy: 357.3%
2022-04-25 23:41:09,354 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.788, Acc: 0.412, Base Lr: 3.25e-03
2022-04-25 23:41:19,211 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.188[s] Speed: 85.1[samples/s]
2022-04-25 23:42:17,059 reid_baseline.train INFO: normal accuracy 0.326371356437916 3.456686496734619 
2022-04-25 23:42:18,034 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-25 23:42:18,034 reid_baseline.train INFO: Accuracy: 32.6% Mean Entropy: 345.7%
2022-04-25 23:42:37,430 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.595, Acc: 0.458, Base Lr: 3.64e-03
2022-04-25 23:42:47,270 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.191[s] Speed: 84.0[samples/s]
2022-04-25 23:43:41,691 reid_baseline.train INFO: normal accuracy 0.3541427587789764 3.26446795463562 
2022-04-25 23:43:42,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-25 23:43:42,470 reid_baseline.train INFO: Accuracy: 35.4% Mean Entropy: 326.4%
2022-04-25 23:44:00,795 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.426, Acc: 0.515, Base Lr: 4.04e-03
2022-04-25 23:44:10,590 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.185[s] Speed: 86.6[samples/s]
2022-04-25 23:45:14,029 reid_baseline.train INFO: normal accuracy 0.3899472113839798 3.0727343559265137 
2022-04-25 23:45:14,937 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-25 23:45:14,937 reid_baseline.train INFO: Accuracy: 39.0% Mean Entropy: 307.3%
2022-04-25 23:45:43,779 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.271, Acc: 0.562, Base Lr: 4.44e-03
2022-04-25 23:45:59,056 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.290[s] Speed: 55.2[samples/s]
2022-04-25 23:47:20,885 reid_baseline.train INFO: normal accuracy 0.4229974753270599 2.9175593852996826 
2022-04-25 23:47:22,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-25 23:47:22,526 reid_baseline.train INFO: Accuracy: 42.3% Mean Entropy: 291.8%
2022-04-25 23:47:53,973 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.099, Acc: 0.620, Base Lr: 4.83e-03
2022-04-25 23:48:11,482 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-25 23:49:34,300 reid_baseline.train INFO: normal accuracy 0.45008033050263946 2.747066020965576 
2022-04-25 23:49:35,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-25 23:49:35,444 reid_baseline.train INFO: Accuracy: 45.0% Mean Entropy: 274.7%
2022-04-25 23:50:07,174 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.946, Acc: 0.678, Base Lr: 5.23e-03
2022-04-25 23:50:23,592 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.316[s] Speed: 50.7[samples/s]
2022-04-25 23:51:44,455 reid_baseline.train INFO: normal accuracy 0.46476933669956394 2.6397783756256104 
2022-04-25 23:51:45,591 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-25 23:51:45,591 reid_baseline.train INFO: Accuracy: 46.5% Mean Entropy: 264.0%
2022-04-25 23:52:15,097 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.855, Acc: 0.681, Base Lr: 5.62e-03
2022-04-25 23:52:32,106 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.306[s] Speed: 52.3[samples/s]
2022-04-25 23:53:53,461 reid_baseline.train INFO: normal accuracy 0.49139316043148956 2.5291595458984375 
2022-04-25 23:53:54,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-25 23:53:54,683 reid_baseline.train INFO: Accuracy: 49.1% Mean Entropy: 252.9%
2022-04-25 23:54:26,364 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.753, Acc: 0.732, Base Lr: 6.02e-03
2022-04-25 23:54:40,857 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.304[s] Speed: 52.7[samples/s]
2022-04-25 23:55:58,253 reid_baseline.train INFO: normal accuracy 0.49437686481523985 2.3869588375091553 
2022-04-25 23:55:59,463 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-25 23:55:59,463 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 238.7%
2022-04-25 23:56:32,673 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.642, Acc: 0.755, Base Lr: 6.42e-03
2022-04-25 23:56:48,504 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-25 23:58:06,502 reid_baseline.train INFO: normal accuracy 0.5239843929309158 2.335333824157715 
2022-04-25 23:58:07,825 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-25 23:58:07,825 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 233.5%
2022-04-25 23:58:38,871 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.540, Acc: 0.801, Base Lr: 6.81e-03
2022-04-25 23:58:55,416 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.313[s] Speed: 51.2[samples/s]
2022-04-26 00:00:20,393 reid_baseline.train INFO: normal accuracy 0.5288042230892817 2.285698652267456 
2022-04-26 00:00:21,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 00:00:21,296 reid_baseline.train INFO: Accuracy: 52.9% Mean Entropy: 228.6%
2022-04-26 00:00:52,963 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.468, Acc: 0.816, Base Lr: 7.21e-03
2022-04-26 00:01:09,108 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.314[s] Speed: 50.9[samples/s]
2022-04-26 00:02:27,417 reid_baseline.train INFO: normal accuracy 0.5407390406242828 2.2399485111236572 
2022-04-26 00:02:28,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 00:02:28,637 reid_baseline.train INFO: Accuracy: 54.1% Mean Entropy: 224.0%
2022-04-26 00:02:58,865 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.396, Acc: 0.844, Base Lr: 7.60e-03
2022-04-26 00:03:14,784 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.303[s] Speed: 52.7[samples/s]
2022-04-26 00:04:38,017 reid_baseline.train INFO: normal accuracy 0.5320174431948589 2.1817305088043213 
2022-04-26 00:04:39,234 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 00:04:39,235 reid_baseline.train INFO: Accuracy: 53.2% Mean Entropy: 218.2%
2022-04-26 00:05:09,503 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.312, Acc: 0.871, Base Lr: 4.01e-03
2022-04-26 00:05:25,544 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.305[s] Speed: 52.5[samples/s]
2022-04-26 00:06:49,215 reid_baseline.train INFO: normal accuracy 0.5485425751663989 2.102823257446289 
2022-04-26 00:06:50,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 00:06:50,465 reid_baseline.train INFO: Accuracy: 54.9% Mean Entropy: 210.3%
2022-04-26 00:07:24,172 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.252, Acc: 0.900, Base Lr: 3.69e-03
2022-04-26 00:07:39,767 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-26 00:09:04,360 reid_baseline.train INFO: normal accuracy 0.5581822354831306 2.0830330848693848 
2022-04-26 00:09:05,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 00:09:05,657 reid_baseline.train INFO: Accuracy: 55.8% Mean Entropy: 208.3%
2022-04-26 00:09:39,777 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.200, Acc: 0.916, Base Lr: 3.38e-03
2022-04-26 00:09:55,859 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-26 00:11:17,113 reid_baseline.train INFO: normal accuracy 0.5616249713105348 2.072511672973633 
2022-04-26 00:11:18,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 00:11:18,464 reid_baseline.train INFO: Accuracy: 56.2% Mean Entropy: 207.3%
2022-04-26 00:11:53,505 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.195, Acc: 0.925, Base Lr: 3.08e-03
2022-04-26 00:12:08,945 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-26 00:13:34,732 reid_baseline.train INFO: normal accuracy 0.5643791599724581 2.079801559448242 
2022-04-26 00:13:34,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 00:13:34,735 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 208.0%
2022-04-26 00:14:10,443 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.171, Acc: 0.922, Base Lr: 2.77e-03
2022-04-26 00:14:24,124 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-26 00:14:52,358 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_8
2022-04-26 00:14:52,358 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 00:14:52,358 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:14:52,358 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:14:52,359 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:15:09,960 reid_baseline.train INFO: start training
2022-04-26 00:15:40,295 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.097, Base Lr: 4.76e-04
2022-04-26 00:15:58,180 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.312[s] Speed: 51.3[samples/s]
2022-04-26 00:16:53,448 reid_baseline.train INFO: normal accuracy 0.0854524627720504 4.172618865966797 
2022-04-26 00:16:54,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:16:54,508 reid_baseline.train INFO: Accuracy: 8.5% Mean Entropy: 417.3%
2022-04-26 00:17:15,448 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.224, Base Lr: 8.72e-04
2022-04-26 00:17:29,251 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.228[s] Speed: 70.2[samples/s]
2022-04-26 00:18:34,825 reid_baseline.train INFO: normal accuracy 0.10103092783505155 4.166526794433594 
2022-04-26 00:18:36,684 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 00:18:36,685 reid_baseline.train INFO: Accuracy: 10.1% Mean Entropy: 416.7%
2022-04-26 00:19:09,897 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.838, Acc: 0.236, Base Lr: 1.27e-03
2022-04-26 00:19:27,870 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-26 00:20:20,283 reid_baseline.train INFO: normal accuracy 0.10240549828178694 4.1449875831604 
2022-04-26 00:20:21,103 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:20:21,103 reid_baseline.train INFO: Accuracy: 10.2% Mean Entropy: 414.5%
2022-04-26 00:20:50,298 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.594, Acc: 0.275, Base Lr: 1.66e-03
2022-04-26 00:21:07,682 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.306[s] Speed: 52.2[samples/s]
2022-04-26 00:21:54,226 reid_baseline.train INFO: normal accuracy 0.10034364261168385 4.104344844818115 
2022-04-26 00:21:55,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:21:55,452 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 410.4%
2022-04-26 00:22:29,513 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.291, Base Lr: 2.06e-03
2022-04-26 00:22:41,770 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.304[s] Speed: 52.6[samples/s]
2022-04-26 00:22:59,420 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_8
2022-04-26 00:22:59,420 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 00:22:59,420 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 00:22:59,420 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 00:22:59,421 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 00:23:16,594 reid_baseline.train INFO: start training
2022-04-26 00:23:49,237 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.097, Base Lr: 4.76e-04
2022-04-26 00:24:05,025 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-26 00:24:59,766 reid_baseline.train INFO: normal accuracy 0.10700608245100247 4.172610282897949 
2022-04-26 00:25:00,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 00:25:00,561 reid_baseline.train INFO: Accuracy: 10.7% Mean Entropy: 417.3%
2022-04-26 00:25:18,062 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.224, Base Lr: 8.72e-04
2022-04-26 00:25:26,617 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.171[s] Speed: 93.4[samples/s]
2022-04-26 00:26:07,243 reid_baseline.train INFO: normal accuracy 0.1248028835323271 4.165829658508301 
2022-04-26 00:26:08,418 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 00:26:08,419 reid_baseline.train INFO: Accuracy: 12.5% Mean Entropy: 416.6%
2022-04-26 00:26:30,138 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.838, Acc: 0.236, Base Lr: 1.27e-03
2022-04-26 00:26:38,985 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.201[s] Speed: 79.7[samples/s]
2022-04-26 00:27:19,069 reid_baseline.train INFO: normal accuracy 0.12187429601261546 4.140270233154297 
2022-04-26 00:27:19,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 00:27:19,882 reid_baseline.train INFO: Accuracy: 12.2% Mean Entropy: 414.0%
2022-04-26 00:27:36,835 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.594, Acc: 0.275, Base Lr: 1.66e-03
2022-04-26 00:27:45,416 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.168[s] Speed: 95.3[samples/s]
2022-04-26 00:28:27,128 reid_baseline.train INFO: normal accuracy 0.12300067582788916 4.084277629852295 
2022-04-26 00:28:28,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 00:28:28,461 reid_baseline.train INFO: Accuracy: 12.3% Mean Entropy: 408.4%
2022-04-26 00:28:49,700 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.291, Base Lr: 2.06e-03
2022-04-26 00:28:59,768 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.206[s] Speed: 77.8[samples/s]
2022-04-26 00:29:37,534 reid_baseline.train INFO: normal accuracy 0.13786888938950215 4.012795448303223 
2022-04-26 00:29:38,885 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 00:29:38,886 reid_baseline.train INFO: Accuracy: 13.8% Mean Entropy: 401.3%
2022-04-26 00:29:59,035 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.178, Acc: 0.317, Base Lr: 2.46e-03
2022-04-26 00:30:09,146 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.198[s] Speed: 80.9[samples/s]
2022-04-26 00:30:50,627 reid_baseline.train INFO: normal accuracy 0.156341518359991 3.8983194828033447 
2022-04-26 00:30:51,767 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 00:30:51,768 reid_baseline.train INFO: Accuracy: 15.6% Mean Entropy: 389.8%
2022-04-26 00:31:14,257 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.981, Acc: 0.362, Base Lr: 2.85e-03
2022-04-26 00:31:23,863 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.211[s] Speed: 75.8[samples/s]
2022-04-26 00:32:01,942 reid_baseline.train INFO: normal accuracy 0.17503942329353459 3.7907299995422363 
2022-04-26 00:32:03,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 00:32:03,410 reid_baseline.train INFO: Accuracy: 17.5% Mean Entropy: 379.1%
2022-04-26 00:32:25,371 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.788, Acc: 0.421, Base Lr: 3.25e-03
2022-04-26 00:32:35,262 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.209[s] Speed: 76.4[samples/s]
2022-04-26 00:33:14,678 reid_baseline.train INFO: normal accuracy 0.2115341293084028 3.6589324474334717 
2022-04-26 00:33:15,666 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 00:33:15,666 reid_baseline.train INFO: Accuracy: 21.2% Mean Entropy: 365.9%
2022-04-26 00:33:38,215 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.602, Acc: 0.471, Base Lr: 3.64e-03
2022-04-26 00:33:47,360 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-26 00:34:27,739 reid_baseline.train INFO: normal accuracy 0.2469024555079973 3.513415813446045 
2022-04-26 00:34:28,688 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 00:34:28,689 reid_baseline.train INFO: Accuracy: 24.7% Mean Entropy: 351.3%
2022-04-26 00:34:49,918 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.430, Acc: 0.514, Base Lr: 4.04e-03
2022-04-26 00:34:59,873 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.205[s] Speed: 78.1[samples/s]
2022-04-26 00:35:40,768 reid_baseline.train INFO: normal accuracy 0.2716828114440189 3.399529457092285 
2022-04-26 00:35:41,843 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 00:35:41,844 reid_baseline.train INFO: Accuracy: 27.2% Mean Entropy: 340.0%
2022-04-26 00:36:02,723 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.276, Acc: 0.553, Base Lr: 4.44e-03
2022-04-26 00:36:12,987 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.204[s] Speed: 78.3[samples/s]
2022-04-26 00:36:50,611 reid_baseline.train INFO: normal accuracy 0.30975444920027034 3.2271974086761475 
2022-04-26 00:36:51,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 00:36:51,443 reid_baseline.train INFO: Accuracy: 31.0% Mean Entropy: 322.7%
2022-04-26 00:37:12,865 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.102, Acc: 0.614, Base Lr: 4.83e-03
2022-04-26 00:37:23,358 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.210[s] Speed: 76.3[samples/s]
2022-04-26 00:38:05,307 reid_baseline.train INFO: normal accuracy 0.33723811669294884 3.0747241973876953 
2022-04-26 00:38:06,359 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 00:38:06,360 reid_baseline.train INFO: Accuracy: 33.7% Mean Entropy: 307.5%
2022-04-26 00:38:24,694 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.966, Acc: 0.670, Base Lr: 5.23e-03
2022-04-26 00:38:36,309 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-26 00:39:18,479 reid_baseline.train INFO: normal accuracy 0.35323271006983553 2.9881417751312256 
2022-04-26 00:39:19,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 00:39:19,465 reid_baseline.train INFO: Accuracy: 35.3% Mean Entropy: 298.8%
2022-04-26 00:39:40,048 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.867, Acc: 0.692, Base Lr: 5.62e-03
2022-04-26 00:39:51,343 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.209[s] Speed: 76.7[samples/s]
2022-04-26 00:40:29,053 reid_baseline.train INFO: normal accuracy 0.374633926560036 2.948763847351074 
2022-04-26 00:40:30,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 00:40:30,276 reid_baseline.train INFO: Accuracy: 37.5% Mean Entropy: 294.9%
2022-04-26 00:40:51,705 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.766, Acc: 0.714, Base Lr: 6.02e-03
2022-04-26 00:41:01,927 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.208[s] Speed: 76.9[samples/s]
2022-04-26 00:41:39,469 reid_baseline.train INFO: normal accuracy 0.396485694976346 2.7802019119262695 
2022-04-26 00:41:40,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 00:41:40,430 reid_baseline.train INFO: Accuracy: 39.6% Mean Entropy: 278.0%
2022-04-26 00:42:01,136 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.652, Acc: 0.757, Base Lr: 6.42e-03
2022-04-26 00:42:11,107 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.202[s] Speed: 79.3[samples/s]
2022-04-26 00:42:50,887 reid_baseline.train INFO: normal accuracy 0.40301869790493355 2.669562816619873 
2022-04-26 00:42:52,116 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 00:42:52,116 reid_baseline.train INFO: Accuracy: 40.3% Mean Entropy: 267.0%
2022-04-26 00:43:12,068 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.564, Acc: 0.799, Base Lr: 6.81e-03
2022-04-26 00:43:24,203 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.210[s] Speed: 76.2[samples/s]
2022-04-26 00:44:08,685 reid_baseline.train INFO: normal accuracy 0.4160847037621086 2.569673776626587 
2022-04-26 00:44:09,892 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 00:44:09,892 reid_baseline.train INFO: Accuracy: 41.6% Mean Entropy: 257.0%
2022-04-26 00:44:28,416 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.483, Acc: 0.814, Base Lr: 7.21e-03
2022-04-26 00:44:40,063 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.198[s] Speed: 80.8[samples/s]
2022-04-26 00:45:20,020 reid_baseline.train INFO: normal accuracy 0.42487046632124353 2.5199413299560547 
2022-04-26 00:45:21,259 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 00:45:21,260 reid_baseline.train INFO: Accuracy: 42.5% Mean Entropy: 252.0%
2022-04-26 00:45:41,311 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.420, Acc: 0.835, Base Lr: 7.60e-03
2022-04-26 00:45:48,546 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.179[s] Speed: 89.2[samples/s]
2022-04-26 00:46:30,395 reid_baseline.train INFO: normal accuracy 0.42937598558233836 2.434130907058716 
2022-04-26 00:46:31,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 00:46:31,635 reid_baseline.train INFO: Accuracy: 42.9% Mean Entropy: 243.4%
2022-04-26 00:46:51,003 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.322, Acc: 0.872, Base Lr: 4.01e-03
2022-04-26 00:47:01,871 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.199[s] Speed: 80.5[samples/s]
2022-04-26 00:47:41,384 reid_baseline.train INFO: normal accuracy 0.4334309529173237 2.3850460052490234 
2022-04-26 00:47:42,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 00:47:42,587 reid_baseline.train INFO: Accuracy: 43.3% Mean Entropy: 238.5%
2022-04-26 00:48:01,814 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.264, Acc: 0.897, Base Lr: 3.69e-03
2022-04-26 00:48:12,132 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.194[s] Speed: 82.4[samples/s]
2022-04-26 00:48:49,936 reid_baseline.train INFO: normal accuracy 0.44559585492227977 2.345327377319336 
2022-04-26 00:48:51,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 00:48:51,158 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 234.5%
2022-04-26 00:49:13,141 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.207, Acc: 0.913, Base Lr: 3.38e-03
2022-04-26 00:49:23,618 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.213[s] Speed: 75.0[samples/s]
2022-04-26 00:50:06,004 reid_baseline.train INFO: normal accuracy 0.4377111962153638 2.3407034873962402 
2022-04-26 00:50:07,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 00:50:07,254 reid_baseline.train INFO: Accuracy: 43.8% Mean Entropy: 234.1%
2022-04-26 00:50:25,350 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.190, Acc: 0.923, Base Lr: 3.08e-03
2022-04-26 00:50:37,725 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.200[s] Speed: 80.1[samples/s]
2022-04-26 00:51:18,296 reid_baseline.train INFO: normal accuracy 0.45235413381392203 2.3588671684265137 
2022-04-26 00:51:18,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 00:51:18,296 reid_baseline.train INFO: Accuracy: 45.2% Mean Entropy: 235.9%
2022-04-26 00:51:39,855 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.180, Acc: 0.917, Base Lr: 2.77e-03
2022-04-26 00:51:50,624 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.212[s] Speed: 75.4[samples/s]
2022-04-26 00:52:30,975 reid_baseline.train INFO: normal accuracy 0.44965082225726516 2.3126559257507324 
2022-04-26 00:52:32,402 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 00:52:32,403 reid_baseline.train INFO: Accuracy: 45.0% Mean Entropy: 231.3%
2022-04-26 00:52:55,023 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.140, Acc: 0.932, Base Lr: 2.48e-03
2022-04-26 00:53:01,987 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.193[s] Speed: 82.8[samples/s]
2022-04-26 00:53:46,401 reid_baseline.train INFO: normal accuracy 0.45122775399864834 2.288888692855835 
2022-04-26 00:53:47,669 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 00:53:47,670 reid_baseline.train INFO: Accuracy: 45.1% Mean Entropy: 228.9%
2022-04-26 00:54:07,544 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.122, Acc: 0.941, Base Lr: 2.20e-03
2022-04-26 00:54:20,037 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.213[s] Speed: 75.2[samples/s]
2022-04-26 00:54:54,598 reid_baseline.train INFO: normal accuracy 0.4467222347375535 2.2880804538726807 
2022-04-26 00:54:55,770 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 00:54:55,770 reid_baseline.train INFO: Accuracy: 44.7% Mean Entropy: 228.8%
2022-04-26 00:55:15,735 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.095, Acc: 0.952, Base Lr: 1.92e-03
2022-04-26 00:55:23,657 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.183[s] Speed: 87.6[samples/s]
2022-04-26 00:56:02,356 reid_baseline.train INFO: normal accuracy 0.4473980626267177 2.2548716068267822 
2022-04-26 00:56:03,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 00:56:03,553 reid_baseline.train INFO: Accuracy: 44.7% Mean Entropy: 225.5%
2022-04-26 00:56:26,095 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.077, Acc: 0.957, Base Lr: 1.66e-03
2022-04-26 00:56:35,532 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.210[s] Speed: 76.1[samples/s]
2022-04-26 00:57:17,617 reid_baseline.train INFO: normal accuracy 0.44559585492227977 2.2625744342803955 
2022-04-26 00:57:17,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 00:57:17,620 reid_baseline.train INFO: Accuracy: 44.6% Mean Entropy: 226.3%
2022-04-26 00:57:36,993 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.059, Acc: 0.961, Base Lr: 1.42e-03
2022-04-26 00:57:46,017 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.186[s] Speed: 86.0[samples/s]
2022-04-26 00:58:24,548 reid_baseline.train INFO: normal accuracy 0.46159044829916646 2.190460681915283 
2022-04-26 00:58:25,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 00:58:25,763 reid_baseline.train INFO: Accuracy: 46.2% Mean Entropy: 219.0%
2022-04-26 00:58:46,382 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.057, Acc: 0.955, Base Lr: 1.19e-03
2022-04-26 00:58:56,328 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.201[s] Speed: 79.6[samples/s]
2022-04-26 00:59:32,106 reid_baseline.train INFO: normal accuracy 0.4568596530750169 2.2759933471679688 
2022-04-26 00:59:32,106 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 00:59:32,106 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 227.6%
2022-04-26 00:59:52,082 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.037, Acc: 0.966, Base Lr: 9.72e-04
2022-04-26 01:00:03,737 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.208[s] Speed: 77.0[samples/s]
2022-04-26 01:00:47,283 reid_baseline.train INFO: normal accuracy 0.46046406848389276 2.2624049186706543 
2022-04-26 01:00:47,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 01:00:47,286 reid_baseline.train INFO: Accuracy: 46.0% Mean Entropy: 226.2%
2022-04-26 01:01:11,488 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.025, Acc: 0.969, Base Lr: 7.78e-04
2022-04-26 01:01:20,477 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.218[s] Speed: 73.4[samples/s]
2022-04-26 01:01:59,717 reid_baseline.train INFO: normal accuracy 0.45978824059472856 2.2426059246063232 
2022-04-26 01:01:59,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 01:01:59,720 reid_baseline.train INFO: Accuracy: 46.0% Mean Entropy: 224.3%
2022-04-26 01:02:19,863 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.022, Acc: 0.970, Base Lr: 6.04e-04
2022-04-26 01:02:32,334 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.212[s] Speed: 75.4[samples/s]
2022-04-26 01:03:13,102 reid_baseline.train INFO: normal accuracy 0.46159044829916646 2.231247901916504 
2022-04-26 01:03:13,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 01:03:13,102 reid_baseline.train INFO: Accuracy: 46.2% Mean Entropy: 223.1%
2022-04-26 01:03:35,469 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.018, Acc: 0.966, Base Lr: 4.51e-04
2022-04-26 01:03:43,041 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-26 01:04:17,661 reid_baseline.train INFO: normal accuracy 0.4591124127055643 2.2267422676086426 
2022-04-26 01:04:17,661 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 01:04:17,661 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 222.7%
2022-04-26 01:04:39,395 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.009, Acc: 0.978, Base Lr: 3.20e-04
2022-04-26 01:04:51,896 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.225[s] Speed: 71.1[samples/s]
2022-04-26 01:05:37,366 reid_baseline.train INFO: normal accuracy 0.4633926560036044 2.246490001678467 
2022-04-26 01:05:37,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 01:05:37,368 reid_baseline.train INFO: Accuracy: 46.3% Mean Entropy: 224.6%
2022-04-26 01:05:56,273 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.016, Acc: 0.964, Base Lr: 2.11e-04
2022-04-26 01:06:04,831 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.181[s] Speed: 88.6[samples/s]
2022-04-26 01:06:48,823 reid_baseline.train INFO: normal accuracy 0.45978824059472856 2.25516414642334 
2022-04-26 01:06:48,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 01:06:48,823 reid_baseline.train INFO: Accuracy: 46.0% Mean Entropy: 225.5%
2022-04-26 01:07:09,038 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.014, Acc: 0.967, Base Lr: 1.26e-04
2022-04-26 01:07:19,625 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.202[s] Speed: 79.2[samples/s]
2022-04-26 01:08:00,814 reid_baseline.train INFO: normal accuracy 0.45933768866861907 2.235711097717285 
2022-04-26 01:08:00,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 01:08:00,818 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 223.6%
2022-04-26 01:08:20,910 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.018, Acc: 0.971, Base Lr: 6.51e-05
2022-04-26 01:08:32,334 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-26 01:09:13,701 reid_baseline.train INFO: normal accuracy 0.4591124127055643 2.231318712234497 
2022-04-26 01:09:13,703 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 01:09:13,703 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 223.1%
2022-04-26 01:09:34,047 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.015, Acc: 0.974, Base Lr: 2.83e-05
2022-04-26 01:09:40,926 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.178[s] Speed: 89.7[samples/s]
2022-04-26 01:10:18,643 reid_baseline.train INFO: normal accuracy 0.4582113088533453 2.210516929626465 
2022-04-26 01:10:18,645 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 01:10:18,646 reid_baseline.train INFO: Accuracy: 45.8% Mean Entropy: 221.1%
2022-04-26 01:10:38,042 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 1.000, Acc: 0.975, Base Lr: 1.60e-05
2022-04-26 01:10:49,574 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.203[s] Speed: 78.7[samples/s]
2022-04-26 01:11:30,682 reid_baseline.train INFO: normal accuracy 0.4586618607794548 2.2657089233398438 
2022-04-26 01:11:30,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 01:11:30,685 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 226.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_all_key_8/transformer_best_model.pth
2022-04-26 01:12:12,907 reid_baseline.train INFO: normal accuracy 0.46159044829916646 2.190460681915283 
2022-04-26 01:12:12,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:12:12,908 reid_baseline.train INFO: Accuracy: 46.2%
2022-04-26 01:12:55,747 reid_baseline.train INFO: normal accuracy 0.46159044829916646 2.190460681915283 
2022-04-26 01:12:55,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:12:55,748 reid_baseline.train INFO: Shuffled Accuracy: 46.2%
2022-04-26 01:13:18,713 reid_baseline.train INFO: normal accuracy 0.9715698393077874 1.1856426000595093 
2022-04-26 01:13:18,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 01:13:18,713 reid_baseline.train INFO: Source Clean Accuracy: 97.2%
2022-04-26 01:13:24,471 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_8
2022-04-26 01:13:24,471 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-26 01:13:24,471 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-26 01:13:24,471 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-26 01:13:24,472 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-26 01:13:36,378 reid_baseline.train INFO: start training
2022-04-26 01:13:57,309 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.153, Acc: 0.097, Base Lr: 4.76e-04
2022-04-26 01:14:08,247 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.209[s] Speed: 76.6[samples/s]
2022-04-26 01:15:17,792 reid_baseline.train INFO: normal accuracy 0.17351388570117052 4.172215938568115 
2022-04-26 01:15:18,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-26 01:15:18,921 reid_baseline.train INFO: Accuracy: 17.4% Mean Entropy: 417.2%
2022-04-26 01:15:39,519 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 4.029, Acc: 0.224, Base Lr: 8.72e-04
2022-04-26 01:15:48,798 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.197[s] Speed: 81.4[samples/s]
2022-04-26 01:16:55,566 reid_baseline.train INFO: normal accuracy 0.19853109938030755 4.162667274475098 
2022-04-26 01:16:56,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-26 01:16:56,772 reid_baseline.train INFO: Accuracy: 19.9% Mean Entropy: 416.3%
2022-04-26 01:17:18,965 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.838, Acc: 0.236, Base Lr: 1.27e-03
2022-04-26 01:17:30,573 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.222[s] Speed: 72.2[samples/s]
2022-04-26 01:18:36,245 reid_baseline.train INFO: normal accuracy 0.2028918980950195 4.121922969818115 
2022-04-26 01:18:37,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-26 01:18:37,454 reid_baseline.train INFO: Accuracy: 20.3% Mean Entropy: 412.2%
2022-04-26 01:18:59,936 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.594, Acc: 0.275, Base Lr: 1.66e-03
2022-04-26 01:19:09,574 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.210[s] Speed: 76.0[samples/s]
2022-04-26 01:20:12,439 reid_baseline.train INFO: normal accuracy 0.20931833830617397 4.029165267944336 
2022-04-26 01:20:13,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-26 01:20:13,748 reid_baseline.train INFO: Accuracy: 20.9% Mean Entropy: 402.9%
2022-04-26 01:20:36,370 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 3.399, Acc: 0.291, Base Lr: 2.06e-03
2022-04-26 01:20:45,324 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.206[s] Speed: 77.7[samples/s]
2022-04-26 01:21:53,352 reid_baseline.train INFO: normal accuracy 0.23410603626348406 3.922011137008667 
2022-04-26 01:21:54,566 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-26 01:21:54,567 reid_baseline.train INFO: Accuracy: 23.4% Mean Entropy: 392.2%
2022-04-26 01:22:12,635 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 3.178, Acc: 0.317, Base Lr: 2.46e-03
2022-04-26 01:22:19,747 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.165[s] Speed: 97.0[samples/s]
2022-04-26 01:23:22,175 reid_baseline.train INFO: normal accuracy 0.25384438834060136 3.7437777519226074 
2022-04-26 01:23:23,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-26 01:23:23,412 reid_baseline.train INFO: Accuracy: 25.4% Mean Entropy: 374.4%
2022-04-26 01:23:46,433 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 2.981, Acc: 0.362, Base Lr: 2.85e-03
2022-04-26 01:23:56,191 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-26 01:25:00,981 reid_baseline.train INFO: normal accuracy 0.28092724351618087 3.585050344467163 
2022-04-26 01:25:02,247 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-26 01:25:02,248 reid_baseline.train INFO: Accuracy: 28.1% Mean Entropy: 358.5%
2022-04-26 01:25:23,455 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 2.788, Acc: 0.421, Base Lr: 3.25e-03
2022-04-26 01:25:32,882 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.201[s] Speed: 79.5[samples/s]
2022-04-26 01:26:42,424 reid_baseline.train INFO: normal accuracy 0.3266008721597429 3.4298806190490723 
2022-04-26 01:26:43,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-26 01:26:43,648 reid_baseline.train INFO: Accuracy: 32.7% Mean Entropy: 343.0%
2022-04-26 01:27:02,465 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 2.602, Acc: 0.471, Base Lr: 3.64e-03
2022-04-26 01:27:12,791 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.191[s] Speed: 83.7[samples/s]
2022-04-26 01:28:21,826 reid_baseline.train INFO: normal accuracy 0.355749368831765 3.2448716163635254 
2022-04-26 01:28:22,831 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-26 01:28:22,831 reid_baseline.train INFO: Accuracy: 35.6% Mean Entropy: 324.5%
2022-04-26 01:28:43,533 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 2.430, Acc: 0.514, Base Lr: 4.04e-03
2022-04-26 01:28:53,871 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.204[s] Speed: 78.4[samples/s]
2022-04-26 01:30:00,230 reid_baseline.train INFO: normal accuracy 0.39109478999311453 3.093080520629883 
2022-04-26 01:30:01,480 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-26 01:30:01,480 reid_baseline.train INFO: Accuracy: 39.1% Mean Entropy: 309.3%
2022-04-26 01:30:22,860 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 2.276, Acc: 0.553, Base Lr: 4.44e-03
2022-04-26 01:30:31,449 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.197[s] Speed: 81.3[samples/s]
2022-04-26 01:31:39,199 reid_baseline.train INFO: normal accuracy 0.4259811797108102 2.902447462081909 
2022-04-26 01:31:40,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-26 01:31:40,392 reid_baseline.train INFO: Accuracy: 42.6% Mean Entropy: 290.2%
2022-04-26 01:32:02,837 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 2.102, Acc: 0.614, Base Lr: 4.83e-03
2022-04-26 01:32:12,414 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.210[s] Speed: 76.1[samples/s]
2022-04-26 01:33:17,160 reid_baseline.train INFO: normal accuracy 0.4516869405554281 2.7444779872894287 
2022-04-26 01:33:18,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-26 01:33:18,364 reid_baseline.train INFO: Accuracy: 45.2% Mean Entropy: 274.4%
2022-04-26 01:33:39,770 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.966, Acc: 0.670, Base Lr: 5.23e-03
2022-04-26 01:33:48,251 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.195[s] Speed: 81.9[samples/s]
2022-04-26 01:34:53,550 reid_baseline.train INFO: normal accuracy 0.47050722974523757 2.634967803955078 
2022-04-26 01:34:54,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-26 01:34:54,764 reid_baseline.train INFO: Accuracy: 47.1% Mean Entropy: 263.5%
2022-04-26 01:35:12,881 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.867, Acc: 0.692, Base Lr: 5.62e-03
2022-04-26 01:35:24,235 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.194[s] Speed: 82.6[samples/s]
2022-04-26 01:36:32,225 reid_baseline.train INFO: normal accuracy 0.49437686481523985 2.570322275161743 
2022-04-26 01:36:33,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-26 01:36:33,464 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 257.0%
2022-04-26 01:36:54,954 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.766, Acc: 0.714, Base Lr: 6.02e-03
2022-04-26 01:37:05,582 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.211[s] Speed: 75.8[samples/s]
2022-04-26 01:38:15,200 reid_baseline.train INFO: normal accuracy 0.506311682350241 2.4300577640533447 
2022-04-26 01:38:16,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-26 01:38:16,481 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 243.0%
2022-04-26 01:38:38,849 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.652, Acc: 0.757, Base Lr: 6.42e-03
2022-04-26 01:38:48,496 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.210[s] Speed: 76.3[samples/s]
2022-04-26 01:39:51,912 reid_baseline.train INFO: normal accuracy 0.5249024558182236 2.3532309532165527 
2022-04-26 01:39:53,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-26 01:39:53,021 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 235.3%
2022-04-26 01:40:12,361 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.564, Acc: 0.799, Base Lr: 6.81e-03
2022-04-26 01:40:22,744 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.195[s] Speed: 82.2[samples/s]
2022-04-26 01:41:33,233 reid_baseline.train INFO: normal accuracy 0.5340830846913014 2.2514827251434326 
2022-04-26 01:41:34,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-26 01:41:34,096 reid_baseline.train INFO: Accuracy: 53.4% Mean Entropy: 225.1%
2022-04-26 01:41:53,264 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.483, Acc: 0.814, Base Lr: 7.21e-03
2022-04-26 01:42:04,842 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.201[s] Speed: 79.4[samples/s]
2022-04-26 01:43:15,171 reid_baseline.train INFO: normal accuracy 0.5430341978425522 2.2444911003112793 
2022-04-26 01:43:16,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-26 01:43:16,411 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 224.4%
2022-04-26 01:43:37,549 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.420, Acc: 0.835, Base Lr: 7.60e-03
2022-04-26 01:43:49,108 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.214[s] Speed: 74.7[samples/s]
2022-04-26 01:44:53,072 reid_baseline.train INFO: normal accuracy 0.5487720908882259 2.189239263534546 
2022-04-26 01:44:54,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-26 01:44:54,056 reid_baseline.train INFO: Accuracy: 54.9% Mean Entropy: 218.9%
2022-04-26 01:45:15,873 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 1.322, Acc: 0.872, Base Lr: 4.01e-03
2022-04-26 01:45:24,882 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-26 01:46:39,669 reid_baseline.train INFO: normal accuracy 0.5577232040394767 2.103342294692993 
2022-04-26 01:46:41,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-26 01:46:41,818 reid_baseline.train INFO: Accuracy: 55.8% Mean Entropy: 210.3%
2022-04-26 01:47:01,768 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 1.264, Acc: 0.897, Base Lr: 3.69e-03
2022-04-26 01:47:12,597 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.202[s] Speed: 79.1[samples/s]
2022-04-26 01:48:22,920 reid_baseline.train INFO: normal accuracy 0.5630020656414965 2.085968017578125 
2022-04-26 01:48:24,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-26 01:48:24,157 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 208.6%
2022-04-26 01:48:47,191 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 1.207, Acc: 0.913, Base Lr: 3.38e-03
2022-04-26 01:48:55,004 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.202[s] Speed: 79.4[samples/s]
2022-04-26 01:49:59,486 reid_baseline.train INFO: normal accuracy 0.5634610970851504 2.0794222354888916 
2022-04-26 01:50:00,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-26 01:50:00,919 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 207.9%
2022-04-26 01:50:18,181 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 1.190, Acc: 0.923, Base Lr: 3.08e-03
2022-04-26 01:50:28,968 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.183[s] Speed: 87.6[samples/s]
2022-04-26 01:51:31,299 reid_baseline.train INFO: normal accuracy 0.564838191416112 2.0943281650543213 
2022-04-26 01:51:31,301 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-26 01:51:31,301 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 209.4%
2022-04-26 01:51:51,478 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 1.180, Acc: 0.917, Base Lr: 2.77e-03
2022-04-26 01:52:02,660 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-26 01:53:08,588 reid_baseline.train INFO: normal accuracy 0.5703465687399587 2.042902708053589 
2022-04-26 01:53:09,799 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-26 01:53:09,799 reid_baseline.train INFO: Accuracy: 57.0% Mean Entropy: 204.3%
2022-04-26 01:53:29,891 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 1.140, Acc: 0.932, Base Lr: 2.48e-03
2022-04-26 01:53:40,877 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.204[s] Speed: 78.4[samples/s]
2022-04-26 01:54:45,995 reid_baseline.train INFO: normal accuracy 0.5652972228597659 2.0230886936187744 
2022-04-26 01:54:47,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-26 01:54:47,095 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 202.3%
2022-04-26 01:55:08,443 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 1.122, Acc: 0.941, Base Lr: 2.20e-03
2022-04-26 01:55:15,785 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.188[s] Speed: 85.2[samples/s]
2022-04-26 01:56:21,270 reid_baseline.train INFO: normal accuracy 0.5652972228597659 2.039536714553833 
2022-04-26 01:56:21,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-26 01:56:21,273 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 204.0%
2022-04-26 01:56:41,217 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 1.095, Acc: 0.952, Base Lr: 1.92e-03
2022-04-26 01:56:53,078 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.209[s] Speed: 76.6[samples/s]
2022-04-26 01:57:52,778 reid_baseline.train INFO: normal accuracy 0.5698875372963048 2.0157909393310547 
2022-04-26 01:57:54,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-26 01:57:54,018 reid_baseline.train INFO: Accuracy: 57.0% Mean Entropy: 201.6%
2022-04-26 01:58:16,483 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 1.077, Acc: 0.957, Base Lr: 1.66e-03
2022-04-26 01:58:26,183 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.211[s] Speed: 75.8[samples/s]
2022-04-26 01:59:25,070 reid_baseline.train INFO: normal accuracy 0.5708056001836126 2.0287137031555176 
2022-04-26 01:59:25,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-26 01:59:25,071 reid_baseline.train INFO: Accuracy: 57.1% Mean Entropy: 202.9%
2022-04-26 01:59:47,414 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 1.059, Acc: 0.961, Base Lr: 1.42e-03
2022-04-26 01:59:56,601 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.207[s] Speed: 77.3[samples/s]
2022-04-26 02:01:00,881 reid_baseline.train INFO: normal accuracy 0.577232040394767 1.9870610237121582 
2022-04-26 02:01:01,827 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-26 02:01:01,828 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 198.7%
2022-04-26 02:01:21,892 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 1.057, Acc: 0.955, Base Lr: 1.19e-03
2022-04-26 02:01:30,572 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.189[s] Speed: 84.7[samples/s]
2022-04-26 02:02:34,348 reid_baseline.train INFO: normal accuracy 0.573100757401882 2.047398805618286 
2022-04-26 02:02:34,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-26 02:02:34,353 reid_baseline.train INFO: Accuracy: 57.3% Mean Entropy: 204.7%
2022-04-26 02:02:56,941 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 1.037, Acc: 0.966, Base Lr: 9.72e-04
2022-04-26 02:03:07,894 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.220[s] Speed: 72.6[samples/s]
2022-04-26 02:04:11,421 reid_baseline.train INFO: normal accuracy 0.5756254303419784 2.033203125 
2022-04-26 02:04:11,424 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-26 02:04:11,424 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 203.3%
2022-04-26 02:04:32,926 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 1.025, Acc: 0.969, Base Lr: 7.78e-04
2022-04-26 02:04:42,360 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.199[s] Speed: 80.4[samples/s]
2022-04-26 02:05:45,979 reid_baseline.train INFO: normal accuracy 0.5749368831764976 2.0074801445007324 
2022-04-26 02:05:45,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-26 02:05:45,979 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 200.7%
2022-04-26 02:06:06,122 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 1.022, Acc: 0.970, Base Lr: 6.04e-04
2022-04-26 02:06:18,481 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.213[s] Speed: 75.2[samples/s]
2022-04-26 02:07:24,738 reid_baseline.train INFO: normal accuracy 0.5751663988983245 2.0067334175109863 
2022-04-26 02:07:24,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-26 02:07:24,743 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 200.7%
2022-04-26 02:07:42,836 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 1.018, Acc: 0.966, Base Lr: 4.51e-04
2022-04-26 02:07:51,576 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.175[s] Speed: 91.4[samples/s]
2022-04-26 02:08:57,683 reid_baseline.train INFO: normal accuracy 0.5767730089511132 2.002345085144043 
2022-04-26 02:08:57,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-26 02:08:57,686 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 200.2%
2022-04-26 02:09:18,587 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 1.009, Acc: 0.978, Base Lr: 3.20e-04
2022-04-26 02:09:29,462 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.208[s] Speed: 77.0[samples/s]
2022-04-26 02:10:31,826 reid_baseline.train INFO: normal accuracy 0.5790681661693826 2.0225727558135986 
2022-04-26 02:10:31,827 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-26 02:10:31,827 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 202.3%
2022-04-26 02:10:55,932 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 1.016, Acc: 0.964, Base Lr: 2.11e-04
2022-04-26 02:11:04,587 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.215[s] Speed: 74.4[samples/s]
2022-04-26 02:12:09,192 reid_baseline.train INFO: normal accuracy 0.5747073674546707 2.0362987518310547 
2022-04-26 02:12:09,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-26 02:12:09,193 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 203.6%
2022-04-26 02:12:31,438 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 1.014, Acc: 0.967, Base Lr: 1.26e-04
2022-04-26 02:12:39,533 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.198[s] Speed: 80.6[samples/s]
2022-04-26 02:13:42,318 reid_baseline.train INFO: normal accuracy 0.5747073674546707 2.0222785472869873 
2022-04-26 02:13:42,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-26 02:13:42,323 reid_baseline.train INFO: Accuracy: 57.5% Mean Entropy: 202.2%
2022-04-26 02:14:00,015 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 1.018, Acc: 0.971, Base Lr: 6.51e-05
2022-04-26 02:14:10,927 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.188[s] Speed: 85.3[samples/s]
2022-04-26 02:15:15,445 reid_baseline.train INFO: normal accuracy 0.577232040394767 2.0200700759887695 
2022-04-26 02:15:15,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-26 02:15:15,447 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 202.0%
2022-04-26 02:15:37,417 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 1.015, Acc: 0.974, Base Lr: 2.83e-05
2022-04-26 02:15:46,102 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.201[s] Speed: 79.6[samples/s]
2022-04-26 02:16:52,587 reid_baseline.train INFO: normal accuracy 0.5783796190039018 1.997209072113037 
2022-04-26 02:16:52,589 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-26 02:16:52,590 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 199.7%
2022-04-26 02:17:14,839 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 1.000, Acc: 0.975, Base Lr: 1.60e-05
2022-04-26 02:17:24,625 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-26 02:18:25,419 reid_baseline.train INFO: normal accuracy 0.5781501032820748 2.047956705093384 
2022-04-26 02:18:25,423 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-26 02:18:25,424 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 204.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_all_key_8/transformer_best_model.pth
2022-04-26 02:19:33,635 reid_baseline.train INFO: normal accuracy 0.577232040394767 1.9870610237121582 
2022-04-26 02:19:33,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:19:33,636 reid_baseline.train INFO: Accuracy: 57.7%
2022-04-26 02:20:29,279 reid_baseline.train INFO: normal accuracy 0.577232040394767 1.9870610237121582 
2022-04-26 02:20:29,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:20:29,279 reid_baseline.train INFO: Shuffled Accuracy: 57.7%
2022-04-26 02:20:57,403 reid_baseline.train INFO: normal accuracy 0.9715698393077874 1.1856426000595093 
2022-04-26 02:20:57,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-26 02:20:57,403 reid_baseline.train INFO: Source Clean Accuracy: 97.2%
