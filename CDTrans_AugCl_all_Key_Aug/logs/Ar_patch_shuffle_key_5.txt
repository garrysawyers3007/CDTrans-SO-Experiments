2022-04-15 13:35:01,077 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_4
2022-04-15 13:35:01,078 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-15 13:35:01,078 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 13:35:01,078 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 13:35:01,078 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 13:35:15,245 reid_baseline.train INFO: start training
2022-04-15 13:35:47,916 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.302, Base Lr: 4.76e-04
2022-04-15 13:36:06,111 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 13:37:07,978 reid_baseline.train INFO: normal accuracy 0.5287226852894796 4.172758102416992 
2022-04-15 13:37:08,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 13:37:08,830 reid_baseline.train INFO: Accuracy: 52.9% Mean Entropy: 417.3%
2022-04-15 13:37:42,094 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.893, Acc: 0.701, Base Lr: 8.72e-04
2022-04-15 13:38:00,012 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 13:39:01,801 reid_baseline.train INFO: normal accuracy 0.5832394683487272 4.166267395019531 
2022-04-15 13:39:02,720 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 13:39:02,720 reid_baseline.train INFO: Accuracy: 58.3% Mean Entropy: 416.6%
2022-04-15 13:39:35,834 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.471, Acc: 0.741, Base Lr: 1.27e-03
2022-04-15 13:39:53,710 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.335[s] Speed: 47.7[samples/s]
2022-04-15 13:40:54,986 reid_baseline.train INFO: normal accuracy 0.5942779905384096 4.127432823181152 
2022-04-15 13:40:55,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 13:40:55,841 reid_baseline.train INFO: Accuracy: 59.4% Mean Entropy: 412.7%
2022-04-15 13:41:29,484 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.922, Acc: 0.743, Base Lr: 1.66e-03
2022-04-15 13:41:47,473 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-15 13:42:48,839 reid_baseline.train INFO: normal accuracy 0.602613201171435 3.9649057388305664 
2022-04-15 13:42:49,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 13:42:49,653 reid_baseline.train INFO: Accuracy: 60.3% Mean Entropy: 396.5%
2022-04-15 13:43:22,873 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.302, Acc: 0.754, Base Lr: 2.06e-03
2022-04-15 13:43:40,089 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.331[s] Speed: 48.3[samples/s]
2022-04-15 13:44:41,501 reid_baseline.train INFO: normal accuracy 0.6237891416985808 3.5630545616149902 
2022-04-15 13:44:42,372 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 13:44:42,372 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 356.3%
2022-04-15 13:45:16,346 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.789, Base Lr: 2.46e-03
2022-04-15 13:45:34,202 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-15 13:46:35,510 reid_baseline.train INFO: normal accuracy 0.6787564766839378 3.1019492149353027 
2022-04-15 13:46:36,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 13:46:36,432 reid_baseline.train INFO: Accuracy: 67.9% Mean Entropy: 310.2%
2022-04-15 13:47:10,422 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.522, Acc: 0.839, Base Lr: 2.85e-03
2022-04-15 13:47:28,328 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 13:48:28,966 reid_baseline.train INFO: normal accuracy 0.7353007434106781 2.6344919204711914 
2022-04-15 13:48:29,864 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 13:48:29,864 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 263.4%
2022-04-15 13:49:03,189 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.299, Acc: 0.895, Base Lr: 3.25e-03
2022-04-15 13:49:21,170 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.337[s] Speed: 47.4[samples/s]
2022-04-15 13:50:22,291 reid_baseline.train INFO: normal accuracy 0.7636855147555756 2.2533388137817383 
2022-04-15 13:50:23,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 13:50:23,172 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 225.3%
2022-04-15 13:50:56,999 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.184, Acc: 0.909, Base Lr: 3.64e-03
2022-04-15 13:51:14,893 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-15 13:52:15,276 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.9615706205368042 
2022-04-15 13:52:16,183 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 13:52:16,184 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 196.2%
2022-04-15 13:52:49,935 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.080, Acc: 0.927, Base Lr: 4.04e-03
2022-04-15 13:53:07,886 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-15 13:54:09,659 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.9085651636123657 
2022-04-15 13:54:10,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 13:54:10,547 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 190.9%
2022-04-15 13:54:44,380 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.023, Acc: 0.942, Base Lr: 4.44e-03
2022-04-15 13:55:02,296 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-15 13:56:02,501 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.6946386098861694 
2022-04-15 13:56:03,396 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 13:56:03,396 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 169.5%
2022-04-15 13:56:37,450 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.952, Base Lr: 4.83e-03
2022-04-15 13:56:55,355 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 13:57:56,158 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.6523261070251465 
2022-04-15 13:57:57,062 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 13:57:57,062 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 165.2%
2022-04-15 13:58:31,008 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.935, Acc: 0.965, Base Lr: 5.23e-03
2022-04-15 13:58:48,849 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-15 13:59:48,930 reid_baseline.train INFO: normal accuracy 0.7886911466546519 1.6644694805145264 
2022-04-15 13:59:48,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 13:59:48,935 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 166.4%
2022-04-15 14:00:22,911 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.900, Acc: 0.977, Base Lr: 5.62e-03
2022-04-15 14:00:40,765 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 14:01:41,603 reid_baseline.train INFO: normal accuracy 0.7963505293985131 1.6587961912155151 
2022-04-15 14:01:41,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 14:01:41,607 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 165.9%
2022-04-15 14:02:15,552 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.880, Acc: 0.981, Base Lr: 6.02e-03
2022-04-15 14:02:33,501 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 14:03:34,099 reid_baseline.train INFO: normal accuracy 0.7913944582113088 1.591461181640625 
2022-04-15 14:03:34,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 14:03:34,945 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 159.1%
2022-04-15 14:04:08,628 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.854, Acc: 0.988, Base Lr: 6.42e-03
2022-04-15 14:04:26,541 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 14:05:27,297 reid_baseline.train INFO: normal accuracy 0.7918450101374184 1.5734021663665771 
2022-04-15 14:05:28,088 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 14:05:28,088 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 157.3%
2022-04-15 14:06:02,452 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.841, Acc: 0.991, Base Lr: 6.81e-03
2022-04-15 14:06:20,307 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 14:07:21,134 reid_baseline.train INFO: normal accuracy 0.7922955620635278 1.701921820640564 
2022-04-15 14:07:21,139 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 14:07:21,139 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 170.2%
2022-04-15 14:07:54,502 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.839, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 14:08:12,321 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 14:09:14,584 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.5420836210250854 
2022-04-15 14:09:15,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 14:09:15,395 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 154.2%
2022-04-15 14:09:49,635 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.829, Acc: 0.989, Base Lr: 7.60e-03
2022-04-15 14:10:07,532 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 14:11:07,803 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.5718047618865967 
2022-04-15 14:11:07,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 14:11:07,805 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 157.2%
2022-04-15 14:11:34,296 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.808, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 14:11:51,334 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.286[s] Speed: 55.9[samples/s]
2022-04-15 14:12:52,573 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.6349374055862427 
2022-04-15 14:12:52,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 14:12:52,578 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 163.5%
2022-04-15 14:13:26,498 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.69e-03
2022-04-15 14:13:43,484 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-15 14:14:43,514 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.740877389907837 
2022-04-15 14:14:43,519 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 14:14:43,519 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 174.1%
2022-04-15 14:15:17,712 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.801, Acc: 0.995, Base Lr: 3.38e-03
2022-04-15 14:15:31,860 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-15 14:16:06,437 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.6732466220855713 
2022-04-15 14:16:06,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 14:16:06,440 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 167.3%
2022-04-15 14:16:29,504 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.992, Base Lr: 3.08e-03
2022-04-15 14:16:39,457 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.217[s] Speed: 73.8[samples/s]
2022-04-15 14:17:15,921 reid_baseline.train INFO: normal accuracy 0.7895922505068709 1.662034511566162 
2022-04-15 14:17:15,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 14:17:15,921 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 166.2%
2022-04-15 14:17:37,856 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.796, Acc: 0.996, Base Lr: 2.77e-03
2022-04-15 14:17:49,289 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.218[s] Speed: 73.4[samples/s]
2022-04-15 14:18:26,618 reid_baseline.train INFO: normal accuracy 0.7913944582113088 1.7065894603729248 
2022-04-15 14:18:26,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 14:18:26,620 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 170.7%
2022-04-15 14:18:44,357 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.48e-03
2022-04-15 14:18:56,267 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.195[s] Speed: 82.1[samples/s]
2022-04-15 14:19:33,546 reid_baseline.train INFO: normal accuracy 0.7963505293985131 1.7296509742736816 
2022-04-15 14:19:33,548 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 14:19:33,548 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 173.0%
2022-04-15 14:19:55,401 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 14:20:02,499 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.190[s] Speed: 84.1[samples/s]
2022-04-15 14:20:43,411 reid_baseline.train INFO: normal accuracy 0.7940977697679658 1.7214288711547852 
2022-04-15 14:20:43,411 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 14:20:43,411 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 172.1%
2022-04-15 14:21:05,180 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.996, Base Lr: 1.92e-03
2022-04-15 14:21:15,955 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.214[s] Speed: 74.8[samples/s]
2022-04-15 14:21:55,028 reid_baseline.train INFO: normal accuracy 0.793872493804911 1.7044011354446411 
2022-04-15 14:21:55,031 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 14:21:55,031 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 170.4%
2022-04-15 14:22:15,699 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.791, Acc: 0.996, Base Lr: 1.66e-03
2022-04-15 14:22:26,550 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.207[s] Speed: 77.2[samples/s]
2022-04-15 14:23:01,974 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.7422239780426025 
2022-04-15 14:23:01,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 14:23:01,977 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 174.2%
2022-04-15 14:23:22,937 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.42e-03
2022-04-15 14:23:33,786 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.208[s] Speed: 76.9[samples/s]
2022-04-15 14:24:07,531 reid_baseline.train INFO: normal accuracy 0.7936472178418563 1.742790937423706 
2022-04-15 14:24:07,533 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 14:24:07,533 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 174.3%
2022-04-15 14:24:29,869 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.19e-03
2022-04-15 14:24:40,294 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.215[s] Speed: 74.3[samples/s]
2022-04-15 14:25:18,348 reid_baseline.train INFO: normal accuracy 0.792971389952692 1.6873165369033813 
2022-04-15 14:25:18,349 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 14:25:18,349 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 168.7%
2022-04-15 14:25:39,704 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 14:25:51,591 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.218[s] Speed: 73.2[samples/s]
2022-04-15 14:26:27,134 reid_baseline.train INFO: normal accuracy 0.7934219418788016 1.7132630348205566 
2022-04-15 14:26:27,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 14:26:27,136 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 171.3%
2022-04-15 14:26:45,161 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.783, Acc: 0.997, Base Lr: 7.78e-04
2022-04-15 14:26:56,436 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.193[s] Speed: 83.1[samples/s]
2022-04-15 14:27:36,166 reid_baseline.train INFO: normal accuracy 0.7945483216940752 1.8023033142089844 
2022-04-15 14:27:36,167 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 14:27:36,167 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 180.2%
2022-04-15 14:27:58,188 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 6.04e-04
2022-04-15 14:28:05,023 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.189[s] Speed: 84.6[samples/s]
2022-04-15 14:28:50,846 reid_baseline.train INFO: normal accuracy 0.7940977697679658 1.7153329849243164 
2022-04-15 14:28:50,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 14:28:50,848 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 171.5%
2022-04-15 14:29:24,900 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.788, Acc: 0.995, Base Lr: 4.51e-04
2022-04-15 14:29:41,478 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.331[s] Speed: 48.3[samples/s]
2022-04-15 14:30:45,010 reid_baseline.train INFO: normal accuracy 0.79477359765713 1.7901331186294556 
2022-04-15 14:30:45,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 14:30:45,015 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 179.0%
2022-04-15 14:31:17,986 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 3.20e-04
2022-04-15 14:31:35,029 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 14:32:35,761 reid_baseline.train INFO: normal accuracy 0.7945483216940752 1.757402777671814 
2022-04-15 14:32:35,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 14:32:35,766 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 175.7%
2022-04-15 14:33:08,762 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 14:33:25,791 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 14:34:26,888 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.7326610088348389 
2022-04-15 14:34:26,892 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 14:34:26,893 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 173.3%
2022-04-15 14:34:59,977 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.782, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 14:35:17,008 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 14:36:17,673 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7123212814331055 
2022-04-15 14:36:17,678 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 14:36:17,678 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.2%
2022-04-15 14:36:50,715 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.784, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 14:37:07,641 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 14:38:08,315 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.7982312440872192 
2022-04-15 14:38:08,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 14:38:08,320 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 179.8%
2022-04-15 14:38:42,464 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 2.83e-05
2022-04-15 14:38:59,438 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 14:39:59,761 reid_baseline.train INFO: normal accuracy 0.7940977697679658 1.7833205461502075 
2022-04-15 14:39:59,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 14:39:59,766 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 178.3%
2022-04-15 14:40:32,784 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.790, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 14:40:49,707 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-15 14:41:51,629 reid_baseline.train INFO: normal accuracy 0.79477359765713 1.7254129648208618 
2022-04-15 14:41:51,634 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 14:41:51,635 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 172.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_4/transformer_best_model.pth
2022-04-15 14:42:53,940 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.5420836210250854 
2022-04-15 14:42:53,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:42:53,941 reid_baseline.train INFO: Accuracy: 79.2%
2022-04-15 14:43:52,879 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.5420836210250854 
2022-04-15 14:43:52,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:43:52,880 reid_baseline.train INFO: Shuffled Accuracy: 79.2%
2022-04-15 14:44:28,119 reid_baseline.train INFO: normal accuracy 0.9954676555418212 0.5764470100402832 
2022-04-15 14:44:28,120 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:44:28,120 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 14:44:32,465 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_4
2022-04-15 14:44:32,465 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-15 14:44:32,466 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 14:44:32,466 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 14:44:32,466 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 14:44:46,609 reid_baseline.train INFO: start training
2022-04-15 14:45:19,685 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.302, Base Lr: 4.76e-04
2022-04-15 14:45:37,871 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.334[s] Speed: 47.8[samples/s]
2022-04-15 14:46:40,785 reid_baseline.train INFO: normal accuracy 0.6020197383520771 4.1726555824279785 
2022-04-15 14:46:41,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 14:46:41,643 reid_baseline.train INFO: Accuracy: 60.2% Mean Entropy: 417.3%
2022-04-15 14:47:14,340 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.893, Acc: 0.701, Base Lr: 8.72e-04
2022-04-15 14:47:32,308 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 14:48:34,989 reid_baseline.train INFO: normal accuracy 0.6536607757631397 4.164004802703857 
2022-04-15 14:48:35,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 14:48:35,867 reid_baseline.train INFO: Accuracy: 65.4% Mean Entropy: 416.4%
2022-04-15 14:49:08,384 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.471, Acc: 0.741, Base Lr: 1.27e-03
2022-04-15 14:49:26,320 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 14:50:29,405 reid_baseline.train INFO: normal accuracy 0.6655955932981409 4.104248523712158 
2022-04-15 14:50:30,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 14:50:30,336 reid_baseline.train INFO: Accuracy: 66.6% Mean Entropy: 410.4%
2022-04-15 14:51:03,078 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.922, Acc: 0.743, Base Lr: 1.66e-03
2022-04-15 14:51:21,120 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 14:52:23,997 reid_baseline.train INFO: normal accuracy 0.6786779894422768 3.8654916286468506 
2022-04-15 14:52:24,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 14:52:24,944 reid_baseline.train INFO: Accuracy: 67.9% Mean Entropy: 386.5%
2022-04-15 14:52:58,033 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.302, Acc: 0.754, Base Lr: 2.06e-03
2022-04-15 14:53:16,166 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 14:54:19,467 reid_baseline.train INFO: normal accuracy 0.7046132660087217 3.3546335697174072 
2022-04-15 14:54:20,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 14:54:20,389 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 335.5%
2022-04-15 14:54:52,876 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.789, Base Lr: 2.46e-03
2022-04-15 14:55:10,886 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 14:56:12,863 reid_baseline.train INFO: normal accuracy 0.7468441588248795 2.845519542694092 
2022-04-15 14:56:13,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 14:56:13,812 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 284.6%
2022-04-15 14:56:46,565 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.522, Acc: 0.839, Base Lr: 2.85e-03
2022-04-15 14:57:04,539 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 14:58:08,267 reid_baseline.train INFO: normal accuracy 0.7899931145283452 2.366518974304199 
2022-04-15 14:58:09,101 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 14:58:09,101 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 236.7%
2022-04-15 14:58:41,708 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.299, Acc: 0.895, Base Lr: 3.25e-03
2022-04-15 14:58:59,789 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 15:00:02,137 reid_baseline.train INFO: normal accuracy 0.8111085609364241 2.0060677528381348 
2022-04-15 15:00:03,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 15:00:03,347 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 200.6%
2022-04-15 15:00:36,457 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.184, Acc: 0.909, Base Lr: 3.64e-03
2022-04-15 15:00:54,484 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 15:01:57,153 reid_baseline.train INFO: normal accuracy 0.8251090199678678 1.7311099767684937 
2022-04-15 15:01:58,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 15:01:58,046 reid_baseline.train INFO: Accuracy: 82.5% Mean Entropy: 173.1%
2022-04-15 15:02:30,862 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.080, Acc: 0.927, Base Lr: 4.04e-03
2022-04-15 15:02:48,746 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 15:03:51,246 reid_baseline.train INFO: normal accuracy 0.8290107872389259 1.6989023685455322 
2022-04-15 15:03:52,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 15:03:52,078 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 169.9%
2022-04-15 15:04:25,571 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.023, Acc: 0.942, Base Lr: 4.44e-03
2022-04-15 15:04:43,579 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 15:05:45,557 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4803614616394043 
2022-04-15 15:05:46,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 15:05:46,419 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 148.0%
2022-04-15 15:06:19,558 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.952, Base Lr: 4.83e-03
2022-04-15 15:06:37,505 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 15:07:40,415 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4792128801345825 
2022-04-15 15:07:41,297 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 15:07:41,297 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 147.9%
2022-04-15 15:08:15,289 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.935, Acc: 0.965, Base Lr: 5.23e-03
2022-04-15 15:08:33,248 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 15:09:35,263 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.4660602807998657 
2022-04-15 15:09:36,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 15:09:36,095 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 146.6%
2022-04-15 15:10:10,311 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.900, Acc: 0.977, Base Lr: 5.62e-03
2022-04-15 15:10:28,227 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 15:11:30,646 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.437819004058838 
2022-04-15 15:11:31,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 15:11:31,642 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 143.8%
2022-04-15 15:12:06,279 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.880, Acc: 0.981, Base Lr: 6.02e-03
2022-04-15 15:12:24,166 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-15 15:13:25,905 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.3761318922042847 
2022-04-15 15:13:26,827 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 15:13:26,828 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 137.6%
2022-04-15 15:14:02,010 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.854, Acc: 0.988, Base Lr: 6.42e-03
2022-04-15 15:14:19,930 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-15 15:15:21,738 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.3509632349014282 
2022-04-15 15:15:22,746 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 15:15:22,746 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 135.1%
2022-04-15 15:15:58,131 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.841, Acc: 0.991, Base Lr: 6.81e-03
2022-04-15 15:16:16,096 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-15 15:17:17,334 reid_baseline.train INFO: normal accuracy 0.8441588248795042 1.465786337852478 
2022-04-15 15:17:17,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 15:17:17,336 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 146.6%
2022-04-15 15:17:52,690 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.839, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 15:18:10,610 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.350[s] Speed: 45.8[samples/s]
2022-04-15 15:19:12,121 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.3205150365829468 
2022-04-15 15:19:13,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 15:19:13,047 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 132.1%
2022-04-15 15:19:48,108 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.829, Acc: 0.989, Base Lr: 7.60e-03
2022-04-15 15:20:06,033 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 15:21:07,529 reid_baseline.train INFO: normal accuracy 0.8393389947211384 1.3578765392303467 
2022-04-15 15:21:07,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 15:21:07,531 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 135.8%
2022-04-15 15:21:42,827 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.808, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 15:22:00,835 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-15 15:23:06,763 reid_baseline.train INFO: normal accuracy 0.8397980261647923 1.3925068378448486 
2022-04-15 15:23:06,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 15:23:06,765 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 139.3%
2022-04-15 15:23:39,594 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.69e-03
2022-04-15 15:23:57,545 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 15:24:56,941 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.5175236463546753 
2022-04-15 15:24:56,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 15:24:56,944 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 151.8%
2022-04-15 15:25:26,508 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.801, Acc: 0.995, Base Lr: 3.38e-03
2022-04-15 15:25:43,585 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.307[s] Speed: 52.2[samples/s]
2022-04-15 15:26:47,769 reid_baseline.train INFO: normal accuracy 0.8436997934358503 1.423648715019226 
2022-04-15 15:26:47,774 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 15:26:47,774 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 142.4%
2022-04-15 15:27:20,567 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.992, Base Lr: 3.08e-03
2022-04-15 15:27:37,547 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 15:28:41,804 reid_baseline.train INFO: normal accuracy 0.8400275418866192 1.4204299449920654 
2022-04-15 15:28:41,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 15:28:41,810 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 142.0%
2022-04-15 15:29:15,055 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.796, Acc: 0.996, Base Lr: 2.77e-03
2022-04-15 15:29:32,055 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.330[s] Speed: 48.4[samples/s]
2022-04-15 15:30:36,490 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.463344693183899 
2022-04-15 15:30:36,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 15:30:36,493 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.3%
2022-04-15 15:31:08,848 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.48e-03
2022-04-15 15:31:25,841 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-15 15:32:30,160 reid_baseline.train INFO: normal accuracy 0.8439293091576773 1.475030779838562 
2022-04-15 15:32:30,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 15:32:30,165 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 147.5%
2022-04-15 15:33:03,137 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 15:33:20,116 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-15 15:34:25,272 reid_baseline.train INFO: normal accuracy 0.8436997934358503 1.4737207889556885 
2022-04-15 15:34:25,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 15:34:25,277 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 147.4%
2022-04-15 15:34:57,601 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.996, Base Lr: 1.92e-03
2022-04-15 15:35:14,621 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-15 15:36:21,068 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.465511441230774 
2022-04-15 15:36:21,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 15:36:21,073 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.6%
2022-04-15 15:36:54,090 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.791, Acc: 0.996, Base Lr: 1.66e-03
2022-04-15 15:37:11,086 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 15:38:16,988 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.4914788007736206 
2022-04-15 15:38:16,992 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 15:38:16,993 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 149.1%
2022-04-15 15:38:48,990 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.42e-03
2022-04-15 15:39:05,966 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-15 15:40:11,720 reid_baseline.train INFO: normal accuracy 0.8430112462703695 1.4971287250518799 
2022-04-15 15:40:11,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 15:40:11,723 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 149.7%
2022-04-15 15:40:45,605 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.19e-03
2022-04-15 15:41:02,508 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 15:42:08,873 reid_baseline.train INFO: normal accuracy 0.8432407619921964 1.4375255107879639 
2022-04-15 15:42:08,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 15:42:08,878 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 143.8%
2022-04-15 15:42:41,818 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 15:42:57,909 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.322[s] Speed: 49.6[samples/s]
2022-04-15 15:44:02,511 reid_baseline.train INFO: normal accuracy 0.8411751204957539 1.4607093334197998 
2022-04-15 15:44:02,516 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 15:44:02,516 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 146.1%
2022-04-15 15:44:36,523 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.783, Acc: 0.997, Base Lr: 7.78e-04
2022-04-15 15:44:52,496 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 15:45:57,348 reid_baseline.train INFO: normal accuracy 0.8411751204957539 1.5526649951934814 
2022-04-15 15:45:57,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 15:45:57,353 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 155.3%
2022-04-15 15:46:30,428 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 6.04e-04
2022-04-15 15:46:46,544 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 15:47:51,920 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.466657042503357 
2022-04-15 15:47:51,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 15:47:51,921 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 146.7%
2022-04-15 15:48:25,777 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.788, Acc: 0.995, Base Lr: 4.51e-04
2022-04-15 15:48:41,902 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 15:49:46,921 reid_baseline.train INFO: normal accuracy 0.8414046362175809 1.538833737373352 
2022-04-15 15:49:46,925 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 15:49:46,926 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 153.9%
2022-04-15 15:50:20,952 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 3.20e-04
2022-04-15 15:50:35,920 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-15 15:51:40,171 reid_baseline.train INFO: normal accuracy 0.8448473720449851 1.508558988571167 
2022-04-15 15:51:40,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 15:51:40,176 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 150.9%
2022-04-15 15:52:13,988 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 15:52:30,168 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.328[s] Speed: 48.9[samples/s]
2022-04-15 15:53:33,867 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4847667217254639 
2022-04-15 15:53:33,872 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 15:53:33,872 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 148.5%
2022-04-15 15:54:07,863 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.782, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 15:54:24,276 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-15 15:55:28,969 reid_baseline.train INFO: normal accuracy 0.8416341519394078 1.465133547782898 
2022-04-15 15:55:28,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 15:55:28,974 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.5%
2022-04-15 15:56:02,239 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.784, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 15:56:19,531 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 15:57:23,479 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.5426408052444458 
2022-04-15 15:57:23,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 15:57:23,481 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 154.3%
2022-04-15 15:57:56,382 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 2.83e-05
2022-04-15 15:58:14,173 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 15:59:17,396 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.5322153568267822 
2022-04-15 15:59:17,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 15:59:17,400 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 153.2%
2022-04-15 15:59:50,213 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.790, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 16:00:07,949 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 16:01:12,578 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4803787469863892 
2022-04-15 16:01:12,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 16:01:12,582 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 148.0%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_4/transformer_best_model.pth
2022-04-15 16:02:17,005 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.3205150365829468 
2022-04-15 16:02:17,005 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:02:17,005 reid_baseline.train INFO: Accuracy: 84.5%
2022-04-15 16:03:18,762 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.3205150365829468 
2022-04-15 16:03:18,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:03:18,763 reid_baseline.train INFO: Shuffled Accuracy: 84.5%
2022-04-15 16:03:54,190 reid_baseline.train INFO: normal accuracy 0.9954676555418212 0.5764470100402832 
2022-04-15 16:03:54,191 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:03:54,191 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 16:03:58,909 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_6
2022-04-15 16:03:58,909 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-15 16:03:58,909 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 16:03:58,910 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 16:03:58,910 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 16:04:13,899 reid_baseline.train INFO: start training
2022-04-15 16:04:48,704 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.297, Base Lr: 4.76e-04
2022-04-15 16:05:06,070 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 16:06:08,952 reid_baseline.train INFO: normal accuracy 0.5260193737328227 4.172761917114258 
2022-04-15 16:06:09,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 16:06:09,818 reid_baseline.train INFO: Accuracy: 52.6% Mean Entropy: 417.3%
2022-04-15 16:06:42,897 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.893, Acc: 0.699, Base Lr: 8.72e-04
2022-04-15 16:07:00,105 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-15 16:08:02,795 reid_baseline.train INFO: normal accuracy 0.5800856048659608 4.166248321533203 
2022-04-15 16:08:03,701 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 16:08:03,702 reid_baseline.train INFO: Accuracy: 58.0% Mean Entropy: 416.6%
2022-04-15 16:08:37,332 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.474, Acc: 0.735, Base Lr: 1.27e-03
2022-04-15 16:08:54,459 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 16:09:57,097 reid_baseline.train INFO: normal accuracy 0.5974318540211759 4.127814292907715 
2022-04-15 16:09:57,897 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 16:09:57,897 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 412.8%
2022-04-15 16:10:30,593 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.921, Acc: 0.729, Base Lr: 1.66e-03
2022-04-15 16:10:47,545 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.327[s] Speed: 49.0[samples/s]
2022-04-15 16:11:50,523 reid_baseline.train INFO: normal accuracy 0.6001351655778329 3.9570417404174805 
2022-04-15 16:11:51,405 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 16:11:51,405 reid_baseline.train INFO: Accuracy: 60.0% Mean Entropy: 395.7%
2022-04-15 16:12:24,823 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.297, Acc: 0.758, Base Lr: 2.06e-03
2022-04-15 16:12:42,026 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 16:13:45,856 reid_baseline.train INFO: normal accuracy 0.6246902455507998 3.5594403743743896 
2022-04-15 16:13:46,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 16:13:46,734 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 355.9%
2022-04-15 16:14:20,234 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.837, Acc: 0.792, Base Lr: 2.46e-03
2022-04-15 16:14:37,014 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 16:15:40,891 reid_baseline.train INFO: normal accuracy 0.68123451227754 3.0872366428375244 
2022-04-15 16:15:41,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 16:15:41,961 reid_baseline.train INFO: Accuracy: 68.1% Mean Entropy: 308.7%
2022-04-15 16:16:15,744 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.517, Acc: 0.842, Base Lr: 2.85e-03
2022-04-15 16:16:32,156 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 16:17:35,571 reid_baseline.train INFO: normal accuracy 0.7348501914845686 2.6061928272247314 
2022-04-15 16:17:36,448 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 16:17:36,449 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 260.6%
2022-04-15 16:18:10,321 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.295, Acc: 0.889, Base Lr: 3.25e-03
2022-04-15 16:18:25,869 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-15 16:19:29,385 reid_baseline.train INFO: normal accuracy 0.7654877224600135 2.242831230163574 
2022-04-15 16:19:30,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 16:19:30,279 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 224.3%
2022-04-15 16:20:04,001 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.185, Acc: 0.909, Base Lr: 3.64e-03
2022-04-15 16:20:19,736 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-15 16:21:23,370 reid_baseline.train INFO: normal accuracy 0.7792295562063528 1.9707814455032349 
2022-04-15 16:21:25,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 16:21:25,446 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 197.1%
2022-04-15 16:21:59,323 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.082, Acc: 0.928, Base Lr: 4.04e-03
2022-04-15 16:22:15,341 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 16:23:21,039 reid_baseline.train INFO: normal accuracy 0.7880153187654877 1.8783897161483765 
2022-04-15 16:23:21,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 16:23:21,947 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 187.8%
2022-04-15 16:23:55,557 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.027, Acc: 0.941, Base Lr: 4.44e-03
2022-04-15 16:24:12,836 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 16:25:15,581 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.6985697746276855 
2022-04-15 16:25:16,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 16:25:16,460 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 169.9%
2022-04-15 16:25:49,325 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.978, Acc: 0.951, Base Lr: 4.83e-03
2022-04-15 16:26:06,952 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 16:27:08,834 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.663155436515808 
2022-04-15 16:27:09,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 16:27:09,692 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 166.3%
2022-04-15 16:27:42,385 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.938, Acc: 0.966, Base Lr: 5.23e-03
2022-04-15 16:28:00,239 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 16:29:02,511 reid_baseline.train INFO: normal accuracy 0.7916197341743636 1.7053794860839844 
2022-04-15 16:29:02,516 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 16:29:02,516 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 170.5%
2022-04-15 16:29:35,144 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.908, Acc: 0.974, Base Lr: 5.62e-03
2022-04-15 16:29:53,084 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 16:30:54,603 reid_baseline.train INFO: normal accuracy 0.7900428024329804 1.713417649269104 
2022-04-15 16:30:54,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 16:30:54,608 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 171.3%
2022-04-15 16:31:27,452 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.979, Base Lr: 6.02e-03
2022-04-15 16:31:45,362 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 16:32:47,657 reid_baseline.train INFO: normal accuracy 0.7934219418788016 1.5824872255325317 
2022-04-15 16:32:48,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 16:32:48,611 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 158.2%
2022-04-15 16:33:21,753 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.855, Acc: 0.986, Base Lr: 6.42e-03
2022-04-15 16:33:39,603 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.335[s] Speed: 47.7[samples/s]
2022-04-15 16:34:41,343 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.6126477718353271 
2022-04-15 16:34:41,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 16:34:41,344 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 161.3%
2022-04-15 16:35:13,998 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.846, Acc: 0.990, Base Lr: 6.81e-03
2022-04-15 16:35:31,893 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 16:36:34,314 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.6940122842788696 
2022-04-15 16:36:34,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 16:36:34,319 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.4%
2022-04-15 16:37:07,256 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.841, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 16:37:25,026 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 16:38:27,289 reid_baseline.train INFO: normal accuracy 0.7889164226177067 1.547371745109558 
2022-04-15 16:38:29,504 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 16:38:29,504 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 154.7%
2022-04-15 16:39:01,618 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.822, Acc: 0.992, Base Lr: 7.60e-03
2022-04-15 16:39:19,450 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-15 16:40:21,739 reid_baseline.train INFO: normal accuracy 0.7868889389502141 1.6127519607543945 
2022-04-15 16:40:21,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 16:40:21,744 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 161.3%
2022-04-15 16:40:57,370 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.809, Acc: 0.993, Base Lr: 4.01e-03
2022-04-15 16:41:14,478 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.347[s] Speed: 46.2[samples/s]
2022-04-15 16:42:17,644 reid_baseline.train INFO: normal accuracy 0.7898175264699256 1.666683554649353 
2022-04-15 16:42:17,648 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 16:42:17,648 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 166.7%
2022-04-15 16:42:46,377 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.69e-03
2022-04-15 16:42:59,826 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.277[s] Speed: 57.7[samples/s]
2022-04-15 16:43:59,219 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.6921361684799194 
2022-04-15 16:43:59,222 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 16:43:59,224 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.2%
2022-04-15 16:44:34,659 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.802, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 16:44:51,415 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 16:45:50,291 reid_baseline.train INFO: normal accuracy 0.7886911466546519 1.6433627605438232 
2022-04-15 16:45:50,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 16:45:50,295 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 164.3%
2022-04-15 16:46:25,192 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.996, Base Lr: 3.08e-03
2022-04-15 16:46:43,057 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 16:47:42,333 reid_baseline.train INFO: normal accuracy 0.7922955620635278 1.6858066320419312 
2022-04-15 16:47:42,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 16:47:42,335 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 168.6%
2022-04-15 16:48:16,948 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.798, Acc: 0.994, Base Lr: 2.77e-03
2022-04-15 16:48:34,597 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 16:49:34,582 reid_baseline.train INFO: normal accuracy 0.7922955620635278 1.6681288480758667 
2022-04-15 16:49:34,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 16:49:34,586 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 166.8%
2022-04-15 16:50:07,374 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.794, Acc: 0.996, Base Lr: 2.48e-03
2022-04-15 16:50:24,672 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 16:51:24,956 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.6805089712142944 
2022-04-15 16:51:24,960 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 16:51:24,960 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 168.1%
2022-04-15 16:51:57,290 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.791, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 16:52:15,266 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-15 16:53:15,806 reid_baseline.train INFO: normal accuracy 0.7907186303221446 1.725136399269104 
2022-04-15 16:53:15,810 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 16:53:15,810 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 172.5%
2022-04-15 16:53:48,037 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.793, Acc: 0.995, Base Lr: 1.92e-03
2022-04-15 16:54:06,015 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 16:55:06,453 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.70846688747406 
2022-04-15 16:55:06,466 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 16:55:06,467 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 170.8%
2022-04-15 16:55:38,027 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.789, Acc: 0.995, Base Lr: 1.66e-03
2022-04-15 16:55:55,930 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-15 16:56:57,847 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7442371845245361 
2022-04-15 16:56:57,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 16:56:57,852 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 174.4%
2022-04-15 16:57:29,391 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.42e-03
2022-04-15 16:57:46,956 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.322[s] Speed: 49.6[samples/s]
2022-04-15 16:58:47,996 reid_baseline.train INFO: normal accuracy 0.7913944582113088 1.7146962881088257 
2022-04-15 16:58:48,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 16:58:48,001 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.5%
2022-04-15 16:59:21,570 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.785, Acc: 0.998, Base Lr: 1.19e-03
2022-04-15 16:59:37,177 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 17:00:40,603 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.6917403936386108 
2022-04-15 17:00:40,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 17:00:40,608 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.2%
2022-04-15 17:01:14,282 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 17:01:28,912 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.318[s] Speed: 50.4[samples/s]
2022-04-15 17:02:30,147 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.7181624174118042 
2022-04-15 17:02:30,149 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 17:02:30,149 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 171.8%
2022-04-15 17:03:04,065 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 7.78e-04
2022-04-15 17:03:19,279 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 17:04:22,692 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7863694429397583 
2022-04-15 17:04:22,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 17:04:22,733 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 178.6%
2022-04-15 17:04:56,688 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.04e-04
2022-04-15 17:05:13,624 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-15 17:06:15,238 reid_baseline.train INFO: normal accuracy 0.7934219418788016 1.6953952312469482 
2022-04-15 17:06:15,242 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 17:06:15,242 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 169.5%
2022-04-15 17:06:48,633 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 4.51e-04
2022-04-15 17:07:05,632 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.330[s] Speed: 48.4[samples/s]
2022-04-15 17:08:07,109 reid_baseline.train INFO: normal accuracy 0.7945483216940752 1.7731261253356934 
2022-04-15 17:08:07,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 17:08:07,114 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 177.3%
2022-04-15 17:08:40,786 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 3.20e-04
2022-04-15 17:08:57,697 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 17:09:58,109 reid_baseline.train INFO: normal accuracy 0.7949988736201847 1.764901876449585 
2022-04-15 17:09:58,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 17:09:58,111 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 176.5%
2022-04-15 17:10:30,359 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 17:10:47,336 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 17:11:48,379 reid_baseline.train INFO: normal accuracy 0.7916197341743636 1.7351226806640625 
2022-04-15 17:11:48,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 17:11:48,384 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 173.5%
2022-04-15 17:12:21,982 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 17:12:38,968 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.332[s] Speed: 48.3[samples/s]
2022-04-15 17:13:39,542 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.7159276008605957 
2022-04-15 17:13:39,546 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 17:13:39,547 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 171.6%
2022-04-15 17:14:13,083 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 17:14:30,053 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 17:15:30,534 reid_baseline.train INFO: normal accuracy 0.7954494255462942 1.7981199026107788 
2022-04-15 17:15:30,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 17:15:30,543 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 179.8%
2022-04-15 17:16:04,803 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.997, Base Lr: 2.83e-05
2022-04-15 17:16:21,768 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 17:17:22,280 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.7653988599777222 
2022-04-15 17:17:22,284 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 17:17:22,285 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 176.5%
2022-04-15 17:17:56,085 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.787, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 17:18:12,478 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 17:19:15,003 reid_baseline.train INFO: normal accuracy 0.7940977697679658 1.719238519668579 
2022-04-15 17:19:15,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 17:19:15,008 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 171.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_6/transformer_best_model.pth
2022-04-15 17:20:17,764 reid_baseline.train INFO: normal accuracy 0.7889164226177067 1.547371745109558 
2022-04-15 17:20:17,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 17:20:17,765 reid_baseline.train INFO: Accuracy: 78.9%
2022-04-15 17:21:16,624 reid_baseline.train INFO: normal accuracy 0.7889164226177067 1.547371745109558 
2022-04-15 17:21:16,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 17:21:16,625 reid_baseline.train INFO: Shuffled Accuracy: 78.9%
2022-04-15 17:21:52,680 reid_baseline.train INFO: normal accuracy 0.9946435929130614 0.5840359926223755 
2022-04-15 17:21:52,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 17:21:52,681 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 17:21:57,201 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_6
2022-04-15 17:21:57,201 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-15 17:21:57,202 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 17:21:57,202 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 17:21:57,202 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 17:22:11,544 reid_baseline.train INFO: start training
2022-04-15 17:22:44,829 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.297, Base Lr: 4.76e-04
2022-04-15 17:23:03,017 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-15 17:24:06,294 reid_baseline.train INFO: normal accuracy 0.598117971081019 4.172659873962402 
2022-04-15 17:24:07,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 17:24:07,330 reid_baseline.train INFO: Accuracy: 59.8% Mean Entropy: 417.3%
2022-04-15 17:24:39,743 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.893, Acc: 0.699, Base Lr: 8.72e-04
2022-04-15 17:24:57,564 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.330[s] Speed: 48.4[samples/s]
2022-04-15 17:26:09,300 reid_baseline.train INFO: normal accuracy 0.6552673858159284 4.163956165313721 
2022-04-15 17:26:11,339 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 17:26:11,339 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 416.4%
2022-04-15 17:26:48,514 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.474, Acc: 0.735, Base Lr: 1.27e-03
2022-04-15 17:27:06,776 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.365[s] Speed: 43.9[samples/s]
2022-04-15 17:28:09,706 reid_baseline.train INFO: normal accuracy 0.6685792976818912 4.104281425476074 
2022-04-15 17:28:10,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 17:28:10,587 reid_baseline.train INFO: Accuracy: 66.9% Mean Entropy: 410.4%
2022-04-15 17:28:43,320 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.921, Acc: 0.729, Base Lr: 1.66e-03
2022-04-15 17:29:01,337 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 17:30:03,923 reid_baseline.train INFO: normal accuracy 0.6779894422767959 3.856644868850708 
2022-04-15 17:30:04,895 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 17:30:04,896 reid_baseline.train INFO: Accuracy: 67.8% Mean Entropy: 385.7%
2022-04-15 17:30:38,031 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.297, Acc: 0.758, Base Lr: 2.06e-03
2022-04-15 17:30:56,087 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 17:31:59,286 reid_baseline.train INFO: normal accuracy 0.7027771402341061 3.3442816734313965 
2022-04-15 17:32:00,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 17:32:00,218 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 334.4%
2022-04-15 17:32:32,915 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.837, Acc: 0.792, Base Lr: 2.46e-03
2022-04-15 17:32:50,979 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-15 17:33:52,680 reid_baseline.train INFO: normal accuracy 0.7500573789304568 2.8348007202148438 
2022-04-15 17:33:53,596 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 17:33:53,596 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 283.5%
2022-04-15 17:34:25,821 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.517, Acc: 0.842, Base Lr: 2.85e-03
2022-04-15 17:34:43,782 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 17:35:47,199 reid_baseline.train INFO: normal accuracy 0.7922882717466146 2.34587025642395 
2022-04-15 17:35:48,125 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 17:35:48,125 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 234.6%
2022-04-15 17:36:21,322 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.295, Acc: 0.889, Base Lr: 3.25e-03
2022-04-15 17:36:39,382 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 17:37:42,383 reid_baseline.train INFO: normal accuracy 0.8152398439293091 2.006458044052124 
2022-04-15 17:37:43,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 17:37:43,312 reid_baseline.train INFO: Accuracy: 81.5% Mean Entropy: 200.6%
2022-04-15 17:38:17,675 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.185, Acc: 0.909, Base Lr: 3.64e-03
2022-04-15 17:38:35,653 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 17:39:38,433 reid_baseline.train INFO: normal accuracy 0.8274041771861372 1.7573788166046143 
2022-04-15 17:39:39,687 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 17:39:39,687 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 175.7%
2022-04-15 17:40:13,844 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.082, Acc: 0.928, Base Lr: 4.04e-03
2022-04-15 17:40:31,874 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 17:41:34,714 reid_baseline.train INFO: normal accuracy 0.8299288501262336 1.683920979499817 
2022-04-15 17:41:36,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 17:41:36,795 reid_baseline.train INFO: Accuracy: 83.0% Mean Entropy: 168.4%
2022-04-15 17:42:12,409 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.027, Acc: 0.941, Base Lr: 4.44e-03
2022-04-15 17:42:30,297 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-15 17:43:31,702 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4770863056182861 
2022-04-15 17:43:32,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 17:43:32,745 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 147.7%
2022-04-15 17:44:08,646 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.978, Acc: 0.951, Base Lr: 4.83e-03
2022-04-15 17:44:26,633 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-15 17:45:26,842 reid_baseline.train INFO: normal accuracy 0.8372733532246959 1.4833017587661743 
2022-04-15 17:45:27,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 17:45:27,766 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 148.3%
2022-04-15 17:46:03,492 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.938, Acc: 0.966, Base Lr: 5.23e-03
2022-04-15 17:46:21,458 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-15 17:47:22,286 reid_baseline.train INFO: normal accuracy 0.8397980261647923 1.5046888589859009 
2022-04-15 17:47:22,291 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 17:47:22,291 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 150.5%
2022-04-15 17:47:58,267 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.908, Acc: 0.974, Base Lr: 5.62e-03
2022-04-15 17:48:16,211 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-15 17:49:17,951 reid_baseline.train INFO: normal accuracy 0.8459949506541198 1.4867241382598877 
2022-04-15 17:49:17,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 17:49:17,953 reid_baseline.train INFO: Accuracy: 84.6% Mean Entropy: 148.7%
2022-04-15 17:49:53,267 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.979, Base Lr: 6.02e-03
2022-04-15 17:50:11,201 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-15 17:51:12,218 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.3754751682281494 
2022-04-15 17:51:14,185 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 17:51:14,186 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 137.5%
2022-04-15 17:51:50,010 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.855, Acc: 0.986, Base Lr: 6.42e-03
2022-04-15 17:52:07,933 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-15 17:53:08,750 reid_baseline.train INFO: normal accuracy 0.8414046362175809 1.3985378742218018 
2022-04-15 17:53:08,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 17:53:08,755 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 139.9%
2022-04-15 17:53:43,882 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.846, Acc: 0.990, Base Lr: 6.81e-03
2022-04-15 17:54:01,763 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.348[s] Speed: 45.9[samples/s]
2022-04-15 17:55:03,128 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.4643665552139282 
2022-04-15 17:55:03,132 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 17:55:03,133 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 146.4%
2022-04-15 17:55:39,025 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.841, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 17:55:56,428 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-15 17:56:57,176 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3355002403259277 
2022-04-15 17:56:58,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 17:56:58,178 reid_baseline.train INFO: Accuracy: 84.6% Mean Entropy: 133.6%
2022-04-15 17:57:33,311 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.822, Acc: 0.992, Base Lr: 7.60e-03
2022-04-15 17:57:50,558 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-15 17:58:51,692 reid_baseline.train INFO: normal accuracy 0.8381914161120037 1.4092601537704468 
2022-04-15 17:58:51,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 17:58:51,697 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 140.9%
2022-04-15 17:59:27,384 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.809, Acc: 0.993, Base Lr: 4.01e-03
2022-04-15 17:59:44,134 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-15 18:00:50,429 reid_baseline.train INFO: normal accuracy 0.8377323846683498 1.4244821071624756 
2022-04-15 18:00:50,431 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 18:00:50,432 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 142.4%
2022-04-15 18:01:25,006 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.69e-03
2022-04-15 18:01:42,689 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 18:02:39,629 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.4706826210021973 
2022-04-15 18:02:39,632 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 18:02:39,632 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 147.1%
2022-04-15 18:03:12,410 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.802, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 18:03:29,451 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-15 18:04:35,116 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.4184210300445557 
2022-04-15 18:04:35,120 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 18:04:35,121 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 141.8%
2022-04-15 18:05:06,970 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.996, Base Lr: 3.08e-03
2022-04-15 18:05:23,930 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.321[s] Speed: 49.9[samples/s]
2022-04-15 18:06:29,887 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.4584169387817383 
2022-04-15 18:06:29,892 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 18:06:29,892 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 145.8%
2022-04-15 18:07:03,001 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.798, Acc: 0.994, Base Lr: 2.77e-03
2022-04-15 18:07:20,018 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 18:08:25,943 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4446864128112793 
2022-04-15 18:08:25,945 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 18:08:25,946 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 144.5%
2022-04-15 18:08:58,836 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.794, Acc: 0.996, Base Lr: 2.48e-03
2022-04-15 18:09:15,875 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 18:10:21,479 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.435155987739563 
2022-04-15 18:10:21,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 18:10:21,482 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 143.5%
2022-04-15 18:10:55,414 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.791, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 18:11:12,299 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 18:12:19,011 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.4924544095993042 
2022-04-15 18:12:19,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 18:12:19,015 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 149.2%
2022-04-15 18:12:52,152 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.793, Acc: 0.995, Base Lr: 1.92e-03
2022-04-15 18:13:08,029 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.322[s] Speed: 49.6[samples/s]
2022-04-15 18:14:13,557 reid_baseline.train INFO: normal accuracy 0.8393389947211384 1.4696712493896484 
2022-04-15 18:14:13,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 18:14:13,562 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 147.0%
2022-04-15 18:14:47,448 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.789, Acc: 0.995, Base Lr: 1.66e-03
2022-04-15 18:15:03,507 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 18:16:08,215 reid_baseline.train INFO: normal accuracy 0.8393389947211384 1.4994380474090576 
2022-04-15 18:16:08,219 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 18:16:08,219 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 149.9%
2022-04-15 18:16:40,783 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.42e-03
2022-04-15 18:16:56,878 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-15 18:18:01,580 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4713521003723145 
2022-04-15 18:18:01,585 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 18:18:01,585 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 147.1%
2022-04-15 18:18:35,689 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.785, Acc: 0.998, Base Lr: 1.19e-03
2022-04-15 18:18:51,839 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.330[s] Speed: 48.4[samples/s]
2022-04-15 18:19:58,737 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.4431096315383911 
2022-04-15 18:19:58,741 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 18:19:58,741 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 144.3%
2022-04-15 18:20:31,412 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 18:20:46,444 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.313[s] Speed: 51.0[samples/s]
2022-04-15 18:21:49,929 reid_baseline.train INFO: normal accuracy 0.8384209318338306 1.4604089260101318 
2022-04-15 18:21:49,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 18:21:49,934 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 146.0%
2022-04-15 18:22:23,751 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 7.78e-04
2022-04-15 18:22:39,957 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-15 18:23:44,333 reid_baseline.train INFO: normal accuracy 0.8416341519394078 1.5379066467285156 
2022-04-15 18:23:44,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 18:23:44,338 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 153.8%
2022-04-15 18:24:18,098 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.04e-04
2022-04-15 18:24:32,958 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.320[s] Speed: 50.1[samples/s]
2022-04-15 18:25:37,444 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4485032558441162 
2022-04-15 18:25:37,448 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 18:25:37,449 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 144.9%
2022-04-15 18:26:11,172 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 4.51e-04
2022-04-15 18:26:27,591 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 18:27:32,123 reid_baseline.train INFO: normal accuracy 0.8402570576084462 1.5215630531311035 
2022-04-15 18:27:32,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 18:27:32,127 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 152.2%
2022-04-15 18:28:05,870 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 3.20e-04
2022-04-15 18:28:21,793 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-15 18:29:25,938 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.51552414894104 
2022-04-15 18:29:25,943 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 18:29:25,943 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 151.6%
2022-04-15 18:29:58,959 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 18:30:16,370 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.332[s] Speed: 48.3[samples/s]
2022-04-15 18:31:19,146 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.486164927482605 
2022-04-15 18:31:19,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 18:31:19,151 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 148.6%
2022-04-15 18:31:52,539 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 18:32:09,424 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.330[s] Speed: 48.4[samples/s]
2022-04-15 18:33:12,300 reid_baseline.train INFO: normal accuracy 0.8397980261647923 1.4684135913848877 
2022-04-15 18:33:12,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 18:33:12,305 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 146.8%
2022-04-15 18:33:45,130 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 18:34:03,001 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 18:35:06,796 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.5422908067703247 
2022-04-15 18:35:06,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 18:35:06,801 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 154.2%
2022-04-15 18:35:39,478 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.997, Base Lr: 2.83e-05
2022-04-15 18:35:57,233 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.331[s] Speed: 48.3[samples/s]
2022-04-15 18:37:01,161 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.513064980506897 
2022-04-15 18:37:01,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 18:37:01,165 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 151.3%
2022-04-15 18:37:33,944 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.787, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 18:37:51,685 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 18:38:56,093 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.4728552103042603 
2022-04-15 18:38:56,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 18:38:56,095 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 147.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_6/transformer_best_model.pth
2022-04-15 18:40:00,472 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3355002403259277 
2022-04-15 18:40:00,473 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:40:00,473 reid_baseline.train INFO: Accuracy: 84.6%
2022-04-15 18:40:59,412 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3355002403259277 
2022-04-15 18:40:59,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:40:59,412 reid_baseline.train INFO: Shuffled Accuracy: 84.6%
2022-04-15 18:41:34,616 reid_baseline.train INFO: normal accuracy 0.9946435929130614 0.5840359926223755 
2022-04-15 18:41:34,616 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:41:34,616 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 18:41:39,063 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_8
2022-04-15 18:41:39,064 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-15 18:41:39,064 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 18:41:39,064 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 18:41:39,064 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 18:41:53,908 reid_baseline.train INFO: start training
2022-04-15 18:42:28,119 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.293, Base Lr: 4.76e-04
2022-04-15 18:42:45,405 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-15 18:43:47,826 reid_baseline.train INFO: normal accuracy 0.5244424419914395 4.172770977020264 
2022-04-15 18:43:48,687 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 18:43:48,687 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 417.3%
2022-04-15 18:44:21,562 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.894, Acc: 0.705, Base Lr: 8.72e-04
2022-04-15 18:44:38,555 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 18:45:40,995 reid_baseline.train INFO: normal accuracy 0.5841405722009462 4.1663899421691895 
2022-04-15 18:45:41,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 18:45:41,984 reid_baseline.train INFO: Accuracy: 58.4% Mean Entropy: 416.6%
2022-04-15 18:46:15,587 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.474, Acc: 0.736, Base Lr: 1.27e-03
2022-04-15 18:46:32,610 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 18:47:35,154 reid_baseline.train INFO: normal accuracy 0.596530750168957 4.12823486328125 
