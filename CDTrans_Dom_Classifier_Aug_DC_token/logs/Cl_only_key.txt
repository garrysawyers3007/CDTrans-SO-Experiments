2022-05-15 12:22:42,035 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls
2022-05-15 12:22:42,035 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Art/transformer_best_model.pth')
2022-05-15 12:22:42,036 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-15 12:22:42,036 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-15 12:22:42,036 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-15 12:22:53,410 reid_baseline.train INFO: start training
2022-05-15 12:24:02,885 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.652, Acc: 0.343, Base Lr: 8.72e-04
2022-05-15 12:25:04,251 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.490, Acc: 0.439, Base Lr: 8.72e-04
2022-05-15 12:25:52,013 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.651[s] Speed: 24.6[samples/s]
2022-05-15 12:28:28,614 reid_baseline.train INFO: normal accuracy 0.2867737948084054 1.2309043407440186 
2022-05-15 12:28:29,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-15 12:28:29,934 reid_baseline.train INFO: Accuracy: 28.7% Mean Entropy: 123.1%
2022-05-15 12:29:49,855 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.948, Acc: 0.762, Base Lr: 1.66e-03
2022-05-15 12:31:06,984 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.871, Acc: 0.804, Base Lr: 1.66e-03
2022-05-15 12:31:55,589 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.753[s] Speed: 21.2[samples/s]
2022-05-15 12:34:43,052 reid_baseline.train INFO: normal accuracy 0.42439225381128964 1.2018550634384155 
2022-05-15 12:34:44,370 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-15 12:34:44,370 reid_baseline.train INFO: Accuracy: 42.4% Mean Entropy: 120.2%
2022-05-15 12:36:06,674 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.645, Acc: 0.922, Base Lr: 2.46e-03
2022-05-15 12:37:23,637 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.635, Acc: 0.925, Base Lr: 2.46e-03
2022-05-15 12:38:10,804 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.756[s] Speed: 21.2[samples/s]
2022-05-15 12:40:52,945 reid_baseline.train INFO: normal accuracy 0.4441697569015245 1.1055902242660522 
2022-05-15 12:40:54,244 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-15 12:40:54,245 reid_baseline.train INFO: Accuracy: 44.4% Mean Entropy: 110.6%
2022-05-15 12:42:13,042 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.573, Acc: 0.950, Base Lr: 3.25e-03
2022-05-15 12:43:30,149 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.565, Acc: 0.955, Base Lr: 3.25e-03
2022-05-15 12:44:18,525 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.748[s] Speed: 21.4[samples/s]
2022-05-15 12:47:00,344 reid_baseline.train INFO: normal accuracy 0.5063864853728883 1.1257946491241455 
2022-05-15 12:47:00,345 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-15 12:47:00,346 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 112.6%
2022-05-15 12:48:21,926 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.532, Acc: 0.970, Base Lr: 4.04e-03
2022-05-15 12:49:37,116 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.531, Acc: 0.969, Base Lr: 4.04e-03
2022-05-15 12:50:24,198 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.746[s] Speed: 21.4[samples/s]
2022-05-15 12:53:17,715 reid_baseline.train INFO: normal accuracy 0.5854964977338277 1.1789159774780273 
2022-05-15 12:53:17,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-15 12:53:17,716 reid_baseline.train INFO: Accuracy: 58.5% Mean Entropy: 117.9%
2022-05-15 12:54:43,108 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.502, Acc: 0.983, Base Lr: 4.83e-03
2022-05-15 12:55:53,853 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.513, Acc: 0.974, Base Lr: 4.83e-03
2022-05-15 12:56:46,063 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.762[s] Speed: 21.0[samples/s]
2022-05-15 12:59:27,275 reid_baseline.train INFO: normal accuracy 0.6493613514627111 1.1366716623306274 
2022-05-15 12:59:27,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-15 12:59:27,275 reid_baseline.train INFO: Accuracy: 64.9% Mean Entropy: 113.7%
2022-05-15 13:00:49,274 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.504, Acc: 0.976, Base Lr: 5.62e-03
2022-05-15 13:01:58,278 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.513, Acc: 0.973, Base Lr: 5.62e-03
2022-05-15 13:02:50,522 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.744[s] Speed: 21.5[samples/s]
2022-05-15 13:05:31,995 reid_baseline.train INFO: normal accuracy 0.6081582200247219 1.0955806970596313 
2022-05-15 13:05:33,325 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-15 13:05:33,325 reid_baseline.train INFO: Accuracy: 60.8% Mean Entropy: 109.6%
2022-05-15 13:06:57,785 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.499, Acc: 0.980, Base Lr: 6.42e-03
2022-05-15 13:08:10,566 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.504, Acc: 0.978, Base Lr: 6.42e-03
2022-05-15 13:09:04,453 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.773[s] Speed: 20.7[samples/s]
2022-05-15 13:11:44,398 reid_baseline.train INFO: normal accuracy 0.6419447878038731 1.0664770603179932 
2022-05-15 13:11:45,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-15 13:11:45,711 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 106.6%
2022-05-15 13:13:09,630 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.495, Acc: 0.978, Base Lr: 7.21e-03
2022-05-15 13:14:19,907 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.499, Acc: 0.978, Base Lr: 7.21e-03
2022-05-15 13:15:10,500 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.750[s] Speed: 21.3[samples/s]
2022-05-15 13:17:46,624 reid_baseline.train INFO: normal accuracy 0.69221260815822 1.0215431451797485 
2022-05-15 13:17:48,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-15 13:17:48,027 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 102.2%
2022-05-15 13:19:11,119 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.483, Acc: 0.985, Base Lr: 4.01e-03
2022-05-15 13:20:24,407 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.481, Acc: 0.984, Base Lr: 4.01e-03
2022-05-15 13:21:18,719 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.772[s] Speed: 20.7[samples/s]
2022-05-15 13:23:59,685 reid_baseline.train INFO: normal accuracy 0.6967449526163988 0.92702317237854 
2022-05-15 13:24:00,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-15 13:24:00,985 reid_baseline.train INFO: Accuracy: 69.7% Mean Entropy: 92.7%
2022-05-15 13:25:21,969 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.475, Acc: 0.982, Base Lr: 3.38e-03
2022-05-15 13:26:36,130 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.472, Acc: 0.985, Base Lr: 3.38e-03
2022-05-15 13:27:28,629 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.761[s] Speed: 21.0[samples/s]
2022-05-15 13:30:00,541 reid_baseline.train INFO: normal accuracy 0.6946847960444994 0.9664731621742249 
2022-05-15 13:30:00,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-15 13:30:00,544 reid_baseline.train INFO: Accuracy: 69.5% Mean Entropy: 96.6%
2022-05-15 13:31:22,695 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.478, Acc: 0.982, Base Lr: 2.77e-03
2022-05-15 13:32:38,008 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.470, Acc: 0.985, Base Lr: 2.77e-03
2022-05-15 13:33:34,521 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.784[s] Speed: 20.4[samples/s]
2022-05-15 13:36:09,417 reid_baseline.train INFO: normal accuracy 0.661722290894108 0.9630544781684875 
2022-05-15 13:36:09,422 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-15 13:36:09,423 reid_baseline.train INFO: Accuracy: 66.2% Mean Entropy: 96.3%
2022-05-15 13:37:31,059 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.469, Acc: 0.985, Base Lr: 2.20e-03
2022-05-15 13:38:49,564 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.474, Acc: 0.984, Base Lr: 2.20e-03
2022-05-15 13:39:42,988 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.782[s] Speed: 20.5[samples/s]
2022-05-15 13:42:22,846 reid_baseline.train INFO: normal accuracy 0.7025133910177174 0.9669222235679626 
2022-05-15 13:42:22,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-15 13:42:22,849 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 96.7%
2022-05-15 13:43:44,276 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.457, Acc: 0.993, Base Lr: 1.66e-03
2022-05-15 13:45:01,171 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.458, Acc: 0.991, Base Lr: 1.66e-03
2022-05-15 13:45:55,908 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.780[s] Speed: 20.5[samples/s]
2022-05-15 13:48:35,687 reid_baseline.train INFO: normal accuracy 0.7177585496497734 0.9551581740379333 
2022-05-15 13:48:35,688 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-15 13:48:35,688 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 95.5%
2022-05-15 13:49:56,475 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.463, Acc: 0.986, Base Lr: 1.19e-03
2022-05-15 13:51:14,636 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.463, Acc: 0.987, Base Lr: 1.19e-03
2022-05-15 13:52:06,573 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.772[s] Speed: 20.7[samples/s]
2022-05-15 13:54:48,192 reid_baseline.train INFO: normal accuracy 0.722702925422332 0.9372850060462952 
2022-05-15 13:54:48,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-15 13:54:48,193 reid_baseline.train INFO: Accuracy: 72.3% Mean Entropy: 93.7%
2022-05-15 13:56:12,550 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.467, Acc: 0.988, Base Lr: 7.78e-04
2022-05-15 13:57:27,761 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.465, Acc: 0.989, Base Lr: 7.78e-04
2022-05-15 13:58:21,663 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.782[s] Speed: 20.5[samples/s]
2022-05-15 14:01:06,466 reid_baseline.train INFO: normal accuracy 0.7070457354758962 0.9505884051322937 
2022-05-15 14:01:06,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-15 14:01:06,467 reid_baseline.train INFO: Accuracy: 70.7% Mean Entropy: 95.1%
2022-05-15 14:02:34,879 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.460, Acc: 0.989, Base Lr: 4.51e-04
2022-05-15 14:03:46,907 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.458, Acc: 0.990, Base Lr: 4.51e-04
2022-05-15 14:04:38,073 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.775[s] Speed: 20.6[samples/s]
2022-05-15 14:07:12,116 reid_baseline.train INFO: normal accuracy 0.7033374536464772 0.9504876136779785 
2022-05-15 14:07:12,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-15 14:07:12,128 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 95.0%
2022-05-15 14:08:39,032 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.466, Acc: 0.987, Base Lr: 2.11e-04
2022-05-15 14:09:52,795 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.463, Acc: 0.990, Base Lr: 2.11e-04
2022-05-15 14:10:45,614 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.782[s] Speed: 20.5[samples/s]
2022-05-15 14:13:18,249 reid_baseline.train INFO: normal accuracy 0.7033374536464772 0.9450350403785706 
2022-05-15 14:13:18,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-15 14:13:18,250 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 94.5%
2022-05-15 14:14:47,730 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.463, Acc: 0.983, Base Lr: 6.51e-05
2022-05-15 14:16:04,413 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.460, Acc: 0.986, Base Lr: 6.51e-05
2022-05-15 14:17:01,576 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.818[s] Speed: 19.6[samples/s]
2022-05-15 14:19:37,542 reid_baseline.train INFO: normal accuracy 0.7107540173053152 0.9793956279754639 
2022-05-15 14:19:37,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-15 14:19:37,543 reid_baseline.train INFO: Accuracy: 71.1% Mean Entropy: 97.9%
2022-05-15 14:21:01,562 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.466, Acc: 0.988, Base Lr: 1.60e-05
2022-05-15 14:22:16,089 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.463, Acc: 0.988, Base Lr: 1.60e-05
2022-05-15 14:23:13,037 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.789[s] Speed: 20.3[samples/s]
2022-05-15 14:25:47,551 reid_baseline.train INFO: normal accuracy 0.7008652657601978 0.957817554473877 
2022-05-15 14:25:47,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-15 14:25:47,552 reid_baseline.train INFO: Accuracy: 70.1% Mean Entropy: 95.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls/transformer_best_model.pth
2022-05-15 14:28:23,434 reid_baseline.train INFO: normal accuracy 0.1630756231516688 1.256740689277649 
2022-05-15 14:28:23,435 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-15 14:28:23,450 reid_baseline.train INFO: Accuracy: 16.3%
2022-05-15 14:31:36,292 reid_baseline.train INFO: normal accuracy 0.16082474226804125 0.6209459900856018 
2022-05-15 14:31:36,293 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-15 14:31:36,293 reid_baseline.train INFO: Source Clean Accuracy: 16.1%
2022-05-15 14:31:45,170 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls
2022-05-15 14:31:45,170 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Product/transformer_best_model.pth')
2022-05-15 14:31:45,171 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-15 14:31:45,171 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-15 14:31:45,171 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-15 14:32:00,586 reid_baseline.train INFO: start training
2022-05-15 14:33:31,327 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.668, Acc: 0.335, Base Lr: 8.72e-04
2022-05-15 14:34:48,301 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.481, Acc: 0.458, Base Lr: 8.72e-04
2022-05-15 14:35:34,818 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.781[s] Speed: 20.5[samples/s]
2022-05-15 14:38:44,912 reid_baseline.train INFO: normal accuracy 0.3852218968236089 1.3100308179855347 
2022-05-15 14:38:46,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-15 14:38:46,193 reid_baseline.train INFO: Accuracy: 38.5% Mean Entropy: 131.0%
2022-05-15 14:40:10,648 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.854, Acc: 0.828, Base Lr: 1.66e-03
2022-05-15 14:41:30,161 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.772, Acc: 0.864, Base Lr: 1.66e-03
2022-05-15 14:42:20,099 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.784[s] Speed: 20.4[samples/s]
2022-05-15 14:45:36,432 reid_baseline.train INFO: normal accuracy 0.601712097319216 1.141844391822815 
2022-05-15 14:45:37,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-15 14:45:37,732 reid_baseline.train INFO: Accuracy: 60.2% Mean Entropy: 114.2%
2022-05-15 14:47:00,337 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.601, Acc: 0.943, Base Lr: 2.46e-03
2022-05-15 14:48:12,788 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.589, Acc: 0.950, Base Lr: 2.46e-03
2022-05-15 14:49:07,262 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.767[s] Speed: 20.8[samples/s]
2022-05-15 14:52:17,222 reid_baseline.train INFO: normal accuracy 0.6285199369227303 1.019861102104187 
2022-05-15 14:52:18,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-15 14:52:18,691 reid_baseline.train INFO: Accuracy: 62.9% Mean Entropy: 102.0%
2022-05-15 14:53:40,239 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.555, Acc: 0.961, Base Lr: 3.25e-03
2022-05-15 14:54:56,926 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.544, Acc: 0.967, Base Lr: 3.25e-03
2022-05-15 14:55:52,890 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.785[s] Speed: 20.4[samples/s]
2022-05-15 14:59:05,835 reid_baseline.train INFO: normal accuracy 0.7447623338589773 1.0094947814941406 
2022-05-15 14:59:07,191 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-15 14:59:07,191 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 100.9%
2022-05-15 15:00:24,226 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.534, Acc: 0.967, Base Lr: 4.04e-03
2022-05-15 15:01:42,479 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.535, Acc: 0.965, Base Lr: 4.04e-03
2022-05-15 15:02:36,506 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.767[s] Speed: 20.9[samples/s]
2022-05-15 15:05:58,540 reid_baseline.train INFO: normal accuracy 0.7670646542013967 0.9799209237098694 
2022-05-15 15:05:59,843 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-15 15:05:59,843 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 98.0%
2022-05-15 15:07:25,682 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.505, Acc: 0.981, Base Lr: 4.83e-03
2022-05-15 15:08:28,517 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.511, Acc: 0.977, Base Lr: 4.83e-03
2022-05-15 15:09:14,042 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.711[s] Speed: 22.5[samples/s]
2022-05-15 15:11:59,060 reid_baseline.train INFO: normal accuracy 0.8150484343320568 0.9139323830604553 
2022-05-15 15:12:00,415 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-15 15:12:00,416 reid_baseline.train INFO: Accuracy: 81.5% Mean Entropy: 91.4%
2022-05-15 15:13:14,591 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.513, Acc: 0.968, Base Lr: 5.62e-03
2022-05-15 15:14:19,496 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.505, Acc: 0.973, Base Lr: 5.62e-03
2022-05-15 15:15:03,972 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.672[s] Speed: 23.8[samples/s]
2022-05-15 15:17:59,837 reid_baseline.train INFO: normal accuracy 0.8420815498986258 0.8830617666244507 
2022-05-15 15:18:00,965 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-15 15:18:00,965 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 88.3%
2022-05-15 15:19:12,112 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.512, Acc: 0.968, Base Lr: 6.42e-03
2022-05-15 15:20:13,575 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.504, Acc: 0.974, Base Lr: 6.42e-03
2022-05-15 15:20:58,604 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.651[s] Speed: 24.6[samples/s]
2022-05-15 15:23:51,451 reid_baseline.train INFO: normal accuracy 0.8391529623789141 0.8714434504508972 
2022-05-15 15:23:52,577 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-15 15:23:52,577 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 87.1%
2022-05-15 15:25:03,137 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.501, Acc: 0.974, Base Lr: 7.21e-03
2022-05-15 15:26:08,239 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.503, Acc: 0.972, Base Lr: 7.21e-03
2022-05-15 15:26:52,106 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.658[s] Speed: 24.3[samples/s]
2022-05-15 15:29:47,684 reid_baseline.train INFO: normal accuracy 0.84275737778779 0.8456864953041077 
2022-05-15 15:29:48,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-15 15:29:48,830 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 84.6%
2022-05-15 15:31:02,071 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.480, Acc: 0.983, Base Lr: 4.01e-03
2022-05-15 15:32:03,217 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.483, Acc: 0.981, Base Lr: 4.01e-03
2022-05-15 15:32:50,017 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.663[s] Speed: 24.1[samples/s]
2022-05-15 15:35:39,714 reid_baseline.train INFO: normal accuracy 0.8641585942779906 0.7250339388847351 
2022-05-15 15:35:40,866 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-15 15:35:40,867 reid_baseline.train INFO: Accuracy: 86.4% Mean Entropy: 72.5%
2022-05-15 15:36:54,943 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.475, Acc: 0.984, Base Lr: 3.38e-03
2022-05-15 15:37:59,916 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.481, Acc: 0.983, Base Lr: 3.38e-03
2022-05-15 15:38:45,265 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.675[s] Speed: 23.7[samples/s]
2022-05-15 15:41:42,879 reid_baseline.train INFO: normal accuracy 0.8686641135390853 0.7359411120414734 
2022-05-15 15:41:42,880 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-15 15:41:42,880 reid_baseline.train INFO: Accuracy: 86.9% Mean Entropy: 73.6%
2022-05-15 15:42:51,186 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.473, Acc: 0.986, Base Lr: 2.77e-03
2022-05-15 15:43:56,041 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.481, Acc: 0.982, Base Lr: 2.77e-03
2022-05-15 15:44:41,304 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.653[s] Speed: 24.5[samples/s]
2022-05-15 15:47:34,709 reid_baseline.train INFO: normal accuracy 0.852444244199144 0.77411949634552 
2022-05-15 15:47:34,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-15 15:47:34,710 reid_baseline.train INFO: Accuracy: 85.2% Mean Entropy: 77.4%
2022-05-15 15:48:46,109 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.475, Acc: 0.986, Base Lr: 2.20e-03
2022-05-15 15:49:50,738 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.472, Acc: 0.987, Base Lr: 2.20e-03
2022-05-15 15:50:33,965 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.657[s] Speed: 24.4[samples/s]
2022-05-15 15:53:27,077 reid_baseline.train INFO: normal accuracy 0.8826312232484794 0.7083654999732971 
2022-05-15 15:53:28,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-15 15:53:28,293 reid_baseline.train INFO: Accuracy: 88.3% Mean Entropy: 70.8%
2022-05-15 15:54:41,446 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.465, Acc: 0.986, Base Lr: 1.66e-03
2022-05-15 15:55:48,069 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.469, Acc: 0.986, Base Lr: 1.66e-03
2022-05-15 15:56:36,811 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.690[s] Speed: 23.2[samples/s]
2022-05-15 15:59:28,760 reid_baseline.train INFO: normal accuracy 0.8569497634602388 0.7264553308486938 
2022-05-15 15:59:28,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-15 15:59:28,762 reid_baseline.train INFO: Accuracy: 85.7% Mean Entropy: 72.6%
2022-05-15 16:00:39,740 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.458, Acc: 0.990, Base Lr: 1.19e-03
2022-05-15 16:01:44,103 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.465, Acc: 0.988, Base Lr: 1.19e-03
2022-05-15 16:02:30,692 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.665[s] Speed: 24.0[samples/s]
2022-05-15 16:05:18,753 reid_baseline.train INFO: normal accuracy 0.8673124577607569 0.7141409516334534 
2022-05-15 16:05:18,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-15 16:05:18,755 reid_baseline.train INFO: Accuracy: 86.7% Mean Entropy: 71.4%
2022-05-15 16:06:32,295 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.463, Acc: 0.990, Base Lr: 7.78e-04
2022-05-15 16:07:34,838 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.461, Acc: 0.990, Base Lr: 7.78e-04
2022-05-15 16:08:19,981 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.664[s] Speed: 24.1[samples/s]
2022-05-15 16:11:16,875 reid_baseline.train INFO: normal accuracy 0.8571750394232935 0.7269935607910156 
2022-05-15 16:11:16,876 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-15 16:11:16,876 reid_baseline.train INFO: Accuracy: 85.7% Mean Entropy: 72.7%
2022-05-15 16:12:29,446 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.456, Acc: 0.992, Base Lr: 4.51e-04
2022-05-15 16:13:30,430 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.455, Acc: 0.991, Base Lr: 4.51e-04
2022-05-15 16:14:18,428 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.665[s] Speed: 24.1[samples/s]
2022-05-15 16:17:13,280 reid_baseline.train INFO: normal accuracy 0.8709168731696328 0.726381778717041 
2022-05-15 16:17:13,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-15 16:17:13,281 reid_baseline.train INFO: Accuracy: 87.1% Mean Entropy: 72.6%
2022-05-15 16:18:26,216 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.455, Acc: 0.990, Base Lr: 2.11e-04
2022-05-15 16:19:23,549 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.462, Acc: 0.989, Base Lr: 2.11e-04
2022-05-15 16:20:11,710 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.653[s] Speed: 24.5[samples/s]
2022-05-15 16:23:09,635 reid_baseline.train INFO: normal accuracy 0.8650596981302096 0.730476975440979 
2022-05-15 16:23:09,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-15 16:23:09,636 reid_baseline.train INFO: Accuracy: 86.5% Mean Entropy: 73.0%
2022-05-15 16:24:20,304 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.461, Acc: 0.987, Base Lr: 6.51e-05
2022-05-15 16:25:24,262 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.458, Acc: 0.989, Base Lr: 6.51e-05
2022-05-15 16:26:08,978 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.657[s] Speed: 24.4[samples/s]
2022-05-15 16:29:00,329 reid_baseline.train INFO: normal accuracy 0.8616805586843884 0.7259180545806885 
2022-05-15 16:29:00,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-15 16:29:00,330 reid_baseline.train INFO: Accuracy: 86.2% Mean Entropy: 72.6%
2022-05-15 16:30:10,570 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.457, Acc: 0.990, Base Lr: 1.60e-05
2022-05-15 16:31:15,654 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.456, Acc: 0.991, Base Lr: 1.60e-05
2022-05-15 16:32:00,878 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-15 16:34:58,001 reid_baseline.train INFO: normal accuracy 0.8540211759405272 0.7271003723144531 
2022-05-15 16:34:58,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-15 16:34:58,001 reid_baseline.train INFO: Accuracy: 85.4% Mean Entropy: 72.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls/transformer_best_model.pth
2022-05-15 16:37:53,730 reid_baseline.train INFO: normal accuracy 0.16338092000906412 0.9124851822853088 
2022-05-15 16:37:53,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-15 16:37:53,731 reid_baseline.train INFO: Accuracy: 16.3%
2022-05-15 16:40:40,527 reid_baseline.train INFO: normal accuracy 0.16884306987399772 0.588090717792511 
2022-05-15 16:40:40,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-15 16:40:40,527 reid_baseline.train INFO: Source Clean Accuracy: 16.9%
2022-05-15 16:40:48,312 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls
2022-05-15 16:40:48,312 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Real_World/transformer_best_model.pth')
2022-05-15 16:40:48,313 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-15 16:40:48,313 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-15 16:40:48,313 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-15 16:41:01,018 reid_baseline.train INFO: start training
2022-05-15 16:42:14,186 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.628, Acc: 0.375, Base Lr: 8.72e-04
2022-05-15 16:43:17,294 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.434, Acc: 0.500, Base Lr: 8.72e-04
2022-05-15 16:44:01,008 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.655[s] Speed: 24.4[samples/s]
2022-05-15 16:51:36,481 reid_baseline.train INFO: normal accuracy 0.3507000229515722 1.328873872756958 
2022-05-15 16:51:37,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-15 16:51:37,693 reid_baseline.train INFO: Accuracy: 35.1% Mean Entropy: 132.9%
2022-05-15 16:52:42,978 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.845, Acc: 0.840, Base Lr: 1.66e-03
2022-05-15 16:53:43,831 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.763, Acc: 0.876, Base Lr: 1.66e-03
2022-05-15 16:54:26,921 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-05-15 17:02:04,518 reid_baseline.train INFO: normal accuracy 0.46729400963966033 1.149101734161377 
2022-05-15 17:02:05,752 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-15 17:02:05,753 reid_baseline.train INFO: Accuracy: 46.7% Mean Entropy: 114.9%
2022-05-15 17:03:15,677 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.609, Acc: 0.941, Base Lr: 2.46e-03
2022-05-15 17:04:18,821 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.591, Acc: 0.948, Base Lr: 2.46e-03
2022-05-15 17:05:05,697 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.659[s] Speed: 24.3[samples/s]
2022-05-15 17:12:56,403 reid_baseline.train INFO: normal accuracy 0.5029843893480257 1.11174476146698 
2022-05-15 17:12:57,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-15 17:12:57,610 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 111.2%
2022-05-15 17:14:02,933 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.562, Acc: 0.957, Base Lr: 3.25e-03
2022-05-15 17:15:05,137 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.548, Acc: 0.963, Base Lr: 3.25e-03
2022-05-15 17:15:52,888 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.642[s] Speed: 24.9[samples/s]
2022-05-15 17:23:33,965 reid_baseline.train INFO: normal accuracy 0.619233417489098 1.0447843074798584 
2022-05-15 17:23:35,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-15 17:23:35,228 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 104.5%
2022-05-15 17:24:49,992 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.527, Acc: 0.973, Base Lr: 4.04e-03
2022-05-15 17:26:04,365 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.519, Acc: 0.976, Base Lr: 4.04e-03
2022-05-15 17:26:56,452 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.737[s] Speed: 21.7[samples/s]
2022-05-15 17:35:19,377 reid_baseline.train INFO: normal accuracy 0.6561854487032361 1.0482951402664185 
2022-05-15 17:35:19,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-15 17:35:19,378 reid_baseline.train INFO: Accuracy: 65.6% Mean Entropy: 104.8%
2022-05-15 17:36:43,813 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.522, Acc: 0.967, Base Lr: 4.83e-03
2022-05-15 17:37:58,273 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.516, Acc: 0.972, Base Lr: 4.83e-03
2022-05-15 17:38:52,497 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.780[s] Speed: 20.5[samples/s]
2022-05-15 17:47:27,564 reid_baseline.train INFO: normal accuracy 0.6908423226991048 0.9938609004020691 
2022-05-15 17:47:28,753 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-15 17:47:28,754 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 99.4%
2022-05-15 17:48:51,401 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.504, Acc: 0.979, Base Lr: 5.62e-03
2022-05-15 17:50:08,106 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.498, Acc: 0.980, Base Lr: 5.62e-03
2022-05-15 17:51:01,533 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.779[s] Speed: 20.5[samples/s]
2022-05-15 17:59:40,769 reid_baseline.train INFO: normal accuracy 0.6913013541427587 1.03212308883667 
2022-05-15 17:59:40,770 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-15 17:59:40,771 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 103.2%
2022-05-15 18:01:02,687 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.494, Acc: 0.981, Base Lr: 6.42e-03
2022-05-15 18:02:16,334 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.498, Acc: 0.979, Base Lr: 6.42e-03
2022-05-15 18:03:09,402 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.764[s] Speed: 20.9[samples/s]
2022-05-15 18:11:37,836 reid_baseline.train INFO: normal accuracy 0.7553362405324765 0.8849225640296936 
2022-05-15 18:11:39,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-15 18:11:39,103 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 88.5%
2022-05-15 18:13:05,214 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.489, Acc: 0.980, Base Lr: 7.21e-03
2022-05-15 18:14:19,825 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.489, Acc: 0.981, Base Lr: 7.21e-03
2022-05-15 18:15:15,574 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.793[s] Speed: 20.2[samples/s]
2022-05-15 18:23:48,117 reid_baseline.train INFO: normal accuracy 0.7525820518705532 0.7818079590797424 
2022-05-15 18:23:49,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-15 18:23:49,499 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 78.2%
2022-05-15 18:25:15,324 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.490, Acc: 0.978, Base Lr: 4.01e-03
2022-05-15 18:26:31,177 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.480, Acc: 0.983, Base Lr: 4.01e-03
2022-05-15 18:27:25,381 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.790[s] Speed: 20.3[samples/s]
2022-05-15 18:36:23,060 reid_baseline.train INFO: normal accuracy 0.7512049575395915 0.7957290410995483 
2022-05-15 18:36:23,060 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-15 18:36:23,061 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 79.6%
2022-05-15 18:37:50,635 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.489, Acc: 0.977, Base Lr: 3.38e-03
2022-05-15 18:39:07,929 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.479, Acc: 0.981, Base Lr: 3.38e-03
2022-05-15 18:39:55,705 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.778[s] Speed: 20.6[samples/s]
2022-05-15 18:48:37,589 reid_baseline.train INFO: normal accuracy 0.769742883379247 0.8088674545288086 
2022-05-15 18:48:37,590 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-15 18:48:37,590 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 80.9%
2022-05-15 18:50:02,213 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.468, Acc: 0.987, Base Lr: 2.77e-03
2022-05-15 18:51:19,734 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.473, Acc: 0.985, Base Lr: 2.77e-03
2022-05-15 18:52:07,679 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.769[s] Speed: 20.8[samples/s]
2022-05-15 19:00:57,328 reid_baseline.train INFO: normal accuracy 0.7548772090888226 0.8223942518234253 
2022-05-15 19:00:57,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-15 19:00:57,329 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 82.2%
2022-05-15 19:02:19,810 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.466, Acc: 0.988, Base Lr: 2.20e-03
2022-05-15 19:03:29,565 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.463, Acc: 0.989, Base Lr: 2.20e-03
2022-05-15 19:04:12,495 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-15 19:13:06,174 reid_baseline.train INFO: normal accuracy 0.7569428505852651 0.8138585686683655 
2022-05-15 19:13:06,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-15 19:13:06,175 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 81.4%
2022-05-15 19:14:32,014 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.467, Acc: 0.986, Base Lr: 1.66e-03
2022-05-15 19:15:39,096 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.466, Acc: 0.987, Base Lr: 1.66e-03
2022-05-15 19:16:25,116 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.728[s] Speed: 22.0[samples/s]
2022-05-15 19:25:15,240 reid_baseline.train INFO: normal accuracy 0.768259072117593 0.7686545252799988 
2022-05-15 19:25:16,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-15 19:25:16,611 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 76.9%
2022-05-15 19:26:36,253 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.461, Acc: 0.992, Base Lr: 1.19e-03
2022-05-15 19:27:43,122 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.463, Acc: 0.989, Base Lr: 1.19e-03
2022-05-15 19:28:29,277 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-05-15 19:37:16,841 reid_baseline.train INFO: normal accuracy 0.7578609134725729 0.7756502628326416 
2022-05-15 19:37:16,842 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-15 19:37:16,842 reid_baseline.train INFO: Accuracy: 75.8% Mean Entropy: 77.6%
2022-05-15 19:38:38,201 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.466, Acc: 0.988, Base Lr: 7.78e-04
2022-05-15 19:39:47,915 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.468, Acc: 0.986, Base Lr: 7.78e-04
2022-05-15 19:40:39,117 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.741[s] Speed: 21.6[samples/s]
2022-05-15 19:49:16,023 reid_baseline.train INFO: normal accuracy 0.7831076428735368 0.7774896621704102 
2022-05-15 19:49:16,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-15 19:49:16,024 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 77.7%
2022-05-15 19:50:35,440 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.460, Acc: 0.990, Base Lr: 4.51e-04
2022-05-15 19:51:40,311 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.461, Acc: 0.989, Base Lr: 4.51e-04
2022-05-15 19:52:31,383 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-15 20:01:04,047 reid_baseline.train INFO: normal accuracy 0.7809414466130884 0.7737889885902405 
2022-05-15 20:01:04,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-15 20:01:04,048 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 77.4%
2022-05-15 20:02:25,414 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.461, Acc: 0.987, Base Lr: 2.11e-04
2022-05-15 20:03:35,043 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.459, Acc: 0.988, Base Lr: 2.11e-04
2022-05-15 20:04:28,142 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.747[s] Speed: 21.4[samples/s]
