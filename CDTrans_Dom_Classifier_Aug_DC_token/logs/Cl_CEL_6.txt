2022-04-23 10:34:50,675 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_7
2022-04-23 10:34:50,675 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=7)
2022-04-23 10:34:50,675 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 10:34:50,675 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 10:34:50,676 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 10:35:00,779 reid_baseline.train INFO: start training
2022-04-23 10:35:32,509 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.063, Acc: 0.220, Base Lr: 8.72e-04
2022-04-23 10:35:55,585 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.993, Acc: 0.332, Base Lr: 8.72e-04
2022-04-23 10:36:11,846 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.257[s] Speed: 62.3[samples/s]
2022-04-23 10:36:41,715 reid_baseline.train INFO: normal accuracy 0.48784507622579315 4.170917987823486 
2022-04-23 10:37:11,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 10:37:11,980 reid_baseline.train INFO: Accuracy: 48.8% Mean Entropy: 417.1%
2022-04-23 10:37:37,598 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.705, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 10:38:01,495 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.588, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 10:38:20,934 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.253[s] Speed: 63.4[samples/s]
2022-04-23 10:38:50,446 reid_baseline.train INFO: normal accuracy 0.5175113308611454 4.1349778175354 
2022-04-23 10:39:20,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 10:39:20,404 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 413.5%
2022-04-23 10:39:46,653 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.043, Acc: 0.576, Base Lr: 2.46e-03
2022-04-23 10:40:12,291 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.886, Acc: 0.577, Base Lr: 2.46e-03
2022-04-23 10:40:29,331 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.252[s] Speed: 63.4[samples/s]
2022-04-23 10:40:57,458 reid_baseline.train INFO: normal accuracy 0.5698393077873919 3.8350038528442383 
2022-04-23 10:41:27,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 10:41:27,420 reid_baseline.train INFO: Accuracy: 57.0% Mean Entropy: 383.5%
2022-04-23 10:41:52,704 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.222, Acc: 0.618, Base Lr: 3.25e-03
2022-04-23 10:42:15,794 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.098, Acc: 0.649, Base Lr: 3.25e-03
2022-04-23 10:42:33,024 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-23 10:43:02,932 reid_baseline.train INFO: normal accuracy 0.6370004120313144 3.22900128364563 
2022-04-23 10:43:46,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 10:43:46,337 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 322.9%
2022-04-23 10:44:11,667 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.688, Acc: 0.722, Base Lr: 4.04e-03
2022-04-23 10:44:35,648 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.624, Acc: 0.720, Base Lr: 4.04e-03
2022-04-23 10:44:52,665 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-23 10:45:21,142 reid_baseline.train INFO: normal accuracy 0.681087762669963 2.8034400939941406 
2022-04-23 10:45:51,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 10:45:51,156 reid_baseline.train INFO: Accuracy: 68.1% Mean Entropy: 280.3%
2022-04-23 10:46:18,315 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.387, Acc: 0.774, Base Lr: 4.83e-03
2022-04-23 10:46:42,799 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.374, Acc: 0.774, Base Lr: 4.83e-03
2022-04-23 10:46:59,533 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.250[s] Speed: 63.9[samples/s]
2022-04-23 10:47:29,553 reid_baseline.train INFO: normal accuracy 0.7140502678203543 2.5048227310180664 
2022-04-23 10:47:59,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 10:47:59,541 reid_baseline.train INFO: Accuracy: 71.4% Mean Entropy: 250.5%
2022-04-23 10:48:25,883 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.255, Acc: 0.800, Base Lr: 5.62e-03
2022-04-23 10:48:49,199 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.226, Acc: 0.813, Base Lr: 5.62e-03
2022-04-23 10:49:07,033 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-23 10:49:37,730 reid_baseline.train INFO: normal accuracy 0.7177585496497734 2.3024394512176514 
2022-04-23 10:50:33,181 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 10:50:33,181 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 230.2%
2022-04-23 10:51:00,156 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.144, Acc: 0.839, Base Lr: 6.42e-03
2022-04-23 10:51:24,218 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.128, Acc: 0.838, Base Lr: 6.42e-03
2022-04-23 10:51:41,449 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.250[s] Speed: 64.0[samples/s]
2022-04-23 10:52:09,090 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.160733938217163 
2022-04-23 10:52:39,088 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 10:52:39,089 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 216.1%
2022-04-23 10:53:05,776 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.062, Acc: 0.851, Base Lr: 7.21e-03
2022-04-23 10:53:29,768 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.054, Acc: 0.851, Base Lr: 7.21e-03
2022-04-23 10:53:47,646 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.251[s] Speed: 63.8[samples/s]
2022-04-23 10:54:15,534 reid_baseline.train INFO: normal accuracy 0.7284713638236506 2.097029209136963 
2022-04-23 10:54:45,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 10:54:45,527 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 209.7%
2022-04-23 10:55:10,009 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.966, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 10:55:34,416 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.948, Acc: 0.883, Base Lr: 4.01e-03
2022-04-23 10:55:52,913 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.247[s] Speed: 64.8[samples/s]
2022-04-23 10:57:14,176 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.0122835636138916 
2022-04-23 10:57:44,162 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 10:57:44,163 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 201.2%
2022-04-23 10:58:09,412 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.923, Acc: 0.893, Base Lr: 3.38e-03
2022-04-23 10:58:33,712 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.939, Acc: 0.886, Base Lr: 3.38e-03
2022-04-23 10:58:51,267 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.245[s] Speed: 65.2[samples/s]
2022-04-23 10:59:23,519 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9516669511795044 
2022-04-23 11:00:21,069 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 11:00:21,076 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 195.2%
2022-04-23 11:00:47,705 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.939, Acc: 0.877, Base Lr: 2.77e-03
2022-04-23 11:01:13,371 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.900, Acc: 0.892, Base Lr: 2.77e-03
2022-04-23 11:01:31,296 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.257[s] Speed: 62.2[samples/s]
2022-04-23 11:01:59,590 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.9449752569198608 
2022-04-23 11:02:29,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 11:02:29,579 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 194.5%
2022-04-23 11:02:56,781 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.919, Acc: 0.887, Base Lr: 2.20e-03
2022-04-23 11:03:20,941 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.899, Acc: 0.897, Base Lr: 2.20e-03
2022-04-23 11:03:38,171 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-23 11:04:07,417 reid_baseline.train INFO: normal accuracy 0.7334157395962093 1.9923486709594727 
2022-04-23 11:04:07,417 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 11:04:07,417 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 199.2%
2022-04-23 11:04:33,100 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.884, Acc: 0.893, Base Lr: 1.66e-03
2022-04-23 11:04:57,376 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.856, Acc: 0.902, Base Lr: 1.66e-03
2022-04-23 11:05:15,393 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.248[s] Speed: 64.4[samples/s]
2022-04-23 11:05:43,199 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.9747461080551147 
2022-04-23 11:05:43,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 11:05:43,202 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 197.5%
2022-04-23 11:06:10,069 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.845, Acc: 0.918, Base Lr: 1.19e-03
2022-04-23 11:06:34,294 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.865, Acc: 0.911, Base Lr: 1.19e-03
2022-04-23 11:06:51,827 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.251[s] Speed: 63.7[samples/s]
2022-04-23 11:07:23,110 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9641021490097046 
2022-04-23 11:07:23,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 11:07:23,111 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 196.4%
2022-04-23 11:07:47,960 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.876, Acc: 0.908, Base Lr: 7.78e-04
2022-04-23 11:08:12,089 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.869, Acc: 0.910, Base Lr: 7.78e-04
2022-04-23 11:08:29,417 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.243[s] Speed: 65.9[samples/s]
2022-04-23 11:08:58,097 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9276401996612549 
2022-04-23 11:09:30,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 11:09:30,701 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 192.8%
2022-04-23 11:09:56,429 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.853, Acc: 0.905, Base Lr: 4.51e-04
2022-04-23 11:10:20,180 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.835, Acc: 0.903, Base Lr: 4.51e-04
2022-04-23 11:10:38,432 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.247[s] Speed: 64.7[samples/s]
2022-04-23 11:11:06,376 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.9343310594558716 
2022-04-23 11:11:06,376 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 11:11:06,377 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 193.4%
2022-04-23 11:11:32,052 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.824, Acc: 0.916, Base Lr: 2.11e-04
2022-04-23 11:11:54,966 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.822, Acc: 0.916, Base Lr: 2.11e-04
2022-04-23 11:12:12,460 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-23 11:12:41,981 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9216187000274658 
2022-04-23 11:13:28,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 11:13:28,399 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 192.2%
2022-04-23 11:13:53,547 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.827, Acc: 0.919, Base Lr: 6.51e-05
2022-04-23 11:14:16,559 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.823, Acc: 0.913, Base Lr: 6.51e-05
2022-04-23 11:14:33,895 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.240[s] Speed: 66.7[samples/s]
2022-04-23 11:15:03,771 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.9160799980163574 
2022-04-23 11:15:33,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 11:15:33,781 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 191.6%
2022-04-23 11:15:59,369 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.824, Acc: 0.918, Base Lr: 1.60e-05
2022-04-23 11:16:23,807 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.820, Acc: 0.917, Base Lr: 1.60e-05
2022-04-23 11:16:41,054 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.246[s] Speed: 64.9[samples/s]
2022-04-23 11:17:39,703 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8740352392196655 
2022-04-23 11:18:09,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 11:18:09,679 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 187.4%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_7/transformer_best_model.pth
2022-04-23 11:19:08,228 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8740352392196655 
2022-04-23 11:19:08,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 11:19:08,228 reid_baseline.train INFO: Accuracy: 74.0%
2022-04-23 11:19:35,995 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8740352392196655 
2022-04-23 11:19:35,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 11:19:35,995 reid_baseline.train INFO: Shuffled Accuracy: 74.0%
2022-04-23 11:20:12,538 reid_baseline.train INFO: normal accuracy 0.9452462772050401 0.859307050704956 
2022-04-23 11:20:12,538 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 11:20:12,539 reid_baseline.train INFO: Source Clean Accuracy: 94.5%
2022-04-23 11:20:17,798 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_7
2022-04-23 11:20:17,798 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=7)
2022-04-23 11:20:17,798 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 11:20:17,798 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 11:20:17,799 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 11:20:27,257 reid_baseline.train INFO: start training
2022-04-23 11:21:01,714 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.063, Acc: 0.220, Base Lr: 8.72e-04
2022-04-23 11:21:25,619 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.993, Acc: 0.333, Base Lr: 8.72e-04
2022-04-23 11:21:43,805 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.278[s] Speed: 57.6[samples/s]
2022-04-23 11:22:21,317 reid_baseline.train INFO: normal accuracy 0.5345798603289029 4.170220375061035 
2022-04-23 11:22:51,270 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 11:22:51,270 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 417.0%
2022-04-23 11:23:17,489 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.705, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 11:23:40,892 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.588, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 11:23:59,039 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.248[s] Speed: 64.6[samples/s]
2022-04-23 11:24:36,081 reid_baseline.train INFO: normal accuracy 0.5638657355260194 4.121324062347412 
2022-04-23 11:25:06,092 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 11:25:06,092 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 412.1%
2022-04-23 11:25:34,809 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.041, Acc: 0.577, Base Lr: 2.46e-03
2022-04-23 11:25:59,741 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.884, Acc: 0.576, Base Lr: 2.46e-03
2022-04-23 11:26:17,279 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.261[s] Speed: 61.4[samples/s]
2022-04-23 11:26:54,691 reid_baseline.train INFO: normal accuracy 0.603514305023654 3.721787691116333 
2022-04-23 11:27:24,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 11:27:24,666 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 372.2%
2022-04-23 11:27:53,847 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.220, Acc: 0.620, Base Lr: 3.25e-03
2022-04-23 11:28:24,592 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.096, Acc: 0.649, Base Lr: 3.25e-03
2022-04-23 11:28:45,971 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.298[s] Speed: 53.7[samples/s]
2022-04-23 11:29:31,876 reid_baseline.train INFO: normal accuracy 0.6690696102725839 2.982513666152954 
2022-04-23 11:30:01,856 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 11:30:01,857 reid_baseline.train INFO: Accuracy: 66.9% Mean Entropy: 298.3%
2022-04-23 11:30:35,084 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.688, Acc: 0.728, Base Lr: 4.04e-03
2022-04-23 11:31:06,539 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.624, Acc: 0.723, Base Lr: 4.04e-03
2022-04-23 11:31:30,969 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.326[s] Speed: 49.0[samples/s]
2022-04-23 11:32:15,092 reid_baseline.train INFO: normal accuracy 0.6988060373958098 2.491365432739258 
2022-04-23 11:32:45,116 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 11:32:45,117 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 249.1%
2022-04-23 11:33:18,154 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.389, Acc: 0.775, Base Lr: 4.83e-03
2022-04-23 11:33:50,674 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.375, Acc: 0.774, Base Lr: 4.83e-03
2022-04-23 11:34:13,254 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-23 11:35:01,128 reid_baseline.train INFO: normal accuracy 0.7253886010362695 2.2044951915740967 
2022-04-23 11:35:39,837 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 11:35:39,844 reid_baseline.train INFO: Accuracy: 72.5% Mean Entropy: 220.4%
2022-04-23 11:36:11,070 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.255, Acc: 0.800, Base Lr: 5.62e-03
2022-04-23 11:36:41,342 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.226, Acc: 0.809, Base Lr: 5.62e-03
2022-04-23 11:37:06,057 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.315[s] Speed: 50.7[samples/s]
2022-04-23 11:37:54,992 reid_baseline.train INFO: normal accuracy 0.7395809867087182 2.0000998973846436 
2022-04-23 11:38:24,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 11:38:24,980 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 200.0%
2022-04-23 11:38:57,618 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.143, Acc: 0.843, Base Lr: 6.42e-03
2022-04-23 11:39:29,576 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.129, Acc: 0.837, Base Lr: 6.42e-03
2022-04-23 11:39:51,949 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-23 11:40:36,307 reid_baseline.train INFO: normal accuracy 0.7458887136742509 1.9101375341415405 
2022-04-23 11:41:06,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 11:41:06,288 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 191.0%
2022-04-23 11:41:41,603 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.062, Acc: 0.851, Base Lr: 7.21e-03
2022-04-23 11:42:13,638 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.054, Acc: 0.848, Base Lr: 7.21e-03
2022-04-23 11:42:35,086 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-23 11:43:18,925 reid_baseline.train INFO: normal accuracy 0.758954719531426 1.8718898296356201 
2022-04-23 11:43:48,896 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 11:43:48,897 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 187.2%
2022-04-23 11:44:21,122 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.967, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 11:44:52,462 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.949, Acc: 0.885, Base Lr: 4.01e-03
2022-04-23 11:45:14,975 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.315[s] Speed: 50.8[samples/s]
2022-04-23 11:46:28,651 reid_baseline.train INFO: normal accuracy 0.758954719531426 1.84441077709198 
2022-04-23 11:46:58,622 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 11:46:58,623 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 184.4%
2022-04-23 11:47:31,170 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.924, Acc: 0.895, Base Lr: 3.38e-03
2022-04-23 11:48:02,332 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.939, Acc: 0.888, Base Lr: 3.38e-03
2022-04-23 11:48:25,130 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-23 11:49:12,908 reid_baseline.train INFO: normal accuracy 0.7627844109033566 1.758219838142395 
2022-04-23 11:50:00,816 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 11:50:00,822 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 175.8%
2022-04-23 11:50:33,767 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.941, Acc: 0.876, Base Lr: 2.77e-03
2022-04-23 11:51:04,026 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.901, Acc: 0.891, Base Lr: 2.77e-03
2022-04-23 11:51:27,174 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.316[s] Speed: 50.6[samples/s]
2022-04-23 11:52:13,311 reid_baseline.train INFO: normal accuracy 0.7654877224600135 1.7487866878509521 
2022-04-23 11:52:43,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 11:52:43,319 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 174.9%
2022-04-23 11:53:18,208 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.919, Acc: 0.887, Base Lr: 2.20e-03
2022-04-23 11:53:48,342 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.900, Acc: 0.896, Base Lr: 2.20e-03
2022-04-23 11:54:09,939 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-23 11:54:58,671 reid_baseline.train INFO: normal accuracy 0.7684163099797252 1.7968602180480957 
2022-04-23 11:54:58,672 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 11:54:58,672 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 179.7%
2022-04-23 11:55:31,188 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.886, Acc: 0.896, Base Lr: 1.66e-03
2022-04-23 11:56:01,162 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.857, Acc: 0.903, Base Lr: 1.66e-03
2022-04-23 11:56:25,031 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.316[s] Speed: 50.6[samples/s]
2022-04-23 11:57:13,937 reid_baseline.train INFO: normal accuracy 0.7688668619058346 1.801121473312378 
2022-04-23 11:57:13,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 11:57:13,945 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 180.1%
2022-04-23 11:57:46,311 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.845, Acc: 0.920, Base Lr: 1.19e-03
2022-04-23 11:58:17,152 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.865, Acc: 0.911, Base Lr: 1.19e-03
2022-04-23 11:58:39,847 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.315[s] Speed: 50.8[samples/s]
2022-04-23 11:59:26,428 reid_baseline.train INFO: normal accuracy 0.7686415859427799 1.8083852529525757 
2022-04-23 11:59:26,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 11:59:26,429 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 180.8%
2022-04-23 12:00:00,092 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.878, Acc: 0.907, Base Lr: 7.78e-04
2022-04-23 12:00:32,375 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.869, Acc: 0.910, Base Lr: 7.78e-04
2022-04-23 12:00:53,504 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-23 12:01:37,552 reid_baseline.train INFO: normal accuracy 0.7733723811669295 1.7621937990188599 
2022-04-23 12:01:37,553 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 12:01:37,553 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 176.2%
2022-04-23 12:02:10,110 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.850, Acc: 0.903, Base Lr: 4.51e-04
2022-04-23 12:02:40,772 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.833, Acc: 0.903, Base Lr: 4.51e-04
2022-04-23 12:03:04,121 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-23 12:03:51,237 reid_baseline.train INFO: normal accuracy 0.7706690696102726 1.7738853693008423 
2022-04-23 12:03:51,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 12:03:51,238 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 177.4%
2022-04-23 12:04:24,143 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.825, Acc: 0.916, Base Lr: 2.11e-04
2022-04-23 12:04:54,090 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.822, Acc: 0.915, Base Lr: 2.11e-04
2022-04-23 12:05:15,680 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.309[s] Speed: 51.7[samples/s]
2022-04-23 12:06:01,587 reid_baseline.train INFO: normal accuracy 0.7735976571299842 1.7698662281036377 
2022-04-23 12:06:01,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 12:06:01,588 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 177.0%
2022-04-23 12:06:34,482 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.824, Acc: 0.920, Base Lr: 6.51e-05
2022-04-23 12:07:04,962 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.822, Acc: 0.911, Base Lr: 6.51e-05
2022-04-23 12:07:28,642 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-23 12:08:13,939 reid_baseline.train INFO: normal accuracy 0.770218517684163 1.7399224042892456 
2022-04-23 12:08:45,761 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 12:08:45,761 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 174.0%
2022-04-23 12:09:18,578 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.823, Acc: 0.920, Base Lr: 1.60e-05
2022-04-23 12:09:49,232 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.820, Acc: 0.916, Base Lr: 1.60e-05
2022-04-23 12:10:11,453 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-23 12:11:27,406 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.7061877250671387 
2022-04-23 12:12:16,079 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 12:12:16,079 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 170.6%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_7/transformer_best_model.pth
2022-04-23 12:13:32,525 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.7061877250671387 
2022-04-23 12:13:32,525 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 12:13:32,526 reid_baseline.train INFO: Accuracy: 77.0%
2022-04-23 12:14:17,025 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.7061877250671387 
2022-04-23 12:14:17,026 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 12:14:17,026 reid_baseline.train INFO: Shuffled Accuracy: 77.0%
2022-04-23 12:15:01,934 reid_baseline.train INFO: normal accuracy 0.9466208476517755 0.8553222417831421 
2022-04-23 12:15:01,935 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 12:15:01,935 reid_baseline.train INFO: Source Clean Accuracy: 94.7%
2022-04-23 12:15:08,068 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_7
2022-04-23 12:15:08,068 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_7', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=7)
2022-04-23 12:15:08,069 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 12:15:08,069 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 12:15:08,069 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_7
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 12:15:17,286 reid_baseline.train INFO: start training
2022-04-23 12:15:57,012 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.063, Acc: 0.220, Base Lr: 8.72e-04
2022-04-23 12:16:27,512 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.993, Acc: 0.332, Base Lr: 8.72e-04
2022-04-23 12:16:50,577 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-23 12:18:47,314 reid_baseline.train INFO: normal accuracy 0.5510672481064953 4.170698165893555 
2022-04-23 12:19:43,360 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 12:19:43,361 reid_baseline.train INFO: Accuracy: 55.1% Mean Entropy: 417.1%
2022-04-23 12:20:16,592 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.705, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 12:20:47,537 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.588, Acc: 0.540, Base Lr: 1.66e-03
2022-04-23 12:21:11,498 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-23 12:23:10,295 reid_baseline.train INFO: normal accuracy 0.5797567133348634 4.128793239593506 
2022-04-23 12:23:45,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 12:23:45,759 reid_baseline.train INFO: Accuracy: 58.0% Mean Entropy: 412.9%
2022-04-23 12:24:20,774 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.043, Acc: 0.576, Base Lr: 2.46e-03
2022-04-23 12:24:52,875 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.886, Acc: 0.577, Base Lr: 2.46e-03
2022-04-23 12:25:16,549 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-23 12:27:21,408 reid_baseline.train INFO: normal accuracy 0.6203809960982327 3.7517290115356445 
2022-04-23 12:28:16,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 12:28:16,999 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 375.2%
2022-04-23 12:29:10,043 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.222, Acc: 0.619, Base Lr: 3.25e-03
2022-04-23 12:29:46,252 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.098, Acc: 0.651, Base Lr: 3.25e-03
2022-04-23 12:30:25,714 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.471[s] Speed: 34.0[samples/s]
2022-04-23 12:32:30,216 reid_baseline.train INFO: normal accuracy 0.6887766812026623 3.043058395385742 
2022-04-23 12:33:30,868 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 12:33:30,869 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 304.3%
2022-04-23 12:34:05,229 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.690, Acc: 0.725, Base Lr: 4.04e-03
2022-04-23 12:34:36,278 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.625, Acc: 0.722, Base Lr: 4.04e-03
2022-04-23 12:34:59,910 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-23 12:36:58,004 reid_baseline.train INFO: normal accuracy 0.7310075740188203 2.5612077713012695 
2022-04-23 12:37:28,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 12:37:28,014 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 256.1%
2022-04-23 12:38:02,104 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.386, Acc: 0.774, Base Lr: 4.83e-03
2022-04-23 12:38:34,445 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.374, Acc: 0.774, Base Lr: 4.83e-03
2022-04-23 12:38:56,800 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-23 12:40:59,556 reid_baseline.train INFO: normal accuracy 0.7555657562543034 2.2569942474365234 
2022-04-23 12:41:29,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 12:41:29,547 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 225.7%
2022-04-23 12:42:00,567 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.253, Acc: 0.796, Base Lr: 5.62e-03
2022-04-23 12:42:33,239 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.225, Acc: 0.809, Base Lr: 5.62e-03
2022-04-23 12:42:55,025 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.313[s] Speed: 51.1[samples/s]
2022-04-23 12:44:44,826 reid_baseline.train INFO: normal accuracy 0.7693366995639201 2.0663700103759766 
2022-04-23 12:45:14,817 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 12:45:14,817 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 206.6%
2022-04-23 12:45:50,071 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.144, Acc: 0.841, Base Lr: 6.42e-03
2022-04-23 12:46:21,486 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.128, Acc: 0.837, Base Lr: 6.42e-03
2022-04-23 12:46:45,013 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-23 12:48:38,185 reid_baseline.train INFO: normal accuracy 0.7775992655496902 1.9425228834152222 
2022-04-23 12:49:08,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 12:49:08,143 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 194.3%
2022-04-23 12:49:41,689 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.060, Acc: 0.853, Base Lr: 7.21e-03
2022-04-23 12:50:10,495 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.054, Acc: 0.851, Base Lr: 7.21e-03
2022-04-23 12:50:33,986 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.314[s] Speed: 50.9[samples/s]
2022-04-23 12:52:31,713 reid_baseline.train INFO: normal accuracy 0.7819600642644021 1.8832885026931763 
2022-04-23 12:53:01,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 12:53:01,704 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 188.3%
2022-04-23 12:53:35,067 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.967, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 12:54:04,915 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.948, Acc: 0.883, Base Lr: 4.01e-03
2022-04-23 12:54:26,287 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.310[s] Speed: 51.6[samples/s]
2022-04-23 12:56:52,912 reid_baseline.train INFO: normal accuracy 0.7787468441588249 1.840586543083191 
2022-04-23 12:57:22,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 12:57:22,906 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 184.1%
2022-04-23 12:57:54,206 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.923, Acc: 0.896, Base Lr: 3.38e-03
2022-04-23 12:58:26,189 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.940, Acc: 0.888, Base Lr: 3.38e-03
2022-04-23 12:58:50,080 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-23 13:00:49,982 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.7653454542160034 
2022-04-23 13:01:21,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 13:01:21,797 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 176.5%
2022-04-23 13:01:53,110 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.940, Acc: 0.877, Base Lr: 2.77e-03
2022-04-23 13:02:24,207 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.901, Acc: 0.892, Base Lr: 2.77e-03
2022-04-23 13:02:47,077 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.312[s] Speed: 51.2[samples/s]
2022-04-23 13:04:55,116 reid_baseline.train INFO: normal accuracy 0.7844847372044985 1.7720816135406494 
2022-04-23 13:04:55,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 13:04:55,117 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 177.2%
2022-04-23 13:05:28,805 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.918, Acc: 0.889, Base Lr: 2.20e-03
2022-04-23 13:05:58,920 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.899, Acc: 0.897, Base Lr: 2.20e-03
2022-04-23 13:06:21,316 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.315[s] Speed: 50.8[samples/s]
2022-04-23 13:08:21,781 reid_baseline.train INFO: normal accuracy 0.7902226302501721 1.8266147375106812 
2022-04-23 13:08:21,782 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 13:08:21,782 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 182.7%
2022-04-23 13:08:54,709 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.886, Acc: 0.896, Base Lr: 1.66e-03
2022-04-23 13:09:25,125 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.858, Acc: 0.903, Base Lr: 1.66e-03
2022-04-23 13:09:45,890 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.308[s] Speed: 51.9[samples/s]
2022-04-23 13:11:40,899 reid_baseline.train INFO: normal accuracy 0.7879274730319027 1.8086817264556885 
2022-04-23 13:11:40,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 13:11:40,900 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 180.9%
2022-04-23 13:12:15,252 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.844, Acc: 0.919, Base Lr: 1.19e-03
2022-04-23 13:12:48,141 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.865, Acc: 0.911, Base Lr: 1.19e-03
2022-04-23 13:13:10,549 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-23 13:15:05,042 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.8084498643875122 
2022-04-23 13:15:05,044 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 13:15:05,044 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 180.8%
2022-04-23 13:15:38,315 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.878, Acc: 0.910, Base Lr: 7.78e-04
2022-04-23 13:16:10,653 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.869, Acc: 0.911, Base Lr: 7.78e-04
2022-04-23 13:16:34,850 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-23 13:18:23,952 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.769173264503479 
2022-04-23 13:18:23,954 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 13:18:23,954 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 176.9%
2022-04-23 13:18:58,046 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.853, Acc: 0.904, Base Lr: 4.51e-04
2022-04-23 13:19:29,724 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.835, Acc: 0.904, Base Lr: 4.51e-04
2022-04-23 13:19:53,765 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-23 13:21:46,692 reid_baseline.train INFO: normal accuracy 0.7879274730319027 1.7778878211975098 
2022-04-23 13:21:46,694 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 13:21:46,695 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 177.8%
2022-04-23 13:22:20,864 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.825, Acc: 0.916, Base Lr: 2.11e-04
2022-04-23 13:22:52,354 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.823, Acc: 0.915, Base Lr: 2.11e-04
2022-04-23 13:23:12,528 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.314[s] Speed: 50.9[samples/s]
2022-04-23 13:25:09,447 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7779139280319214 
2022-04-23 13:25:09,448 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 13:25:09,448 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 177.8%
2022-04-23 13:25:42,716 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.825, Acc: 0.921, Base Lr: 6.51e-05
2022-04-23 13:26:13,920 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.822, Acc: 0.913, Base Lr: 6.51e-05
2022-04-23 13:26:37,757 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-23 13:28:35,438 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.7526586055755615 
2022-04-23 13:29:27,626 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 13:29:27,633 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 175.3%
2022-04-23 13:30:01,415 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.824, Acc: 0.918, Base Lr: 1.60e-05
2022-04-23 13:30:33,138 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.820, Acc: 0.915, Base Lr: 1.60e-05
2022-04-23 13:30:57,479 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-23 13:33:25,888 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.7114683389663696 
2022-04-23 13:33:59,052 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 13:33:59,052 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 171.1%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_7/transformer_best_model.pth
2022-04-23 13:36:27,635 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.7114683389663696 
2022-04-23 13:36:27,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 13:36:27,636 reid_baseline.train INFO: Accuracy: 79.0%
2022-04-23 13:38:22,870 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.7114683389663696 
2022-04-23 13:38:22,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 13:38:22,871 reid_baseline.train INFO: Shuffled Accuracy: 79.0%
2022-04-23 13:39:11,023 reid_baseline.train INFO: normal accuracy 0.9457044673539519 0.8575485348701477 
2022-04-23 13:39:11,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 13:39:11,023 reid_baseline.train INFO: Source Clean Accuracy: 94.6%
2022-04-23 13:39:17,135 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_8
2022-04-23 13:39:17,136 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=8)
2022-04-23 13:39:17,136 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 13:39:17,136 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 13:39:17,137 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 13:39:26,204 reid_baseline.train INFO: start training
2022-04-23 13:40:04,259 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.052, Acc: 0.207, Base Lr: 8.72e-04
2022-04-23 13:40:35,831 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.994, Acc: 0.323, Base Lr: 8.72e-04
2022-04-23 13:40:57,869 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-23 13:41:33,208 reid_baseline.train INFO: normal accuracy 0.492377420683972 4.171163558959961 
2022-04-23 13:42:03,130 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 13:42:03,131 reid_baseline.train INFO: Accuracy: 49.2% Mean Entropy: 417.1%
2022-04-23 13:42:37,811 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.733, Acc: 0.543, Base Lr: 1.66e-03
2022-04-23 13:43:10,727 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.617, Acc: 0.542, Base Lr: 1.66e-03
2022-04-23 13:43:33,475 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.331[s] Speed: 48.3[samples/s]
2022-04-23 13:44:10,681 reid_baseline.train INFO: normal accuracy 0.5212196126905645 4.135204315185547 
2022-04-23 13:44:40,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 13:44:40,677 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 413.5%
2022-04-23 13:45:12,841 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.070, Acc: 0.579, Base Lr: 2.46e-03
2022-04-23 13:45:43,258 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.901, Acc: 0.578, Base Lr: 2.46e-03
2022-04-23 13:46:06,328 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-23 13:46:40,678 reid_baseline.train INFO: normal accuracy 0.5793160280181294 3.835158348083496 
2022-04-23 13:47:10,666 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 13:47:10,667 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 383.5%
2022-04-23 13:47:41,604 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.217, Acc: 0.626, Base Lr: 3.25e-03
2022-04-23 13:48:10,861 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.098, Acc: 0.651, Base Lr: 3.25e-03
2022-04-23 13:48:32,284 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-23 13:49:09,328 reid_baseline.train INFO: normal accuracy 0.6431808817470128 3.224196434020996 
2022-04-23 13:49:39,307 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 13:49:39,307 reid_baseline.train INFO: Accuracy: 64.3% Mean Entropy: 322.4%
2022-04-23 13:50:11,114 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.684, Acc: 0.725, Base Lr: 4.04e-03
2022-04-23 13:50:40,798 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.643, Acc: 0.723, Base Lr: 4.04e-03
2022-04-23 13:51:01,959 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.303[s] Speed: 52.9[samples/s]
2022-04-23 13:51:37,366 reid_baseline.train INFO: normal accuracy 0.6827358879274825 2.791764497756958 
2022-04-23 13:52:07,373 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 13:52:07,374 reid_baseline.train INFO: Accuracy: 68.3% Mean Entropy: 279.2%
2022-04-23 13:52:38,866 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.405, Acc: 0.785, Base Lr: 4.83e-03
2022-04-23 13:53:08,123 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.392, Acc: 0.777, Base Lr: 4.83e-03
2022-04-23 13:53:29,111 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.299[s] Speed: 53.4[samples/s]
2022-04-23 13:54:04,284 reid_baseline.train INFO: normal accuracy 0.7091058920477956 2.4770796298980713 
2022-04-23 13:54:34,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 13:54:34,265 reid_baseline.train INFO: Accuracy: 70.9% Mean Entropy: 247.7%
2022-04-23 13:55:06,133 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.264, Acc: 0.792, Base Lr: 5.62e-03
2022-04-23 13:55:36,422 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.236, Acc: 0.808, Base Lr: 5.62e-03
2022-04-23 13:55:56,925 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.303[s] Speed: 52.8[samples/s]
2022-04-23 13:56:30,732 reid_baseline.train INFO: normal accuracy 0.715698393077874 2.300156593322754 
2022-04-23 13:57:05,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 13:57:05,171 reid_baseline.train INFO: Accuracy: 71.6% Mean Entropy: 230.0%
2022-04-23 13:57:38,682 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.138, Acc: 0.835, Base Lr: 6.42e-03
2022-04-23 13:58:06,789 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.141, Acc: 0.830, Base Lr: 6.42e-03
2022-04-23 13:58:25,968 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.296[s] Speed: 54.1[samples/s]
2022-04-23 13:59:00,804 reid_baseline.train INFO: normal accuracy 0.7325916769674495 2.149801731109619 
2022-04-23 13:59:30,787 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 13:59:30,788 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 215.0%
2022-04-23 14:00:01,879 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.063, Acc: 0.847, Base Lr: 7.21e-03
2022-04-23 14:00:28,910 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.062, Acc: 0.848, Base Lr: 7.21e-03
2022-04-23 14:00:48,395 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.284[s] Speed: 56.3[samples/s]
2022-04-23 14:01:20,891 reid_baseline.train INFO: normal accuracy 0.7235269880510918 2.087453842163086 
2022-04-23 14:01:50,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 14:01:50,878 reid_baseline.train INFO: Accuracy: 72.4% Mean Entropy: 208.7%
2022-04-23 14:02:22,655 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.997, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 14:02:51,783 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.970, Acc: 0.883, Base Lr: 4.01e-03
2022-04-23 14:03:12,941 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-23 14:04:18,693 reid_baseline.train INFO: normal accuracy 0.7354758961681088 2.0484273433685303 
2022-04-23 14:04:48,702 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 14:04:48,703 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 204.8%
2022-04-23 14:05:20,001 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.936, Acc: 0.894, Base Lr: 3.38e-03
2022-04-23 14:05:48,290 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.952, Acc: 0.885, Base Lr: 3.38e-03
2022-04-23 14:06:08,899 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.293[s] Speed: 54.5[samples/s]
2022-04-23 14:06:43,570 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.9753799438476562 
2022-04-23 14:07:13,595 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 14:07:13,595 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 197.5%
2022-04-23 14:07:45,532 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.963, Acc: 0.879, Base Lr: 2.77e-03
2022-04-23 14:08:14,299 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.922, Acc: 0.893, Base Lr: 2.77e-03
2022-04-23 14:08:34,904 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.298[s] Speed: 53.7[samples/s]
2022-04-23 14:09:10,454 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.9538013935089111 
2022-04-23 14:09:40,428 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 14:09:40,429 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 195.4%
2022-04-23 14:10:12,520 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.916, Acc: 0.893, Base Lr: 2.20e-03
2022-04-23 14:10:38,669 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.905, Acc: 0.899, Base Lr: 2.20e-03
2022-04-23 14:10:57,468 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.282[s] Speed: 56.7[samples/s]
2022-04-23 14:11:33,664 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.9993356466293335 
2022-04-23 14:11:33,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 14:11:33,665 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 199.9%
2022-04-23 14:12:05,994 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.904, Acc: 0.893, Base Lr: 1.66e-03
2022-04-23 14:12:35,712 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.880, Acc: 0.901, Base Lr: 1.66e-03
2022-04-23 14:12:55,334 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-23 14:13:29,550 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9666552543640137 
2022-04-23 14:13:29,551 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 14:13:29,551 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 196.7%
2022-04-23 14:13:59,977 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.857, Acc: 0.915, Base Lr: 1.19e-03
2022-04-23 14:14:28,724 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.870, Acc: 0.910, Base Lr: 1.19e-03
2022-04-23 14:14:49,868 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.294[s] Speed: 54.4[samples/s]
2022-04-23 14:15:26,884 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.9573758840560913 
2022-04-23 14:15:26,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 14:15:26,889 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 195.7%
2022-04-23 14:15:56,179 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.895, Acc: 0.912, Base Lr: 7.78e-04
2022-04-23 14:16:25,597 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.885, Acc: 0.912, Base Lr: 7.78e-04
2022-04-23 14:16:46,793 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.292[s] Speed: 54.7[samples/s]
2022-04-23 14:17:22,140 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.9244928359985352 
2022-04-23 14:18:02,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 14:18:02,389 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 192.4%
2022-04-23 14:18:31,326 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.886, Acc: 0.903, Base Lr: 4.51e-04
2022-04-23 14:19:01,027 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.865, Acc: 0.902, Base Lr: 4.51e-04
2022-04-23 14:19:23,057 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.295[s] Speed: 54.1[samples/s]
2022-04-23 14:19:57,897 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9381287097930908 
2022-04-23 14:19:57,897 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 14:19:57,897 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 193.8%
2022-04-23 14:20:28,011 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.852, Acc: 0.912, Base Lr: 2.11e-04
2022-04-23 14:20:54,028 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.841, Acc: 0.910, Base Lr: 2.11e-04
2022-04-23 14:21:15,332 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.284[s] Speed: 56.4[samples/s]
2022-04-23 14:21:51,921 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.9334205389022827 
2022-04-23 14:21:51,922 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 14:21:51,922 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 193.3%
2022-04-23 14:22:22,845 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.834, Acc: 0.915, Base Lr: 6.51e-05
2022-04-23 14:22:50,878 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.837, Acc: 0.911, Base Lr: 6.51e-05
2022-04-23 14:23:09,631 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.284[s] Speed: 56.3[samples/s]
2022-04-23 14:23:43,056 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9110056161880493 
2022-04-23 14:24:13,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 14:24:13,152 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 191.1%
2022-04-23 14:24:44,512 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.833, Acc: 0.918, Base Lr: 1.60e-05
2022-04-23 14:25:15,912 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.837, Acc: 0.912, Base Lr: 1.60e-05
2022-04-23 14:25:37,082 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.307[s] Speed: 52.0[samples/s]
2022-04-23 14:26:49,453 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8708637952804565 
2022-04-23 14:27:19,472 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 14:27:19,473 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 187.1%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_8/transformer_best_model.pth
2022-04-23 14:28:52,505 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8708637952804565 
2022-04-23 14:28:52,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 14:28:52,506 reid_baseline.train INFO: Accuracy: 73.9%
2022-04-23 14:29:26,900 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.8708637952804565 
2022-04-23 14:29:26,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 14:29:26,901 reid_baseline.train INFO: Shuffled Accuracy: 73.9%
2022-04-23 14:30:10,051 reid_baseline.train INFO: normal accuracy 0.9441008018327606 0.8501065969467163 
2022-04-23 14:30:10,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 14:30:10,051 reid_baseline.train INFO: Source Clean Accuracy: 94.4%
2022-04-23 14:30:15,790 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_8
2022-04-23 14:30:15,791 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=8)
2022-04-23 14:30:15,791 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 14:30:15,791 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 14:30:15,791 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 14:30:26,251 reid_baseline.train INFO: start training
2022-04-23 14:31:07,323 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.052, Acc: 0.207, Base Lr: 8.72e-04
2022-04-23 14:31:39,016 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.994, Acc: 0.324, Base Lr: 8.72e-04
2022-04-23 14:32:02,713 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-23 14:32:54,908 reid_baseline.train INFO: normal accuracy 0.5339040324397387 4.170567035675049 
2022-04-23 14:33:44,827 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 14:33:44,827 reid_baseline.train INFO: Accuracy: 53.4% Mean Entropy: 417.1%
2022-04-23 14:34:21,301 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.739, Acc: 0.542, Base Lr: 1.66e-03
2022-04-23 14:34:54,731 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.621, Acc: 0.541, Base Lr: 1.66e-03
2022-04-23 14:35:19,772 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-23 14:36:05,026 reid_baseline.train INFO: normal accuracy 0.562514079747691 4.122872829437256 
2022-04-23 14:36:35,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 14:36:35,033 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 412.3%
2022-04-23 14:37:11,285 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.070, Acc: 0.583, Base Lr: 2.46e-03
2022-04-23 14:37:45,473 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.903, Acc: 0.582, Base Lr: 2.46e-03
2022-04-23 14:38:09,483 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.346[s] Speed: 46.3[samples/s]
2022-04-23 14:38:57,359 reid_baseline.train INFO: normal accuracy 0.6005857175039423 3.7186760902404785 
2022-04-23 14:39:27,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 14:39:27,320 reid_baseline.train INFO: Accuracy: 60.1% Mean Entropy: 371.9%
2022-04-23 14:40:03,234 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.221, Acc: 0.623, Base Lr: 3.25e-03
2022-04-23 14:40:36,252 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.103, Acc: 0.650, Base Lr: 3.25e-03
2022-04-23 14:41:00,492 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-23 14:41:47,141 reid_baseline.train INFO: normal accuracy 0.665465194863708 2.9956555366516113 
2022-04-23 14:42:17,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 14:42:17,100 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 299.6%
2022-04-23 14:42:52,193 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.689, Acc: 0.725, Base Lr: 4.04e-03
2022-04-23 14:43:26,162 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.647, Acc: 0.721, Base Lr: 4.04e-03
2022-04-23 14:43:51,178 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-23 14:44:35,908 reid_baseline.train INFO: normal accuracy 0.6990313133588646 2.493886709213257 
2022-04-23 14:45:07,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 14:45:07,038 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 249.4%
2022-04-23 14:45:41,692 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.405, Acc: 0.784, Base Lr: 4.83e-03
2022-04-23 14:46:15,953 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.392, Acc: 0.777, Base Lr: 4.83e-03
2022-04-23 14:46:39,180 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-23 14:47:29,074 reid_baseline.train INFO: normal accuracy 0.718855598107682 2.204097270965576 
2022-04-23 14:47:59,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 14:47:59,057 reid_baseline.train INFO: Accuracy: 71.9% Mean Entropy: 220.4%
2022-04-23 14:48:32,927 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.268, Acc: 0.795, Base Lr: 5.62e-03
2022-04-23 14:49:04,869 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.238, Acc: 0.808, Base Lr: 5.62e-03
2022-04-23 14:49:28,166 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-23 14:50:16,852 reid_baseline.train INFO: normal accuracy 0.7393557107456634 2.0372960567474365 
2022-04-23 14:50:57,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 14:50:57,057 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 203.7%
2022-04-23 14:51:30,997 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.142, Acc: 0.832, Base Lr: 6.42e-03
2022-04-23 14:52:04,349 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.144, Acc: 0.832, Base Lr: 6.42e-03
2022-04-23 14:52:26,918 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-23 14:53:09,580 reid_baseline.train INFO: normal accuracy 0.7454381617481415 1.8940613269805908 
2022-04-23 14:53:43,088 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 14:53:43,089 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 189.4%
2022-04-23 14:54:14,336 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.059, Acc: 0.854, Base Lr: 7.21e-03
2022-04-23 14:54:43,482 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.057, Acc: 0.853, Base Lr: 7.21e-03
2022-04-23 14:55:06,371 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.305[s] Speed: 52.5[samples/s]
2022-04-23 14:55:53,167 reid_baseline.train INFO: normal accuracy 0.7591799954944808 1.830856442451477 
2022-04-23 14:56:23,128 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 14:56:23,129 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 183.1%
2022-04-23 14:56:55,721 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.997, Acc: 0.874, Base Lr: 4.01e-03
2022-04-23 14:57:26,581 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.970, Acc: 0.883, Base Lr: 4.01e-03
2022-04-23 14:57:47,314 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.308[s] Speed: 52.0[samples/s]
2022-04-23 14:59:03,944 reid_baseline.train INFO: normal accuracy 0.7605316512728092 1.8188847303390503 
2022-04-23 14:59:51,935 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 14:59:51,936 reid_baseline.train INFO: Accuracy: 76.1% Mean Entropy: 181.9%
2022-04-23 15:00:27,068 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.936, Acc: 0.894, Base Lr: 3.38e-03
2022-04-23 15:01:03,095 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.952, Acc: 0.885, Base Lr: 3.38e-03
2022-04-23 15:01:28,971 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.355[s] Speed: 45.0[samples/s]
2022-04-23 15:02:19,807 reid_baseline.train INFO: normal accuracy 0.7614327551250282 1.7733232975006104 
2022-04-23 15:03:11,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 15:03:11,366 reid_baseline.train INFO: Accuracy: 76.1% Mean Entropy: 177.3%
2022-04-23 15:03:49,416 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.962, Acc: 0.880, Base Lr: 2.77e-03
2022-04-23 15:04:25,624 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.921, Acc: 0.892, Base Lr: 2.77e-03
2022-04-23 15:04:53,055 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-23 15:05:44,967 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.7673054933547974 
2022-04-23 15:06:41,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 15:06:41,220 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 176.7%
2022-04-23 15:07:20,203 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.919, Acc: 0.891, Base Lr: 2.20e-03
2022-04-23 15:07:56,436 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.907, Acc: 0.897, Base Lr: 2.20e-03
2022-04-23 15:08:21,757 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.368[s] Speed: 43.4[samples/s]
2022-04-23 15:09:15,952 reid_baseline.train INFO: normal accuracy 0.7690921378688894 1.812152624130249 
2022-04-23 15:09:15,959 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 15:09:15,959 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 181.2%
2022-04-23 15:09:52,078 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.904, Acc: 0.895, Base Lr: 1.66e-03
2022-04-23 15:10:28,509 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.878, Acc: 0.904, Base Lr: 1.66e-03
2022-04-23 15:10:55,001 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-23 15:11:47,603 reid_baseline.train INFO: normal accuracy 0.7690921378688894 1.7855379581451416 
2022-04-23 15:11:47,605 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 15:11:47,605 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 178.6%
2022-04-23 15:12:24,634 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.854, Acc: 0.914, Base Lr: 1.19e-03
2022-04-23 15:12:59,630 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.867, Acc: 0.908, Base Lr: 1.19e-03
2022-04-23 15:13:26,477 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-23 15:14:17,743 reid_baseline.train INFO: normal accuracy 0.7684163099797252 1.7891227006912231 
2022-04-23 15:14:17,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 15:14:17,744 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 178.9%
2022-04-23 15:14:56,786 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.894, Acc: 0.912, Base Lr: 7.78e-04
2022-04-23 15:15:31,646 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.883, Acc: 0.912, Base Lr: 7.78e-04
2022-04-23 15:15:57,027 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.364[s] Speed: 44.0[samples/s]
2022-04-23 15:16:47,261 reid_baseline.train INFO: normal accuracy 0.7742734850191485 1.7556219100952148 
2022-04-23 15:17:17,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 15:17:17,260 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 175.6%
2022-04-23 15:17:57,228 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.881, Acc: 0.906, Base Lr: 4.51e-04
2022-04-23 15:18:31,803 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.862, Acc: 0.906, Base Lr: 4.51e-04
2022-04-23 15:18:58,692 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.372[s] Speed: 43.1[samples/s]
2022-04-23 15:19:49,763 reid_baseline.train INFO: normal accuracy 0.7731471052038748 1.7698129415512085 
2022-04-23 15:19:49,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 15:19:49,764 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 177.0%
2022-04-23 15:20:29,218 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.850, Acc: 0.914, Base Lr: 2.11e-04
2022-04-23 15:21:06,410 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.839, Acc: 0.912, Base Lr: 2.11e-04
2022-04-23 15:21:30,795 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-04-23 15:22:20,379 reid_baseline.train INFO: normal accuracy 0.7756251407974769 1.7713855504989624 
2022-04-23 15:22:20,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 15:22:20,380 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 177.1%
2022-04-23 15:22:59,154 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.834, Acc: 0.916, Base Lr: 6.51e-05
2022-04-23 15:23:36,931 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.837, Acc: 0.911, Base Lr: 6.51e-05
2022-04-23 15:24:03,207 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.376[s] Speed: 42.5[samples/s]
2022-04-23 15:24:51,571 reid_baseline.train INFO: normal accuracy 0.7706690696102726 1.7320632934570312 
2022-04-23 15:25:21,548 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 15:25:21,548 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 173.2%
2022-04-23 15:26:01,735 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.831, Acc: 0.916, Base Lr: 1.60e-05
2022-04-23 15:26:37,564 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.835, Acc: 0.912, Base Lr: 1.60e-05
2022-04-23 15:27:05,222 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-23 15:28:27,866 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.7013988494873047 
2022-04-23 15:28:57,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 15:28:57,855 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 170.1%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_8/transformer_best_model.pth
2022-04-23 15:30:21,797 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.7013988494873047 
2022-04-23 15:30:21,800 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 15:30:21,800 reid_baseline.train INFO: Accuracy: 77.2%
2022-04-23 15:31:13,932 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.7013988494873047 
2022-04-23 15:31:13,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 15:31:13,933 reid_baseline.train INFO: Shuffled Accuracy: 77.2%
2022-04-23 15:32:07,616 reid_baseline.train INFO: normal accuracy 0.9443298969072165 0.8511542081832886 
2022-04-23 15:32:07,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 15:32:07,618 reid_baseline.train INFO: Source Clean Accuracy: 94.4%
2022-04-23 15:32:15,138 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_8
2022-04-23 15:32:15,138 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=8)
2022-04-23 15:32:15,138 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 15:32:15,139 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 15:32:15,142 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 15:32:26,972 reid_baseline.train INFO: start training
2022-04-23 15:33:15,072 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.052, Acc: 0.207, Base Lr: 8.72e-04
2022-04-23 15:33:50,979 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.995, Acc: 0.324, Base Lr: 8.72e-04
2022-04-23 15:34:19,292 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.408[s] Speed: 39.2[samples/s]
2022-04-23 15:36:37,647 reid_baseline.train INFO: normal accuracy 0.5512967638283223 4.170986652374268 
2022-04-23 15:37:07,590 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 15:37:07,590 reid_baseline.train INFO: Accuracy: 55.1% Mean Entropy: 417.1%
2022-04-23 15:37:49,753 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.733, Acc: 0.546, Base Lr: 1.66e-03
2022-04-23 15:38:28,557 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.617, Acc: 0.543, Base Lr: 1.66e-03
2022-04-23 15:38:58,456 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.406[s] Speed: 39.4[samples/s]
2022-04-23 15:41:18,502 reid_baseline.train INFO: normal accuracy 0.5776910718384209 4.129067897796631 
2022-04-23 15:41:48,499 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 15:41:48,500 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 412.9%
2022-04-23 15:42:31,061 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.069, Acc: 0.580, Base Lr: 2.46e-03
2022-04-23 15:43:11,043 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 4.901, Acc: 0.579, Base Lr: 2.46e-03
2022-04-23 15:43:40,003 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.408[s] Speed: 39.2[samples/s]
2022-04-23 15:45:50,269 reid_baseline.train INFO: normal accuracy 0.623364700481983 3.7550079822540283 
2022-04-23 15:46:20,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 15:46:20,266 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 375.5%
2022-04-23 15:47:01,879 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.216, Acc: 0.626, Base Lr: 3.25e-03
2022-04-23 15:47:40,724 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.098, Acc: 0.651, Base Lr: 3.25e-03
2022-04-23 15:48:09,328 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-23 15:50:13,614 reid_baseline.train INFO: normal accuracy 0.6947440899701629 3.0435733795166016 
2022-04-23 15:50:43,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 15:50:43,653 reid_baseline.train INFO: Accuracy: 69.5% Mean Entropy: 304.4%
2022-04-23 15:51:25,778 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.685, Acc: 0.728, Base Lr: 4.04e-03
2022-04-23 15:52:00,662 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.644, Acc: 0.725, Base Lr: 4.04e-03
2022-04-23 15:52:28,691 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.385[s] Speed: 41.6[samples/s]
2022-04-23 15:54:44,979 reid_baseline.train INFO: normal accuracy 0.7310075740188203 2.550398349761963 
2022-04-23 15:55:26,684 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 15:55:26,693 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 255.0%
2022-04-23 15:56:04,364 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.405, Acc: 0.781, Base Lr: 4.83e-03
2022-04-23 15:56:43,866 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.392, Acc: 0.777, Base Lr: 4.83e-03
2022-04-23 15:57:13,228 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-23 15:59:31,740 reid_baseline.train INFO: normal accuracy 0.7571723663070921 2.2571468353271484 
2022-04-23 16:00:01,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 16:00:01,765 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 225.7%
2022-04-23 16:00:44,762 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.263, Acc: 0.790, Base Lr: 5.62e-03
2022-04-23 16:01:25,088 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.234, Acc: 0.804, Base Lr: 5.62e-03
2022-04-23 16:01:54,995 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.415[s] Speed: 38.6[samples/s]
2022-04-23 16:04:08,209 reid_baseline.train INFO: normal accuracy 0.7652054165710351 2.069964647293091 
2022-04-23 16:04:38,257 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 16:04:38,257 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 207.0%
2022-04-23 16:05:20,976 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.143, Acc: 0.834, Base Lr: 6.42e-03
2022-04-23 16:06:00,530 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.141, Acc: 0.834, Base Lr: 6.42e-03
2022-04-23 16:06:29,199 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.406[s] Speed: 39.4[samples/s]
2022-04-23 16:08:39,175 reid_baseline.train INFO: normal accuracy 0.774156529722286 1.9414429664611816 
2022-04-23 16:09:09,162 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 16:09:09,162 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 194.1%
2022-04-23 16:09:50,233 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.061, Acc: 0.852, Base Lr: 7.21e-03
2022-04-23 16:10:30,340 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.060, Acc: 0.852, Base Lr: 7.21e-03
2022-04-23 16:10:59,549 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.404[s] Speed: 39.6[samples/s]
2022-04-23 16:13:07,959 reid_baseline.train INFO: normal accuracy 0.7792058756024788 1.8858006000518799 
2022-04-23 16:13:37,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 16:13:37,996 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 188.6%
2022-04-23 16:14:21,084 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.997, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 16:15:02,528 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.971, Acc: 0.881, Base Lr: 4.01e-03
2022-04-23 16:15:32,662 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.420[s] Speed: 38.1[samples/s]
2022-04-23 16:18:12,458 reid_baseline.train INFO: normal accuracy 0.782419095708056 1.8504396677017212 
2022-04-23 16:18:42,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 16:18:42,443 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 185.0%
2022-04-23 16:19:24,826 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.936, Acc: 0.888, Base Lr: 3.38e-03
2022-04-23 16:20:06,378 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.952, Acc: 0.881, Base Lr: 3.38e-03
2022-04-23 16:20:34,185 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-23 16:22:41,605 reid_baseline.train INFO: normal accuracy 0.7856323158136332 1.7889113426208496 
2022-04-23 16:23:11,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 16:23:11,594 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 178.9%
2022-04-23 16:23:55,069 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.966, Acc: 0.879, Base Lr: 2.77e-03
2022-04-23 16:24:34,451 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.923, Acc: 0.891, Base Lr: 2.77e-03
2022-04-23 16:25:01,429 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 16:27:11,945 reid_baseline.train INFO: normal accuracy 0.7844847372044985 1.7845443487167358 
2022-04-23 16:27:41,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 16:27:41,982 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 178.5%
2022-04-23 16:28:25,597 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.918, Acc: 0.895, Base Lr: 2.20e-03
2022-04-23 16:29:03,897 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.906, Acc: 0.900, Base Lr: 2.20e-03
2022-04-23 16:29:29,823 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-23 16:31:40,847 reid_baseline.train INFO: normal accuracy 0.7888455359192105 1.8338919878005981 
2022-04-23 16:31:40,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 16:31:40,850 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 183.4%
2022-04-23 16:32:23,756 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.904, Acc: 0.893, Base Lr: 1.66e-03
2022-04-23 16:33:03,293 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.881, Acc: 0.902, Base Lr: 1.66e-03
2022-04-23 16:33:31,365 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-23 16:35:46,617 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7999649047851562 
2022-04-23 16:35:46,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 16:35:46,618 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 180.0%
2022-04-23 16:36:28,590 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.856, Acc: 0.918, Base Lr: 1.19e-03
2022-04-23 16:37:08,288 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.869, Acc: 0.910, Base Lr: 1.19e-03
2022-04-23 16:37:36,872 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-23 16:39:52,001 reid_baseline.train INFO: normal accuracy 0.7883865044755566 1.7942698001861572 
2022-04-23 16:39:52,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 16:39:52,002 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 179.4%
2022-04-23 16:40:32,862 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.896, Acc: 0.911, Base Lr: 7.78e-04
2022-04-23 16:41:10,162 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.886, Acc: 0.911, Base Lr: 7.78e-04
2022-04-23 16:41:39,158 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-23 16:43:44,114 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.763015627861023 
2022-04-23 16:44:14,103 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 16:44:14,105 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 176.3%
2022-04-23 16:44:54,468 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.886, Acc: 0.903, Base Lr: 4.51e-04
2022-04-23 16:45:34,622 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.864, Acc: 0.902, Base Lr: 4.51e-04
2022-04-23 16:46:03,375 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-23 16:48:09,004 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.781724452972412 
2022-04-23 16:48:09,006 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 16:48:09,007 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 178.2%
2022-04-23 16:48:51,623 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.848, Acc: 0.911, Base Lr: 2.11e-04
2022-04-23 16:49:31,027 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.838, Acc: 0.909, Base Lr: 2.11e-04
2022-04-23 16:49:59,295 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.404[s] Speed: 39.6[samples/s]
2022-04-23 16:52:02,429 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.7860850095748901 
2022-04-23 16:52:02,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 16:52:02,433 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 178.6%
2022-04-23 16:52:41,758 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.835, Acc: 0.915, Base Lr: 6.51e-05
2022-04-23 16:53:21,311 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.839, Acc: 0.910, Base Lr: 6.51e-05
2022-04-23 16:53:49,514 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-23 16:55:59,614 reid_baseline.train INFO: normal accuracy 0.7890750516410374 1.751142144203186 
2022-04-23 16:56:29,644 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 16:56:29,644 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 175.1%
2022-04-23 16:57:09,713 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.835, Acc: 0.917, Base Lr: 1.60e-05
2022-04-23 16:57:49,313 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.838, Acc: 0.912, Base Lr: 1.60e-05
2022-04-23 16:58:18,778 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-23 17:00:56,351 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7096909284591675 
2022-04-23 17:01:26,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 17:01:26,343 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 171.0%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_8/transformer_best_model.pth
2022-04-23 17:04:13,692 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7096909284591675 
2022-04-23 17:04:13,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 17:04:13,694 reid_baseline.train INFO: Accuracy: 79.2%
2022-04-23 17:06:34,474 reid_baseline.train INFO: normal accuracy 0.7922882717466146 1.7096909284591675 
2022-04-23 17:06:34,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 17:06:34,474 reid_baseline.train INFO: Shuffled Accuracy: 79.2%
2022-04-23 17:07:28,879 reid_baseline.train INFO: normal accuracy 0.9438717067583047 0.8523033857345581 
2022-04-23 17:07:28,879 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 17:07:28,879 reid_baseline.train INFO: Source Clean Accuracy: 94.4%
2022-04-23 17:07:36,437 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_9
2022-04-23 17:07:36,438 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_9', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=9)
2022-04-23 17:07:36,439 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 17:07:36,439 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 17:07:36,440 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_9
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 17:07:49,142 reid_baseline.train INFO: start training
2022-04-23 17:08:40,136 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.039, Acc: 0.188, Base Lr: 8.72e-04
2022-04-23 17:09:21,632 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.009, Acc: 0.313, Base Lr: 8.72e-04
2022-04-23 17:09:52,454 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.447[s] Speed: 35.8[samples/s]
2022-04-23 17:10:36,498 reid_baseline.train INFO: normal accuracy 0.4820766378244747 4.171588897705078 
2022-04-23 17:11:06,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 17:11:06,450 reid_baseline.train INFO: Accuracy: 48.2% Mean Entropy: 417.2%
2022-04-23 17:11:49,205 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.764, Acc: 0.533, Base Lr: 1.66e-03
2022-04-23 17:12:30,819 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.654, Acc: 0.533, Base Lr: 1.66e-03
2022-04-23 17:12:59,451 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.414[s] Speed: 38.7[samples/s]
2022-04-23 17:13:42,916 reid_baseline.train INFO: normal accuracy 0.5125669550885867 4.14448356628418 
2022-04-23 17:14:12,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 17:14:12,919 reid_baseline.train INFO: Accuracy: 51.3% Mean Entropy: 414.4%
2022-04-23 17:14:57,961 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.173, Acc: 0.567, Base Lr: 2.46e-03
2022-04-23 17:15:36,847 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.012, Acc: 0.565, Base Lr: 2.46e-03
2022-04-23 17:16:05,669 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.413[s] Speed: 38.7[samples/s]
2022-04-23 17:16:45,546 reid_baseline.train INFO: normal accuracy 0.5587144622991347 3.9031927585601807 
2022-04-23 17:17:15,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 17:17:15,521 reid_baseline.train INFO: Accuracy: 55.9% Mean Entropy: 390.3%
2022-04-23 17:17:57,949 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.374, Acc: 0.605, Base Lr: 3.25e-03
2022-04-23 17:18:38,225 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.229, Acc: 0.635, Base Lr: 3.25e-03
2022-04-23 17:19:07,130 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-23 17:19:44,944 reid_baseline.train INFO: normal accuracy 0.6258755665430573 3.3631579875946045 
2022-04-23 17:20:14,931 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 17:20:14,932 reid_baseline.train INFO: Accuracy: 62.6% Mean Entropy: 336.3%
2022-04-23 17:20:55,845 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.798, Acc: 0.699, Base Lr: 4.04e-03
2022-04-23 17:21:33,152 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.739, Acc: 0.701, Base Lr: 4.04e-03
2022-04-23 17:22:01,099 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-04-23 17:22:42,933 reid_baseline.train INFO: normal accuracy 0.669138854552946 2.9020864963531494 
2022-04-23 17:23:12,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 17:23:12,910 reid_baseline.train INFO: Accuracy: 66.9% Mean Entropy: 290.2%
2022-04-23 17:23:54,735 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.484, Acc: 0.764, Base Lr: 4.83e-03
2022-04-23 17:24:31,373 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.457, Acc: 0.764, Base Lr: 4.83e-03
2022-04-23 17:25:00,272 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-23 17:25:44,229 reid_baseline.train INFO: normal accuracy 0.6926246394725999 2.597022771835327 
2022-04-23 17:26:14,224 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 17:26:14,225 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 259.7%
2022-04-23 17:26:55,797 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.306, Acc: 0.787, Base Lr: 5.62e-03
2022-04-23 17:27:36,299 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.279, Acc: 0.796, Base Lr: 5.62e-03
2022-04-23 17:28:05,836 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-23 17:28:48,599 reid_baseline.train INFO: normal accuracy 0.7173465183353935 2.372116804122925 
2022-04-23 17:29:18,550 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 17:29:18,551 reid_baseline.train INFO: Accuracy: 71.7% Mean Entropy: 237.2%
2022-04-23 17:30:01,454 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.187, Acc: 0.821, Base Lr: 6.42e-03
2022-04-23 17:30:40,291 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.182, Acc: 0.820, Base Lr: 6.42e-03
2022-04-23 17:31:08,131 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-23 17:31:47,737 reid_baseline.train INFO: normal accuracy 0.7301194890811702 2.199981212615967 
2022-04-23 17:32:17,720 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 17:32:17,720 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 220.0%
2022-04-23 17:32:57,951 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.103, Acc: 0.844, Base Lr: 7.21e-03
2022-04-23 17:33:36,578 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.088, Acc: 0.848, Base Lr: 7.21e-03
2022-04-23 17:34:05,293 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-23 17:34:44,699 reid_baseline.train INFO: normal accuracy 0.7301194890811702 2.0823285579681396 
2022-04-23 17:35:17,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 17:35:17,256 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 208.2%
2022-04-23 17:35:56,835 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.988, Acc: 0.865, Base Lr: 4.01e-03
2022-04-23 17:36:36,600 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.970, Acc: 0.875, Base Lr: 4.01e-03
2022-04-23 17:37:04,301 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-23 17:38:14,160 reid_baseline.train INFO: normal accuracy 0.738360115368768 2.0634641647338867 
2022-04-23 17:38:59,301 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 17:38:59,301 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 206.3%
2022-04-23 17:39:41,635 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.940, Acc: 0.886, Base Lr: 3.38e-03
2022-04-23 17:40:20,964 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.963, Acc: 0.880, Base Lr: 3.38e-03
2022-04-23 17:40:50,068 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-23 17:41:27,080 reid_baseline.train INFO: normal accuracy 0.734651833539349 1.9915412664413452 
2022-04-23 17:41:58,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 17:41:58,511 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 199.2%
2022-04-23 17:42:40,969 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.989, Acc: 0.873, Base Lr: 2.77e-03
2022-04-23 17:43:20,768 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.938, Acc: 0.888, Base Lr: 2.77e-03
2022-04-23 17:43:48,354 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 17:44:26,583 reid_baseline.train INFO: normal accuracy 0.7358879274824887 1.9851576089859009 
2022-04-23 17:44:56,589 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 17:44:56,589 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 198.5%
2022-04-23 17:45:39,729 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.951, Acc: 0.883, Base Lr: 2.20e-03
2022-04-23 17:46:20,510 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.933, Acc: 0.892, Base Lr: 2.20e-03
2022-04-23 17:46:46,453 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 17:47:27,162 reid_baseline.train INFO: normal accuracy 0.7342398022249691 2.0375750064849854 
2022-04-23 17:47:27,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 17:47:27,163 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 203.8%
2022-04-23 17:48:09,684 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.913, Acc: 0.891, Base Lr: 1.66e-03
2022-04-23 17:48:48,313 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.886, Acc: 0.898, Base Lr: 1.66e-03
2022-04-23 17:49:16,066 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-23 17:49:54,636 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.0071043968200684 
2022-04-23 17:49:54,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 17:49:54,639 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 200.7%
2022-04-23 17:50:36,094 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.860, Acc: 0.915, Base Lr: 1.19e-03
2022-04-23 17:51:14,913 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.885, Acc: 0.908, Base Lr: 1.19e-03
2022-04-23 17:51:42,875 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-23 17:52:24,475 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.986021876335144 
2022-04-23 17:52:24,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 17:52:24,483 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 198.6%
2022-04-23 17:53:05,156 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.898, Acc: 0.904, Base Lr: 7.78e-04
2022-04-23 17:53:45,423 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.892, Acc: 0.905, Base Lr: 7.78e-04
2022-04-23 17:54:14,325 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 17:54:55,944 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.9443342685699463 
2022-04-23 17:55:44,556 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 17:55:44,556 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 194.4%
2022-04-23 17:56:27,657 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.880, Acc: 0.905, Base Lr: 4.51e-04
2022-04-23 17:57:08,294 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.869, Acc: 0.905, Base Lr: 4.51e-04
2022-04-23 17:57:37,484 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.414[s] Speed: 38.7[samples/s]
2022-04-23 17:58:19,367 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.9457920789718628 
2022-04-23 17:58:19,368 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 17:58:19,369 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 194.6%
2022-04-23 17:59:00,501 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.855, Acc: 0.911, Base Lr: 2.11e-04
2022-04-23 17:59:40,921 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.845, Acc: 0.906, Base Lr: 2.11e-04
2022-04-23 18:00:09,825 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-23 18:00:55,835 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.945549726486206 
2022-04-23 18:00:55,838 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 18:00:55,838 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 194.6%
2022-04-23 18:01:37,751 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.844, Acc: 0.909, Base Lr: 6.51e-05
2022-04-23 18:02:17,594 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.848, Acc: 0.904, Base Lr: 6.51e-05
2022-04-23 18:02:45,328 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-23 18:03:26,207 reid_baseline.train INFO: normal accuracy 0.7391841779975278 1.925681233406067 
2022-04-23 18:03:56,160 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 18:03:56,161 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 192.6%
2022-04-23 18:04:34,985 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.849, Acc: 0.917, Base Lr: 1.60e-05
2022-04-23 18:05:14,974 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.855, Acc: 0.912, Base Lr: 1.60e-05
2022-04-23 18:05:43,869 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-23 18:06:55,912 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.8936418294906616 
2022-04-23 18:07:25,931 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 18:07:25,932 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 189.4%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_9/transformer_best_model.pth
2022-04-23 18:08:35,382 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.8936418294906616 
2022-04-23 18:08:35,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 18:08:35,383 reid_baseline.train INFO: Accuracy: 74.2%
2022-04-23 18:09:16,286 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.8936418294906616 
2022-04-23 18:09:16,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 18:09:16,287 reid_baseline.train INFO: Shuffled Accuracy: 74.2%
2022-04-23 18:10:06,645 reid_baseline.train INFO: normal accuracy 0.9422680412371134 0.868893027305603 
2022-04-23 18:10:06,645 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 18:10:06,645 reid_baseline.train INFO: Source Clean Accuracy: 94.2%
2022-04-23 18:10:13,169 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_9
2022-04-23 18:10:13,170 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_9', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=9)
2022-04-23 18:10:13,170 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 18:10:13,170 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 18:10:13,171 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_9
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 18:10:24,193 reid_baseline.train INFO: start training
2022-04-23 18:11:13,366 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.039, Acc: 0.188, Base Lr: 8.72e-04
2022-04-23 18:11:53,680 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.010, Acc: 0.314, Base Lr: 8.72e-04
2022-04-23 18:12:22,414 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.429[s] Speed: 37.3[samples/s]
2022-04-23 18:13:14,760 reid_baseline.train INFO: normal accuracy 0.5330029285875197 4.171077728271484 
2022-04-23 18:13:53,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 18:13:53,235 reid_baseline.train INFO: Accuracy: 53.3% Mean Entropy: 417.1%
2022-04-23 18:14:33,877 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.764, Acc: 0.533, Base Lr: 1.66e-03
2022-04-23 18:15:13,448 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.655, Acc: 0.535, Base Lr: 1.66e-03
2022-04-23 18:15:43,189 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-23 18:16:36,035 reid_baseline.train INFO: normal accuracy 0.5582338364496509 4.134821891784668 
2022-04-23 18:17:06,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 18:17:06,041 reid_baseline.train INFO: Accuracy: 55.8% Mean Entropy: 413.5%
2022-04-23 18:17:48,435 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.171, Acc: 0.570, Base Lr: 2.46e-03
2022-04-23 18:18:28,534 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.015, Acc: 0.570, Base Lr: 2.46e-03
2022-04-23 18:18:56,237 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.404[s] Speed: 39.6[samples/s]
2022-04-23 18:19:46,657 reid_baseline.train INFO: normal accuracy 0.5839152962378914 3.8131871223449707 
2022-04-23 18:20:16,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 18:20:16,630 reid_baseline.train INFO: Accuracy: 58.4% Mean Entropy: 381.3%
2022-04-23 18:20:58,654 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.388, Acc: 0.605, Base Lr: 3.25e-03
2022-04-23 18:21:36,958 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.241, Acc: 0.635, Base Lr: 3.25e-03
2022-04-23 18:22:05,200 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-23 18:22:55,330 reid_baseline.train INFO: normal accuracy 0.6474431178193287 3.1173079013824463 
2022-04-23 18:23:25,314 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 18:23:25,315 reid_baseline.train INFO: Accuracy: 64.7% Mean Entropy: 311.7%
2022-04-23 18:24:05,114 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.792, Acc: 0.705, Base Lr: 4.04e-03
2022-04-23 18:24:44,746 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.730, Acc: 0.703, Base Lr: 4.04e-03
2022-04-23 18:25:10,606 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-23 18:26:00,266 reid_baseline.train INFO: normal accuracy 0.6909213786888939 2.5717966556549072 
2022-04-23 18:26:30,222 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 18:26:30,222 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 257.2%
2022-04-23 18:27:11,421 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.483, Acc: 0.766, Base Lr: 4.83e-03
2022-04-23 18:27:51,561 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.454, Acc: 0.765, Base Lr: 4.83e-03
2022-04-23 18:28:19,012 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-23 18:29:13,925 reid_baseline.train INFO: normal accuracy 0.7118720432529849 2.245378255844116 
2022-04-23 18:29:43,945 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 18:29:43,946 reid_baseline.train INFO: Accuracy: 71.2% Mean Entropy: 224.5%
2022-04-23 18:30:28,149 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.301, Acc: 0.786, Base Lr: 5.62e-03
2022-04-23 18:31:03,863 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.274, Acc: 0.798, Base Lr: 5.62e-03
2022-04-23 18:31:30,662 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-23 18:32:23,930 reid_baseline.train INFO: normal accuracy 0.7341743635954043 2.054389476776123 
2022-04-23 18:32:53,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 18:32:53,922 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 205.4%
2022-04-23 18:33:37,455 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.185, Acc: 0.821, Base Lr: 6.42e-03
2022-04-23 18:34:15,666 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.181, Acc: 0.819, Base Lr: 6.42e-03
2022-04-23 18:34:43,733 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 18:35:33,634 reid_baseline.train INFO: normal accuracy 0.7402568145978824 1.946613073348999 
2022-04-23 18:36:03,621 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 18:36:03,621 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 194.7%
2022-04-23 18:36:44,419 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.102, Acc: 0.842, Base Lr: 7.21e-03
2022-04-23 18:37:23,396 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.086, Acc: 0.845, Base Lr: 7.21e-03
2022-04-23 18:37:52,020 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-23 18:38:43,452 reid_baseline.train INFO: normal accuracy 0.7517458887136742 1.8493075370788574 
2022-04-23 18:39:13,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 18:39:13,459 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 184.9%
2022-04-23 18:39:52,053 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.993, Acc: 0.863, Base Lr: 4.01e-03
2022-04-23 18:40:32,061 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.975, Acc: 0.876, Base Lr: 4.01e-03
2022-04-23 18:41:00,924 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-23 18:42:22,408 reid_baseline.train INFO: normal accuracy 0.7533228204550575 1.8440327644348145 
2022-04-23 18:43:20,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 18:43:20,754 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 184.4%
2022-04-23 18:44:03,044 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.934, Acc: 0.892, Base Lr: 3.38e-03
2022-04-23 18:44:44,468 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.961, Acc: 0.883, Base Lr: 3.38e-03
2022-04-23 18:45:14,545 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.417[s] Speed: 38.4[samples/s]
2022-04-23 18:46:08,062 reid_baseline.train INFO: normal accuracy 0.7603063753097544 1.7614221572875977 
2022-04-23 18:47:00,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 18:47:00,777 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 176.1%
2022-04-23 18:47:44,766 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.987, Acc: 0.870, Base Lr: 2.77e-03
2022-04-23 18:48:25,539 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.937, Acc: 0.887, Base Lr: 2.77e-03
2022-04-23 18:48:55,917 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.421[s] Speed: 38.0[samples/s]
2022-04-23 18:49:46,716 reid_baseline.train INFO: normal accuracy 0.7630096868664114 1.7675577402114868 
2022-04-23 18:49:46,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 18:49:46,734 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 176.8%
2022-04-23 18:50:28,974 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.952, Acc: 0.882, Base Lr: 2.20e-03
2022-04-23 18:51:07,845 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.933, Acc: 0.891, Base Lr: 2.20e-03
2022-04-23 18:51:35,778 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-23 18:52:31,296 reid_baseline.train INFO: normal accuracy 0.7650371705339041 1.8126237392425537 
2022-04-23 18:52:31,304 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 18:52:31,305 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 181.3%
2022-04-23 18:53:11,602 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.913, Acc: 0.890, Base Lr: 1.66e-03
2022-04-23 18:53:50,217 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.887, Acc: 0.898, Base Lr: 1.66e-03
2022-04-23 18:54:17,843 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-23 18:55:08,899 reid_baseline.train INFO: normal accuracy 0.7654877224600135 1.7873620986938477 
2022-04-23 18:55:08,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 18:55:08,900 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 178.7%
2022-04-23 18:55:48,407 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.862, Acc: 0.917, Base Lr: 1.19e-03
2022-04-23 18:56:25,664 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.888, Acc: 0.909, Base Lr: 1.19e-03
2022-04-23 18:56:54,754 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.388[s] Speed: 41.3[samples/s]
2022-04-23 18:57:46,352 reid_baseline.train INFO: normal accuracy 0.7675152061275062 1.7928450107574463 
2022-04-23 18:57:46,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 18:57:46,358 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 179.3%
2022-04-23 18:58:28,804 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.894, Acc: 0.903, Base Lr: 7.78e-04
2022-04-23 18:59:08,371 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.889, Acc: 0.903, Base Lr: 7.78e-04
2022-04-23 18:59:37,341 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.406[s] Speed: 39.4[samples/s]
2022-04-23 19:00:28,147 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.754514217376709 
2022-04-23 19:00:58,098 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 19:00:58,099 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 175.5%
2022-04-23 19:01:38,258 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.881, Acc: 0.906, Base Lr: 4.51e-04
2022-04-23 19:02:16,389 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.871, Acc: 0.904, Base Lr: 4.51e-04
2022-04-23 19:02:45,898 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-23 19:03:36,881 reid_baseline.train INFO: normal accuracy 0.771119621536382 1.7621936798095703 
2022-04-23 19:03:36,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 19:03:36,882 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 176.2%
2022-04-23 19:04:18,237 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.858, Acc: 0.908, Base Lr: 2.11e-04
2022-04-23 19:04:55,321 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.846, Acc: 0.907, Base Lr: 2.11e-04
2022-04-23 19:05:23,253 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.390[s] Speed: 41.1[samples/s]
2022-04-23 19:06:14,255 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.7609046697616577 
2022-04-23 19:06:14,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 19:06:14,260 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 176.1%
2022-04-23 19:06:55,668 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.845, Acc: 0.913, Base Lr: 6.51e-05
2022-04-23 19:07:34,687 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.847, Acc: 0.906, Base Lr: 6.51e-05
2022-04-23 19:08:02,652 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-23 19:08:53,432 reid_baseline.train INFO: normal accuracy 0.7681910340166704 1.7268308401107788 
2022-04-23 19:09:23,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 19:09:23,453 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 172.7%
2022-04-23 19:10:05,542 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.847, Acc: 0.914, Base Lr: 1.60e-05
2022-04-23 19:10:45,547 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.853, Acc: 0.911, Base Lr: 1.60e-05
2022-04-23 19:11:13,152 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 19:12:34,016 reid_baseline.train INFO: normal accuracy 0.7693174138319442 1.702620267868042 
2022-04-23 19:13:04,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 19:13:04,017 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 170.3%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_9/transformer_best_model.pth
2022-04-23 19:14:26,448 reid_baseline.train INFO: normal accuracy 0.7693174138319442 1.702620267868042 
2022-04-23 19:14:26,449 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 19:14:26,449 reid_baseline.train INFO: Accuracy: 76.9%
2022-04-23 19:15:16,261 reid_baseline.train INFO: normal accuracy 0.7693174138319442 1.702620267868042 
2022-04-23 19:15:16,261 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 19:15:16,261 reid_baseline.train INFO: Shuffled Accuracy: 76.9%
2022-04-23 19:16:06,660 reid_baseline.train INFO: normal accuracy 0.9415807560137457 0.8686740398406982 
2022-04-23 19:16:06,661 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 19:16:06,661 reid_baseline.train INFO: Source Clean Accuracy: 94.2%
2022-04-23 19:16:13,241 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_9
2022-04-23 19:16:13,242 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_9', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=9)
2022-04-23 19:16:13,242 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 19:16:13,242 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 19:16:13,242 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_9
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 19:16:24,445 reid_baseline.train INFO: start training
2022-04-23 19:17:13,167 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.039, Acc: 0.188, Base Lr: 8.72e-04
2022-04-23 19:17:53,064 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.010, Acc: 0.314, Base Lr: 8.72e-04
2022-04-23 19:18:20,942 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.421[s] Speed: 38.0[samples/s]
2022-04-23 19:20:33,707 reid_baseline.train INFO: normal accuracy 0.5421161349552445 4.171509742736816 
2022-04-23 19:21:03,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 19:21:03,654 reid_baseline.train INFO: Accuracy: 54.2% Mean Entropy: 417.2%
2022-04-23 19:21:44,886 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.767, Acc: 0.536, Base Lr: 1.66e-03
2022-04-23 19:22:21,468 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.661, Acc: 0.537, Base Lr: 1.66e-03
2022-04-23 19:22:50,571 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.392[s] Speed: 40.9[samples/s]
2022-04-23 19:25:00,307 reid_baseline.train INFO: normal accuracy 0.5756254303419784 4.142868995666504 
2022-04-23 19:25:37,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 19:25:37,053 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 414.3%
2022-04-23 19:26:15,302 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.197, Acc: 0.566, Base Lr: 2.46e-03
2022-04-23 19:26:54,977 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.039, Acc: 0.564, Base Lr: 2.46e-03
2022-04-23 19:27:24,050 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-23 19:29:38,301 reid_baseline.train INFO: normal accuracy 0.6052329584576543 3.853749990463257 
2022-04-23 19:30:08,377 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 19:30:08,378 reid_baseline.train INFO: Accuracy: 60.5% Mean Entropy: 385.4%
2022-04-23 19:30:48,747 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.387, Acc: 0.607, Base Lr: 3.25e-03
2022-04-23 19:31:29,862 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.242, Acc: 0.635, Base Lr: 3.25e-03
2022-04-23 19:32:00,613 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.411[s] Speed: 38.9[samples/s]
2022-04-23 19:34:20,222 reid_baseline.train INFO: normal accuracy 0.673628643562084 3.1843953132629395 
2022-04-23 19:34:50,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 19:34:50,183 reid_baseline.train INFO: Accuracy: 67.4% Mean Entropy: 318.4%
2022-04-23 19:35:29,778 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.798, Acc: 0.706, Base Lr: 4.04e-03
2022-04-23 19:36:06,613 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.737, Acc: 0.705, Base Lr: 4.04e-03
2022-04-23 19:36:33,764 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-23 19:38:47,155 reid_baseline.train INFO: normal accuracy 0.7181546935965114 2.649073839187622 
2022-04-23 19:39:17,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 19:39:17,165 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 264.9%
2022-04-23 19:39:55,219 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.483, Acc: 0.765, Base Lr: 4.83e-03
2022-04-23 19:40:30,827 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.455, Acc: 0.763, Base Lr: 4.83e-03
2022-04-23 19:40:56,918 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.364[s] Speed: 43.9[samples/s]
2022-04-23 19:43:20,129 reid_baseline.train INFO: normal accuracy 0.7473031902685334 2.3230810165405273 
2022-04-23 19:43:50,162 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 19:43:50,163 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 232.3%
2022-04-23 19:44:26,630 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.307, Acc: 0.785, Base Lr: 5.62e-03
2022-04-23 19:45:01,609 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.277, Acc: 0.797, Base Lr: 5.62e-03
2022-04-23 19:45:26,797 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-23 19:47:29,150 reid_baseline.train INFO: normal accuracy 0.7603855864126693 2.119014263153076 
2022-04-23 19:47:59,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 19:47:59,119 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 211.9%
2022-04-23 19:48:38,602 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.185, Acc: 0.819, Base Lr: 6.42e-03
2022-04-23 19:49:13,803 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.181, Acc: 0.820, Base Lr: 6.42e-03
2022-04-23 19:49:38,790 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.364[s] Speed: 43.9[samples/s]
2022-04-23 19:51:37,383 reid_baseline.train INFO: normal accuracy 0.7769107183842093 1.9869393110275269 
2022-04-23 19:52:07,523 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 19:52:07,524 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 198.7%
2022-04-23 19:52:44,205 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.105, Acc: 0.839, Base Lr: 7.21e-03
2022-04-23 19:53:20,489 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.089, Acc: 0.845, Base Lr: 7.21e-03
2022-04-23 19:53:46,418 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-23 19:55:48,189 reid_baseline.train INFO: normal accuracy 0.7810420013770943 1.8911391496658325 
2022-04-23 19:56:18,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 19:56:18,164 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 189.1%
2022-04-23 19:56:54,108 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.988, Acc: 0.870, Base Lr: 4.01e-03
2022-04-23 19:57:28,829 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.969, Acc: 0.878, Base Lr: 4.01e-03
2022-04-23 19:57:54,370 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.352[s] Speed: 45.4[samples/s]
2022-04-23 20:00:23,200 reid_baseline.train INFO: normal accuracy 0.7792058756024788 1.8641821146011353 
2022-04-23 20:00:53,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 20:00:53,176 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 186.4%
2022-04-23 20:01:30,639 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.942, Acc: 0.885, Base Lr: 3.38e-03
2022-04-23 20:02:05,651 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.966, Acc: 0.881, Base Lr: 3.38e-03
2022-04-23 20:02:29,745 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-23 20:04:34,268 reid_baseline.train INFO: normal accuracy 0.7860913472572871 1.8091026544570923 
2022-04-23 20:05:04,244 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 20:05:04,245 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 180.9%
2022-04-23 20:05:42,001 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.986, Acc: 0.868, Base Lr: 2.77e-03
2022-04-23 20:06:16,442 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.937, Acc: 0.887, Base Lr: 2.77e-03
2022-04-23 20:06:40,661 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-23 20:08:43,518 reid_baseline.train INFO: normal accuracy 0.7808124856552674 1.797386646270752 
2022-04-23 20:09:34,363 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 20:09:34,363 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 179.7%
2022-04-23 20:10:11,413 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.947, Acc: 0.885, Base Lr: 2.20e-03
2022-04-23 20:10:46,051 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.932, Acc: 0.893, Base Lr: 2.20e-03
2022-04-23 20:11:09,969 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-23 20:13:18,122 reid_baseline.train INFO: normal accuracy 0.7874684415882488 1.8457581996917725 
2022-04-23 20:13:18,123 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 20:13:18,123 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 184.6%
2022-04-23 20:13:55,336 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.914, Acc: 0.890, Base Lr: 1.66e-03
2022-04-23 20:14:29,521 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.886, Acc: 0.898, Base Lr: 1.66e-03
2022-04-23 20:14:54,139 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-23 20:16:51,654 reid_baseline.train INFO: normal accuracy 0.7863208629791141 1.8223258256912231 
2022-04-23 20:16:51,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 20:16:51,657 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 182.2%
2022-04-23 20:17:27,989 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.861, Acc: 0.917, Base Lr: 1.19e-03
2022-04-23 20:18:04,573 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.887, Acc: 0.908, Base Lr: 1.19e-03
2022-04-23 20:18:31,759 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.367[s] Speed: 43.6[samples/s]
2022-04-23 20:20:44,084 reid_baseline.train INFO: normal accuracy 0.7874684415882488 1.8169547319412231 
2022-04-23 20:20:44,085 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 20:20:44,085 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 181.7%
2022-04-23 20:21:22,629 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.894, Acc: 0.903, Base Lr: 7.78e-04
2022-04-23 20:22:00,464 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.891, Acc: 0.903, Base Lr: 7.78e-04
2022-04-23 20:22:26,167 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.374[s] Speed: 42.8[samples/s]
2022-04-23 20:24:26,481 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.7764748334884644 
2022-04-23 20:24:56,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 20:24:56,469 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 177.6%
2022-04-23 20:25:36,263 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.882, Acc: 0.905, Base Lr: 4.51e-04
2022-04-23 20:26:13,998 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.871, Acc: 0.904, Base Lr: 4.51e-04
2022-04-23 20:26:42,057 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.387[s] Speed: 41.4[samples/s]
2022-04-23 20:28:49,432 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.783582091331482 
2022-04-23 20:28:49,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 20:28:49,432 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 178.4%
2022-04-23 20:29:29,974 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.857, Acc: 0.913, Base Lr: 2.11e-04
2022-04-23 20:30:07,246 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.847, Acc: 0.908, Base Lr: 2.11e-04
2022-04-23 20:30:34,027 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-23 20:32:39,312 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.7892146110534668 
2022-04-23 20:32:39,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 20:32:39,313 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 178.9%
2022-04-23 20:33:20,480 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.845, Acc: 0.910, Base Lr: 6.51e-05
2022-04-23 20:33:58,224 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.848, Acc: 0.905, Base Lr: 6.51e-05
2022-04-23 20:34:23,803 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-23 20:36:29,654 reid_baseline.train INFO: normal accuracy 0.7876979573100757 1.7622934579849243 
2022-04-23 20:36:59,654 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 20:36:59,654 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 176.2%
2022-04-23 20:37:40,296 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.848, Acc: 0.915, Base Lr: 1.60e-05
2022-04-23 20:38:17,779 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.852, Acc: 0.910, Base Lr: 1.60e-05
2022-04-23 20:38:42,209 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.375[s] Speed: 42.6[samples/s]
2022-04-23 20:41:18,102 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7251862287521362 
2022-04-23 20:41:48,112 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 20:41:48,113 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 172.5%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_9/transformer_best_model.pth
2022-04-23 20:44:23,766 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7251862287521362 
2022-04-23 20:44:23,767 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 20:44:23,767 reid_baseline.train INFO: Accuracy: 79.0%
2022-04-23 20:46:22,411 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7251862287521362 
2022-04-23 20:46:22,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 20:46:22,412 reid_baseline.train INFO: Shuffled Accuracy: 79.0%
2022-04-23 20:47:11,166 reid_baseline.train INFO: normal accuracy 0.9434135166093929 0.8709173202514648 
2022-04-23 20:47:11,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 20:47:11,166 reid_baseline.train INFO: Source Clean Accuracy: 94.3%
2022-04-23 20:47:17,718 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_10
2022-04-23 20:47:17,718 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=10)
2022-04-23 20:47:17,718 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 20:47:17,719 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 20:47:17,719 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 20:47:28,322 reid_baseline.train INFO: start training
2022-04-23 20:48:07,522 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.112, Acc: 0.167, Base Lr: 8.72e-04
2022-04-23 20:48:41,021 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.056, Acc: 0.286, Base Lr: 8.72e-04
2022-04-23 20:49:04,971 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.350[s] Speed: 45.8[samples/s]
2022-04-23 20:49:42,987 reid_baseline.train INFO: normal accuracy 0.45900288421920066 4.172036647796631 
2022-04-23 20:50:21,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 20:50:21,915 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 417.2%
2022-04-23 20:50:54,070 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.817, Acc: 0.524, Base Lr: 1.66e-03
2022-04-23 20:51:25,921 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.739, Acc: 0.528, Base Lr: 1.66e-03
2022-04-23 20:51:50,823 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-23 20:52:31,368 reid_baseline.train INFO: normal accuracy 0.5138030490317265 4.153901100158691 
2022-04-23 20:53:01,371 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 20:53:01,372 reid_baseline.train INFO: Accuracy: 51.4% Mean Entropy: 415.4%
2022-04-23 20:53:37,293 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.302, Acc: 0.570, Base Lr: 2.46e-03
2022-04-23 20:54:11,162 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.168, Acc: 0.566, Base Lr: 2.46e-03
2022-04-23 20:54:36,585 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-23 20:55:13,929 reid_baseline.train INFO: normal accuracy 0.5558302430984755 3.9873275756835938 
2022-04-23 20:55:43,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 20:55:43,904 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 398.7%
2022-04-23 20:56:18,926 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.488, Acc: 0.592, Base Lr: 3.25e-03
2022-04-23 20:56:52,887 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.343, Acc: 0.618, Base Lr: 3.25e-03
2022-04-23 20:57:17,959 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.344[s] Speed: 46.4[samples/s]
2022-04-23 20:57:58,826 reid_baseline.train INFO: normal accuracy 0.6110424392253812 3.4498612880706787 
2022-04-23 20:58:28,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 20:58:28,824 reid_baseline.train INFO: Accuracy: 61.1% Mean Entropy: 345.0%
2022-04-23 20:59:02,687 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.871, Acc: 0.688, Base Lr: 4.04e-03
2022-04-23 20:59:38,151 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.801, Acc: 0.691, Base Lr: 4.04e-03
2022-04-23 21:00:02,920 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-23 21:00:40,418 reid_baseline.train INFO: normal accuracy 0.6646065100947672 2.991421937942505 
2022-04-23 21:01:10,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 21:01:10,379 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 299.1%
2022-04-23 21:01:43,717 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.513, Acc: 0.760, Base Lr: 4.83e-03
2022-04-23 21:02:17,646 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.496, Acc: 0.758, Base Lr: 4.83e-03
2022-04-23 21:02:43,202 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-23 21:03:24,855 reid_baseline.train INFO: normal accuracy 0.6983930778739185 2.6307451725006104 
2022-04-23 21:03:54,865 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 21:03:54,866 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 263.1%
2022-04-23 21:04:30,847 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.346, Acc: 0.786, Base Lr: 5.62e-03
2022-04-23 21:05:08,068 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.318, Acc: 0.795, Base Lr: 5.62e-03
2022-04-23 21:05:34,889 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-04-23 21:06:16,109 reid_baseline.train INFO: normal accuracy 0.7103419859909353 2.399749755859375 
2022-04-23 21:06:46,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 21:06:46,077 reid_baseline.train INFO: Accuracy: 71.0% Mean Entropy: 240.0%
2022-04-23 21:07:21,749 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.206, Acc: 0.826, Base Lr: 6.42e-03
2022-04-23 21:07:55,446 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.195, Acc: 0.824, Base Lr: 6.42e-03
2022-04-23 21:08:20,614 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-23 21:08:58,625 reid_baseline.train INFO: normal accuracy 0.7259991759373713 2.2507269382476807 
2022-04-23 21:09:33,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 21:09:33,556 reid_baseline.train INFO: Accuracy: 72.6% Mean Entropy: 225.1%
2022-04-23 21:10:07,750 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.129, Acc: 0.839, Base Lr: 7.21e-03
2022-04-23 21:10:41,404 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.103, Acc: 0.837, Base Lr: 7.21e-03
2022-04-23 21:11:04,880 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-23 21:11:42,911 reid_baseline.train INFO: normal accuracy 0.7235269880510918 2.163684129714966 
2022-04-23 21:12:13,061 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 21:12:13,061 reid_baseline.train INFO: Accuracy: 72.4% Mean Entropy: 216.4%
2022-04-23 21:12:46,409 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.015, Acc: 0.862, Base Lr: 4.01e-03
2022-04-23 21:13:20,363 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.998, Acc: 0.873, Base Lr: 4.01e-03
2022-04-23 21:13:44,266 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-23 21:14:52,588 reid_baseline.train INFO: normal accuracy 0.7280593325092707 2.0882205963134766 
2022-04-23 21:15:49,397 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 21:15:49,404 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 208.8%
2022-04-23 21:16:25,978 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.977, Acc: 0.881, Base Lr: 3.38e-03
2022-04-23 21:17:00,653 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.998, Acc: 0.874, Base Lr: 3.38e-03
2022-04-23 21:17:24,858 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.350[s] Speed: 45.8[samples/s]
2022-04-23 21:18:05,696 reid_baseline.train INFO: normal accuracy 0.738772146683148 2.0311741828918457 
2022-04-23 21:19:01,915 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 21:19:01,922 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 203.1%
2022-04-23 21:19:39,055 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.015, Acc: 0.863, Base Lr: 2.77e-03
2022-04-23 21:20:13,179 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.963, Acc: 0.880, Base Lr: 2.77e-03
2022-04-23 21:20:38,708 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.354[s] Speed: 45.1[samples/s]
2022-04-23 21:21:18,681 reid_baseline.train INFO: normal accuracy 0.7350638648537289 2.007861852645874 
2022-04-23 21:22:16,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 21:22:16,938 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 200.8%
2022-04-23 21:22:53,891 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.970, Acc: 0.881, Base Lr: 2.20e-03
2022-04-23 21:23:28,508 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.955, Acc: 0.890, Base Lr: 2.20e-03
2022-04-23 21:23:51,594 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-23 21:24:28,641 reid_baseline.train INFO: normal accuracy 0.7371240214256284 2.0489420890808105 
2022-04-23 21:24:28,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 21:24:28,642 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 204.9%
2022-04-23 21:25:04,165 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.943, Acc: 0.883, Base Lr: 1.66e-03
2022-04-23 21:25:35,591 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.918, Acc: 0.893, Base Lr: 1.66e-03
2022-04-23 21:26:01,997 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-23 21:26:42,976 reid_baseline.train INFO: normal accuracy 0.7400082406262876 2.0398762226104736 
2022-04-23 21:26:42,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 21:26:42,977 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 204.0%
2022-04-23 21:27:22,656 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.908, Acc: 0.903, Base Lr: 1.19e-03
2022-04-23 21:27:58,798 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.926, Acc: 0.903, Base Lr: 1.19e-03
2022-04-23 21:28:25,260 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.374[s] Speed: 42.7[samples/s]
2022-04-23 21:29:07,470 reid_baseline.train INFO: normal accuracy 0.7391841779975278 2.0332627296447754 
2022-04-23 21:29:07,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 21:29:07,471 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 203.3%
2022-04-23 21:29:46,963 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.921, Acc: 0.903, Base Lr: 7.78e-04
2022-04-23 21:30:25,299 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.921, Acc: 0.897, Base Lr: 7.78e-04
2022-04-23 21:30:49,948 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.375[s] Speed: 42.6[samples/s]
2022-04-23 21:31:27,834 reid_baseline.train INFO: normal accuracy 0.7424804285125669 2.002568244934082 
2022-04-23 21:31:57,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 21:31:57,864 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 200.3%
2022-04-23 21:32:37,796 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.916, Acc: 0.902, Base Lr: 4.51e-04
2022-04-23 21:33:15,950 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.892, Acc: 0.900, Base Lr: 4.51e-04
2022-04-23 21:33:43,346 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-23 21:34:22,591 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.9981759786605835 
2022-04-23 21:34:52,574 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 21:34:52,574 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 199.8%
2022-04-23 21:35:32,548 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.885, Acc: 0.909, Base Lr: 2.11e-04
2022-04-23 21:36:10,016 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.884, Acc: 0.907, Base Lr: 2.11e-04
2022-04-23 21:36:37,479 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.384[s] Speed: 41.6[samples/s]
2022-04-23 21:37:20,501 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.9952319860458374 
2022-04-23 21:37:50,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 21:37:50,495 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 199.5%
2022-04-23 21:38:31,209 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.867, Acc: 0.909, Base Lr: 6.51e-05
2022-04-23 21:39:08,317 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.867, Acc: 0.903, Base Lr: 6.51e-05
2022-04-23 21:39:34,344 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-23 21:40:16,460 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.9767038822174072 
2022-04-23 21:40:46,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 21:40:46,461 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 197.7%
2022-04-23 21:41:26,211 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.867, Acc: 0.907, Base Lr: 1.60e-05
2022-04-23 21:42:02,869 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.875, Acc: 0.903, Base Lr: 1.60e-05
2022-04-23 21:42:31,161 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.384[s] Speed: 41.7[samples/s]
2022-04-23 21:43:41,014 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.9382761716842651 
2022-04-23 21:44:10,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 21:44:10,998 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 193.8%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_10/transformer_best_model.pth
2022-04-23 21:45:20,189 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.9382761716842651 
2022-04-23 21:45:20,190 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 21:45:20,191 reid_baseline.train INFO: Accuracy: 73.8%
2022-04-23 21:46:00,702 reid_baseline.train INFO: normal accuracy 0.7379480840543882 1.9382761716842651 
2022-04-23 21:46:00,703 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 21:46:00,703 reid_baseline.train INFO: Shuffled Accuracy: 73.8%
2022-04-23 21:46:51,047 reid_baseline.train INFO: normal accuracy 0.9374570446735395 0.8812248110771179 
2022-04-23 21:46:51,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 21:46:51,048 reid_baseline.train INFO: Source Clean Accuracy: 93.7%
2022-04-23 21:46:57,799 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_10
2022-04-23 21:46:57,800 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=10)
2022-04-23 21:46:57,800 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 21:46:57,800 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 21:46:57,801 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 21:47:09,189 reid_baseline.train INFO: start training
2022-04-23 21:47:56,760 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.111, Acc: 0.167, Base Lr: 8.72e-04
2022-04-23 21:48:37,077 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.055, Acc: 0.288, Base Lr: 8.72e-04
2022-04-23 21:49:06,441 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.424[s] Speed: 37.7[samples/s]
2022-04-23 21:50:00,166 reid_baseline.train INFO: normal accuracy 0.5228655102500563 4.171720027923584 
2022-04-23 21:50:40,246 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 21:50:40,247 reid_baseline.train INFO: Accuracy: 52.3% Mean Entropy: 417.2%
2022-04-23 21:51:22,724 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.821, Acc: 0.514, Base Lr: 1.66e-03
2022-04-23 21:51:59,656 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.746, Acc: 0.522, Base Lr: 1.66e-03
2022-04-23 21:52:30,094 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 21:53:25,451 reid_baseline.train INFO: normal accuracy 0.5429150709619284 4.149446964263916 
2022-04-23 21:53:55,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 21:53:55,471 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 414.9%
2022-04-23 21:54:35,856 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.319, Acc: 0.567, Base Lr: 2.46e-03
2022-04-23 21:55:15,259 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.186, Acc: 0.563, Base Lr: 2.46e-03
2022-04-23 21:55:43,932 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-23 21:56:35,020 reid_baseline.train INFO: normal accuracy 0.5731020500112638 3.909834146499634 
2022-04-23 21:57:05,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 21:57:05,073 reid_baseline.train INFO: Accuracy: 57.3% Mean Entropy: 391.0%
2022-04-23 21:57:43,542 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.483, Acc: 0.596, Base Lr: 3.25e-03
2022-04-23 21:58:22,770 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.335, Acc: 0.619, Base Lr: 3.25e-03
2022-04-23 21:58:50,998 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.388[s] Speed: 41.2[samples/s]
2022-04-23 21:59:42,459 reid_baseline.train INFO: normal accuracy 0.6377562514079748 3.2308523654937744 
2022-04-23 22:00:18,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 22:00:18,474 reid_baseline.train INFO: Accuracy: 63.8% Mean Entropy: 323.1%
2022-04-23 22:00:58,975 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.869, Acc: 0.690, Base Lr: 4.04e-03
2022-04-23 22:01:38,326 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.798, Acc: 0.694, Base Lr: 4.04e-03
2022-04-23 22:02:08,091 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-23 22:03:02,732 reid_baseline.train INFO: normal accuracy 0.6843883757603064 2.6702756881713867 
2022-04-23 22:03:49,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 22:03:49,594 reid_baseline.train INFO: Accuracy: 68.4% Mean Entropy: 267.0%
2022-04-23 22:04:29,815 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.505, Acc: 0.759, Base Lr: 4.83e-03
2022-04-23 22:05:09,955 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.496, Acc: 0.758, Base Lr: 4.83e-03
2022-04-23 22:05:38,432 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-23 22:06:34,220 reid_baseline.train INFO: normal accuracy 0.7064654201396711 2.334113597869873 
2022-04-23 22:07:30,639 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 22:07:30,646 reid_baseline.train INFO: Accuracy: 70.6% Mean Entropy: 233.4%
2022-04-23 22:08:12,385 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.347, Acc: 0.779, Base Lr: 5.62e-03
2022-04-23 22:08:51,203 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.316, Acc: 0.793, Base Lr: 5.62e-03
2022-04-23 22:09:19,921 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-23 22:10:13,305 reid_baseline.train INFO: normal accuracy 0.7314710520387475 2.1133079528808594 
2022-04-23 22:11:00,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 22:11:00,521 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 211.3%
2022-04-23 22:11:43,744 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.207, Acc: 0.825, Base Lr: 6.42e-03
2022-04-23 22:12:21,831 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.197, Acc: 0.823, Base Lr: 6.42e-03
2022-04-23 22:12:48,917 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-23 22:13:40,884 reid_baseline.train INFO: normal accuracy 0.7359765712998423 1.9981211423873901 
2022-04-23 22:14:24,958 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 22:14:24,958 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 199.8%
2022-04-23 22:15:06,262 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.127, Acc: 0.834, Base Lr: 7.21e-03
2022-04-23 22:15:45,749 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.103, Acc: 0.837, Base Lr: 7.21e-03
2022-04-23 22:16:15,059 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-23 22:17:02,223 reid_baseline.train INFO: normal accuracy 0.7508447848614552 1.927426815032959 
2022-04-23 22:17:34,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 22:17:34,263 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 192.7%
2022-04-23 22:18:16,195 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.020, Acc: 0.864, Base Lr: 4.01e-03
2022-04-23 22:18:55,498 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 3.003, Acc: 0.868, Base Lr: 4.01e-03
2022-04-23 22:19:24,827 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-23 22:21:09,327 reid_baseline.train INFO: normal accuracy 0.7569272358639333 1.8567326068878174 
2022-04-23 22:21:39,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 22:21:39,330 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 185.7%
2022-04-23 22:22:22,366 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.973, Acc: 0.888, Base Lr: 3.38e-03
2022-04-23 22:23:01,403 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.994, Acc: 0.883, Base Lr: 3.38e-03
2022-04-23 22:23:28,897 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-23 22:24:20,901 reid_baseline.train INFO: normal accuracy 0.759855823383645 1.8180783987045288 
2022-04-23 22:24:50,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 22:24:50,908 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 181.8%
2022-04-23 22:25:32,071 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.014, Acc: 0.859, Base Lr: 2.77e-03
2022-04-23 22:26:12,500 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.961, Acc: 0.880, Base Lr: 2.77e-03
2022-04-23 22:26:40,860 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-23 22:27:33,370 reid_baseline.train INFO: normal accuracy 0.7578283397161523 1.7839208841323853 
2022-04-23 22:28:03,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 22:28:03,349 reid_baseline.train INFO: Accuracy: 75.8% Mean Entropy: 178.4%
2022-04-23 22:28:45,812 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.973, Acc: 0.884, Base Lr: 2.20e-03
2022-04-23 22:29:22,830 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.961, Acc: 0.889, Base Lr: 2.20e-03
2022-04-23 22:29:50,307 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-23 22:30:44,350 reid_baseline.train INFO: normal accuracy 0.7641360666816851 1.8522835969924927 
2022-04-23 22:30:44,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 22:30:44,352 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 185.2%
2022-04-23 22:31:25,649 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.939, Acc: 0.884, Base Lr: 1.66e-03
2022-04-23 22:32:02,880 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.915, Acc: 0.892, Base Lr: 1.66e-03
2022-04-23 22:32:29,470 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.385[s] Speed: 41.6[samples/s]
2022-04-23 22:33:21,093 reid_baseline.train INFO: normal accuracy 0.7670646542013967 1.8258211612701416 
2022-04-23 22:33:21,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-23 22:33:21,095 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 182.6%
2022-04-23 22:34:01,709 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.911, Acc: 0.902, Base Lr: 1.19e-03
2022-04-23 22:34:42,583 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.927, Acc: 0.899, Base Lr: 1.19e-03
2022-04-23 22:35:10,546 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-23 22:36:02,660 reid_baseline.train INFO: normal accuracy 0.7666141022752873 1.8288944959640503 
2022-04-23 22:36:02,660 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-23 22:36:02,660 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 182.9%
2022-04-23 22:36:43,968 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.921, Acc: 0.901, Base Lr: 7.78e-04
2022-04-23 22:37:25,751 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.920, Acc: 0.898, Base Lr: 7.78e-04
2022-04-23 22:37:54,974 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.411[s] Speed: 38.9[samples/s]
2022-04-23 22:38:48,355 reid_baseline.train INFO: normal accuracy 0.7731471052038748 1.8032957315444946 
2022-04-23 22:38:48,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-23 22:38:48,359 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 180.3%
2022-04-23 22:39:32,625 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.917, Acc: 0.904, Base Lr: 4.51e-04
2022-04-23 22:40:15,038 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.893, Acc: 0.902, Base Lr: 4.51e-04
2022-04-23 22:40:46,405 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.432[s] Speed: 37.0[samples/s]
2022-04-23 22:41:41,107 reid_baseline.train INFO: normal accuracy 0.7684163099797252 1.8067930936813354 
2022-04-23 22:41:41,109 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-23 22:41:41,109 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 180.7%
2022-04-23 22:42:25,618 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.883, Acc: 0.911, Base Lr: 2.11e-04
2022-04-23 22:43:06,093 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.880, Acc: 0.906, Base Lr: 2.11e-04
2022-04-23 22:43:34,309 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.414[s] Speed: 38.6[samples/s]
2022-04-23 22:44:25,244 reid_baseline.train INFO: normal accuracy 0.772020725388601 1.8094922304153442 
2022-04-23 22:44:25,246 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-23 22:44:25,246 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 180.9%
2022-04-23 22:45:06,141 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.865, Acc: 0.905, Base Lr: 6.51e-05
2022-04-23 22:45:45,491 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.865, Acc: 0.900, Base Lr: 6.51e-05
2022-04-23 22:46:15,094 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 22:47:06,943 reid_baseline.train INFO: normal accuracy 0.7675152061275062 1.774538278579712 
2022-04-23 22:47:36,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-23 22:47:36,967 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 177.5%
2022-04-23 22:48:19,756 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.869, Acc: 0.907, Base Lr: 1.60e-05
2022-04-23 22:48:58,759 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.876, Acc: 0.904, Base Lr: 1.60e-05
2022-04-23 22:49:27,561 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-23 22:50:48,976 reid_baseline.train INFO: normal accuracy 0.7697679657580536 1.7467514276504517 
2022-04-23 22:51:18,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-23 22:51:18,973 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 174.7%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_10/transformer_best_model.pth
2022-04-23 22:52:41,618 reid_baseline.train INFO: normal accuracy 0.7697679657580536 1.7467514276504517 
2022-04-23 22:52:41,624 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 22:52:41,625 reid_baseline.train INFO: Accuracy: 77.0%
2022-04-23 22:53:35,204 reid_baseline.train INFO: normal accuracy 0.7697679657580536 1.7467514276504517 
2022-04-23 22:53:35,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 22:53:35,216 reid_baseline.train INFO: Shuffled Accuracy: 77.0%
2022-04-23 22:54:23,301 reid_baseline.train INFO: normal accuracy 0.9392898052691867 0.886983335018158 
2022-04-23 22:54:23,301 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-23 22:54:23,301 reid_baseline.train INFO: Source Clean Accuracy: 93.9%
2022-04-23 22:54:29,966 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_10
2022-04-23 22:54:29,967 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=10)
2022-04-23 22:54:29,967 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-23 22:54:29,967 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-23 22:54:29,968 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-23 22:54:41,437 reid_baseline.train INFO: start training
2022-04-23 22:55:29,935 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.112, Acc: 0.167, Base Lr: 8.72e-04
2022-04-23 22:56:09,372 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.057, Acc: 0.283, Base Lr: 8.72e-04
2022-04-23 22:56:37,480 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.420[s] Speed: 38.1[samples/s]
2022-04-23 22:58:43,131 reid_baseline.train INFO: normal accuracy 0.5308698645857242 4.171962738037109 
2022-04-23 22:59:13,060 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-23 22:59:13,060 reid_baseline.train INFO: Accuracy: 53.1% Mean Entropy: 417.2%
2022-04-23 22:59:56,911 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.824, Acc: 0.516, Base Lr: 1.66e-03
2022-04-23 23:00:37,838 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.746, Acc: 0.524, Base Lr: 1.66e-03
2022-04-23 23:01:07,113 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.418[s] Speed: 38.3[samples/s]
2022-04-23 23:03:16,478 reid_baseline.train INFO: normal accuracy 0.5659857700252467 4.152101516723633 
2022-04-23 23:03:46,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-23 23:03:46,470 reid_baseline.train INFO: Accuracy: 56.6% Mean Entropy: 415.2%
2022-04-23 23:04:28,534 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.301, Acc: 0.569, Base Lr: 2.46e-03
2022-04-23 23:05:08,925 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.163, Acc: 0.564, Base Lr: 2.46e-03
2022-04-23 23:05:36,360 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-23 23:07:45,841 reid_baseline.train INFO: normal accuracy 0.5960523295845765 3.9436817169189453 
2022-04-23 23:08:15,842 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-23 23:08:15,842 reid_baseline.train INFO: Accuracy: 59.6% Mean Entropy: 394.4%
2022-04-23 23:08:58,171 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.504, Acc: 0.590, Base Lr: 3.25e-03
2022-04-23 23:09:36,710 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.354, Acc: 0.622, Base Lr: 3.25e-03
2022-04-23 23:10:03,574 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-23 23:12:06,716 reid_baseline.train INFO: normal accuracy 0.6543493229286206 3.2882118225097656 
2022-04-23 23:12:36,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-23 23:12:36,733 reid_baseline.train INFO: Accuracy: 65.4% Mean Entropy: 328.8%
2022-04-23 23:13:19,587 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.881, Acc: 0.695, Base Lr: 4.04e-03
2022-04-23 23:14:00,178 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.812, Acc: 0.695, Base Lr: 4.04e-03
2022-04-23 23:14:28,205 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.408[s] Speed: 39.2[samples/s]
2022-04-23 23:16:40,477 reid_baseline.train INFO: normal accuracy 0.7105806747762222 2.7541306018829346 
2022-04-23 23:17:10,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-23 23:17:10,469 reid_baseline.train INFO: Accuracy: 71.1% Mean Entropy: 275.4%
2022-04-23 23:17:51,753 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.516, Acc: 0.755, Base Lr: 4.83e-03
2022-04-23 23:18:29,202 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.504, Acc: 0.756, Base Lr: 4.83e-03
2022-04-23 23:18:58,451 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-23 23:21:18,238 reid_baseline.train INFO: normal accuracy 0.740647234335552 2.3984105587005615 
2022-04-23 23:21:48,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-23 23:21:48,219 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 239.8%
2022-04-23 23:22:29,314 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.353, Acc: 0.783, Base Lr: 5.62e-03
2022-04-23 23:23:06,676 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.321, Acc: 0.793, Base Lr: 5.62e-03
2022-04-23 23:23:35,231 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-23 23:25:47,922 reid_baseline.train INFO: normal accuracy 0.7592380078035346 2.1815576553344727 
2022-04-23 23:26:17,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-23 23:26:17,940 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 218.2%
2022-04-23 23:27:02,132 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.211, Acc: 0.817, Base Lr: 6.42e-03
2022-04-23 23:27:42,668 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.200, Acc: 0.819, Base Lr: 6.42e-03
2022-04-23 23:28:12,349 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.419[s] Speed: 38.2[samples/s]
2022-04-23 23:30:18,050 reid_baseline.train INFO: normal accuracy 0.765893963736516 2.0361921787261963 
2022-04-23 23:30:48,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-23 23:30:48,048 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 203.6%
2022-04-23 23:31:28,134 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.121, Acc: 0.840, Base Lr: 7.21e-03
2022-04-23 23:32:06,242 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.105, Acc: 0.838, Base Lr: 7.21e-03
2022-04-23 23:32:35,454 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-23 23:34:48,666 reid_baseline.train INFO: normal accuracy 0.7789763598806518 1.9348269701004028 
2022-04-23 23:35:18,640 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-23 23:35:18,641 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 193.5%
2022-04-23 23:35:57,640 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.019, Acc: 0.862, Base Lr: 4.01e-03
2022-04-23 23:36:36,530 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 3.001, Acc: 0.871, Base Lr: 4.01e-03
2022-04-23 23:37:03,964 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-23 23:39:51,062 reid_baseline.train INFO: normal accuracy 0.7794353913243057 1.8837475776672363 
2022-04-23 23:40:30,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-23 23:40:30,264 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 188.4%
2022-04-23 23:41:10,608 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.970, Acc: 0.883, Base Lr: 3.38e-03
2022-04-23 23:41:50,151 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.996, Acc: 0.878, Base Lr: 3.38e-03
2022-04-23 23:42:18,918 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-23 23:44:35,503 reid_baseline.train INFO: normal accuracy 0.7828781271517099 1.8460280895233154 
2022-04-23 23:45:26,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-23 23:45:26,840 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 184.6%
2022-04-23 23:46:13,218 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.015, Acc: 0.866, Base Lr: 2.77e-03
2022-04-23 23:46:53,283 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.963, Acc: 0.884, Base Lr: 2.77e-03
2022-04-23 23:47:23,012 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.426[s] Speed: 37.6[samples/s]
2022-04-23 23:49:34,790 reid_baseline.train INFO: normal accuracy 0.7792058756024788 1.818207859992981 
2022-04-23 23:50:33,092 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-23 23:50:33,097 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 181.8%
2022-04-23 23:51:31,653 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.973, Acc: 0.877, Base Lr: 2.20e-03
2022-04-23 23:52:25,187 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.959, Acc: 0.887, Base Lr: 2.20e-03
2022-04-23 23:52:59,382 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.536[s] Speed: 29.9[samples/s]
2022-04-23 23:55:50,377 reid_baseline.train INFO: normal accuracy 0.7847142529263255 1.8877071142196655 
2022-04-23 23:55:50,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-23 23:55:50,378 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 188.8%
2022-04-23 23:56:43,633 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.943, Acc: 0.882, Base Lr: 1.66e-03
2022-04-23 23:57:30,978 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.919, Acc: 0.892, Base Lr: 1.66e-03
2022-04-23 23:57:59,638 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.473[s] Speed: 33.8[samples/s]
2022-04-24 00:00:10,958 reid_baseline.train INFO: normal accuracy 0.7837961900390177 1.8618401288986206 
2022-04-24 00:00:10,962 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-24 00:00:10,963 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 186.2%
2022-04-24 00:00:51,658 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.913, Acc: 0.901, Base Lr: 1.19e-03
2022-04-24 00:01:31,524 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.931, Acc: 0.901, Base Lr: 1.19e-03
2022-04-24 00:02:00,822 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-24 00:04:10,230 reid_baseline.train INFO: normal accuracy 0.7835666743171907 1.8617851734161377 
2022-04-24 00:04:10,231 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-24 00:04:10,231 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 186.2%
2022-04-24 00:04:51,586 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.923, Acc: 0.901, Base Lr: 7.78e-04
2022-04-24 00:05:30,527 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.920, Acc: 0.897, Base Lr: 7.78e-04
2022-04-24 00:06:00,035 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-24 00:08:12,275 reid_baseline.train INFO: normal accuracy 0.7858618315354602 1.824876308441162 
2022-04-24 00:08:12,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-24 00:08:12,280 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 182.5%
2022-04-24 00:08:55,482 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.921, Acc: 0.901, Base Lr: 4.51e-04
2022-04-24 00:09:36,490 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.893, Acc: 0.901, Base Lr: 4.51e-04
2022-04-24 00:10:07,889 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.423[s] Speed: 37.8[samples/s]
2022-04-24 00:12:20,381 reid_baseline.train INFO: normal accuracy 0.7860913472572871 1.8259257078170776 
2022-04-24 00:12:20,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-24 00:12:20,383 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 182.6%
2022-04-24 00:13:03,485 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.883, Acc: 0.906, Base Lr: 2.11e-04
2022-04-24 00:13:44,972 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.878, Acc: 0.903, Base Lr: 2.11e-04
2022-04-24 00:14:16,274 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.424[s] Speed: 37.7[samples/s]
2022-04-24 00:16:36,495 reid_baseline.train INFO: normal accuracy 0.7856323158136332 1.834206223487854 
2022-04-24 00:16:36,496 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-24 00:16:36,496 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 183.4%
2022-04-24 00:17:22,368 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.867, Acc: 0.904, Base Lr: 6.51e-05
2022-04-24 00:18:05,535 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.865, Acc: 0.902, Base Lr: 6.51e-05
2022-04-24 00:18:38,331 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.446[s] Speed: 35.9[samples/s]
2022-04-24 00:20:49,302 reid_baseline.train INFO: normal accuracy 0.7844847372044985 1.8034147024154663 
2022-04-24 00:21:19,314 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-24 00:21:19,314 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 180.3%
2022-04-24 00:22:02,572 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.863, Acc: 0.909, Base Lr: 1.60e-05
2022-04-24 00:22:42,714 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.873, Acc: 0.905, Base Lr: 1.60e-05
2022-04-24 00:23:13,042 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.416[s] Speed: 38.5[samples/s]
2022-04-24 00:25:50,955 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.7675670385360718 
2022-04-24 00:26:20,959 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-24 00:26:20,960 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 176.8%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_10/transformer_best_model.pth
2022-04-24 00:29:08,508 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.7675670385360718 
2022-04-24 00:29:08,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 00:29:08,510 reid_baseline.train INFO: Accuracy: 78.7%
2022-04-24 00:31:18,763 reid_baseline.train INFO: normal accuracy 0.7872389258664219 1.7675670385360718 
2022-04-24 00:31:18,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 00:31:18,763 reid_baseline.train INFO: Shuffled Accuracy: 78.7%
2022-04-24 00:32:10,955 reid_baseline.train INFO: normal accuracy 0.9388316151202749 0.8826695680618286 
2022-04-24 00:32:10,956 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 00:32:10,956 reid_baseline.train INFO: Source Clean Accuracy: 93.9%
2022-04-24 00:32:17,641 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_12
2022-04-24 00:32:17,641 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_12', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=12)
2022-04-24 00:32:17,642 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-24 00:32:17,642 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-24 00:32:17,642 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_12
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-24 00:32:28,765 reid_baseline.train INFO: start training
2022-04-24 00:33:19,744 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.037, Acc: 0.153, Base Lr: 8.72e-04
2022-04-24 00:33:58,094 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 5.999, Acc: 0.278, Base Lr: 8.72e-04
2022-04-24 00:34:27,290 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.432[s] Speed: 37.1[samples/s]
2022-04-24 00:35:07,526 reid_baseline.train INFO: normal accuracy 0.4647713226205192 4.172215461730957 
2022-04-24 00:35:37,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-24 00:35:37,465 reid_baseline.train INFO: Accuracy: 46.5% Mean Entropy: 417.2%
2022-04-24 00:36:21,696 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.799, Acc: 0.522, Base Lr: 1.66e-03
2022-04-24 00:36:59,187 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.718, Acc: 0.527, Base Lr: 1.66e-03
2022-04-24 00:37:30,501 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.414[s] Speed: 38.6[samples/s]
2022-04-24 00:38:12,206 reid_baseline.train INFO: normal accuracy 0.5092707045735476 4.157186985015869 
2022-04-24 00:38:42,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-24 00:38:42,213 reid_baseline.train INFO: Accuracy: 50.9% Mean Entropy: 415.7%
2022-04-24 00:39:26,354 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.328, Acc: 0.571, Base Lr: 2.46e-03
2022-04-24 00:40:05,296 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.219, Acc: 0.567, Base Lr: 2.46e-03
2022-04-24 00:40:34,368 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.411[s] Speed: 39.0[samples/s]
2022-04-24 00:41:15,448 reid_baseline.train INFO: normal accuracy 0.5467655541821178 4.030815601348877 
2022-04-24 00:41:45,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-24 00:41:45,465 reid_baseline.train INFO: Accuracy: 54.7% Mean Entropy: 403.1%
2022-04-24 00:42:27,923 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.603, Acc: 0.591, Base Lr: 3.25e-03
2022-04-24 00:43:07,721 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.446, Acc: 0.613, Base Lr: 3.25e-03
2022-04-24 00:43:37,602 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.411[s] Speed: 39.0[samples/s]
2022-04-24 00:44:20,413 reid_baseline.train INFO: normal accuracy 0.6048619695096827 3.5189123153686523 
2022-04-24 00:44:50,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-24 00:44:50,429 reid_baseline.train INFO: Accuracy: 60.5% Mean Entropy: 351.9%
2022-04-24 00:45:32,273 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.930, Acc: 0.677, Base Lr: 4.04e-03
2022-04-24 00:46:12,833 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.850, Acc: 0.681, Base Lr: 4.04e-03
2022-04-24 00:46:42,600 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.411[s] Speed: 38.9[samples/s]
2022-04-24 00:47:22,762 reid_baseline.train INFO: normal accuracy 0.6563658838071693 3.0617733001708984 
2022-04-24 00:47:52,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-24 00:47:52,748 reid_baseline.train INFO: Accuracy: 65.6% Mean Entropy: 306.2%
2022-04-24 00:48:34,093 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.547, Acc: 0.753, Base Lr: 4.83e-03
2022-04-24 00:49:16,085 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.532, Acc: 0.749, Base Lr: 4.83e-03
2022-04-24 00:49:46,031 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.415[s] Speed: 38.6[samples/s]
2022-04-24 00:50:27,564 reid_baseline.train INFO: normal accuracy 0.6905644829007005 2.6501998901367188 
2022-04-24 00:51:06,746 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-24 00:51:06,753 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 265.0%
2022-04-24 00:51:49,783 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.371, Acc: 0.774, Base Lr: 5.62e-03
2022-04-24 00:52:31,026 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.336, Acc: 0.787, Base Lr: 5.62e-03
2022-04-24 00:53:00,769 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.418[s] Speed: 38.3[samples/s]
2022-04-24 00:53:44,697 reid_baseline.train INFO: normal accuracy 0.7058096415327565 2.4102933406829834 
2022-04-24 00:54:37,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-24 00:54:37,320 reid_baseline.train INFO: Accuracy: 70.6% Mean Entropy: 241.0%
2022-04-24 00:55:21,323 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.222, Acc: 0.813, Base Lr: 6.42e-03
2022-04-24 00:56:02,176 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.210, Acc: 0.813, Base Lr: 6.42e-03
2022-04-24 00:56:32,616 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.422[s] Speed: 37.9[samples/s]
2022-04-24 00:57:12,987 reid_baseline.train INFO: normal accuracy 0.7338277709105891 2.2857420444488525 
2022-04-24 00:58:06,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-24 00:58:06,474 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 228.6%
2022-04-24 00:58:49,435 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.131, Acc: 0.834, Base Lr: 7.21e-03
2022-04-24 00:59:28,550 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.118, Acc: 0.833, Base Lr: 7.21e-03
2022-04-24 00:59:56,442 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-24 01:00:36,729 reid_baseline.train INFO: normal accuracy 0.7264112072517511 2.1424031257629395 
2022-04-24 01:01:22,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-24 01:01:22,512 reid_baseline.train INFO: Accuracy: 72.6% Mean Entropy: 214.2%
2022-04-24 01:02:04,713 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.019, Acc: 0.858, Base Lr: 4.01e-03
2022-04-24 01:02:47,971 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 3.002, Acc: 0.870, Base Lr: 4.01e-03
2022-04-24 01:03:18,473 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.425[s] Speed: 37.7[samples/s]
2022-04-24 01:04:29,996 reid_baseline.train INFO: normal accuracy 0.7288833951380305 2.0594584941864014 
2022-04-24 01:05:05,861 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-24 01:05:05,861 reid_baseline.train INFO: Accuracy: 72.9% Mean Entropy: 205.9%
2022-04-24 01:05:50,545 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.983, Acc: 0.877, Base Lr: 3.38e-03
2022-04-24 01:06:32,788 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.996, Acc: 0.871, Base Lr: 3.38e-03
2022-04-24 01:07:03,077 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.429[s] Speed: 37.3[samples/s]
2022-04-24 01:07:40,527 reid_baseline.train INFO: normal accuracy 0.7395962093119077 2.057920455932617 
2022-04-24 01:08:10,547 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-24 01:08:10,547 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 205.8%
2022-04-24 01:08:54,098 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.022, Acc: 0.866, Base Lr: 2.77e-03
2022-04-24 01:09:36,652 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.970, Acc: 0.883, Base Lr: 2.77e-03
2022-04-24 01:10:06,797 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.426[s] Speed: 37.6[samples/s]
2022-04-24 01:10:48,228 reid_baseline.train INFO: normal accuracy 0.7371240214256284 1.98476243019104 
2022-04-24 01:11:18,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-24 01:11:18,266 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 198.5%
2022-04-24 01:12:02,967 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.975, Acc: 0.879, Base Lr: 2.20e-03
2022-04-24 01:12:45,557 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.950, Acc: 0.888, Base Lr: 2.20e-03
2022-04-24 01:13:13,216 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.421[s] Speed: 38.0[samples/s]
2022-04-24 01:13:54,986 reid_baseline.train INFO: normal accuracy 0.7367119901112484 2.0421433448791504 
2022-04-24 01:13:54,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-24 01:13:54,988 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 204.2%
2022-04-24 01:14:39,238 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.959, Acc: 0.879, Base Lr: 1.66e-03
2022-04-24 01:15:19,199 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.932, Acc: 0.891, Base Lr: 1.66e-03
2022-04-24 01:15:49,117 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.418[s] Speed: 38.3[samples/s]
2022-04-24 01:16:31,647 reid_baseline.train INFO: normal accuracy 0.7395962093119077 2.009734869003296 
2022-04-24 01:16:31,648 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-24 01:16:31,648 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 201.0%
2022-04-24 01:17:14,548 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.894, Acc: 0.903, Base Lr: 1.19e-03
2022-04-24 01:17:56,640 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.912, Acc: 0.900, Base Lr: 1.19e-03
2022-04-24 01:18:28,064 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.426[s] Speed: 37.5[samples/s]
2022-04-24 01:19:14,181 reid_baseline.train INFO: normal accuracy 0.7416563658838071 2.006856918334961 
2022-04-24 01:19:14,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-24 01:19:14,182 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 200.7%
2022-04-24 01:19:58,257 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.922, Acc: 0.899, Base Lr: 7.78e-04
2022-04-24 01:20:41,988 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.913, Acc: 0.898, Base Lr: 7.78e-04
2022-04-24 01:21:14,114 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.439[s] Speed: 36.4[samples/s]
2022-04-24 01:21:59,335 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.9842123985290527 
2022-04-24 01:22:47,930 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-24 01:22:47,936 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 198.4%
2022-04-24 01:23:30,997 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.925, Acc: 0.897, Base Lr: 4.51e-04
2022-04-24 01:24:12,111 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.901, Acc: 0.898, Base Lr: 4.51e-04
2022-04-24 01:24:41,598 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.416[s] Speed: 38.4[samples/s]
2022-04-24 01:25:23,460 reid_baseline.train INFO: normal accuracy 0.7441285537700866 1.9794020652770996 
2022-04-24 01:26:21,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-24 01:26:21,919 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 197.9%
2022-04-24 01:27:04,243 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.881, Acc: 0.902, Base Lr: 2.11e-04
2022-04-24 01:27:43,823 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.879, Acc: 0.903, Base Lr: 2.11e-04
2022-04-24 01:28:12,988 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.407[s] Speed: 39.3[samples/s]
2022-04-24 01:28:53,915 reid_baseline.train INFO: normal accuracy 0.7420683971981871 1.9607328176498413 
2022-04-24 01:29:33,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-24 01:29:33,997 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 196.1%
2022-04-24 01:30:13,685 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.873, Acc: 0.901, Base Lr: 6.51e-05
2022-04-24 01:30:53,695 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.883, Acc: 0.899, Base Lr: 6.51e-05
2022-04-24 01:31:23,785 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-24 01:32:06,643 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9606356620788574 
2022-04-24 01:32:36,604 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-24 01:32:36,605 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 196.1%
2022-04-24 01:33:17,951 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.874, Acc: 0.908, Base Lr: 1.60e-05
2022-04-24 01:33:58,290 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.882, Acc: 0.903, Base Lr: 1.60e-05
2022-04-24 01:34:27,485 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.406[s] Speed: 39.4[samples/s]
2022-04-24 01:35:39,478 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.923704743385315 
2022-04-24 01:36:36,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-24 01:36:36,353 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 192.4%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_CEL_layer_12/transformer_best_model.pth
2022-04-24 01:37:48,547 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.923704743385315 
2022-04-24 01:37:48,548 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 01:37:48,548 reid_baseline.train INFO: Accuracy: 74.0%
2022-04-24 01:38:29,560 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.923704743385315 
2022-04-24 01:38:29,561 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 01:38:29,561 reid_baseline.train INFO: Shuffled Accuracy: 74.0%
2022-04-24 01:39:21,939 reid_baseline.train INFO: normal accuracy 0.9367697594501718 0.9058756232261658 
2022-04-24 01:39:21,946 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 01:39:21,946 reid_baseline.train INFO: Source Clean Accuracy: 93.7%
2022-04-24 01:39:29,356 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_12
2022-04-24 01:39:29,356 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_12', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=12)
2022-04-24 01:39:29,357 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-24 01:39:29,357 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-24 01:39:29,357 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_12
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-24 01:39:38,937 reid_baseline.train INFO: start training
2022-04-24 01:40:29,402 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.038, Acc: 0.157, Base Lr: 8.72e-04
2022-04-24 01:41:09,332 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.002, Acc: 0.282, Base Lr: 8.72e-04
2022-04-24 01:41:38,850 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.437[s] Speed: 36.6[samples/s]
2022-04-24 01:42:33,737 reid_baseline.train INFO: normal accuracy 0.5212885785086732 4.171957492828369 
2022-04-24 01:43:22,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-24 01:43:22,983 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 417.2%
2022-04-24 01:44:06,208 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.808, Acc: 0.523, Base Lr: 1.66e-03
2022-04-24 01:44:46,653 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.717, Acc: 0.530, Base Lr: 1.66e-03
2022-04-24 01:45:19,380 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.426[s] Speed: 37.5[samples/s]
2022-04-24 01:46:08,894 reid_baseline.train INFO: normal accuracy 0.551926109484118 4.151192665100098 
2022-04-24 01:46:43,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-24 01:46:43,951 reid_baseline.train INFO: Accuracy: 55.2% Mean Entropy: 415.1%
2022-04-24 01:47:20,136 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.315, Acc: 0.573, Base Lr: 2.46e-03
2022-04-24 01:47:52,549 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.193, Acc: 0.568, Base Lr: 2.46e-03
2022-04-24 01:48:17,249 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-24 01:49:05,502 reid_baseline.train INFO: normal accuracy 0.5778328452354133 3.9474010467529297 
2022-04-24 01:49:41,362 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-24 01:49:41,363 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 394.7%
2022-04-24 01:50:14,906 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.547, Acc: 0.590, Base Lr: 3.25e-03
2022-04-24 01:50:49,597 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.395, Acc: 0.615, Base Lr: 3.25e-03
2022-04-24 01:51:14,934 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-24 01:52:05,109 reid_baseline.train INFO: normal accuracy 0.6334760081099347 3.2781782150268555 
2022-04-24 01:52:45,976 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-24 01:52:45,977 reid_baseline.train INFO: Accuracy: 63.3% Mean Entropy: 327.8%
2022-04-24 01:53:20,261 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.902, Acc: 0.685, Base Lr: 4.04e-03
2022-04-24 01:53:51,820 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.825, Acc: 0.687, Base Lr: 4.04e-03
2022-04-24 01:54:14,241 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-24 01:55:02,106 reid_baseline.train INFO: normal accuracy 0.6850642036494706 2.7217977046966553 
2022-04-24 01:55:51,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-24 01:55:51,078 reid_baseline.train INFO: Accuracy: 68.5% Mean Entropy: 272.2%
2022-04-24 01:56:23,665 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.531, Acc: 0.753, Base Lr: 4.83e-03
2022-04-24 01:56:55,576 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.516, Acc: 0.751, Base Lr: 4.83e-03
2022-04-24 01:57:18,752 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-24 01:58:11,964 reid_baseline.train INFO: normal accuracy 0.7116467672899301 2.3397858142852783 
2022-04-24 01:59:03,066 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-24 01:59:03,066 reid_baseline.train INFO: Accuracy: 71.2% Mean Entropy: 234.0%
2022-04-24 01:59:37,046 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.361, Acc: 0.784, Base Lr: 5.62e-03
2022-04-24 02:00:09,748 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.326, Acc: 0.793, Base Lr: 5.62e-03
2022-04-24 02:00:32,330 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-24 02:01:22,845 reid_baseline.train INFO: normal accuracy 0.7307952241495832 2.1174168586730957 
2022-04-24 02:02:16,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-24 02:02:16,438 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 211.7%
2022-04-24 02:02:52,728 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.218, Acc: 0.816, Base Lr: 6.42e-03
2022-04-24 02:03:24,668 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.205, Acc: 0.815, Base Lr: 6.42e-03
2022-04-24 02:03:48,778 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-24 02:04:38,738 reid_baseline.train INFO: normal accuracy 0.7366523991890065 2.0036699771881104 
2022-04-24 02:05:08,768 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-24 02:05:08,769 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 200.4%
2022-04-24 02:05:46,736 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.117, Acc: 0.839, Base Lr: 7.21e-03
2022-04-24 02:06:20,581 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.106, Acc: 0.842, Base Lr: 7.21e-03
2022-04-24 02:06:43,505 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-24 02:07:32,343 reid_baseline.train INFO: normal accuracy 0.7548997521964407 1.9027496576309204 
2022-04-24 02:08:30,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-24 02:08:30,236 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 190.3%
2022-04-24 02:09:04,047 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.012, Acc: 0.863, Base Lr: 4.01e-03
2022-04-24 02:09:35,810 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.999, Acc: 0.870, Base Lr: 4.01e-03
2022-04-24 02:09:58,109 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-24 02:11:15,158 reid_baseline.train INFO: normal accuracy 0.7582788916422618 1.9023630619049072 
2022-04-24 02:11:50,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-24 02:11:50,073 reid_baseline.train INFO: Accuracy: 75.8% Mean Entropy: 190.2%
2022-04-24 02:12:25,672 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.978, Acc: 0.880, Base Lr: 3.38e-03
2022-04-24 02:12:56,914 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.991, Acc: 0.875, Base Lr: 3.38e-03
2022-04-24 02:13:20,126 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-24 02:14:08,057 reid_baseline.train INFO: normal accuracy 0.7657129984230683 1.8180698156356812 
2022-04-24 02:14:38,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-24 02:14:38,045 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 181.8%
2022-04-24 02:15:12,863 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.011, Acc: 0.869, Base Lr: 2.77e-03
2022-04-24 02:15:43,554 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.959, Acc: 0.885, Base Lr: 2.77e-03
2022-04-24 02:16:07,240 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.327[s] Speed: 49.0[samples/s]
2022-04-24 02:16:55,452 reid_baseline.train INFO: normal accuracy 0.7650371705339041 1.8161076307296753 
2022-04-24 02:17:25,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-24 02:17:25,432 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 181.6%
2022-04-24 02:18:00,408 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.967, Acc: 0.882, Base Lr: 2.20e-03
2022-04-24 02:18:32,047 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.944, Acc: 0.890, Base Lr: 2.20e-03
2022-04-24 02:18:54,585 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.327[s] Speed: 49.0[samples/s]
2022-04-24 02:19:45,393 reid_baseline.train INFO: normal accuracy 0.7679657580536157 1.8513367176055908 
2022-04-24 02:19:45,394 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-24 02:19:45,394 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 185.1%
2022-04-24 02:20:19,530 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.956, Acc: 0.884, Base Lr: 1.66e-03
2022-04-24 02:20:51,929 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.928, Acc: 0.892, Base Lr: 1.66e-03
2022-04-24 02:21:15,077 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-24 02:22:04,054 reid_baseline.train INFO: normal accuracy 0.7675152061275062 1.8254224061965942 
2022-04-24 02:22:04,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-24 02:22:04,058 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 182.5%
2022-04-24 02:22:36,805 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.887, Acc: 0.905, Base Lr: 1.19e-03
2022-04-24 02:23:08,606 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.907, Acc: 0.903, Base Lr: 1.19e-03
2022-04-24 02:23:31,984 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-24 02:24:21,980 reid_baseline.train INFO: normal accuracy 0.7679657580536157 1.8337236642837524 
2022-04-24 02:24:21,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-24 02:24:21,981 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 183.4%
2022-04-24 02:24:56,145 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.911, Acc: 0.901, Base Lr: 7.78e-04
2022-04-24 02:25:28,834 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.903, Acc: 0.900, Base Lr: 7.78e-04
2022-04-24 02:25:52,044 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-24 02:26:39,859 reid_baseline.train INFO: normal accuracy 0.7740482090560937 1.7927018404006958 
2022-04-24 02:27:09,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-24 02:27:09,807 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 179.3%
2022-04-24 02:27:44,451 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.918, Acc: 0.904, Base Lr: 4.51e-04
2022-04-24 02:28:15,042 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.897, Acc: 0.901, Base Lr: 4.51e-04
2022-04-24 02:28:36,823 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-24 02:29:24,975 reid_baseline.train INFO: normal accuracy 0.7740482090560937 1.7939919233322144 
2022-04-24 02:29:24,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-24 02:29:24,976 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 179.4%
2022-04-24 02:29:59,978 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.878, Acc: 0.905, Base Lr: 2.11e-04
2022-04-24 02:30:28,899 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.875, Acc: 0.907, Base Lr: 2.11e-04
2022-04-24 02:30:50,064 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.312[s] Speed: 51.3[samples/s]
2022-04-24 02:31:40,015 reid_baseline.train INFO: normal accuracy 0.7740482090560937 1.7945311069488525 
2022-04-24 02:31:40,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-24 02:31:40,019 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 179.5%
2022-04-24 02:32:10,450 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.858, Acc: 0.911, Base Lr: 6.51e-05
2022-04-24 02:32:39,236 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.873, Acc: 0.901, Base Lr: 6.51e-05
2022-04-24 02:33:02,356 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.302[s] Speed: 53.1[samples/s]
2022-04-24 02:33:54,167 reid_baseline.train INFO: normal accuracy 0.770218517684163 1.7658209800720215 
2022-04-24 02:34:24,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-24 02:34:24,179 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 176.6%
2022-04-24 02:35:02,985 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.868, Acc: 0.910, Base Lr: 1.60e-05
2022-04-24 02:35:35,821 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.876, Acc: 0.909, Base Lr: 1.60e-05
2022-04-24 02:35:59,556 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-24 02:37:17,885 reid_baseline.train INFO: normal accuracy 0.7717954494255463 1.7400168180465698 
2022-04-24 02:37:47,865 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-24 02:37:47,866 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 174.0%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_CEL_layer_12/transformer_best_model.pth
2022-04-24 02:39:05,968 reid_baseline.train INFO: normal accuracy 0.7717954494255463 1.7400168180465698 
2022-04-24 02:39:05,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 02:39:05,970 reid_baseline.train INFO: Accuracy: 77.2%
2022-04-24 02:39:52,200 reid_baseline.train INFO: normal accuracy 0.7717954494255463 1.7400168180465698 
2022-04-24 02:39:52,201 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 02:39:52,201 reid_baseline.train INFO: Shuffled Accuracy: 77.2%
2022-04-24 02:40:39,366 reid_baseline.train INFO: normal accuracy 0.9397479954180985 0.9017875790596008 
2022-04-24 02:40:39,367 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 02:40:39,367 reid_baseline.train INFO: Source Clean Accuracy: 94.0%
2022-04-24 02:40:45,526 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_12
2022-04-24 02:40:45,527 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_12', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, layer_num=12)
2022-04-24 02:40:45,527 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-24 02:40:45,527 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-24 02:40:45,528 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_12
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-24 02:40:55,486 reid_baseline.train INFO: start training
2022-04-24 02:41:34,457 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 6.039, Acc: 0.156, Base Lr: 8.72e-04
2022-04-24 02:42:05,516 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 6.001, Acc: 0.280, Base Lr: 8.72e-04
2022-04-24 02:42:27,289 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-24 02:44:23,270 reid_baseline.train INFO: normal accuracy 0.5352306633004361 4.17221212387085 
2022-04-24 02:44:53,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-24 02:44:53,192 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 417.2%
2022-04-24 02:45:25,436 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 5.811, Acc: 0.527, Base Lr: 1.66e-03
2022-04-24 02:45:55,412 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 5.723, Acc: 0.530, Base Lr: 1.66e-03
2022-04-24 02:46:19,375 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.316[s] Speed: 50.7[samples/s]
2022-04-24 02:48:31,595 reid_baseline.train INFO: normal accuracy 0.5675923800780354 4.155862808227539 
2022-04-24 02:49:01,539 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-24 02:49:01,539 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 415.6%
2022-04-24 02:49:33,984 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 5.326, Acc: 0.569, Base Lr: 2.46e-03
2022-04-24 02:50:03,677 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 5.212, Acc: 0.564, Base Lr: 2.46e-03
2022-04-24 02:50:26,096 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.310[s] Speed: 51.7[samples/s]
2022-04-24 02:52:26,580 reid_baseline.train INFO: normal accuracy 0.5891668579297682 3.99145770072937 
2022-04-24 02:52:56,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-24 02:52:56,541 reid_baseline.train INFO: Accuracy: 58.9% Mean Entropy: 399.1%
2022-04-24 02:53:29,202 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 4.587, Acc: 0.595, Base Lr: 3.25e-03
2022-04-24 02:54:00,423 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 4.427, Acc: 0.610, Base Lr: 3.25e-03
2022-04-24 02:54:22,936 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.316[s] Speed: 50.6[samples/s]
2022-04-24 02:56:15,946 reid_baseline.train INFO: normal accuracy 0.6548083543722745 3.35922908782959 
2022-04-24 02:56:45,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-24 02:56:45,916 reid_baseline.train INFO: Accuracy: 65.5% Mean Entropy: 335.9%
2022-04-24 02:57:18,622 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.925, Acc: 0.670, Base Lr: 4.04e-03
2022-04-24 02:57:49,105 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.845, Acc: 0.677, Base Lr: 4.04e-03
2022-04-24 02:58:11,242 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.312[s] Speed: 51.2[samples/s]
2022-04-24 03:00:07,987 reid_baseline.train INFO: normal accuracy 0.7089740647234336 2.808422088623047 
2022-04-24 03:00:37,968 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-24 03:00:37,968 reid_baseline.train INFO: Accuracy: 70.9% Mean Entropy: 280.8%
2022-04-24 03:01:09,726 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.544, Acc: 0.754, Base Lr: 4.83e-03
2022-04-24 03:01:40,983 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.527, Acc: 0.751, Base Lr: 4.83e-03
2022-04-24 03:02:03,417 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.313[s] Speed: 51.1[samples/s]
2022-04-24 03:04:11,999 reid_baseline.train INFO: normal accuracy 0.745008033050264 2.4017996788024902 
2022-04-24 03:04:41,945 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-24 03:04:41,946 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 240.2%
2022-04-24 03:05:14,939 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.370, Acc: 0.775, Base Lr: 5.62e-03
2022-04-24 03:05:46,220 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.335, Acc: 0.787, Base Lr: 5.62e-03
2022-04-24 03:06:07,788 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.314[s] Speed: 50.9[samples/s]
2022-04-24 03:08:04,071 reid_baseline.train INFO: normal accuracy 0.7580904291943998 2.169499158859253 
2022-04-24 03:08:34,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-24 03:08:34,032 reid_baseline.train INFO: Accuracy: 75.8% Mean Entropy: 216.9%
2022-04-24 03:09:07,169 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.211, Acc: 0.812, Base Lr: 6.42e-03
2022-04-24 03:09:38,356 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.202, Acc: 0.815, Base Lr: 6.42e-03
2022-04-24 03:10:01,376 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-24 03:11:54,861 reid_baseline.train INFO: normal accuracy 0.7757631397750746 2.0767157077789307 
2022-04-24 03:12:24,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-24 03:12:24,815 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 207.7%
2022-04-24 03:12:56,687 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 3.124, Acc: 0.837, Base Lr: 7.21e-03
2022-04-24 03:13:25,613 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.109, Acc: 0.835, Base Lr: 7.21e-03
2022-04-24 03:13:48,210 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.305[s] Speed: 52.4[samples/s]
2022-04-24 03:15:51,542 reid_baseline.train INFO: normal accuracy 0.778517328436998 1.9347399473190308 
2022-04-24 03:16:21,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-24 03:16:21,503 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 193.5%
2022-04-24 03:16:53,146 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 3.023, Acc: 0.859, Base Lr: 4.01e-03
2022-04-24 03:17:22,845 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 3.002, Acc: 0.871, Base Lr: 4.01e-03
2022-04-24 03:17:44,920 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.305[s] Speed: 52.4[samples/s]
2022-04-24 03:20:09,551 reid_baseline.train INFO: normal accuracy 0.7844847372044985 1.880149483680725 
2022-04-24 03:20:40,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-24 03:20:40,055 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 188.0%
2022-04-24 03:21:12,968 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.978, Acc: 0.882, Base Lr: 3.38e-03
2022-04-24 03:21:44,594 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.995, Acc: 0.876, Base Lr: 3.38e-03
2022-04-24 03:22:06,144 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.315[s] Speed: 50.7[samples/s]
2022-04-24 03:24:05,994 reid_baseline.train INFO: normal accuracy 0.7863208629791141 1.8596255779266357 
2022-04-24 03:24:35,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-24 03:24:35,948 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 186.0%
2022-04-24 03:25:08,844 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 3.012, Acc: 0.869, Base Lr: 2.77e-03
2022-04-24 03:25:39,031 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.964, Acc: 0.886, Base Lr: 2.77e-03
2022-04-24 03:26:00,311 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.309[s] Speed: 51.8[samples/s]
2022-04-24 03:28:06,535 reid_baseline.train INFO: normal accuracy 0.7840257057608446 1.7884080410003662 
2022-04-24 03:28:36,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-24 03:28:36,482 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 178.8%
2022-04-24 03:29:09,399 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.963, Acc: 0.886, Base Lr: 2.20e-03
2022-04-24 03:29:39,568 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.944, Acc: 0.892, Base Lr: 2.20e-03
2022-04-24 03:29:59,257 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.303[s] Speed: 52.8[samples/s]
2022-04-24 03:32:02,041 reid_baseline.train INFO: normal accuracy 0.7876979573100757 1.8654855489730835 
2022-04-24 03:32:02,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-24 03:32:02,041 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 186.5%
2022-04-24 03:32:33,648 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.951, Acc: 0.882, Base Lr: 1.66e-03
2022-04-24 03:33:04,160 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.931, Acc: 0.892, Base Lr: 1.66e-03
2022-04-24 03:33:25,668 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.306[s] Speed: 52.2[samples/s]
2022-04-24 03:35:23,747 reid_baseline.train INFO: normal accuracy 0.7854028000918063 1.8389511108398438 
2022-04-24 03:35:23,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-24 03:35:23,748 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 183.9%
2022-04-24 03:35:56,627 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.891, Acc: 0.910, Base Lr: 1.19e-03
2022-04-24 03:36:27,008 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.909, Acc: 0.905, Base Lr: 1.19e-03
2022-04-24 03:36:48,475 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.310[s] Speed: 51.6[samples/s]
2022-04-24 03:38:48,342 reid_baseline.train INFO: normal accuracy 0.7851732843699794 1.8448073863983154 
2022-04-24 03:38:48,342 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-24 03:38:48,342 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 184.5%
2022-04-24 03:39:21,442 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.924, Acc: 0.897, Base Lr: 7.78e-04
2022-04-24 03:39:51,323 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.915, Acc: 0.896, Base Lr: 7.78e-04
2022-04-24 03:40:12,956 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.310[s] Speed: 51.7[samples/s]
2022-04-24 03:42:09,474 reid_baseline.train INFO: normal accuracy 0.7858618315354602 1.8102155923843384 
2022-04-24 03:42:09,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-24 03:42:09,475 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 181.0%
2022-04-24 03:42:43,204 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.923, Acc: 0.902, Base Lr: 4.51e-04
2022-04-24 03:43:13,251 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.903, Acc: 0.899, Base Lr: 4.51e-04
2022-04-24 03:43:36,563 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-24 03:45:39,587 reid_baseline.train INFO: normal accuracy 0.7881569887537296 1.8113006353378296 
2022-04-24 03:45:39,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-24 03:45:39,588 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 181.1%
2022-04-24 03:46:12,343 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.879, Acc: 0.902, Base Lr: 2.11e-04
2022-04-24 03:46:43,272 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.875, Acc: 0.903, Base Lr: 2.11e-04
2022-04-24 03:47:04,551 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.311[s] Speed: 51.5[samples/s]
2022-04-24 03:49:00,591 reid_baseline.train INFO: normal accuracy 0.7888455359192105 1.807566523551941 
2022-04-24 03:49:00,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-24 03:49:00,600 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 180.8%
2022-04-24 03:49:31,750 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.866, Acc: 0.904, Base Lr: 6.51e-05
2022-04-24 03:50:01,931 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.879, Acc: 0.899, Base Lr: 6.51e-05
2022-04-24 03:50:24,109 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.306[s] Speed: 52.3[samples/s]
2022-04-24 03:52:16,536 reid_baseline.train INFO: normal accuracy 0.786550378700941 1.7891356945037842 
2022-04-24 03:52:16,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-24 03:52:16,537 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 178.9%
2022-04-24 03:52:49,717 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.875, Acc: 0.909, Base Lr: 1.60e-05
2022-04-24 03:53:20,863 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.879, Acc: 0.907, Base Lr: 1.60e-05
2022-04-24 03:53:43,393 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-24 03:56:16,038 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7544021606445312 
2022-04-24 03:56:46,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-24 03:56:46,021 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 175.4%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_CEL_layer_12/transformer_best_model.pth
2022-04-24 03:59:15,484 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7544021606445312 
2022-04-24 03:59:15,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 03:59:15,485 reid_baseline.train INFO: Accuracy: 79.1%
2022-04-24 04:01:12,889 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.7544021606445312 
2022-04-24 04:01:12,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 04:01:12,889 reid_baseline.train INFO: Shuffled Accuracy: 79.1%
2022-04-24 04:02:00,506 reid_baseline.train INFO: normal accuracy 0.9381443298969072 0.9094341397285461 
2022-04-24 04:02:00,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-24 04:02:00,508 reid_baseline.train INFO: Source Clean Accuracy: 93.8%
