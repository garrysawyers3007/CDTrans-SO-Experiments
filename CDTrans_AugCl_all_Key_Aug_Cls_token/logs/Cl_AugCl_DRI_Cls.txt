2022-05-02 21:06:17,638 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls
2022-05-02 21:06:17,638 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-02 21:06:17,638 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-02 21:06:17,638 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-02 21:06:17,639 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-02 21:06:30,198 reid_baseline.train INFO: start training
2022-05-02 21:07:40,576 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.132, Acc: 0.175, Base Lr: 8.72e-04
2022-05-02 21:08:36,858 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.263, Base Lr: 8.72e-04
2022-05-02 21:09:16,781 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.605[s] Speed: 26.5[samples/s]
2022-05-02 21:10:29,624 reid_baseline.train INFO: normal accuracy 0.3860733415739596 4.169071197509766 
2022-05-02 21:10:30,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-02 21:10:30,524 reid_baseline.train INFO: Accuracy: 38.6% Mean Entropy: 416.9%
2022-05-02 21:11:26,895 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.752, Acc: 0.471, Base Lr: 1.66e-03
2022-05-02 21:12:26,917 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.613, Acc: 0.484, Base Lr: 1.66e-03
2022-05-02 21:13:09,125 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.581[s] Speed: 27.5[samples/s]
2022-05-02 21:14:52,605 reid_baseline.train INFO: normal accuracy 0.449938195302843 4.101027488708496 
2022-05-02 21:14:53,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-02 21:14:53,950 reid_baseline.train INFO: Accuracy: 45.0% Mean Entropy: 410.1%
2022-05-02 21:16:10,699 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.885, Acc: 0.571, Base Lr: 2.46e-03
2022-05-02 21:17:24,378 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.718, Acc: 0.578, Base Lr: 2.46e-03
2022-05-02 21:18:15,941 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.740[s] Speed: 21.6[samples/s]
2022-05-02 21:19:49,194 reid_baseline.train INFO: normal accuracy 0.5760197775030902 3.738939046859741 
2022-05-02 21:19:50,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-02 21:19:50,393 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 373.9%
2022-05-02 21:21:04,122 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.142, Acc: 0.669, Base Lr: 3.25e-03
2022-05-02 21:22:09,321 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.048, Acc: 0.683, Base Lr: 3.25e-03
2022-05-02 21:22:54,098 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.673[s] Speed: 23.8[samples/s]
2022-05-02 21:24:51,335 reid_baseline.train INFO: normal accuracy 0.6530696332921302 3.2394633293151855 
2022-05-02 21:24:54,302 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-02 21:24:54,302 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 323.9%
2022-05-02 21:26:09,740 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.734, Acc: 0.741, Base Lr: 4.04e-03
2022-05-02 21:27:25,974 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.686, Acc: 0.751, Base Lr: 4.04e-03
2022-05-02 21:28:07,645 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.708[s] Speed: 22.6[samples/s]
2022-05-02 21:29:45,204 reid_baseline.train INFO: normal accuracy 0.6872682323856613 2.909785270690918 
2022-05-02 21:29:46,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-02 21:29:46,354 reid_baseline.train INFO: Accuracy: 68.7% Mean Entropy: 291.0%
2022-05-02 21:30:43,970 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.489, Acc: 0.801, Base Lr: 4.83e-03
2022-05-02 21:31:39,511 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.476, Acc: 0.797, Base Lr: 4.83e-03
2022-05-02 21:32:24,105 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-05-02 21:34:04,023 reid_baseline.train INFO: normal accuracy 0.7045735475896168 2.7172985076904297 
2022-05-02 21:34:05,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-02 21:34:05,238 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 271.7%
2022-05-02 21:35:17,840 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.368, Acc: 0.824, Base Lr: 5.62e-03
2022-05-02 21:36:20,425 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.364, Acc: 0.829, Base Lr: 5.62e-03
2022-05-02 21:37:02,312 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.648[s] Speed: 24.7[samples/s]
2022-05-02 21:38:41,172 reid_baseline.train INFO: normal accuracy 0.715286361763494 2.6145007610321045 
2022-05-02 21:38:42,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-02 21:38:42,365 reid_baseline.train INFO: Accuracy: 71.5% Mean Entropy: 261.5%
2022-05-02 21:39:49,507 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.259, Acc: 0.863, Base Lr: 6.42e-03
2022-05-02 21:40:53,202 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.264, Acc: 0.860, Base Lr: 6.42e-03
2022-05-02 21:41:31,053 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.618[s] Speed: 25.9[samples/s]
2022-05-02 21:43:00,752 reid_baseline.train INFO: normal accuracy 0.7144622991347342 2.540652275085449 
2022-05-02 21:43:03,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-02 21:43:03,787 reid_baseline.train INFO: Accuracy: 71.4% Mean Entropy: 254.1%
2022-05-02 21:44:10,585 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.242, Acc: 0.863, Base Lr: 7.21e-03
2022-05-02 21:45:10,909 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.227, Acc: 0.871, Base Lr: 7.21e-03
2022-05-02 21:45:55,722 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.630[s] Speed: 25.4[samples/s]
2022-05-02 21:47:24,096 reid_baseline.train INFO: normal accuracy 0.7198187062216729 2.419959783554077 
2022-05-02 21:47:25,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-02 21:47:25,058 reid_baseline.train INFO: Accuracy: 72.0% Mean Entropy: 242.0%
2022-05-02 21:48:30,176 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.144, Acc: 0.895, Base Lr: 4.01e-03
2022-05-02 21:49:18,184 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.136, Acc: 0.894, Base Lr: 4.01e-03
2022-05-02 21:49:50,772 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.533[s] Speed: 30.0[samples/s]
2022-05-02 21:50:57,874 reid_baseline.train INFO: normal accuracy 0.7218788627935723 2.4966630935668945 
2022-05-02 21:50:57,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-02 21:50:57,874 reid_baseline.train INFO: Accuracy: 72.2% Mean Entropy: 249.7%
2022-05-02 21:51:48,589 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.103, Acc: 0.908, Base Lr: 3.38e-03
2022-05-02 21:52:33,289 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.111, Acc: 0.906, Base Lr: 3.38e-03
2022-05-02 21:53:06,265 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.470[s] Speed: 34.0[samples/s]
2022-05-02 21:54:11,842 reid_baseline.train INFO: normal accuracy 0.7321796456530696 2.4409518241882324 
2022-05-02 21:54:11,843 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-02 21:54:11,843 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 244.1%
2022-05-02 21:55:02,105 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.067, Acc: 0.919, Base Lr: 2.77e-03
2022-05-02 21:55:47,868 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.083, Acc: 0.915, Base Lr: 2.77e-03
2022-05-02 21:56:19,330 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.467[s] Speed: 34.3[samples/s]
2022-05-02 21:57:24,910 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.3378796577453613 
2022-05-02 21:57:25,711 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-02 21:57:25,711 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 233.8%
2022-05-02 21:58:15,065 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.070, Acc: 0.918, Base Lr: 2.20e-03
2022-05-02 21:59:03,551 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.061, Acc: 0.920, Base Lr: 2.20e-03
2022-05-02 21:59:41,782 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.498[s] Speed: 32.1[samples/s]
2022-05-02 22:01:05,144 reid_baseline.train INFO: normal accuracy 0.73094355170993 2.363865852355957 
2022-05-02 22:01:05,147 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-02 22:01:05,147 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 236.4%
2022-05-02 22:02:29,665 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.066, Acc: 0.922, Base Lr: 1.66e-03
2022-05-02 22:03:47,784 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.065, Acc: 0.920, Base Lr: 1.66e-03
2022-05-02 22:04:40,213 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.788[s] Speed: 20.3[samples/s]
2022-05-02 22:06:30,205 reid_baseline.train INFO: normal accuracy 0.7301194890811702 2.384930372238159 
2022-05-02 22:06:30,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-02 22:06:30,207 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 238.5%
2022-05-02 22:07:57,692 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.917, Base Lr: 1.19e-03
2022-05-02 22:09:15,164 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.052, Acc: 0.920, Base Lr: 1.19e-03
2022-05-02 22:10:17,987 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.834[s] Speed: 19.2[samples/s]
2022-05-02 22:12:01,730 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.335406541824341 
2022-05-02 22:12:02,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-02 22:12:02,928 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 233.5%
2022-05-02 22:13:26,597 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.026, Acc: 0.932, Base Lr: 7.78e-04
2022-05-02 22:14:45,233 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.036, Acc: 0.925, Base Lr: 7.78e-04
2022-05-02 22:15:45,288 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.814[s] Speed: 19.6[samples/s]
2022-05-02 22:17:23,703 reid_baseline.train INFO: normal accuracy 0.7367119901112484 2.3675498962402344 
2022-05-02 22:17:23,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-02 22:17:23,704 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 236.8%
2022-05-02 22:18:54,156 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.048, Acc: 0.923, Base Lr: 4.51e-04
2022-05-02 22:20:18,388 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.056, Acc: 0.918, Base Lr: 4.51e-04
2022-05-02 22:21:10,501 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.831[s] Speed: 19.3[samples/s]
2022-05-02 22:22:56,250 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.365370750427246 
2022-05-02 22:22:56,252 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-02 22:22:56,252 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 236.5%
2022-05-02 22:24:27,163 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.030, Acc: 0.924, Base Lr: 2.11e-04
2022-05-02 22:25:39,118 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.029, Acc: 0.928, Base Lr: 2.11e-04
2022-05-02 22:26:31,784 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.789[s] Speed: 20.3[samples/s]
2022-05-02 22:28:13,883 reid_baseline.train INFO: normal accuracy 0.7342398022249691 2.320817470550537 
2022-05-02 22:28:15,223 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-02 22:28:15,224 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 232.1%
2022-05-02 22:29:45,298 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.020, Acc: 0.936, Base Lr: 6.51e-05
2022-05-02 22:31:03,349 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.026, Acc: 0.930, Base Lr: 6.51e-05
2022-05-02 22:32:01,702 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.830[s] Speed: 19.3[samples/s]
2022-05-02 22:33:46,164 reid_baseline.train INFO: normal accuracy 0.7358879274824887 2.392970323562622 
2022-05-02 22:33:46,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-02 22:33:46,165 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 239.3%
2022-05-02 22:35:10,866 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.039, Acc: 0.928, Base Lr: 1.60e-05
2022-05-02 22:36:25,418 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.032, Acc: 0.930, Base Lr: 1.60e-05
2022-05-02 22:37:25,430 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.803[s] Speed: 19.9[samples/s]
2022-05-02 22:39:05,964 reid_baseline.train INFO: normal accuracy 0.7313555830243098 2.3377034664154053 
2022-05-02 22:39:05,965 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-02 22:39:05,965 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 233.8%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls/transformer_best_model.pth
2022-05-02 22:40:47,931 reid_baseline.train INFO: normal accuracy 0.7342398022249691 2.320817470550537 
2022-05-02 22:40:47,932 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-02 22:40:47,932 reid_baseline.train INFO: Accuracy: 73.4%
2022-05-02 22:42:37,222 reid_baseline.train INFO: normal accuracy 0.7342398022249691 2.320817470550537 
2022-05-02 22:42:37,223 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-02 22:42:37,223 reid_baseline.train INFO: Shuffled Accuracy: 73.4%
2022-05-02 22:44:33,047 reid_baseline.train INFO: normal accuracy 0.9461626575028637 1.2468056678771973 
2022-05-02 22:44:33,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-02 22:44:33,049 reid_baseline.train INFO: Source Clean Accuracy: 94.6%
2022-05-02 22:44:40,305 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls
2022-05-02 22:44:40,306 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-02 22:44:40,306 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-02 22:44:40,306 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-02 22:44:40,306 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-02 22:44:55,984 reid_baseline.train INFO: start training
2022-05-02 22:46:33,679 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.132, Acc: 0.174, Base Lr: 8.72e-04
2022-05-02 22:47:51,670 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.262, Base Lr: 8.72e-04
2022-05-02 22:48:47,926 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.845[s] Speed: 18.9[samples/s]
2022-05-02 22:50:52,637 reid_baseline.train INFO: normal accuracy 0.40865059698130207 4.168494701385498 
2022-05-02 22:50:53,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-02 22:50:53,887 reid_baseline.train INFO: Accuracy: 40.9% Mean Entropy: 416.8%
2022-05-02 22:52:18,456 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.752, Acc: 0.471, Base Lr: 1.66e-03
2022-05-02 22:53:37,924 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.613, Acc: 0.484, Base Lr: 1.66e-03
2022-05-02 22:54:35,214 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.811[s] Speed: 19.7[samples/s]
2022-05-02 22:56:38,374 reid_baseline.train INFO: normal accuracy 0.48344221671547644 4.084643363952637 
2022-05-02 22:56:39,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-02 22:56:39,705 reid_baseline.train INFO: Accuracy: 48.3% Mean Entropy: 408.5%
2022-05-02 22:58:05,507 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.885, Acc: 0.572, Base Lr: 2.46e-03
2022-05-02 22:59:27,355 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.718, Acc: 0.579, Base Lr: 2.46e-03
2022-05-02 23:00:18,595 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.801[s] Speed: 20.0[samples/s]
2022-05-02 23:02:26,109 reid_baseline.train INFO: normal accuracy 0.6019373732822708 3.632650375366211 
2022-05-02 23:02:27,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-02 23:02:27,443 reid_baseline.train INFO: Accuracy: 60.2% Mean Entropy: 363.3%
2022-05-02 23:03:56,813 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.142, Acc: 0.669, Base Lr: 3.25e-03
2022-05-02 23:05:15,145 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.048, Acc: 0.683, Base Lr: 3.25e-03
2022-05-02 23:06:10,866 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.818[s] Speed: 19.6[samples/s]
2022-05-02 23:08:19,674 reid_baseline.train INFO: normal accuracy 0.6816850642036495 3.0754313468933105 
2022-05-02 23:08:20,986 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-02 23:08:20,987 reid_baseline.train INFO: Accuracy: 68.2% Mean Entropy: 307.5%
2022-05-02 23:09:45,070 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.734, Acc: 0.741, Base Lr: 4.04e-03
2022-05-02 23:11:11,359 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.686, Acc: 0.751, Base Lr: 4.04e-03
2022-05-02 23:12:07,390 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.829[s] Speed: 19.3[samples/s]
2022-05-02 23:14:07,108 reid_baseline.train INFO: normal accuracy 0.7093940076593828 2.7217555046081543 
2022-05-02 23:14:08,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-02 23:14:08,448 reid_baseline.train INFO: Accuracy: 70.9% Mean Entropy: 272.2%
2022-05-02 23:15:36,602 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.489, Acc: 0.801, Base Lr: 4.83e-03
2022-05-02 23:16:56,174 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.476, Acc: 0.797, Base Lr: 4.83e-03
2022-05-02 23:17:54,829 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.829[s] Speed: 19.3[samples/s]
2022-05-02 23:19:48,115 reid_baseline.train INFO: normal accuracy 0.7305699481865285 2.5384907722473145 
2022-05-02 23:19:49,517 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-02 23:19:49,518 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 253.8%
2022-05-02 23:21:21,566 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.368, Acc: 0.825, Base Lr: 5.62e-03
2022-05-02 23:22:39,730 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.364, Acc: 0.829, Base Lr: 5.62e-03
2022-05-02 23:23:36,238 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.830[s] Speed: 19.3[samples/s]
2022-05-02 23:25:33,397 reid_baseline.train INFO: normal accuracy 0.7409326424870466 2.420964479446411 
2022-05-02 23:25:34,638 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-02 23:25:34,639 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 242.1%
2022-05-02 23:26:54,031 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.259, Acc: 0.861, Base Lr: 6.42e-03
2022-05-02 23:28:12,891 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.264, Acc: 0.860, Base Lr: 6.42e-03
2022-05-02 23:29:10,976 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.792[s] Speed: 20.2[samples/s]
2022-05-02 23:31:14,524 reid_baseline.train INFO: normal accuracy 0.7355260193737329 2.3674144744873047 
2022-05-02 23:31:15,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-02 23:31:15,942 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 236.7%
2022-05-02 23:32:40,369 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.242, Acc: 0.863, Base Lr: 7.21e-03
2022-05-02 23:33:59,052 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.227, Acc: 0.871, Base Lr: 7.21e-03
2022-05-02 23:34:57,333 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.811[s] Speed: 19.7[samples/s]
2022-05-02 23:37:10,512 reid_baseline.train INFO: normal accuracy 0.752872268528948 2.3124096393585205 
2022-05-02 23:37:11,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-02 23:37:11,718 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 231.2%
2022-05-02 23:38:36,530 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.144, Acc: 0.895, Base Lr: 4.01e-03
2022-05-02 23:39:59,446 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.136, Acc: 0.894, Base Lr: 4.01e-03
2022-05-02 23:40:55,119 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.818[s] Speed: 19.6[samples/s]
2022-05-02 23:43:17,526 reid_baseline.train INFO: normal accuracy 0.7544492002703311 2.376157760620117 
2022-05-02 23:43:17,528 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-02 23:43:17,528 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 237.6%
2022-05-02 23:45:22,359 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.103, Acc: 0.908, Base Lr: 3.38e-03
2022-05-02 23:47:21,630 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.111, Acc: 0.906, Base Lr: 3.38e-03
2022-05-02 23:48:39,300 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.179[s] Speed: 13.6[samples/s]
2022-05-02 23:50:58,967 reid_baseline.train INFO: normal accuracy 0.7582788916422618 2.3388779163360596 
2022-05-02 23:50:58,968 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-02 23:50:58,968 reid_baseline.train INFO: Accuracy: 75.8% Mean Entropy: 233.9%
2022-05-02 23:52:36,151 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.067, Acc: 0.919, Base Lr: 2.77e-03
2022-05-02 23:54:10,747 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.083, Acc: 0.915, Base Lr: 2.77e-03
2022-05-02 23:55:12,832 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.930[s] Speed: 17.2[samples/s]
2022-05-02 23:57:25,636 reid_baseline.train INFO: normal accuracy 0.7562514079747691 2.216897487640381 
2022-05-02 23:57:27,257 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-02 23:57:27,258 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 221.7%
2022-05-02 23:58:54,082 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.070, Acc: 0.918, Base Lr: 2.20e-03
2022-05-03 00:00:14,372 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.061, Acc: 0.920, Base Lr: 2.20e-03
2022-05-03 00:01:10,207 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.817[s] Speed: 19.6[samples/s]
2022-05-03 00:03:29,457 reid_baseline.train INFO: normal accuracy 0.7632349628294661 2.256118059158325 
2022-05-03 00:03:29,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 00:03:29,458 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 225.6%
2022-05-03 00:05:15,595 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.066, Acc: 0.923, Base Lr: 1.66e-03
2022-05-03 00:06:38,433 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.065, Acc: 0.921, Base Lr: 1.66e-03
2022-05-03 00:07:43,066 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.929[s] Speed: 17.2[samples/s]
2022-05-03 00:09:45,978 reid_baseline.train INFO: normal accuracy 0.7663888263122325 2.2737011909484863 
2022-05-03 00:09:45,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 00:09:45,979 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 227.4%
2022-05-03 00:11:19,086 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.917, Base Lr: 1.19e-03
2022-05-03 00:12:55,670 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.052, Acc: 0.920, Base Lr: 1.19e-03
2022-05-03 00:14:00,968 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.934[s] Speed: 17.1[samples/s]
2022-05-03 00:16:06,723 reid_baseline.train INFO: normal accuracy 0.7670646542013967 2.227534770965576 
2022-05-03 00:16:06,723 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 00:16:06,724 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 222.8%
2022-05-03 00:17:31,404 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.026, Acc: 0.932, Base Lr: 7.78e-04
2022-05-03 00:18:46,693 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.036, Acc: 0.925, Base Lr: 7.78e-04
2022-05-03 00:19:46,686 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.806[s] Speed: 19.9[samples/s]
2022-05-03 00:22:11,693 reid_baseline.train INFO: normal accuracy 0.771119621536382 2.2681429386138916 
2022-05-03 00:22:11,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 00:22:11,701 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 226.8%
2022-05-03 00:23:48,629 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.048, Acc: 0.922, Base Lr: 4.51e-04
2022-05-03 00:25:09,283 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.056, Acc: 0.918, Base Lr: 4.51e-04
2022-05-03 00:26:05,299 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.855[s] Speed: 18.7[samples/s]
2022-05-03 00:28:09,114 reid_baseline.train INFO: normal accuracy 0.7715701734624916 2.2708489894866943 
2022-05-03 00:28:09,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 00:28:09,115 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 227.1%
2022-05-03 00:29:42,657 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.030, Acc: 0.924, Base Lr: 2.11e-04
2022-05-03 00:31:19,615 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.029, Acc: 0.928, Base Lr: 2.11e-04
2022-05-03 00:32:24,382 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.935[s] Speed: 17.1[samples/s]
2022-05-03 00:34:26,718 reid_baseline.train INFO: normal accuracy 0.7704437936472178 2.233787775039673 
2022-05-03 00:34:26,718 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 00:34:26,718 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 223.4%
2022-05-03 00:35:58,145 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.020, Acc: 0.936, Base Lr: 6.51e-05
2022-05-03 00:37:09,541 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.026, Acc: 0.930, Base Lr: 6.51e-05
2022-05-03 00:38:13,315 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.830[s] Speed: 19.3[samples/s]
2022-05-03 00:40:30,881 reid_baseline.train INFO: normal accuracy 0.773822933093039 2.300452947616577 
2022-05-03 00:40:30,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 00:40:30,884 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 230.0%
2022-05-03 00:42:07,950 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.039, Acc: 0.927, Base Lr: 1.60e-05
2022-05-03 00:43:22,649 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.032, Acc: 0.930, Base Lr: 1.60e-05
2022-05-03 00:44:21,693 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.845[s] Speed: 18.9[samples/s]
2022-05-03 00:46:31,350 reid_baseline.train INFO: normal accuracy 0.7699932417211084 2.25478196144104 
2022-05-03 00:46:31,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 00:46:31,352 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 225.5%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls/transformer_best_model.pth
2022-05-03 00:48:51,915 reid_baseline.train INFO: normal accuracy 0.7562514079747691 2.216897487640381 
2022-05-03 00:48:51,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 00:48:51,916 reid_baseline.train INFO: Accuracy: 75.6%
2022-05-03 00:51:10,103 reid_baseline.train INFO: normal accuracy 0.7562514079747691 2.216897487640381 
2022-05-03 00:51:10,103 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 00:51:10,103 reid_baseline.train INFO: Shuffled Accuracy: 75.6%
2022-05-03 00:53:11,401 reid_baseline.train INFO: normal accuracy 0.93631156930126 1.2519571781158447 
2022-05-03 00:53:11,401 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 00:53:11,401 reid_baseline.train INFO: Source Clean Accuracy: 93.6%
2022-05-03 00:53:18,217 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls
2022-05-03 00:53:18,217 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 00:53:18,218 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 00:53:18,218 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 00:53:18,218 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 00:53:39,487 reid_baseline.train INFO: start training
2022-05-03 00:55:13,507 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.132, Acc: 0.175, Base Lr: 8.72e-04
2022-05-03 00:56:45,111 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.262, Base Lr: 8.72e-04
2022-05-03 00:57:48,682 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.907[s] Speed: 17.6[samples/s]
2022-05-03 01:03:44,315 reid_baseline.train INFO: normal accuracy 0.40601331191186596 4.168906211853027 
2022-05-03 01:03:45,521 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 01:03:45,521 reid_baseline.train INFO: Accuracy: 40.6% Mean Entropy: 416.9%
2022-05-03 01:05:04,435 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.752, Acc: 0.471, Base Lr: 1.66e-03
2022-05-03 01:06:38,197 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.613, Acc: 0.484, Base Lr: 1.66e-03
2022-05-03 01:07:41,732 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.865[s] Speed: 18.5[samples/s]
2022-05-03 01:13:33,759 reid_baseline.train INFO: normal accuracy 0.4874913931604315 4.092172145843506 
2022-05-03 01:13:35,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 01:13:35,128 reid_baseline.train INFO: Accuracy: 48.7% Mean Entropy: 409.2%
2022-05-03 01:15:07,000 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.885, Acc: 0.572, Base Lr: 2.46e-03
2022-05-03 01:16:37,864 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.718, Acc: 0.578, Base Lr: 2.46e-03
2022-05-03 01:17:43,776 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.911[s] Speed: 17.6[samples/s]
2022-05-03 01:23:24,779 reid_baseline.train INFO: normal accuracy 0.6180858388799633 3.672832489013672 
2022-05-03 01:23:25,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 01:23:25,775 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 367.3%
2022-05-03 01:25:20,424 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.142, Acc: 0.669, Base Lr: 3.25e-03
2022-05-03 01:27:22,209 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.048, Acc: 0.683, Base Lr: 3.25e-03
2022-05-03 01:28:43,125 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.162[s] Speed: 13.8[samples/s]
2022-05-03 01:35:10,601 reid_baseline.train INFO: normal accuracy 0.7009410144594905 3.1193289756774902 
2022-05-03 01:35:11,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 01:35:11,802 reid_baseline.train INFO: Accuracy: 70.1% Mean Entropy: 311.9%
2022-05-03 01:36:42,880 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.734, Acc: 0.740, Base Lr: 4.04e-03
2022-05-03 01:38:40,861 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.686, Acc: 0.750, Base Lr: 4.04e-03
2022-05-03 01:40:09,148 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.089[s] Speed: 14.7[samples/s]
2022-05-03 01:46:46,187 reid_baseline.train INFO: normal accuracy 0.7335322469589167 2.7599241733551025 
2022-05-03 01:46:47,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 01:46:47,351 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 276.0%
2022-05-03 01:48:06,164 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.489, Acc: 0.801, Base Lr: 4.83e-03
2022-05-03 01:49:20,857 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.476, Acc: 0.797, Base Lr: 4.83e-03
2022-05-03 01:50:17,518 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.770[s] Speed: 20.8[samples/s]
2022-05-03 01:56:49,092 reid_baseline.train INFO: normal accuracy 0.7495983474868029 2.55281138420105 
2022-05-03 01:56:50,491 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 01:56:50,491 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 255.3%
2022-05-03 01:58:56,268 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.368, Acc: 0.824, Base Lr: 5.62e-03
2022-05-03 02:00:54,876 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.364, Acc: 0.829, Base Lr: 5.62e-03
2022-05-03 02:02:28,974 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.240[s] Speed: 12.9[samples/s]
2022-05-03 02:09:04,173 reid_baseline.train INFO: normal accuracy 0.761533165021804 2.4566900730133057 
2022-05-03 02:09:05,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 02:09:05,767 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 245.7%
2022-05-03 02:11:26,340 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.259, Acc: 0.862, Base Lr: 6.42e-03
2022-05-03 02:13:33,431 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.264, Acc: 0.860, Base Lr: 6.42e-03
2022-05-03 02:15:03,864 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.312[s] Speed: 12.2[samples/s]
2022-05-03 02:21:53,178 reid_baseline.train INFO: normal accuracy 0.7654349322928621 2.3974432945251465 
2022-05-03 02:21:54,747 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 02:21:54,758 reid_baseline.train INFO: Accuracy: 76.5% Mean Entropy: 239.7%
2022-05-03 02:24:12,471 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.242, Acc: 0.863, Base Lr: 7.21e-03
2022-05-03 02:26:24,499 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.227, Acc: 0.871, Base Lr: 7.21e-03
2022-05-03 02:27:55,587 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.322[s] Speed: 12.1[samples/s]
2022-05-03 02:35:03,908 reid_baseline.train INFO: normal accuracy 0.7736974982786321 2.307345151901245 
2022-05-03 02:35:05,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 02:35:05,560 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 230.7%
2022-05-03 02:37:30,413 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.144, Acc: 0.895, Base Lr: 4.01e-03
2022-05-03 02:39:49,985 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.136, Acc: 0.894, Base Lr: 4.01e-03
2022-05-03 02:41:29,575 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.406[s] Speed: 11.4[samples/s]
2022-05-03 02:49:43,497 reid_baseline.train INFO: normal accuracy 0.7748450768877668 2.3852381706237793 
2022-05-03 02:49:43,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 02:49:43,502 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 238.5%
2022-05-03 02:51:53,356 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.103, Acc: 0.908, Base Lr: 3.38e-03
2022-05-03 02:54:08,147 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.111, Acc: 0.906, Base Lr: 3.38e-03
2022-05-03 02:55:57,344 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.369[s] Speed: 11.7[samples/s]
2022-05-03 03:02:33,181 reid_baseline.train INFO: normal accuracy 0.7819600642644021 2.339223861694336 
2022-05-03 03:02:33,181 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 03:02:33,181 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 233.9%
2022-05-03 03:04:35,678 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.067, Acc: 0.919, Base Lr: 2.77e-03
2022-05-03 03:06:40,105 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.083, Acc: 0.915, Base Lr: 2.77e-03
2022-05-03 03:08:09,197 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.231[s] Speed: 13.0[samples/s]
2022-05-03 03:14:57,984 reid_baseline.train INFO: normal accuracy 0.7769107183842093 2.21840238571167 
2022-05-03 03:14:59,574 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 03:14:59,575 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 221.8%
2022-05-03 03:17:20,748 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.070, Acc: 0.918, Base Lr: 2.20e-03
2022-05-03 03:19:30,698 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.061, Acc: 0.920, Base Lr: 2.20e-03
2022-05-03 03:21:09,843 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.356[s] Speed: 11.8[samples/s]
2022-05-03 03:27:58,430 reid_baseline.train INFO: normal accuracy 0.7803534542116135 2.26790452003479 
2022-05-03 03:27:58,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 03:27:58,433 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 226.8%
2022-05-03 03:29:47,479 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.066, Acc: 0.922, Base Lr: 1.66e-03
2022-05-03 03:31:37,826 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.065, Acc: 0.920, Base Lr: 1.66e-03
2022-05-03 03:32:59,757 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.104[s] Speed: 14.5[samples/s]
2022-05-03 03:38:55,554 reid_baseline.train INFO: normal accuracy 0.7808124856552674 2.2930257320404053 
2022-05-03 03:38:55,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 03:38:55,559 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 229.3%
2022-05-03 03:40:58,674 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.917, Base Lr: 1.19e-03
2022-05-03 03:42:41,109 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.052, Acc: 0.920, Base Lr: 1.19e-03
2022-05-03 03:44:03,264 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.126[s] Speed: 14.2[samples/s]
2022-05-03 03:49:49,272 reid_baseline.train INFO: normal accuracy 0.7787468441588249 2.2399191856384277 
2022-05-03 03:49:49,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 03:49:49,278 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 224.0%
2022-05-03 03:51:40,194 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.026, Acc: 0.932, Base Lr: 7.78e-04
2022-05-03 03:53:31,112 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.036, Acc: 0.925, Base Lr: 7.78e-04
2022-05-03 03:54:49,984 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.101[s] Speed: 14.5[samples/s]
2022-05-03 04:00:36,097 reid_baseline.train INFO: normal accuracy 0.7815010328207482 2.277886390686035 
2022-05-03 04:00:36,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 04:00:36,100 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 227.8%
2022-05-03 04:02:28,190 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.048, Acc: 0.922, Base Lr: 4.51e-04
2022-05-03 04:04:11,162 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.056, Acc: 0.918, Base Lr: 4.51e-04
2022-05-03 04:05:25,987 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.062[s] Speed: 15.1[samples/s]
2022-05-03 04:11:32,429 reid_baseline.train INFO: normal accuracy 0.7817305485425752 2.284163236618042 
2022-05-03 04:11:32,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 04:11:32,431 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 228.4%
2022-05-03 04:13:21,416 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.030, Acc: 0.924, Base Lr: 2.11e-04
2022-05-03 04:15:20,972 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.029, Acc: 0.928, Base Lr: 2.11e-04
2022-05-03 04:16:40,998 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.130[s] Speed: 14.2[samples/s]
2022-05-03 04:22:38,332 reid_baseline.train INFO: normal accuracy 0.782419095708056 2.2390756607055664 
2022-05-03 04:22:38,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 04:22:38,337 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 223.9%
2022-05-03 04:24:34,663 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.020, Acc: 0.936, Base Lr: 6.51e-05
2022-05-03 04:26:23,649 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.026, Acc: 0.930, Base Lr: 6.51e-05
2022-05-03 04:27:48,665 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.137[s] Speed: 14.1[samples/s]
2022-05-03 04:33:47,377 reid_baseline.train INFO: normal accuracy 0.7817305485425752 2.311682939529419 
2022-05-03 04:33:47,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 04:33:47,382 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 231.2%
2022-05-03 04:35:42,302 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.039, Acc: 0.927, Base Lr: 1.60e-05
2022-05-03 04:37:30,584 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.032, Acc: 0.930, Base Lr: 1.60e-05
2022-05-03 04:38:43,475 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.085[s] Speed: 14.8[samples/s]
2022-05-03 04:43:58,805 reid_baseline.train INFO: normal accuracy 0.7808124856552674 2.2563891410827637 
2022-05-03 04:43:58,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 04:43:58,807 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 225.6%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls/transformer_best_model.pth
2022-05-03 04:49:58,259 reid_baseline.train INFO: normal accuracy 0.7769107183842093 2.21840238571167 
2022-05-03 04:49:58,259 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 04:49:58,260 reid_baseline.train INFO: Accuracy: 77.7%
2022-05-03 04:55:46,644 reid_baseline.train INFO: normal accuracy 0.7769107183842093 2.21840238571167 
2022-05-03 04:55:46,644 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 04:55:46,644 reid_baseline.train INFO: Shuffled Accuracy: 77.7%
2022-05-03 04:57:44,920 reid_baseline.train INFO: normal accuracy 0.9360824742268041 1.2518279552459717 
2022-05-03 04:57:44,921 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 04:57:44,921 reid_baseline.train INFO: Source Clean Accuracy: 93.6%
