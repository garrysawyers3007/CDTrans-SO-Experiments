2022-05-03 12:25:56,540 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls_corrected
2022-05-03 12:25:56,541 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls_corrected', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 12:25:56,541 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 12:25:56,541 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 12:25:56,541 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls_corrected
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 12:26:11,926 reid_baseline.train INFO: start training
2022-05-03 12:27:25,584 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.064, Base Lr: 8.72e-04
2022-05-03 12:28:20,576 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.121, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 12:29:03,756 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.626[s] Speed: 25.6[samples/s]
2022-05-03 12:30:20,523 reid_baseline.train INFO: normal accuracy 0.009064688916357644 4.167600154876709 
2022-05-03 12:30:21,299 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 12:30:21,300 reid_baseline.train INFO: Accuracy: 0.9% Mean Entropy: 416.8%
2022-05-03 12:31:31,982 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.991, Acc: 0.107, Base Lr: 1.66e-03
2022-05-03 12:32:38,604 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.944, Acc: 0.116, Base Lr: 1.66e-03
2022-05-03 12:33:14,675 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.635[s] Speed: 25.2[samples/s]
2022-05-03 12:34:34,388 reid_baseline.train INFO: normal accuracy 0.011948908117016894 4.13901948928833 
2022-05-03 12:34:35,210 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 12:34:35,210 reid_baseline.train INFO: Accuracy: 1.2% Mean Entropy: 413.9%
2022-05-03 12:35:34,427 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.743, Acc: 0.137, Base Lr: 2.46e-03
2022-05-03 12:36:27,046 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.719, Acc: 0.133, Base Lr: 2.46e-03
2022-05-03 12:37:05,927 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.552[s] Speed: 29.0[samples/s]
2022-05-03 12:38:23,496 reid_baseline.train INFO: normal accuracy 0.02018953440461475 4.079753875732422 
2022-05-03 12:38:24,462 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 12:38:24,462 reid_baseline.train INFO: Accuracy: 2.0% Mean Entropy: 408.0%
2022-05-03 12:39:30,216 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.533, Acc: 0.170, Base Lr: 3.25e-03
2022-05-03 12:40:24,035 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.502, Acc: 0.178, Base Lr: 3.25e-03
2022-05-03 12:41:03,549 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-05-03 12:42:25,959 reid_baseline.train INFO: normal accuracy 0.0465595385249279 4.03169584274292 
2022-05-03 12:42:27,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 12:42:27,324 reid_baseline.train INFO: Accuracy: 4.7% Mean Entropy: 403.2%
2022-05-03 12:43:22,738 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.391, Acc: 0.209, Base Lr: 4.04e-03
2022-05-03 12:44:26,521 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.373, Acc: 0.207, Base Lr: 4.04e-03
2022-05-03 12:45:14,814 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-05-03 12:46:32,362 reid_baseline.train INFO: normal accuracy 0.06056860321384425 3.9417505264282227 
2022-05-03 12:46:33,489 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 12:46:33,489 reid_baseline.train INFO: Accuracy: 6.1% Mean Entropy: 394.2%
2022-05-03 12:47:33,889 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.273, Acc: 0.238, Base Lr: 4.83e-03
2022-05-03 12:48:29,295 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.256, Acc: 0.241, Base Lr: 4.83e-03
2022-05-03 12:49:07,543 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.564[s] Speed: 28.4[samples/s]
2022-05-03 12:50:21,610 reid_baseline.train INFO: normal accuracy 0.05644829007004532 3.881476640701294 
2022-05-03 12:50:22,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 12:50:22,914 reid_baseline.train INFO: Accuracy: 5.6% Mean Entropy: 388.1%
2022-05-03 12:51:31,353 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.152, Acc: 0.260, Base Lr: 5.62e-03
2022-05-03 12:52:35,462 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.175, Acc: 0.253, Base Lr: 5.62e-03
2022-05-03 12:53:16,429 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.636[s] Speed: 25.2[samples/s]
2022-05-03 12:54:39,338 reid_baseline.train INFO: normal accuracy 0.07210548001648125 3.9050540924072266 
2022-05-03 12:54:39,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 12:54:39,338 reid_baseline.train INFO: Accuracy: 7.2% Mean Entropy: 390.5%
2022-05-03 12:55:41,358 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.082, Acc: 0.293, Base Lr: 6.42e-03
2022-05-03 12:56:39,889 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.071, Acc: 0.291, Base Lr: 6.42e-03
2022-05-03 12:57:18,882 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-05-03 12:58:42,875 reid_baseline.train INFO: normal accuracy 0.07704985578903997 3.8088440895080566 
2022-05-03 12:58:43,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 12:58:43,901 reid_baseline.train INFO: Accuracy: 7.7% Mean Entropy: 380.9%
2022-05-03 12:59:57,504 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.986, Acc: 0.308, Base Lr: 7.21e-03
2022-05-03 13:00:55,568 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.009, Acc: 0.305, Base Lr: 7.21e-03
2022-05-03 13:01:44,439 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-03 13:03:30,065 reid_baseline.train INFO: normal accuracy 0.08570251339101771 3.760324001312256 
2022-05-03 13:03:31,031 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 13:03:31,032 reid_baseline.train INFO: Accuracy: 8.6% Mean Entropy: 376.0%
2022-05-03 13:04:40,159 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.867, Acc: 0.339, Base Lr: 4.01e-03
2022-05-03 13:05:48,261 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.853, Acc: 0.344, Base Lr: 4.01e-03
2022-05-03 13:06:39,112 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-03 13:08:12,599 reid_baseline.train INFO: normal accuracy 0.10094767202307375 3.749990224838257 
2022-05-03 13:08:13,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 13:08:13,503 reid_baseline.train INFO: Accuracy: 10.1% Mean Entropy: 375.0%
2022-05-03 13:09:27,628 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.772, Acc: 0.361, Base Lr: 3.38e-03
2022-05-03 13:10:37,537 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.781, Acc: 0.369, Base Lr: 3.38e-03
2022-05-03 13:11:30,784 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.723[s] Speed: 22.1[samples/s]
2022-05-03 13:13:18,966 reid_baseline.train INFO: normal accuracy 0.10012360939431397 3.7445473670959473 
2022-05-03 13:13:19,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 13:13:19,907 reid_baseline.train INFO: Accuracy: 10.0% Mean Entropy: 374.5%
2022-05-03 13:14:35,124 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.747, Acc: 0.389, Base Lr: 2.77e-03
2022-05-03 13:15:52,860 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.744, Acc: 0.379, Base Lr: 2.77e-03
2022-05-03 13:16:51,144 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.773[s] Speed: 20.7[samples/s]
2022-05-03 13:18:41,893 reid_baseline.train INFO: normal accuracy 0.08199423156159868 3.6931605339050293 
2022-05-03 13:18:42,872 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 13:18:42,872 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 369.3%
2022-05-03 13:20:07,358 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.677, Acc: 0.390, Base Lr: 2.20e-03
2022-05-03 13:21:27,666 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.651, Acc: 0.400, Base Lr: 2.20e-03
2022-05-03 13:22:22,532 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.805[s] Speed: 19.9[samples/s]
2022-05-03 13:24:04,885 reid_baseline.train INFO: normal accuracy 0.08446641944787804 3.689260721206665 
2022-05-03 13:24:05,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 13:24:05,820 reid_baseline.train INFO: Accuracy: 8.4% Mean Entropy: 368.9%
2022-05-03 13:25:36,275 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.627, Acc: 0.425, Base Lr: 1.66e-03
2022-05-03 13:26:56,280 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.646, Acc: 0.414, Base Lr: 1.66e-03
2022-05-03 13:27:49,173 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.818[s] Speed: 19.6[samples/s]
2022-05-03 13:30:03,211 reid_baseline.train INFO: normal accuracy 0.092295014421096 3.688377857208252 
2022-05-03 13:30:04,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 13:30:04,227 reid_baseline.train INFO: Accuracy: 9.2% Mean Entropy: 368.8%
2022-05-03 13:31:36,844 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.575, Acc: 0.428, Base Lr: 1.19e-03
2022-05-03 13:32:48,096 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.599, Acc: 0.425, Base Lr: 1.19e-03
2022-05-03 13:33:44,674 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.807[s] Speed: 19.8[samples/s]
2022-05-03 13:35:35,582 reid_baseline.train INFO: normal accuracy 0.09765142150803462 3.655231475830078 
2022-05-03 13:35:36,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 13:35:36,508 reid_baseline.train INFO: Accuracy: 9.8% Mean Entropy: 365.5%
2022-05-03 13:37:02,728 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.557, Acc: 0.447, Base Lr: 7.78e-04
2022-05-03 13:38:14,242 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.567, Acc: 0.439, Base Lr: 7.78e-04
2022-05-03 13:39:02,416 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.754[s] Speed: 21.2[samples/s]
2022-05-03 13:40:56,773 reid_baseline.train INFO: normal accuracy 0.09270704573547589 3.6904714107513428 
2022-05-03 13:40:56,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 13:40:56,778 reid_baseline.train INFO: Accuracy: 9.3% Mean Entropy: 369.0%
2022-05-03 13:42:07,718 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.558, Acc: 0.433, Base Lr: 4.51e-04
2022-05-03 13:43:16,434 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.572, Acc: 0.426, Base Lr: 4.51e-04
2022-05-03 13:44:09,382 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.705[s] Speed: 22.7[samples/s]
2022-05-03 13:45:40,379 reid_baseline.train INFO: normal accuracy 0.09023485784919653 3.6763226985931396 
2022-05-03 13:45:40,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 13:45:40,380 reid_baseline.train INFO: Accuracy: 9.0% Mean Entropy: 367.6%
2022-05-03 13:46:49,471 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.582, Acc: 0.428, Base Lr: 2.11e-04
2022-05-03 13:47:54,505 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.569, Acc: 0.433, Base Lr: 2.11e-04
2022-05-03 13:48:41,510 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.663[s] Speed: 24.1[samples/s]
2022-05-03 13:50:16,723 reid_baseline.train INFO: normal accuracy 0.09394313967861558 3.682891607284546 
2022-05-03 13:50:16,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 13:50:16,724 reid_baseline.train INFO: Accuracy: 9.4% Mean Entropy: 368.3%
2022-05-03 13:51:30,274 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.548, Acc: 0.444, Base Lr: 6.51e-05
2022-05-03 13:52:38,685 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.563, Acc: 0.439, Base Lr: 6.51e-05
2022-05-03 13:53:22,618 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.681[s] Speed: 23.5[samples/s]
2022-05-03 13:54:58,266 reid_baseline.train INFO: normal accuracy 0.09188298310671611 3.684908151626587 
2022-05-03 13:54:58,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 13:54:58,266 reid_baseline.train INFO: Accuracy: 9.2% Mean Entropy: 368.5%
2022-05-03 13:56:03,887 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.560, Acc: 0.451, Base Lr: 1.60e-05
2022-05-03 13:57:05,435 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.538, Acc: 0.451, Base Lr: 1.60e-05
2022-05-03 13:57:43,349 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.605[s] Speed: 26.5[samples/s]
2022-05-03 13:59:02,264 reid_baseline.train INFO: normal accuracy 0.09517923362175525 3.646336317062378 
2022-05-03 13:59:03,200 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 13:59:03,200 reid_baseline.train INFO: Accuracy: 9.5% Mean Entropy: 364.6%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_DRI_Cls_corrected/transformer_best_model.pth
2022-05-03 14:00:26,321 reid_baseline.train INFO: normal accuracy 0.09517923362175525 3.646336317062378 
2022-05-03 14:00:26,322 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 14:00:26,322 reid_baseline.train INFO: Accuracy: 9.5%
2022-05-03 14:02:00,582 reid_baseline.train INFO: normal accuracy 0.09517923362175525 3.646336317062378 
2022-05-03 14:02:00,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 14:02:00,583 reid_baseline.train INFO: Shuffled Accuracy: 9.5%
2022-05-03 14:03:44,787 reid_baseline.train INFO: normal accuracy 0.16380297823596793 3.602003812789917 
2022-05-03 14:03:44,787 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 14:03:44,787 reid_baseline.train INFO: Source Clean Accuracy: 16.4%
2022-05-03 14:03:50,789 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls_corrected
2022-05-03 14:03:50,789 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls_corrected', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 14:03:50,790 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 14:03:50,790 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 14:03:50,790 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls_corrected
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 14:04:09,050 reid_baseline.train INFO: start training
2022-05-03 14:05:15,250 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.064, Base Lr: 8.72e-04
2022-05-03 14:06:22,733 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.121, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 14:07:09,089 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.656[s] Speed: 24.4[samples/s]
2022-05-03 14:08:49,335 reid_baseline.train INFO: normal accuracy 0.024780355936021625 4.1675190925598145 
2022-05-03 14:08:50,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 14:08:50,248 reid_baseline.train INFO: Accuracy: 2.5% Mean Entropy: 416.8%
2022-05-03 14:09:53,457 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.991, Acc: 0.107, Base Lr: 1.66e-03
2022-05-03 14:10:51,793 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.944, Acc: 0.116, Base Lr: 1.66e-03
2022-05-03 14:11:30,850 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-05-03 14:13:08,416 reid_baseline.train INFO: normal accuracy 0.025906735751295335 4.138700485229492 
2022-05-03 14:13:09,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 14:13:09,286 reid_baseline.train INFO: Accuracy: 2.6% Mean Entropy: 413.9%
2022-05-03 14:14:16,423 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.743, Acc: 0.138, Base Lr: 2.46e-03
2022-05-03 14:15:10,794 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.719, Acc: 0.133, Base Lr: 2.46e-03
2022-05-03 14:15:49,958 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-05-03 14:17:40,862 reid_baseline.train INFO: normal accuracy 0.03041225501239018 4.07863712310791 
2022-05-03 14:17:43,052 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 14:17:43,052 reid_baseline.train INFO: Accuracy: 3.0% Mean Entropy: 407.9%
2022-05-03 14:18:40,661 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.533, Acc: 0.169, Base Lr: 3.25e-03
2022-05-03 14:19:40,527 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.502, Acc: 0.178, Base Lr: 3.25e-03
2022-05-03 14:20:27,353 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-05-03 14:22:03,759 reid_baseline.train INFO: normal accuracy 0.048434332056769544 4.032215118408203 
2022-05-03 14:22:04,733 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 14:22:04,733 reid_baseline.train INFO: Accuracy: 4.8% Mean Entropy: 403.2%
2022-05-03 14:23:05,118 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.391, Acc: 0.209, Base Lr: 4.04e-03
2022-05-03 14:24:04,588 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.373, Acc: 0.206, Base Lr: 4.04e-03
2022-05-03 14:24:45,335 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.588[s] Speed: 27.2[samples/s]
2022-05-03 14:26:17,458 reid_baseline.train INFO: normal accuracy 0.06285199369227304 3.9408271312713623 
2022-05-03 14:26:18,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 14:26:18,409 reid_baseline.train INFO: Accuracy: 6.3% Mean Entropy: 394.1%
2022-05-03 14:27:27,838 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.273, Acc: 0.238, Base Lr: 4.83e-03
2022-05-03 14:28:31,529 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.256, Acc: 0.241, Base Lr: 4.83e-03
2022-05-03 14:29:10,647 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.631[s] Speed: 25.4[samples/s]
2022-05-03 14:30:42,975 reid_baseline.train INFO: normal accuracy 0.053390403243973865 3.8624985218048096 
2022-05-03 14:30:43,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 14:30:44,000 reid_baseline.train INFO: Accuracy: 5.3% Mean Entropy: 386.2%
2022-05-03 14:31:42,476 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.152, Acc: 0.261, Base Lr: 5.62e-03
2022-05-03 14:32:35,810 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.175, Acc: 0.254, Base Lr: 5.62e-03
2022-05-03 14:33:13,738 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.548[s] Speed: 29.2[samples/s]
2022-05-03 14:34:43,866 reid_baseline.train INFO: normal accuracy 0.06735751295336788 3.910048723220825 
2022-05-03 14:34:43,866 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 14:34:43,867 reid_baseline.train INFO: Accuracy: 6.7% Mean Entropy: 391.0%
2022-05-03 14:35:44,023 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.080, Acc: 0.291, Base Lr: 6.42e-03
2022-05-03 14:36:37,688 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.070, Acc: 0.294, Base Lr: 6.42e-03
2022-05-03 14:37:15,165 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.554[s] Speed: 28.9[samples/s]
2022-05-03 14:38:52,018 reid_baseline.train INFO: normal accuracy 0.08132462266276189 3.8012378215789795 
2022-05-03 14:38:53,083 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 14:38:53,084 reid_baseline.train INFO: Accuracy: 8.1% Mean Entropy: 380.1%
2022-05-03 14:39:50,361 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.990, Acc: 0.311, Base Lr: 7.21e-03
2022-05-03 14:40:55,504 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.011, Acc: 0.306, Base Lr: 7.21e-03
2022-05-03 14:41:42,130 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.619[s] Speed: 25.8[samples/s]
2022-05-03 14:43:12,519 reid_baseline.train INFO: normal accuracy 0.07208830817751746 3.7597131729125977 
2022-05-03 14:43:13,580 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 14:43:13,580 reid_baseline.train INFO: Accuracy: 7.2% Mean Entropy: 376.0%
2022-05-03 14:44:07,112 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.865, Acc: 0.344, Base Lr: 4.01e-03
2022-05-03 14:45:02,005 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.850, Acc: 0.346, Base Lr: 4.01e-03
2022-05-03 14:45:40,061 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.537[s] Speed: 29.8[samples/s]
2022-05-03 14:47:12,762 reid_baseline.train INFO: normal accuracy 0.08425321018247353 3.7586264610290527 
2022-05-03 14:47:13,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 14:47:13,729 reid_baseline.train INFO: Accuracy: 8.4% Mean Entropy: 375.9%
2022-05-03 14:48:23,674 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.773, Acc: 0.368, Base Lr: 3.38e-03
2022-05-03 14:49:18,060 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.782, Acc: 0.369, Base Lr: 3.38e-03
2022-05-03 14:49:56,440 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-05-03 14:51:33,985 reid_baseline.train INFO: normal accuracy 0.08628069384996621 3.731431484222412 
2022-05-03 14:51:34,934 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 14:51:34,934 reid_baseline.train INFO: Accuracy: 8.6% Mean Entropy: 373.1%
2022-05-03 14:52:33,363 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.746, Acc: 0.388, Base Lr: 2.77e-03
2022-05-03 14:53:25,954 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.743, Acc: 0.377, Base Lr: 2.77e-03
2022-05-03 14:54:13,019 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.579[s] Speed: 27.6[samples/s]
2022-05-03 14:55:39,114 reid_baseline.train INFO: normal accuracy 0.07636855147555756 3.682206869125366 
2022-05-03 14:55:40,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 14:55:40,034 reid_baseline.train INFO: Accuracy: 7.6% Mean Entropy: 368.2%
2022-05-03 14:56:35,079 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.674, Acc: 0.391, Base Lr: 2.20e-03
2022-05-03 14:57:30,823 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.650, Acc: 0.399, Base Lr: 2.20e-03
2022-05-03 14:58:08,456 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.544[s] Speed: 29.4[samples/s]
2022-05-03 14:59:43,504 reid_baseline.train INFO: normal accuracy 0.07974769092137869 3.6842572689056396 
2022-05-03 14:59:43,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 14:59:43,506 reid_baseline.train INFO: Accuracy: 8.0% Mean Entropy: 368.4%
2022-05-03 15:00:35,923 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.627, Acc: 0.428, Base Lr: 1.66e-03
2022-05-03 15:01:31,069 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.646, Acc: 0.417, Base Lr: 1.66e-03
2022-05-03 15:02:09,123 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.533[s] Speed: 30.0[samples/s]
2022-05-03 15:03:48,574 reid_baseline.train INFO: normal accuracy 0.07839603514305024 3.6905598640441895 
2022-05-03 15:03:48,575 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 15:03:48,575 reid_baseline.train INFO: Accuracy: 7.8% Mean Entropy: 369.1%
2022-05-03 15:04:47,323 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.575, Acc: 0.431, Base Lr: 1.19e-03
2022-05-03 15:05:40,325 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.598, Acc: 0.428, Base Lr: 1.19e-03
2022-05-03 15:06:18,518 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.549[s] Speed: 29.1[samples/s]
2022-05-03 15:08:07,191 reid_baseline.train INFO: normal accuracy 0.08492903807163775 3.6666359901428223 
2022-05-03 15:08:08,496 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 15:08:08,497 reid_baseline.train INFO: Accuracy: 8.5% Mean Entropy: 366.7%
2022-05-03 15:09:07,795 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.557, Acc: 0.445, Base Lr: 7.78e-04
2022-05-03 15:10:09,023 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.567, Acc: 0.438, Base Lr: 7.78e-04
2022-05-03 15:10:39,509 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-03 15:12:14,353 reid_baseline.train INFO: normal accuracy 0.0820004505519261 3.6841700077056885 
2022-05-03 15:12:14,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 15:12:14,354 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 368.4%
2022-05-03 15:13:12,774 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.557, Acc: 0.438, Base Lr: 4.51e-04
2022-05-03 15:14:21,931 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.571, Acc: 0.428, Base Lr: 4.51e-04
2022-05-03 15:15:15,640 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.664[s] Speed: 24.1[samples/s]
2022-05-03 15:17:07,841 reid_baseline.train INFO: normal accuracy 0.08492903807163775 3.6909327507019043 
2022-05-03 15:17:07,842 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 15:17:07,842 reid_baseline.train INFO: Accuracy: 8.5% Mean Entropy: 369.1%
2022-05-03 15:18:21,158 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.581, Acc: 0.429, Base Lr: 2.11e-04
2022-05-03 15:19:29,689 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.569, Acc: 0.435, Base Lr: 2.11e-04
2022-05-03 15:20:22,009 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.711[s] Speed: 22.5[samples/s]
2022-05-03 15:22:16,791 reid_baseline.train INFO: normal accuracy 0.08177517458887137 3.6828091144561768 
2022-05-03 15:22:16,791 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 15:22:16,792 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 368.3%
2022-05-03 15:23:37,179 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.546, Acc: 0.444, Base Lr: 6.51e-05
2022-05-03 15:24:52,400 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.562, Acc: 0.438, Base Lr: 6.51e-05
2022-05-03 15:25:43,930 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.759[s] Speed: 21.1[samples/s]
2022-05-03 15:27:34,062 reid_baseline.train INFO: normal accuracy 0.08222572651498085 3.6798086166381836 
2022-05-03 15:27:34,062 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 15:27:34,063 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 368.0%
2022-05-03 15:28:54,454 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.559, Acc: 0.451, Base Lr: 1.60e-05
2022-05-03 15:30:07,645 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.537, Acc: 0.451, Base Lr: 1.60e-05
2022-05-03 15:31:01,793 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.760[s] Speed: 21.0[samples/s]
2022-05-03 15:33:00,766 reid_baseline.train INFO: normal accuracy 0.08425321018247353 3.649878978729248 
2022-05-03 15:33:01,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 15:33:01,626 reid_baseline.train INFO: Accuracy: 8.4% Mean Entropy: 365.0%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_DRI_Cls_corrected/transformer_best_model.pth
2022-05-03 15:34:47,991 reid_baseline.train INFO: normal accuracy 0.08425321018247353 3.649878978729248 
2022-05-03 15:34:47,992 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 15:34:47,992 reid_baseline.train INFO: Accuracy: 8.4%
2022-05-03 15:36:43,809 reid_baseline.train INFO: normal accuracy 0.08425321018247353 3.649878978729248 
2022-05-03 15:36:43,810 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 15:36:43,810 reid_baseline.train INFO: Shuffled Accuracy: 8.4%
2022-05-03 15:38:43,784 reid_baseline.train INFO: normal accuracy 0.16174112256586484 3.5969038009643555 
2022-05-03 15:38:43,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 15:38:43,784 reid_baseline.train INFO: Source Clean Accuracy: 16.2%
2022-05-03 15:38:52,191 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls_corrected
2022-05-03 15:38:52,191 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls_corrected', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 15:38:52,191 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 15:38:52,191 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 15:38:52,192 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls_corrected
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 15:39:08,522 reid_baseline.train INFO: start training
2022-05-03 15:40:33,198 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.151, Acc: 0.064, Base Lr: 8.72e-04
2022-05-03 15:41:41,463 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.121, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 15:42:33,441 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.748[s] Speed: 21.4[samples/s]
2022-05-03 15:47:47,287 reid_baseline.train INFO: normal accuracy 0.021344962129905897 4.1677398681640625 
2022-05-03 15:47:48,194 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 15:47:48,195 reid_baseline.train INFO: Accuracy: 2.1% Mean Entropy: 416.8%
2022-05-03 15:49:03,226 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.991, Acc: 0.106, Base Lr: 1.66e-03
2022-05-03 15:50:18,057 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.944, Acc: 0.116, Base Lr: 1.66e-03
2022-05-03 15:51:08,465 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.734[s] Speed: 21.8[samples/s]
2022-05-03 15:56:21,551 reid_baseline.train INFO: normal accuracy 0.021115446408078952 4.139759063720703 
2022-05-03 15:56:22,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 15:56:22,582 reid_baseline.train INFO: Accuracy: 2.1% Mean Entropy: 414.0%
2022-05-03 15:57:41,737 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.743, Acc: 0.136, Base Lr: 2.46e-03
2022-05-03 15:58:57,722 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.719, Acc: 0.133, Base Lr: 2.46e-03
2022-05-03 15:59:49,912 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.759[s] Speed: 21.1[samples/s]
2022-05-03 16:04:50,583 reid_baseline.train INFO: normal accuracy 0.025246729400963966 4.080721378326416 
2022-05-03 16:04:51,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 16:04:51,997 reid_baseline.train INFO: Accuracy: 2.5% Mean Entropy: 408.1%
2022-05-03 16:06:12,113 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 3.533, Acc: 0.170, Base Lr: 3.25e-03
2022-05-03 16:07:25,247 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 3.502, Acc: 0.179, Base Lr: 3.25e-03
2022-05-03 16:08:16,801 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.750[s] Speed: 21.3[samples/s]
2022-05-03 16:13:36,749 reid_baseline.train INFO: normal accuracy 0.046132660087215976 4.0360283851623535 
2022-05-03 16:13:38,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 16:13:38,168 reid_baseline.train INFO: Accuracy: 4.6% Mean Entropy: 403.6%
2022-05-03 16:14:52,983 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 3.391, Acc: 0.211, Base Lr: 4.04e-03
2022-05-03 16:16:07,672 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 3.373, Acc: 0.207, Base Lr: 4.04e-03
2022-05-03 16:16:57,723 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.731[s] Speed: 21.9[samples/s]
2022-05-03 16:22:11,840 reid_baseline.train INFO: normal accuracy 0.05623135184760156 3.9482181072235107 
2022-05-03 16:22:13,179 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 16:22:13,180 reid_baseline.train INFO: Accuracy: 5.6% Mean Entropy: 394.8%
2022-05-03 16:23:30,540 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 3.273, Acc: 0.241, Base Lr: 4.83e-03
2022-05-03 16:24:40,718 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 3.256, Acc: 0.244, Base Lr: 4.83e-03
2022-05-03 16:25:30,808 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.724[s] Speed: 22.1[samples/s]
2022-05-03 16:30:47,784 reid_baseline.train INFO: normal accuracy 0.06311682350240992 3.877190113067627 
2022-05-03 16:30:48,943 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 16:30:48,943 reid_baseline.train INFO: Accuracy: 6.3% Mean Entropy: 387.7%
2022-05-03 16:32:10,325 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 3.153, Acc: 0.264, Base Lr: 5.62e-03
2022-05-03 16:34:02,306 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 3.176, Acc: 0.257, Base Lr: 5.62e-03
2022-05-03 16:35:35,923 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.051[s] Speed: 15.2[samples/s]
2022-05-03 16:41:29,303 reid_baseline.train INFO: normal accuracy 0.07183842093183383 3.912651777267456 
2022-05-03 16:41:29,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 16:41:29,306 reid_baseline.train INFO: Accuracy: 7.2% Mean Entropy: 391.3%
2022-05-03 16:43:23,231 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 3.080, Acc: 0.293, Base Lr: 6.42e-03
2022-05-03 16:44:48,620 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 3.070, Acc: 0.292, Base Lr: 6.42e-03
2022-05-03 16:45:56,303 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.978[s] Speed: 16.4[samples/s]
2022-05-03 16:51:35,948 reid_baseline.train INFO: normal accuracy 0.07000229515721827 3.8078083992004395 
2022-05-03 16:51:37,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 16:51:37,309 reid_baseline.train INFO: Accuracy: 7.0% Mean Entropy: 380.8%
2022-05-03 16:53:31,079 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 2.990, Acc: 0.309, Base Lr: 7.21e-03
2022-05-03 16:55:19,277 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 3.009, Acc: 0.302, Base Lr: 7.21e-03
2022-05-03 16:56:41,186 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.113[s] Speed: 14.4[samples/s]
2022-05-03 17:03:02,528 reid_baseline.train INFO: normal accuracy 0.07711728253385357 3.7754318714141846 
2022-05-03 17:03:04,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 17:03:04,176 reid_baseline.train INFO: Accuracy: 7.7% Mean Entropy: 377.5%
2022-05-03 17:04:48,359 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 2.873, Acc: 0.337, Base Lr: 4.01e-03
2022-05-03 17:06:18,212 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 2.854, Acc: 0.345, Base Lr: 4.01e-03
2022-05-03 17:07:01,490 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.869[s] Speed: 18.4[samples/s]
2022-05-03 17:12:27,109 reid_baseline.train INFO: normal accuracy 0.09042919439981639 3.770094156265259 
2022-05-03 17:12:28,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 17:12:28,109 reid_baseline.train INFO: Accuracy: 9.0% Mean Entropy: 377.0%
2022-05-03 17:13:41,301 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 2.773, Acc: 0.363, Base Lr: 3.38e-03
2022-05-03 17:14:48,203 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 2.782, Acc: 0.367, Base Lr: 3.38e-03
2022-05-03 17:15:35,023 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.684[s] Speed: 23.4[samples/s]
2022-05-03 17:19:48,058 reid_baseline.train INFO: normal accuracy 0.08928161579068167 3.748661518096924 
2022-05-03 17:19:48,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 17:19:48,927 reid_baseline.train INFO: Accuracy: 8.9% Mean Entropy: 374.9%
2022-05-03 17:21:05,975 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 2.747, Acc: 0.393, Base Lr: 2.77e-03
2022-05-03 17:22:09,383 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 2.743, Acc: 0.379, Base Lr: 2.77e-03
2022-05-03 17:22:57,864 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.691[s] Speed: 23.1[samples/s]
2022-05-03 17:27:15,206 reid_baseline.train INFO: normal accuracy 0.07436309387193023 3.6933419704437256 
2022-05-03 17:27:16,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 17:27:16,121 reid_baseline.train INFO: Accuracy: 7.4% Mean Entropy: 369.3%
2022-05-03 17:28:24,090 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 2.677, Acc: 0.392, Base Lr: 2.20e-03
2022-05-03 17:29:37,220 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 2.651, Acc: 0.401, Base Lr: 2.20e-03
2022-05-03 17:30:22,693 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.683[s] Speed: 23.4[samples/s]
2022-05-03 17:34:35,417 reid_baseline.train INFO: normal accuracy 0.0778058296993344 3.6990582942962646 
2022-05-03 17:34:35,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 17:34:35,420 reid_baseline.train INFO: Accuracy: 7.8% Mean Entropy: 369.9%
2022-05-03 17:35:46,919 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 2.628, Acc: 0.429, Base Lr: 1.66e-03
2022-05-03 17:36:55,754 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 2.647, Acc: 0.417, Base Lr: 1.66e-03
2022-05-03 17:37:42,622 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-03 17:41:45,048 reid_baseline.train INFO: normal accuracy 0.08101904980491163 3.6986052989959717 
2022-05-03 17:41:45,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 17:41:45,051 reid_baseline.train INFO: Accuracy: 8.1% Mean Entropy: 369.9%
2022-05-03 17:43:02,693 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 2.575, Acc: 0.428, Base Lr: 1.19e-03
2022-05-03 17:44:06,208 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 2.598, Acc: 0.425, Base Lr: 1.19e-03
2022-05-03 17:44:52,449 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.686[s] Speed: 23.3[samples/s]
2022-05-03 17:49:17,507 reid_baseline.train INFO: normal accuracy 0.08515033279779664 3.676922559738159 
2022-05-03 17:49:18,423 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 17:49:18,423 reid_baseline.train INFO: Accuracy: 8.5% Mean Entropy: 367.7%
2022-05-03 17:50:36,256 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 2.557, Acc: 0.444, Base Lr: 7.78e-04
2022-05-03 17:51:44,407 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 2.567, Acc: 0.437, Base Lr: 7.78e-04
2022-05-03 17:52:36,952 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.727[s] Speed: 22.0[samples/s]
2022-05-03 17:56:49,261 reid_baseline.train INFO: normal accuracy 0.08124856552673858 3.6921560764312744 
2022-05-03 17:56:49,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 17:56:49,263 reid_baseline.train INFO: Accuracy: 8.1% Mean Entropy: 369.2%
2022-05-03 17:57:59,949 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 2.559, Acc: 0.434, Base Lr: 4.51e-04
2022-05-03 17:59:04,771 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 2.572, Acc: 0.426, Base Lr: 4.51e-04
2022-05-03 17:59:50,807 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.665[s] Speed: 24.1[samples/s]
2022-05-03 18:04:18,711 reid_baseline.train INFO: normal accuracy 0.08216662841404636 3.69356369972229 
2022-05-03 18:04:18,712 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 18:04:18,712 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 369.4%
2022-05-03 18:05:37,633 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 2.582, Acc: 0.432, Base Lr: 2.11e-04
2022-05-03 18:06:48,828 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 2.569, Acc: 0.438, Base Lr: 2.11e-04
2022-05-03 18:07:37,737 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.728[s] Speed: 22.0[samples/s]
2022-05-03 18:12:00,320 reid_baseline.train INFO: normal accuracy 0.08124856552673858 3.6895663738250732 
2022-05-03 18:12:00,322 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 18:12:00,322 reid_baseline.train INFO: Accuracy: 8.1% Mean Entropy: 369.0%
2022-05-03 18:13:11,245 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 2.548, Acc: 0.445, Base Lr: 6.51e-05
2022-05-03 18:14:19,332 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 2.563, Acc: 0.440, Base Lr: 6.51e-05
2022-05-03 18:15:13,224 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.706[s] Speed: 22.7[samples/s]
2022-05-03 18:19:43,952 reid_baseline.train INFO: normal accuracy 0.08193711269221941 3.68892765045166 
2022-05-03 18:19:43,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 18:19:43,953 reid_baseline.train INFO: Accuracy: 8.2% Mean Entropy: 368.9%
2022-05-03 18:20:58,259 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 2.560, Acc: 0.452, Base Lr: 1.60e-05
2022-05-03 18:22:08,146 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 2.538, Acc: 0.450, Base Lr: 1.60e-05
2022-05-03 18:22:59,144 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.714[s] Speed: 22.4[samples/s]
2022-05-03 18:27:44,880 reid_baseline.train INFO: normal accuracy 0.08354372274500803 3.6572060585021973 
2022-05-03 18:27:45,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 18:27:45,869 reid_baseline.train INFO: Accuracy: 8.4% Mean Entropy: 365.7%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_DRI_Cls_corrected/transformer_best_model.pth
2022-05-03 18:32:53,653 reid_baseline.train INFO: normal accuracy 0.08354372274500803 3.6572060585021973 
2022-05-03 18:32:53,654 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:32:53,654 reid_baseline.train INFO: Accuracy: 8.4%
2022-05-03 18:38:14,057 reid_baseline.train INFO: normal accuracy 0.08354372274500803 3.6572060585021973 
2022-05-03 18:38:14,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:38:14,058 reid_baseline.train INFO: Shuffled Accuracy: 8.4%
2022-05-03 18:40:26,677 reid_baseline.train INFO: normal accuracy 0.16449026345933562 3.5951359272003174 
2022-05-03 18:40:26,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:40:26,681 reid_baseline.train INFO: Source Clean Accuracy: 16.4%
