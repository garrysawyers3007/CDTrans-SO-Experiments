2022-04-14 03:24:46,389 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_2
2022-04-14 03:24:46,389 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-14 03:24:46,389 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 03:24:46,389 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 03:24:46,390 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 03:24:53,779 reid_baseline.train INFO: start training
2022-04-14 03:25:07,117 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.295, Base Lr: 4.76e-04
2022-04-14 03:25:13,450 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.128[s] Speed: 125.4[samples/s]
2022-04-14 03:25:33,962 reid_baseline.train INFO: normal accuracy 0.38579610538373427 4.172661304473877 
2022-04-14 03:25:34,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 03:25:34,746 reid_baseline.train INFO: Accuracy: 38.6% Mean Entropy: 417.3%
2022-04-14 03:25:47,777 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.894, Acc: 0.696, Base Lr: 8.72e-04
2022-04-14 03:25:54,173 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.128[s] Speed: 125.2[samples/s]
2022-04-14 03:26:14,709 reid_baseline.train INFO: normal accuracy 0.4359679266895762 4.1666131019592285 
2022-04-14 03:26:15,564 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 03:26:15,564 reid_baseline.train INFO: Accuracy: 43.6% Mean Entropy: 416.7%
2022-04-14 03:26:28,397 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.476, Acc: 0.733, Base Lr: 1.27e-03
2022-04-14 03:26:34,489 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.124[s] Speed: 128.6[samples/s]
2022-04-14 03:26:54,976 reid_baseline.train INFO: normal accuracy 0.44742268041237115 4.137569904327393 
2022-04-14 03:26:55,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 03:26:55,798 reid_baseline.train INFO: Accuracy: 44.7% Mean Entropy: 413.8%
2022-04-14 03:27:08,839 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.924, Acc: 0.727, Base Lr: 1.66e-03
2022-04-14 03:27:15,189 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.127[s] Speed: 125.6[samples/s]
2022-04-14 03:27:35,742 reid_baseline.train INFO: normal accuracy 0.4570446735395189 4.0011444091796875 
2022-04-14 03:27:36,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 03:27:36,516 reid_baseline.train INFO: Accuracy: 45.7% Mean Entropy: 400.1%
2022-04-14 03:27:49,846 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.301, Acc: 0.751, Base Lr: 2.06e-03
2022-04-14 03:27:56,412 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.131[s] Speed: 122.4[samples/s]
2022-04-14 03:28:16,985 reid_baseline.train INFO: normal accuracy 0.4946162657502864 3.6711437702178955 
2022-04-14 03:28:17,831 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 03:28:17,831 reid_baseline.train INFO: Accuracy: 49.5% Mean Entropy: 367.1%
2022-04-14 03:28:30,551 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.784, Base Lr: 2.46e-03
2022-04-14 03:28:36,432 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.121[s] Speed: 131.8[samples/s]
2022-04-14 03:28:56,946 reid_baseline.train INFO: normal accuracy 0.5443298969072164 3.3216099739074707 
2022-04-14 03:28:57,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 03:28:57,758 reid_baseline.train INFO: Accuracy: 54.4% Mean Entropy: 332.2%
2022-04-14 03:29:10,582 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.514, Acc: 0.843, Base Lr: 2.85e-03
2022-04-14 03:29:16,728 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.125[s] Speed: 128.4[samples/s]
2022-04-14 03:29:37,309 reid_baseline.train INFO: normal accuracy 0.5835051546391753 2.9146034717559814 
2022-04-14 03:29:38,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 03:29:38,697 reid_baseline.train INFO: Accuracy: 58.4% Mean Entropy: 291.5%
2022-04-14 03:29:51,374 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.309, Acc: 0.883, Base Lr: 3.25e-03
2022-04-14 03:29:57,297 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.122[s] Speed: 131.1[samples/s]
2022-04-14 03:30:17,825 reid_baseline.train INFO: normal accuracy 0.6038946162657503 2.568610429763794 
2022-04-14 03:30:18,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 03:30:18,666 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 256.9%
2022-04-14 03:30:31,547 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.182, Acc: 0.908, Base Lr: 3.64e-03
2022-04-14 03:30:37,559 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.123[s] Speed: 129.7[samples/s]
2022-04-14 03:30:58,066 reid_baseline.train INFO: normal accuracy 0.6036655211912944 2.27990984916687 
2022-04-14 03:30:58,906 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 03:30:58,906 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 228.0%
2022-04-14 03:31:11,817 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.926, Base Lr: 4.04e-03
2022-04-14 03:31:17,818 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.124[s] Speed: 128.8[samples/s]
2022-04-14 03:31:39,280 reid_baseline.train INFO: normal accuracy 0.6096219931271478 2.1563479900360107 
2022-04-14 03:31:41,683 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 03:31:41,684 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 215.6%
2022-04-14 03:31:54,633 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.028, Acc: 0.941, Base Lr: 4.44e-03
2022-04-14 03:32:00,702 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 03:32:21,281 reid_baseline.train INFO: normal accuracy 0.618327605956472 1.9651323556900024 
2022-04-14 03:32:22,104 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 03:32:22,104 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 196.5%
2022-04-14 03:32:35,169 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.950, Base Lr: 4.83e-03
2022-04-14 03:32:41,315 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.125[s] Speed: 127.7[samples/s]
2022-04-14 03:33:01,909 reid_baseline.train INFO: normal accuracy 0.6233676975945017 1.9825879335403442 
2022-04-14 03:33:01,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 03:33:01,910 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 198.3%
2022-04-14 03:33:15,313 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.936, Acc: 0.965, Base Lr: 5.23e-03
2022-04-14 03:33:21,621 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.129[s] Speed: 124.0[samples/s]
2022-04-14 03:33:42,157 reid_baseline.train INFO: normal accuracy 0.6162657502863689 1.9655275344848633 
2022-04-14 03:33:42,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 03:33:42,158 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 196.6%
2022-04-14 03:33:54,825 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.903, Acc: 0.981, Base Lr: 5.62e-03
2022-04-14 03:34:00,706 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.122[s] Speed: 131.3[samples/s]
2022-04-14 03:34:21,193 reid_baseline.train INFO: normal accuracy 0.6194730813287515 1.9186104536056519 
2022-04-14 03:34:22,011 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 03:34:22,011 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 191.9%
2022-04-14 03:34:34,890 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.980, Base Lr: 6.02e-03
2022-04-14 03:34:40,852 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.124[s] Speed: 129.2[samples/s]
2022-04-14 03:35:01,495 reid_baseline.train INFO: normal accuracy 0.6153493699885453 1.8531773090362549 
2022-04-14 03:35:03,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 03:35:03,977 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 185.3%
2022-04-14 03:35:16,771 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.857, Acc: 0.984, Base Lr: 6.42e-03
2022-04-14 03:35:22,858 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 03:35:43,467 reid_baseline.train INFO: normal accuracy 0.6080183276059564 1.8790419101715088 
2022-04-14 03:35:43,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 03:35:43,467 reid_baseline.train INFO: Accuracy: 60.8% Mean Entropy: 187.9%
2022-04-14 03:35:56,422 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.842, Acc: 0.991, Base Lr: 6.81e-03
2022-04-14 03:36:02,520 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.125[s] Speed: 127.9[samples/s]
2022-04-14 03:36:23,009 reid_baseline.train INFO: normal accuracy 0.6109965635738832 1.9752018451690674 
2022-04-14 03:36:23,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 03:36:23,009 reid_baseline.train INFO: Accuracy: 61.1% Mean Entropy: 197.5%
2022-04-14 03:36:35,351 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.840, Acc: 0.989, Base Lr: 7.21e-03
2022-04-14 03:36:41,301 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.120[s] Speed: 133.2[samples/s]
2022-04-14 03:37:01,832 reid_baseline.train INFO: normal accuracy 0.6128293241695304 1.8376915454864502 
2022-04-14 03:37:02,644 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 03:37:02,645 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 183.8%
2022-04-14 03:37:15,574 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.825, Acc: 0.991, Base Lr: 7.60e-03
2022-04-14 03:37:21,778 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.126[s] Speed: 127.3[samples/s]
2022-04-14 03:37:42,247 reid_baseline.train INFO: normal accuracy 0.6059564719358533 1.918710708618164 
2022-04-14 03:37:42,247 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 03:37:42,247 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 191.9%
2022-04-14 03:37:55,356 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.810, Acc: 0.994, Base Lr: 4.01e-03
2022-04-14 03:38:01,449 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.126[s] Speed: 126.9[samples/s]
2022-04-14 03:38:22,989 reid_baseline.train INFO: normal accuracy 0.6130584192439863 1.9811493158340454 
2022-04-14 03:38:22,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 03:38:22,990 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 198.1%
2022-04-14 03:38:36,139 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.804, Acc: 0.994, Base Lr: 3.69e-03
2022-04-14 03:38:42,219 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.125[s] Speed: 127.6[samples/s]
2022-04-14 03:39:02,671 reid_baseline.train INFO: normal accuracy 0.6151202749140894 2.0006654262542725 
2022-04-14 03:39:02,672 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 03:39:02,672 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 200.1%
2022-04-14 03:39:15,184 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.800, Acc: 0.994, Base Lr: 3.38e-03
2022-04-14 03:39:21,446 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.123[s] Speed: 129.7[samples/s]
2022-04-14 03:39:42,118 reid_baseline.train INFO: normal accuracy 0.6121420389461627 1.9908944368362427 
2022-04-14 03:39:42,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 03:39:42,119 reid_baseline.train INFO: Accuracy: 61.2% Mean Entropy: 199.1%
2022-04-14 03:39:54,802 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.802, Acc: 0.994, Base Lr: 3.08e-03
2022-04-14 03:40:00,684 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.121[s] Speed: 132.2[samples/s]
2022-04-14 03:40:21,160 reid_baseline.train INFO: normal accuracy 0.611454753722795 1.9890050888061523 
2022-04-14 03:40:21,161 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 03:40:21,161 reid_baseline.train INFO: Accuracy: 61.1% Mean Entropy: 198.9%
2022-04-14 03:40:33,818 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.800, Acc: 0.995, Base Lr: 2.77e-03
2022-04-14 03:40:39,690 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.120[s] Speed: 133.1[samples/s]
2022-04-14 03:41:00,283 reid_baseline.train INFO: normal accuracy 0.6146620847651776 1.9627203941345215 
2022-04-14 03:41:00,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 03:41:00,283 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 196.3%
2022-04-14 03:41:12,857 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.791, Acc: 0.995, Base Lr: 2.48e-03
2022-04-14 03:41:18,918 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.122[s] Speed: 130.7[samples/s]
2022-04-14 03:41:39,624 reid_baseline.train INFO: normal accuracy 0.6229095074455899 1.986354112625122 
2022-04-14 03:41:39,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 03:41:39,625 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 198.6%
2022-04-14 03:41:52,345 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.993, Base Lr: 2.20e-03
2022-04-14 03:41:58,384 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.122[s] Speed: 131.0[samples/s]
2022-04-14 03:42:19,014 reid_baseline.train INFO: normal accuracy 0.6192439862542956 2.0114028453826904 
2022-04-14 03:42:19,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 03:42:19,015 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 201.1%
2022-04-14 03:42:31,305 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.995, Base Lr: 1.92e-03
2022-04-14 03:42:37,205 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.119[s] Speed: 134.0[samples/s]
2022-04-14 03:42:57,710 reid_baseline.train INFO: normal accuracy 0.6162657502863689 2.0063700675964355 
2022-04-14 03:42:57,711 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 03:42:57,711 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 200.6%
2022-04-14 03:43:10,494 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.790, Acc: 0.996, Base Lr: 1.66e-03
2022-04-14 03:43:16,421 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.123[s] Speed: 130.2[samples/s]
2022-04-14 03:43:36,874 reid_baseline.train INFO: normal accuracy 0.6190148911798397 2.0630898475646973 
2022-04-14 03:43:36,875 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 03:43:36,875 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 206.3%
2022-04-14 03:43:49,398 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.786, Acc: 0.995, Base Lr: 1.42e-03
2022-04-14 03:43:55,563 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.122[s] Speed: 131.2[samples/s]
2022-04-14 03:44:16,144 reid_baseline.train INFO: normal accuracy 0.6199312714776632 2.050461530685425 
2022-04-14 03:44:16,144 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 03:44:16,144 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 205.0%
2022-04-14 03:44:29,038 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.997, Base Lr: 1.19e-03
2022-04-14 03:44:35,117 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.124[s] Speed: 128.6[samples/s]
2022-04-14 03:44:56,382 reid_baseline.train INFO: normal accuracy 0.6206185567010309 2.0071067810058594 
2022-04-14 03:44:56,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 03:44:56,383 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 200.7%
2022-04-14 03:45:09,468 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-14 03:45:15,481 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.124[s] Speed: 128.6[samples/s]
2022-04-14 03:45:36,035 reid_baseline.train INFO: normal accuracy 0.6210767468499427 2.0146546363830566 
2022-04-14 03:45:36,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 03:45:36,035 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 201.5%
2022-04-14 03:45:48,604 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.784, Acc: 0.997, Base Lr: 7.78e-04
2022-04-14 03:45:54,564 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.121[s] Speed: 131.9[samples/s]
2022-04-14 03:46:15,098 reid_baseline.train INFO: normal accuracy 0.6210767468499427 2.1041014194488525 
2022-04-14 03:46:15,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 03:46:15,099 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 210.4%
2022-04-14 03:46:27,606 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.993, Base Lr: 6.04e-04
2022-04-14 03:46:33,781 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 03:46:54,469 reid_baseline.train INFO: normal accuracy 0.6213058419243986 2.0384607315063477 
2022-04-14 03:46:54,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 03:46:54,470 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 203.8%
2022-04-14 03:47:07,291 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 4.51e-04
2022-04-14 03:47:13,171 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.123[s] Speed: 130.4[samples/s]
2022-04-14 03:47:33,800 reid_baseline.train INFO: normal accuracy 0.6215349369988545 2.090648651123047 
2022-04-14 03:47:33,800 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 03:47:33,800 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 209.1%
2022-04-14 03:47:46,795 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.993, Base Lr: 3.20e-04
2022-04-14 03:47:52,845 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.124[s] Speed: 128.7[samples/s]
2022-04-14 03:48:13,440 reid_baseline.train INFO: normal accuracy 0.6213058419243986 2.0640907287597656 
2022-04-14 03:48:13,440 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 03:48:13,441 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 206.4%
2022-04-14 03:48:26,249 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.784, Acc: 0.996, Base Lr: 2.11e-04
2022-04-14 03:48:32,257 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.123[s] Speed: 129.7[samples/s]
2022-04-14 03:48:53,106 reid_baseline.train INFO: normal accuracy 0.6208476517754868 2.025721788406372 
2022-04-14 03:48:53,106 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 03:48:53,106 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 202.6%
2022-04-14 03:49:06,201 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-14 03:49:12,232 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.125[s] Speed: 128.1[samples/s]
2022-04-14 03:49:32,819 reid_baseline.train INFO: normal accuracy 0.6231386025200458 2.0256452560424805 
2022-04-14 03:49:32,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 03:49:32,820 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 202.6%
2022-04-14 03:49:45,321 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.783, Acc: 0.994, Base Lr: 6.51e-05
2022-04-14 03:49:51,157 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.119[s] Speed: 134.4[samples/s]
2022-04-14 03:50:11,718 reid_baseline.train INFO: normal accuracy 0.6245131729667812 2.0866477489471436 
2022-04-14 03:50:11,718 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 03:50:11,718 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 208.7%
2022-04-14 03:50:24,457 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 2.83e-05
2022-04-14 03:50:30,453 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.123[s] Speed: 130.2[samples/s]
2022-04-14 03:50:51,045 reid_baseline.train INFO: normal accuracy 0.6222222222222222 2.0868687629699707 
2022-04-14 03:50:51,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 03:50:51,046 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 208.7%
2022-04-14 03:51:04,284 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.787, Acc: 0.994, Base Lr: 1.60e-05
2022-04-14 03:51:10,632 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.128[s] Speed: 124.8[samples/s]
2022-04-14 03:51:32,219 reid_baseline.train INFO: normal accuracy 0.6219931271477663 2.053534984588623 
2022-04-14 03:51:32,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 03:51:32,220 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 205.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_2/transformer_best_model.pth
2022-04-14 03:51:53,641 reid_baseline.train INFO: normal accuracy 0.6128293241695304 1.8376915454864502 
2022-04-14 03:51:53,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 03:51:53,641 reid_baseline.train INFO: Accuracy: 61.3%
2022-04-14 03:52:13,705 reid_baseline.train INFO: normal accuracy 0.6128293241695304 1.8376915454864502 
2022-04-14 03:52:13,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 03:52:13,705 reid_baseline.train INFO: Shuffled Accuracy: 61.3%
2022-04-14 03:52:27,951 reid_baseline.train INFO: normal accuracy 0.9958796868562011 0.5656225681304932 
2022-04-14 03:52:27,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 03:52:27,952 reid_baseline.train INFO: Source Clean Accuracy: 99.6%
2022-04-14 03:52:32,278 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_3
2022-04-14 03:52:32,278 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-14 03:52:32,279 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 03:52:32,279 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 03:52:32,279 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 03:52:39,221 reid_baseline.train INFO: start training
2022-04-14 03:52:52,696 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.289, Base Lr: 4.76e-04
2022-04-14 03:52:59,298 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.132[s] Speed: 121.6[samples/s]
2022-04-14 03:53:19,998 reid_baseline.train INFO: normal accuracy 0.38694158075601376 4.172654628753662 
2022-04-14 03:53:20,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 03:53:20,765 reid_baseline.train INFO: Accuracy: 38.7% Mean Entropy: 417.3%
2022-04-14 03:53:33,413 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.895, Acc: 0.697, Base Lr: 8.72e-04
2022-04-14 03:53:39,387 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.122[s] Speed: 130.6[samples/s]
2022-04-14 03:53:59,914 reid_baseline.train INFO: normal accuracy 0.4343642611683849 4.166616916656494 
2022-04-14 03:54:00,715 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 03:54:00,715 reid_baseline.train INFO: Accuracy: 43.4% Mean Entropy: 416.7%
2022-04-14 03:54:13,503 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.475, Acc: 0.739, Base Lr: 1.27e-03
2022-04-14 03:54:19,632 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.124[s] Speed: 128.8[samples/s]
2022-04-14 03:54:40,145 reid_baseline.train INFO: normal accuracy 0.44765177548682705 4.137641429901123 
2022-04-14 03:54:40,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 03:54:40,999 reid_baseline.train INFO: Accuracy: 44.8% Mean Entropy: 413.8%
2022-04-14 03:54:54,231 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.924, Acc: 0.737, Base Lr: 1.66e-03
2022-04-14 03:55:00,496 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.127[s] Speed: 125.6[samples/s]
2022-04-14 03:55:21,205 reid_baseline.train INFO: normal accuracy 0.4586483390607102 4.004063129425049 
2022-04-14 03:55:22,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 03:55:22,016 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 400.4%
2022-04-14 03:55:34,368 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.304, Acc: 0.748, Base Lr: 2.06e-03
2022-04-14 03:55:40,341 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.120[s] Speed: 132.9[samples/s]
2022-04-14 03:56:00,908 reid_baseline.train INFO: normal accuracy 0.4934707903780069 3.6737115383148193 
2022-04-14 03:56:01,746 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 03:56:01,747 reid_baseline.train INFO: Accuracy: 49.3% Mean Entropy: 367.4%
2022-04-14 03:56:14,558 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.843, Acc: 0.793, Base Lr: 2.46e-03
2022-04-14 03:56:20,738 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.125[s] Speed: 128.2[samples/s]
2022-04-14 03:56:41,286 reid_baseline.train INFO: normal accuracy 0.547766323024055 3.319751024246216 
2022-04-14 03:56:42,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 03:56:42,082 reid_baseline.train INFO: Accuracy: 54.8% Mean Entropy: 332.0%
2022-04-14 03:56:55,096 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.517, Acc: 0.847, Base Lr: 2.85e-03
2022-04-14 03:57:01,157 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 03:57:21,828 reid_baseline.train INFO: normal accuracy 0.5848797250859107 2.9305579662323 
2022-04-14 03:57:22,673 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 03:57:22,673 reid_baseline.train INFO: Accuracy: 58.5% Mean Entropy: 293.1%
2022-04-14 03:57:35,540 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.296, Acc: 0.892, Base Lr: 3.25e-03
2022-04-14 03:57:41,721 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 03:58:02,232 reid_baseline.train INFO: normal accuracy 0.6004581901489118 2.581156015396118 
2022-04-14 03:58:03,043 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 03:58:03,044 reid_baseline.train INFO: Accuracy: 60.0% Mean Entropy: 258.1%
2022-04-14 03:58:15,617 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.186, Acc: 0.912, Base Lr: 3.64e-03
2022-04-14 03:58:21,530 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.121[s] Speed: 131.7[samples/s]
2022-04-14 03:58:42,032 reid_baseline.train INFO: normal accuracy 0.60893470790378 2.297321319580078 
2022-04-14 03:58:42,854 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 03:58:42,855 reid_baseline.train INFO: Accuracy: 60.9% Mean Entropy: 229.7%
2022-04-14 03:58:55,158 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.929, Base Lr: 4.04e-03
2022-04-14 03:59:01,063 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.119[s] Speed: 133.9[samples/s]
2022-04-14 03:59:22,303 reid_baseline.train INFO: normal accuracy 0.6132875143184422 2.192746877670288 
2022-04-14 03:59:23,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 03:59:23,097 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 219.3%
2022-04-14 03:59:35,895 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.019, Acc: 0.943, Base Lr: 4.44e-03
2022-04-14 03:59:41,999 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.124[s] Speed: 129.1[samples/s]
2022-04-14 04:00:02,593 reid_baseline.train INFO: normal accuracy 0.6187857961053838 1.999135971069336 
2022-04-14 04:00:03,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 04:00:03,439 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 199.9%
2022-04-14 04:00:16,287 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.980, Acc: 0.952, Base Lr: 4.83e-03
2022-04-14 04:00:22,240 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.122[s] Speed: 131.1[samples/s]
2022-04-14 04:00:42,896 reid_baseline.train INFO: normal accuracy 0.6238258877434135 1.998761534690857 
2022-04-14 04:00:43,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 04:00:43,716 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 199.9%
2022-04-14 04:00:56,484 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.937, Acc: 0.965, Base Lr: 5.23e-03
2022-04-14 04:01:02,541 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.124[s] Speed: 129.4[samples/s]
2022-04-14 04:01:23,078 reid_baseline.train INFO: normal accuracy 0.6174112256586484 1.9817373752593994 
2022-04-14 04:01:23,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 04:01:23,900 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 198.2%
2022-04-14 04:01:36,499 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.904, Acc: 0.977, Base Lr: 5.62e-03
2022-04-14 04:01:42,673 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.123[s] Speed: 129.8[samples/s]
2022-04-14 04:02:03,250 reid_baseline.train INFO: normal accuracy 0.6169530355097366 1.9505410194396973 
2022-04-14 04:02:04,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 04:02:04,046 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 195.1%
2022-04-14 04:02:17,085 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.881, Acc: 0.982, Base Lr: 6.02e-03
2022-04-14 04:02:23,333 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.127[s] Speed: 126.3[samples/s]
2022-04-14 04:02:44,011 reid_baseline.train INFO: normal accuracy 0.6180985108820161 1.851585030555725 
2022-04-14 04:02:44,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 04:02:44,799 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 185.2%
2022-04-14 04:02:58,088 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.859, Acc: 0.988, Base Lr: 6.42e-03
2022-04-14 04:03:04,366 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.128[s] Speed: 124.9[samples/s]
2022-04-14 04:03:24,957 reid_baseline.train INFO: normal accuracy 0.6169530355097366 1.8743563890457153 
2022-04-14 04:03:24,958 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 04:03:24,958 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 187.4%
2022-04-14 04:03:37,447 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.842, Acc: 0.991, Base Lr: 6.81e-03
2022-04-14 04:03:43,374 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.121[s] Speed: 132.3[samples/s]
2022-04-14 04:04:03,962 reid_baseline.train INFO: normal accuracy 0.6194730813287515 1.9633835554122925 
2022-04-14 04:04:03,963 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 04:04:03,963 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 196.3%
2022-04-14 04:04:17,102 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.840, Acc: 0.987, Base Lr: 7.21e-03
2022-04-14 04:04:23,354 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.127[s] Speed: 125.7[samples/s]
2022-04-14 04:04:43,882 reid_baseline.train INFO: normal accuracy 0.6139747995418099 1.8748388290405273 
2022-04-14 04:04:43,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 04:04:43,883 reid_baseline.train INFO: Accuracy: 61.4% Mean Entropy: 187.5%
2022-04-14 04:04:57,078 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.824, Acc: 0.991, Base Lr: 7.60e-03
2022-04-14 04:05:03,075 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.125[s] Speed: 128.4[samples/s]
2022-04-14 04:05:23,774 reid_baseline.train INFO: normal accuracy 0.6071019473081328 1.9379717111587524 
2022-04-14 04:05:23,774 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 04:05:23,774 reid_baseline.train INFO: Accuracy: 60.7% Mean Entropy: 193.8%
2022-04-14 04:05:36,433 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.809, Acc: 0.994, Base Lr: 4.01e-03
2022-04-14 04:05:42,358 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.122[s] Speed: 131.1[samples/s]
2022-04-14 04:06:03,819 reid_baseline.train INFO: normal accuracy 0.6197021764032073 1.945841908454895 
2022-04-14 04:06:03,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 04:06:03,819 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 194.6%
2022-04-14 04:06:16,212 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.994, Base Lr: 3.69e-03
2022-04-14 04:06:22,293 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 04:06:42,817 reid_baseline.train INFO: normal accuracy 0.6213058419243986 1.997294306755066 
2022-04-14 04:06:42,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 04:06:42,818 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 199.7%
2022-04-14 04:06:55,701 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.799, Acc: 0.995, Base Lr: 3.38e-03
2022-04-14 04:07:02,132 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.126[s] Speed: 127.1[samples/s]
2022-04-14 04:07:22,776 reid_baseline.train INFO: normal accuracy 0.6213058419243986 1.9769368171691895 
2022-04-14 04:07:22,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 04:07:22,777 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 197.7%
2022-04-14 04:07:35,582 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.993, Base Lr: 3.08e-03
2022-04-14 04:07:41,574 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.122[s] Speed: 130.7[samples/s]
2022-04-14 04:08:02,172 reid_baseline.train INFO: normal accuracy 0.6192439862542956 1.9986145496368408 
2022-04-14 04:08:02,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 04:08:02,173 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 199.9%
2022-04-14 04:08:15,255 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.796, Acc: 0.995, Base Lr: 2.77e-03
2022-04-14 04:08:21,318 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.126[s] Speed: 127.2[samples/s]
2022-04-14 04:08:42,166 reid_baseline.train INFO: normal accuracy 0.6210767468499427 1.9626586437225342 
2022-04-14 04:08:42,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 04:08:42,166 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 196.3%
2022-04-14 04:08:54,973 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.793, Acc: 0.995, Base Lr: 2.48e-03
2022-04-14 04:09:01,022 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.124[s] Speed: 129.2[samples/s]
2022-04-14 04:09:21,547 reid_baseline.train INFO: normal accuracy 0.6219931271477663 1.9824432134628296 
2022-04-14 04:09:21,562 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 04:09:21,563 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 198.2%
2022-04-14 04:09:34,500 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.993, Base Lr: 2.20e-03
2022-04-14 04:09:40,583 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.125[s] Speed: 128.2[samples/s]
2022-04-14 04:10:01,095 reid_baseline.train INFO: normal accuracy 0.6245131729667812 2.016110420227051 
2022-04-14 04:10:01,096 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 04:10:01,096 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 201.6%
2022-04-14 04:10:13,588 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.794, Acc: 0.995, Base Lr: 1.92e-03
2022-04-14 04:10:19,516 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.121[s] Speed: 132.4[samples/s]
2022-04-14 04:10:40,022 reid_baseline.train INFO: normal accuracy 0.6224513172966781 1.9893531799316406 
2022-04-14 04:10:40,023 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 04:10:40,023 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 198.9%
2022-04-14 04:10:52,797 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.791, Acc: 0.996, Base Lr: 1.66e-03
2022-04-14 04:10:59,033 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.125[s] Speed: 128.2[samples/s]
2022-04-14 04:11:19,705 reid_baseline.train INFO: normal accuracy 0.6240549828178694 2.056931495666504 
2022-04-14 04:11:19,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 04:11:19,705 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 205.7%
2022-04-14 04:11:32,175 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.788, Acc: 0.994, Base Lr: 1.42e-03
2022-04-14 04:11:38,091 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.121[s] Speed: 132.5[samples/s]
2022-04-14 04:11:58,596 reid_baseline.train INFO: normal accuracy 0.6219931271477663 2.05513858795166 
2022-04-14 04:11:58,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 04:11:58,597 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 205.5%
2022-04-14 04:12:11,755 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.997, Base Lr: 1.19e-03
2022-04-14 04:12:17,694 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.124[s] Speed: 128.6[samples/s]
2022-04-14 04:12:39,148 reid_baseline.train INFO: normal accuracy 0.6235967926689576 2.0224788188934326 
2022-04-14 04:12:39,148 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 04:12:39,148 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 202.2%
2022-04-14 04:12:51,774 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.785, Acc: 0.998, Base Lr: 9.72e-04
2022-04-14 04:12:57,974 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.123[s] Speed: 129.8[samples/s]
2022-04-14 04:13:18,610 reid_baseline.train INFO: normal accuracy 0.6197021764032073 2.0246691703796387 
2022-04-14 04:13:18,610 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 04:13:18,610 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 202.5%
2022-04-14 04:13:31,212 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.782, Acc: 0.998, Base Lr: 7.78e-04
2022-04-14 04:13:37,053 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.121[s] Speed: 132.1[samples/s]
2022-04-14 04:13:57,587 reid_baseline.train INFO: normal accuracy 0.6238258877434135 2.120149612426758 
2022-04-14 04:13:57,587 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 04:13:57,588 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 212.0%
2022-04-14 04:14:10,335 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 6.04e-04
2022-04-14 04:14:16,210 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.122[s] Speed: 131.1[samples/s]
2022-04-14 04:14:36,741 reid_baseline.train INFO: normal accuracy 0.6238258877434135 2.026500701904297 
2022-04-14 04:14:36,741 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 04:14:36,742 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 202.7%
2022-04-14 04:14:49,287 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 4.51e-04
2022-04-14 04:14:55,561 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.124[s] Speed: 129.4[samples/s]
2022-04-14 04:15:16,315 reid_baseline.train INFO: normal accuracy 0.6231386025200458 2.0961079597473145 
2022-04-14 04:15:16,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 04:15:16,315 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 209.6%
2022-04-14 04:15:28,766 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.994, Base Lr: 3.20e-04
2022-04-14 04:15:34,632 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.120[s] Speed: 133.6[samples/s]
2022-04-14 04:15:55,086 reid_baseline.train INFO: normal accuracy 0.6235967926689576 2.070479154586792 
2022-04-14 04:15:55,086 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 04:15:55,086 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 207.0%
2022-04-14 04:16:07,486 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.784, Acc: 0.994, Base Lr: 2.11e-04
2022-04-14 04:16:13,333 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.120[s] Speed: 133.6[samples/s]
2022-04-14 04:16:33,894 reid_baseline.train INFO: normal accuracy 0.6233676975945017 2.0299530029296875 
2022-04-14 04:16:33,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 04:16:33,894 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 203.0%
2022-04-14 04:16:47,109 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-14 04:16:53,313 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.126[s] Speed: 126.8[samples/s]
2022-04-14 04:17:13,945 reid_baseline.train INFO: normal accuracy 0.6254295532646048 2.0283777713775635 
2022-04-14 04:17:13,946 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 04:17:13,946 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 202.8%
2022-04-14 04:17:26,502 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.784, Acc: 0.995, Base Lr: 6.51e-05
2022-04-14 04:17:32,517 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.122[s] Speed: 131.2[samples/s]
2022-04-14 04:17:52,982 reid_baseline.train INFO: normal accuracy 0.6238258877434135 2.0984721183776855 
2022-04-14 04:17:52,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 04:17:52,983 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 209.8%
2022-04-14 04:18:05,697 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.994, Base Lr: 2.83e-05
2022-04-14 04:18:11,777 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.123[s] Speed: 130.2[samples/s]
2022-04-14 04:18:32,404 reid_baseline.train INFO: normal accuracy 0.624971363115693 2.075435161590576 
2022-04-14 04:18:32,405 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 04:18:32,405 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 207.5%
2022-04-14 04:18:44,735 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.791, Acc: 0.993, Base Lr: 1.60e-05
2022-04-14 04:18:50,865 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.121[s] Speed: 132.6[samples/s]
2022-04-14 04:19:12,236 reid_baseline.train INFO: normal accuracy 0.6254295532646048 2.03326678276062 
2022-04-14 04:19:12,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 04:19:12,236 reid_baseline.train INFO: Accuracy: 62.5% Mean Entropy: 203.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_3/transformer_best_model.pth
2022-04-14 04:19:33,697 reid_baseline.train INFO: normal accuracy 0.6180985108820161 1.851585030555725 
2022-04-14 04:19:33,698 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:19:33,698 reid_baseline.train INFO: Accuracy: 61.8%
2022-04-14 04:19:53,596 reid_baseline.train INFO: normal accuracy 0.6180985108820161 1.851585030555725 
2022-04-14 04:19:53,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:19:53,597 reid_baseline.train INFO: Shuffled Accuracy: 61.8%
2022-04-14 04:20:07,791 reid_baseline.train INFO: normal accuracy 0.9917593737124022 0.7076267004013062 
2022-04-14 04:20:07,792 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:20:07,792 reid_baseline.train INFO: Source Clean Accuracy: 99.2%
2022-04-14 04:20:12,275 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_4
2022-04-14 04:20:12,275 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-14 04:20:12,275 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 04:20:12,275 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 04:20:12,276 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 04:20:20,168 reid_baseline.train INFO: start training
2022-04-14 04:20:33,314 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.302, Base Lr: 4.76e-04
2022-04-14 04:20:39,819 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.129[s] Speed: 124.3[samples/s]
2022-04-14 04:21:00,375 reid_baseline.train INFO: normal accuracy 0.39014891179839634 4.172661304473877 
2022-04-14 04:21:01,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 04:21:01,165 reid_baseline.train INFO: Accuracy: 39.0% Mean Entropy: 417.3%
2022-04-14 04:21:13,753 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.893, Acc: 0.701, Base Lr: 8.72e-04
2022-04-14 04:21:19,959 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.124[s] Speed: 129.5[samples/s]
2022-04-14 04:21:40,454 reid_baseline.train INFO: normal accuracy 0.4352806414662085 4.166630268096924 
2022-04-14 04:21:41,277 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 04:21:41,277 reid_baseline.train INFO: Accuracy: 43.5% Mean Entropy: 416.7%
2022-04-14 04:21:54,033 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.471, Acc: 0.741, Base Lr: 1.27e-03
2022-04-14 04:22:00,221 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.123[s] Speed: 129.9[samples/s]
2022-04-14 04:22:20,792 reid_baseline.train INFO: normal accuracy 0.44536082474226807 4.137221336364746 
2022-04-14 04:22:21,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 04:22:21,614 reid_baseline.train INFO: Accuracy: 44.5% Mean Entropy: 413.7%
2022-04-14 04:22:34,563 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.922, Acc: 0.743, Base Lr: 1.66e-03
2022-04-14 04:22:40,845 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.126[s] Speed: 126.6[samples/s]
2022-04-14 04:23:01,515 reid_baseline.train INFO: normal accuracy 0.45910652920962197 4.004425048828125 
2022-04-14 04:23:02,342 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 04:23:02,342 reid_baseline.train INFO: Accuracy: 45.9% Mean Entropy: 400.4%
2022-04-14 04:23:14,732 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.302, Acc: 0.754, Base Lr: 2.06e-03
2022-04-14 04:23:20,718 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.121[s] Speed: 132.5[samples/s]
2022-04-14 04:23:41,320 reid_baseline.train INFO: normal accuracy 0.4941580756013746 3.678377866744995 
2022-04-14 04:23:42,154 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 04:23:42,154 reid_baseline.train INFO: Accuracy: 49.4% Mean Entropy: 367.8%
2022-04-14 04:23:54,646 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.789, Base Lr: 2.46e-03
2022-04-14 04:24:00,615 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 04:24:21,162 reid_baseline.train INFO: normal accuracy 0.5429553264604811 3.3166770935058594 
2022-04-14 04:24:21,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 04:24:21,977 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 331.7%
2022-04-14 04:24:35,208 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.522, Acc: 0.839, Base Lr: 2.85e-03
2022-04-14 04:24:41,220 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.126[s] Speed: 126.5[samples/s]
2022-04-14 04:25:01,928 reid_baseline.train INFO: normal accuracy 0.5823596792668958 2.9242396354675293 
2022-04-14 04:25:02,739 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 04:25:02,740 reid_baseline.train INFO: Accuracy: 58.2% Mean Entropy: 292.4%
2022-04-14 04:25:15,340 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.299, Acc: 0.895, Base Lr: 3.25e-03
2022-04-14 04:25:21,531 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.123[s] Speed: 129.6[samples/s]
2022-04-14 04:25:42,277 reid_baseline.train INFO: normal accuracy 0.6025200458190149 2.574301242828369 
2022-04-14 04:25:43,098 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 04:25:43,098 reid_baseline.train INFO: Accuracy: 60.3% Mean Entropy: 257.4%
2022-04-14 04:25:55,710 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.184, Acc: 0.909, Base Lr: 3.64e-03
2022-04-14 04:26:01,893 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.123[s] Speed: 129.6[samples/s]
2022-04-14 04:26:22,392 reid_baseline.train INFO: normal accuracy 0.606643757159221 2.2820730209350586 
2022-04-14 04:26:23,254 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 04:26:23,255 reid_baseline.train INFO: Accuracy: 60.7% Mean Entropy: 228.2%
2022-04-14 04:26:35,917 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.080, Acc: 0.927, Base Lr: 4.04e-03
2022-04-14 04:26:42,119 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.124[s] Speed: 129.3[samples/s]
2022-04-14 04:27:03,422 reid_baseline.train INFO: normal accuracy 0.6116838487972509 2.202167510986328 
2022-04-14 04:27:04,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 04:27:04,232 reid_baseline.train INFO: Accuracy: 61.2% Mean Entropy: 220.2%
2022-04-14 04:27:16,658 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.023, Acc: 0.942, Base Lr: 4.44e-03
2022-04-14 04:27:22,591 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.121[s] Speed: 132.7[samples/s]
2022-04-14 04:27:43,188 reid_baseline.train INFO: normal accuracy 0.6162657502863689 1.9793604612350464 
2022-04-14 04:27:44,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 04:27:44,001 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 197.9%
2022-04-14 04:27:56,965 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.952, Base Lr: 4.83e-03
2022-04-14 04:28:03,352 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.126[s] Speed: 127.3[samples/s]
2022-04-14 04:28:23,950 reid_baseline.train INFO: normal accuracy 0.6240549828178694 1.9586347341537476 
2022-04-14 04:28:24,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 04:28:24,766 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 195.9%
2022-04-14 04:28:37,684 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.935, Acc: 0.965, Base Lr: 5.23e-03
2022-04-14 04:28:43,810 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.125[s] Speed: 127.9[samples/s]
2022-04-14 04:29:04,437 reid_baseline.train INFO: normal accuracy 0.6148911798396335 1.9301671981811523 
2022-04-14 04:29:05,280 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 04:29:05,280 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 193.0%
2022-04-14 04:29:18,311 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.900, Acc: 0.977, Base Lr: 5.62e-03
2022-04-14 04:29:24,583 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.126[s] Speed: 126.6[samples/s]
2022-04-14 04:29:45,131 reid_baseline.train INFO: normal accuracy 0.6148911798396335 1.934588074684143 
2022-04-14 04:29:45,132 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 04:29:45,132 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 193.5%
2022-04-14 04:29:58,354 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.880, Acc: 0.981, Base Lr: 6.02e-03
2022-04-14 04:30:04,329 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.125[s] Speed: 128.0[samples/s]
2022-04-14 04:30:24,843 reid_baseline.train INFO: normal accuracy 0.6178694158075602 1.8411895036697388 
2022-04-14 04:30:25,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 04:30:25,647 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 184.1%
2022-04-14 04:30:38,079 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.854, Acc: 0.988, Base Lr: 6.42e-03
2022-04-14 04:30:44,206 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.122[s] Speed: 131.2[samples/s]
2022-04-14 04:31:04,764 reid_baseline.train INFO: normal accuracy 0.6169530355097366 1.8669774532318115 
2022-04-14 04:31:04,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 04:31:04,764 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 186.7%
2022-04-14 04:31:17,325 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.841, Acc: 0.991, Base Lr: 6.81e-03
2022-04-14 04:31:23,258 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.121[s] Speed: 132.6[samples/s]
2022-04-14 04:31:43,821 reid_baseline.train INFO: normal accuracy 0.6112256586483391 1.9739344120025635 
2022-04-14 04:31:43,821 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 04:31:43,821 reid_baseline.train INFO: Accuracy: 61.1% Mean Entropy: 197.4%
2022-04-14 04:31:56,751 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.839, Acc: 0.989, Base Lr: 7.21e-03
2022-04-14 04:32:03,044 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.125[s] Speed: 127.5[samples/s]
2022-04-14 04:32:23,576 reid_baseline.train INFO: normal accuracy 0.6148911798396335 1.8240928649902344 
2022-04-14 04:32:24,381 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 04:32:24,381 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 182.4%
2022-04-14 04:32:37,003 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.829, Acc: 0.989, Base Lr: 7.60e-03
2022-04-14 04:32:43,195 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.124[s] Speed: 129.5[samples/s]
2022-04-14 04:33:03,728 reid_baseline.train INFO: normal accuracy 0.6121420389461627 1.8890092372894287 
2022-04-14 04:33:03,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 04:33:03,729 reid_baseline.train INFO: Accuracy: 61.2% Mean Entropy: 188.9%
2022-04-14 04:33:16,237 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.808, Acc: 0.994, Base Lr: 4.01e-03
2022-04-14 04:33:22,434 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.122[s] Speed: 131.2[samples/s]
2022-04-14 04:33:43,976 reid_baseline.train INFO: normal accuracy 0.6130584192439863 1.9572266340255737 
2022-04-14 04:33:43,977 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 04:33:43,977 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 195.7%
2022-04-14 04:33:56,429 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.69e-03
2022-04-14 04:34:02,508 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.122[s] Speed: 131.4[samples/s]
2022-04-14 04:34:23,048 reid_baseline.train INFO: normal accuracy 0.6169530355097366 2.0413310527801514 
2022-04-14 04:34:23,049 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 04:34:23,049 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 204.1%
2022-04-14 04:34:35,613 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.801, Acc: 0.995, Base Lr: 3.38e-03
2022-04-14 04:34:41,705 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 04:35:02,319 reid_baseline.train INFO: normal accuracy 0.6162657502863689 1.9636837244033813 
2022-04-14 04:35:02,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 04:35:02,320 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 196.4%
2022-04-14 04:35:15,379 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.992, Base Lr: 3.08e-03
2022-04-14 04:35:21,577 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.126[s] Speed: 127.2[samples/s]
2022-04-14 04:35:42,117 reid_baseline.train INFO: normal accuracy 0.6176403207331043 1.9414761066436768 
2022-04-14 04:35:42,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 04:35:42,118 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 194.1%
2022-04-14 04:35:54,840 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.796, Acc: 0.996, Base Lr: 2.77e-03
2022-04-14 04:36:01,105 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 04:36:21,683 reid_baseline.train INFO: normal accuracy 0.6169530355097366 1.9782718420028687 
2022-04-14 04:36:21,683 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 04:36:21,683 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 197.8%
2022-04-14 04:36:34,319 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.48e-03
2022-04-14 04:36:40,228 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.121[s] Speed: 132.7[samples/s]
2022-04-14 04:37:00,806 reid_baseline.train INFO: normal accuracy 0.6199312714776632 2.026435375213623 
2022-04-14 04:37:00,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 04:37:00,807 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 202.6%
2022-04-14 04:37:13,558 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.994, Base Lr: 2.20e-03
2022-04-14 04:37:19,517 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.123[s] Speed: 130.5[samples/s]
2022-04-14 04:37:40,117 reid_baseline.train INFO: normal accuracy 0.6155784650630012 2.027244806289673 
2022-04-14 04:37:40,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 04:37:40,117 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 202.7%
2022-04-14 04:37:52,810 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.996, Base Lr: 1.92e-03
2022-04-14 04:37:58,870 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.123[s] Speed: 129.9[samples/s]
2022-04-14 04:38:19,436 reid_baseline.train INFO: normal accuracy 0.6164948453608248 2.0174448490142822 
2022-04-14 04:38:19,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 04:38:19,437 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 201.7%
2022-04-14 04:38:32,408 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.791, Acc: 0.996, Base Lr: 1.66e-03
2022-04-14 04:38:38,449 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.124[s] Speed: 129.0[samples/s]
2022-04-14 04:38:59,092 reid_baseline.train INFO: normal accuracy 0.6192439862542956 2.038219690322876 
2022-04-14 04:38:59,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 04:38:59,093 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 203.8%
2022-04-14 04:39:11,661 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.42e-03
2022-04-14 04:39:17,794 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.122[s] Speed: 130.9[samples/s]
2022-04-14 04:39:38,387 reid_baseline.train INFO: normal accuracy 0.6164948453608248 2.050536870956421 
2022-04-14 04:39:38,387 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 04:39:38,387 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 205.1%
2022-04-14 04:39:51,126 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 1.19e-03
2022-04-14 04:39:57,096 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.123[s] Speed: 130.5[samples/s]
2022-04-14 04:40:18,523 reid_baseline.train INFO: normal accuracy 0.6164948453608248 1.9935717582702637 
2022-04-14 04:40:18,523 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 04:40:18,523 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 199.4%
2022-04-14 04:40:30,948 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-14 04:40:36,970 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.121[s] Speed: 132.1[samples/s]
2022-04-14 04:40:57,559 reid_baseline.train INFO: normal accuracy 0.6164948453608248 2.0126142501831055 
2022-04-14 04:40:57,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 04:40:57,559 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 201.3%
2022-04-14 04:41:10,126 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.783, Acc: 0.997, Base Lr: 7.78e-04
2022-04-14 04:41:16,072 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.121[s] Speed: 132.2[samples/s]
2022-04-14 04:41:36,609 reid_baseline.train INFO: normal accuracy 0.6194730813287515 2.1025407314300537 
2022-04-14 04:41:36,610 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 04:41:36,610 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 210.3%
2022-04-14 04:41:49,049 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 6.04e-04
2022-04-14 04:41:54,980 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.121[s] Speed: 132.7[samples/s]
2022-04-14 04:42:15,643 reid_baseline.train INFO: normal accuracy 0.6185567010309279 2.016531229019165 
2022-04-14 04:42:15,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 04:42:15,643 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 201.7%
2022-04-14 04:42:27,896 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.788, Acc: 0.995, Base Lr: 4.51e-04
2022-04-14 04:42:33,784 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 04:42:54,482 reid_baseline.train INFO: normal accuracy 0.6199312714776632 2.082900047302246 
2022-04-14 04:42:54,482 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 04:42:54,483 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 208.3%
2022-04-14 04:43:06,732 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 3.20e-04
2022-04-14 04:43:12,619 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.119[s] Speed: 134.6[samples/s]
2022-04-14 04:43:33,306 reid_baseline.train INFO: normal accuracy 0.6162657502863689 2.0574710369110107 
2022-04-14 04:43:33,306 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 04:43:33,306 reid_baseline.train INFO: Accuracy: 61.6% Mean Entropy: 205.7%
2022-04-14 04:43:45,978 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.785, Acc: 0.996, Base Lr: 2.11e-04
2022-04-14 04:43:52,080 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.123[s] Speed: 129.8[samples/s]
2022-04-14 04:44:12,583 reid_baseline.train INFO: normal accuracy 0.6151202749140894 2.0342586040496826 
2022-04-14 04:44:12,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 04:44:12,584 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 203.4%
2022-04-14 04:44:24,801 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.782, Acc: 0.998, Base Lr: 1.26e-04
2022-04-14 04:44:30,770 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.119[s] Speed: 134.0[samples/s]
2022-04-14 04:44:51,359 reid_baseline.train INFO: normal accuracy 0.6171821305841925 2.014549970626831 
2022-04-14 04:44:51,359 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 04:44:51,359 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 201.5%
2022-04-14 04:45:03,542 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.784, Acc: 0.994, Base Lr: 6.51e-05
2022-04-14 04:45:09,453 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.119[s] Speed: 134.9[samples/s]
2022-04-14 04:45:30,033 reid_baseline.train INFO: normal accuracy 0.6174112256586484 2.0941519737243652 
2022-04-14 04:45:30,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 04:45:30,033 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 209.4%
2022-04-14 04:45:42,620 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.782, Acc: 0.996, Base Lr: 2.83e-05
2022-04-14 04:45:48,445 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.121[s] Speed: 132.4[samples/s]
2022-04-14 04:46:08,925 reid_baseline.train INFO: normal accuracy 0.6169530355097366 2.078563928604126 
2022-04-14 04:46:08,925 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 04:46:08,926 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 207.9%
2022-04-14 04:46:21,698 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.790, Acc: 0.994, Base Lr: 1.60e-05
2022-04-14 04:46:27,629 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.121[s] Speed: 131.8[samples/s]
2022-04-14 04:46:49,035 reid_baseline.train INFO: normal accuracy 0.618327605956472 2.033742666244507 
2022-04-14 04:46:49,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 04:46:49,035 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 203.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Clipart_shuffled_key_4/transformer_best_model.pth
2022-04-14 04:47:10,014 reid_baseline.train INFO: normal accuracy 0.6148911798396335 1.8240928649902344 
2022-04-14 04:47:10,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:47:10,014 reid_baseline.train INFO: Accuracy: 61.5%
2022-04-14 04:47:29,810 reid_baseline.train INFO: normal accuracy 0.6148911798396335 1.8240928649902344 
2022-04-14 04:47:29,811 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:47:29,811 reid_baseline.train INFO: Shuffled Accuracy: 61.5%
2022-04-14 04:47:43,908 reid_baseline.train INFO: normal accuracy 0.9954676555418212 0.5764470100402832 
2022-04-14 04:47:43,908 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:47:43,908 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
