2022-04-14 11:33:16,314 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
2022-04-14 11:33:16,314 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-14 11:33:16,314 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 11:33:16,314 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 11:33:16,315 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 11:33:23,823 reid_baseline.train INFO: start training
2022-04-14 11:33:36,623 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.128, Acc: 0.259, Base Lr: 4.76e-04
2022-04-14 11:33:48,003 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.075, Acc: 0.394, Base Lr: 4.76e-04
2022-04-14 11:33:56,451 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.119[s] Speed: 134.9[samples/s]
2022-04-14 11:34:17,369 reid_baseline.train INFO: normal accuracy 0.5674701509348953 4.169826030731201 
2022-04-14 11:34:18,161 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 11:34:18,161 reid_baseline.train INFO: Accuracy: 56.7% Mean Entropy: 417.0%
2022-04-14 11:34:30,319 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.770, Acc: 0.619, Base Lr: 8.72e-04
2022-04-14 11:34:41,386 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.666, Acc: 0.617, Base Lr: 8.72e-04
2022-04-14 11:34:49,543 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.115[s] Speed: 139.2[samples/s]
2022-04-14 11:35:10,196 reid_baseline.train INFO: normal accuracy 0.572876774048209 4.128554821014404 
2022-04-14 11:35:11,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 11:35:11,035 reid_baseline.train INFO: Accuracy: 57.3% Mean Entropy: 412.9%
2022-04-14 11:35:23,237 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.119, Acc: 0.640, Base Lr: 1.27e-03
2022-04-14 11:35:34,304 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.992, Acc: 0.632, Base Lr: 1.27e-03
2022-04-14 11:35:42,695 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.116[s] Speed: 138.3[samples/s]
2022-04-14 11:36:03,505 reid_baseline.train INFO: normal accuracy 0.6206352782158143 3.881603240966797 
2022-04-14 11:36:04,335 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 11:36:04,335 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 388.2%
2022-04-14 11:36:16,569 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.393, Acc: 0.675, Base Lr: 1.66e-03
2022-04-14 11:36:27,816 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.304, Acc: 0.675, Base Lr: 1.66e-03
2022-04-14 11:36:35,928 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.115[s] Speed: 138.6[samples/s]
2022-04-14 11:36:56,562 reid_baseline.train INFO: normal accuracy 0.6659157467898176 3.382575511932373 
2022-04-14 11:36:57,463 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 11:36:57,463 reid_baseline.train INFO: Accuracy: 66.6% Mean Entropy: 338.3%
2022-04-14 11:37:10,045 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.863, Acc: 0.742, Base Lr: 2.06e-03
2022-04-14 11:37:21,534 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.828, Acc: 0.744, Base Lr: 2.06e-03
2022-04-14 11:37:29,719 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 11:37:50,427 reid_baseline.train INFO: normal accuracy 0.7226852894796125 2.8676135540008545 
2022-04-14 11:37:51,255 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 11:37:51,255 reid_baseline.train INFO: Accuracy: 72.3% Mean Entropy: 286.8%
2022-04-14 11:38:03,972 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.547, Acc: 0.811, Base Lr: 2.46e-03
2022-04-14 11:38:15,085 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.526, Acc: 0.814, Base Lr: 2.46e-03
2022-04-14 11:38:23,482 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 11:38:44,262 reid_baseline.train INFO: normal accuracy 0.7465645415634152 2.462951183319092 
2022-04-14 11:38:45,079 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 11:38:45,080 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 246.3%
2022-04-14 11:38:57,609 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.391, Acc: 0.832, Base Lr: 2.85e-03
2022-04-14 11:39:08,987 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.364, Acc: 0.841, Base Lr: 2.85e-03
2022-04-14 11:39:17,379 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.118[s] Speed: 135.3[samples/s]
2022-04-14 11:39:38,326 reid_baseline.train INFO: normal accuracy 0.7553503041225501 2.2099385261535645 
2022-04-14 11:39:40,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 11:39:40,823 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 221.0%
2022-04-14 11:39:53,427 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.260, Acc: 0.869, Base Lr: 3.25e-03
2022-04-14 11:40:04,620 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.255, Acc: 0.862, Base Lr: 3.25e-03
2022-04-14 11:40:12,871 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.117[s] Speed: 137.2[samples/s]
2022-04-14 11:40:33,657 reid_baseline.train INFO: normal accuracy 0.7643613426447398 2.0806028842926025 
2022-04-14 11:40:34,490 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 11:40:34,490 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 208.1%
2022-04-14 11:40:47,131 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.165, Acc: 0.889, Base Lr: 3.64e-03
2022-04-14 11:40:58,408 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.166, Acc: 0.889, Base Lr: 3.64e-03
2022-04-14 11:41:06,915 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.119[s] Speed: 134.8[samples/s]
2022-04-14 11:41:27,737 reid_baseline.train INFO: normal accuracy 0.771119621536382 1.9808629751205444 
2022-04-14 11:41:28,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 11:41:28,571 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 198.1%
2022-04-14 11:41:41,189 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.107, Acc: 0.906, Base Lr: 4.04e-03
2022-04-14 11:41:52,529 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.103, Acc: 0.909, Base Lr: 4.04e-03
2022-04-14 11:42:00,763 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.117[s] Speed: 136.2[samples/s]
2022-04-14 11:42:22,927 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.8942137956619263 
2022-04-14 11:42:25,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 11:42:25,810 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 189.4%
2022-04-14 11:42:38,397 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.074, Acc: 0.922, Base Lr: 4.44e-03
2022-04-14 11:42:49,515 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.057, Acc: 0.924, Base Lr: 4.44e-03
2022-04-14 11:42:57,884 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.117[s] Speed: 136.8[samples/s]
2022-04-14 11:43:18,758 reid_baseline.train INFO: normal accuracy 0.7880153187654877 1.8433711528778076 
2022-04-14 11:43:19,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 11:43:19,544 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 184.3%
2022-04-14 11:43:31,879 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.017, Acc: 0.939, Base Lr: 4.83e-03
2022-04-14 11:43:43,281 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.022, Acc: 0.933, Base Lr: 4.83e-03
2022-04-14 11:43:51,818 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 11:44:12,713 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.8040826320648193 
2022-04-14 11:44:13,550 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 11:44:13,550 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 180.4%
2022-04-14 11:44:25,843 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.974, Acc: 0.952, Base Lr: 5.23e-03
2022-04-14 11:44:36,957 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.987, Acc: 0.944, Base Lr: 5.23e-03
2022-04-14 11:44:45,137 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.116[s] Speed: 138.4[samples/s]
2022-04-14 11:45:06,287 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.8203792572021484 
2022-04-14 11:45:06,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 11:45:06,287 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 182.0%
2022-04-14 11:45:18,962 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.958, Acc: 0.946, Base Lr: 5.62e-03
2022-04-14 11:45:30,547 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.959, Acc: 0.947, Base Lr: 5.62e-03
2022-04-14 11:45:38,930 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.119[s] Speed: 134.0[samples/s]
2022-04-14 11:45:59,912 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.7850770950317383 
2022-04-14 11:46:00,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 11:46:00,744 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 178.5%
2022-04-14 11:46:13,308 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.924, Acc: 0.958, Base Lr: 6.02e-03
2022-04-14 11:46:24,531 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.935, Acc: 0.954, Base Lr: 6.02e-03
2022-04-14 11:46:32,732 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.117[s] Speed: 136.6[samples/s]
2022-04-14 11:46:53,752 reid_baseline.train INFO: normal accuracy 0.7756251407974769 1.7439228296279907 
2022-04-14 11:46:54,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 11:46:54,594 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 174.4%
2022-04-14 11:47:07,142 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.918, Acc: 0.962, Base Lr: 6.42e-03
2022-04-14 11:47:18,420 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.921, Acc: 0.960, Base Lr: 6.42e-03
2022-04-14 11:47:27,058 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.119[s] Speed: 134.6[samples/s]
2022-04-14 11:47:47,889 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.6188594102859497 
2022-04-14 11:47:48,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 11:47:48,754 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 161.9%
2022-04-14 11:48:01,379 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.897, Acc: 0.966, Base Lr: 6.81e-03
2022-04-14 11:48:12,525 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.902, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 11:48:20,764 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.117[s] Speed: 136.6[samples/s]
2022-04-14 11:48:41,734 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.6542800664901733 
2022-04-14 11:48:41,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 11:48:41,734 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 165.4%
2022-04-14 11:48:54,213 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.895, Acc: 0.963, Base Lr: 7.21e-03
2022-04-14 11:49:05,384 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.888, Acc: 0.968, Base Lr: 7.21e-03
2022-04-14 11:49:13,602 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.116[s] Speed: 137.7[samples/s]
2022-04-14 11:49:34,545 reid_baseline.train INFO: normal accuracy 0.7744987609822032 1.7541617155075073 
2022-04-14 11:49:34,545 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 11:49:34,545 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 175.4%
2022-04-14 11:49:46,662 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.878, Acc: 0.970, Base Lr: 7.60e-03
2022-04-14 11:49:57,587 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.969, Base Lr: 7.60e-03
2022-04-14 11:50:05,822 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.114[s] Speed: 139.9[samples/s]
2022-04-14 11:50:26,706 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.759894847869873 
2022-04-14 11:50:26,706 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 11:50:26,706 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 176.0%
2022-04-14 11:50:39,109 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.869, Acc: 0.973, Base Lr: 4.01e-03
2022-04-14 11:50:50,256 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.867, Acc: 0.972, Base Lr: 4.01e-03
2022-04-14 11:50:58,368 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.115[s] Speed: 138.9[samples/s]
2022-04-14 11:51:19,986 reid_baseline.train INFO: normal accuracy 0.7760756927235863 1.7189992666244507 
2022-04-14 11:51:19,987 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 11:51:19,987 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 171.9%
2022-04-14 11:51:32,266 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.857, Acc: 0.977, Base Lr: 3.69e-03
2022-04-14 11:51:43,553 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.858, Acc: 0.974, Base Lr: 3.69e-03
2022-04-14 11:51:51,967 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.117[s] Speed: 136.7[samples/s]
2022-04-14 11:52:12,779 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.7239278554916382 
2022-04-14 11:52:12,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 11:52:12,780 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 172.4%
2022-04-14 11:52:25,114 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.855, Acc: 0.974, Base Lr: 3.38e-03
2022-04-14 11:52:36,268 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.853, Acc: 0.975, Base Lr: 3.38e-03
2022-04-14 11:52:44,560 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.116[s] Speed: 137.6[samples/s]
2022-04-14 11:53:05,459 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.8066401481628418 
2022-04-14 11:53:05,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 11:53:05,459 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 180.7%
2022-04-14 11:53:17,868 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.838, Acc: 0.979, Base Lr: 3.08e-03
2022-04-14 11:53:28,948 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.846, Acc: 0.978, Base Lr: 3.08e-03
2022-04-14 11:53:37,413 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.117[s] Speed: 136.9[samples/s]
2022-04-14 11:53:58,310 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.6693171262741089 
2022-04-14 11:53:58,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 11:53:58,310 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 166.9%
2022-04-14 11:54:10,394 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.831, Acc: 0.980, Base Lr: 2.77e-03
2022-04-14 11:54:21,446 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.841, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 11:54:29,645 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.115[s] Speed: 139.5[samples/s]
2022-04-14 11:54:50,501 reid_baseline.train INFO: normal accuracy 0.7713448974994368 1.6942996978759766 
2022-04-14 11:54:50,501 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 11:54:50,502 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 169.4%
2022-04-14 11:55:03,282 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.832, Acc: 0.981, Base Lr: 2.48e-03
2022-04-14 11:55:14,438 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.838, Acc: 0.977, Base Lr: 2.48e-03
2022-04-14 11:55:22,670 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 11:55:43,569 reid_baseline.train INFO: normal accuracy 0.7747240369452579 1.703098177909851 
2022-04-14 11:55:43,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 11:55:43,570 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 170.3%
2022-04-14 11:55:56,051 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.821, Acc: 0.983, Base Lr: 2.20e-03
2022-04-14 11:56:07,508 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.826, Acc: 0.979, Base Lr: 2.20e-03
2022-04-14 11:56:15,713 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 11:56:36,677 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.7732757329940796 
2022-04-14 11:56:36,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 11:56:36,677 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 177.3%
2022-04-14 11:56:48,853 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.822, Acc: 0.983, Base Lr: 1.92e-03
2022-04-14 11:57:00,220 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.828, Acc: 0.980, Base Lr: 1.92e-03
2022-04-14 11:57:08,341 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.116[s] Speed: 138.1[samples/s]
2022-04-14 11:57:29,350 reid_baseline.train INFO: normal accuracy 0.7785537283171886 1.743717074394226 
2022-04-14 11:57:29,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 11:57:29,351 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 174.4%
2022-04-14 11:57:42,212 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.819, Acc: 0.986, Base Lr: 1.66e-03
2022-04-14 11:57:53,592 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.827, Acc: 0.982, Base Lr: 1.66e-03
2022-04-14 11:58:01,973 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.119[s] Speed: 134.5[samples/s]
2022-04-14 11:58:22,819 reid_baseline.train INFO: normal accuracy 0.7751745888713675 1.7648780345916748 
2022-04-14 11:58:22,820 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 11:58:22,820 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 176.5%
2022-04-14 11:58:35,046 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 1.42e-03
2022-04-14 11:58:46,202 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.823, Acc: 0.981, Base Lr: 1.42e-03
2022-04-14 11:58:54,787 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.117[s] Speed: 136.8[samples/s]
2022-04-14 11:59:15,658 reid_baseline.train INFO: normal accuracy 0.7778779004280243 1.875257134437561 
2022-04-14 11:59:15,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 11:59:15,658 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 187.5%
2022-04-14 11:59:27,736 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.817, Acc: 0.985, Base Lr: 1.19e-03
2022-04-14 11:59:38,908 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.821, Acc: 0.983, Base Lr: 1.19e-03
2022-04-14 11:59:47,070 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.115[s] Speed: 139.4[samples/s]
2022-04-14 12:00:08,704 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.760339379310608 
2022-04-14 12:00:08,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 12:00:08,705 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 176.0%
2022-04-14 12:00:21,090 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 9.72e-04
2022-04-14 12:00:32,464 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.820, Acc: 0.980, Base Lr: 9.72e-04
2022-04-14 12:00:40,728 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.117[s] Speed: 136.6[samples/s]
2022-04-14 12:01:01,575 reid_baseline.train INFO: normal accuracy 0.780806487947736 1.8137139081954956 
2022-04-14 12:01:01,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 12:01:01,576 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 181.4%
2022-04-14 12:01:14,080 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.814, Acc: 0.983, Base Lr: 7.78e-04
2022-04-14 12:01:25,414 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.817, Acc: 0.982, Base Lr: 7.78e-04
2022-04-14 12:01:33,588 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.117[s] Speed: 136.5[samples/s]
2022-04-14 12:01:54,524 reid_baseline.train INFO: normal accuracy 0.780806487947736 1.8133410215377808 
2022-04-14 12:01:54,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 12:01:54,524 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 181.3%
2022-04-14 12:02:07,025 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.809, Acc: 0.990, Base Lr: 6.04e-04
2022-04-14 12:02:18,261 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.818, Acc: 0.983, Base Lr: 6.04e-04
2022-04-14 12:02:26,717 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.118[s] Speed: 135.8[samples/s]
2022-04-14 12:02:47,641 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.7469433546066284 
2022-04-14 12:02:47,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 12:02:47,642 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 174.7%
2022-04-14 12:02:59,699 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.820, Acc: 0.980, Base Lr: 4.51e-04
2022-04-14 12:03:10,724 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.819, Acc: 0.979, Base Lr: 4.51e-04
2022-04-14 12:03:18,805 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.114[s] Speed: 140.3[samples/s]
2022-04-14 12:03:39,642 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.8041095733642578 
2022-04-14 12:03:39,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 12:03:39,643 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 180.4%
2022-04-14 12:03:52,080 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.820, Acc: 0.978, Base Lr: 3.20e-04
2022-04-14 12:04:03,313 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 3.20e-04
2022-04-14 12:04:11,397 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.116[s] Speed: 138.4[samples/s]
2022-04-14 12:04:32,403 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.7769380807876587 
2022-04-14 12:04:32,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 12:04:32,404 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 177.7%
2022-04-14 12:04:45,103 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.809, Acc: 0.985, Base Lr: 2.11e-04
2022-04-14 12:04:56,285 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.812, Acc: 0.984, Base Lr: 2.11e-04
2022-04-14 12:05:04,697 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 12:05:25,544 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.7720251083374023 
2022-04-14 12:05:25,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 12:05:25,544 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 177.2%
2022-04-14 12:05:37,999 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.813, Acc: 0.986, Base Lr: 1.26e-04
2022-04-14 12:05:49,093 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.816, Acc: 0.984, Base Lr: 1.26e-04
2022-04-14 12:05:57,201 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.116[s] Speed: 138.1[samples/s]
2022-04-14 12:06:18,057 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.7550939321517944 
2022-04-14 12:06:18,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 12:06:18,058 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 175.5%
2022-04-14 12:06:30,761 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.821, Acc: 0.977, Base Lr: 6.51e-05
2022-04-14 12:06:42,428 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 6.51e-05
2022-04-14 12:06:50,914 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.120[s] Speed: 133.4[samples/s]
2022-04-14 12:07:11,784 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.8704562187194824 
2022-04-14 12:07:11,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 12:07:11,785 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 187.0%
2022-04-14 12:07:24,206 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.813, Acc: 0.984, Base Lr: 2.83e-05
2022-04-14 12:07:35,289 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.817, Acc: 0.982, Base Lr: 2.83e-05
2022-04-14 12:07:43,533 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.116[s] Speed: 137.7[samples/s]
2022-04-14 12:08:04,441 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.845676302909851 
2022-04-14 12:08:04,441 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 12:08:04,442 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 184.6%
2022-04-14 12:08:17,157 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.819, Acc: 0.979, Base Lr: 1.60e-05
2022-04-14 12:08:28,261 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 1.60e-05
2022-04-14 12:08:36,449 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.116[s] Speed: 137.5[samples/s]
2022-04-14 12:08:58,026 reid_baseline.train INFO: normal accuracy 0.780806487947736 1.772519588470459 
2022-04-14 12:08:58,026 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 12:08:58,026 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 177.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_1/transformer_best_model.pth
2022-04-14 12:09:19,311 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.6188594102859497 
2022-04-14 12:09:19,312 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:09:19,312 reid_baseline.train INFO: Accuracy: 78.0%
2022-04-14 12:09:40,216 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.6188594102859497 
2022-04-14 12:09:40,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:09:40,217 reid_baseline.train INFO: Shuffled Accuracy: 78.0%
2022-04-14 12:10:00,847 reid_baseline.train INFO: normal accuracy 0.9731958762886598 0.6256215572357178 
2022-04-14 12:10:00,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:10:00,848 reid_baseline.train INFO: Source Clean Accuracy: 97.3%
2022-04-14 12:10:04,946 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_6
2022-04-14 12:10:04,946 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-14 12:10:04,946 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 12:10:04,946 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 12:10:04,946 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 12:10:12,996 reid_baseline.train INFO: start training
2022-04-14 12:10:25,614 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.127, Acc: 0.270, Base Lr: 4.76e-04
2022-04-14 12:10:37,051 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.074, Acc: 0.397, Base Lr: 4.76e-04
2022-04-14 12:10:45,700 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.120[s] Speed: 133.9[samples/s]
2022-04-14 12:11:06,622 reid_baseline.train INFO: normal accuracy 0.5627393557107456 4.169774532318115 
2022-04-14 12:11:07,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 12:11:07,408 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 417.0%
2022-04-14 12:11:19,842 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.766, Acc: 0.624, Base Lr: 8.72e-04
2022-04-14 12:11:31,097 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.662, Acc: 0.613, Base Lr: 8.72e-04
2022-04-14 12:11:39,267 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.117[s] Speed: 137.1[samples/s]
2022-04-14 12:12:00,163 reid_baseline.train INFO: normal accuracy 0.5776075692723587 4.127866268157959 
2022-04-14 12:12:00,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 12:12:01,000 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 412.8%
2022-04-14 12:12:13,802 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.115, Acc: 0.636, Base Lr: 1.27e-03
2022-04-14 12:12:25,499 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.987, Acc: 0.629, Base Lr: 1.27e-03
2022-04-14 12:12:33,839 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.120[s] Speed: 133.3[samples/s]
2022-04-14 12:12:54,773 reid_baseline.train INFO: normal accuracy 0.622662761883307 3.8801333904266357 
2022-04-14 12:12:55,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 12:12:55,593 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 388.0%
2022-04-14 12:13:07,960 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.389, Acc: 0.675, Base Lr: 1.66e-03
2022-04-14 12:13:19,190 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.297, Acc: 0.680, Base Lr: 1.66e-03
2022-04-14 12:13:27,664 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.117[s] Speed: 136.3[samples/s]
2022-04-14 12:13:48,507 reid_baseline.train INFO: normal accuracy 0.6677179544942554 3.3896336555480957 
2022-04-14 12:13:49,332 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 12:13:49,332 reid_baseline.train INFO: Accuracy: 66.8% Mean Entropy: 339.0%
2022-04-14 12:14:01,825 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.861, Acc: 0.740, Base Lr: 2.06e-03
2022-04-14 12:14:13,115 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.827, Acc: 0.744, Base Lr: 2.06e-03
2022-04-14 12:14:21,336 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.117[s] Speed: 136.6[samples/s]
2022-04-14 12:14:42,186 reid_baseline.train INFO: normal accuracy 0.7193061500337914 2.8713901042938232 
2022-04-14 12:14:43,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 12:14:43,069 reid_baseline.train INFO: Accuracy: 71.9% Mean Entropy: 287.1%
2022-04-14 12:14:55,587 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.547, Acc: 0.808, Base Lr: 2.46e-03
2022-04-14 12:15:06,951 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.526, Acc: 0.809, Base Lr: 2.46e-03
2022-04-14 12:15:15,285 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.118[s] Speed: 135.7[samples/s]
2022-04-14 12:15:36,146 reid_baseline.train INFO: normal accuracy 0.7458887136742509 2.4643380641937256 
2022-04-14 12:15:36,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 12:15:36,980 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 246.4%
2022-04-14 12:15:49,476 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.395, Acc: 0.834, Base Lr: 2.85e-03
2022-04-14 12:16:00,716 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.368, Acc: 0.840, Base Lr: 2.85e-03
2022-04-14 12:16:09,145 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 12:16:30,177 reid_baseline.train INFO: normal accuracy 0.7546744762333859 2.1935977935791016 
2022-04-14 12:16:31,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 12:16:31,016 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 219.4%
2022-04-14 12:16:43,551 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.260, Acc: 0.868, Base Lr: 3.25e-03
2022-04-14 12:16:54,781 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.253, Acc: 0.868, Base Lr: 3.25e-03
2022-04-14 12:17:03,069 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.117[s] Speed: 136.3[samples/s]
2022-04-14 12:17:23,969 reid_baseline.train INFO: normal accuracy 0.759855823383645 2.0857298374176025 
2022-04-14 12:17:24,859 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 12:17:24,859 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 208.6%
2022-04-14 12:17:37,582 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.171, Acc: 0.890, Base Lr: 3.64e-03
2022-04-14 12:17:49,459 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.891, Base Lr: 3.64e-03
2022-04-14 12:17:58,105 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.122[s] Speed: 131.5[samples/s]
2022-04-14 12:18:18,961 reid_baseline.train INFO: normal accuracy 0.7693174138319442 2.004500150680542 
2022-04-14 12:18:19,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 12:18:19,823 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 200.5%
2022-04-14 12:18:32,105 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.104, Acc: 0.911, Base Lr: 4.04e-03
2022-04-14 12:18:43,337 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.108, Acc: 0.902, Base Lr: 4.04e-03
2022-04-14 12:18:51,949 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 12:19:13,618 reid_baseline.train INFO: normal accuracy 0.7765262446496959 1.916068434715271 
2022-04-14 12:19:14,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 12:19:14,450 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 191.6%
2022-04-14 12:19:26,702 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.074, Acc: 0.914, Base Lr: 4.44e-03
2022-04-14 12:19:38,046 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.059, Acc: 0.920, Base Lr: 4.44e-03
2022-04-14 12:19:46,469 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.117[s] Speed: 136.5[samples/s]
2022-04-14 12:20:07,390 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.8476364612579346 
2022-04-14 12:20:08,269 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 12:20:08,269 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 184.8%
2022-04-14 12:20:20,789 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.014, Acc: 0.941, Base Lr: 4.83e-03
2022-04-14 12:20:31,987 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.020, Acc: 0.933, Base Lr: 4.83e-03
2022-04-14 12:20:40,290 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.117[s] Speed: 136.6[samples/s]
2022-04-14 12:21:01,179 reid_baseline.train INFO: normal accuracy 0.7886911466546519 1.8242720365524292 
2022-04-14 12:21:02,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 12:21:02,013 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 182.4%
2022-04-14 12:21:14,499 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.979, Acc: 0.948, Base Lr: 5.23e-03
2022-04-14 12:21:26,479 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.989, Acc: 0.939, Base Lr: 5.23e-03
2022-04-14 12:21:34,823 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.120[s] Speed: 133.2[samples/s]
2022-04-14 12:21:55,678 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.8306021690368652 
2022-04-14 12:21:55,678 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 12:21:55,678 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 183.1%
2022-04-14 12:22:08,245 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.954, Acc: 0.949, Base Lr: 5.62e-03
2022-04-14 12:22:19,367 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.955, Acc: 0.948, Base Lr: 5.62e-03
2022-04-14 12:22:27,981 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 12:22:48,943 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.787996530532837 
2022-04-14 12:22:49,770 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 12:22:49,770 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 178.8%
2022-04-14 12:23:02,572 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.919, Acc: 0.957, Base Lr: 6.02e-03
2022-04-14 12:23:14,477 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.936, Acc: 0.954, Base Lr: 6.02e-03
2022-04-14 12:23:23,192 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 12:23:44,200 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.7402759790420532 
2022-04-14 12:23:45,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 12:23:45,035 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 174.0%
2022-04-14 12:23:57,725 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.909, Acc: 0.966, Base Lr: 6.42e-03
2022-04-14 12:24:08,908 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.918, Acc: 0.962, Base Lr: 6.42e-03
2022-04-14 12:24:17,235 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 12:24:38,217 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6481611728668213 
2022-04-14 12:24:39,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 12:24:39,051 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 164.8%
2022-04-14 12:24:51,524 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.910, Acc: 0.963, Base Lr: 6.81e-03
2022-04-14 12:25:02,733 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.911, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 12:25:11,038 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.117[s] Speed: 136.7[samples/s]
2022-04-14 12:25:31,983 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.6630958318710327 
2022-04-14 12:25:31,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 12:25:31,984 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 166.3%
2022-04-14 12:25:44,380 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.889, Acc: 0.967, Base Lr: 7.21e-03
2022-04-14 12:25:55,614 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.890, Acc: 0.966, Base Lr: 7.21e-03
2022-04-14 12:26:03,944 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.117[s] Speed: 136.9[samples/s]
2022-04-14 12:26:24,840 reid_baseline.train INFO: normal accuracy 0.7760756927235863 1.7234152555465698 
2022-04-14 12:26:24,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 12:26:24,841 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 172.3%
2022-04-14 12:26:37,015 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.876, Acc: 0.973, Base Lr: 7.60e-03
2022-04-14 12:26:48,263 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.972, Base Lr: 7.60e-03
2022-04-14 12:26:56,990 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.118[s] Speed: 136.0[samples/s]
2022-04-14 12:27:17,835 reid_baseline.train INFO: normal accuracy 0.7783284523541338 1.7292673587799072 
2022-04-14 12:27:17,835 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 12:27:17,835 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 172.9%
2022-04-14 12:27:30,385 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.861, Acc: 0.976, Base Lr: 4.01e-03
2022-04-14 12:27:41,792 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.861, Acc: 0.976, Base Lr: 4.01e-03
2022-04-14 12:27:50,102 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.118[s] Speed: 136.0[samples/s]
2022-04-14 12:28:11,674 reid_baseline.train INFO: normal accuracy 0.7751745888713675 1.6940971612930298 
2022-04-14 12:28:11,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 12:28:11,674 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 169.4%
2022-04-14 12:28:23,971 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.853, Acc: 0.977, Base Lr: 3.69e-03
2022-04-14 12:28:35,161 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.857, Acc: 0.973, Base Lr: 3.69e-03
2022-04-14 12:28:43,368 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.116[s] Speed: 138.0[samples/s]
2022-04-14 12:29:04,140 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.7402317523956299 
2022-04-14 12:29:04,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 12:29:04,141 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 174.0%
2022-04-14 12:29:16,446 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.857, Acc: 0.971, Base Lr: 3.38e-03
2022-04-14 12:29:28,041 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.853, Acc: 0.974, Base Lr: 3.38e-03
2022-04-14 12:29:36,647 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.119[s] Speed: 134.5[samples/s]
2022-04-14 12:29:57,407 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.8055070638656616 
2022-04-14 12:29:57,407 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 12:29:57,407 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 180.6%
2022-04-14 12:30:09,802 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.837, Acc: 0.979, Base Lr: 3.08e-03
2022-04-14 12:30:21,367 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.844, Acc: 0.977, Base Lr: 3.08e-03
2022-04-14 12:30:29,912 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.119[s] Speed: 134.7[samples/s]
2022-04-14 12:30:50,928 reid_baseline.train INFO: normal accuracy 0.7756251407974769 1.7000478506088257 
2022-04-14 12:30:50,929 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 12:30:50,929 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 170.0%
2022-04-14 12:31:03,295 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.831, Acc: 0.981, Base Lr: 2.77e-03
2022-04-14 12:31:14,977 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.838, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 12:31:23,672 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.120[s] Speed: 133.5[samples/s]
2022-04-14 12:31:44,701 reid_baseline.train INFO: normal accuracy 0.7713448974994368 1.717081904411316 
2022-04-14 12:31:44,702 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 12:31:44,702 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 171.7%
2022-04-14 12:31:56,739 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.831, Acc: 0.982, Base Lr: 2.48e-03
2022-04-14 12:32:07,789 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.839, Acc: 0.977, Base Lr: 2.48e-03
2022-04-14 12:32:16,108 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.114[s] Speed: 139.9[samples/s]
2022-04-14 12:32:36,836 reid_baseline.train INFO: normal accuracy 0.7767515206127507 1.685894250869751 
2022-04-14 12:32:36,837 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 12:32:36,837 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 168.6%
2022-04-14 12:32:49,543 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.826, Acc: 0.981, Base Lr: 2.20e-03
2022-04-14 12:33:01,202 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.829, Acc: 0.980, Base Lr: 2.20e-03
2022-04-14 12:33:09,731 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.120[s] Speed: 133.0[samples/s]
2022-04-14 12:33:30,438 reid_baseline.train INFO: normal accuracy 0.7756251407974769 1.7667216062545776 
2022-04-14 12:33:30,438 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 12:33:30,438 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 176.7%
2022-04-14 12:33:42,364 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.823, Acc: 0.981, Base Lr: 1.92e-03
2022-04-14 12:33:53,461 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.829, Acc: 0.978, Base Lr: 1.92e-03
2022-04-14 12:34:01,621 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.114[s] Speed: 140.3[samples/s]
2022-04-14 12:34:22,346 reid_baseline.train INFO: normal accuracy 0.7765262446496959 1.7649167776107788 
2022-04-14 12:34:22,347 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 12:34:22,347 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 176.5%
2022-04-14 12:34:34,176 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.823, Acc: 0.984, Base Lr: 1.66e-03
2022-04-14 12:34:45,198 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.829, Acc: 0.981, Base Lr: 1.66e-03
2022-04-14 12:34:53,414 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.114[s] Speed: 140.7[samples/s]
2022-04-14 12:35:14,143 reid_baseline.train INFO: normal accuracy 0.7778779004280243 1.773423194885254 
2022-04-14 12:35:14,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 12:35:14,144 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 177.3%
2022-04-14 12:35:26,572 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.816, Acc: 0.986, Base Lr: 1.42e-03
2022-04-14 12:35:38,109 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.820, Acc: 0.983, Base Lr: 1.42e-03
2022-04-14 12:35:46,584 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.119[s] Speed: 135.0[samples/s]
2022-04-14 12:36:07,384 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.860020399093628 
2022-04-14 12:36:07,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 12:36:07,385 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 186.0%
2022-04-14 12:36:19,774 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.814, Acc: 0.983, Base Lr: 1.19e-03
2022-04-14 12:36:31,227 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 1.19e-03
2022-04-14 12:36:39,728 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 12:37:01,130 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.7657532691955566 
2022-04-14 12:37:01,131 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 12:37:01,131 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 176.6%
2022-04-14 12:37:13,323 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 9.72e-04
2022-04-14 12:37:24,753 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.818, Acc: 0.981, Base Lr: 9.72e-04
2022-04-14 12:37:33,368 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.118[s] Speed: 136.1[samples/s]
2022-04-14 12:37:54,127 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.8137191534042358 
2022-04-14 12:37:54,128 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 12:37:54,128 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 181.4%
2022-04-14 12:38:06,570 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.815, Acc: 0.981, Base Lr: 7.78e-04
2022-04-14 12:38:18,069 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.819, Acc: 0.981, Base Lr: 7.78e-04
2022-04-14 12:38:26,644 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.119[s] Speed: 134.5[samples/s]
2022-04-14 12:38:47,383 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.818291187286377 
2022-04-14 12:38:47,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 12:38:47,383 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 181.8%
2022-04-14 12:38:59,764 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.811, Acc: 0.987, Base Lr: 6.04e-04
2022-04-14 12:39:11,177 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.819, Acc: 0.982, Base Lr: 6.04e-04
2022-04-14 12:39:19,726 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 12:39:40,578 reid_baseline.train INFO: normal accuracy 0.7772020725388601 1.7362258434295654 
2022-04-14 12:39:40,579 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 12:39:40,579 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 173.6%
2022-04-14 12:39:53,073 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.819, Acc: 0.982, Base Lr: 4.51e-04
2022-04-14 12:40:04,542 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.821, Acc: 0.981, Base Lr: 4.51e-04
2022-04-14 12:40:13,026 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 12:40:33,840 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.7988141775131226 
2022-04-14 12:40:33,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 12:40:33,841 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 179.9%
2022-04-14 12:40:46,237 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.821, Acc: 0.980, Base Lr: 3.20e-04
2022-04-14 12:40:57,817 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 3.20e-04
2022-04-14 12:41:06,483 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.119[s] Speed: 134.0[samples/s]
2022-04-14 12:41:27,286 reid_baseline.train INFO: normal accuracy 0.7792295562063528 1.773904800415039 
2022-04-14 12:41:27,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 12:41:27,287 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 177.4%
2022-04-14 12:41:39,835 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.809, Acc: 0.989, Base Lr: 2.11e-04
2022-04-14 12:41:51,422 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.812, Acc: 0.985, Base Lr: 2.11e-04
2022-04-14 12:41:59,922 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.119[s] Speed: 133.9[samples/s]
2022-04-14 12:42:20,565 reid_baseline.train INFO: normal accuracy 0.779004280243298 1.7703101634979248 
2022-04-14 12:42:20,565 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 12:42:20,566 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 177.0%
2022-04-14 12:42:32,953 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.819, Acc: 0.983, Base Lr: 1.26e-04
2022-04-14 12:42:44,088 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.821, Acc: 0.981, Base Lr: 1.26e-04
2022-04-14 12:42:52,232 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.116[s] Speed: 138.4[samples/s]
2022-04-14 12:43:12,950 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.7422897815704346 
2022-04-14 12:43:12,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 12:43:12,951 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 174.2%
2022-04-14 12:43:25,644 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.821, Acc: 0.980, Base Lr: 6.51e-05
2022-04-14 12:43:37,225 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.821, Acc: 0.981, Base Lr: 6.51e-05
2022-04-14 12:43:45,741 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.120[s] Speed: 133.7[samples/s]
2022-04-14 12:44:06,436 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.8649739027023315 
2022-04-14 12:44:06,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 12:44:06,437 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 186.5%
2022-04-14 12:44:18,931 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 2.83e-05
2022-04-14 12:44:30,608 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 2.83e-05
2022-04-14 12:44:38,862 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.118[s] Speed: 135.1[samples/s]
2022-04-14 12:44:59,680 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.8217275142669678 
2022-04-14 12:44:59,680 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 12:44:59,680 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 182.2%
2022-04-14 12:45:12,122 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.818, Acc: 0.982, Base Lr: 1.60e-05
2022-04-14 12:45:23,793 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.817, Acc: 0.982, Base Lr: 1.60e-05
2022-04-14 12:45:32,133 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.119[s] Speed: 134.7[samples/s]
2022-04-14 12:45:53,750 reid_baseline.train INFO: normal accuracy 0.7801306600585718 1.7713299989700317 
2022-04-14 12:45:53,751 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 12:45:53,751 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 177.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_6/transformer_best_model.pth
2022-04-14 12:46:15,051 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6481611728668213 
2022-04-14 12:46:15,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:46:15,051 reid_baseline.train INFO: Accuracy: 77.9%
2022-04-14 12:46:34,969 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6481611728668213 
2022-04-14 12:46:34,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:46:34,969 reid_baseline.train INFO: Shuffled Accuracy: 77.9%
2022-04-14 12:46:55,394 reid_baseline.train INFO: normal accuracy 0.9718213058419244 0.6526678204536438 
2022-04-14 12:46:55,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 12:46:55,395 reid_baseline.train INFO: Source Clean Accuracy: 97.2%
