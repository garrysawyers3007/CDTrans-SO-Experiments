2022-04-19 03:25:56,518 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1_20_10
2022-04-19 03:25:56,518 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-19 03:25:56,518 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 03:25:56,518 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 03:25:56,519 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 03:26:03,052 reid_baseline.train INFO: start training
2022-04-19 03:26:45,435 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.251, Base Lr: 8.72e-04
2022-04-19 03:27:27,973 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.367, Base Lr: 8.72e-04
2022-04-19 03:28:00,438 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.429[s] Speed: 37.3[samples/s]
2022-04-19 03:28:30,627 reid_baseline.train INFO: normal accuracy 0.5055624227441285 4.167154312133789 
2022-04-19 03:28:33,644 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 03:28:33,645 reid_baseline.train INFO: Accuracy: 50.6% Mean Entropy: 416.7%
2022-04-19 03:29:16,848 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.630, Acc: 0.578, Base Lr: 1.66e-03
2022-04-19 03:29:59,717 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.476, Acc: 0.558, Base Lr: 1.66e-03
2022-04-19 03:30:31,318 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.431[s] Speed: 37.1[samples/s]
2022-04-19 03:31:02,960 reid_baseline.train INFO: normal accuracy 0.5545941491553358 4.039480209350586 
2022-04-19 03:31:08,028 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 03:31:08,029 reid_baseline.train INFO: Accuracy: 55.5% Mean Entropy: 403.9%
2022-04-19 03:31:49,079 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.688, Acc: 0.618, Base Lr: 2.46e-03
2022-04-19 03:32:29,714 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.550, Acc: 0.619, Base Lr: 2.46e-03
2022-04-19 03:32:57,081 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-19 03:33:28,151 reid_baseline.train INFO: normal accuracy 0.6168108776266996 3.4652345180511475 
2022-04-19 03:33:31,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 03:33:31,232 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 346.5%
2022-04-19 03:34:15,504 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.026, Acc: 0.680, Base Lr: 3.25e-03
2022-04-19 03:34:55,891 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.926, Acc: 0.703, Base Lr: 3.25e-03
2022-04-19 03:35:21,741 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-19 03:35:54,349 reid_baseline.train INFO: normal accuracy 0.6679027606098064 2.867680788040161 
2022-04-19 03:35:58,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 03:35:58,878 reid_baseline.train INFO: Accuracy: 66.8% Mean Entropy: 286.8%
2022-04-19 03:36:41,339 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.660, Acc: 0.746, Base Lr: 4.04e-03
2022-04-19 03:37:23,863 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.636, Acc: 0.752, Base Lr: 4.04e-03
2022-04-19 03:37:52,642 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.417[s] Speed: 38.4[samples/s]
2022-04-19 03:38:20,325 reid_baseline.train INFO: normal accuracy 0.696332921302019 2.538881778717041 
2022-04-19 03:38:23,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 03:38:23,422 reid_baseline.train INFO: Accuracy: 69.6% Mean Entropy: 253.9%
2022-04-19 03:39:10,259 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.446, Acc: 0.810, Base Lr: 4.83e-03
2022-04-19 03:39:48,016 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.443, Acc: 0.805, Base Lr: 4.83e-03
2022-04-19 03:40:16,023 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.412[s] Speed: 38.8[samples/s]
2022-04-19 03:40:43,819 reid_baseline.train INFO: normal accuracy 0.7165224557066338 2.2858712673187256 
2022-04-19 03:40:46,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 03:40:46,912 reid_baseline.train INFO: Accuracy: 71.7% Mean Entropy: 228.6%
2022-04-19 03:41:30,037 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.343, Acc: 0.828, Base Lr: 5.62e-03
2022-04-19 03:42:12,520 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.343, Acc: 0.824, Base Lr: 5.62e-03
2022-04-19 03:42:41,750 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.421[s] Speed: 38.0[samples/s]
2022-04-19 03:43:11,047 reid_baseline.train INFO: normal accuracy 0.7198187062216729 2.1114954948425293 
2022-04-19 03:43:16,861 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 03:43:16,861 reid_baseline.train INFO: Accuracy: 72.0% Mean Entropy: 211.1%
2022-04-19 03:43:59,531 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.249, Acc: 0.846, Base Lr: 6.42e-03
2022-04-19 03:44:36,585 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.254, Acc: 0.853, Base Lr: 6.42e-03
2022-04-19 03:45:06,379 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-19 03:45:30,138 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.0600109100341797 
2022-04-19 03:45:33,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 03:45:33,242 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 206.0%
2022-04-19 03:46:18,020 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.214, Acc: 0.866, Base Lr: 7.21e-03
2022-04-19 03:46:57,620 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.194, Acc: 0.872, Base Lr: 7.21e-03
2022-04-19 03:47:29,834 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.427[s] Speed: 37.5[samples/s]
2022-04-19 03:47:55,475 reid_baseline.train INFO: normal accuracy 0.7313555830243098 1.9880051612854004 
2022-04-19 03:47:58,601 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 03:47:58,602 reid_baseline.train INFO: Accuracy: 73.1% Mean Entropy: 198.8%
2022-04-19 03:48:39,483 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.140, Acc: 0.885, Base Lr: 4.01e-03
2022-04-19 03:49:17,568 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.147, Acc: 0.884, Base Lr: 4.01e-03
2022-04-19 03:49:49,828 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.407[s] Speed: 39.3[samples/s]
2022-04-19 03:50:19,324 reid_baseline.train INFO: normal accuracy 0.7342398022249691 1.941468358039856 
2022-04-19 03:50:22,445 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 03:50:22,446 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 194.1%
2022-04-19 03:51:02,881 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.095, Acc: 0.909, Base Lr: 3.38e-03
2022-04-19 03:51:46,806 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.107, Acc: 0.901, Base Lr: 3.38e-03
2022-04-19 03:52:16,936 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.419[s] Speed: 38.2[samples/s]
2022-04-19 03:52:41,377 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.8929519653320312 
2022-04-19 03:52:44,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 03:52:44,460 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 189.3%
2022-04-19 03:53:24,658 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.082, Acc: 0.906, Base Lr: 2.77e-03
2022-04-19 03:54:05,781 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.080, Acc: 0.906, Base Lr: 2.77e-03
2022-04-19 03:54:35,070 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-19 03:55:04,154 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9001986980438232 
2022-04-19 03:55:04,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 03:55:04,158 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 190.0%
2022-04-19 03:55:40,320 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.034, Acc: 0.924, Base Lr: 2.20e-03
2022-04-19 03:56:22,359 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.053, Acc: 0.921, Base Lr: 2.20e-03
2022-04-19 03:56:45,930 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-19 03:57:10,434 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.9227880239486694 
2022-04-19 03:57:10,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 03:57:10,439 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 192.3%
2022-04-19 03:57:50,046 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.039, Acc: 0.912, Base Lr: 1.66e-03
2022-04-19 03:58:34,085 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.044, Acc: 0.917, Base Lr: 1.66e-03
2022-04-19 03:59:05,967 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.423[s] Speed: 37.8[samples/s]
2022-04-19 03:59:34,356 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.9175128936767578 
2022-04-19 03:59:34,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 03:59:34,356 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 191.8%
2022-04-19 04:00:13,145 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.923, Base Lr: 1.19e-03
2022-04-19 04:00:56,003 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.030, Acc: 0.920, Base Lr: 1.19e-03
2022-04-19 04:01:27,820 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.416[s] Speed: 38.5[samples/s]
2022-04-19 04:01:58,369 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8807945251464844 
2022-04-19 04:02:01,585 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 04:02:01,585 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 188.1%
2022-04-19 04:02:45,146 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.017, Acc: 0.928, Base Lr: 7.78e-04
2022-04-19 04:03:25,859 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.015, Acc: 0.934, Base Lr: 7.78e-04
2022-04-19 04:03:51,417 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-19 04:04:24,892 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.9164419174194336 
2022-04-19 04:04:24,896 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 04:04:24,896 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 191.6%
2022-04-19 04:05:08,758 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.025, Acc: 0.931, Base Lr: 4.51e-04
2022-04-19 04:05:51,587 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.022, Acc: 0.931, Base Lr: 4.51e-04
2022-04-19 04:06:19,981 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.422[s] Speed: 38.0[samples/s]
2022-04-19 04:06:45,495 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.86110258102417 
2022-04-19 04:06:48,579 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 04:06:48,579 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 186.1%
2022-04-19 04:07:32,273 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.022, Acc: 0.927, Base Lr: 2.11e-04
2022-04-19 04:08:14,190 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.021, Acc: 0.927, Base Lr: 2.11e-04
2022-04-19 04:08:42,994 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.419[s] Speed: 38.2[samples/s]
2022-04-19 04:09:13,374 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.836613416671753 
2022-04-19 04:09:16,754 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 04:09:16,756 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 183.7%
2022-04-19 04:10:01,802 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.022, Acc: 0.922, Base Lr: 6.51e-05
2022-04-19 04:10:36,008 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.019, Acc: 0.927, Base Lr: 6.51e-05
2022-04-19 04:11:03,975 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-19 04:11:35,979 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.8642385005950928 
2022-04-19 04:11:35,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 04:11:35,980 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 186.4%
2022-04-19 04:12:16,160 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.928, Base Lr: 1.60e-05
2022-04-19 04:12:51,876 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.019, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 04:13:25,708 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-19 04:13:54,038 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.8469969034194946 
2022-04-19 04:13:54,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 04:13:54,038 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 184.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_1_20_10/transformer_best_model.pth
2022-04-19 04:14:24,450 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.836613416671753 
2022-04-19 04:14:24,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 04:14:24,450 reid_baseline.train INFO: Accuracy: 74.5%
2022-04-19 04:14:59,552 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.836613416671753 
2022-04-19 04:14:59,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 04:14:59,560 reid_baseline.train INFO: Shuffled Accuracy: 74.5%
2022-04-19 04:15:27,393 reid_baseline.train INFO: normal accuracy 0.9583046964490264 0.8001209497451782 
2022-04-19 04:15:27,393 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 04:15:27,393 reid_baseline.train INFO: Source Clean Accuracy: 95.8%
2022-04-19 04:15:31,695 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_1_20_10
2022-04-19 04:15:31,695 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_1_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-19 04:15:31,695 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 04:15:31,696 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 04:15:31,696 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_1_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 04:15:40,998 reid_baseline.train INFO: start training
2022-04-19 04:16:30,271 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.251, Base Lr: 8.72e-04
2022-04-19 04:17:12,922 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.367, Base Lr: 8.72e-04
2022-04-19 04:17:44,142 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.445[s] Speed: 36.0[samples/s]
2022-04-19 04:18:11,190 reid_baseline.train INFO: normal accuracy 0.5559810768191034 4.165635585784912 
2022-04-19 04:18:14,491 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 04:18:14,496 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 416.6%
2022-04-19 04:18:59,328 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.630, Acc: 0.577, Base Lr: 1.66e-03
2022-04-19 04:19:40,064 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.476, Acc: 0.558, Base Lr: 1.66e-03
2022-04-19 04:20:09,611 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.422[s] Speed: 37.9[samples/s]
2022-04-19 04:20:38,783 reid_baseline.train INFO: normal accuracy 0.5852669520162199 3.991551160812378 
2022-04-19 04:20:41,976 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 04:20:41,977 reid_baseline.train INFO: Accuracy: 58.5% Mean Entropy: 399.2%
2022-04-19 04:21:24,647 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.688, Acc: 0.618, Base Lr: 2.46e-03
2022-04-19 04:22:04,186 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.550, Acc: 0.619, Base Lr: 2.46e-03
2022-04-19 04:22:34,599 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.413[s] Speed: 38.8[samples/s]
2022-04-19 04:23:01,108 reid_baseline.train INFO: normal accuracy 0.6514980851543141 3.245378017425537 
2022-04-19 04:23:04,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 04:23:04,339 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 324.5%
2022-04-19 04:23:50,540 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.026, Acc: 0.680, Base Lr: 3.25e-03
2022-04-19 04:24:27,095 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.926, Acc: 0.702, Base Lr: 3.25e-03
2022-04-19 04:24:58,066 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.417[s] Speed: 38.4[samples/s]
2022-04-19 04:25:29,356 reid_baseline.train INFO: normal accuracy 0.6981302095066456 2.5779852867126465 
2022-04-19 04:25:32,671 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 04:25:32,672 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 257.8%
2022-04-19 04:26:16,471 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.660, Acc: 0.745, Base Lr: 4.04e-03
2022-04-19 04:26:57,565 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.636, Acc: 0.752, Base Lr: 4.04e-03
2022-04-19 04:27:29,960 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.430[s] Speed: 37.2[samples/s]
2022-04-19 04:28:01,996 reid_baseline.train INFO: normal accuracy 0.7175039423293534 2.273298740386963 
2022-04-19 04:28:05,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 04:28:05,265 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 227.3%
2022-04-19 04:28:40,503 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.446, Acc: 0.810, Base Lr: 4.83e-03
2022-04-19 04:29:15,539 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.443, Acc: 0.806, Base Lr: 4.83e-03
2022-04-19 04:29:45,193 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-04-19 04:30:11,654 reid_baseline.train INFO: normal accuracy 0.7402568145978824 2.0396556854248047 
2022-04-19 04:30:14,868 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 04:30:14,869 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 204.0%
2022-04-19 04:30:49,153 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.344, Acc: 0.830, Base Lr: 5.62e-03
2022-04-19 04:31:22,166 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.343, Acc: 0.825, Base Lr: 5.62e-03
2022-04-19 04:31:48,372 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.342[s] Speed: 46.7[samples/s]
2022-04-19 04:32:15,312 reid_baseline.train INFO: normal accuracy 0.7429601261545393 1.8960951566696167 
2022-04-19 04:32:18,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 04:32:18,495 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 189.6%
2022-04-19 04:32:58,813 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.248, Acc: 0.846, Base Lr: 6.42e-03
2022-04-19 04:33:32,164 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.254, Acc: 0.853, Base Lr: 6.42e-03
2022-04-19 04:33:58,270 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.365[s] Speed: 43.8[samples/s]
2022-04-19 04:34:33,409 reid_baseline.train INFO: normal accuracy 0.7591799954944808 1.8382318019866943 
2022-04-19 04:34:37,156 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 04:34:37,157 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 183.8%
2022-04-19 04:35:21,672 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.214, Acc: 0.866, Base Lr: 7.21e-03
2022-04-19 04:35:56,923 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.193, Acc: 0.872, Base Lr: 7.21e-03
2022-04-19 04:36:21,111 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.381[s] Speed: 42.0[samples/s]
2022-04-19 04:36:54,505 reid_baseline.train INFO: normal accuracy 0.7573777877900428 1.8269842863082886 
2022-04-19 04:36:59,974 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 04:36:59,974 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 182.7%
2022-04-19 04:37:41,562 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.140, Acc: 0.887, Base Lr: 4.01e-03
2022-04-19 04:38:20,776 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.147, Acc: 0.885, Base Lr: 4.01e-03
2022-04-19 04:38:44,208 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-19 04:39:24,924 reid_baseline.train INFO: normal accuracy 0.7609822031989186 1.7685471773147583 
2022-04-19 04:39:29,234 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 04:39:29,235 reid_baseline.train INFO: Accuracy: 76.1% Mean Entropy: 176.9%
2022-04-19 04:40:03,333 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.095, Acc: 0.906, Base Lr: 3.38e-03
2022-04-19 04:40:46,583 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.107, Acc: 0.900, Base Lr: 3.38e-03
2022-04-19 04:41:13,326 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.381[s] Speed: 42.0[samples/s]
2022-04-19 04:41:48,362 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.6940395832061768 
2022-04-19 04:41:52,092 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 04:41:52,094 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 169.4%
2022-04-19 04:42:28,644 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.083, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 04:43:05,219 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.080, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 04:43:37,646 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.387[s] Speed: 41.4[samples/s]
2022-04-19 04:44:03,333 reid_baseline.train INFO: normal accuracy 0.7767515206127507 1.72298002243042 
2022-04-19 04:44:03,334 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 04:44:03,334 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 172.3%
2022-04-19 04:44:37,318 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.035, Acc: 0.923, Base Lr: 2.20e-03
2022-04-19 04:45:10,003 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.054, Acc: 0.920, Base Lr: 2.20e-03
2022-04-19 04:45:32,145 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-19 04:46:03,291 reid_baseline.train INFO: normal accuracy 0.771119621536382 1.7445354461669922 
2022-04-19 04:46:03,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 04:46:03,295 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 174.5%
2022-04-19 04:46:44,253 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.039, Acc: 0.911, Base Lr: 1.66e-03
2022-04-19 04:47:17,937 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.044, Acc: 0.916, Base Lr: 1.66e-03
2022-04-19 04:47:42,453 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-04-19 04:48:13,884 reid_baseline.train INFO: normal accuracy 0.7751745888713675 1.7514607906341553 
2022-04-19 04:48:13,889 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 04:48:13,889 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 175.1%
2022-04-19 04:48:53,653 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.921, Base Lr: 1.19e-03
2022-04-19 04:49:32,278 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.030, Acc: 0.917, Base Lr: 1.19e-03
2022-04-19 04:49:55,530 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-19 04:50:28,039 reid_baseline.train INFO: normal accuracy 0.7735976571299842 1.7154563665390015 
2022-04-19 04:50:28,040 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 04:50:28,040 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 171.5%
2022-04-19 04:51:04,056 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.018, Acc: 0.927, Base Lr: 7.78e-04
2022-04-19 04:51:46,136 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.015, Acc: 0.934, Base Lr: 7.78e-04
2022-04-19 04:52:13,285 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-19 04:52:45,758 reid_baseline.train INFO: normal accuracy 0.7749493129083127 1.7625941038131714 
2022-04-19 04:52:45,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 04:52:45,758 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 176.3%
2022-04-19 04:53:21,106 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.025, Acc: 0.930, Base Lr: 4.51e-04
2022-04-19 04:53:51,790 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.022, Acc: 0.932, Base Lr: 4.51e-04
2022-04-19 04:54:22,954 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.356[s] Speed: 44.9[samples/s]
2022-04-19 04:54:51,007 reid_baseline.train INFO: normal accuracy 0.7747240369452579 1.7072199583053589 
2022-04-19 04:54:51,008 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 04:54:51,008 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 170.7%
2022-04-19 04:55:23,311 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.022, Acc: 0.926, Base Lr: 2.11e-04
2022-04-19 04:55:57,118 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.021, Acc: 0.926, Base Lr: 2.11e-04
2022-04-19 04:56:18,406 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-19 04:56:50,486 reid_baseline.train INFO: normal accuracy 0.77292182924082 1.6781963109970093 
2022-04-19 04:56:54,824 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 04:56:54,825 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 167.8%
2022-04-19 04:57:37,177 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.023, Acc: 0.923, Base Lr: 6.51e-05
2022-04-19 04:58:02,991 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.019, Acc: 0.927, Base Lr: 6.51e-05
2022-04-19 04:58:30,091 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-19 04:59:02,228 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.7169209718704224 
2022-04-19 04:59:02,233 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 04:59:02,233 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 171.7%
2022-04-19 04:59:37,297 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.926, Base Lr: 1.60e-05
2022-04-19 05:00:08,797 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.019, Acc: 0.926, Base Lr: 1.60e-05
2022-04-19 05:00:28,390 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.316[s] Speed: 50.7[samples/s]
2022-04-19 05:01:05,247 reid_baseline.train INFO: normal accuracy 0.7733723811669295 1.695671558380127 
2022-04-19 05:01:05,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 05:01:05,248 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 169.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_1_20_10/transformer_best_model.pth
2022-04-19 05:01:41,032 reid_baseline.train INFO: normal accuracy 0.77292182924082 1.6781963109970093 
2022-04-19 05:01:41,032 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 05:01:41,032 reid_baseline.train INFO: Accuracy: 77.3%
2022-04-19 05:02:10,020 reid_baseline.train INFO: normal accuracy 0.77292182924082 1.6781963109970093 
2022-04-19 05:02:10,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 05:02:10,020 reid_baseline.train INFO: Shuffled Accuracy: 77.3%
2022-04-19 05:02:37,860 reid_baseline.train INFO: normal accuracy 0.9585337915234823 0.8002830147743225 
2022-04-19 05:02:37,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 05:02:37,861 reid_baseline.train INFO: Source Clean Accuracy: 95.9%
2022-04-19 05:02:41,849 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1_20_10
2022-04-19 05:02:41,849 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-19 05:02:41,849 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 05:02:41,849 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 05:02:41,850 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 05:02:49,000 reid_baseline.train INFO: start training
2022-04-19 05:03:21,779 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.251, Base Lr: 8.72e-04
2022-04-19 05:03:51,390 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.367, Base Lr: 8.72e-04
2022-04-19 05:04:11,588 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-19 05:05:54,082 reid_baseline.train INFO: normal accuracy 0.5671333486343815 4.1667304039001465 
2022-04-19 05:05:57,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 05:05:57,117 reid_baseline.train INFO: Accuracy: 56.7% Mean Entropy: 416.7%
2022-04-19 05:06:28,333 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.630, Acc: 0.577, Base Lr: 1.66e-03
2022-04-19 05:06:56,617 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.476, Acc: 0.558, Base Lr: 1.66e-03
2022-04-19 05:07:16,423 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.290[s] Speed: 55.1[samples/s]
2022-04-19 05:08:59,817 reid_baseline.train INFO: normal accuracy 0.6059215056231352 4.014642238616943 
2022-04-19 05:09:03,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 05:09:03,278 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 401.5%
2022-04-19 05:09:34,574 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.688, Acc: 0.618, Base Lr: 2.46e-03
2022-04-19 05:10:01,144 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.550, Acc: 0.619, Base Lr: 2.46e-03
2022-04-19 05:10:19,955 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-19 05:12:09,723 reid_baseline.train INFO: normal accuracy 0.6747762221712187 3.3087403774261475 
2022-04-19 05:12:13,014 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 05:12:13,016 reid_baseline.train INFO: Accuracy: 67.5% Mean Entropy: 330.9%
2022-04-19 05:12:41,387 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.026, Acc: 0.680, Base Lr: 3.25e-03
2022-04-19 05:13:14,615 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.926, Acc: 0.702, Base Lr: 3.25e-03
2022-04-19 05:13:39,925 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-19 05:15:29,841 reid_baseline.train INFO: normal accuracy 0.724122102364012 2.63761830329895 
2022-04-19 05:15:33,185 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 05:15:33,186 reid_baseline.train INFO: Accuracy: 72.4% Mean Entropy: 263.8%
2022-04-19 05:16:10,887 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.660, Acc: 0.745, Base Lr: 4.04e-03
2022-04-19 05:16:38,848 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.636, Acc: 0.752, Base Lr: 4.04e-03
2022-04-19 05:16:59,973 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-19 05:18:52,697 reid_baseline.train INFO: normal accuracy 0.7486802845994951 2.3139028549194336 
2022-04-19 05:18:55,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 05:18:55,864 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 231.4%
2022-04-19 05:19:26,043 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.446, Acc: 0.810, Base Lr: 4.83e-03
2022-04-19 05:19:53,863 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.443, Acc: 0.807, Base Lr: 4.83e-03
2022-04-19 05:20:14,294 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.287[s] Speed: 55.7[samples/s]
2022-04-19 05:22:01,006 reid_baseline.train INFO: normal accuracy 0.7711728253385357 2.0715034008026123 
2022-04-19 05:22:04,319 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 05:22:04,320 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 207.2%
2022-04-19 05:22:35,085 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.344, Acc: 0.830, Base Lr: 5.62e-03
2022-04-19 05:23:02,292 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.343, Acc: 0.825, Base Lr: 5.62e-03
2022-04-19 05:23:24,602 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.294[s] Speed: 54.4[samples/s]
2022-04-19 05:25:20,802 reid_baseline.train INFO: normal accuracy 0.7720908882258435 1.9115711450576782 
2022-04-19 05:25:24,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 05:25:24,057 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 191.2%
2022-04-19 05:25:50,433 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.248, Acc: 0.848, Base Lr: 6.42e-03
2022-04-19 05:26:17,294 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.254, Acc: 0.854, Base Lr: 6.42e-03
2022-04-19 05:26:41,508 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.284[s] Speed: 56.4[samples/s]
2022-04-19 05:28:31,450 reid_baseline.train INFO: normal accuracy 0.778517328436998 1.8552201986312866 
2022-04-19 05:28:34,723 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 05:28:34,724 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 185.5%
2022-04-19 05:29:11,960 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.214, Acc: 0.866, Base Lr: 7.21e-03
2022-04-19 05:29:50,048 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.193, Acc: 0.872, Base Lr: 7.21e-03
2022-04-19 05:30:20,263 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.387[s] Speed: 41.4[samples/s]
2022-04-19 05:32:15,709 reid_baseline.train INFO: normal accuracy 0.7817305485425752 1.8251550197601318 
2022-04-19 05:32:20,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 05:32:20,254 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 182.5%
2022-04-19 05:32:56,757 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.140, Acc: 0.887, Base Lr: 4.01e-03
2022-04-19 05:33:37,288 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.147, Acc: 0.885, Base Lr: 4.01e-03
2022-04-19 05:34:09,464 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-19 05:36:09,013 reid_baseline.train INFO: normal accuracy 0.7798944227679596 1.7750741243362427 
2022-04-19 05:36:12,288 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 05:36:12,289 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 177.5%
2022-04-19 05:36:46,661 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.095, Acc: 0.907, Base Lr: 3.38e-03
2022-04-19 05:37:28,208 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.107, Acc: 0.900, Base Lr: 3.38e-03
2022-04-19 05:37:57,362 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.385[s] Speed: 41.6[samples/s]
2022-04-19 05:40:00,872 reid_baseline.train INFO: normal accuracy 0.7899931145283452 1.7196285724639893 
2022-04-19 05:40:04,198 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 05:40:04,200 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 172.0%
2022-04-19 05:40:44,535 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.083, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 05:41:25,990 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.080, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 05:41:56,777 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.412[s] Speed: 38.8[samples/s]
2022-04-19 05:43:59,182 reid_baseline.train INFO: normal accuracy 0.7888455359192105 1.7388391494750977 
2022-04-19 05:43:59,186 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 05:43:59,186 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 173.9%
2022-04-19 05:44:41,158 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.035, Acc: 0.922, Base Lr: 2.20e-03
2022-04-19 05:45:22,942 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.054, Acc: 0.920, Base Lr: 2.20e-03
2022-04-19 05:45:53,650 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.419[s] Speed: 38.2[samples/s]
2022-04-19 05:47:51,693 reid_baseline.train INFO: normal accuracy 0.7874684415882488 1.7656415700912476 
2022-04-19 05:47:51,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 05:47:51,698 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 176.6%
2022-04-19 05:48:37,095 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.039, Acc: 0.912, Base Lr: 1.66e-03
2022-04-19 05:49:19,192 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.044, Acc: 0.917, Base Lr: 1.66e-03
2022-04-19 05:49:47,806 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.425[s] Speed: 37.6[samples/s]
2022-04-19 05:51:40,836 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.766463279724121 
2022-04-19 05:51:40,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 05:51:40,839 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 176.6%
2022-04-19 05:52:25,903 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.921, Base Lr: 1.19e-03
2022-04-19 05:53:10,124 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.030, Acc: 0.919, Base Lr: 1.19e-03
2022-04-19 05:53:37,037 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.425[s] Speed: 37.6[samples/s]
2022-04-19 05:55:32,347 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.7322996854782104 
2022-04-19 05:55:32,350 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 05:55:32,351 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 173.2%
2022-04-19 05:56:16,766 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.017, Acc: 0.927, Base Lr: 7.78e-04
2022-04-19 05:56:58,185 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.015, Acc: 0.933, Base Lr: 7.78e-04
2022-04-19 05:57:20,584 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-19 05:59:14,402 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.7693406343460083 
2022-04-19 05:59:14,407 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 05:59:14,407 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 176.9%
2022-04-19 05:59:54,945 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.025, Acc: 0.931, Base Lr: 4.51e-04
2022-04-19 06:00:31,956 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.022, Acc: 0.932, Base Lr: 4.51e-04
2022-04-19 06:00:55,353 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.369[s] Speed: 43.3[samples/s]
2022-04-19 06:02:50,117 reid_baseline.train INFO: normal accuracy 0.7918292403029608 1.709031581878662 
2022-04-19 06:02:54,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 06:02:54,078 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 170.9%
2022-04-19 06:03:37,942 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.022, Acc: 0.926, Base Lr: 2.11e-04
2022-04-19 06:04:16,967 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.021, Acc: 0.925, Base Lr: 2.11e-04
2022-04-19 06:04:42,019 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-19 06:06:38,030 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.6871707439422607 
2022-04-19 06:06:41,305 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 06:06:41,305 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 168.7%
2022-04-19 06:07:18,493 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.023, Acc: 0.923, Base Lr: 6.51e-05
2022-04-19 06:07:51,147 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.019, Acc: 0.927, Base Lr: 6.51e-05
2022-04-19 06:08:12,430 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-19 06:10:13,322 reid_baseline.train INFO: normal accuracy 0.790911177415653 1.725232720375061 
2022-04-19 06:10:13,326 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 06:10:13,326 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 172.5%
2022-04-19 06:10:47,502 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 06:11:29,053 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.019, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 06:11:58,294 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.384[s] Speed: 41.6[samples/s]
2022-04-19 06:13:53,456 reid_baseline.train INFO: normal accuracy 0.7902226302501721 1.6992595195770264 
2022-04-19 06:13:53,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 06:13:53,458 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 169.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_1_20_10/transformer_best_model.pth
2022-04-19 06:15:43,760 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.6871707439422607 
2022-04-19 06:15:43,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 06:15:43,760 reid_baseline.train INFO: Accuracy: 79.2%
2022-04-19 06:17:26,185 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.6871707439422607 
2022-04-19 06:17:26,185 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 06:17:26,185 reid_baseline.train INFO: Shuffled Accuracy: 79.2%
2022-04-19 06:17:58,125 reid_baseline.train INFO: normal accuracy 0.9585337915234823 0.8009662628173828 
2022-04-19 06:17:58,125 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 06:17:58,125 reid_baseline.train INFO: Source Clean Accuracy: 95.9%
2022-04-19 06:18:02,559 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2_20_10
2022-04-19 06:18:02,559 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-19 06:18:02,560 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 06:18:02,560 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 06:18:02,560 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 06:18:11,954 reid_baseline.train INFO: start training
2022-04-19 06:18:53,381 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.121, Acc: 0.251, Base Lr: 8.72e-04
2022-04-19 06:19:35,719 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.055, Acc: 0.369, Base Lr: 8.72e-04
2022-04-19 06:20:02,894 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.404[s] Speed: 39.6[samples/s]
2022-04-19 06:20:28,962 reid_baseline.train INFO: normal accuracy 0.507622579316028 4.167177677154541 
2022-04-19 06:20:32,119 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 06:20:32,120 reid_baseline.train INFO: Accuracy: 50.8% Mean Entropy: 416.7%
2022-04-19 06:21:08,333 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.654, Acc: 0.552, Base Lr: 1.66e-03
2022-04-19 06:21:46,773 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.491, Acc: 0.547, Base Lr: 1.66e-03
2022-04-19 06:22:17,564 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-19 06:22:41,829 reid_baseline.train INFO: normal accuracy 0.5488257107540173 4.034020900726318 
2022-04-19 06:22:45,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 06:22:45,237 reid_baseline.train INFO: Accuracy: 54.9% Mean Entropy: 403.4%
2022-04-19 06:23:24,817 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.729, Acc: 0.613, Base Lr: 2.46e-03
2022-04-19 06:24:05,529 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.559, Acc: 0.624, Base Lr: 2.46e-03
2022-04-19 06:24:34,013 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-19 06:25:00,754 reid_baseline.train INFO: normal accuracy 0.6213432220848785 3.449178457260132 
2022-04-19 06:25:04,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 06:25:04,028 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 344.9%
2022-04-19 06:25:41,080 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.015, Acc: 0.683, Base Lr: 3.25e-03
2022-04-19 06:26:17,577 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.930, Acc: 0.699, Base Lr: 3.25e-03
2022-04-19 06:26:47,808 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-19 06:27:14,806 reid_baseline.train INFO: normal accuracy 0.6777915121549237 2.8853769302368164 
2022-04-19 06:27:18,109 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 06:27:18,110 reid_baseline.train INFO: Accuracy: 67.8% Mean Entropy: 288.5%
2022-04-19 06:27:52,821 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.623, Acc: 0.767, Base Lr: 4.04e-03
2022-04-19 06:28:24,020 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.601, Acc: 0.772, Base Lr: 4.04e-03
2022-04-19 06:28:51,175 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-19 06:29:15,008 reid_baseline.train INFO: normal accuracy 0.700041203131438 2.547983407974243 
2022-04-19 06:29:18,253 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 06:29:18,254 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 254.8%
2022-04-19 06:29:46,940 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.480, Acc: 0.795, Base Lr: 4.83e-03
2022-04-19 06:30:20,171 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.449, Acc: 0.800, Base Lr: 4.83e-03
2022-04-19 06:30:43,673 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.313[s] Speed: 51.1[samples/s]
2022-04-19 06:31:10,497 reid_baseline.train INFO: normal accuracy 0.7099299546765554 2.3275792598724365 
2022-04-19 06:31:15,135 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 06:31:15,135 reid_baseline.train INFO: Accuracy: 71.0% Mean Entropy: 232.8%
2022-04-19 06:31:56,712 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.349, Acc: 0.820, Base Lr: 5.62e-03
2022-04-19 06:32:27,826 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.344, Acc: 0.828, Base Lr: 5.62e-03
2022-04-19 06:32:52,337 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.356[s] Speed: 44.9[samples/s]
2022-04-19 06:33:21,502 reid_baseline.train INFO: normal accuracy 0.7288833951380305 2.215252637863159 
2022-04-19 06:33:24,987 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 06:33:24,987 reid_baseline.train INFO: Accuracy: 72.9% Mean Entropy: 221.5%
2022-04-19 06:33:58,853 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.286, Acc: 0.844, Base Lr: 6.42e-03
2022-04-19 06:34:37,472 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.275, Acc: 0.845, Base Lr: 6.42e-03
2022-04-19 06:35:01,458 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-19 06:35:31,367 reid_baseline.train INFO: normal accuracy 0.7321796456530696 2.0687472820281982 
2022-04-19 06:35:34,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 06:35:34,561 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 206.9%
2022-04-19 06:36:07,231 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.208, Acc: 0.860, Base Lr: 7.21e-03
2022-04-19 06:36:41,529 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.200, Acc: 0.863, Base Lr: 7.21e-03
2022-04-19 06:37:10,457 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-19 06:37:34,372 reid_baseline.train INFO: normal accuracy 0.7334157395962093 2.062042236328125 
2022-04-19 06:37:37,538 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 06:37:37,540 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 206.2%
2022-04-19 06:38:07,552 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.123, Acc: 0.899, Base Lr: 4.01e-03
2022-04-19 06:38:39,992 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.133, Acc: 0.894, Base Lr: 4.01e-03
2022-04-19 06:39:05,050 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.321[s] Speed: 49.9[samples/s]
2022-04-19 06:39:36,110 reid_baseline.train INFO: normal accuracy 0.7367119901112484 1.9613062143325806 
2022-04-19 06:39:40,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 06:39:40,074 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 196.1%
2022-04-19 06:40:16,318 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.093, Acc: 0.901, Base Lr: 3.38e-03
2022-04-19 06:40:48,364 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.099, Acc: 0.902, Base Lr: 3.38e-03
2022-04-19 06:41:12,597 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-19 06:41:39,671 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8834067583084106 
2022-04-19 06:41:42,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 06:41:42,933 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 188.3%
2022-04-19 06:42:22,461 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 06:42:56,830 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.085, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 06:43:19,560 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-19 06:43:49,655 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.8779938220977783 
2022-04-19 06:43:53,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 06:43:53,047 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 187.8%
2022-04-19 06:44:26,060 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.063, Acc: 0.913, Base Lr: 2.20e-03
2022-04-19 06:45:00,072 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.065, Acc: 0.915, Base Lr: 2.20e-03
2022-04-19 06:45:26,762 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-19 06:45:54,443 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.9009119272232056 
2022-04-19 06:45:54,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 06:45:54,446 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 190.1%
2022-04-19 06:46:28,502 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.054, Acc: 0.921, Base Lr: 1.66e-03
2022-04-19 06:46:59,619 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.051, Acc: 0.918, Base Lr: 1.66e-03
2022-04-19 06:47:23,359 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-19 06:47:50,498 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9628111124038696 
2022-04-19 06:47:50,501 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 06:47:50,501 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 196.3%
2022-04-19 06:48:28,331 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.033, Acc: 0.928, Base Lr: 1.19e-03
2022-04-19 06:49:00,420 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.028, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 06:49:26,081 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-19 06:49:55,456 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8314136266708374 
2022-04-19 06:49:58,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 06:49:58,664 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 183.1%
2022-04-19 06:50:38,254 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.036, Acc: 0.926, Base Lr: 7.78e-04
2022-04-19 06:51:09,634 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.026, Acc: 0.924, Base Lr: 7.78e-04
2022-04-19 06:51:33,567 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-19 06:52:06,099 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.8670752048492432 
2022-04-19 06:52:06,099 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 06:52:06,099 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 186.7%
2022-04-19 06:52:36,798 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.035, Acc: 0.920, Base Lr: 4.51e-04
2022-04-19 06:53:10,675 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.033, Acc: 0.922, Base Lr: 4.51e-04
2022-04-19 06:53:34,372 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-19 06:54:02,293 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.865505337715149 
2022-04-19 06:54:02,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 06:54:02,296 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 186.6%
2022-04-19 06:54:37,591 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.004, Acc: 0.934, Base Lr: 2.11e-04
2022-04-19 06:55:14,895 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.004, Acc: 0.936, Base Lr: 2.11e-04
2022-04-19 06:55:44,345 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.374[s] Speed: 42.8[samples/s]
2022-04-19 06:56:15,603 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.8540270328521729 
2022-04-19 06:56:15,603 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 06:56:15,603 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 185.4%
2022-04-19 06:56:49,901 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.005, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 06:57:23,141 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.018, Acc: 0.924, Base Lr: 6.51e-05
2022-04-19 06:57:48,661 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-19 06:58:16,173 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.937196135520935 
2022-04-19 06:58:16,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 06:58:16,176 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 193.7%
2022-04-19 06:58:51,269 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.025, Acc: 0.923, Base Lr: 1.60e-05
2022-04-19 06:59:23,451 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.013, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 06:59:46,215 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-19 07:00:20,213 reid_baseline.train INFO: normal accuracy 0.7428924598269468 1.8415435552597046 
2022-04-19 07:00:20,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 07:00:20,214 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 184.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_2_20_10/transformer_best_model.pth
2022-04-19 07:00:48,559 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8314136266708374 
2022-04-19 07:00:48,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:00:48,560 reid_baseline.train INFO: Accuracy: 74.2%
2022-04-19 07:01:12,680 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8314136266708374 
2022-04-19 07:01:12,680 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:01:12,680 reid_baseline.train INFO: Shuffled Accuracy: 74.2%
2022-04-19 07:01:46,801 reid_baseline.train INFO: normal accuracy 0.9539518900343643 0.8003178238868713 
2022-04-19 07:01:46,801 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:01:46,801 reid_baseline.train INFO: Source Clean Accuracy: 95.4%
2022-04-19 07:01:54,174 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_2_20_10
2022-04-19 07:01:54,174 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_2_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-19 07:01:54,174 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 07:01:54,175 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 07:01:54,175 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_2_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 07:02:03,477 reid_baseline.train INFO: start training
2022-04-19 07:02:38,498 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.121, Acc: 0.252, Base Lr: 8.72e-04
2022-04-19 07:03:16,897 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.055, Acc: 0.370, Base Lr: 8.72e-04
2022-04-19 07:03:45,373 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-19 07:04:21,684 reid_baseline.train INFO: normal accuracy 0.5679207028610047 4.1657915115356445 
2022-04-19 07:04:26,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 07:04:26,997 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 416.6%
2022-04-19 07:05:00,779 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.654, Acc: 0.552, Base Lr: 1.66e-03
2022-04-19 07:05:32,663 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.491, Acc: 0.547, Base Lr: 1.66e-03
2022-04-19 07:06:00,489 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.342[s] Speed: 46.7[samples/s]
2022-04-19 07:06:34,903 reid_baseline.train INFO: normal accuracy 0.592926334760081 3.990825653076172 
2022-04-19 07:06:38,011 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 07:06:38,012 reid_baseline.train INFO: Accuracy: 59.3% Mean Entropy: 399.1%
2022-04-19 07:07:12,683 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.729, Acc: 0.614, Base Lr: 2.46e-03
2022-04-19 07:07:44,365 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.559, Acc: 0.625, Base Lr: 2.46e-03
2022-04-19 07:08:07,912 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-19 07:08:41,036 reid_baseline.train INFO: normal accuracy 0.6478936697454382 3.247870445251465 
2022-04-19 07:08:44,135 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 07:08:44,137 reid_baseline.train INFO: Accuracy: 64.8% Mean Entropy: 324.8%
2022-04-19 07:09:19,597 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.015, Acc: 0.683, Base Lr: 3.25e-03
2022-04-19 07:09:54,980 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.930, Acc: 0.699, Base Lr: 3.25e-03
2022-04-19 07:10:15,311 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-19 07:10:48,623 reid_baseline.train INFO: normal accuracy 0.7084929038071638 2.604728937149048 
2022-04-19 07:10:51,791 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 07:10:51,793 reid_baseline.train INFO: Accuracy: 70.8% Mean Entropy: 260.5%
2022-04-19 07:11:30,143 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.623, Acc: 0.767, Base Lr: 4.04e-03
2022-04-19 07:12:01,557 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.601, Acc: 0.772, Base Lr: 4.04e-03
2022-04-19 07:12:23,766 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-19 07:12:58,609 reid_baseline.train INFO: normal accuracy 0.7229105654426673 2.2401599884033203 
2022-04-19 07:13:01,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 07:13:01,892 reid_baseline.train INFO: Accuracy: 72.3% Mean Entropy: 224.0%
2022-04-19 07:13:43,488 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.480, Acc: 0.795, Base Lr: 4.83e-03
2022-04-19 07:14:18,475 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.449, Acc: 0.799, Base Lr: 4.83e-03
2022-04-19 07:14:42,547 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.369[s] Speed: 43.4[samples/s]
2022-04-19 07:15:18,996 reid_baseline.train INFO: normal accuracy 0.7373282270781708 2.034528970718384 
2022-04-19 07:15:22,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 07:15:22,114 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 203.5%
2022-04-19 07:15:57,207 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.350, Acc: 0.821, Base Lr: 5.62e-03
2022-04-19 07:16:35,441 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.344, Acc: 0.829, Base Lr: 5.62e-03
2022-04-19 07:17:00,120 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-19 07:17:32,796 reid_baseline.train INFO: normal accuracy 0.749267853120072 1.9459726810455322 
2022-04-19 07:17:35,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 07:17:35,997 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 194.6%
2022-04-19 07:18:09,990 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.286, Acc: 0.845, Base Lr: 6.42e-03
2022-04-19 07:18:44,242 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.275, Acc: 0.846, Base Lr: 6.42e-03
2022-04-19 07:19:13,845 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.358[s] Speed: 44.6[samples/s]
2022-04-19 07:19:44,885 reid_baseline.train INFO: normal accuracy 0.7503942329353458 1.8497285842895508 
2022-04-19 07:19:48,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 07:19:48,928 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 185.0%
2022-04-19 07:20:22,376 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.209, Acc: 0.861, Base Lr: 7.21e-03
2022-04-19 07:20:53,661 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.201, Acc: 0.863, Base Lr: 7.21e-03
2022-04-19 07:21:14,809 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.315[s] Speed: 50.9[samples/s]
2022-04-19 07:21:48,156 reid_baseline.train INFO: normal accuracy 0.7587294435683712 1.8638406991958618 
2022-04-19 07:21:48,159 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 07:21:48,160 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 186.4%
2022-04-19 07:22:22,517 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.122, Acc: 0.897, Base Lr: 4.01e-03
2022-04-19 07:22:52,947 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.133, Acc: 0.893, Base Lr: 4.01e-03
2022-04-19 07:23:17,017 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-19 07:23:52,339 reid_baseline.train INFO: normal accuracy 0.7612074791619734 1.7836763858795166 
2022-04-19 07:23:55,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 07:23:55,824 reid_baseline.train INFO: Accuracy: 76.1% Mean Entropy: 178.4%
2022-04-19 07:24:27,772 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.094, Acc: 0.904, Base Lr: 3.38e-03
2022-04-19 07:25:00,893 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.099, Acc: 0.903, Base Lr: 3.38e-03
2022-04-19 07:25:26,423 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-19 07:25:52,836 reid_baseline.train INFO: normal accuracy 0.7670646542013967 1.7129695415496826 
2022-04-19 07:25:56,060 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 07:25:56,061 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 171.3%
2022-04-19 07:26:39,775 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.088, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 07:27:16,618 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.086, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 07:27:44,637 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-19 07:28:15,162 reid_baseline.train INFO: normal accuracy 0.765938274386123 1.7169486284255981 
2022-04-19 07:28:15,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 07:28:15,166 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 171.7%
2022-04-19 07:28:59,200 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.063, Acc: 0.912, Base Lr: 2.20e-03
2022-04-19 07:29:37,965 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.065, Acc: 0.913, Base Lr: 2.20e-03
2022-04-19 07:30:04,508 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-19 07:30:31,480 reid_baseline.train INFO: normal accuracy 0.7690921378688894 1.7248826026916504 
2022-04-19 07:30:31,485 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 07:30:31,485 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 172.5%
2022-04-19 07:31:14,275 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.053, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 07:31:52,619 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.051, Acc: 0.920, Base Lr: 1.66e-03
2022-04-19 07:32:20,303 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.399[s] Speed: 40.1[samples/s]
2022-04-19 07:32:50,442 reid_baseline.train INFO: normal accuracy 0.770218517684163 1.7901960611343384 
2022-04-19 07:32:50,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 07:32:50,447 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 179.0%
2022-04-19 07:33:30,209 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.033, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 07:34:08,560 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.028, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 07:34:38,871 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-19 07:35:05,669 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.6975271701812744 
2022-04-19 07:35:08,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 07:35:08,868 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 169.8%
2022-04-19 07:35:47,626 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.035, Acc: 0.926, Base Lr: 7.78e-04
2022-04-19 07:36:24,101 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.026, Acc: 0.923, Base Lr: 7.78e-04
2022-04-19 07:36:56,345 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-19 07:37:26,510 reid_baseline.train INFO: normal accuracy 0.7715701734624916 1.7205995321273804 
2022-04-19 07:37:26,513 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 07:37:26,513 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 172.1%
2022-04-19 07:38:04,090 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.034, Acc: 0.921, Base Lr: 4.51e-04
2022-04-19 07:38:43,823 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.033, Acc: 0.923, Base Lr: 4.51e-04
2022-04-19 07:39:11,788 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-19 07:39:45,113 reid_baseline.train INFO: normal accuracy 0.7731471052038748 1.7195093631744385 
2022-04-19 07:39:45,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 07:39:45,117 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 172.0%
2022-04-19 07:40:17,448 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.004, Acc: 0.934, Base Lr: 2.11e-04
2022-04-19 07:40:48,422 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.004, Acc: 0.936, Base Lr: 2.11e-04
2022-04-19 07:41:12,076 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-19 07:41:38,628 reid_baseline.train INFO: normal accuracy 0.7740482090560937 1.709256887435913 
2022-04-19 07:41:38,631 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 07:41:38,631 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 170.9%
2022-04-19 07:42:18,832 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.005, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 07:42:57,456 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.017, Acc: 0.924, Base Lr: 6.51e-05
2022-04-19 07:43:18,612 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.366[s] Speed: 43.7[samples/s]
2022-04-19 07:43:56,248 reid_baseline.train INFO: normal accuracy 0.7735976571299842 1.7936064004898071 
2022-04-19 07:43:56,249 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 07:43:56,249 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 179.4%
2022-04-19 07:44:30,704 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.024, Acc: 0.925, Base Lr: 1.60e-05
2022-04-19 07:45:06,075 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.012, Acc: 0.928, Base Lr: 1.60e-05
2022-04-19 07:45:34,213 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-19 07:46:06,238 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.7019758224487305 
2022-04-19 07:46:06,243 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 07:46:06,243 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 170.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_2_20_10/transformer_best_model.pth
2022-04-19 07:46:44,399 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.6975271701812744 
2022-04-19 07:46:44,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:46:44,400 reid_baseline.train INFO: Accuracy: 77.2%
2022-04-19 07:47:18,248 reid_baseline.train INFO: normal accuracy 0.7724712773147105 1.6975271701812744 
2022-04-19 07:47:18,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:47:18,248 reid_baseline.train INFO: Shuffled Accuracy: 77.2%
2022-04-19 07:47:55,410 reid_baseline.train INFO: normal accuracy 0.9534936998854525 0.7991759181022644 
2022-04-19 07:47:55,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 07:47:55,410 reid_baseline.train INFO: Source Clean Accuracy: 95.3%
2022-04-19 07:48:02,929 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2_20_10
2022-04-19 07:48:02,929 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-19 07:48:02,929 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 07:48:02,930 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 07:48:02,930 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 07:48:11,876 reid_baseline.train INFO: start training
2022-04-19 07:48:54,739 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.121, Acc: 0.251, Base Lr: 8.72e-04
2022-04-19 07:49:34,779 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.055, Acc: 0.370, Base Lr: 8.72e-04
2022-04-19 07:50:03,523 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.407[s] Speed: 39.3[samples/s]
2022-04-19 07:52:00,505 reid_baseline.train INFO: normal accuracy 0.5756254303419784 4.166840553283691 
2022-04-19 07:52:03,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 07:52:03,522 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 416.7%
2022-04-19 07:52:39,979 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.654, Acc: 0.552, Base Lr: 1.66e-03
2022-04-19 07:53:18,775 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.491, Acc: 0.547, Base Lr: 1.66e-03
2022-04-19 07:53:47,188 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-19 07:55:43,358 reid_baseline.train INFO: normal accuracy 0.6137250401652513 4.012449264526367 
2022-04-19 07:55:46,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 07:55:46,629 reid_baseline.train INFO: Accuracy: 61.4% Mean Entropy: 401.2%
2022-04-19 07:56:22,068 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.729, Acc: 0.614, Base Lr: 2.46e-03
2022-04-19 07:56:53,107 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.559, Acc: 0.625, Base Lr: 2.46e-03
2022-04-19 07:57:21,636 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-19 07:59:16,309 reid_baseline.train INFO: normal accuracy 0.6766123479458342 3.304377794265747 
2022-04-19 07:59:19,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 07:59:19,536 reid_baseline.train INFO: Accuracy: 67.7% Mean Entropy: 330.4%
2022-04-19 07:59:58,543 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.015, Acc: 0.683, Base Lr: 3.25e-03
2022-04-19 08:00:37,236 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.930, Acc: 0.699, Base Lr: 3.25e-03
2022-04-19 08:01:06,549 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-19 08:03:04,944 reid_baseline.train INFO: normal accuracy 0.7303190268533395 2.666455030441284 
2022-04-19 08:03:08,330 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 08:03:08,330 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 266.6%
2022-04-19 08:03:46,037 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.623, Acc: 0.767, Base Lr: 4.04e-03
2022-04-19 08:04:23,933 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.602, Acc: 0.772, Base Lr: 4.04e-03
2022-04-19 08:04:51,900 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-19 08:06:50,960 reid_baseline.train INFO: normal accuracy 0.7512049575395915 2.3106963634490967 
2022-04-19 08:06:59,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 08:06:59,273 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 231.1%
2022-04-19 08:07:38,779 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.480, Acc: 0.793, Base Lr: 4.83e-03
2022-04-19 08:08:17,671 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.449, Acc: 0.799, Base Lr: 4.83e-03
2022-04-19 08:08:44,309 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.385[s] Speed: 41.6[samples/s]
2022-04-19 08:10:45,809 reid_baseline.train INFO: normal accuracy 0.7661234794583429 2.091372013092041 
2022-04-19 08:10:48,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 08:10:48,940 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 209.1%
2022-04-19 08:11:28,608 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.350, Acc: 0.823, Base Lr: 5.62e-03
2022-04-19 08:12:06,355 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.344, Acc: 0.830, Base Lr: 5.62e-03
2022-04-19 08:12:34,963 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.388[s] Speed: 41.2[samples/s]
2022-04-19 08:14:36,389 reid_baseline.train INFO: normal accuracy 0.7764516869405554 2.004244327545166 
2022-04-19 08:14:39,614 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 08:14:39,614 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 200.4%
2022-04-19 08:15:17,194 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.286, Acc: 0.845, Base Lr: 6.42e-03
2022-04-19 08:15:58,221 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.275, Acc: 0.845, Base Lr: 6.42e-03
2022-04-19 08:16:26,391 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-19 08:18:26,513 reid_baseline.train INFO: normal accuracy 0.7764516869405554 1.8777050971984863 
2022-04-19 08:18:29,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 08:18:29,785 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 187.8%
2022-04-19 08:19:06,565 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.209, Acc: 0.861, Base Lr: 7.21e-03
2022-04-19 08:19:44,333 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.201, Acc: 0.863, Base Lr: 7.21e-03
2022-04-19 08:20:13,556 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-19 08:22:13,970 reid_baseline.train INFO: normal accuracy 0.7849437686481524 1.894973635673523 
2022-04-19 08:22:13,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 08:22:13,973 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 189.5%
2022-04-19 08:22:56,348 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.123, Acc: 0.899, Base Lr: 4.01e-03
2022-04-19 08:23:34,839 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.134, Acc: 0.894, Base Lr: 4.01e-03
2022-04-19 08:24:03,882 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-19 08:26:07,985 reid_baseline.train INFO: normal accuracy 0.7920587560247877 1.8033950328826904 
2022-04-19 08:26:12,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 08:26:12,077 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 180.3%
2022-04-19 08:26:50,602 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.093, Acc: 0.901, Base Lr: 3.38e-03
2022-04-19 08:27:22,173 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.099, Acc: 0.902, Base Lr: 3.38e-03
2022-04-19 08:27:49,252 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.356[s] Speed: 45.0[samples/s]
2022-04-19 08:29:54,387 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.7289267778396606 
2022-04-19 08:29:57,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 08:29:57,583 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 172.9%
2022-04-19 08:30:35,389 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 08:31:13,744 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.085, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 08:31:31,572 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-19 08:33:26,957 reid_baseline.train INFO: normal accuracy 0.7913702088593069 1.7196974754333496 
2022-04-19 08:33:30,259 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 08:33:30,259 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 172.0%
2022-04-19 08:34:10,872 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.063, Acc: 0.915, Base Lr: 2.20e-03
2022-04-19 08:34:40,601 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.065, Acc: 0.915, Base Lr: 2.20e-03
2022-04-19 08:34:59,359 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.326[s] Speed: 49.0[samples/s]
2022-04-19 08:36:58,956 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7331486940383911 
2022-04-19 08:36:58,958 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 08:36:58,959 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 173.3%
2022-04-19 08:37:33,488 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.054, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 08:38:05,415 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.051, Acc: 0.919, Base Lr: 1.66e-03
2022-04-19 08:38:19,861 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.296[s] Speed: 54.0[samples/s]
2022-04-19 08:40:20,321 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.8115657567977905 
2022-04-19 08:40:20,324 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 08:40:20,324 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 181.2%
2022-04-19 08:40:54,647 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.033, Acc: 0.928, Base Lr: 1.19e-03
2022-04-19 08:41:32,940 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.028, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 08:41:54,240 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-19 08:43:52,734 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.6959477663040161 
2022-04-19 08:43:56,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 08:43:56,060 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 169.6%
2022-04-19 08:44:35,126 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.035, Acc: 0.925, Base Lr: 7.78e-04
2022-04-19 08:45:07,286 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.026, Acc: 0.922, Base Lr: 7.78e-04
2022-04-19 08:45:26,961 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-19 08:47:19,470 reid_baseline.train INFO: normal accuracy 0.7895340830846913 1.7249704599380493 
2022-04-19 08:47:19,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 08:47:19,475 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 172.5%
2022-04-19 08:47:53,477 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.035, Acc: 0.921, Base Lr: 4.51e-04
2022-04-19 08:48:25,785 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.033, Acc: 0.922, Base Lr: 4.51e-04
2022-04-19 08:48:46,089 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-19 08:50:38,963 reid_baseline.train INFO: normal accuracy 0.790911177415653 1.7258358001708984 
2022-04-19 08:50:38,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 08:50:38,964 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 172.6%
2022-04-19 08:51:07,919 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.004, Acc: 0.935, Base Lr: 2.11e-04
2022-04-19 08:51:35,100 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.004, Acc: 0.936, Base Lr: 2.11e-04
2022-04-19 08:51:52,044 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.268[s] Speed: 59.8[samples/s]
2022-04-19 08:53:51,704 reid_baseline.train INFO: normal accuracy 0.7913702088593069 1.7144269943237305 
2022-04-19 08:53:51,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 08:53:51,705 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.4%
2022-04-19 08:54:19,625 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.005, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 08:54:47,242 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.018, Acc: 0.924, Base Lr: 6.51e-05
2022-04-19 08:55:10,878 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.290[s] Speed: 55.2[samples/s]
2022-04-19 08:56:56,955 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.8019412755966187 
2022-04-19 08:56:56,956 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 08:56:56,956 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 180.2%
2022-04-19 08:57:29,829 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.025, Acc: 0.923, Base Lr: 1.60e-05
2022-04-19 08:58:07,297 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.013, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 08:58:32,211 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-19 09:00:30,833 reid_baseline.train INFO: normal accuracy 0.7904521459719991 1.7037338018417358 
2022-04-19 09:00:30,836 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 09:00:30,837 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 170.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_2_20_10/transformer_best_model.pth
2022-04-19 09:02:30,591 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.6959477663040161 
2022-04-19 09:02:30,609 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:02:30,609 reid_baseline.train INFO: Accuracy: 79.1%
2022-04-19 09:04:09,540 reid_baseline.train INFO: normal accuracy 0.790681661693826 1.6959477663040161 
2022-04-19 09:04:09,540 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:04:09,540 reid_baseline.train INFO: Shuffled Accuracy: 79.1%
2022-04-19 09:04:46,252 reid_baseline.train INFO: normal accuracy 0.9528064146620847 0.7995136976242065 
2022-04-19 09:04:46,252 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:04:46,252 reid_baseline.train INFO: Source Clean Accuracy: 95.3%
2022-04-19 09:04:52,205 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3_20_10
2022-04-19 09:04:52,205 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-19 09:04:52,205 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 09:04:52,206 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 09:04:52,206 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 09:05:00,257 reid_baseline.train INFO: start training
2022-04-19 09:05:35,466 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.255, Base Lr: 8.72e-04
2022-04-19 09:06:13,707 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.366, Base Lr: 8.72e-04
2022-04-19 09:06:38,591 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.357[s] Speed: 44.8[samples/s]
2022-04-19 09:07:08,049 reid_baseline.train INFO: normal accuracy 0.5043263288009888 4.1672186851501465 
2022-04-19 09:07:11,179 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 09:07:11,179 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 416.7%
2022-04-19 09:07:44,793 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.644, Acc: 0.566, Base Lr: 1.66e-03
2022-04-19 09:08:09,674 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.486, Acc: 0.563, Base Lr: 1.66e-03
2022-04-19 09:08:33,505 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.302[s] Speed: 53.1[samples/s]
2022-04-19 09:08:57,381 reid_baseline.train INFO: normal accuracy 0.5430572723526988 4.035676956176758 
2022-04-19 09:09:00,591 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 09:09:00,592 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 403.6%
2022-04-19 09:09:34,487 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.711, Acc: 0.591, Base Lr: 2.46e-03
2022-04-19 09:10:03,941 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.556, Acc: 0.608, Base Lr: 2.46e-03
2022-04-19 09:10:22,683 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.301[s] Speed: 53.2[samples/s]
2022-04-19 09:10:49,631 reid_baseline.train INFO: normal accuracy 0.6180469715698393 3.4327938556671143 
2022-04-19 09:10:52,789 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 09:10:52,791 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 343.3%
2022-04-19 09:11:34,463 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.003, Acc: 0.689, Base Lr: 3.25e-03
2022-04-19 09:12:04,682 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.925, Acc: 0.707, Base Lr: 3.25e-03
2022-04-19 09:12:25,372 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-19 09:12:55,358 reid_baseline.train INFO: normal accuracy 0.6794396374124434 2.948411464691162 
2022-04-19 09:12:59,775 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 09:12:59,776 reid_baseline.train INFO: Accuracy: 67.9% Mean Entropy: 294.8%
2022-04-19 09:13:31,251 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.671, Acc: 0.744, Base Lr: 4.04e-03
2022-04-19 09:14:06,605 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.624, Acc: 0.754, Base Lr: 4.04e-03
2022-04-19 09:14:31,024 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-19 09:15:01,978 reid_baseline.train INFO: normal accuracy 0.7049855789039967 2.538900136947632 
2022-04-19 09:15:05,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 09:15:05,095 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 253.9%
2022-04-19 09:15:39,693 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.425, Acc: 0.812, Base Lr: 4.83e-03
2022-04-19 09:16:07,377 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.448, Acc: 0.795, Base Lr: 4.83e-03
2022-04-19 09:16:30,687 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-19 09:16:54,766 reid_baseline.train INFO: normal accuracy 0.7181705809641533 2.241992235183716 
2022-04-19 09:16:57,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 09:16:57,911 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 224.2%
2022-04-19 09:17:30,684 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.343, Acc: 0.824, Base Lr: 5.62e-03
2022-04-19 09:18:02,006 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.330, Acc: 0.827, Base Lr: 5.62e-03
2022-04-19 09:18:21,188 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.305[s] Speed: 52.5[samples/s]
2022-04-19 09:18:45,864 reid_baseline.train INFO: normal accuracy 0.7330037082818294 2.162339925765991 
2022-04-19 09:18:49,139 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 09:18:49,139 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 216.2%
2022-04-19 09:19:29,293 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.248, Acc: 0.855, Base Lr: 6.42e-03
2022-04-19 09:19:56,805 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.255, Acc: 0.854, Base Lr: 6.42e-03
2022-04-19 09:20:17,583 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.324[s] Speed: 49.4[samples/s]
2022-04-19 09:20:46,719 reid_baseline.train INFO: normal accuracy 0.7280593325092707 2.1172542572021484 
2022-04-19 09:20:49,989 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 09:20:49,989 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 211.7%
2022-04-19 09:21:21,298 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.216, Acc: 0.868, Base Lr: 7.21e-03
2022-04-19 09:21:50,112 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.208, Acc: 0.871, Base Lr: 7.21e-03
2022-04-19 09:22:10,589 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.295[s] Speed: 54.2[samples/s]
2022-04-19 09:22:39,970 reid_baseline.train INFO: normal accuracy 0.7371240214256284 2.0028460025787354 
2022-04-19 09:22:43,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 09:22:43,171 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 200.3%
2022-04-19 09:23:14,311 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.116, Acc: 0.892, Base Lr: 4.01e-03
2022-04-19 09:23:43,807 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.122, Acc: 0.892, Base Lr: 4.01e-03
2022-04-19 09:24:04,778 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-19 09:24:37,287 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.9428837299346924 
2022-04-19 09:24:41,132 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 09:24:41,132 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 194.3%
2022-04-19 09:25:14,079 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.094, Acc: 0.906, Base Lr: 3.38e-03
2022-04-19 09:25:38,064 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.105, Acc: 0.899, Base Lr: 3.38e-03
2022-04-19 09:25:55,562 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.273[s] Speed: 58.7[samples/s]
2022-04-19 09:26:16,772 reid_baseline.train INFO: normal accuracy 0.7342398022249691 1.969071865081787 
2022-04-19 09:26:16,774 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 09:26:16,774 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 196.9%
2022-04-19 09:26:46,349 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.911, Base Lr: 2.77e-03
2022-04-19 09:27:12,255 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.082, Acc: 0.907, Base Lr: 2.77e-03
2022-04-19 09:27:28,458 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.263[s] Speed: 60.9[samples/s]
2022-04-19 09:27:49,833 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.9835412502288818 
2022-04-19 09:27:49,835 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 09:27:49,835 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 198.4%
2022-04-19 09:28:19,456 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.070, Acc: 0.911, Base Lr: 2.20e-03
2022-04-19 09:28:44,956 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.059, Acc: 0.915, Base Lr: 2.20e-03
2022-04-19 09:29:01,348 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.262[s] Speed: 61.1[samples/s]
2022-04-19 09:29:22,562 reid_baseline.train INFO: normal accuracy 0.7428924598269468 1.8856890201568604 
2022-04-19 09:29:25,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 09:29:25,675 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 188.6%
2022-04-19 09:29:53,303 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.042, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 09:30:16,628 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.037, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 09:30:33,820 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.250[s] Speed: 64.1[samples/s]
2022-04-19 09:30:55,413 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9661486148834229 
2022-04-19 09:30:55,415 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 09:30:55,416 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 196.6%
2022-04-19 09:31:23,940 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.930, Base Lr: 1.19e-03
2022-04-19 09:31:48,206 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.029, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 09:32:05,104 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.255[s] Speed: 62.7[samples/s]
2022-04-19 09:32:28,420 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.8654810190200806 
2022-04-19 09:32:31,541 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 09:32:31,542 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 186.5%
2022-04-19 09:32:55,138 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.021, Acc: 0.921, Base Lr: 7.78e-04
2022-04-19 09:33:19,050 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.023, Acc: 0.925, Base Lr: 7.78e-04
2022-04-19 09:33:33,876 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.228[s] Speed: 70.1[samples/s]
2022-04-19 09:33:55,476 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8334358930587769 
2022-04-19 09:33:58,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 09:33:58,619 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 183.3%
2022-04-19 09:34:26,753 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.039, Acc: 0.917, Base Lr: 4.51e-04
2022-04-19 09:34:51,641 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.029, Acc: 0.924, Base Lr: 4.51e-04
2022-04-19 09:35:09,642 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.260[s] Speed: 61.5[samples/s]
2022-04-19 09:35:31,557 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.9052014350891113 
2022-04-19 09:35:31,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 09:35:31,557 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 190.5%
2022-04-19 09:36:00,275 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.017, Acc: 0.932, Base Lr: 2.11e-04
2022-04-19 09:36:26,465 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.025, Acc: 0.924, Base Lr: 2.11e-04
2022-04-19 09:36:45,750 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.272[s] Speed: 58.9[samples/s]
2022-04-19 09:37:06,755 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.8703356981277466 
2022-04-19 09:37:06,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 09:37:06,758 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 187.0%
2022-04-19 09:37:34,091 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.017, Acc: 0.933, Base Lr: 6.51e-05
2022-04-19 09:38:00,885 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.020, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 09:38:19,592 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.267[s] Speed: 60.0[samples/s]
2022-04-19 09:38:40,959 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.82142972946167 
2022-04-19 09:38:44,074 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 09:38:44,074 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 182.1%
2022-04-19 09:39:11,434 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.925, Base Lr: 1.60e-05
2022-04-19 09:39:35,412 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.011, Acc: 0.927, Base Lr: 1.60e-05
2022-04-19 09:39:53,909 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-19 09:40:18,948 reid_baseline.train INFO: normal accuracy 0.7466007416563659 1.8747581243515015 
2022-04-19 09:40:18,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 09:40:18,951 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 187.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_aug_key_3_20_10/transformer_best_model.pth
2022-04-19 09:40:44,278 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.82142972946167 
2022-04-19 09:40:44,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:40:44,278 reid_baseline.train INFO: Accuracy: 74.9%
2022-04-19 09:41:09,510 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.82142972946167 
2022-04-19 09:41:09,510 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:41:09,510 reid_baseline.train INFO: Shuffled Accuracy: 74.9%
2022-04-19 09:41:31,659 reid_baseline.train INFO: normal accuracy 0.9612829324169531 0.7650744915008545 
2022-04-19 09:41:31,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 09:41:31,659 reid_baseline.train INFO: Source Clean Accuracy: 96.1%
2022-04-19 09:41:35,349 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_3_20_10
2022-04-19 09:41:35,349 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_3_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-19 09:41:35,349 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 09:41:35,349 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 09:41:35,349 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_3_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 09:41:41,799 reid_baseline.train INFO: start training
2022-04-19 09:42:14,177 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.255, Base Lr: 8.72e-04
2022-04-19 09:42:40,011 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.367, Base Lr: 8.72e-04
2022-04-19 09:42:59,401 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.281[s] Speed: 56.9[samples/s]
2022-04-19 09:43:21,551 reid_baseline.train INFO: normal accuracy 0.5586843883757603 4.1658782958984375 
2022-04-19 09:43:24,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 09:43:24,675 reid_baseline.train INFO: Accuracy: 55.9% Mean Entropy: 416.6%
2022-04-19 09:43:51,776 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.644, Acc: 0.567, Base Lr: 1.66e-03
2022-04-19 09:44:17,737 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.486, Acc: 0.563, Base Lr: 1.66e-03
2022-04-19 09:44:36,845 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.264[s] Speed: 60.5[samples/s]
2022-04-19 09:44:59,462 reid_baseline.train INFO: normal accuracy 0.5974318540211759 3.9919216632843018 
2022-04-19 09:45:02,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 09:45:02,543 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 399.2%
2022-04-19 09:45:29,269 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.711, Acc: 0.591, Base Lr: 2.46e-03
2022-04-19 09:45:55,853 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.556, Acc: 0.608, Base Lr: 2.46e-03
2022-04-19 09:46:15,285 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.266[s] Speed: 60.0[samples/s]
2022-04-19 09:46:38,765 reid_baseline.train INFO: normal accuracy 0.6573552601937374 3.242731809616089 
2022-04-19 09:46:41,989 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 09:46:41,990 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 324.3%
2022-04-19 09:47:08,610 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.003, Acc: 0.688, Base Lr: 3.25e-03
2022-04-19 09:47:34,339 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.925, Acc: 0.706, Base Lr: 3.25e-03
2022-04-19 09:47:55,236 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.268[s] Speed: 59.6[samples/s]
2022-04-19 09:48:17,321 reid_baseline.train INFO: normal accuracy 0.7114214913268754 2.6482081413269043 
2022-04-19 09:48:20,573 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 09:48:20,574 reid_baseline.train INFO: Accuracy: 71.1% Mean Entropy: 264.8%
2022-04-19 09:48:45,861 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.671, Acc: 0.744, Base Lr: 4.04e-03
2022-04-19 09:49:12,560 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.624, Acc: 0.755, Base Lr: 4.04e-03
2022-04-19 09:49:32,155 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.262[s] Speed: 61.0[samples/s]
2022-04-19 09:49:56,931 reid_baseline.train INFO: normal accuracy 0.7321468799279117 2.245943784713745 
2022-04-19 09:50:00,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 09:50:00,060 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 224.6%
2022-04-19 09:50:27,471 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.425, Acc: 0.812, Base Lr: 4.83e-03
2022-04-19 09:50:53,744 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.448, Acc: 0.795, Base Lr: 4.83e-03
2022-04-19 09:51:12,341 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.265[s] Speed: 60.4[samples/s]
2022-04-19 09:51:34,329 reid_baseline.train INFO: normal accuracy 0.7357512953367875 2.021979808807373 
2022-04-19 09:51:37,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 09:51:37,508 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 202.2%
2022-04-19 09:52:04,299 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.343, Acc: 0.823, Base Lr: 5.62e-03
2022-04-19 09:52:30,948 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.330, Acc: 0.826, Base Lr: 5.62e-03
2022-04-19 09:52:50,031 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.266[s] Speed: 60.2[samples/s]
2022-04-19 09:53:11,992 reid_baseline.train INFO: normal accuracy 0.7506195088984006 1.9251621961593628 
2022-04-19 09:53:16,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 09:53:16,325 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 192.5%
2022-04-19 09:53:46,534 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.248, Acc: 0.858, Base Lr: 6.42e-03
2022-04-19 09:54:11,702 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.255, Acc: 0.856, Base Lr: 6.42e-03
2022-04-19 09:54:31,070 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.274[s] Speed: 58.4[samples/s]
2022-04-19 09:54:53,915 reid_baseline.train INFO: normal accuracy 0.7508447848614552 1.8618803024291992 
2022-04-19 09:54:57,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 09:54:57,056 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 186.2%
2022-04-19 09:55:24,795 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.216, Acc: 0.869, Base Lr: 7.21e-03
2022-04-19 09:55:51,630 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.209, Acc: 0.870, Base Lr: 7.21e-03
2022-04-19 09:56:11,147 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.271[s] Speed: 59.0[samples/s]
2022-04-19 09:56:33,810 reid_baseline.train INFO: normal accuracy 0.7571525118269881 1.8124147653579712 
2022-04-19 09:56:36,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 09:56:36,973 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 181.2%
2022-04-19 09:57:03,378 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.116, Acc: 0.891, Base Lr: 4.01e-03
2022-04-19 09:57:31,751 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.122, Acc: 0.891, Base Lr: 4.01e-03
2022-04-19 09:57:52,576 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.277[s] Speed: 57.8[samples/s]
2022-04-19 09:58:17,482 reid_baseline.train INFO: normal accuracy 0.7603063753097544 1.7935887575149536 
2022-04-19 09:58:20,599 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 09:58:20,600 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 179.4%
2022-04-19 09:58:46,471 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.095, Acc: 0.907, Base Lr: 3.38e-03
2022-04-19 09:59:13,276 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.106, Acc: 0.901, Base Lr: 3.38e-03
2022-04-19 09:59:33,043 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.265[s] Speed: 60.3[samples/s]
2022-04-19 09:59:55,645 reid_baseline.train INFO: normal accuracy 0.7666141022752873 1.8151657581329346 
2022-04-19 09:59:55,647 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 09:59:55,647 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 181.5%
2022-04-19 10:00:23,204 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.912, Base Lr: 2.77e-03
2022-04-19 10:00:51,256 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.082, Acc: 0.908, Base Lr: 2.77e-03
2022-04-19 10:01:10,575 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.274[s] Speed: 58.3[samples/s]
2022-04-19 10:01:33,355 reid_baseline.train INFO: normal accuracy 0.7661635503491777 1.7838783264160156 
2022-04-19 10:01:36,536 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 10:01:36,537 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 178.4%
2022-04-19 10:02:02,573 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.070, Acc: 0.912, Base Lr: 2.20e-03
2022-04-19 10:02:28,117 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.059, Acc: 0.915, Base Lr: 2.20e-03
2022-04-19 10:02:46,462 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.256[s] Speed: 62.5[samples/s]
2022-04-19 10:03:08,895 reid_baseline.train INFO: normal accuracy 0.7666141022752873 1.7277427911758423 
2022-04-19 10:03:11,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 10:03:11,981 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 172.8%
2022-04-19 10:03:39,467 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.042, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 10:04:05,531 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.037, Acc: 0.923, Base Lr: 1.66e-03
2022-04-19 10:04:25,108 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-04-19 10:04:47,593 reid_baseline.train INFO: normal accuracy 0.7639107907186303 1.79275381565094 
2022-04-19 10:04:47,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 10:04:47,594 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 179.3%
2022-04-19 10:05:15,702 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.929, Base Lr: 1.19e-03
2022-04-19 10:05:40,298 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.029, Acc: 0.926, Base Lr: 1.19e-03
2022-04-19 10:06:00,439 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.267[s] Speed: 60.0[samples/s]
2022-04-19 10:06:25,971 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.6994811296463013 
2022-04-19 10:06:29,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 10:06:29,098 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 169.9%
2022-04-19 10:06:51,137 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.021, Acc: 0.921, Base Lr: 7.78e-04
2022-04-19 10:07:16,010 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.023, Acc: 0.926, Base Lr: 7.78e-04
2022-04-19 10:07:35,271 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.242[s] Speed: 66.0[samples/s]
2022-04-19 10:07:57,255 reid_baseline.train INFO: normal accuracy 0.7657129984230683 1.6748262643814087 
2022-04-19 10:08:00,539 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 10:08:00,539 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 167.5%
2022-04-19 10:08:21,444 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.039, Acc: 0.917, Base Lr: 4.51e-04
2022-04-19 10:08:40,869 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.029, Acc: 0.924, Base Lr: 4.51e-04
2022-04-19 10:08:55,198 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.200[s] Speed: 79.9[samples/s]
2022-04-19 10:09:18,607 reid_baseline.train INFO: normal accuracy 0.7690921378688894 1.7580894231796265 
2022-04-19 10:09:18,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 10:09:18,607 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 175.8%
2022-04-19 10:09:48,872 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.017, Acc: 0.933, Base Lr: 2.11e-04
2022-04-19 10:10:16,830 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.025, Acc: 0.925, Base Lr: 2.11e-04
2022-04-19 10:10:36,640 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-19 10:11:02,564 reid_baseline.train INFO: normal accuracy 0.7697679657580536 1.703608512878418 
2022-04-19 10:11:02,565 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 10:11:02,565 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 170.4%
2022-04-19 10:11:23,884 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.017, Acc: 0.931, Base Lr: 6.51e-05
2022-04-19 10:11:44,416 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.020, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 10:11:58,117 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.203[s] Speed: 78.6[samples/s]
2022-04-19 10:12:23,773 reid_baseline.train INFO: normal accuracy 0.7677404820905609 1.6697204113006592 
2022-04-19 10:12:27,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 10:12:27,729 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 167.0%
2022-04-19 10:12:55,224 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.925, Base Lr: 1.60e-05
2022-04-19 10:13:18,140 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.011, Acc: 0.926, Base Lr: 1.60e-05
2022-04-19 10:13:32,896 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.239[s] Speed: 67.0[samples/s]
2022-04-19 10:14:00,787 reid_baseline.train INFO: normal accuracy 0.7704437936472178 1.7139102220535278 
2022-04-19 10:14:00,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 10:14:00,788 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 171.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_aug_key_3_20_10/transformer_best_model.pth
2022-04-19 10:14:28,543 reid_baseline.train INFO: normal accuracy 0.7677404820905609 1.6697204113006592 
2022-04-19 10:14:28,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 10:14:28,543 reid_baseline.train INFO: Accuracy: 76.8%
2022-04-19 10:14:52,902 reid_baseline.train INFO: normal accuracy 0.7677404820905609 1.6697204113006592 
2022-04-19 10:14:52,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 10:14:52,902 reid_baseline.train INFO: Shuffled Accuracy: 76.8%
2022-04-19 10:15:15,361 reid_baseline.train INFO: normal accuracy 0.9612829324169531 0.764980137348175 
2022-04-19 10:15:15,362 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 10:15:15,362 reid_baseline.train INFO: Source Clean Accuracy: 96.1%
2022-04-19 10:15:19,013 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_3_20_10
2022-04-19 10:15:19,013 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_3_20_10', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-19 10:15:19,013 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-19 10:15:19,014 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-19 10:15:19,014 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_3_20_10
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-19 10:15:25,091 reid_baseline.train INFO: start training
2022-04-19 10:15:52,841 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.120, Acc: 0.255, Base Lr: 8.72e-04
2022-04-19 10:16:12,452 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.054, Acc: 0.366, Base Lr: 8.72e-04
2022-04-19 10:16:27,078 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.224[s] Speed: 71.3[samples/s]
2022-04-19 10:17:51,501 reid_baseline.train INFO: normal accuracy 0.5680514115216893 4.16689395904541 
2022-04-19 10:17:54,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-19 10:17:54,630 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 416.7%
2022-04-19 10:18:18,721 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.644, Acc: 0.567, Base Lr: 1.66e-03
2022-04-19 10:18:39,891 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.486, Acc: 0.564, Base Lr: 1.66e-03
2022-04-19 10:18:54,395 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.219[s] Speed: 73.1[samples/s]
2022-04-19 10:20:19,475 reid_baseline.train INFO: normal accuracy 0.6086756942850585 4.014758110046387 
2022-04-19 10:20:22,702 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-19 10:20:22,702 reid_baseline.train INFO: Accuracy: 60.9% Mean Entropy: 401.5%
2022-04-19 10:20:44,182 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.711, Acc: 0.591, Base Lr: 2.46e-03
2022-04-19 10:21:04,210 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.556, Acc: 0.608, Base Lr: 2.46e-03
2022-04-19 10:21:19,392 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.208[s] Speed: 77.1[samples/s]
2022-04-19 10:22:41,391 reid_baseline.train INFO: normal accuracy 0.6821207252696809 3.297806978225708 
2022-04-19 10:22:44,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-19 10:22:44,476 reid_baseline.train INFO: Accuracy: 68.2% Mean Entropy: 329.8%
2022-04-19 10:23:05,424 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.003, Acc: 0.688, Base Lr: 3.25e-03
2022-04-19 10:23:25,158 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.925, Acc: 0.706, Base Lr: 3.25e-03
2022-04-19 10:23:40,077 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-19 10:25:03,200 reid_baseline.train INFO: normal accuracy 0.7369749827863209 2.720790147781372 
2022-04-19 10:25:06,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-19 10:25:06,280 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 272.1%
2022-04-19 10:25:27,257 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.672, Acc: 0.744, Base Lr: 4.04e-03
2022-04-19 10:25:47,419 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.624, Acc: 0.754, Base Lr: 4.04e-03
2022-04-19 10:26:01,884 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-19 10:27:28,583 reid_baseline.train INFO: normal accuracy 0.7638283222400735 2.308588743209839 
2022-04-19 10:27:31,683 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-19 10:27:31,684 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 230.9%
2022-04-19 10:27:52,168 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.425, Acc: 0.812, Base Lr: 4.83e-03
2022-04-19 10:28:11,412 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.448, Acc: 0.794, Base Lr: 4.83e-03
2022-04-19 10:28:25,755 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.198[s] Speed: 80.8[samples/s]
2022-04-19 10:29:48,108 reid_baseline.train INFO: normal accuracy 0.7736974982786321 2.039273738861084 
2022-04-19 10:29:51,185 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-19 10:29:51,186 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 203.9%
2022-04-19 10:30:11,774 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.343, Acc: 0.824, Base Lr: 5.62e-03
2022-04-19 10:30:32,507 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.330, Acc: 0.826, Base Lr: 5.62e-03
2022-04-19 10:30:47,316 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.206[s] Speed: 77.8[samples/s]
2022-04-19 10:32:11,684 reid_baseline.train INFO: normal accuracy 0.786550378700941 1.9597455263137817 
2022-04-19 10:32:14,778 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-19 10:32:14,779 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 196.0%
2022-04-19 10:32:35,343 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.248, Acc: 0.857, Base Lr: 6.42e-03
2022-04-19 10:32:54,561 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.256, Acc: 0.856, Base Lr: 6.42e-03
2022-04-19 10:33:09,782 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.201[s] Speed: 79.4[samples/s]
2022-04-19 10:34:31,760 reid_baseline.train INFO: normal accuracy 0.7831076428735368 1.9209246635437012 
2022-04-19 10:34:34,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-19 10:34:34,840 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 192.1%
2022-04-19 10:34:57,759 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.216, Acc: 0.866, Base Lr: 7.21e-03
2022-04-19 10:35:17,772 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.208, Acc: 0.870, Base Lr: 7.21e-03
2022-04-19 10:35:32,894 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.213[s] Speed: 75.2[samples/s]
2022-04-19 10:36:52,153 reid_baseline.train INFO: normal accuracy 0.7842552214826716 1.822750449180603 
2022-04-19 10:36:55,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-19 10:36:55,488 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 182.3%
2022-04-19 10:37:16,967 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.116, Acc: 0.891, Base Lr: 4.01e-03
2022-04-19 10:37:37,193 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.121, Acc: 0.892, Base Lr: 4.01e-03
2022-04-19 10:37:52,597 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.209[s] Speed: 76.5[samples/s]
2022-04-19 10:39:16,503 reid_baseline.train INFO: normal accuracy 0.7893045673628644 1.7828600406646729 
2022-04-19 10:39:19,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-19 10:39:19,577 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 178.3%
2022-04-19 10:39:39,835 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.094, Acc: 0.909, Base Lr: 3.38e-03
2022-04-19 10:40:00,641 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.105, Acc: 0.901, Base Lr: 3.38e-03
2022-04-19 10:40:15,177 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-19 10:41:37,578 reid_baseline.train INFO: normal accuracy 0.7840257057608446 1.818657636642456 
2022-04-19 10:41:37,579 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-19 10:41:37,579 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 181.9%
2022-04-19 10:41:58,752 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.912, Base Lr: 2.77e-03
2022-04-19 10:42:18,598 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.082, Acc: 0.909, Base Lr: 2.77e-03
2022-04-19 10:42:33,015 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.203[s] Speed: 78.8[samples/s]
2022-04-19 10:43:55,747 reid_baseline.train INFO: normal accuracy 0.7911406931374799 1.807532548904419 
2022-04-19 10:43:55,749 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-19 10:43:55,749 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 180.8%
2022-04-19 10:44:16,923 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.069, Acc: 0.911, Base Lr: 2.20e-03
2022-04-19 10:44:36,205 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.059, Acc: 0.914, Base Lr: 2.20e-03
2022-04-19 10:44:50,372 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.200[s] Speed: 80.0[samples/s]
2022-04-19 10:46:08,598 reid_baseline.train INFO: normal accuracy 0.7920587560247877 1.733734130859375 
2022-04-19 10:46:11,677 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-19 10:46:11,678 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 173.4%
2022-04-19 10:46:33,483 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.042, Acc: 0.921, Base Lr: 1.66e-03
2022-04-19 10:46:53,931 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.036, Acc: 0.922, Base Lr: 1.66e-03
2022-04-19 10:47:09,320 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.211[s] Speed: 75.8[samples/s]
2022-04-19 10:48:34,881 reid_baseline.train INFO: normal accuracy 0.7925177874684416 1.8090263605117798 
2022-04-19 10:48:34,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-19 10:48:34,883 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 180.9%
2022-04-19 10:48:55,201 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.023, Acc: 0.929, Base Lr: 1.19e-03
2022-04-19 10:49:16,539 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.029, Acc: 0.927, Base Lr: 1.19e-03
2022-04-19 10:49:31,178 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.206[s] Speed: 77.6[samples/s]
2022-04-19 10:50:55,006 reid_baseline.train INFO: normal accuracy 0.7936653660775763 1.708713412284851 
2022-04-19 10:50:58,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-19 10:50:58,112 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 170.9%
2022-04-19 10:51:19,645 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.021, Acc: 0.921, Base Lr: 7.78e-04
2022-04-19 10:51:38,741 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.023, Acc: 0.926, Base Lr: 7.78e-04
2022-04-19 10:51:54,142 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.205[s] Speed: 78.0[samples/s]
2022-04-19 10:53:19,167 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.6765964031219482 
2022-04-19 10:53:22,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-19 10:53:22,273 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 167.7%
2022-04-19 10:53:43,407 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.040, Acc: 0.917, Base Lr: 4.51e-04
2022-04-19 10:54:03,709 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.030, Acc: 0.924, Base Lr: 4.51e-04
2022-04-19 10:54:17,832 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.204[s] Speed: 78.6[samples/s]
2022-04-19 10:55:46,199 reid_baseline.train INFO: normal accuracy 0.7943539132430572 1.75931978225708 
2022-04-19 10:55:46,200 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-19 10:55:46,200 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 175.9%
2022-04-19 10:56:05,807 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.017, Acc: 0.930, Base Lr: 2.11e-04
2022-04-19 10:56:24,247 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.025, Acc: 0.923, Base Lr: 2.11e-04
2022-04-19 10:56:39,304 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.195[s] Speed: 82.3[samples/s]
2022-04-19 10:58:03,726 reid_baseline.train INFO: normal accuracy 0.7934358503557494 1.7166833877563477 
2022-04-19 10:58:03,726 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-19 10:58:03,726 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 171.7%
2022-04-19 10:58:20,277 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.017, Acc: 0.933, Base Lr: 6.51e-05
2022-04-19 10:58:36,510 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.020, Acc: 0.928, Base Lr: 6.51e-05
2022-04-19 10:58:48,526 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.164[s] Speed: 97.5[samples/s]
2022-04-19 10:59:57,939 reid_baseline.train INFO: normal accuracy 0.7932063346339224 1.6705509424209595 
2022-04-19 11:00:01,030 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-19 11:00:01,030 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 167.1%
2022-04-19 11:00:18,043 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.016, Acc: 0.926, Base Lr: 1.60e-05
2022-04-19 11:00:33,834 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.011, Acc: 0.928, Base Lr: 1.60e-05
2022-04-19 11:00:45,730 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.164[s] Speed: 97.7[samples/s]
2022-04-19 11:02:00,003 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.7227973937988281 
2022-04-19 11:02:00,003 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-19 11:02:00,003 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 172.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_aug_key_3_20_10/transformer_best_model.pth
2022-04-19 11:03:15,724 reid_baseline.train INFO: normal accuracy 0.7932063346339224 1.6705509424209595 
2022-04-19 11:03:15,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 11:03:15,724 reid_baseline.train INFO: Accuracy: 79.3%
2022-04-19 11:04:27,734 reid_baseline.train INFO: normal accuracy 0.7932063346339224 1.6705509424209595 
2022-04-19 11:04:27,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 11:04:27,734 reid_baseline.train INFO: Shuffled Accuracy: 79.3%
2022-04-19 11:04:47,337 reid_baseline.train INFO: normal accuracy 0.961512027491409 0.764687180519104 
2022-04-19 11:04:47,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-19 11:04:47,337 reid_baseline.train INFO: Source Clean Accuracy: 96.2%
