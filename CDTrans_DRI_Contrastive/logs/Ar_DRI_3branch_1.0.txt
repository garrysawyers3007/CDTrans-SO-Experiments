2022-05-08 22:14:52,048 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0
2022-05-08 22:14:52,048 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=1.0)
2022-05-08 22:14:52,048 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-08 22:14:52,049 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-08 22:14:52,049 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Clipart.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-08 22:15:03,198 reid_baseline.train INFO: start training
2022-05-08 22:16:02,173 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.293, Loss2: 4.160, Loss3: 4.174,  Acc: 0.472, Acc2: 0.091, Acc2_pse: 0.091, Base Lr: 8.72e-04
2022-05-08 22:16:27,068 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.565[s] Speed: 28.3[samples/s]
2022-05-08 22:17:59,052 reid_baseline.train INFO: normal accuracy 0.2849942726231386 4.173048973083496 
2022-05-08 22:18:24,260 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-08 22:18:24,261 reid_baseline.train INFO: Accuracy: 28.5%, best Accuracy: 28.5%, min Mean_entropy: 4e+00
2022-05-08 22:19:24,513 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 0.651, Loss2: 4.074, Loss3: 4.173,  Acc: 0.809, Acc2: 0.378, Acc2_pse: 0.378, Base Lr: 1.66e-03
2022-05-08 22:19:50,471 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-05-08 22:21:26,819 reid_baseline.train INFO: normal accuracy 0.33814432989690724 4.169178485870361 
2022-05-08 22:21:30,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-08 22:21:30,403 reid_baseline.train INFO: Accuracy: 33.8%, best Accuracy: 33.8%, min Mean_entropy: 4e+00
2022-05-08 22:22:32,240 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.313, Loss2: 3.906, Loss3: 4.168,  Acc: 0.933, Acc2: 0.417, Acc2_pse: 0.417, Base Lr: 2.46e-03
2022-05-08 22:22:59,247 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.613[s] Speed: 26.1[samples/s]
2022-05-08 22:24:34,224 reid_baseline.train INFO: normal accuracy 0.395418098510882 4.147607803344727 
2022-05-08 22:24:38,219 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-08 22:24:38,219 reid_baseline.train INFO: Accuracy: 39.5%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:25:38,584 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.205, Loss2: 3.559, Loss3: 4.118,  Acc: 0.952, Acc2: 0.427, Acc2_pse: 0.427, Base Lr: 3.25e-03
2022-05-08 22:26:05,772 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.604[s] Speed: 26.5[samples/s]
2022-05-08 22:27:40,909 reid_baseline.train INFO: normal accuracy 0.32943871706758304 3.943296432495117 
2022-05-08 22:27:40,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-08 22:27:40,910 reid_baseline.train INFO: Accuracy: 32.9%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:28:37,635 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.190, Loss2: 3.093, Loss3: 3.708,  Acc: 0.961, Acc2: 0.389, Acc2_pse: 0.389, Base Lr: 4.04e-03
2022-05-08 22:29:03,990 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.569[s] Speed: 28.1[samples/s]
2022-05-08 22:30:40,728 reid_baseline.train INFO: normal accuracy 0.31752577319587627 2.944291591644287 
2022-05-08 22:30:40,728 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-08 22:30:40,728 reid_baseline.train INFO: Accuracy: 31.8%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:31:38,156 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.182, Loss2: 2.941, Loss3: 2.798,  Acc: 0.966, Acc2: 0.341, Acc2_pse: 0.341, Base Lr: 4.83e-03
2022-05-08 22:32:01,652 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.570[s] Speed: 28.1[samples/s]
2022-05-08 22:33:38,047 reid_baseline.train INFO: normal accuracy 0.3042382588774341 2.1883351802825928 
2022-05-08 22:33:38,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-08 22:33:38,047 reid_baseline.train INFO: Accuracy: 30.4%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:34:35,002 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.173, Loss2: 2.866, Loss3: 2.159,  Acc: 0.962, Acc2: 0.369, Acc2_pse: 0.369, Base Lr: 5.62e-03
2022-05-08 22:34:59,706 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.571[s] Speed: 28.0[samples/s]
2022-05-08 22:36:38,403 reid_baseline.train INFO: normal accuracy 0.33608247422680415 1.9455313682556152 
2022-05-08 22:36:38,403 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-08 22:36:38,403 reid_baseline.train INFO: Accuracy: 33.6%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:37:37,358 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.178, Loss2: 2.666, Loss3: 1.750,  Acc: 0.959, Acc2: 0.426, Acc2_pse: 0.426, Base Lr: 6.42e-03
2022-05-08 22:38:03,394 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-05-08 22:39:41,479 reid_baseline.train INFO: normal accuracy 0.3541809851088202 1.711219072341919 
2022-05-08 22:39:41,479 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-08 22:39:41,479 reid_baseline.train INFO: Accuracy: 35.4%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:40:43,805 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.137, Loss2: 2.541, Loss3: 1.553,  Acc: 0.977, Acc2: 0.431, Acc2_pse: 0.431, Base Lr: 7.21e-03
2022-05-08 22:41:08,250 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-05-08 22:42:47,471 reid_baseline.train INFO: normal accuracy 0.38510882016036657 1.4758869409561157 
2022-05-08 22:42:47,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-08 22:42:47,471 reid_baseline.train INFO: Accuracy: 38.5%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:43:47,877 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.151, Loss2: 2.417, Loss3: 1.296,  Acc: 0.971, Acc2: 0.491, Acc2_pse: 0.491, Base Lr: 6.83e-03
2022-05-08 22:44:13,232 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.600[s] Speed: 26.7[samples/s]
2022-05-08 22:45:48,496 reid_baseline.train INFO: normal accuracy 0.37800687285223367 1.2536979913711548 
2022-05-08 22:45:48,496 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-08 22:45:48,497 reid_baseline.train INFO: Accuracy: 37.8%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:46:47,798 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.139, Loss2: 2.347, Loss3: 1.222,  Acc: 0.972, Acc2: 0.507, Acc2_pse: 0.507, Base Lr: 6.60e-03
2022-05-08 22:47:14,038 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-05-08 22:48:47,364 reid_baseline.train INFO: normal accuracy 0.3935853379152348 1.2230836153030396 
2022-05-08 22:48:47,364 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-08 22:48:47,364 reid_baseline.train INFO: Accuracy: 39.4%, best Accuracy: 39.5%, min Mean_entropy: 4e+00
2022-05-08 22:49:44,547 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.138, Loss2: 2.210, Loss3: 1.134,  Acc: 0.974, Acc2: 0.533, Acc2_pse: 0.533, Base Lr: 6.35e-03
2022-05-08 22:50:14,306 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.604[s] Speed: 26.5[samples/s]
2022-05-08 22:51:49,753 reid_baseline.train INFO: normal accuracy 0.41993127147766324 1.2266374826431274 
2022-05-08 22:51:53,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-08 22:51:53,214 reid_baseline.train INFO: Accuracy: 42.0%, best Accuracy: 42.0%, min Mean_entropy: 1e+00
2022-05-08 22:52:50,580 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.133, Loss2: 2.134, Loss3: 1.061,  Acc: 0.979, Acc2: 0.538, Acc2_pse: 0.538, Base Lr: 6.09e-03
2022-05-08 22:53:15,046 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.568[s] Speed: 28.2[samples/s]
2022-05-08 22:54:52,896 reid_baseline.train INFO: normal accuracy 0.4327605956471936 1.1870487928390503 
2022-05-08 22:54:57,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-08 22:54:57,737 reid_baseline.train INFO: Accuracy: 43.3%, best Accuracy: 43.3%, min Mean_entropy: 1e+00
2022-05-08 22:55:55,937 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.126, Loss2: 2.014, Loss3: 1.034,  Acc: 0.979, Acc2: 0.575, Acc2_pse: 0.575, Base Lr: 5.82e-03
2022-05-08 22:56:19,332 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.567[s] Speed: 28.2[samples/s]
2022-05-08 22:57:55,642 reid_baseline.train INFO: normal accuracy 0.44879725085910654 1.0932974815368652 
2022-05-08 22:57:58,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-08 22:57:58,883 reid_baseline.train INFO: Accuracy: 44.9%, best Accuracy: 44.9%, min Mean_entropy: 1e+00
2022-05-08 22:58:56,202 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.138, Loss2: 2.013, Loss3: 1.018,  Acc: 0.973, Acc2: 0.584, Acc2_pse: 0.584, Base Lr: 5.54e-03
2022-05-08 22:59:20,924 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.574[s] Speed: 27.9[samples/s]
2022-05-08 23:00:54,552 reid_baseline.train INFO: normal accuracy 0.43963344788087055 0.9384346604347229 
2022-05-08 23:00:54,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-08 23:00:54,553 reid_baseline.train INFO: Accuracy: 44.0%, best Accuracy: 44.9%, min Mean_entropy: 1e+00
2022-05-08 23:01:54,929 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.129, Loss2: 1.939, Loss3: 0.970,  Acc: 0.982, Acc2: 0.604, Acc2_pse: 0.604, Base Lr: 5.24e-03
2022-05-08 23:02:19,818 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-05-08 23:03:53,270 reid_baseline.train INFO: normal accuracy 0.4813287514318442 1.0526496171951294 
2022-05-08 23:03:56,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-08 23:03:56,606 reid_baseline.train INFO: Accuracy: 48.1%, best Accuracy: 48.1%, min Mean_entropy: 1e+00
2022-05-08 23:04:56,884 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.120, Loss2: 1.917, Loss3: 0.961,  Acc: 0.978, Acc2: 0.607, Acc2_pse: 0.607, Base Lr: 4.94e-03
2022-05-08 23:05:23,374 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.598[s] Speed: 26.7[samples/s]
2022-05-08 23:06:57,107 reid_baseline.train INFO: normal accuracy 0.4639175257731959 0.9155603051185608 
2022-05-08 23:06:57,107 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-08 23:06:57,107 reid_baseline.train INFO: Accuracy: 46.4%, best Accuracy: 48.1%, min Mean_entropy: 1e+00
2022-05-08 23:07:59,972 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.126, Loss2: 1.833, Loss3: 0.912,  Acc: 0.973, Acc2: 0.625, Acc2_pse: 0.625, Base Lr: 4.63e-03
2022-05-08 23:08:26,325 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.611[s] Speed: 26.2[samples/s]
2022-05-08 23:10:00,508 reid_baseline.train INFO: normal accuracy 0.4966781214203895 0.9829477667808533 
2022-05-08 23:10:04,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-08 23:10:04,038 reid_baseline.train INFO: Accuracy: 49.7%, best Accuracy: 49.7%, min Mean_entropy: 1e+00
2022-05-08 23:11:02,585 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.117, Loss2: 1.829, Loss3: 0.916,  Acc: 0.984, Acc2: 0.621, Acc2_pse: 0.621, Base Lr: 4.32e-03
2022-05-08 23:11:30,792 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.607[s] Speed: 26.4[samples/s]
2022-05-08 23:13:05,790 reid_baseline.train INFO: normal accuracy 0.46827033218785796 0.858633816242218 
2022-05-08 23:13:05,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-08 23:13:05,790 reid_baseline.train INFO: Accuracy: 46.8%, best Accuracy: 49.7%, min Mean_entropy: 1e+00
2022-05-08 23:14:02,725 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.116, Loss2: 1.754, Loss3: 0.870,  Acc: 0.985, Acc2: 0.637, Acc2_pse: 0.637, Base Lr: 4.01e-03
2022-05-08 23:14:28,913 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.581[s] Speed: 27.5[samples/s]
2022-05-08 23:16:05,232 reid_baseline.train INFO: normal accuracy 0.49851088201603666 0.9215632677078247 
2022-05-08 23:16:08,457 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-08 23:16:08,457 reid_baseline.train INFO: Accuracy: 49.9%, best Accuracy: 49.9%, min Mean_entropy: 0.9
2022-05-08 23:17:05,752 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.113, Loss2: 1.793, Loss3: 0.902,  Acc: 0.988, Acc2: 0.638, Acc2_pse: 0.638, Base Lr: 3.69e-03
2022-05-08 23:17:31,552 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.569[s] Speed: 28.1[samples/s]
2022-05-08 23:19:09,476 reid_baseline.train INFO: normal accuracy 0.4865979381443299 0.8823726773262024 
2022-05-08 23:19:09,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-08 23:19:09,477 reid_baseline.train INFO: Accuracy: 48.7%, best Accuracy: 49.9%, min Mean_entropy: 0.9
2022-05-08 23:20:07,599 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.114, Loss2: 1.724, Loss3: 0.858,  Acc: 0.980, Acc2: 0.656, Acc2_pse: 0.656, Base Lr: 3.38e-03
2022-05-08 23:20:31,793 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.572[s] Speed: 28.0[samples/s]
2022-05-08 23:22:07,363 reid_baseline.train INFO: normal accuracy 0.4966781214203895 0.8297491669654846 
2022-05-08 23:22:07,363 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-08 23:22:07,363 reid_baseline.train INFO: Accuracy: 49.7%, best Accuracy: 49.9%, min Mean_entropy: 0.9
2022-05-08 23:23:09,180 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.116, Loss2: 1.678, Loss3: 0.827,  Acc: 0.982, Acc2: 0.688, Acc2_pse: 0.688, Base Lr: 3.08e-03
2022-05-08 23:23:32,181 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-05-08 23:25:05,156 reid_baseline.train INFO: normal accuracy 0.5168384879725086 0.8564696907997131 
2022-05-08 23:25:08,425 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-08 23:25:08,425 reid_baseline.train INFO: Accuracy: 51.7%, best Accuracy: 51.7%, min Mean_entropy: 0.9
2022-05-08 23:26:07,766 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.108, Loss2: 1.665, Loss3: 0.856,  Acc: 0.988, Acc2: 0.684, Acc2_pse: 0.684, Base Lr: 2.77e-03
2022-05-08 23:26:33,041 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-05-08 23:28:09,038 reid_baseline.train INFO: normal accuracy 0.4859106529209622 0.7918372750282288 
2022-05-08 23:28:09,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-08 23:28:09,038 reid_baseline.train INFO: Accuracy: 48.6%, best Accuracy: 51.7%, min Mean_entropy: 0.9
2022-05-08 23:29:09,724 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.110, Loss2: 1.655, Loss3: 0.876,  Acc: 0.985, Acc2: 0.682, Acc2_pse: 0.682, Base Lr: 2.48e-03
2022-05-08 23:29:35,094 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-05-08 23:31:09,884 reid_baseline.train INFO: normal accuracy 0.49003436426116836 0.7548441290855408 
2022-05-08 23:31:09,885 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-08 23:31:09,885 reid_baseline.train INFO: Accuracy: 49.0%, best Accuracy: 51.7%, min Mean_entropy: 0.9
2022-05-08 23:32:09,297 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.112, Loss2: 1.615, Loss3: 0.847,  Acc: 0.983, Acc2: 0.687, Acc2_pse: 0.687, Base Lr: 2.20e-03
2022-05-08 23:32:33,881 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-05-08 23:34:06,672 reid_baseline.train INFO: normal accuracy 0.5232531500572738 0.8448848724365234 
2022-05-08 23:34:10,073 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-08 23:34:10,073 reid_baseline.train INFO: Accuracy: 52.3%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:35:06,991 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.112, Loss2: 1.611, Loss3: 0.805,  Acc: 0.985, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 1.92e-03
2022-05-08 23:35:34,164 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-05-08 23:37:08,228 reid_baseline.train INFO: normal accuracy 0.5083619702176403 0.8374450206756592 
2022-05-08 23:37:08,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-08 23:37:08,228 reid_baseline.train INFO: Accuracy: 50.8%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:38:05,946 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.118, Loss2: 1.560, Loss3: 0.849,  Acc: 0.982, Acc2: 0.709, Acc2_pse: 0.709, Base Lr: 1.66e-03
2022-05-08 23:38:30,324 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.574[s] Speed: 27.9[samples/s]
2022-05-08 23:40:09,356 reid_baseline.train INFO: normal accuracy 0.4925544100801833 0.7569645643234253 
2022-05-08 23:40:09,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-08 23:40:09,356 reid_baseline.train INFO: Accuracy: 49.3%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:41:06,909 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.113, Loss2: 1.584, Loss3: 0.769,  Acc: 0.983, Acc2: 0.708, Acc2_pse: 0.708, Base Lr: 1.42e-03
2022-05-08 23:41:31,777 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.576[s] Speed: 27.8[samples/s]
2022-05-08 23:43:04,233 reid_baseline.train INFO: normal accuracy 0.5163802978235968 0.7828876972198486 
2022-05-08 23:43:04,234 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-08 23:43:04,234 reid_baseline.train INFO: Accuracy: 51.6%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:44:02,784 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.109, Loss2: 1.594, Loss3: 0.804,  Acc: 0.984, Acc2: 0.693, Acc2_pse: 0.693, Base Lr: 1.19e-03
2022-05-08 23:44:27,583 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.575[s] Speed: 27.8[samples/s]
2022-05-08 23:46:05,952 reid_baseline.train INFO: normal accuracy 0.5097365406643757 0.8300039768218994 
2022-05-08 23:46:05,952 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-08 23:46:05,953 reid_baseline.train INFO: Accuracy: 51.0%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:47:06,696 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.103, Loss2: 1.567, Loss3: 0.806,  Acc: 0.987, Acc2: 0.699, Acc2_pse: 0.699, Base Lr: 9.72e-04
2022-05-08 23:47:31,459 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-05-08 23:49:02,333 reid_baseline.train INFO: normal accuracy 0.49919816723940436 0.7390409111976624 
2022-05-08 23:49:02,333 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-08 23:49:02,333 reid_baseline.train INFO: Accuracy: 49.9%, best Accuracy: 52.3%, min Mean_entropy: 0.8
2022-05-08 23:50:01,344 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.106, Loss2: 1.562, Loss3: 0.771,  Acc: 0.988, Acc2: 0.703, Acc2_pse: 0.703, Base Lr: 7.78e-04
2022-05-08 23:50:27,843 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-05-08 23:51:57,240 reid_baseline.train INFO: normal accuracy 0.5266895761741123 0.804663896560669 
2022-05-08 23:52:00,353 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-08 23:52:00,354 reid_baseline.train INFO: Accuracy: 52.7%, best Accuracy: 52.7%, min Mean_entropy: 0.8
2022-05-08 23:52:57,937 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.102, Loss2: 1.595, Loss3: 0.800,  Acc: 0.990, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 6.04e-04
2022-05-08 23:53:21,555 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.568[s] Speed: 28.2[samples/s]
2022-05-08 23:54:52,576 reid_baseline.train INFO: normal accuracy 0.5454753722794959 0.8531389236450195 
2022-05-08 23:54:55,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-08 23:54:55,766 reid_baseline.train INFO: Accuracy: 54.5%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-08 23:55:51,175 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.106, Loss2: 1.556, Loss3: 0.769,  Acc: 0.986, Acc2: 0.718, Acc2_pse: 0.718, Base Lr: 4.51e-04
2022-05-08 23:56:15,351 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.556[s] Speed: 28.8[samples/s]
2022-05-08 23:57:47,174 reid_baseline.train INFO: normal accuracy 0.5120274914089347 0.7880375385284424 
2022-05-08 23:57:47,174 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-08 23:57:47,174 reid_baseline.train INFO: Accuracy: 51.2%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-08 23:58:43,428 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.106, Loss2: 1.550, Loss3: 0.769,  Acc: 0.989, Acc2: 0.713, Acc2_pse: 0.713, Base Lr: 3.20e-04
2022-05-08 23:59:06,953 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.554[s] Speed: 28.9[samples/s]
2022-05-09 00:00:40,149 reid_baseline.train INFO: normal accuracy 0.5308132875143184 0.80949866771698 
2022-05-09 00:00:40,150 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 00:00:40,150 reid_baseline.train INFO: Accuracy: 53.1%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-09 00:01:38,515 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.110, Loss2: 1.552, Loss3: 0.769,  Acc: 0.991, Acc2: 0.715, Acc2_pse: 0.715, Base Lr: 2.11e-04
2022-05-09 00:01:59,835 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.565[s] Speed: 28.3[samples/s]
2022-05-09 00:03:33,581 reid_baseline.train INFO: normal accuracy 0.5260022909507446 0.8209050297737122 
2022-05-09 00:03:33,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 00:03:33,581 reid_baseline.train INFO: Accuracy: 52.6%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-09 00:04:32,754 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.105, Loss2: 1.591, Loss3: 0.821,  Acc: 0.990, Acc2: 0.704, Acc2_pse: 0.704, Base Lr: 1.26e-04
2022-05-09 00:04:56,546 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-05-09 00:06:25,796 reid_baseline.train INFO: normal accuracy 0.5166093928980527 0.7597362995147705 
2022-05-09 00:06:25,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 00:06:25,797 reid_baseline.train INFO: Accuracy: 51.7%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-09 00:07:27,496 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.104, Loss2: 1.516, Loss3: 0.742,  Acc: 0.984, Acc2: 0.736, Acc2_pse: 0.736, Base Lr: 6.51e-05
2022-05-09 00:07:53,906 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.608[s] Speed: 26.3[samples/s]
2022-05-09 00:09:22,932 reid_baseline.train INFO: normal accuracy 0.5101947308132875 0.8024249076843262 
2022-05-09 00:09:22,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 00:09:22,933 reid_baseline.train INFO: Accuracy: 51.0%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-09 00:10:21,228 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.101, Loss2: 1.550, Loss3: 0.782,  Acc: 0.989, Acc2: 0.712, Acc2_pse: 0.712, Base Lr: 2.83e-05
2022-05-09 00:10:47,494 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.583[s] Speed: 27.4[samples/s]
2022-05-09 00:12:16,237 reid_baseline.train INFO: normal accuracy 0.5035509736540664 0.7543056011199951 
2022-05-09 00:12:16,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 00:12:16,237 reid_baseline.train INFO: Accuracy: 50.4%, best Accuracy: 54.5%, min Mean_entropy: 0.9
2022-05-09 00:13:10,921 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.098, Loss2: 1.519, Loss3: 0.789,  Acc: 0.989, Acc2: 0.726, Acc2_pse: 0.726, Base Lr: 1.60e-05
2022-05-09 00:13:35,708 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.548[s] Speed: 29.2[samples/s]
2022-05-09 00:15:06,236 reid_baseline.train INFO: normal accuracy 0.5058419243986254 0.7319362759590149 
2022-05-09 00:15:06,236 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 00:15:06,236 reid_baseline.train INFO: Accuracy: 50.6%, best Accuracy: 54.5%, min Mean_entropy: 0.9
best model preformance is 0.5454753722794959
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ClipartDRI_1.0/transformer_best_model.pth
2022-05-09 00:16:37,675 reid_baseline.train INFO: normal accuracy 0.5454753722794959 0.8531389236450195 
2022-05-09 00:16:37,676 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 00:16:37,676 reid_baseline.train INFO: Accuracy: 54.5%
2022-05-09 00:18:03,838 reid_baseline.train INFO: normal accuracy 0.8978162340337865 0.2770031690597534 
2022-05-09 00:18:03,838 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 00:18:03,839 reid_baseline.train INFO: Accuracy: 89.8%
2022-05-09 00:18:09,491 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2ProductDRI_1.0
2022-05-09 00:18:09,491 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2ProductDRI_1.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=1.0)
2022-05-09 00:18:09,491 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 00:18:09,491 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 00:18:09,492 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Product.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2ProductDRI_1.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Product and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 00:18:14,679 reid_baseline.train INFO: start training
2022-05-09 00:19:09,773 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.293, Loss2: 4.160, Loss3: 4.174,  Acc: 0.472, Acc2: 0.091, Acc2_pse: 0.091, Base Lr: 8.72e-04
2022-05-09 00:19:35,062 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 00:21:12,728 reid_baseline.train INFO: normal accuracy 0.353683261995945 4.173141002655029 
2022-05-09 00:21:15,741 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 00:21:15,741 reid_baseline.train INFO: Accuracy: 35.4%, best Accuracy: 35.4%, min Mean_entropy: 4e+00
2022-05-09 00:22:12,508 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 0.651, Loss2: 4.074, Loss3: 4.173,  Acc: 0.809, Acc2: 0.378, Acc2_pse: 0.378, Base Lr: 1.66e-03
2022-05-09 00:22:37,590 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.564[s] Speed: 28.3[samples/s]
2022-05-09 00:24:13,182 reid_baseline.train INFO: normal accuracy 0.4622662761883307 4.169829845428467 
2022-05-09 00:24:16,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 00:24:16,309 reid_baseline.train INFO: Accuracy: 46.2%, best Accuracy: 46.2%, min Mean_entropy: 4e+00
2022-05-09 00:25:12,891 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.313, Loss2: 3.906, Loss3: 4.168,  Acc: 0.933, Acc2: 0.417, Acc2_pse: 0.417, Base Lr: 2.46e-03
2022-05-09 00:25:36,263 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.551[s] Speed: 29.0[samples/s]
2022-05-09 00:27:10,059 reid_baseline.train INFO: normal accuracy 0.5025906735751295 4.144713878631592 
2022-05-09 00:27:13,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 00:27:13,138 reid_baseline.train INFO: Accuracy: 50.3%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:28:12,647 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.205, Loss2: 3.559, Loss3: 4.118,  Acc: 0.952, Acc2: 0.427, Acc2_pse: 0.427, Base Lr: 3.25e-03
2022-05-09 00:28:35,303 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.567[s] Speed: 28.2[samples/s]
2022-05-09 00:30:12,091 reid_baseline.train INFO: normal accuracy 0.426222122099572 3.939332962036133 
2022-05-09 00:30:12,091 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 00:30:12,091 reid_baseline.train INFO: Accuracy: 42.6%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:31:11,291 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.190, Loss2: 3.093, Loss3: 3.708,  Acc: 0.961, Acc2: 0.390, Acc2_pse: 0.390, Base Lr: 4.04e-03
2022-05-09 00:31:38,269 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.590[s] Speed: 27.1[samples/s]
2022-05-09 00:33:07,979 reid_baseline.train INFO: normal accuracy 0.3662987159270106 2.9396748542785645 
2022-05-09 00:33:07,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 00:33:07,979 reid_baseline.train INFO: Accuracy: 36.6%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:34:07,491 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.182, Loss2: 2.941, Loss3: 2.798,  Acc: 0.965, Acc2: 0.342, Acc2_pse: 0.342, Base Lr: 4.83e-03
2022-05-09 00:34:31,588 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.589[s] Speed: 27.2[samples/s]
2022-05-09 00:36:08,354 reid_baseline.train INFO: normal accuracy 0.3584140572200946 2.247896194458008 
2022-05-09 00:36:08,354 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 00:36:08,355 reid_baseline.train INFO: Accuracy: 35.8%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:37:03,424 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.173, Loss2: 2.866, Loss3: 2.159,  Acc: 0.962, Acc2: 0.366, Acc2_pse: 0.366, Base Lr: 5.62e-03
2022-05-09 00:37:27,728 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.555[s] Speed: 28.8[samples/s]
2022-05-09 00:39:00,638 reid_baseline.train INFO: normal accuracy 0.3955845911241271 1.9373761415481567 
2022-05-09 00:39:00,638 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 00:39:00,638 reid_baseline.train INFO: Accuracy: 39.6%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:39:58,477 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.178, Loss2: 2.667, Loss3: 1.750,  Acc: 0.959, Acc2: 0.427, Acc2_pse: 0.427, Base Lr: 6.42e-03
2022-05-09 00:40:23,824 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-05-09 00:41:58,404 reid_baseline.train INFO: normal accuracy 0.44424419914395136 1.7354023456573486 
2022-05-09 00:41:58,404 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 00:41:58,404 reid_baseline.train INFO: Accuracy: 44.4%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:42:54,655 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.138, Loss2: 2.541, Loss3: 1.552,  Acc: 0.977, Acc2: 0.436, Acc2_pse: 0.436, Base Lr: 7.21e-03
2022-05-09 00:43:47,939 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.750[s] Speed: 21.3[samples/s]
2022-05-09 00:45:24,891 reid_baseline.train INFO: normal accuracy 0.45167830592475783 1.3906903266906738 
2022-05-09 00:45:24,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 00:45:24,891 reid_baseline.train INFO: Accuracy: 45.2%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:46:21,945 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.150, Loss2: 2.419, Loss3: 1.298,  Acc: 0.971, Acc2: 0.493, Acc2_pse: 0.493, Base Lr: 6.83e-03
2022-05-09 00:46:45,336 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.562[s] Speed: 28.4[samples/s]
2022-05-09 00:48:24,076 reid_baseline.train INFO: normal accuracy 0.46587069159720657 1.172985553741455 
2022-05-09 00:48:24,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 00:48:24,076 reid_baseline.train INFO: Accuracy: 46.6%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:49:23,098 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.138, Loss2: 2.346, Loss3: 1.223,  Acc: 0.972, Acc2: 0.507, Acc2_pse: 0.507, Base Lr: 6.60e-03
2022-05-09 00:49:46,644 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.569[s] Speed: 28.1[samples/s]
2022-05-09 00:51:17,341 reid_baseline.train INFO: normal accuracy 0.4879477359765713 1.1848371028900146 
2022-05-09 00:51:17,341 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 00:51:17,341 reid_baseline.train INFO: Accuracy: 48.8%, best Accuracy: 50.3%, min Mean_entropy: 4e+00
2022-05-09 00:52:17,950 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.140, Loss2: 2.212, Loss3: 1.129,  Acc: 0.973, Acc2: 0.532, Acc2_pse: 0.532, Base Lr: 6.35e-03
2022-05-09 00:52:43,026 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.595[s] Speed: 26.9[samples/s]
2022-05-09 00:54:16,543 reid_baseline.train INFO: normal accuracy 0.5226402342870016 1.157098412513733 
2022-05-09 00:54:19,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 00:54:19,629 reid_baseline.train INFO: Accuracy: 52.3%, best Accuracy: 52.3%, min Mean_entropy: 1e+00
2022-05-09 00:55:16,258 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.133, Loss2: 2.132, Loss3: 1.053,  Acc: 0.977, Acc2: 0.545, Acc2_pse: 0.545, Base Lr: 6.09e-03
2022-05-09 00:55:41,954 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.572[s] Speed: 28.0[samples/s]
2022-05-09 00:57:17,784 reid_baseline.train INFO: normal accuracy 0.5296237891416986 1.0457382202148438 
2022-05-09 00:57:20,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 00:57:20,859 reid_baseline.train INFO: Accuracy: 53.0%, best Accuracy: 53.0%, min Mean_entropy: 1e+00
2022-05-09 00:58:16,937 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.124, Loss2: 2.017, Loss3: 1.019,  Acc: 0.979, Acc2: 0.571, Acc2_pse: 0.571, Base Lr: 5.82e-03
2022-05-09 00:58:40,244 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.551[s] Speed: 29.0[samples/s]
2022-05-09 01:00:19,327 reid_baseline.train INFO: normal accuracy 0.5512502815949538 0.9894025325775146 
2022-05-09 01:00:22,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 01:00:22,443 reid_baseline.train INFO: Accuracy: 55.1%, best Accuracy: 55.1%, min Mean_entropy: 1e+00
2022-05-09 01:01:17,416 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.135, Loss2: 2.013, Loss3: 1.018,  Acc: 0.973, Acc2: 0.586, Acc2_pse: 0.586, Base Lr: 5.54e-03
2022-05-09 01:01:42,120 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.557[s] Speed: 28.7[samples/s]
2022-05-09 01:03:17,114 reid_baseline.train INFO: normal accuracy 0.5395359315161072 0.8995075225830078 
2022-05-09 01:03:17,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 01:03:17,115 reid_baseline.train INFO: Accuracy: 54.0%, best Accuracy: 55.1%, min Mean_entropy: 1e+00
2022-05-09 01:04:13,244 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.130, Loss2: 1.930, Loss3: 0.965,  Acc: 0.974, Acc2: 0.609, Acc2_pse: 0.609, Base Lr: 5.24e-03
2022-05-09 01:04:36,344 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.550[s] Speed: 29.1[samples/s]
2022-05-09 01:06:11,027 reid_baseline.train INFO: normal accuracy 0.580761432755125 0.9279792308807373 
2022-05-09 01:06:14,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 01:06:14,112 reid_baseline.train INFO: Accuracy: 58.1%, best Accuracy: 58.1%, min Mean_entropy: 0.9
2022-05-09 01:07:13,481 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.118, Loss2: 1.913, Loss3: 0.957,  Acc: 0.982, Acc2: 0.606, Acc2_pse: 0.606, Base Lr: 4.94e-03
2022-05-09 01:07:39,045 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-05-09 01:09:10,279 reid_baseline.train INFO: normal accuracy 0.5667943230457311 0.851103663444519 
2022-05-09 01:09:10,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 01:09:10,279 reid_baseline.train INFO: Accuracy: 56.7%, best Accuracy: 58.1%, min Mean_entropy: 0.9
2022-05-09 01:10:13,203 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.127, Loss2: 1.831, Loss3: 0.909,  Acc: 0.973, Acc2: 0.626, Acc2_pse: 0.626, Base Lr: 4.63e-03
2022-05-09 01:10:38,974 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.607[s] Speed: 26.3[samples/s]
2022-05-09 01:12:13,936 reid_baseline.train INFO: normal accuracy 0.5904482991664789 0.845820426940918 
2022-05-09 01:12:17,024 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 01:12:17,024 reid_baseline.train INFO: Accuracy: 59.0%, best Accuracy: 59.0%, min Mean_entropy: 0.8
2022-05-09 01:13:17,013 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.112, Loss2: 1.830, Loss3: 0.927,  Acc: 0.983, Acc2: 0.628, Acc2_pse: 0.628, Base Lr: 4.32e-03
2022-05-09 01:13:41,553 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-05-09 01:15:19,515 reid_baseline.train INFO: normal accuracy 0.5672448749718405 0.7875529527664185 
2022-05-09 01:15:19,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 01:15:19,515 reid_baseline.train INFO: Accuracy: 56.7%, best Accuracy: 59.0%, min Mean_entropy: 0.8
2022-05-09 01:16:15,872 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.115, Loss2: 1.758, Loss3: 0.865,  Acc: 0.985, Acc2: 0.638, Acc2_pse: 0.638, Base Lr: 4.01e-03
2022-05-09 01:16:38,664 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 01:18:20,245 reid_baseline.train INFO: normal accuracy 0.6066681685064204 0.8113991618156433 
2022-05-09 01:18:23,332 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 01:18:23,332 reid_baseline.train INFO: Accuracy: 60.7%, best Accuracy: 60.7%, min Mean_entropy: 0.8
2022-05-09 01:19:19,164 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.114, Loss2: 1.787, Loss3: 0.897,  Acc: 0.986, Acc2: 0.642, Acc2_pse: 0.642, Base Lr: 3.69e-03
2022-05-09 01:19:43,538 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.549[s] Speed: 29.1[samples/s]
2022-05-09 01:21:19,316 reid_baseline.train INFO: normal accuracy 0.601712097319216 0.7847447395324707 
2022-05-09 01:21:19,316 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 01:21:19,316 reid_baseline.train INFO: Accuracy: 60.2%, best Accuracy: 60.7%, min Mean_entropy: 0.8
2022-05-09 01:22:18,747 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.112, Loss2: 1.722, Loss3: 0.862,  Acc: 0.978, Acc2: 0.657, Acc2_pse: 0.657, Base Lr: 3.38e-03
2022-05-09 01:22:40,445 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.563[s] Speed: 28.4[samples/s]
2022-05-09 01:24:11,571 reid_baseline.train INFO: normal accuracy 0.6030637530975445 0.7260764241218567 
2022-05-09 01:24:11,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 01:24:11,572 reid_baseline.train INFO: Accuracy: 60.3%, best Accuracy: 60.7%, min Mean_entropy: 0.8
2022-05-09 01:25:13,229 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.118, Loss2: 1.677, Loss3: 0.817,  Acc: 0.981, Acc2: 0.687, Acc2_pse: 0.687, Base Lr: 3.08e-03
2022-05-09 01:25:38,760 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.605[s] Speed: 26.4[samples/s]
2022-05-09 01:27:12,418 reid_baseline.train INFO: normal accuracy 0.6332507321468799 0.7592347860336304 
2022-05-09 01:27:15,506 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 01:27:15,506 reid_baseline.train INFO: Accuracy: 63.3%, best Accuracy: 63.3%, min Mean_entropy: 0.8
2022-05-09 01:28:15,188 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.109, Loss2: 1.667, Loss3: 0.860,  Acc: 0.989, Acc2: 0.684, Acc2_pse: 0.684, Base Lr: 2.77e-03
2022-05-09 01:28:40,189 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-05-09 01:30:15,168 reid_baseline.train INFO: normal accuracy 0.6050912367650372 0.7062883377075195 
2022-05-09 01:30:15,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 01:30:15,168 reid_baseline.train INFO: Accuracy: 60.5%, best Accuracy: 63.3%, min Mean_entropy: 0.8
2022-05-09 01:31:10,324 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.113, Loss2: 1.657, Loss3: 0.876,  Acc: 0.982, Acc2: 0.683, Acc2_pse: 0.683, Base Lr: 2.48e-03
2022-05-09 01:31:38,022 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.571[s] Speed: 28.0[samples/s]
2022-05-09 01:33:13,468 reid_baseline.train INFO: normal accuracy 0.6080198242847488 0.6761652231216431 
2022-05-09 01:33:13,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 01:33:13,469 reid_baseline.train INFO: Accuracy: 60.8%, best Accuracy: 63.3%, min Mean_entropy: 0.8
2022-05-09 01:34:09,732 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.112, Loss2: 1.626, Loss3: 0.829,  Acc: 0.981, Acc2: 0.683, Acc2_pse: 0.683, Base Lr: 2.20e-03
2022-05-09 01:34:32,988 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.552[s] Speed: 29.0[samples/s]
2022-05-09 01:36:09,721 reid_baseline.train INFO: normal accuracy 0.6370804235188106 0.7172892689704895 
2022-05-09 01:36:12,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 01:36:12,807 reid_baseline.train INFO: Accuracy: 63.7%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:37:10,523 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.108, Loss2: 1.611, Loss3: 0.809,  Acc: 0.987, Acc2: 0.701, Acc2_pse: 0.701, Base Lr: 1.92e-03
2022-05-09 01:37:35,266 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.573[s] Speed: 27.9[samples/s]
2022-05-09 01:39:10,070 reid_baseline.train INFO: normal accuracy 0.6373056994818653 0.7464485764503479 
2022-05-09 01:39:13,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 01:39:13,155 reid_baseline.train INFO: Accuracy: 63.7%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:40:12,139 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.116, Loss2: 1.567, Loss3: 0.842,  Acc: 0.981, Acc2: 0.707, Acc2_pse: 0.707, Base Lr: 1.66e-03
2022-05-09 01:40:34,991 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.572[s] Speed: 28.0[samples/s]
2022-05-09 01:42:11,868 reid_baseline.train INFO: normal accuracy 0.6172561387699932 0.6587613821029663 
2022-05-09 01:42:11,868 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 01:42:11,868 reid_baseline.train INFO: Accuracy: 61.7%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:43:10,468 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.111, Loss2: 1.586, Loss3: 0.761,  Acc: 0.984, Acc2: 0.711, Acc2_pse: 0.711, Base Lr: 1.42e-03
2022-05-09 01:43:35,200 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-05-09 01:45:07,983 reid_baseline.train INFO: normal accuracy 0.6330254561838252 0.6732438802719116 
2022-05-09 01:45:07,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 01:45:07,983 reid_baseline.train INFO: Accuracy: 63.3%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:46:07,388 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.110, Loss2: 1.596, Loss3: 0.801,  Acc: 0.986, Acc2: 0.690, Acc2_pse: 0.690, Base Lr: 1.19e-03
2022-05-09 01:46:32,859 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.585[s] Speed: 27.3[samples/s]
2022-05-09 01:48:11,275 reid_baseline.train INFO: normal accuracy 0.6258166253660734 0.7360163927078247 
2022-05-09 01:48:11,275 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 01:48:11,275 reid_baseline.train INFO: Accuracy: 62.6%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:49:07,203 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.105, Loss2: 1.561, Loss3: 0.805,  Acc: 0.987, Acc2: 0.702, Acc2_pse: 0.702, Base Lr: 9.72e-04
2022-05-09 01:49:33,783 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.569[s] Speed: 28.1[samples/s]
2022-05-09 01:51:10,871 reid_baseline.train INFO: normal accuracy 0.6213111061049786 0.6548234224319458 
2022-05-09 01:51:10,871 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 01:51:10,871 reid_baseline.train INFO: Accuracy: 62.1%, best Accuracy: 63.7%, min Mean_entropy: 0.7
2022-05-09 01:52:09,937 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.108, Loss2: 1.564, Loss3: 0.763,  Acc: 0.987, Acc2: 0.706, Acc2_pse: 0.706, Base Lr: 7.78e-04
2022-05-09 01:52:33,795 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.572[s] Speed: 28.0[samples/s]
2022-05-09 01:54:11,914 reid_baseline.train INFO: normal accuracy 0.6415859427799054 0.6752972602844238 
2022-05-09 01:54:14,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 01:54:14,998 reid_baseline.train INFO: Accuracy: 64.2%, best Accuracy: 64.2%, min Mean_entropy: 0.7
2022-05-09 01:55:13,113 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.102, Loss2: 1.596, Loss3: 0.801,  Acc: 0.987, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 6.04e-04
2022-05-09 01:55:36,334 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.569[s] Speed: 28.1[samples/s]
2022-05-09 01:57:11,941 reid_baseline.train INFO: normal accuracy 0.6623113313809417 0.7280071973800659 
2022-05-09 01:57:15,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 01:57:15,034 reid_baseline.train INFO: Accuracy: 66.2%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 01:58:13,548 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.107, Loss2: 1.561, Loss3: 0.767,  Acc: 0.985, Acc2: 0.717, Acc2_pse: 0.717, Base Lr: 4.51e-04
2022-05-09 01:58:38,627 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.585[s] Speed: 27.4[samples/s]
2022-05-09 02:00:12,615 reid_baseline.train INFO: normal accuracy 0.6391079071863032 0.6809516549110413 
2022-05-09 02:00:12,615 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 02:00:12,615 reid_baseline.train INFO: Accuracy: 63.9%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:01:14,391 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.107, Loss2: 1.560, Loss3: 0.756,  Acc: 0.989, Acc2: 0.712, Acc2_pse: 0.712, Base Lr: 3.20e-04
2022-05-09 02:01:39,569 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.604[s] Speed: 26.5[samples/s]
2022-05-09 02:03:12,310 reid_baseline.train INFO: normal accuracy 0.644514530299617 0.6881950497627258 
2022-05-09 02:03:12,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 02:03:12,310 reid_baseline.train INFO: Accuracy: 64.5%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:04:09,985 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.110, Loss2: 1.555, Loss3: 0.758,  Acc: 0.988, Acc2: 0.716, Acc2_pse: 0.716, Base Lr: 2.11e-04
2022-05-09 02:04:33,852 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-05-09 02:06:07,760 reid_baseline.train INFO: normal accuracy 0.6438387024104528 0.71035236120224 
2022-05-09 02:06:07,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 02:06:07,760 reid_baseline.train INFO: Accuracy: 64.4%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:07:03,350 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.106, Loss2: 1.595, Loss3: 0.815,  Acc: 0.989, Acc2: 0.705, Acc2_pse: 0.705, Base Lr: 1.26e-04
2022-05-09 02:07:27,338 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.560[s] Speed: 28.6[samples/s]
2022-05-09 02:09:02,046 reid_baseline.train INFO: normal accuracy 0.6328001802207704 0.6481526494026184 
2022-05-09 02:09:02,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 02:09:02,047 reid_baseline.train INFO: Accuracy: 63.3%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:09:58,387 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.103, Loss2: 1.508, Loss3: 0.746,  Acc: 0.984, Acc2: 0.733, Acc2_pse: 0.733, Base Lr: 6.51e-05
2022-05-09 02:10:22,306 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 02:11:54,266 reid_baseline.train INFO: normal accuracy 0.6404595629646317 0.6968235373497009 
2022-05-09 02:11:54,266 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 02:11:54,266 reid_baseline.train INFO: Accuracy: 64.0%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:12:53,332 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.103, Loss2: 1.547, Loss3: 0.787,  Acc: 0.986, Acc2: 0.716, Acc2_pse: 0.716, Base Lr: 2.83e-05
2022-05-09 02:13:15,602 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.561[s] Speed: 28.5[samples/s]
2022-05-09 02:14:49,926 reid_baseline.train INFO: normal accuracy 0.6271682811444019 0.6526563763618469 
2022-05-09 02:14:49,926 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 02:14:49,926 reid_baseline.train INFO: Accuracy: 62.7%, best Accuracy: 66.2%, min Mean_entropy: 0.7
2022-05-09 02:15:48,862 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.098, Loss2: 1.514, Loss3: 0.792,  Acc: 0.990, Acc2: 0.728, Acc2_pse: 0.728, Base Lr: 1.60e-05
2022-05-09 02:16:14,915 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.586[s] Speed: 27.3[samples/s]
2022-05-09 02:17:50,758 reid_baseline.train INFO: normal accuracy 0.6278441090335661 0.6380595564842224 
2022-05-09 02:17:50,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 02:17:50,758 reid_baseline.train INFO: Accuracy: 62.8%, best Accuracy: 66.2%, min Mean_entropy: 0.7
best model preformance is 0.6623113313809417
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2ProductDRI_1.0/transformer_best_model.pth
2022-05-09 02:19:27,918 reid_baseline.train INFO: normal accuracy 0.6623113313809417 0.7280071973800659 
2022-05-09 02:19:27,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 02:19:27,919 reid_baseline.train INFO: Accuracy: 66.2%
2022-05-09 02:20:53,205 reid_baseline.train INFO: normal accuracy 0.8990523279769262 0.27761542797088623 
2022-05-09 02:20:53,205 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 02:20:53,205 reid_baseline.train INFO: Accuracy: 89.9%
2022-05-09 02:20:56,588 reid_baseline INFO: Saving model in the path :../logs/uda/deit_base/office-home/Art2Real_WorldDRI_1.0
2022-05-09 02:20:56,588 reid_baseline INFO: Namespace(config_file='configs/uda.yml', opts=['MODEL.DEVICE_ID', "('0')", 'OUTPUT_DIR', '../logs/uda/deit_base/office-home/Art2Real_WorldDRI_1.0', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TRAIN_DIR2', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'DATASETS.NAMES', 'OfficeHome', 'DATASETS.NAMES2', 'OfficeHome', 'MODEL.Transformer_TYPE', 'uda_vit_base_patch16_224_TransReID'], local_rank=0, patch_size=1, dom_cls=False, layer_num=1, dom_weight=1.0)
2022-05-09 02:20:56,588 reid_baseline INFO: Loaded configuration file configs/uda.yml
2022-05-09 02:20:56,589 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'uda_vit_base_patch16_224_TransReID' #uda_vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  BLOCK_PATTERN: '3_branches'
  TASK_TYPE: 'classify_DA'
  UDA_STAGE: 'UDA'
#  CAMERA_EMBEDDING: True
#  VIEWPOINT_EMBEDDING: True

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 4

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-09 02:20:56,589 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 4
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OfficeHome
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ../data/OfficeHomeDataset/Real_World.txt
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: 3_branches
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: uda_vit_base_patch16_224_TransReID
  UDA_STAGE: UDA
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_1.0
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
=> Office-Home loaded
Dataset statistics:
train Real_World and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4357 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
using Transformer_type: uda_vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
using 3branches blocks
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building uda transformer===========
label smooth on, numclasses: 65
2022-05-09 02:21:01,117 reid_baseline.train INFO: start training
2022-05-09 02:21:57,678 reid_baseline.train INFO: Epoch[1] Iteration[100/147] Loss1: 1.293, Loss2: 4.160, Loss3: 4.174,  Acc: 0.472, Acc2: 0.090, Acc2_pse: 0.090, Base Lr: 8.72e-04
2022-05-09 02:22:23,757 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.568[s] Speed: 28.1[samples/s]
2022-05-09 02:27:52,897 reid_baseline.train INFO: normal accuracy 0.4624741794812945 4.173108100891113 
2022-05-09 02:27:55,904 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-09 02:27:55,904 reid_baseline.train INFO: Accuracy: 46.2%, best Accuracy: 46.2%, min Mean_entropy: 4e+00
2022-05-09 02:28:53,814 reid_baseline.train INFO: Epoch[2] Iteration[100/147] Loss1: 0.651, Loss2: 4.074, Loss3: 4.173,  Acc: 0.809, Acc2: 0.379, Acc2_pse: 0.379, Base Lr: 1.66e-03
2022-05-09 02:29:19,681 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.578[s] Speed: 27.7[samples/s]
2022-05-09 02:34:46,991 reid_baseline.train INFO: normal accuracy 0.5641496442506312 4.1690568923950195 
2022-05-09 02:34:50,089 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-09 02:34:50,090 reid_baseline.train INFO: Accuracy: 56.4%, best Accuracy: 56.4%, min Mean_entropy: 4e+00
2022-05-09 02:35:49,183 reid_baseline.train INFO: Epoch[3] Iteration[100/147] Loss1: 0.313, Loss2: 3.906, Loss3: 4.168,  Acc: 0.933, Acc2: 0.417, Acc2_pse: 0.417, Base Lr: 2.46e-03
2022-05-09 02:36:16,082 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.593[s] Speed: 27.0[samples/s]
2022-05-09 02:41:48,815 reid_baseline.train INFO: normal accuracy 0.598347486802846 4.133710861206055 
2022-05-09 02:41:51,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-09 02:41:51,914 reid_baseline.train INFO: Accuracy: 59.8%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 02:42:50,576 reid_baseline.train INFO: Epoch[4] Iteration[100/147] Loss1: 0.205, Loss2: 3.559, Loss3: 4.118,  Acc: 0.952, Acc2: 0.427, Acc2_pse: 0.427, Base Lr: 3.25e-03
2022-05-09 02:43:15,437 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.576[s] Speed: 27.8[samples/s]
2022-05-09 02:48:30,720 reid_baseline.train INFO: normal accuracy 0.5118200596740877 3.7928812503814697 
2022-05-09 02:48:30,720 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-09 02:48:30,720 reid_baseline.train INFO: Accuracy: 51.2%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 02:49:29,244 reid_baseline.train INFO: Epoch[5] Iteration[100/147] Loss1: 0.191, Loss2: 3.093, Loss3: 3.708,  Acc: 0.961, Acc2: 0.389, Acc2_pse: 0.389, Base Lr: 4.04e-03
2022-05-09 02:49:55,816 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.583[s] Speed: 27.5[samples/s]
2022-05-09 02:55:11,512 reid_baseline.train INFO: normal accuracy 0.4537525820518706 2.611082077026367 
2022-05-09 02:55:11,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-09 02:55:11,512 reid_baseline.train INFO: Accuracy: 45.4%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 02:56:10,167 reid_baseline.train INFO: Epoch[6] Iteration[100/147] Loss1: 0.182, Loss2: 2.941, Loss3: 2.798,  Acc: 0.965, Acc2: 0.342, Acc2_pse: 0.342, Base Lr: 4.83e-03
2022-05-09 02:56:34,150 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.582[s] Speed: 27.5[samples/s]
2022-05-09 03:01:51,380 reid_baseline.train INFO: normal accuracy 0.4418177645168694 1.933512568473816 
2022-05-09 03:01:51,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-09 03:01:51,380 reid_baseline.train INFO: Accuracy: 44.2%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:02:50,054 reid_baseline.train INFO: Epoch[7] Iteration[100/147] Loss1: 0.173, Loss2: 2.866, Loss3: 2.159,  Acc: 0.962, Acc2: 0.367, Acc2_pse: 0.367, Base Lr: 5.62e-03
2022-05-09 03:03:12,233 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.565[s] Speed: 28.3[samples/s]
2022-05-09 03:08:32,684 reid_baseline.train INFO: normal accuracy 0.4904750975441818 1.6655830144882202 
2022-05-09 03:08:32,684 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-09 03:08:32,684 reid_baseline.train INFO: Accuracy: 49.0%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:09:29,288 reid_baseline.train INFO: Epoch[8] Iteration[100/147] Loss1: 0.178, Loss2: 2.668, Loss3: 1.749,  Acc: 0.958, Acc2: 0.426, Acc2_pse: 0.426, Base Lr: 6.42e-03
2022-05-09 03:09:52,835 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.556[s] Speed: 28.8[samples/s]
2022-05-09 03:15:17,336 reid_baseline.train INFO: normal accuracy 0.5308698645857242 1.4593956470489502 
2022-05-09 03:15:17,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-09 03:15:17,336 reid_baseline.train INFO: Accuracy: 53.1%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:16:13,924 reid_baseline.train INFO: Epoch[9] Iteration[100/147] Loss1: 0.137, Loss2: 2.540, Loss3: 1.555,  Acc: 0.979, Acc2: 0.434, Acc2_pse: 0.434, Base Lr: 7.21e-03
2022-05-09 03:16:38,263 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.554[s] Speed: 28.9[samples/s]
2022-05-09 03:21:55,668 reid_baseline.train INFO: normal accuracy 0.5457883865044756 1.1808656454086304 
2022-05-09 03:21:55,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-09 03:21:55,668 reid_baseline.train INFO: Accuracy: 54.6%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:22:51,860 reid_baseline.train INFO: Epoch[10] Iteration[100/147] Loss1: 0.148, Loss2: 2.420, Loss3: 1.297,  Acc: 0.970, Acc2: 0.493, Acc2_pse: 0.493, Base Lr: 6.83e-03
2022-05-09 03:23:15,735 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.560[s] Speed: 28.6[samples/s]
2022-05-09 03:28:44,435 reid_baseline.train INFO: normal accuracy 0.560706908423227 0.9613035917282104 
2022-05-09 03:28:44,435 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-09 03:28:44,435 reid_baseline.train INFO: Accuracy: 56.1%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:29:39,241 reid_baseline.train INFO: Epoch[11] Iteration[100/147] Loss1: 0.136, Loss2: 2.343, Loss3: 1.221,  Acc: 0.976, Acc2: 0.506, Acc2_pse: 0.506, Base Lr: 6.60e-03
2022-05-09 03:30:03,266 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.544[s] Speed: 29.4[samples/s]
2022-05-09 03:35:23,086 reid_baseline.train INFO: normal accuracy 0.577232040394767 0.9615525007247925 
2022-05-09 03:35:23,086 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-09 03:35:23,086 reid_baseline.train INFO: Accuracy: 57.7%, best Accuracy: 59.8%, min Mean_entropy: 4e+00
2022-05-09 03:36:18,826 reid_baseline.train INFO: Epoch[12] Iteration[100/147] Loss1: 0.140, Loss2: 2.205, Loss3: 1.137,  Acc: 0.970, Acc2: 0.533, Acc2_pse: 0.533, Base Lr: 6.35e-03
2022-05-09 03:36:43,807 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.560[s] Speed: 28.5[samples/s]
2022-05-09 03:41:59,648 reid_baseline.train INFO: normal accuracy 0.619003901767271 0.9583256244659424 
2022-05-09 03:42:02,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-09 03:42:02,737 reid_baseline.train INFO: Accuracy: 61.9%, best Accuracy: 61.9%, min Mean_entropy: 1e+00
2022-05-09 03:42:58,244 reid_baseline.train INFO: Epoch[13] Iteration[100/147] Loss1: 0.131, Loss2: 2.133, Loss3: 1.052,  Acc: 0.977, Acc2: 0.541, Acc2_pse: 0.541, Base Lr: 6.09e-03
2022-05-09 03:43:22,476 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.554[s] Speed: 28.9[samples/s]
2022-05-09 03:48:39,742 reid_baseline.train INFO: normal accuracy 0.631627266467753 0.8583701848983765 
2022-05-09 03:48:42,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-09 03:48:42,831 reid_baseline.train INFO: Accuracy: 63.2%, best Accuracy: 63.2%, min Mean_entropy: 0.9
2022-05-09 03:49:38,803 reid_baseline.train INFO: Epoch[14] Iteration[100/147] Loss1: 0.127, Loss2: 2.019, Loss3: 1.031,  Acc: 0.977, Acc2: 0.570, Acc2_pse: 0.570, Base Lr: 5.82e-03
2022-05-09 03:50:01,756 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.548[s] Speed: 29.2[samples/s]
2022-05-09 03:55:30,581 reid_baseline.train INFO: normal accuracy 0.6373651595134266 0.8124049305915833 
2022-05-09 03:55:33,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-09 03:55:33,669 reid_baseline.train INFO: Accuracy: 63.7%, best Accuracy: 63.7%, min Mean_entropy: 0.8
2022-05-09 03:56:28,623 reid_baseline.train INFO: Epoch[15] Iteration[100/147] Loss1: 0.138, Loss2: 2.015, Loss3: 1.020,  Acc: 0.973, Acc2: 0.585, Acc2_pse: 0.585, Base Lr: 5.54e-03
2022-05-09 03:56:52,675 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.552[s] Speed: 29.0[samples/s]
2022-05-09 04:02:14,775 reid_baseline.train INFO: normal accuracy 0.6261188891439063 0.7037544846534729 
2022-05-09 04:02:14,776 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-09 04:02:14,776 reid_baseline.train INFO: Accuracy: 62.6%, best Accuracy: 63.7%, min Mean_entropy: 0.8
2022-05-09 04:03:09,673 reid_baseline.train INFO: Epoch[16] Iteration[100/147] Loss1: 0.134, Loss2: 1.931, Loss3: 0.966,  Acc: 0.976, Acc2: 0.601, Acc2_pse: 0.601, Base Lr: 5.24e-03
2022-05-09 04:03:33,407 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.546[s] Speed: 29.3[samples/s]
2022-05-09 04:08:50,367 reid_baseline.train INFO: normal accuracy 0.6688088134037181 0.7421458959579468 
2022-05-09 04:08:53,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-09 04:08:53,452 reid_baseline.train INFO: Accuracy: 66.9%, best Accuracy: 66.9%, min Mean_entropy: 0.7
2022-05-09 04:09:50,748 reid_baseline.train INFO: Epoch[17] Iteration[100/147] Loss1: 0.119, Loss2: 1.913, Loss3: 0.961,  Acc: 0.981, Acc2: 0.608, Acc2_pse: 0.608, Base Lr: 4.94e-03
2022-05-09 04:10:16,820 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.575[s] Speed: 27.8[samples/s]
2022-05-09 04:15:38,358 reid_baseline.train INFO: normal accuracy 0.6474638512738122 0.6645914316177368 
2022-05-09 04:15:38,358 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-09 04:15:38,358 reid_baseline.train INFO: Accuracy: 64.7%, best Accuracy: 66.9%, min Mean_entropy: 0.7
2022-05-09 04:16:35,364 reid_baseline.train INFO: Epoch[18] Iteration[100/147] Loss1: 0.126, Loss2: 1.825, Loss3: 0.912,  Acc: 0.976, Acc2: 0.621, Acc2_pse: 0.621, Base Lr: 4.63e-03
2022-05-09 04:17:00,215 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.561[s] Speed: 28.5[samples/s]
2022-05-09 04:22:13,670 reid_baseline.train INFO: normal accuracy 0.6848749139316043 0.6934046149253845 
2022-05-09 04:22:16,755 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-09 04:22:16,755 reid_baseline.train INFO: Accuracy: 68.5%, best Accuracy: 68.5%, min Mean_entropy: 0.7
2022-05-09 04:23:14,707 reid_baseline.train INFO: Epoch[19] Iteration[100/147] Loss1: 0.117, Loss2: 1.834, Loss3: 0.922,  Acc: 0.983, Acc2: 0.620, Acc2_pse: 0.620, Base Lr: 4.32e-03
2022-05-09 04:23:38,717 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.573[s] Speed: 27.9[samples/s]
2022-05-09 04:28:51,822 reid_baseline.train INFO: normal accuracy 0.6623823731925637 0.6140899062156677 
2022-05-09 04:28:51,822 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-09 04:28:51,823 reid_baseline.train INFO: Accuracy: 66.2%, best Accuracy: 68.5%, min Mean_entropy: 0.7
2022-05-09 04:29:50,064 reid_baseline.train INFO: Epoch[20] Iteration[100/147] Loss1: 0.118, Loss2: 1.754, Loss3: 0.865,  Acc: 0.985, Acc2: 0.645, Acc2_pse: 0.645, Base Lr: 4.01e-03
2022-05-09 04:30:13,967 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.574[s] Speed: 27.9[samples/s]
2022-05-09 04:35:31,709 reid_baseline.train INFO: normal accuracy 0.6988753729630479 0.638207733631134 
2022-05-09 04:35:34,795 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-09 04:35:34,795 reid_baseline.train INFO: Accuracy: 69.9%, best Accuracy: 69.9%, min Mean_entropy: 0.6
2022-05-09 04:36:33,949 reid_baseline.train INFO: Epoch[21] Iteration[100/147] Loss1: 0.113, Loss2: 1.788, Loss3: 0.903,  Acc: 0.988, Acc2: 0.644, Acc2_pse: 0.644, Base Lr: 3.69e-03
2022-05-09 04:37:00,237 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.585[s] Speed: 27.3[samples/s]
2022-05-09 04:42:17,029 reid_baseline.train INFO: normal accuracy 0.6855634610970851 0.6134310364723206 
2022-05-09 04:42:17,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-05-09 04:42:17,029 reid_baseline.train INFO: Accuracy: 68.6%, best Accuracy: 69.9%, min Mean_entropy: 0.6
2022-05-09 04:43:17,025 reid_baseline.train INFO: Epoch[22] Iteration[100/147] Loss1: 0.112, Loss2: 1.719, Loss3: 0.859,  Acc: 0.978, Acc2: 0.655, Acc2_pse: 0.655, Base Lr: 3.38e-03
2022-05-09 04:43:41,179 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.584[s] Speed: 27.4[samples/s]
2022-05-09 04:49:01,549 reid_baseline.train INFO: normal accuracy 0.6913013541427587 0.571619987487793 
2022-05-09 04:49:01,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-05-09 04:49:01,549 reid_baseline.train INFO: Accuracy: 69.1%, best Accuracy: 69.9%, min Mean_entropy: 0.6
2022-05-09 04:49:57,526 reid_baseline.train INFO: Epoch[23] Iteration[100/147] Loss1: 0.119, Loss2: 1.679, Loss3: 0.823,  Acc: 0.980, Acc2: 0.684, Acc2_pse: 0.684, Base Lr: 3.08e-03
2022-05-09 04:50:24,639 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.577[s] Speed: 27.7[samples/s]
2022-05-09 04:55:38,026 reid_baseline.train INFO: normal accuracy 0.7126463162726647 0.5969580411911011 
2022-05-09 04:55:41,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-05-09 04:55:41,113 reid_baseline.train INFO: Accuracy: 71.3%, best Accuracy: 71.3%, min Mean_entropy: 0.6
2022-05-09 04:56:36,987 reid_baseline.train INFO: Epoch[24] Iteration[100/147] Loss1: 0.111, Loss2: 1.664, Loss3: 0.857,  Acc: 0.988, Acc2: 0.685, Acc2_pse: 0.685, Base Lr: 2.77e-03
2022-05-09 04:57:00,593 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.556[s] Speed: 28.8[samples/s]
2022-05-09 05:02:21,620 reid_baseline.train INFO: normal accuracy 0.6862520082625659 0.5462602972984314 
2022-05-09 05:02:21,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-05-09 05:02:21,620 reid_baseline.train INFO: Accuracy: 68.6%, best Accuracy: 71.3%, min Mean_entropy: 0.6
2022-05-09 05:03:16,709 reid_baseline.train INFO: Epoch[25] Iteration[100/147] Loss1: 0.110, Loss2: 1.661, Loss3: 0.872,  Acc: 0.985, Acc2: 0.687, Acc2_pse: 0.687, Base Lr: 2.48e-03
2022-05-09 05:03:40,636 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.545[s] Speed: 29.4[samples/s]
2022-05-09 05:08:56,053 reid_baseline.train INFO: normal accuracy 0.6910718384209318 0.5265999436378479 
2022-05-09 05:08:56,054 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-05-09 05:08:56,054 reid_baseline.train INFO: Accuracy: 69.1%, best Accuracy: 71.3%, min Mean_entropy: 0.6
2022-05-09 05:09:52,239 reid_baseline.train INFO: Epoch[26] Iteration[100/147] Loss1: 0.117, Loss2: 1.618, Loss3: 0.842,  Acc: 0.983, Acc2: 0.688, Acc2_pse: 0.688, Base Lr: 2.20e-03
2022-05-09 05:10:15,497 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.552[s] Speed: 29.0[samples/s]
2022-05-09 05:15:36,521 reid_baseline.train INFO: normal accuracy 0.7195317879274731 0.5719636082649231 
2022-05-09 05:15:39,622 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-05-09 05:15:39,623 reid_baseline.train INFO: Accuracy: 72.0%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:16:35,298 reid_baseline.train INFO: Epoch[27] Iteration[100/147] Loss1: 0.111, Loss2: 1.615, Loss3: 0.807,  Acc: 0.987, Acc2: 0.699, Acc2_pse: 0.699, Base Lr: 1.92e-03
2022-05-09 05:16:59,284 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 05:22:22,947 reid_baseline.train INFO: normal accuracy 0.7057608446178564 0.5633101463317871 
2022-05-09 05:22:22,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-05-09 05:22:22,947 reid_baseline.train INFO: Accuracy: 70.6%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:23:19,740 reid_baseline.train INFO: Epoch[28] Iteration[100/147] Loss1: 0.117, Loss2: 1.568, Loss3: 0.842,  Acc: 0.980, Acc2: 0.706, Acc2_pse: 0.706, Base Lr: 1.66e-03
2022-05-09 05:23:43,540 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.563[s] Speed: 28.4[samples/s]
2022-05-09 05:29:02,388 reid_baseline.train INFO: normal accuracy 0.6970392471884324 0.5120699405670166 
2022-05-09 05:29:02,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-05-09 05:29:02,388 reid_baseline.train INFO: Accuracy: 69.7%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:29:59,514 reid_baseline.train INFO: Epoch[29] Iteration[100/147] Loss1: 0.111, Loss2: 1.587, Loss3: 0.762,  Acc: 0.987, Acc2: 0.705, Acc2_pse: 0.705, Base Lr: 1.42e-03
2022-05-09 05:30:23,322 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.566[s] Speed: 28.3[samples/s]
2022-05-09 05:35:40,927 reid_baseline.train INFO: normal accuracy 0.7181546935965114 0.5215380191802979 
2022-05-09 05:35:40,928 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-05-09 05:35:40,928 reid_baseline.train INFO: Accuracy: 71.8%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:36:37,928 reid_baseline.train INFO: Epoch[30] Iteration[100/147] Loss1: 0.109, Loss2: 1.595, Loss3: 0.804,  Acc: 0.985, Acc2: 0.690, Acc2_pse: 0.690, Base Lr: 1.19e-03
2022-05-09 05:37:02,661 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.564[s] Speed: 28.4[samples/s]
2022-05-09 05:42:29,336 reid_baseline.train INFO: normal accuracy 0.7103511590543953 0.5644594430923462 
2022-05-09 05:42:29,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-05-09 05:42:29,336 reid_baseline.train INFO: Accuracy: 71.0%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:43:25,244 reid_baseline.train INFO: Epoch[31] Iteration[100/147] Loss1: 0.103, Loss2: 1.568, Loss3: 0.803,  Acc: 0.985, Acc2: 0.705, Acc2_pse: 0.705, Base Lr: 9.72e-04
2022-05-09 05:43:52,033 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.570[s] Speed: 28.1[samples/s]
2022-05-09 05:49:10,484 reid_baseline.train INFO: normal accuracy 0.7020885930686253 0.49962013959884644 
2022-05-09 05:49:10,484 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-05-09 05:49:10,484 reid_baseline.train INFO: Accuracy: 70.2%, best Accuracy: 72.0%, min Mean_entropy: 0.6
2022-05-09 05:50:06,961 reid_baseline.train INFO: Epoch[32] Iteration[100/147] Loss1: 0.107, Loss2: 1.567, Loss3: 0.764,  Acc: 0.988, Acc2: 0.704, Acc2_pse: 0.704, Base Lr: 7.78e-04
2022-05-09 05:50:30,976 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.555[s] Speed: 28.8[samples/s]
2022-05-09 05:55:43,953 reid_baseline.train INFO: normal accuracy 0.7250401652513198 0.5370907187461853 
2022-05-09 05:55:47,037 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-05-09 05:55:47,038 reid_baseline.train INFO: Accuracy: 72.5%, best Accuracy: 72.5%, min Mean_entropy: 0.5
2022-05-09 05:56:43,451 reid_baseline.train INFO: Epoch[33] Iteration[100/147] Loss1: 0.102, Loss2: 1.603, Loss3: 0.789,  Acc: 0.991, Acc2: 0.691, Acc2_pse: 0.691, Base Lr: 6.04e-04
2022-05-09 05:57:06,549 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.556[s] Speed: 28.8[samples/s]
2022-05-09 06:02:30,624 reid_baseline.train INFO: normal accuracy 0.7372044985081478 0.5658129453659058 
2022-05-09 06:02:33,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-05-09 06:02:33,823 reid_baseline.train INFO: Accuracy: 73.7%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:03:28,652 reid_baseline.train INFO: Epoch[34] Iteration[100/147] Loss1: 0.105, Loss2: 1.555, Loss3: 0.768,  Acc: 0.986, Acc2: 0.716, Acc2_pse: 0.716, Base Lr: 4.51e-04
2022-05-09 06:03:52,049 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.547[s] Speed: 29.3[samples/s]
2022-05-09 06:09:16,939 reid_baseline.train INFO: normal accuracy 0.7163185678218958 0.5224078893661499 
2022-05-09 06:09:16,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-05-09 06:09:16,939 reid_baseline.train INFO: Accuracy: 71.6%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:10:13,634 reid_baseline.train INFO: Epoch[35] Iteration[100/147] Loss1: 0.107, Loss2: 1.555, Loss3: 0.758,  Acc: 0.988, Acc2: 0.709, Acc2_pse: 0.709, Base Lr: 3.20e-04
2022-05-09 06:10:36,966 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.556[s] Speed: 28.8[samples/s]
2022-05-09 06:16:02,129 reid_baseline.train INFO: normal accuracy 0.7273353224695892 0.5317806601524353 
2022-05-09 06:16:02,129 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-05-09 06:16:02,130 reid_baseline.train INFO: Accuracy: 72.7%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:16:57,447 reid_baseline.train INFO: Epoch[36] Iteration[100/147] Loss1: 0.112, Loss2: 1.559, Loss3: 0.752,  Acc: 0.987, Acc2: 0.715, Acc2_pse: 0.715, Base Lr: 2.11e-04
2022-05-09 06:17:19,748 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.550[s] Speed: 29.1[samples/s]
2022-05-09 06:22:45,954 reid_baseline.train INFO: normal accuracy 0.7248106495294928 0.5476682782173157 
2022-05-09 06:22:45,954 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-05-09 06:22:45,954 reid_baseline.train INFO: Accuracy: 72.5%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:23:41,748 reid_baseline.train INFO: Epoch[37] Iteration[100/147] Loss1: 0.106, Loss2: 1.595, Loss3: 0.811,  Acc: 0.989, Acc2: 0.697, Acc2_pse: 0.697, Base Lr: 1.26e-04
2022-05-09 06:24:04,545 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 06:29:25,019 reid_baseline.train INFO: normal accuracy 0.7179251778746845 0.49387645721435547 
2022-05-09 06:29:25,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-05-09 06:29:25,020 reid_baseline.train INFO: Accuracy: 71.8%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:30:22,041 reid_baseline.train INFO: Epoch[38] Iteration[100/147] Loss1: 0.102, Loss2: 1.519, Loss3: 0.734,  Acc: 0.987, Acc2: 0.733, Acc2_pse: 0.733, Base Lr: 6.51e-05
2022-05-09 06:30:45,284 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.553[s] Speed: 28.9[samples/s]
2022-05-09 06:36:03,661 reid_baseline.train INFO: normal accuracy 0.7147119577691072 0.529874324798584 
2022-05-09 06:36:03,661 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-05-09 06:36:03,661 reid_baseline.train INFO: Accuracy: 71.5%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:37:01,086 reid_baseline.train INFO: Epoch[39] Iteration[100/147] Loss1: 0.104, Loss2: 1.552, Loss3: 0.779,  Acc: 0.987, Acc2: 0.710, Acc2_pse: 0.710, Base Lr: 2.83e-05
2022-05-09 06:37:23,828 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.552[s] Speed: 29.0[samples/s]
2022-05-09 06:42:40,079 reid_baseline.train INFO: normal accuracy 0.7098921276107414 0.49475935101509094 
2022-05-09 06:42:40,079 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-05-09 06:42:40,079 reid_baseline.train INFO: Accuracy: 71.0%, best Accuracy: 73.7%, min Mean_entropy: 0.6
2022-05-09 06:43:35,074 reid_baseline.train INFO: Epoch[40] Iteration[100/147] Loss1: 0.099, Loss2: 1.519, Loss3: 0.793,  Acc: 0.992, Acc2: 0.728, Acc2_pse: 0.728, Base Lr: 1.60e-05
2022-05-09 06:43:59,755 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.549[s] Speed: 29.2[samples/s]
2022-05-09 06:49:20,588 reid_baseline.train INFO: normal accuracy 0.7064493917833372 0.4855595529079437 
2022-05-09 06:49:20,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-05-09 06:49:20,588 reid_baseline.train INFO: Accuracy: 70.6%, best Accuracy: 73.7%, min Mean_entropy: 0.6
best model preformance is 0.7372044985081478
Loading pretrained model for finetuning from ../logs/uda/deit_base/office-home/Art2Real_WorldDRI_1.0/transformer_best_model.pth
2022-05-09 06:54:40,765 reid_baseline.train INFO: normal accuracy 0.7372044985081478 0.5658129453659058 
2022-05-09 06:54:40,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best model
2022-05-09 06:54:40,765 reid_baseline.train INFO: Accuracy: 73.7%
2022-05-09 06:56:05,770 reid_baseline.train INFO: normal accuracy 0.8986402966625463 0.28001198172569275 
2022-05-09 06:56:05,770 reid_baseline.train INFO: Classify Domain Adapatation Source Results - Best model
2022-05-09 06:56:05,771 reid_baseline.train INFO: Accuracy: 89.9%
