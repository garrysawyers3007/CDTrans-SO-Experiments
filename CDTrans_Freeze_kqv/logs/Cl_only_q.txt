2022-05-13 23:57:28,344 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_q
2022-05-13 23:57:28,344 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_q', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-05-13 23:57:28,344 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 23:57:28,344 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 23:57:28,345 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_q
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-13 23:57:35,114 reid_baseline.train INFO: start training
2022-05-13 23:57:41,495 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.088, Acc: 0.345, Base Lr: 8.72e-04
2022-05-13 23:57:47,075 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 3.986, Acc: 0.453, Base Lr: 8.72e-04
2022-05-13 23:57:51,178 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.058[s] Speed: 276.6[samples/s]
2022-05-13 23:58:00,690 reid_baseline.train INFO: normal accuracy 0.4899052327976926 4.163028240203857 
2022-05-13 23:58:03,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 23:58:03,732 reid_baseline.train INFO: Accuracy: 49.0% Mean Entropy: 416.3%
2022-05-13 23:58:09,823 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.447, Acc: 0.612, Base Lr: 1.66e-03
2022-05-13 23:58:15,378 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.273, Acc: 0.623, Base Lr: 1.66e-03
2022-05-13 23:58:19,523 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.058[s] Speed: 276.7[samples/s]
2022-05-13 23:58:29,022 reid_baseline.train INFO: normal accuracy 0.5372888339513803 4.063893795013428 
2022-05-13 23:58:32,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 23:58:32,113 reid_baseline.train INFO: Accuracy: 53.7% Mean Entropy: 406.4%
2022-05-13 23:58:38,259 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.585, Acc: 0.660, Base Lr: 2.46e-03
2022-05-13 23:58:43,844 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.456, Acc: 0.673, Base Lr: 2.46e-03
2022-05-13 23:58:48,032 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.058[s] Speed: 274.5[samples/s]
2022-05-13 23:58:57,534 reid_baseline.train INFO: normal accuracy 0.6131025957972805 3.7649755477905273 
2022-05-13 23:59:00,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 23:59:00,635 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 376.5%
2022-05-13 23:59:06,764 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 1.914, Acc: 0.749, Base Lr: 3.25e-03
2022-05-13 23:59:12,328 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.888, Acc: 0.748, Base Lr: 3.25e-03
2022-05-13 23:59:16,525 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.058[s] Speed: 275.0[samples/s]
2022-05-13 23:59:26,014 reid_baseline.train INFO: normal accuracy 0.661722290894108 3.3852670192718506 
2022-05-13 23:59:29,123 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 23:59:29,123 reid_baseline.train INFO: Accuracy: 66.2% Mean Entropy: 338.5%
2022-05-13 23:59:35,242 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.620, Acc: 0.796, Base Lr: 4.04e-03
2022-05-13 23:59:40,829 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.585, Acc: 0.798, Base Lr: 4.04e-03
2022-05-13 23:59:45,019 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.058[s] Speed: 275.0[samples/s]
2022-05-13 23:59:54,438 reid_baseline.train INFO: normal accuracy 0.6831479192418624 3.0224404335021973 
2022-05-13 23:59:57,577 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 23:59:57,577 reid_baseline.train INFO: Accuracy: 68.3% Mean Entropy: 302.2%
2022-05-14 00:00:03,703 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.455, Acc: 0.816, Base Lr: 4.83e-03
2022-05-14 00:00:09,309 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.423, Acc: 0.826, Base Lr: 4.83e-03
2022-05-14 00:00:13,477 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.058[s] Speed: 274.9[samples/s]
2022-05-14 00:00:22,954 reid_baseline.train INFO: normal accuracy 0.696332921302019 2.802457571029663 
2022-05-14 00:00:26,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-14 00:00:26,049 reid_baseline.train INFO: Accuracy: 69.6% Mean Entropy: 280.2%
2022-05-14 00:00:32,175 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.309, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:00:37,772 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.313, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:00:41,927 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:00:51,344 reid_baseline.train INFO: normal accuracy 0.6934487021013597 2.6434919834136963 
2022-05-14 00:00:54,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-14 00:00:54,434 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 264.3%
2022-05-14 00:01:00,521 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.216, Acc: 0.893, Base Lr: 6.42e-03
2022-05-14 00:01:06,135 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.233, Acc: 0.887, Base Lr: 6.42e-03
2022-05-14 00:01:10,313 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:01:19,776 reid_baseline.train INFO: normal accuracy 0.6876802637000412 2.5254712104797363 
2022-05-14 00:01:22,885 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-14 00:01:22,885 reid_baseline.train INFO: Accuracy: 68.8% Mean Entropy: 252.5%
2022-05-14 00:01:29,004 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.185, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:01:34,662 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.184, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:01:38,841 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.058[s] Speed: 273.9[samples/s]
2022-05-14 00:01:48,311 reid_baseline.train INFO: normal accuracy 0.7004532344458179 2.417001247406006 
2022-05-14 00:01:51,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-14 00:01:51,419 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 241.7%
2022-05-14 00:01:57,553 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.926, Base Lr: 4.01e-03
2022-05-14 00:02:03,155 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.134, Acc: 0.916, Base Lr: 4.01e-03
2022-05-14 00:02:07,315 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.058[s] Speed: 274.9[samples/s]
2022-05-14 00:02:19,780 reid_baseline.train INFO: normal accuracy 0.69221260815822 2.377821922302246 
2022-05-14 00:02:22,870 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-14 00:02:22,870 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 237.8%
2022-05-14 00:02:28,951 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.123, Acc: 0.920, Base Lr: 3.38e-03
2022-05-14 00:02:34,539 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.120, Acc: 0.921, Base Lr: 3.38e-03
2022-05-14 00:02:38,764 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.058[s] Speed: 274.9[samples/s]
2022-05-14 00:02:48,204 reid_baseline.train INFO: normal accuracy 0.6897404202719407 2.3876616954803467 
2022-05-14 00:02:48,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-14 00:02:48,207 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 238.8%
2022-05-14 00:02:54,312 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.080, Acc: 0.938, Base Lr: 2.77e-03
2022-05-14 00:02:59,930 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.093, Acc: 0.932, Base Lr: 2.77e-03
2022-05-14 00:03:04,139 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.058[s] Speed: 274.3[samples/s]
2022-05-14 00:03:13,616 reid_baseline.train INFO: normal accuracy 0.6934487021013597 2.3704233169555664 
2022-05-14 00:03:16,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-14 00:03:16,697 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 237.0%
2022-05-14 00:03:22,859 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.096, Acc: 0.934, Base Lr: 2.20e-03
2022-05-14 00:03:28,464 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.086, Acc: 0.936, Base Lr: 2.20e-03
2022-05-14 00:03:32,646 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.058[s] Speed: 274.0[samples/s]
2022-05-14 00:03:42,089 reid_baseline.train INFO: normal accuracy 0.6897404202719407 2.347078800201416 
2022-05-14 00:03:45,197 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-14 00:03:45,197 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 234.7%
2022-05-14 00:03:51,272 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.091, Acc: 0.928, Base Lr: 1.66e-03
2022-05-14 00:03:56,866 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.081, Acc: 0.932, Base Lr: 1.66e-03
2022-05-14 00:04:01,083 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.058[s] Speed: 275.1[samples/s]
2022-05-14 00:04:10,582 reid_baseline.train INFO: normal accuracy 0.6918005768438401 2.3582890033721924 
2022-05-14 00:04:10,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-14 00:04:10,584 reid_baseline.train INFO: Accuracy: 69.2% Mean Entropy: 235.8%
2022-05-14 00:04:16,675 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.944, Base Lr: 1.19e-03
2022-05-14 00:04:22,276 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.070, Acc: 0.940, Base Lr: 1.19e-03
2022-05-14 00:04:26,400 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.058[s] Speed: 276.3[samples/s]
2022-05-14 00:04:35,828 reid_baseline.train INFO: normal accuracy 0.6827358879274825 2.3371317386627197 
2022-05-14 00:04:38,910 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-14 00:04:38,910 reid_baseline.train INFO: Accuracy: 68.3% Mean Entropy: 233.7%
2022-05-14 00:04:45,042 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.066, Acc: 0.939, Base Lr: 7.78e-04
2022-05-14 00:04:50,617 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.057, Acc: 0.945, Base Lr: 7.78e-04
2022-05-14 00:04:54,783 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.058[s] Speed: 275.3[samples/s]
2022-05-14 00:05:04,215 reid_baseline.train INFO: normal accuracy 0.6860321384425216 2.355959177017212 
2022-05-14 00:05:04,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-14 00:05:04,217 reid_baseline.train INFO: Accuracy: 68.6% Mean Entropy: 235.6%
2022-05-14 00:05:10,310 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.066, Acc: 0.938, Base Lr: 4.51e-04
2022-05-14 00:05:15,905 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.060, Acc: 0.943, Base Lr: 4.51e-04
2022-05-14 00:05:20,097 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:05:29,597 reid_baseline.train INFO: normal accuracy 0.6864441697569015 2.318416118621826 
2022-05-14 00:05:32,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-14 00:05:32,692 reid_baseline.train INFO: Accuracy: 68.6% Mean Entropy: 231.8%
2022-05-14 00:05:38,817 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.045, Acc: 0.938, Base Lr: 2.11e-04
2022-05-14 00:05:44,454 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.053, Acc: 0.939, Base Lr: 2.11e-04
2022-05-14 00:05:48,636 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.058[s] Speed: 274.1[samples/s]
2022-05-14 00:05:58,120 reid_baseline.train INFO: normal accuracy 0.6905644829007005 2.3468117713928223 
2022-05-14 00:05:58,122 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-14 00:05:58,122 reid_baseline.train INFO: Accuracy: 69.1% Mean Entropy: 234.7%
2022-05-14 00:06:04,217 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.054, Acc: 0.939, Base Lr: 6.51e-05
2022-05-14 00:06:09,760 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.053, Acc: 0.943, Base Lr: 6.51e-05
2022-05-14 00:06:13,932 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.058[s] Speed: 276.4[samples/s]
2022-05-14 00:06:23,459 reid_baseline.train INFO: normal accuracy 0.6897404202719407 2.3522002696990967 
2022-05-14 00:06:23,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-14 00:06:23,460 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 235.2%
2022-05-14 00:06:29,479 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.065, Acc: 0.941, Base Lr: 1.60e-05
2022-05-14 00:06:35,060 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.058, Acc: 0.943, Base Lr: 1.60e-05
2022-05-14 00:06:39,227 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.058[s] Speed: 277.2[samples/s]
2022-05-14 00:06:51,775 reid_baseline.train INFO: normal accuracy 0.6889163576431809 2.357454299926758 
2022-05-14 00:06:51,777 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-14 00:06:51,778 reid_baseline.train INFO: Accuracy: 68.9% Mean Entropy: 235.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_only_q/transformer_best_model.pth
2022-05-14 00:07:04,618 reid_baseline.train INFO: normal accuracy 0.6864441697569015 2.318416118621826 
2022-05-14 00:07:04,619 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:07:04,619 reid_baseline.train INFO: Accuracy: 68.6%
2022-05-14 00:07:14,009 reid_baseline.train INFO: normal accuracy 0.6864441697569015 2.318416118621826 
2022-05-14 00:07:14,009 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:07:14,009 reid_baseline.train INFO: Shuffled Accuracy: 68.6%
2022-05-14 00:07:29,947 reid_baseline.train INFO: normal accuracy 0.961512027491409 0.874355137348175 
2022-05-14 00:07:29,948 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:07:29,948 reid_baseline.train INFO: Source Clean Accuracy: 96.2%
2022-05-14 00:07:32,596 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_q
2022-05-14 00:07:32,596 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_q', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-05-14 00:07:32,597 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-14 00:07:32,597 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-14 00:07:32,597 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_q
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-14 00:07:39,402 reid_baseline.train INFO: start training
2022-05-14 00:07:45,760 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.088, Acc: 0.345, Base Lr: 8.72e-04
2022-05-14 00:07:51,312 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 3.986, Acc: 0.453, Base Lr: 8.72e-04
2022-05-14 00:07:55,525 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.058[s] Speed: 275.5[samples/s]
2022-05-14 00:08:11,787 reid_baseline.train INFO: normal accuracy 0.5622888037846362 4.1585869789123535 
2022-05-14 00:08:14,815 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-14 00:08:14,815 reid_baseline.train INFO: Accuracy: 56.2% Mean Entropy: 415.9%
2022-05-14 00:08:20,953 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.447, Acc: 0.612, Base Lr: 1.66e-03
2022-05-14 00:08:26,569 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.273, Acc: 0.623, Base Lr: 1.66e-03
2022-05-14 00:08:30,723 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.058[s] Speed: 274.8[samples/s]
2022-05-14 00:08:46,877 reid_baseline.train INFO: normal accuracy 0.5875197116467673 3.9883761405944824 
2022-05-14 00:08:49,987 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-14 00:08:49,987 reid_baseline.train INFO: Accuracy: 58.8% Mean Entropy: 398.8%
2022-05-14 00:08:56,138 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.585, Acc: 0.660, Base Lr: 2.46e-03
2022-05-14 00:09:01,727 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.456, Acc: 0.673, Base Lr: 2.46e-03
2022-05-14 00:09:05,947 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.058[s] Speed: 274.0[samples/s]
2022-05-14 00:09:22,101 reid_baseline.train INFO: normal accuracy 0.6539761207479162 3.5198519229888916 
2022-05-14 00:09:25,208 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-14 00:09:25,208 reid_baseline.train INFO: Accuracy: 65.4% Mean Entropy: 352.0%
2022-05-14 00:09:31,366 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 1.914, Acc: 0.749, Base Lr: 3.25e-03
2022-05-14 00:09:36,955 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.888, Acc: 0.748, Base Lr: 3.25e-03
2022-05-14 00:09:41,098 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:09:57,242 reid_baseline.train INFO: normal accuracy 0.7132236990313133 3.0164036750793457 
2022-05-14 00:10:00,377 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-14 00:10:00,377 reid_baseline.train INFO: Accuracy: 71.3% Mean Entropy: 301.6%
2022-05-14 00:10:06,513 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.620, Acc: 0.796, Base Lr: 4.04e-03
2022-05-14 00:10:12,095 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.585, Acc: 0.798, Base Lr: 4.04e-03
2022-05-14 00:10:16,327 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.058[s] Speed: 274.2[samples/s]
2022-05-14 00:10:32,561 reid_baseline.train INFO: normal accuracy 0.7445370578959225 2.595425844192505 
2022-05-14 00:10:35,688 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-14 00:10:35,689 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 259.5%
2022-05-14 00:10:41,855 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.455, Acc: 0.816, Base Lr: 4.83e-03
2022-05-14 00:10:47,485 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.423, Acc: 0.826, Base Lr: 4.83e-03
2022-05-14 00:10:51,689 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.059[s] Speed: 273.3[samples/s]
2022-05-14 00:11:07,917 reid_baseline.train INFO: normal accuracy 0.7483667492678531 2.343370199203491 
2022-05-14 00:11:11,039 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-14 00:11:11,039 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 234.3%
2022-05-14 00:11:17,183 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.309, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:11:22,808 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.313, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:11:27,004 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.058[s] Speed: 273.9[samples/s]
2022-05-14 00:11:43,256 reid_baseline.train INFO: normal accuracy 0.7524217166028385 2.1786725521087646 
2022-05-14 00:11:46,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-14 00:11:46,384 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 217.9%
2022-05-14 00:11:52,502 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.216, Acc: 0.893, Base Lr: 6.42e-03
2022-05-14 00:11:58,124 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.233, Acc: 0.887, Base Lr: 6.42e-03
2022-05-14 00:12:02,272 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:12:18,462 reid_baseline.train INFO: normal accuracy 0.7526469925658932 2.0549871921539307 
2022-05-14 00:12:21,569 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-14 00:12:21,569 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 205.5%
2022-05-14 00:12:27,704 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.185, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:12:33,316 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.184, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:12:37,476 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.058[s] Speed: 274.9[samples/s]
2022-05-14 00:12:53,708 reid_baseline.train INFO: normal accuracy 0.7558008560486597 1.9523993730545044 
2022-05-14 00:12:56,794 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-14 00:12:56,795 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 195.2%
2022-05-14 00:13:02,906 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.926, Base Lr: 4.01e-03
2022-05-14 00:13:08,504 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.134, Acc: 0.916, Base Lr: 4.01e-03
2022-05-14 00:13:12,652 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.058[s] Speed: 275.8[samples/s]
2022-05-14 00:13:31,874 reid_baseline.train INFO: normal accuracy 0.758954719531426 1.9272501468658447 
2022-05-14 00:13:34,950 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-14 00:13:34,951 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 192.7%
2022-05-14 00:13:41,081 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.123, Acc: 0.920, Base Lr: 3.38e-03
2022-05-14 00:13:46,666 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.120, Acc: 0.921, Base Lr: 3.38e-03
2022-05-14 00:13:50,823 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.058[s] Speed: 275.5[samples/s]
2022-05-14 00:14:07,050 reid_baseline.train INFO: normal accuracy 0.7560261320117143 1.9514657258987427 
2022-05-14 00:14:07,053 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-14 00:14:07,053 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 195.1%
2022-05-14 00:14:13,212 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.080, Acc: 0.938, Base Lr: 2.77e-03
2022-05-14 00:14:18,840 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.093, Acc: 0.932, Base Lr: 2.77e-03
2022-05-14 00:14:23,013 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.058[s] Speed: 274.0[samples/s]
2022-05-14 00:14:39,226 reid_baseline.train INFO: normal accuracy 0.7564766839378239 1.9316729307174683 
2022-05-14 00:14:39,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-14 00:14:39,229 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 193.2%
2022-05-14 00:14:45,382 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.096, Acc: 0.934, Base Lr: 2.20e-03
2022-05-14 00:14:51,022 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.086, Acc: 0.936, Base Lr: 2.20e-03
2022-05-14 00:14:55,202 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.058[s] Speed: 273.8[samples/s]
2022-05-14 00:15:11,426 reid_baseline.train INFO: normal accuracy 0.751971164676729 1.9198126792907715 
2022-05-14 00:15:14,521 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-14 00:15:14,521 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 192.0%
2022-05-14 00:15:20,663 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.091, Acc: 0.928, Base Lr: 1.66e-03
2022-05-14 00:15:26,251 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.081, Acc: 0.932, Base Lr: 1.66e-03
2022-05-14 00:15:30,483 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.058[s] Speed: 274.0[samples/s]
2022-05-14 00:15:46,696 reid_baseline.train INFO: normal accuracy 0.7544492002703311 1.9526137113571167 
2022-05-14 00:15:46,698 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-14 00:15:46,698 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 195.3%
2022-05-14 00:15:52,862 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.944, Base Lr: 1.19e-03
2022-05-14 00:15:58,498 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.070, Acc: 0.940, Base Lr: 1.19e-03
2022-05-14 00:16:02,715 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.059[s] Speed: 273.0[samples/s]
2022-05-14 00:16:18,899 reid_baseline.train INFO: normal accuracy 0.7499436810092364 1.9186654090881348 
2022-05-14 00:16:21,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-14 00:16:21,994 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 191.9%
2022-05-14 00:16:28,108 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.066, Acc: 0.939, Base Lr: 7.78e-04
2022-05-14 00:16:33,717 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.057, Acc: 0.945, Base Lr: 7.78e-04
2022-05-14 00:16:37,880 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.058[s] Speed: 275.3[samples/s]
2022-05-14 00:16:53,984 reid_baseline.train INFO: normal accuracy 0.7564766839378239 1.9452344179153442 
2022-05-14 00:16:53,986 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-14 00:16:53,986 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 194.5%
2022-05-14 00:17:00,094 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.066, Acc: 0.938, Base Lr: 4.51e-04
2022-05-14 00:17:05,673 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.060, Acc: 0.943, Base Lr: 4.51e-04
2022-05-14 00:17:09,865 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.058[s] Speed: 275.4[samples/s]
2022-05-14 00:17:26,100 reid_baseline.train INFO: normal accuracy 0.7530975444920027 1.9030687808990479 
2022-05-14 00:17:29,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-14 00:17:29,178 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 190.3%
2022-05-14 00:17:35,334 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.045, Acc: 0.938, Base Lr: 2.11e-04
2022-05-14 00:17:40,926 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.053, Acc: 0.939, Base Lr: 2.11e-04
2022-05-14 00:17:45,141 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.058[s] Speed: 273.9[samples/s]
2022-05-14 00:18:01,293 reid_baseline.train INFO: normal accuracy 0.75107006082451 1.9230800867080688 
2022-05-14 00:18:01,295 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-14 00:18:01,295 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 192.3%
2022-05-14 00:18:07,462 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.054, Acc: 0.939, Base Lr: 6.51e-05
2022-05-14 00:18:13,030 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.053, Acc: 0.943, Base Lr: 6.51e-05
2022-05-14 00:18:17,184 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:18:33,333 reid_baseline.train INFO: normal accuracy 0.7546744762333859 1.9331753253936768 
2022-05-14 00:18:33,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-14 00:18:33,336 reid_baseline.train INFO: Accuracy: 75.5% Mean Entropy: 193.3%
2022-05-14 00:18:39,495 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.065, Acc: 0.941, Base Lr: 1.60e-05
2022-05-14 00:18:45,140 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.058, Acc: 0.943, Base Lr: 1.60e-05
2022-05-14 00:18:49,305 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.058[s] Speed: 273.8[samples/s]
2022-05-14 00:19:08,547 reid_baseline.train INFO: normal accuracy 0.7508447848614552 1.9356410503387451 
2022-05-14 00:19:08,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-14 00:19:08,549 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 193.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_only_q/transformer_best_model.pth
2022-05-14 00:19:28,166 reid_baseline.train INFO: normal accuracy 0.7530975444920027 1.9030687808990479 
2022-05-14 00:19:28,167 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:19:28,167 reid_baseline.train INFO: Accuracy: 75.3%
2022-05-14 00:19:44,402 reid_baseline.train INFO: normal accuracy 0.7530975444920027 1.9030687808990479 
2022-05-14 00:19:44,402 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:19:44,402 reid_baseline.train INFO: Shuffled Accuracy: 75.3%
2022-05-14 00:20:00,382 reid_baseline.train INFO: normal accuracy 0.961512027491409 0.874355137348175 
2022-05-14 00:20:00,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:20:00,382 reid_baseline.train INFO: Source Clean Accuracy: 96.2%
2022-05-14 00:20:03,074 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_q
2022-05-14 00:20:03,074 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_q', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-05-14 00:20:03,074 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-14 00:20:03,075 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-14 00:20:03,075 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_q
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-05-14 00:20:09,832 reid_baseline.train INFO: start training
2022-05-14 00:20:16,244 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.088, Acc: 0.345, Base Lr: 8.72e-04
2022-05-14 00:20:21,845 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 3.986, Acc: 0.453, Base Lr: 8.72e-04
2022-05-14 00:20:26,054 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.058[s] Speed: 273.9[samples/s]
2022-05-14 00:20:44,271 reid_baseline.train INFO: normal accuracy 0.5584117512049576 4.161073207855225 
2022-05-14 00:20:47,293 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-14 00:20:47,294 reid_baseline.train INFO: Accuracy: 55.8% Mean Entropy: 416.1%
2022-05-14 00:20:53,409 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.447, Acc: 0.612, Base Lr: 1.66e-03
2022-05-14 00:20:58,997 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.273, Acc: 0.623, Base Lr: 1.66e-03
2022-05-14 00:21:03,184 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.058[s] Speed: 275.1[samples/s]
2022-05-14 00:21:21,335 reid_baseline.train INFO: normal accuracy 0.5988065182464999 4.025062561035156 
2022-05-14 00:21:24,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-14 00:21:24,452 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 402.5%
2022-05-14 00:21:30,573 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 2.585, Acc: 0.660, Base Lr: 2.46e-03
2022-05-14 00:21:36,178 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.456, Acc: 0.673, Base Lr: 2.46e-03
2022-05-14 00:21:40,371 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.058[s] Speed: 274.8[samples/s]
2022-05-14 00:21:58,554 reid_baseline.train INFO: normal accuracy 0.6672022033509295 3.6309072971343994 
2022-05-14 00:22:01,668 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-14 00:22:01,668 reid_baseline.train INFO: Accuracy: 66.7% Mean Entropy: 363.1%
2022-05-14 00:22:07,798 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 1.914, Acc: 0.749, Base Lr: 3.25e-03
2022-05-14 00:22:13,428 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 1.888, Acc: 0.748, Base Lr: 3.25e-03
2022-05-14 00:22:17,677 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.059[s] Speed: 273.2[samples/s]
2022-05-14 00:22:35,874 reid_baseline.train INFO: normal accuracy 0.7261877438604545 3.1801717281341553 
2022-05-14 00:22:38,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-14 00:22:38,982 reid_baseline.train INFO: Accuracy: 72.6% Mean Entropy: 318.0%
2022-05-14 00:22:45,105 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.620, Acc: 0.796, Base Lr: 4.04e-03
2022-05-14 00:22:50,748 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.585, Acc: 0.798, Base Lr: 4.04e-03
2022-05-14 00:22:55,001 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.059[s] Speed: 273.0[samples/s]
2022-05-14 00:23:13,166 reid_baseline.train INFO: normal accuracy 0.7631397750745926 2.77195143699646 
2022-05-14 00:23:16,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-14 00:23:16,281 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 277.2%
2022-05-14 00:23:22,408 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.455, Acc: 0.816, Base Lr: 4.83e-03
2022-05-14 00:23:27,991 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.423, Acc: 0.826, Base Lr: 4.83e-03
2022-05-14 00:23:32,172 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.058[s] Speed: 275.4[samples/s]
2022-05-14 00:23:50,439 reid_baseline.train INFO: normal accuracy 0.7753041083314207 2.5300142765045166 
2022-05-14 00:23:53,535 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-14 00:23:53,535 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 253.0%
2022-05-14 00:23:59,630 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.309, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:24:05,217 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.313, Acc: 0.862, Base Lr: 5.62e-03
2022-05-14 00:24:09,451 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.058[s] Speed: 275.2[samples/s]
2022-05-14 00:24:27,650 reid_baseline.train INFO: normal accuracy 0.7734679825568052 2.358808755874634 
2022-05-14 00:24:30,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-14 00:24:30,764 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 235.9%
2022-05-14 00:24:36,915 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.216, Acc: 0.893, Base Lr: 6.42e-03
2022-05-14 00:24:42,492 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.233, Acc: 0.887, Base Lr: 6.42e-03
2022-05-14 00:24:46,696 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.058[s] Speed: 275.0[samples/s]
2022-05-14 00:25:04,914 reid_baseline.train INFO: normal accuracy 0.7702547624512279 2.239790201187134 
2022-05-14 00:25:07,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-14 00:25:07,998 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 224.0%
2022-05-14 00:25:14,213 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.185, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:25:19,789 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.184, Acc: 0.897, Base Lr: 7.21e-03
2022-05-14 00:25:23,982 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.058[s] Speed: 274.1[samples/s]
2022-05-14 00:25:42,183 reid_baseline.train INFO: normal accuracy 0.7755336240532477 2.1246070861816406 
2022-05-14 00:25:45,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-14 00:25:45,272 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 212.5%
2022-05-14 00:25:51,472 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.926, Base Lr: 4.01e-03
2022-05-14 00:25:57,099 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.134, Acc: 0.916, Base Lr: 4.01e-03
2022-05-14 00:26:01,267 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.058[s] Speed: 273.9[samples/s]
2022-05-14 00:26:22,434 reid_baseline.train INFO: normal accuracy 0.7746155611659399 2.09391713142395 
2022-05-14 00:26:25,528 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-14 00:26:25,528 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 209.4%
2022-05-14 00:26:31,725 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.123, Acc: 0.920, Base Lr: 3.38e-03
2022-05-14 00:26:37,326 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.120, Acc: 0.921, Base Lr: 3.38e-03
2022-05-14 00:26:41,533 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.058[s] Speed: 273.7[samples/s]
2022-05-14 00:26:59,743 reid_baseline.train INFO: normal accuracy 0.7762221712187285 2.1069178581237793 
2022-05-14 00:26:59,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-14 00:26:59,745 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 210.7%
2022-05-14 00:27:05,890 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.080, Acc: 0.938, Base Lr: 2.77e-03
2022-05-14 00:27:11,493 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.093, Acc: 0.932, Base Lr: 2.77e-03
2022-05-14 00:27:15,689 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.058[s] Speed: 274.7[samples/s]
2022-05-14 00:27:33,888 reid_baseline.train INFO: normal accuracy 0.7677300895111315 2.0861968994140625 
2022-05-14 00:27:36,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-14 00:27:36,985 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 208.6%
2022-05-14 00:27:43,155 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.096, Acc: 0.934, Base Lr: 2.20e-03
2022-05-14 00:27:48,780 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.086, Acc: 0.936, Base Lr: 2.20e-03
2022-05-14 00:27:52,998 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.058[s] Speed: 273.6[samples/s]
2022-05-14 00:28:11,178 reid_baseline.train INFO: normal accuracy 0.7750745926095938 2.0611321926116943 
2022-05-14 00:28:14,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-14 00:28:14,264 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 206.1%
2022-05-14 00:28:20,493 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.091, Acc: 0.928, Base Lr: 1.66e-03
2022-05-14 00:28:26,103 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.081, Acc: 0.932, Base Lr: 1.66e-03
2022-05-14 00:28:30,333 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.059[s] Speed: 272.6[samples/s]
2022-05-14 00:28:48,504 reid_baseline.train INFO: normal accuracy 0.7704842781730549 2.086057186126709 
2022-05-14 00:28:48,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-14 00:28:48,507 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 208.6%
2022-05-14 00:28:54,651 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.062, Acc: 0.944, Base Lr: 1.19e-03
2022-05-14 00:29:00,226 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.070, Acc: 0.940, Base Lr: 1.19e-03
2022-05-14 00:29:04,403 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.058[s] Speed: 275.6[samples/s]
2022-05-14 00:29:22,639 reid_baseline.train INFO: normal accuracy 0.7732384668349782 2.060810089111328 
2022-05-14 00:29:25,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-14 00:29:25,785 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 206.1%
2022-05-14 00:29:31,937 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.066, Acc: 0.939, Base Lr: 7.78e-04
2022-05-14 00:29:37,531 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.057, Acc: 0.945, Base Lr: 7.78e-04
2022-05-14 00:29:41,738 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.058[s] Speed: 274.6[samples/s]
2022-05-14 00:29:59,909 reid_baseline.train INFO: normal accuracy 0.7720908882258435 2.081310749053955 
2022-05-14 00:29:59,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-14 00:29:59,911 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 208.1%
2022-05-14 00:30:06,101 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.066, Acc: 0.938, Base Lr: 4.51e-04
2022-05-14 00:30:11,733 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.060, Acc: 0.943, Base Lr: 4.51e-04
2022-05-14 00:30:15,942 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.059[s] Speed: 273.2[samples/s]
2022-05-14 00:30:34,066 reid_baseline.train INFO: normal accuracy 0.7691071838420932 2.0365467071533203 
2022-05-14 00:30:37,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-14 00:30:37,177 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 203.7%
2022-05-14 00:30:43,329 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.045, Acc: 0.938, Base Lr: 2.11e-04
2022-05-14 00:30:48,951 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.053, Acc: 0.939, Base Lr: 2.11e-04
2022-05-14 00:30:53,135 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.058[s] Speed: 274.5[samples/s]
2022-05-14 00:31:11,326 reid_baseline.train INFO: normal accuracy 0.7679596052329585 2.0641767978668213 
2022-05-14 00:31:11,328 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-14 00:31:11,328 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 206.4%
2022-05-14 00:31:17,526 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.054, Acc: 0.939, Base Lr: 6.51e-05
2022-05-14 00:31:23,179 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.053, Acc: 0.943, Base Lr: 6.51e-05
2022-05-14 00:31:27,382 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.059[s] Speed: 272.9[samples/s]
2022-05-14 00:31:45,500 reid_baseline.train INFO: normal accuracy 0.7709433096167088 2.069941759109497 
2022-05-14 00:31:45,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-14 00:31:45,503 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 207.0%
2022-05-14 00:31:51,616 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.065, Acc: 0.941, Base Lr: 1.60e-05
2022-05-14 00:31:57,263 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.058, Acc: 0.943, Base Lr: 1.60e-05
2022-05-14 00:32:01,428 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.058[s] Speed: 275.1[samples/s]
2022-05-14 00:32:22,611 reid_baseline.train INFO: normal accuracy 0.769795731007574 2.0785555839538574 
2022-05-14 00:32:22,612 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-14 00:32:22,612 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 207.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_only_q/transformer_best_model.pth
2022-05-14 00:32:42,424 reid_baseline.train INFO: normal accuracy 0.7691071838420932 2.0365467071533203 
2022-05-14 00:32:42,425 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:32:42,425 reid_baseline.train INFO: Accuracy: 76.9%
2022-05-14 00:33:00,430 reid_baseline.train INFO: normal accuracy 0.7691071838420932 2.0365467071533203 
2022-05-14 00:33:00,431 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:33:00,431 reid_baseline.train INFO: Shuffled Accuracy: 76.9%
2022-05-14 00:33:16,463 reid_baseline.train INFO: normal accuracy 0.961512027491409 0.874355137348175 
2022-05-14 00:33:16,463 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-14 00:33:16,464 reid_baseline.train INFO: Source Clean Accuracy: 96.2%
