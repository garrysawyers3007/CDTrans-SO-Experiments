2022-05-13 15:22:36,102 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls
2022-05-13 15:22:36,102 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Art/transformer_best_model.pth')
2022-05-13 15:22:36,102 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 15:22:36,103 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 15:22:36,103 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Art/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 15:22:44,144 reid_baseline.train INFO: start training
2022-05-13 15:22:48,403 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.368, Acc: 0.349, Base Lr: 8.72e-04
2022-05-13 15:22:51,850 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.316, Acc: 0.397, Base Lr: 8.72e-04
2022-05-13 15:22:55,295 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.265, Acc: 0.439, Base Lr: 8.72e-04
2022-05-13 15:22:58,749 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.229, Acc: 0.471, Base Lr: 8.72e-04
2022-05-13 15:23:02,104 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.197, Acc: 0.497, Base Lr: 8.72e-04
2022-05-13 15:23:05,502 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.170, Acc: 0.519, Base Lr: 8.72e-04
2022-05-13 15:23:08,887 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.150, Acc: 0.536, Base Lr: 8.72e-04
2022-05-13 15:23:11,787 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.035[s] Speed: 452.6[samples/s]
2022-05-13 15:23:24,816 reid_baseline.train INFO: normal accuracy 0.6985246953175113 1.0837581157684326 
2022-05-13 15:23:25,529 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 15:23:25,529 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 108.4%
2022-05-13 15:23:29,872 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.969, Acc: 0.660, Base Lr: 1.66e-03
2022-05-13 15:23:33,234 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.964, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 15:23:37,034 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.957, Acc: 0.676, Base Lr: 1.66e-03
2022-05-13 15:23:40,304 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.951, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 15:23:43,774 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.943, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 15:23:47,722 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.939, Acc: 0.686, Base Lr: 1.66e-03
2022-05-13 15:23:51,241 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.933, Acc: 0.690, Base Lr: 1.66e-03
2022-05-13 15:23:54,124 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.037[s] Speed: 437.2[samples/s]
2022-05-13 15:24:07,042 reid_baseline.train INFO: normal accuracy 0.7479153303399615 0.9302095770835876 
2022-05-13 15:24:07,791 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 15:24:07,791 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 93.0%
2022-05-13 15:24:11,933 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.877, Acc: 0.733, Base Lr: 2.46e-03
2022-05-13 15:24:15,291 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.884, Acc: 0.724, Base Lr: 2.46e-03
2022-05-13 15:24:18,552 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.883, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:24:21,945 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.885, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:24:25,358 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.885, Acc: 0.717, Base Lr: 2.46e-03
2022-05-13 15:24:28,735 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.884, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:24:32,127 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.884, Acc: 0.721, Base Lr: 2.46e-03
2022-05-13 15:24:34,782 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.035[s] Speed: 462.4[samples/s]
2022-05-13 15:24:47,800 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.840415358543396 
2022-05-13 15:24:48,566 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 15:24:48,566 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 84.0%
2022-05-13 15:24:52,977 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.875, Acc: 0.726, Base Lr: 3.25e-03
2022-05-13 15:24:56,301 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.865, Acc: 0.736, Base Lr: 3.25e-03
2022-05-13 15:24:59,659 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:25:03,076 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.739, Base Lr: 3.25e-03
2022-05-13 15:25:06,447 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.862, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:25:09,918 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.860, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:25:13,251 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.859, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:25:15,969 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.035[s] Speed: 455.5[samples/s]
2022-05-13 15:25:29,016 reid_baseline.train INFO: normal accuracy 0.7636305323925593 0.8318294286727905 
2022-05-13 15:25:29,760 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 15:25:29,760 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 83.2%
2022-05-13 15:25:33,940 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.840, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 15:25:37,249 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.852, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 15:25:40,512 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.849, Acc: 0.744, Base Lr: 4.04e-03
2022-05-13 15:25:43,762 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.858, Acc: 0.737, Base Lr: 4.04e-03
2022-05-13 15:25:47,298 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:25:50,776 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:25:54,362 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.859, Acc: 0.736, Base Lr: 4.04e-03
2022-05-13 15:25:57,078 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.035[s] Speed: 457.0[samples/s]
2022-05-13 15:26:10,162 reid_baseline.train INFO: normal accuracy 0.7710070558050032 0.7999117374420166 
2022-05-13 15:26:10,979 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 15:26:10,979 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 80.0%
2022-05-13 15:26:15,102 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.836, Acc: 0.751, Base Lr: 4.83e-03
2022-05-13 15:26:18,441 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.858, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:26:21,806 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.852, Acc: 0.743, Base Lr: 4.83e-03
2022-05-13 15:26:25,272 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.856, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:26:28,631 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.865, Acc: 0.736, Base Lr: 4.83e-03
2022-05-13 15:26:32,001 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:26:35,332 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:26:38,022 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.035[s] Speed: 461.6[samples/s]
2022-05-13 15:26:50,944 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.775780439376831 
2022-05-13 15:26:51,850 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 15:26:51,851 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 77.6%
2022-05-13 15:26:56,302 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.845, Acc: 0.751, Base Lr: 5.62e-03
2022-05-13 15:26:59,597 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.844, Acc: 0.745, Base Lr: 5.62e-03
2022-05-13 15:27:02,912 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 5.62e-03
2022-05-13 15:27:06,247 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.860, Acc: 0.738, Base Lr: 5.62e-03
2022-05-13 15:27:09,504 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.864, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:27:12,735 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:27:15,970 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.864, Acc: 0.735, Base Lr: 5.62e-03
2022-05-13 15:27:18,994 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.035[s] Speed: 459.8[samples/s]
2022-05-13 15:27:32,180 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.7559989094734192 
2022-05-13 15:27:32,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 15:27:32,942 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 75.6%
2022-05-13 15:27:37,181 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.867, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:27:40,524 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.865, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:27:43,899 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.854, Acc: 0.747, Base Lr: 6.42e-03
2022-05-13 15:27:47,114 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.859, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 15:27:50,817 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.867, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:27:54,288 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:27:57,609 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:28:00,665 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.035[s] Speed: 450.8[samples/s]
2022-05-13 15:28:13,830 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.7614196538925171 
2022-05-13 15:28:13,830 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 15:28:13,830 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 76.1%
2022-05-13 15:28:18,061 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.845, Acc: 0.749, Base Lr: 7.21e-03
2022-05-13 15:28:21,581 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.864, Acc: 0.744, Base Lr: 7.21e-03
2022-05-13 15:28:24,865 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.857, Acc: 0.743, Base Lr: 7.21e-03
2022-05-13 15:28:28,115 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.868, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 15:28:31,314 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.873, Acc: 0.734, Base Lr: 7.21e-03
2022-05-13 15:28:34,587 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.872, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 15:28:37,846 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.880, Acc: 0.733, Base Lr: 7.21e-03
2022-05-13 15:28:40,519 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.034[s] Speed: 468.4[samples/s]
2022-05-13 15:28:53,621 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:28:54,427 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 15:28:54,427 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 75.2%
2022-05-13 15:28:58,542 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.836, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 15:29:01,844 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.844, Acc: 0.748, Base Lr: 4.01e-03
2022-05-13 15:29:05,321 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.845, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 15:29:08,938 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.850, Acc: 0.749, Base Lr: 4.01e-03
2022-05-13 15:29:12,437 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 15:29:15,807 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 15:29:19,197 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.857, Acc: 0.745, Base Lr: 4.01e-03
2022-05-13 15:29:22,001 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.035[s] Speed: 452.7[samples/s]
2022-05-13 15:29:35,714 reid_baseline.train INFO: normal accuracy 0.7694034637588197 0.7607062458992004 
2022-05-13 15:29:35,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 15:29:35,714 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 76.1%
2022-05-13 15:29:39,902 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.818, Acc: 0.772, Base Lr: 3.38e-03
2022-05-13 15:29:43,298 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.832, Acc: 0.758, Base Lr: 3.38e-03
2022-05-13 15:29:46,637 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.832, Acc: 0.757, Base Lr: 3.38e-03
2022-05-13 15:29:50,470 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.833, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:29:53,722 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.835, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:29:57,003 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.844, Acc: 0.752, Base Lr: 3.38e-03
2022-05-13 15:30:00,326 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.841, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 15:30:02,983 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.035[s] Speed: 457.8[samples/s]
2022-05-13 15:30:15,932 reid_baseline.train INFO: normal accuracy 0.77325208466966 0.7601624727249146 
2022-05-13 15:30:15,933 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 15:30:15,933 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.0%
2022-05-13 15:30:20,478 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.836, Acc: 0.749, Base Lr: 2.77e-03
2022-05-13 15:30:23,780 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.837, Acc: 0.753, Base Lr: 2.77e-03
2022-05-13 15:30:27,303 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:30:30,640 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.833, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:30:34,005 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.836, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:30:37,352 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:30:40,677 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.77e-03
2022-05-13 15:30:43,426 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.035[s] Speed: 455.1[samples/s]
2022-05-13 15:30:56,394 reid_baseline.train INFO: normal accuracy 0.7780628608082104 0.7607043385505676 
2022-05-13 15:30:56,395 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 15:30:56,395 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 76.1%
2022-05-13 15:31:00,681 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.819, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 15:31:04,290 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.815, Acc: 0.773, Base Lr: 2.20e-03
2022-05-13 15:31:07,772 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.817, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 15:31:11,140 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 15:31:14,477 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.831, Acc: 0.760, Base Lr: 2.20e-03
2022-05-13 15:31:17,817 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.829, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 15:31:21,599 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.20e-03
2022-05-13 15:31:24,273 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.036[s] Speed: 448.9[samples/s]
2022-05-13 15:31:37,354 reid_baseline.train INFO: normal accuracy 0.7831943553559975 0.7872423529624939 
2022-05-13 15:31:37,355 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 15:31:37,355 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 78.7%
2022-05-13 15:31:41,700 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.807, Acc: 0.761, Base Lr: 1.66e-03
2022-05-13 15:31:44,973 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.799, Acc: 0.773, Base Lr: 1.66e-03
2022-05-13 15:31:48,568 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.810, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 15:31:52,117 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.824, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 15:31:55,571 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.827, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 15:31:59,372 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.825, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 15:32:02,791 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.826, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 15:32:05,542 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.036[s] Speed: 443.1[samples/s]
2022-05-13 15:32:18,617 reid_baseline.train INFO: normal accuracy 0.7841565105837075 0.7571505904197693 
2022-05-13 15:32:18,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 15:32:18,618 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 75.7%
2022-05-13 15:32:22,847 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.811, Acc: 0.778, Base Lr: 1.19e-03
2022-05-13 15:32:26,568 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.816, Acc: 0.772, Base Lr: 1.19e-03
2022-05-13 15:32:29,983 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.813, Acc: 0.771, Base Lr: 1.19e-03
2022-05-13 15:32:33,578 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.814, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 15:32:36,886 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.815, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 15:32:40,178 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.818, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 15:32:43,904 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.819, Acc: 0.762, Base Lr: 1.19e-03
2022-05-13 15:32:46,767 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.036[s] Speed: 443.4[samples/s]
2022-05-13 15:32:59,779 reid_baseline.train INFO: normal accuracy 0.7822322001282873 0.766720712184906 
2022-05-13 15:32:59,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 15:32:59,780 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 76.7%
2022-05-13 15:33:03,812 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.822, Acc: 0.758, Base Lr: 7.78e-04
2022-05-13 15:33:07,231 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.813, Acc: 0.766, Base Lr: 7.78e-04
2022-05-13 15:33:10,488 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.809, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 15:33:13,834 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.810, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 15:33:17,218 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.817, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:33:20,593 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.814, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:33:23,939 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.815, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:33:26,657 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.034[s] Speed: 464.4[samples/s]
2022-05-13 15:33:39,780 reid_baseline.train INFO: normal accuracy 0.7854393842206543 0.769970715045929 
2022-05-13 15:33:39,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 15:33:39,780 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 77.0%
2022-05-13 15:33:44,060 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.806, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 15:33:47,446 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.809, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 15:33:50,846 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.805, Acc: 0.773, Base Lr: 4.51e-04
2022-05-13 15:33:54,291 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.813, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 15:33:57,855 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.811, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 15:34:01,229 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.810, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 15:34:04,517 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.810, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 15:34:07,304 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.035[s] Speed: 453.5[samples/s]
2022-05-13 15:34:20,339 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7585982084274292 
2022-05-13 15:34:20,339 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 15:34:20,340 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 75.9%
2022-05-13 15:34:24,818 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.822, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 15:34:28,067 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.823, Acc: 0.764, Base Lr: 2.11e-04
2022-05-13 15:34:31,325 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.809, Acc: 0.772, Base Lr: 2.11e-04
2022-05-13 15:34:34,577 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.813, Acc: 0.770, Base Lr: 2.11e-04
2022-05-13 15:34:38,002 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.812, Acc: 0.769, Base Lr: 2.11e-04
2022-05-13 15:34:41,651 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.815, Acc: 0.766, Base Lr: 2.11e-04
2022-05-13 15:34:45,071 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.812, Acc: 0.767, Base Lr: 2.11e-04
2022-05-13 15:34:47,780 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.035[s] Speed: 456.8[samples/s]
2022-05-13 15:35:00,907 reid_baseline.train INFO: normal accuracy 0.7835150737652341 0.7696419954299927 
2022-05-13 15:35:00,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 15:35:00,907 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 77.0%
2022-05-13 15:35:05,386 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.769, Acc: 0.787, Base Lr: 6.51e-05
2022-05-13 15:35:08,978 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.801, Acc: 0.772, Base Lr: 6.51e-05
2022-05-13 15:35:12,311 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.801, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 15:35:15,760 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.802, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 15:35:19,058 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.804, Acc: 0.775, Base Lr: 6.51e-05
2022-05-13 15:35:22,523 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.807, Acc: 0.773, Base Lr: 6.51e-05
2022-05-13 15:35:25,903 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.808, Acc: 0.771, Base Lr: 6.51e-05
2022-05-13 15:35:28,657 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.035[s] Speed: 451.9[samples/s]
2022-05-13 15:35:41,715 reid_baseline.train INFO: normal accuracy 0.7924951892238614 0.7754571437835693 
2022-05-13 15:35:41,716 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 15:35:41,716 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 77.5%
2022-05-13 15:35:46,108 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.810, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 15:35:49,515 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.816, Acc: 0.767, Base Lr: 1.60e-05
2022-05-13 15:35:52,911 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.818, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:35:56,310 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 15:35:59,604 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:36:03,484 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.811, Acc: 0.766, Base Lr: 1.60e-05
2022-05-13 15:36:06,754 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.812, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:36:09,437 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.035[s] Speed: 451.4[samples/s]
2022-05-13 15:36:23,387 reid_baseline.train INFO: normal accuracy 0.791853752405388 0.7856165170669556 
2022-05-13 15:36:23,387 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 15:36:23,387 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 78.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls/transformer_best_model.pth
2022-05-13 15:36:37,179 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:36:37,179 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:36:37,180 reid_baseline.train INFO: Accuracy: 75.2%
2022-05-13 15:36:50,255 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:36:50,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:36:50,256 reid_baseline.train INFO: Shuffled Accuracy: 75.2%
2022-05-13 15:37:37,808 reid_baseline.train INFO: normal accuracy 0.7821170809943865 0.7411313652992249 
2022-05-13 15:37:37,809 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:37:37,809 reid_baseline.train INFO: Source Clean Accuracy: 78.2%
2022-05-13 15:37:42,983 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls
2022-05-13 15:37:42,983 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Product/transformer_best_model.pth')
2022-05-13 15:37:42,983 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 15:37:42,983 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 15:37:42,983 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Product/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 15:37:53,024 reid_baseline.train INFO: start training
2022-05-13 15:37:57,516 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.368, Acc: 0.349, Base Lr: 8.72e-04
2022-05-13 15:38:01,128 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.316, Acc: 0.397, Base Lr: 8.72e-04
2022-05-13 15:38:04,709 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.265, Acc: 0.439, Base Lr: 8.72e-04
2022-05-13 15:38:08,201 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.229, Acc: 0.471, Base Lr: 8.72e-04
2022-05-13 15:38:11,826 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.197, Acc: 0.497, Base Lr: 8.72e-04
2022-05-13 15:38:15,322 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.170, Acc: 0.519, Base Lr: 8.72e-04
2022-05-13 15:38:18,807 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.150, Acc: 0.536, Base Lr: 8.72e-04
2022-05-13 15:38:21,854 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.037[s] Speed: 434.1[samples/s]
2022-05-13 15:38:35,053 reid_baseline.train INFO: normal accuracy 0.6985246953175113 1.0837581157684326 
2022-05-13 15:38:35,811 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 15:38:35,811 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 108.4%
2022-05-13 15:38:40,300 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.969, Acc: 0.660, Base Lr: 1.66e-03
2022-05-13 15:38:43,575 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.964, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 15:38:46,875 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.957, Acc: 0.676, Base Lr: 1.66e-03
2022-05-13 15:38:50,128 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.951, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 15:38:53,455 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.943, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 15:38:56,700 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.939, Acc: 0.686, Base Lr: 1.66e-03
2022-05-13 15:38:59,941 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.933, Acc: 0.690, Base Lr: 1.66e-03
2022-05-13 15:39:02,627 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.034[s] Speed: 465.5[samples/s]
2022-05-13 15:39:15,800 reid_baseline.train INFO: normal accuracy 0.7479153303399615 0.9302095770835876 
2022-05-13 15:39:16,572 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 15:39:16,572 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 93.0%
2022-05-13 15:39:21,018 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.877, Acc: 0.733, Base Lr: 2.46e-03
2022-05-13 15:39:24,452 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.884, Acc: 0.724, Base Lr: 2.46e-03
2022-05-13 15:39:27,857 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.883, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:39:31,197 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.885, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:39:34,568 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.885, Acc: 0.717, Base Lr: 2.46e-03
2022-05-13 15:39:38,045 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.884, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:39:41,568 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.884, Acc: 0.721, Base Lr: 2.46e-03
2022-05-13 15:39:44,361 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.036[s] Speed: 449.1[samples/s]
2022-05-13 15:39:57,529 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.840415358543396 
2022-05-13 15:39:58,307 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 15:39:58,314 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 84.0%
2022-05-13 15:40:02,949 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.875, Acc: 0.726, Base Lr: 3.25e-03
2022-05-13 15:40:06,571 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.865, Acc: 0.736, Base Lr: 3.25e-03
2022-05-13 15:40:10,187 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:40:13,488 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.739, Base Lr: 3.25e-03
2022-05-13 15:40:16,952 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.862, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:40:20,555 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.860, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:40:25,337 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.859, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:40:28,055 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.038[s] Speed: 421.4[samples/s]
2022-05-13 15:40:41,194 reid_baseline.train INFO: normal accuracy 0.7636305323925593 0.8318294286727905 
2022-05-13 15:40:41,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 15:40:41,967 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 83.2%
2022-05-13 15:40:46,330 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.840, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 15:40:49,714 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.852, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 15:40:53,040 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.849, Acc: 0.744, Base Lr: 4.04e-03
2022-05-13 15:40:56,416 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.858, Acc: 0.737, Base Lr: 4.04e-03
2022-05-13 15:40:59,755 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:41:03,064 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:41:06,440 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.859, Acc: 0.736, Base Lr: 4.04e-03
2022-05-13 15:41:09,200 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.035[s] Speed: 458.4[samples/s]
2022-05-13 15:41:22,358 reid_baseline.train INFO: normal accuracy 0.7710070558050032 0.7999117374420166 
2022-05-13 15:41:23,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 15:41:23,165 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 80.0%
2022-05-13 15:41:29,268 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.836, Acc: 0.751, Base Lr: 4.83e-03
2022-05-13 15:41:32,596 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.858, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:41:35,918 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.852, Acc: 0.743, Base Lr: 4.83e-03
2022-05-13 15:41:39,691 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.856, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:41:42,980 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.865, Acc: 0.736, Base Lr: 4.83e-03
2022-05-13 15:41:46,253 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:41:49,497 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:41:52,369 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.037[s] Speed: 429.2[samples/s]
2022-05-13 15:42:06,058 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.775780439376831 
2022-05-13 15:42:06,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 15:42:06,884 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 77.6%
2022-05-13 15:42:11,194 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.845, Acc: 0.751, Base Lr: 5.62e-03
2022-05-13 15:42:14,572 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.844, Acc: 0.745, Base Lr: 5.62e-03
2022-05-13 15:42:17,994 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 5.62e-03
2022-05-13 15:42:21,518 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.860, Acc: 0.738, Base Lr: 5.62e-03
2022-05-13 15:42:24,862 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.864, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:42:28,196 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:42:31,524 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.864, Acc: 0.735, Base Lr: 5.62e-03
2022-05-13 15:42:35,682 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.037[s] Speed: 433.4[samples/s]
2022-05-13 15:42:48,861 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.7559989094734192 
2022-05-13 15:42:49,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 15:42:49,636 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 75.6%
2022-05-13 15:42:54,926 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.867, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:42:58,866 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.865, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:43:02,328 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.854, Acc: 0.747, Base Lr: 6.42e-03
2022-05-13 15:43:07,468 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.859, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 15:43:11,001 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.867, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:43:14,426 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:43:17,705 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:43:20,390 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.039[s] Speed: 406.1[samples/s]
2022-05-13 15:43:33,847 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.7614196538925171 
2022-05-13 15:43:33,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 15:43:33,848 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 76.1%
2022-05-13 15:43:38,091 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.845, Acc: 0.749, Base Lr: 7.21e-03
2022-05-13 15:43:41,551 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.864, Acc: 0.744, Base Lr: 7.21e-03
2022-05-13 15:43:44,925 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.857, Acc: 0.743, Base Lr: 7.21e-03
2022-05-13 15:43:48,273 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.868, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 15:43:51,580 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.873, Acc: 0.734, Base Lr: 7.21e-03
2022-05-13 15:43:54,987 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.872, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 15:43:58,420 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.880, Acc: 0.733, Base Lr: 7.21e-03
2022-05-13 15:44:02,181 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.036[s] Speed: 440.5[samples/s]
2022-05-13 15:44:15,925 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:44:16,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 15:44:16,738 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 75.2%
2022-05-13 15:44:21,057 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.836, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 15:44:24,430 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.844, Acc: 0.748, Base Lr: 4.01e-03
2022-05-13 15:44:27,777 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.845, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 15:44:31,125 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.850, Acc: 0.749, Base Lr: 4.01e-03
2022-05-13 15:44:34,551 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 15:44:39,432 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 15:44:43,026 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.857, Acc: 0.745, Base Lr: 4.01e-03
2022-05-13 15:44:45,752 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.037[s] Speed: 430.2[samples/s]
2022-05-13 15:45:00,886 reid_baseline.train INFO: normal accuracy 0.7694034637588197 0.7607062458992004 
2022-05-13 15:45:00,887 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 15:45:00,887 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 76.1%
2022-05-13 15:45:05,083 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.818, Acc: 0.772, Base Lr: 3.38e-03
2022-05-13 15:45:08,352 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.832, Acc: 0.758, Base Lr: 3.38e-03
2022-05-13 15:45:11,851 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.832, Acc: 0.757, Base Lr: 3.38e-03
2022-05-13 15:45:15,246 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.833, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:45:18,694 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.835, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:45:22,050 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.844, Acc: 0.752, Base Lr: 3.38e-03
2022-05-13 15:45:27,000 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.841, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 15:45:29,776 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.037[s] Speed: 432.1[samples/s]
2022-05-13 15:45:42,919 reid_baseline.train INFO: normal accuracy 0.77325208466966 0.7601624727249146 
2022-05-13 15:45:42,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 15:45:42,920 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.0%
2022-05-13 15:45:48,147 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.836, Acc: 0.749, Base Lr: 2.77e-03
2022-05-13 15:45:51,681 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.837, Acc: 0.753, Base Lr: 2.77e-03
2022-05-13 15:45:57,035 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:46:00,370 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.833, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:46:03,780 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.836, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:46:07,095 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:46:10,540 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.77e-03
2022-05-13 15:46:13,275 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.039[s] Speed: 411.2[samples/s]
2022-05-13 15:46:27,216 reid_baseline.train INFO: normal accuracy 0.7780628608082104 0.7607043385505676 
2022-05-13 15:46:27,217 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 15:46:27,217 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 76.1%
2022-05-13 15:46:31,520 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.819, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 15:46:35,024 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.815, Acc: 0.773, Base Lr: 2.20e-03
2022-05-13 15:46:38,334 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.817, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 15:46:41,660 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 15:46:45,087 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.831, Acc: 0.760, Base Lr: 2.20e-03
2022-05-13 15:46:48,405 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.829, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 15:46:53,318 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.20e-03
2022-05-13 15:46:56,076 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.037[s] Speed: 432.5[samples/s]
2022-05-13 15:47:09,895 reid_baseline.train INFO: normal accuracy 0.7831943553559975 0.7872423529624939 
2022-05-13 15:47:09,895 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 15:47:09,896 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 78.7%
2022-05-13 15:47:14,797 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.807, Acc: 0.761, Base Lr: 1.66e-03
2022-05-13 15:47:18,098 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.799, Acc: 0.773, Base Lr: 1.66e-03
2022-05-13 15:47:21,488 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.810, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 15:47:25,088 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.824, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 15:47:28,513 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.827, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 15:47:34,193 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.825, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 15:47:37,830 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.826, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 15:47:40,639 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.039[s] Speed: 407.1[samples/s]
2022-05-13 15:47:54,135 reid_baseline.train INFO: normal accuracy 0.7841565105837075 0.7571505904197693 
2022-05-13 15:47:54,135 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 15:47:54,135 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 75.7%
2022-05-13 15:47:58,511 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.811, Acc: 0.778, Base Lr: 1.19e-03
2022-05-13 15:48:01,840 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.816, Acc: 0.772, Base Lr: 1.19e-03
2022-05-13 15:48:05,546 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.813, Acc: 0.771, Base Lr: 1.19e-03
2022-05-13 15:48:08,942 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.814, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 15:48:13,467 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.815, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 15:48:16,870 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.818, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 15:48:20,427 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.819, Acc: 0.762, Base Lr: 1.19e-03
2022-05-13 15:48:23,426 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.038[s] Speed: 426.4[samples/s]
2022-05-13 15:48:37,642 reid_baseline.train INFO: normal accuracy 0.7822322001282873 0.766720712184906 
2022-05-13 15:48:37,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 15:48:37,643 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 76.7%
2022-05-13 15:48:42,118 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.822, Acc: 0.758, Base Lr: 7.78e-04
2022-05-13 15:48:45,689 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.813, Acc: 0.766, Base Lr: 7.78e-04
2022-05-13 15:48:49,245 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.809, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 15:48:54,204 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.810, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 15:48:57,627 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.817, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:49:00,969 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.814, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:49:04,237 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.815, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 15:49:08,523 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.040[s] Speed: 404.3[samples/s]
2022-05-13 15:49:21,653 reid_baseline.train INFO: normal accuracy 0.7854393842206543 0.769970715045929 
2022-05-13 15:49:21,654 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 15:49:21,654 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 77.0%
2022-05-13 15:49:26,193 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.806, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 15:49:29,551 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.809, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 15:49:32,851 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.805, Acc: 0.773, Base Lr: 4.51e-04
2022-05-13 15:49:36,183 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.813, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 15:49:39,762 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.811, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 15:49:44,722 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.810, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 15:49:48,129 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.810, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 15:49:51,022 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.038[s] Speed: 425.3[samples/s]
2022-05-13 15:50:04,508 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7585982084274292 
2022-05-13 15:50:04,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 15:50:04,508 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 75.9%
2022-05-13 15:50:09,145 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.822, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 15:50:12,447 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.823, Acc: 0.764, Base Lr: 2.11e-04
2022-05-13 15:50:15,752 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.809, Acc: 0.772, Base Lr: 2.11e-04
2022-05-13 15:50:19,359 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.813, Acc: 0.770, Base Lr: 2.11e-04
2022-05-13 15:50:23,762 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.812, Acc: 0.769, Base Lr: 2.11e-04
2022-05-13 15:50:27,432 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.815, Acc: 0.766, Base Lr: 2.11e-04
2022-05-13 15:50:33,269 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.812, Acc: 0.767, Base Lr: 2.11e-04
2022-05-13 15:50:36,049 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.040[s] Speed: 398.2[samples/s]
2022-05-13 15:50:49,559 reid_baseline.train INFO: normal accuracy 0.7835150737652341 0.7696419954299927 
2022-05-13 15:50:49,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 15:50:49,560 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 77.0%
2022-05-13 15:50:54,385 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.769, Acc: 0.787, Base Lr: 6.51e-05
2022-05-13 15:50:57,672 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.801, Acc: 0.772, Base Lr: 6.51e-05
2022-05-13 15:51:00,993 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.801, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 15:51:04,279 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.802, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 15:51:07,568 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.804, Acc: 0.775, Base Lr: 6.51e-05
2022-05-13 15:51:11,572 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.807, Acc: 0.773, Base Lr: 6.51e-05
2022-05-13 15:51:15,504 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.808, Acc: 0.771, Base Lr: 6.51e-05
2022-05-13 15:51:18,248 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.037[s] Speed: 435.1[samples/s]
2022-05-13 15:51:31,444 reid_baseline.train INFO: normal accuracy 0.7924951892238614 0.7754571437835693 
2022-05-13 15:51:31,445 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 15:51:31,445 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 77.5%
2022-05-13 15:51:35,629 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.810, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 15:51:38,891 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.816, Acc: 0.767, Base Lr: 1.60e-05
2022-05-13 15:51:43,581 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.818, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:51:47,057 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 15:51:50,725 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:51:54,191 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.811, Acc: 0.766, Base Lr: 1.60e-05
2022-05-13 15:51:57,460 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.812, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:52:00,158 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.037[s] Speed: 434.8[samples/s]
2022-05-13 15:52:14,209 reid_baseline.train INFO: normal accuracy 0.791853752405388 0.7856165170669556 
2022-05-13 15:52:14,209 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 15:52:14,209 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 78.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls/transformer_best_model.pth
2022-05-13 15:52:27,836 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:52:27,837 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:52:27,837 reid_baseline.train INFO: Accuracy: 75.2%
2022-05-13 15:52:41,001 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 15:52:41,002 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:52:41,002 reid_baseline.train INFO: Shuffled Accuracy: 75.2%
2022-05-13 15:53:28,949 reid_baseline.train INFO: normal accuracy 0.7821170809943865 0.7411313652992249 
2022-05-13 15:53:28,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:53:28,950 reid_baseline.train INFO: Source Clean Accuracy: 78.2%
2022-05-13 15:53:33,979 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls
2022-05-13 15:53:33,979 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Real_World/transformer_best_model.pth')
2022-05-13 15:53:33,979 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 15:53:33,979 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 15:53:33,980 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2Real_World/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 15:53:45,138 reid_baseline.train INFO: start training
2022-05-13 15:53:49,605 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.368, Acc: 0.349, Base Lr: 8.72e-04
2022-05-13 15:53:53,121 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.316, Acc: 0.397, Base Lr: 8.72e-04
2022-05-13 15:53:56,469 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.265, Acc: 0.439, Base Lr: 8.72e-04
2022-05-13 15:54:00,196 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.229, Acc: 0.471, Base Lr: 8.72e-04
2022-05-13 15:54:03,692 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.197, Acc: 0.497, Base Lr: 8.72e-04
2022-05-13 15:54:06,990 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.170, Acc: 0.519, Base Lr: 8.72e-04
2022-05-13 15:54:10,339 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.150, Acc: 0.536, Base Lr: 8.72e-04
2022-05-13 15:54:13,108 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.036[s] Speed: 447.5[samples/s]
2022-05-13 15:54:26,381 reid_baseline.train INFO: normal accuracy 0.6985246953175113 1.0837581157684326 
2022-05-13 15:54:27,143 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 15:54:27,144 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 108.4%
2022-05-13 15:54:31,559 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.969, Acc: 0.660, Base Lr: 1.66e-03
2022-05-13 15:54:34,931 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.964, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 15:54:38,315 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.957, Acc: 0.676, Base Lr: 1.66e-03
2022-05-13 15:54:41,684 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.951, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 15:54:45,167 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.943, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 15:54:48,671 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.939, Acc: 0.686, Base Lr: 1.66e-03
2022-05-13 15:54:52,769 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.933, Acc: 0.690, Base Lr: 1.66e-03
2022-05-13 15:54:55,593 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.036[s] Speed: 438.8[samples/s]
2022-05-13 15:55:09,375 reid_baseline.train INFO: normal accuracy 0.7479153303399615 0.9302095770835876 
2022-05-13 15:55:10,148 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 15:55:10,148 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 93.0%
2022-05-13 15:55:14,582 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.877, Acc: 0.733, Base Lr: 2.46e-03
2022-05-13 15:55:18,365 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.884, Acc: 0.724, Base Lr: 2.46e-03
2022-05-13 15:55:21,725 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.883, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:55:25,326 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.885, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:55:28,689 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.885, Acc: 0.717, Base Lr: 2.46e-03
2022-05-13 15:55:33,508 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.884, Acc: 0.720, Base Lr: 2.46e-03
2022-05-13 15:55:36,858 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.884, Acc: 0.721, Base Lr: 2.46e-03
2022-05-13 15:55:39,519 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.038[s] Speed: 425.0[samples/s]
2022-05-13 15:55:52,756 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.840415358543396 
2022-05-13 15:55:53,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 15:55:53,549 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 84.0%
2022-05-13 15:55:58,168 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.875, Acc: 0.726, Base Lr: 3.25e-03
2022-05-13 15:56:01,530 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.865, Acc: 0.736, Base Lr: 3.25e-03
2022-05-13 15:56:04,792 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:56:08,170 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.739, Base Lr: 3.25e-03
2022-05-13 15:56:13,133 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.862, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:56:16,978 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.860, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:56:20,352 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.859, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:56:23,133 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.038[s] Speed: 422.3[samples/s]
2022-05-13 15:56:36,499 reid_baseline.train INFO: normal accuracy 0.7636305323925593 0.8318294286727905 
2022-05-13 15:56:37,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 15:56:37,287 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 83.2%
2022-05-13 15:56:41,727 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.840, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 15:56:45,245 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.852, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 15:56:49,008 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.849, Acc: 0.744, Base Lr: 4.04e-03
2022-05-13 15:56:53,785 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.858, Acc: 0.737, Base Lr: 4.04e-03
2022-05-13 15:56:57,241 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:57:00,558 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.860, Acc: 0.735, Base Lr: 4.04e-03
2022-05-13 15:57:03,942 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.859, Acc: 0.736, Base Lr: 4.04e-03
2022-05-13 15:57:08,384 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.040[s] Speed: 401.4[samples/s]
2022-05-13 15:57:21,499 reid_baseline.train INFO: normal accuracy 0.7710070558050032 0.7999117374420166 
2022-05-13 15:57:22,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 15:57:22,729 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 80.0%
2022-05-13 15:57:27,151 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.836, Acc: 0.751, Base Lr: 4.83e-03
2022-05-13 15:57:32,122 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.858, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:57:35,609 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.852, Acc: 0.743, Base Lr: 4.83e-03
2022-05-13 15:57:38,982 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.856, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:57:42,314 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.865, Acc: 0.736, Base Lr: 4.83e-03
2022-05-13 15:57:45,619 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:57:48,888 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.864, Acc: 0.738, Base Lr: 4.83e-03
2022-05-13 15:57:51,594 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.037[s] Speed: 432.4[samples/s]
2022-05-13 15:58:05,205 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.775780439376831 
2022-05-13 15:58:06,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 15:58:06,008 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 77.6%
2022-05-13 15:58:10,370 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.845, Acc: 0.751, Base Lr: 5.62e-03
2022-05-13 15:58:13,658 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.844, Acc: 0.745, Base Lr: 5.62e-03
2022-05-13 15:58:17,009 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.861, Acc: 0.737, Base Lr: 5.62e-03
2022-05-13 15:58:21,933 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.860, Acc: 0.738, Base Lr: 5.62e-03
2022-05-13 15:58:25,245 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.864, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:58:31,085 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 5.62e-03
2022-05-13 15:58:34,812 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.864, Acc: 0.735, Base Lr: 5.62e-03
2022-05-13 15:58:37,895 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.041[s] Speed: 391.4[samples/s]
2022-05-13 15:58:51,012 reid_baseline.train INFO: normal accuracy 0.7713277742142399 0.7559989094734192 
2022-05-13 15:58:51,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 15:58:51,785 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 75.6%
2022-05-13 15:58:56,174 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.867, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:58:59,661 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.865, Acc: 0.739, Base Lr: 6.42e-03
2022-05-13 15:59:02,981 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.854, Acc: 0.747, Base Lr: 6.42e-03
2022-05-13 15:59:06,308 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.859, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 15:59:10,582 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.867, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:59:13,937 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:59:18,118 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.870, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:59:21,500 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.038[s] Speed: 420.0[samples/s]
2022-05-13 15:59:35,128 reid_baseline.train INFO: normal accuracy 0.7594611930724824 0.7614196538925171 
2022-05-13 15:59:35,128 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 15:59:35,128 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 76.1%
2022-05-13 15:59:39,498 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.845, Acc: 0.749, Base Lr: 7.21e-03
2022-05-13 15:59:43,617 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.864, Acc: 0.744, Base Lr: 7.21e-03
2022-05-13 15:59:47,069 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.857, Acc: 0.743, Base Lr: 7.21e-03
2022-05-13 15:59:50,346 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.868, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 15:59:56,064 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.873, Acc: 0.734, Base Lr: 7.21e-03
2022-05-13 15:59:59,395 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.872, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 16:00:02,993 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.880, Acc: 0.733, Base Lr: 7.21e-03
2022-05-13 16:00:05,687 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.039[s] Speed: 408.4[samples/s]
2022-05-13 16:00:18,999 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 16:00:19,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 16:00:19,790 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 75.2%
2022-05-13 16:00:23,901 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.836, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 16:00:27,183 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.844, Acc: 0.748, Base Lr: 4.01e-03
2022-05-13 16:00:30,587 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.845, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 16:00:33,995 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.850, Acc: 0.749, Base Lr: 4.01e-03
2022-05-13 16:00:37,656 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 16:00:41,365 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.856, Acc: 0.747, Base Lr: 4.01e-03
2022-05-13 16:00:44,840 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.857, Acc: 0.745, Base Lr: 4.01e-03
2022-05-13 16:00:48,390 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.037[s] Speed: 436.5[samples/s]
2022-05-13 16:01:04,614 reid_baseline.train INFO: normal accuracy 0.7694034637588197 0.7607062458992004 
2022-05-13 16:01:04,615 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 16:01:04,615 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 76.1%
2022-05-13 16:01:09,136 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.818, Acc: 0.772, Base Lr: 3.38e-03
2022-05-13 16:01:14,033 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.832, Acc: 0.758, Base Lr: 3.38e-03
2022-05-13 16:01:17,393 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.832, Acc: 0.757, Base Lr: 3.38e-03
2022-05-13 16:01:20,923 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.833, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:01:24,292 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.835, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:01:27,662 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.844, Acc: 0.752, Base Lr: 3.38e-03
2022-05-13 16:01:31,009 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.841, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 16:01:35,583 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.040[s] Speed: 403.0[samples/s]
2022-05-13 16:01:48,826 reid_baseline.train INFO: normal accuracy 0.77325208466966 0.7601624727249146 
2022-05-13 16:01:48,826 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 16:01:48,827 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.0%
2022-05-13 16:01:52,978 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.836, Acc: 0.749, Base Lr: 2.77e-03
2022-05-13 16:01:56,233 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.837, Acc: 0.753, Base Lr: 2.77e-03
2022-05-13 16:01:59,700 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:02:03,154 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.833, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:02:06,602 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.836, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:02:09,920 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.831, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:02:15,078 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.77e-03
2022-05-13 16:02:17,824 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.037[s] Speed: 430.4[samples/s]
2022-05-13 16:02:31,261 reid_baseline.train INFO: normal accuracy 0.7780628608082104 0.7607043385505676 
2022-05-13 16:02:31,262 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 16:02:31,262 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 76.1%
2022-05-13 16:02:37,258 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.819, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 16:02:40,852 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.815, Acc: 0.773, Base Lr: 2.20e-03
2022-05-13 16:02:44,387 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.817, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 16:02:47,773 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 16:02:51,101 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.831, Acc: 0.760, Base Lr: 2.20e-03
2022-05-13 16:02:54,421 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.829, Acc: 0.759, Base Lr: 2.20e-03
2022-05-13 16:02:57,793 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.834, Acc: 0.755, Base Lr: 2.20e-03
2022-05-13 16:03:02,096 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.040[s] Speed: 404.8[samples/s]
2022-05-13 16:03:15,312 reid_baseline.train INFO: normal accuracy 0.7831943553559975 0.7872423529624939 
2022-05-13 16:03:15,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 16:03:15,313 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 78.7%
2022-05-13 16:03:19,849 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.807, Acc: 0.761, Base Lr: 1.66e-03
2022-05-13 16:03:23,190 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.799, Acc: 0.773, Base Lr: 1.66e-03
2022-05-13 16:03:27,887 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.810, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 16:03:31,307 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.824, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 16:03:34,583 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.827, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 16:03:38,035 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.825, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 16:03:41,325 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.826, Acc: 0.759, Base Lr: 1.66e-03
2022-05-13 16:03:44,081 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.037[s] Speed: 433.9[samples/s]
2022-05-13 16:03:57,508 reid_baseline.train INFO: normal accuracy 0.7841565105837075 0.7571505904197693 
2022-05-13 16:03:57,509 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 16:03:57,509 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 75.7%
2022-05-13 16:04:02,146 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.811, Acc: 0.778, Base Lr: 1.19e-03
2022-05-13 16:04:06,364 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.816, Acc: 0.772, Base Lr: 1.19e-03
2022-05-13 16:04:09,810 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.813, Acc: 0.771, Base Lr: 1.19e-03
2022-05-13 16:04:13,500 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.814, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 16:04:16,839 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.815, Acc: 0.768, Base Lr: 1.19e-03
2022-05-13 16:04:20,238 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.818, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 16:04:25,302 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.819, Acc: 0.762, Base Lr: 1.19e-03
2022-05-13 16:04:28,066 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.039[s] Speed: 409.5[samples/s]
2022-05-13 16:04:41,856 reid_baseline.train INFO: normal accuracy 0.7822322001282873 0.766720712184906 
2022-05-13 16:04:41,857 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 16:04:41,857 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 76.7%
2022-05-13 16:04:46,099 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.822, Acc: 0.758, Base Lr: 7.78e-04
2022-05-13 16:04:49,550 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.813, Acc: 0.766, Base Lr: 7.78e-04
2022-05-13 16:04:52,862 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.809, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 16:04:56,212 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.810, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 16:04:59,481 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.817, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 16:05:03,748 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.814, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 16:05:07,125 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.815, Acc: 0.762, Base Lr: 7.78e-04
2022-05-13 16:05:10,067 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.036[s] Speed: 443.2[samples/s]
2022-05-13 16:05:23,916 reid_baseline.train INFO: normal accuracy 0.7854393842206543 0.769970715045929 
2022-05-13 16:05:23,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 16:05:23,916 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 77.0%
2022-05-13 16:05:28,425 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.806, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 16:05:33,417 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.809, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 16:05:36,845 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.805, Acc: 0.773, Base Lr: 4.51e-04
2022-05-13 16:05:40,252 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.813, Acc: 0.771, Base Lr: 4.51e-04
2022-05-13 16:05:43,714 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.811, Acc: 0.772, Base Lr: 4.51e-04
2022-05-13 16:05:47,038 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.810, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 16:05:50,340 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.810, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 16:05:53,156 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.037[s] Speed: 426.9[samples/s]
2022-05-13 16:06:06,924 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7585982084274292 
2022-05-13 16:06:06,925 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 16:06:06,925 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 75.9%
2022-05-13 16:06:11,739 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.822, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 16:06:15,247 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.823, Acc: 0.764, Base Lr: 2.11e-04
2022-05-13 16:06:18,518 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.809, Acc: 0.772, Base Lr: 2.11e-04
2022-05-13 16:06:21,807 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.813, Acc: 0.770, Base Lr: 2.11e-04
2022-05-13 16:06:25,801 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.812, Acc: 0.769, Base Lr: 2.11e-04
2022-05-13 16:06:29,217 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.815, Acc: 0.766, Base Lr: 2.11e-04
2022-05-13 16:06:33,101 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.812, Acc: 0.767, Base Lr: 2.11e-04
2022-05-13 16:06:35,792 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.037[s] Speed: 432.4[samples/s]
2022-05-13 16:06:49,140 reid_baseline.train INFO: normal accuracy 0.7835150737652341 0.7696419954299927 
2022-05-13 16:06:49,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 16:06:49,140 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 77.0%
2022-05-13 16:06:53,862 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.769, Acc: 0.787, Base Lr: 6.51e-05
2022-05-13 16:06:57,319 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.801, Acc: 0.772, Base Lr: 6.51e-05
2022-05-13 16:07:00,695 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.801, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 16:07:04,048 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.802, Acc: 0.777, Base Lr: 6.51e-05
2022-05-13 16:07:08,293 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.804, Acc: 0.775, Base Lr: 6.51e-05
2022-05-13 16:07:13,476 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.807, Acc: 0.773, Base Lr: 6.51e-05
2022-05-13 16:07:16,853 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.808, Acc: 0.771, Base Lr: 6.51e-05
2022-05-13 16:07:19,620 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.039[s] Speed: 411.5[samples/s]
2022-05-13 16:07:33,730 reid_baseline.train INFO: normal accuracy 0.7924951892238614 0.7754571437835693 
2022-05-13 16:07:33,731 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 16:07:33,731 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 77.5%
2022-05-13 16:07:38,069 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.810, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 16:07:41,520 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.816, Acc: 0.767, Base Lr: 1.60e-05
2022-05-13 16:07:45,012 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.818, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 16:07:48,713 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 16:07:52,787 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 16:07:57,504 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.811, Acc: 0.766, Base Lr: 1.60e-05
2022-05-13 16:08:01,102 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.812, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 16:08:03,790 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.039[s] Speed: 415.2[samples/s]
2022-05-13 16:08:17,657 reid_baseline.train INFO: normal accuracy 0.791853752405388 0.7856165170669556 
2022-05-13 16:08:17,658 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 16:08:17,658 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 78.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls/transformer_best_model.pth
2022-05-13 16:08:31,513 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 16:08:31,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:08:31,514 reid_baseline.train INFO: Accuracy: 75.2%
2022-05-13 16:08:45,150 reid_baseline.train INFO: normal accuracy 0.7524053880692751 0.7523706555366516 
2022-05-13 16:08:45,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:08:45,151 reid_baseline.train INFO: Shuffled Accuracy: 75.2%
2022-05-13 16:09:32,665 reid_baseline.train INFO: normal accuracy 0.7821170809943865 0.7411313652992249 
2022-05-13 16:09:32,666 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:09:32,666 reid_baseline.train INFO: Source Clean Accuracy: 78.2%
