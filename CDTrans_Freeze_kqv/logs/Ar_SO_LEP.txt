2022-05-13 15:21:14,490 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_ClipartSO_Dom_Cls
2022-05-13 15:21:14,490 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_ClipartSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Art_2Clipart/transformer_best_model.pth')
2022-05-13 15:21:14,490 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 15:21:14,491 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 15:21:14,491 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_ClipartSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Clipart/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 15:21:24,518 reid_baseline.train INFO: start training
2022-05-13 15:21:33,002 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.338, Acc: 0.371, Base Lr: 8.72e-04
2022-05-13 15:21:40,454 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.276, Acc: 0.424, Base Lr: 8.72e-04
2022-05-13 15:21:47,879 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.223, Acc: 0.467, Base Lr: 8.72e-04
2022-05-13 15:21:55,353 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.191, Acc: 0.495, Base Lr: 8.72e-04
2022-05-13 15:22:02,804 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.163, Acc: 0.517, Base Lr: 8.72e-04
2022-05-13 15:22:10,267 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.138, Acc: 0.537, Base Lr: 8.72e-04
2022-05-13 15:22:17,690 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.119, Acc: 0.553, Base Lr: 8.72e-04
2022-05-13 15:22:23,741 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.076[s] Speed: 211.5[samples/s]
2022-05-13 15:22:51,560 reid_baseline.train INFO: normal accuracy 0.6988454137267479 1.05935537815094 
2022-05-13 15:22:52,303 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 15:22:52,303 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 105.9%
2022-05-13 15:23:01,035 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.958, Acc: 0.655, Base Lr: 1.66e-03
2022-05-13 15:23:08,768 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.954, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 15:23:16,539 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.946, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 15:23:24,070 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.942, Acc: 0.680, Base Lr: 1.66e-03
2022-05-13 15:23:31,834 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.936, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 15:23:39,589 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.934, Acc: 0.687, Base Lr: 1.66e-03
2022-05-13 15:23:45,754 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.927, Acc: 0.691, Base Lr: 1.66e-03
2022-05-13 15:23:51,082 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.075[s] Speed: 212.8[samples/s]
2022-05-13 15:24:19,085 reid_baseline.train INFO: normal accuracy 0.7543296985246953 0.9268256425857544 
2022-05-13 15:24:19,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 15:24:19,878 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 92.7%
2022-05-13 15:24:28,507 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.873, Acc: 0.735, Base Lr: 2.46e-03
2022-05-13 15:24:36,191 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.878, Acc: 0.730, Base Lr: 2.46e-03
2022-05-13 15:24:43,982 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.877, Acc: 0.729, Base Lr: 2.46e-03
2022-05-13 15:24:51,597 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.877, Acc: 0.726, Base Lr: 2.46e-03
2022-05-13 15:24:59,337 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.877, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:25:07,059 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.875, Acc: 0.725, Base Lr: 2.46e-03
2022-05-13 15:25:14,806 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.875, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:25:20,966 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.078[s] Speed: 204.6[samples/s]
2022-05-13 15:25:48,636 reid_baseline.train INFO: normal accuracy 0.7642719692110327 0.8457469344139099 
2022-05-13 15:25:49,461 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 15:25:49,461 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 84.6%
2022-05-13 15:25:58,159 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.876, Acc: 0.724, Base Lr: 3.25e-03
2022-05-13 15:26:05,752 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.864, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:26:13,348 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.860, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:26:21,063 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:26:28,771 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.861, Acc: 0.733, Base Lr: 3.25e-03
2022-05-13 15:26:36,511 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:26:44,157 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:26:50,283 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.078[s] Speed: 205.2[samples/s]
2022-05-13 15:27:18,548 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.8324406147003174 
2022-05-13 15:27:19,349 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 15:27:19,349 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 83.2%
2022-05-13 15:27:27,797 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.826, Acc: 0.757, Base Lr: 4.04e-03
2022-05-13 15:27:35,346 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.840, Acc: 0.748, Base Lr: 4.04e-03
2022-05-13 15:27:43,084 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.840, Acc: 0.749, Base Lr: 4.04e-03
2022-05-13 15:27:49,805 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.852, Acc: 0.742, Base Lr: 4.04e-03
2022-05-13 15:27:55,771 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.855, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 15:28:03,527 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.04e-03
2022-05-13 15:28:11,055 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.853, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 15:28:17,265 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.074[s] Speed: 215.5[samples/s]
2022-05-13 15:28:45,344 reid_baseline.train INFO: normal accuracy 0.7671584348941629 0.7957854866981506 
2022-05-13 15:28:46,114 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 15:28:46,114 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 79.6%
2022-05-13 15:28:54,466 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.843, Acc: 0.737, Base Lr: 4.83e-03
2022-05-13 15:29:02,194 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.855, Acc: 0.733, Base Lr: 4.83e-03
2022-05-13 15:29:10,006 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.849, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 15:29:17,710 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.850, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:29:25,414 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.856, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 15:29:32,936 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.855, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 15:29:40,554 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.83e-03
2022-05-13 15:29:46,771 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.078[s] Speed: 205.8[samples/s]
2022-05-13 15:30:14,712 reid_baseline.train INFO: normal accuracy 0.7729313662604234 0.7643894553184509 
2022-05-13 15:30:15,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 15:30:15,464 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.4%
2022-05-13 15:30:23,992 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.833, Acc: 0.758, Base Lr: 5.62e-03
2022-05-13 15:30:31,683 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.838, Acc: 0.749, Base Lr: 5.62e-03
2022-05-13 15:30:39,407 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.854, Acc: 0.739, Base Lr: 5.62e-03
2022-05-13 15:30:47,116 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.852, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 15:30:54,621 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.856, Acc: 0.740, Base Lr: 5.62e-03
2022-05-13 15:31:02,258 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.853, Acc: 0.742, Base Lr: 5.62e-03
2022-05-13 15:31:10,013 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.855, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 15:31:16,236 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.078[s] Speed: 205.4[samples/s]
2022-05-13 15:31:44,324 reid_baseline.train INFO: normal accuracy 0.7735728030788968 0.7536090612411499 
2022-05-13 15:31:45,139 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 15:31:45,139 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 75.4%
2022-05-13 15:31:53,888 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.863, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 15:31:59,181 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:32:06,845 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.852, Acc: 0.742, Base Lr: 6.42e-03
2022-05-13 15:32:14,427 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.857, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:32:21,993 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 15:32:29,811 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.864, Acc: 0.736, Base Lr: 6.42e-03
2022-05-13 15:32:37,539 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.864, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 15:32:43,736 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.075[s] Speed: 213.4[samples/s]
2022-05-13 15:33:11,983 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.768822968006134 
2022-05-13 15:33:11,985 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 15:33:11,985 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 76.9%
2022-05-13 15:33:20,523 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.850, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 15:33:28,262 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.858, Acc: 0.739, Base Lr: 7.21e-03
2022-05-13 15:33:35,980 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.848, Acc: 0.746, Base Lr: 7.21e-03
2022-05-13 15:33:43,580 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.856, Acc: 0.741, Base Lr: 7.21e-03
2022-05-13 15:33:51,283 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 7.21e-03
2022-05-13 15:33:58,982 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 15:34:06,701 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.870, Acc: 0.732, Base Lr: 7.21e-03
2022-05-13 15:34:12,916 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.078[s] Speed: 204.9[samples/s]
2022-05-13 15:34:40,845 reid_baseline.train INFO: normal accuracy 0.7540089801154586 0.7510765194892883 
2022-05-13 15:34:41,648 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 15:34:41,649 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 75.1%
2022-05-13 15:34:50,355 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.825, Acc: 0.761, Base Lr: 4.01e-03
2022-05-13 15:34:57,922 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.827, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 15:35:05,587 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.829, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 15:35:13,316 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.834, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 15:35:21,075 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.843, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 15:35:28,801 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.842, Acc: 0.752, Base Lr: 4.01e-03
2022-05-13 15:35:36,410 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.843, Acc: 0.751, Base Lr: 4.01e-03
2022-05-13 15:35:42,508 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.078[s] Speed: 205.2[samples/s]
2022-05-13 15:36:09,112 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7674882411956787 
2022-05-13 15:36:09,115 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 15:36:09,115 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 76.7%
2022-05-13 15:36:17,655 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.814, Acc: 0.763, Base Lr: 3.38e-03
2022-05-13 15:36:25,178 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.828, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:36:32,834 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.825, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 15:36:40,446 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.824, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 15:36:47,959 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.823, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 15:36:55,626 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.831, Acc: 0.751, Base Lr: 3.38e-03
2022-05-13 15:37:03,210 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.830, Acc: 0.753, Base Lr: 3.38e-03
2022-05-13 15:37:09,278 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.077[s] Speed: 207.9[samples/s]
2022-05-13 15:37:37,373 reid_baseline.train INFO: normal accuracy 0.777421423989737 0.7533466815948486 
2022-05-13 15:37:37,375 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 15:37:37,375 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 75.3%
2022-05-13 15:37:45,550 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.77e-03
2022-05-13 15:37:53,072 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.826, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 15:38:00,840 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.823, Acc: 0.760, Base Lr: 2.77e-03
2022-05-13 15:38:08,718 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.823, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 15:38:16,511 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.824, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 15:38:24,286 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.820, Acc: 0.766, Base Lr: 2.77e-03
2022-05-13 15:38:31,880 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.822, Acc: 0.763, Base Lr: 2.77e-03
2022-05-13 15:38:38,025 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.078[s] Speed: 205.8[samples/s]
2022-05-13 15:39:06,525 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 15:39:07,346 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 15:39:07,346 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 74.7%
2022-05-13 15:39:15,649 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.804, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 15:39:23,345 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.805, Acc: 0.772, Base Lr: 2.20e-03
2022-05-13 15:39:31,034 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.807, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 15:39:38,754 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.811, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 15:39:46,468 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.819, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 15:39:54,038 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.817, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 15:40:01,631 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.821, Acc: 0.758, Base Lr: 2.20e-03
2022-05-13 15:40:05,727 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.075[s] Speed: 214.0[samples/s]
2022-05-13 15:40:34,863 reid_baseline.train INFO: normal accuracy 0.7748556767158435 0.7823576927185059 
2022-05-13 15:40:34,866 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 15:40:34,866 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 78.2%
2022-05-13 15:40:43,457 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.800, Acc: 0.768, Base Lr: 1.66e-03
2022-05-13 15:40:51,103 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.797, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 15:40:58,797 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.801, Acc: 0.766, Base Lr: 1.66e-03
2022-05-13 15:41:06,569 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.815, Acc: 0.760, Base Lr: 1.66e-03
2022-05-13 15:41:14,213 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.817, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 15:41:21,709 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.816, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 15:41:30,542 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.815, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 15:41:36,798 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.079[s] Speed: 202.1[samples/s]
2022-05-13 15:42:05,066 reid_baseline.train INFO: normal accuracy 0.7867222578576011 0.7539136409759521 
2022-05-13 15:42:05,069 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 15:42:05,069 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 75.4%
2022-05-13 15:42:13,808 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.797, Acc: 0.773, Base Lr: 1.19e-03
2022-05-13 15:42:21,505 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 15:42:29,260 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.800, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 15:42:37,521 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 15:42:45,082 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.799, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 15:42:52,805 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.803, Acc: 0.766, Base Lr: 1.19e-03
2022-05-13 15:43:01,321 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.805, Acc: 0.763, Base Lr: 1.19e-03
2022-05-13 15:43:08,819 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.082[s] Speed: 196.2[samples/s]
2022-05-13 15:43:37,426 reid_baseline.train INFO: normal accuracy 0.7886465683130212 0.7610619068145752 
2022-05-13 15:43:37,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 15:43:37,429 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.1%
2022-05-13 15:43:46,056 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.807, Acc: 0.759, Base Lr: 7.78e-04
2022-05-13 15:43:53,840 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.803, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 15:44:02,189 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.800, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 15:44:10,986 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.803, Acc: 0.773, Base Lr: 7.78e-04
2022-05-13 15:44:16,293 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.809, Acc: 0.768, Base Lr: 7.78e-04
2022-05-13 15:44:24,049 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.806, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 15:44:31,764 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.804, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 15:44:39,176 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.079[s] Speed: 202.1[samples/s]
2022-05-13 15:45:08,196 reid_baseline.train INFO: normal accuracy 0.7912123155869147 0.7672516107559204 
2022-05-13 15:45:08,199 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 15:45:08,199 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 76.7%
2022-05-13 15:45:16,808 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.790, Acc: 0.779, Base Lr: 4.51e-04
2022-05-13 15:45:25,689 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.800, Acc: 0.767, Base Lr: 4.51e-04
2022-05-13 15:45:33,399 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.802, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 15:45:40,983 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.806, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 15:45:49,288 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.802, Acc: 0.768, Base Lr: 4.51e-04
2022-05-13 15:45:58,153 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.799, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 15:46:05,937 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.801, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 15:46:12,164 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.082[s] Speed: 195.2[samples/s]
2022-05-13 15:46:40,884 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7549644112586975 
2022-05-13 15:46:40,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 15:46:40,886 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 75.5%
2022-05-13 15:46:49,767 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.808, Acc: 0.779, Base Lr: 2.11e-04
2022-05-13 15:46:58,661 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.812, Acc: 0.768, Base Lr: 2.11e-04
2022-05-13 15:47:06,227 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.801, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 15:47:14,696 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.803, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 15:47:22,404 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.802, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 15:47:30,092 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.804, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 15:47:39,461 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.801, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 15:47:45,661 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.083[s] Speed: 193.2[samples/s]
2022-05-13 15:48:14,468 reid_baseline.train INFO: normal accuracy 0.7864015394483643 0.769210696220398 
2022-05-13 15:48:14,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 15:48:14,470 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 76.9%
2022-05-13 15:48:22,214 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.754, Acc: 0.794, Base Lr: 6.51e-05
2022-05-13 15:48:28,353 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.788, Acc: 0.781, Base Lr: 6.51e-05
2022-05-13 15:48:36,953 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.785, Acc: 0.784, Base Lr: 6.51e-05
2022-05-13 15:48:44,723 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.787, Acc: 0.783, Base Lr: 6.51e-05
2022-05-13 15:48:53,681 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.792, Acc: 0.779, Base Lr: 6.51e-05
2022-05-13 15:49:01,444 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.795, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 15:49:10,289 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.797, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 15:49:16,494 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.080[s] Speed: 201.2[samples/s]
2022-05-13 15:49:45,522 reid_baseline.train INFO: normal accuracy 0.7892880051314946 0.7686514854431152 
2022-05-13 15:49:45,524 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 15:49:45,524 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.9%
2022-05-13 15:49:54,001 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 15:50:01,498 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 15:50:09,491 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.808, Acc: 0.765, Base Lr: 1.60e-05
2022-05-13 15:50:17,228 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.802, Acc: 0.768, Base Lr: 1.60e-05
2022-05-13 15:50:25,440 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.798, Acc: 0.769, Base Lr: 1.60e-05
2022-05-13 15:50:34,847 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.799, Acc: 0.771, Base Lr: 1.60e-05
2022-05-13 15:50:42,502 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.801, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 15:50:49,131 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.082[s] Speed: 196.2[samples/s]
2022-05-13 15:51:18,635 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7794554829597473 
2022-05-13 15:51:18,637 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 15:51:18,637 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 77.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_ClipartSO_Dom_Cls/transformer_best_model.pth
2022-05-13 15:51:48,382 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 15:51:48,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:51:48,383 reid_baseline.train INFO: Accuracy: 78.5%
2022-05-13 15:52:16,855 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 15:52:16,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:52:16,855 reid_baseline.train INFO: Shuffled Accuracy: 78.5%
2022-05-13 15:54:00,716 reid_baseline.train INFO: normal accuracy 0.8098636728147555 0.7326639890670776 
2022-05-13 15:54:00,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 15:54:00,717 reid_baseline.train INFO: Source Clean Accuracy: 81.0%
2022-05-13 15:54:05,689 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_ProductSO_Dom_Cls
2022-05-13 15:54:05,689 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_ProductSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Art_2Product/transformer_best_model.pth')
2022-05-13 15:54:05,689 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 15:54:05,689 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 15:54:05,690 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_ProductSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Product/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 15:54:18,307 reid_baseline.train INFO: start training
2022-05-13 15:54:27,305 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.338, Acc: 0.371, Base Lr: 8.72e-04
2022-05-13 15:54:35,064 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.276, Acc: 0.424, Base Lr: 8.72e-04
2022-05-13 15:54:42,845 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.223, Acc: 0.467, Base Lr: 8.72e-04
2022-05-13 15:54:50,674 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.191, Acc: 0.495, Base Lr: 8.72e-04
2022-05-13 15:54:58,423 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.163, Acc: 0.517, Base Lr: 8.72e-04
2022-05-13 15:55:07,166 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.138, Acc: 0.537, Base Lr: 8.72e-04
2022-05-13 15:55:14,870 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.119, Acc: 0.553, Base Lr: 8.72e-04
2022-05-13 15:55:21,257 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.080[s] Speed: 199.1[samples/s]
2022-05-13 15:55:50,747 reid_baseline.train INFO: normal accuracy 0.6988454137267479 1.05935537815094 
2022-05-13 15:55:51,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 15:55:51,495 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 105.9%
2022-05-13 15:55:59,923 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.958, Acc: 0.655, Base Lr: 1.66e-03
2022-05-13 15:56:07,569 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.954, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 15:56:16,484 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.946, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 15:56:24,170 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.942, Acc: 0.680, Base Lr: 1.66e-03
2022-05-13 15:56:32,257 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.936, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 15:56:39,823 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.934, Acc: 0.687, Base Lr: 1.66e-03
2022-05-13 15:56:45,755 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.927, Acc: 0.691, Base Lr: 1.66e-03
2022-05-13 15:56:52,356 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.078[s] Speed: 205.1[samples/s]
2022-05-13 15:57:20,701 reid_baseline.train INFO: normal accuracy 0.7543296985246953 0.9268256425857544 
2022-05-13 15:57:21,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 15:57:21,459 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 92.7%
2022-05-13 15:57:30,545 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.873, Acc: 0.735, Base Lr: 2.46e-03
2022-05-13 15:57:38,963 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.878, Acc: 0.730, Base Lr: 2.46e-03
2022-05-13 15:57:46,739 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.877, Acc: 0.729, Base Lr: 2.46e-03
2022-05-13 15:57:54,449 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.877, Acc: 0.726, Base Lr: 2.46e-03
2022-05-13 15:58:02,508 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.877, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:58:10,092 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.875, Acc: 0.725, Base Lr: 2.46e-03
2022-05-13 15:58:17,816 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.875, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 15:58:25,217 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.082[s] Speed: 195.9[samples/s]
2022-05-13 15:58:54,174 reid_baseline.train INFO: normal accuracy 0.7642719692110327 0.8457469344139099 
2022-05-13 15:58:55,044 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 15:58:55,045 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 84.6%
2022-05-13 15:59:03,949 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.876, Acc: 0.724, Base Lr: 3.25e-03
2022-05-13 15:59:12,075 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.864, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 15:59:20,349 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.860, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 15:59:28,429 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:59:35,933 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.861, Acc: 0.733, Base Lr: 3.25e-03
2022-05-13 15:59:44,156 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:59:52,675 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 15:59:59,774 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.083[s] Speed: 192.9[samples/s]
2022-05-13 16:00:28,126 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.8324406147003174 
2022-05-13 16:00:28,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 16:00:28,945 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 83.2%
2022-05-13 16:00:37,966 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.826, Acc: 0.757, Base Lr: 4.04e-03
2022-05-13 16:00:46,164 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.840, Acc: 0.748, Base Lr: 4.04e-03
2022-05-13 16:00:53,154 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.840, Acc: 0.749, Base Lr: 4.04e-03
2022-05-13 16:00:59,886 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.852, Acc: 0.742, Base Lr: 4.04e-03
2022-05-13 16:01:07,492 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.855, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 16:01:16,269 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.04e-03
2022-05-13 16:01:23,957 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.853, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 16:01:30,186 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.078[s] Speed: 204.2[samples/s]
2022-05-13 16:01:59,934 reid_baseline.train INFO: normal accuracy 0.7671584348941629 0.7957854866981506 
2022-05-13 16:02:00,810 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 16:02:00,810 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 79.6%
2022-05-13 16:02:09,516 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.843, Acc: 0.737, Base Lr: 4.83e-03
2022-05-13 16:02:18,424 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.855, Acc: 0.733, Base Lr: 4.83e-03
2022-05-13 16:02:26,034 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.849, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 16:02:35,145 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.850, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 16:02:42,893 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.856, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 16:02:50,652 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.855, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 16:02:58,306 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.83e-03
2022-05-13 16:03:05,704 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.083[s] Speed: 192.4[samples/s]
2022-05-13 16:03:34,795 reid_baseline.train INFO: normal accuracy 0.7729313662604234 0.7643894553184509 
2022-05-13 16:03:35,638 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 16:03:35,638 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.4%
2022-05-13 16:03:44,306 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.833, Acc: 0.758, Base Lr: 5.62e-03
2022-05-13 16:03:52,503 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.838, Acc: 0.749, Base Lr: 5.62e-03
2022-05-13 16:04:00,064 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.854, Acc: 0.739, Base Lr: 5.62e-03
2022-05-13 16:04:08,315 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.852, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 16:04:16,090 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.856, Acc: 0.740, Base Lr: 5.62e-03
2022-05-13 16:04:24,965 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.853, Acc: 0.742, Base Lr: 5.62e-03
2022-05-13 16:04:32,619 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.855, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 16:04:39,746 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.082[s] Speed: 194.7[samples/s]
2022-05-13 16:05:05,438 reid_baseline.train INFO: normal accuracy 0.7735728030788968 0.7536090612411499 
2022-05-13 16:05:06,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 16:05:06,250 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 75.4%
2022-05-13 16:05:16,062 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.863, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 16:05:23,573 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:05:31,347 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.852, Acc: 0.742, Base Lr: 6.42e-03
2022-05-13 16:05:40,181 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.857, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:05:47,859 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:05:55,551 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.864, Acc: 0.736, Base Lr: 6.42e-03
2022-05-13 16:06:04,191 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.864, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 16:06:10,419 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.082[s] Speed: 194.5[samples/s]
2022-05-13 16:06:39,260 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.768822968006134 
2022-05-13 16:06:39,263 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 16:06:39,263 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 76.9%
2022-05-13 16:06:47,968 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.850, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 16:06:55,717 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.858, Acc: 0.739, Base Lr: 7.21e-03
2022-05-13 16:07:03,509 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.848, Acc: 0.746, Base Lr: 7.21e-03
2022-05-13 16:07:13,010 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.856, Acc: 0.741, Base Lr: 7.21e-03
2022-05-13 16:07:20,664 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 7.21e-03
2022-05-13 16:07:29,954 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 16:07:37,510 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.870, Acc: 0.732, Base Lr: 7.21e-03
2022-05-13 16:07:43,796 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.083[s] Speed: 193.4[samples/s]
2022-05-13 16:08:13,006 reid_baseline.train INFO: normal accuracy 0.7540089801154586 0.7510765194892883 
2022-05-13 16:08:13,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 16:08:13,823 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 75.1%
2022-05-13 16:08:22,331 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.825, Acc: 0.761, Base Lr: 4.01e-03
2022-05-13 16:08:29,975 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.827, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 16:08:37,583 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.829, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 16:08:45,757 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.834, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 16:08:53,445 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.843, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 16:09:01,016 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.842, Acc: 0.752, Base Lr: 4.01e-03
2022-05-13 16:09:06,734 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.843, Acc: 0.751, Base Lr: 4.01e-03
2022-05-13 16:09:12,191 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.075[s] Speed: 213.8[samples/s]
2022-05-13 16:09:40,831 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7674882411956787 
2022-05-13 16:09:40,833 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 16:09:40,833 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 76.7%
2022-05-13 16:09:49,300 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.814, Acc: 0.763, Base Lr: 3.38e-03
2022-05-13 16:09:56,793 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.828, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:10:04,304 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.825, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:10:11,812 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.824, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 16:10:19,322 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.823, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 16:10:26,841 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.831, Acc: 0.751, Base Lr: 3.38e-03
2022-05-13 16:10:34,331 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.830, Acc: 0.753, Base Lr: 3.38e-03
2022-05-13 16:10:40,410 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.076[s] Speed: 209.9[samples/s]
2022-05-13 16:11:08,346 reid_baseline.train INFO: normal accuracy 0.777421423989737 0.7533466815948486 
2022-05-13 16:11:08,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 16:11:08,348 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 75.3%
2022-05-13 16:11:16,644 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.77e-03
2022-05-13 16:11:24,115 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.826, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:11:31,634 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.823, Acc: 0.760, Base Lr: 2.77e-03
2022-05-13 16:11:39,152 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.823, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 16:11:46,696 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.824, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 16:11:54,192 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.820, Acc: 0.766, Base Lr: 2.77e-03
2022-05-13 16:12:01,676 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.822, Acc: 0.763, Base Lr: 2.77e-03
2022-05-13 16:12:07,753 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.076[s] Speed: 210.4[samples/s]
2022-05-13 16:12:35,605 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 16:12:36,355 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 16:12:36,355 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 74.7%
2022-05-13 16:12:44,523 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.804, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 16:12:52,013 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.805, Acc: 0.772, Base Lr: 2.20e-03
2022-05-13 16:12:59,536 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.807, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 16:13:07,052 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.811, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 16:13:13,916 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.819, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 16:13:19,594 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.817, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 16:13:27,157 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.821, Acc: 0.758, Base Lr: 2.20e-03
2022-05-13 16:13:33,246 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.073[s] Speed: 219.5[samples/s]
2022-05-13 16:14:00,992 reid_baseline.train INFO: normal accuracy 0.7748556767158435 0.7823576927185059 
2022-05-13 16:14:00,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 16:14:00,994 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 78.2%
2022-05-13 16:14:09,526 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.800, Acc: 0.768, Base Lr: 1.66e-03
2022-05-13 16:14:17,078 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.797, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 16:14:24,665 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.801, Acc: 0.766, Base Lr: 1.66e-03
2022-05-13 16:14:32,288 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.815, Acc: 0.760, Base Lr: 1.66e-03
2022-05-13 16:14:39,847 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.817, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 16:14:47,392 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.816, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 16:14:54,951 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.815, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 16:15:01,064 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.077[s] Speed: 207.8[samples/s]
2022-05-13 16:15:29,312 reid_baseline.train INFO: normal accuracy 0.7867222578576011 0.7539136409759521 
2022-05-13 16:15:29,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 16:15:29,315 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 75.4%
2022-05-13 16:15:37,833 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.797, Acc: 0.773, Base Lr: 1.19e-03
2022-05-13 16:15:45,434 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 16:15:53,063 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.800, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 16:16:00,631 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 16:16:08,197 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.799, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 16:16:15,764 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.803, Acc: 0.766, Base Lr: 1.19e-03
2022-05-13 16:16:23,391 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.805, Acc: 0.763, Base Lr: 1.19e-03
2022-05-13 16:16:29,492 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.077[s] Speed: 207.4[samples/s]
2022-05-13 16:16:57,316 reid_baseline.train INFO: normal accuracy 0.7886465683130212 0.7610619068145752 
2022-05-13 16:16:57,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 16:16:57,318 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.1%
2022-05-13 16:17:05,817 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.807, Acc: 0.759, Base Lr: 7.78e-04
2022-05-13 16:17:13,359 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.803, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 16:17:20,617 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.800, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 16:17:26,175 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.803, Acc: 0.773, Base Lr: 7.78e-04
2022-05-13 16:17:33,773 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.809, Acc: 0.768, Base Lr: 7.78e-04
2022-05-13 16:17:41,394 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.806, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 16:17:48,909 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.804, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 16:17:55,134 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.074[s] Speed: 215.9[samples/s]
2022-05-13 16:18:22,967 reid_baseline.train INFO: normal accuracy 0.7912123155869147 0.7672516107559204 
2022-05-13 16:18:22,969 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 16:18:22,969 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 76.7%
2022-05-13 16:18:31,452 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.790, Acc: 0.779, Base Lr: 4.51e-04
2022-05-13 16:18:39,015 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.800, Acc: 0.767, Base Lr: 4.51e-04
2022-05-13 16:18:46,572 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.802, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 16:18:54,139 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.806, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 16:19:01,722 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.802, Acc: 0.768, Base Lr: 4.51e-04
2022-05-13 16:19:09,293 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.799, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 16:19:16,869 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.801, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 16:19:23,016 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.077[s] Speed: 207.9[samples/s]
2022-05-13 16:19:50,762 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7549644112586975 
2022-05-13 16:19:50,764 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 16:19:50,764 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 75.5%
2022-05-13 16:19:59,190 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.808, Acc: 0.779, Base Lr: 2.11e-04
2022-05-13 16:20:06,782 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.812, Acc: 0.768, Base Lr: 2.11e-04
2022-05-13 16:20:14,385 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.801, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 16:20:21,970 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.803, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 16:20:29,513 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.802, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 16:20:37,069 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.804, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 16:20:44,634 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.801, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 16:20:50,755 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.077[s] Speed: 208.0[samples/s]
2022-05-13 16:21:18,539 reid_baseline.train INFO: normal accuracy 0.7864015394483643 0.769210696220398 
2022-05-13 16:21:18,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 16:21:18,542 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 76.9%
2022-05-13 16:21:27,046 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.754, Acc: 0.794, Base Lr: 6.51e-05
2022-05-13 16:21:32,354 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.788, Acc: 0.781, Base Lr: 6.51e-05
2022-05-13 16:21:39,935 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.785, Acc: 0.784, Base Lr: 6.51e-05
2022-05-13 16:21:47,508 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.787, Acc: 0.783, Base Lr: 6.51e-05
2022-05-13 16:21:54,999 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.792, Acc: 0.779, Base Lr: 6.51e-05
2022-05-13 16:22:02,777 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.795, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 16:22:10,563 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.797, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 16:22:16,823 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.075[s] Speed: 214.2[samples/s]
2022-05-13 16:22:45,033 reid_baseline.train INFO: normal accuracy 0.7892880051314946 0.7686514854431152 
2022-05-13 16:22:45,036 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 16:22:45,036 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.9%
2022-05-13 16:22:53,232 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 16:23:00,676 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 16:23:08,143 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.808, Acc: 0.765, Base Lr: 1.60e-05
2022-05-13 16:23:15,595 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.802, Acc: 0.768, Base Lr: 1.60e-05
2022-05-13 16:23:23,148 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.798, Acc: 0.769, Base Lr: 1.60e-05
2022-05-13 16:23:30,669 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.799, Acc: 0.771, Base Lr: 1.60e-05
2022-05-13 16:23:38,202 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.801, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 16:23:44,271 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.076[s] Speed: 210.7[samples/s]
2022-05-13 16:24:12,704 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7794554829597473 
2022-05-13 16:24:12,706 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 16:24:12,706 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 77.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_ProductSO_Dom_Cls/transformer_best_model.pth
2022-05-13 16:24:41,177 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 16:24:41,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:24:41,177 reid_baseline.train INFO: Accuracy: 78.5%
2022-05-13 16:25:08,820 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 16:25:08,821 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:25:08,821 reid_baseline.train INFO: Shuffled Accuracy: 78.5%
2022-05-13 16:26:52,026 reid_baseline.train INFO: normal accuracy 0.8098636728147555 0.7326639890670776 
2022-05-13 16:26:52,027 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 16:26:52,027 reid_baseline.train INFO: Source Clean Accuracy: 81.0%
2022-05-13 16:26:56,437 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_WorldSO_Dom_Cls
2022-05-13 16:26:56,437 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_WorldSO_Dom_Cls', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Dom_Cls_train.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Dom_Cls_test.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False, pretrain_path='../logs/pretrain/deit_base/office-home/Art_2Real_World/transformer_best_model.pth')
2022-05-13 16:26:56,438 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-13 16:26:56,438 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-13 16:26:56,438 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Dom_Cls_test.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Dom_Cls_train.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_WorldSO_Dom_Cls
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Dom_Cls_train and valid is Dom_Cls_test
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |     4 |    12470 |         1
  valid   |     4 |     3118 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2Real_World/transformer_best_model.pth
label smooth on, numclasses: 4
pretrain train
2022-05-13 16:27:07,755 reid_baseline.train INFO: start training
2022-05-13 16:27:16,695 reid_baseline.train INFO: Epoch[1] Iteration[100/780] Loss: 1.338, Acc: 0.371, Base Lr: 8.72e-04
2022-05-13 16:27:24,258 reid_baseline.train INFO: Epoch[1] Iteration[200/780] Loss: 1.276, Acc: 0.424, Base Lr: 8.72e-04
2022-05-13 16:27:31,894 reid_baseline.train INFO: Epoch[1] Iteration[300/780] Loss: 1.223, Acc: 0.467, Base Lr: 8.72e-04
2022-05-13 16:27:39,515 reid_baseline.train INFO: Epoch[1] Iteration[400/780] Loss: 1.191, Acc: 0.495, Base Lr: 8.72e-04
2022-05-13 16:27:47,194 reid_baseline.train INFO: Epoch[1] Iteration[500/780] Loss: 1.163, Acc: 0.517, Base Lr: 8.72e-04
2022-05-13 16:27:54,837 reid_baseline.train INFO: Epoch[1] Iteration[600/780] Loss: 1.138, Acc: 0.537, Base Lr: 8.72e-04
2022-05-13 16:28:02,364 reid_baseline.train INFO: Epoch[1] Iteration[700/780] Loss: 1.119, Acc: 0.553, Base Lr: 8.72e-04
2022-05-13 16:28:08,663 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.078[s] Speed: 205.8[samples/s]
2022-05-13 16:28:36,820 reid_baseline.train INFO: normal accuracy 0.6988454137267479 1.05935537815094 
2022-05-13 16:28:37,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-13 16:28:37,576 reid_baseline.train INFO: Accuracy: 69.9% Mean Entropy: 105.9%
2022-05-13 16:28:45,861 reid_baseline.train INFO: Epoch[2] Iteration[100/780] Loss: 0.958, Acc: 0.655, Base Lr: 1.66e-03
2022-05-13 16:28:53,418 reid_baseline.train INFO: Epoch[2] Iteration[200/780] Loss: 0.954, Acc: 0.667, Base Lr: 1.66e-03
2022-05-13 16:29:00,969 reid_baseline.train INFO: Epoch[2] Iteration[300/780] Loss: 0.946, Acc: 0.678, Base Lr: 1.66e-03
2022-05-13 16:29:08,564 reid_baseline.train INFO: Epoch[2] Iteration[400/780] Loss: 0.942, Acc: 0.680, Base Lr: 1.66e-03
2022-05-13 16:29:16,132 reid_baseline.train INFO: Epoch[2] Iteration[500/780] Loss: 0.936, Acc: 0.682, Base Lr: 1.66e-03
2022-05-13 16:29:23,759 reid_baseline.train INFO: Epoch[2] Iteration[600/780] Loss: 0.934, Acc: 0.687, Base Lr: 1.66e-03
2022-05-13 16:29:31,384 reid_baseline.train INFO: Epoch[2] Iteration[700/780] Loss: 0.927, Acc: 0.691, Base Lr: 1.66e-03
2022-05-13 16:29:37,544 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.077[s] Speed: 208.1[samples/s]
2022-05-13 16:30:03,073 reid_baseline.train INFO: normal accuracy 0.7543296985246953 0.9268256425857544 
2022-05-13 16:30:03,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-13 16:30:03,927 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 92.7%
2022-05-13 16:30:12,395 reid_baseline.train INFO: Epoch[3] Iteration[100/780] Loss: 0.873, Acc: 0.735, Base Lr: 2.46e-03
2022-05-13 16:30:19,998 reid_baseline.train INFO: Epoch[3] Iteration[200/780] Loss: 0.878, Acc: 0.730, Base Lr: 2.46e-03
2022-05-13 16:30:27,604 reid_baseline.train INFO: Epoch[3] Iteration[300/780] Loss: 0.877, Acc: 0.729, Base Lr: 2.46e-03
2022-05-13 16:30:35,189 reid_baseline.train INFO: Epoch[3] Iteration[400/780] Loss: 0.877, Acc: 0.726, Base Lr: 2.46e-03
2022-05-13 16:30:42,734 reid_baseline.train INFO: Epoch[3] Iteration[500/780] Loss: 0.877, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 16:30:50,319 reid_baseline.train INFO: Epoch[3] Iteration[600/780] Loss: 0.875, Acc: 0.725, Base Lr: 2.46e-03
2022-05-13 16:30:57,942 reid_baseline.train INFO: Epoch[3] Iteration[700/780] Loss: 0.875, Acc: 0.723, Base Lr: 2.46e-03
2022-05-13 16:31:04,079 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.077[s] Speed: 207.5[samples/s]
2022-05-13 16:31:32,057 reid_baseline.train INFO: normal accuracy 0.7642719692110327 0.8457469344139099 
2022-05-13 16:31:32,854 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-13 16:31:32,854 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 84.6%
2022-05-13 16:31:41,373 reid_baseline.train INFO: Epoch[4] Iteration[100/780] Loss: 0.876, Acc: 0.724, Base Lr: 3.25e-03
2022-05-13 16:31:48,972 reid_baseline.train INFO: Epoch[4] Iteration[200/780] Loss: 0.864, Acc: 0.738, Base Lr: 3.25e-03
2022-05-13 16:31:56,549 reid_baseline.train INFO: Epoch[4] Iteration[300/780] Loss: 0.860, Acc: 0.737, Base Lr: 3.25e-03
2022-05-13 16:32:04,210 reid_baseline.train INFO: Epoch[4] Iteration[400/780] Loss: 0.859, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 16:32:11,882 reid_baseline.train INFO: Epoch[4] Iteration[500/780] Loss: 0.861, Acc: 0.733, Base Lr: 3.25e-03
2022-05-13 16:32:19,434 reid_baseline.train INFO: Epoch[4] Iteration[600/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 16:32:27,000 reid_baseline.train INFO: Epoch[4] Iteration[700/780] Loss: 0.858, Acc: 0.734, Base Lr: 3.25e-03
2022-05-13 16:32:33,154 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.077[s] Speed: 207.0[samples/s]
2022-05-13 16:33:01,206 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.8324406147003174 
2022-05-13 16:33:02,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-13 16:33:02,029 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 83.2%
2022-05-13 16:33:10,513 reid_baseline.train INFO: Epoch[5] Iteration[100/780] Loss: 0.826, Acc: 0.757, Base Lr: 4.04e-03
2022-05-13 16:33:18,090 reid_baseline.train INFO: Epoch[5] Iteration[200/780] Loss: 0.840, Acc: 0.748, Base Lr: 4.04e-03
2022-05-13 16:33:25,634 reid_baseline.train INFO: Epoch[5] Iteration[300/780] Loss: 0.840, Acc: 0.749, Base Lr: 4.04e-03
2022-05-13 16:33:33,189 reid_baseline.train INFO: Epoch[5] Iteration[400/780] Loss: 0.852, Acc: 0.742, Base Lr: 4.04e-03
2022-05-13 16:33:40,822 reid_baseline.train INFO: Epoch[5] Iteration[500/780] Loss: 0.855, Acc: 0.739, Base Lr: 4.04e-03
2022-05-13 16:33:48,408 reid_baseline.train INFO: Epoch[5] Iteration[600/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.04e-03
2022-05-13 16:33:53,992 reid_baseline.train INFO: Epoch[5] Iteration[700/780] Loss: 0.853, Acc: 0.741, Base Lr: 4.04e-03
2022-05-13 16:33:59,838 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.074[s] Speed: 216.3[samples/s]
2022-05-13 16:34:27,820 reid_baseline.train INFO: normal accuracy 0.7671584348941629 0.7957854866981506 
2022-05-13 16:34:28,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-13 16:34:28,602 reid_baseline.train INFO: Accuracy: 76.7% Mean Entropy: 79.6%
2022-05-13 16:34:37,144 reid_baseline.train INFO: Epoch[6] Iteration[100/780] Loss: 0.843, Acc: 0.737, Base Lr: 4.83e-03
2022-05-13 16:34:44,692 reid_baseline.train INFO: Epoch[6] Iteration[200/780] Loss: 0.855, Acc: 0.733, Base Lr: 4.83e-03
2022-05-13 16:34:52,408 reid_baseline.train INFO: Epoch[6] Iteration[300/780] Loss: 0.849, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 16:35:00,005 reid_baseline.train INFO: Epoch[6] Iteration[400/780] Loss: 0.850, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 16:35:07,560 reid_baseline.train INFO: Epoch[6] Iteration[500/780] Loss: 0.856, Acc: 0.739, Base Lr: 4.83e-03
2022-05-13 16:35:15,124 reid_baseline.train INFO: Epoch[6] Iteration[600/780] Loss: 0.855, Acc: 0.742, Base Lr: 4.83e-03
2022-05-13 16:35:22,659 reid_baseline.train INFO: Epoch[6] Iteration[700/780] Loss: 0.854, Acc: 0.740, Base Lr: 4.83e-03
2022-05-13 16:35:28,784 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.077[s] Speed: 207.9[samples/s]
2022-05-13 16:35:56,908 reid_baseline.train INFO: normal accuracy 0.7729313662604234 0.7643894553184509 
2022-05-13 16:35:57,718 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-13 16:35:57,718 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 76.4%
2022-05-13 16:36:06,241 reid_baseline.train INFO: Epoch[7] Iteration[100/780] Loss: 0.833, Acc: 0.758, Base Lr: 5.62e-03
2022-05-13 16:36:13,825 reid_baseline.train INFO: Epoch[7] Iteration[200/780] Loss: 0.838, Acc: 0.749, Base Lr: 5.62e-03
2022-05-13 16:36:21,393 reid_baseline.train INFO: Epoch[7] Iteration[300/780] Loss: 0.854, Acc: 0.739, Base Lr: 5.62e-03
2022-05-13 16:36:28,942 reid_baseline.train INFO: Epoch[7] Iteration[400/780] Loss: 0.852, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 16:36:36,466 reid_baseline.train INFO: Epoch[7] Iteration[500/780] Loss: 0.856, Acc: 0.740, Base Lr: 5.62e-03
2022-05-13 16:36:44,038 reid_baseline.train INFO: Epoch[7] Iteration[600/780] Loss: 0.853, Acc: 0.742, Base Lr: 5.62e-03
2022-05-13 16:36:51,631 reid_baseline.train INFO: Epoch[7] Iteration[700/780] Loss: 0.855, Acc: 0.741, Base Lr: 5.62e-03
2022-05-13 16:36:57,753 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.077[s] Speed: 207.9[samples/s]
2022-05-13 16:37:25,799 reid_baseline.train INFO: normal accuracy 0.7735728030788968 0.7536090612411499 
2022-05-13 16:37:26,598 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-13 16:37:26,598 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 75.4%
2022-05-13 16:37:36,242 reid_baseline.train INFO: Epoch[8] Iteration[100/780] Loss: 0.863, Acc: 0.744, Base Lr: 6.42e-03
2022-05-13 16:37:48,062 reid_baseline.train INFO: Epoch[8] Iteration[200/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:37:59,905 reid_baseline.train INFO: Epoch[8] Iteration[300/780] Loss: 0.852, Acc: 0.742, Base Lr: 6.42e-03
2022-05-13 16:38:11,723 reid_baseline.train INFO: Epoch[8] Iteration[400/780] Loss: 0.857, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:38:22,344 reid_baseline.train INFO: Epoch[8] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 6.42e-03
2022-05-13 16:38:34,138 reid_baseline.train INFO: Epoch[8] Iteration[600/780] Loss: 0.864, Acc: 0.736, Base Lr: 6.42e-03
2022-05-13 16:38:45,947 reid_baseline.train INFO: Epoch[8] Iteration[700/780] Loss: 0.864, Acc: 0.737, Base Lr: 6.42e-03
2022-05-13 16:38:55,486 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.114[s] Speed: 140.4[samples/s]
2022-05-13 16:39:36,148 reid_baseline.train INFO: normal accuracy 0.7700449005772931 0.768822968006134 
2022-05-13 16:39:36,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-13 16:39:36,152 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 76.9%
2022-05-13 16:39:48,803 reid_baseline.train INFO: Epoch[9] Iteration[100/780] Loss: 0.850, Acc: 0.737, Base Lr: 7.21e-03
2022-05-13 16:40:00,648 reid_baseline.train INFO: Epoch[9] Iteration[200/780] Loss: 0.858, Acc: 0.739, Base Lr: 7.21e-03
2022-05-13 16:40:12,446 reid_baseline.train INFO: Epoch[9] Iteration[300/780] Loss: 0.848, Acc: 0.746, Base Lr: 7.21e-03
2022-05-13 16:40:24,261 reid_baseline.train INFO: Epoch[9] Iteration[400/780] Loss: 0.856, Acc: 0.741, Base Lr: 7.21e-03
2022-05-13 16:40:36,044 reid_baseline.train INFO: Epoch[9] Iteration[500/780] Loss: 0.862, Acc: 0.738, Base Lr: 7.21e-03
2022-05-13 16:40:47,847 reid_baseline.train INFO: Epoch[9] Iteration[600/780] Loss: 0.863, Acc: 0.736, Base Lr: 7.21e-03
2022-05-13 16:40:59,631 reid_baseline.train INFO: Epoch[9] Iteration[700/780] Loss: 0.870, Acc: 0.732, Base Lr: 7.21e-03
2022-05-13 16:41:09,214 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.119[s] Speed: 134.1[samples/s]
2022-05-13 16:41:50,030 reid_baseline.train INFO: normal accuracy 0.7540089801154586 0.7510765194892883 
2022-05-13 16:41:50,854 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-13 16:41:50,854 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 75.1%
2022-05-13 16:42:03,528 reid_baseline.train INFO: Epoch[10] Iteration[100/780] Loss: 0.825, Acc: 0.761, Base Lr: 4.01e-03
2022-05-13 16:42:15,355 reid_baseline.train INFO: Epoch[10] Iteration[200/780] Loss: 0.827, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 16:42:27,141 reid_baseline.train INFO: Epoch[10] Iteration[300/780] Loss: 0.829, Acc: 0.757, Base Lr: 4.01e-03
2022-05-13 16:42:38,965 reid_baseline.train INFO: Epoch[10] Iteration[400/780] Loss: 0.834, Acc: 0.754, Base Lr: 4.01e-03
2022-05-13 16:42:50,754 reid_baseline.train INFO: Epoch[10] Iteration[500/780] Loss: 0.843, Acc: 0.750, Base Lr: 4.01e-03
2022-05-13 16:43:02,508 reid_baseline.train INFO: Epoch[10] Iteration[600/780] Loss: 0.842, Acc: 0.752, Base Lr: 4.01e-03
2022-05-13 16:43:14,297 reid_baseline.train INFO: Epoch[10] Iteration[700/780] Loss: 0.843, Acc: 0.751, Base Lr: 4.01e-03
2022-05-13 16:43:23,845 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.119[s] Speed: 134.2[samples/s]
2022-05-13 16:44:05,370 reid_baseline.train INFO: normal accuracy 0.7825529185375241 0.7674882411956787 
2022-05-13 16:44:05,375 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-13 16:44:05,375 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 76.7%
2022-05-13 16:44:17,896 reid_baseline.train INFO: Epoch[11] Iteration[100/780] Loss: 0.814, Acc: 0.763, Base Lr: 3.38e-03
2022-05-13 16:44:29,731 reid_baseline.train INFO: Epoch[11] Iteration[200/780] Loss: 0.828, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:44:41,631 reid_baseline.train INFO: Epoch[11] Iteration[300/780] Loss: 0.825, Acc: 0.756, Base Lr: 3.38e-03
2022-05-13 16:44:53,515 reid_baseline.train INFO: Epoch[11] Iteration[400/780] Loss: 0.824, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 16:45:04,104 reid_baseline.train INFO: Epoch[11] Iteration[500/780] Loss: 0.823, Acc: 0.754, Base Lr: 3.38e-03
2022-05-13 16:45:16,018 reid_baseline.train INFO: Epoch[11] Iteration[600/780] Loss: 0.831, Acc: 0.751, Base Lr: 3.38e-03
2022-05-13 16:45:27,835 reid_baseline.train INFO: Epoch[11] Iteration[700/780] Loss: 0.830, Acc: 0.753, Base Lr: 3.38e-03
2022-05-13 16:45:37,384 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.118[s] Speed: 135.6[samples/s]
2022-05-13 16:46:18,500 reid_baseline.train INFO: normal accuracy 0.777421423989737 0.7533466815948486 
2022-05-13 16:46:18,505 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-13 16:46:18,505 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 75.3%
2022-05-13 16:46:31,318 reid_baseline.train INFO: Epoch[12] Iteration[100/780] Loss: 0.822, Acc: 0.767, Base Lr: 2.77e-03
2022-05-13 16:46:42,698 reid_baseline.train INFO: Epoch[12] Iteration[200/780] Loss: 0.826, Acc: 0.758, Base Lr: 2.77e-03
2022-05-13 16:46:53,210 reid_baseline.train INFO: Epoch[12] Iteration[300/780] Loss: 0.823, Acc: 0.760, Base Lr: 2.77e-03
2022-05-13 16:47:03,719 reid_baseline.train INFO: Epoch[12] Iteration[400/780] Loss: 0.823, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 16:47:14,203 reid_baseline.train INFO: Epoch[12] Iteration[500/780] Loss: 0.824, Acc: 0.761, Base Lr: 2.77e-03
2022-05-13 16:47:24,705 reid_baseline.train INFO: Epoch[12] Iteration[600/780] Loss: 0.820, Acc: 0.766, Base Lr: 2.77e-03
2022-05-13 16:47:35,171 reid_baseline.train INFO: Epoch[12] Iteration[700/780] Loss: 0.822, Acc: 0.763, Base Lr: 2.77e-03
2022-05-13 16:47:43,648 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.109[s] Speed: 146.8[samples/s]
2022-05-13 16:48:20,390 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 16:48:21,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-13 16:48:21,318 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 74.7%
2022-05-13 16:48:32,830 reid_baseline.train INFO: Epoch[13] Iteration[100/780] Loss: 0.804, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 16:48:43,250 reid_baseline.train INFO: Epoch[13] Iteration[200/780] Loss: 0.805, Acc: 0.772, Base Lr: 2.20e-03
2022-05-13 16:48:53,643 reid_baseline.train INFO: Epoch[13] Iteration[300/780] Loss: 0.807, Acc: 0.768, Base Lr: 2.20e-03
2022-05-13 16:49:05,099 reid_baseline.train INFO: Epoch[13] Iteration[400/780] Loss: 0.811, Acc: 0.767, Base Lr: 2.20e-03
2022-05-13 16:49:15,454 reid_baseline.train INFO: Epoch[13] Iteration[500/780] Loss: 0.819, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 16:49:26,763 reid_baseline.train INFO: Epoch[13] Iteration[600/780] Loss: 0.817, Acc: 0.761, Base Lr: 2.20e-03
2022-05-13 16:49:37,220 reid_baseline.train INFO: Epoch[13] Iteration[700/780] Loss: 0.821, Acc: 0.758, Base Lr: 2.20e-03
2022-05-13 16:49:46,786 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.109[s] Speed: 146.4[samples/s]
2022-05-13 16:50:23,136 reid_baseline.train INFO: normal accuracy 0.7748556767158435 0.7823576927185059 
2022-05-13 16:50:23,141 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-13 16:50:23,141 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 78.2%
2022-05-13 16:50:34,935 reid_baseline.train INFO: Epoch[14] Iteration[100/780] Loss: 0.800, Acc: 0.768, Base Lr: 1.66e-03
2022-05-13 16:50:45,091 reid_baseline.train INFO: Epoch[14] Iteration[200/780] Loss: 0.797, Acc: 0.767, Base Lr: 1.66e-03
2022-05-13 16:50:55,015 reid_baseline.train INFO: Epoch[14] Iteration[300/780] Loss: 0.801, Acc: 0.766, Base Lr: 1.66e-03
2022-05-13 16:51:04,184 reid_baseline.train INFO: Epoch[14] Iteration[400/780] Loss: 0.815, Acc: 0.760, Base Lr: 1.66e-03
2022-05-13 16:51:15,781 reid_baseline.train INFO: Epoch[14] Iteration[500/780] Loss: 0.817, Acc: 0.756, Base Lr: 1.66e-03
2022-05-13 16:51:26,006 reid_baseline.train INFO: Epoch[14] Iteration[600/780] Loss: 0.816, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 16:51:37,870 reid_baseline.train INFO: Epoch[14] Iteration[700/780] Loss: 0.815, Acc: 0.758, Base Lr: 1.66e-03
2022-05-13 16:51:47,807 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.109[s] Speed: 147.4[samples/s]
2022-05-13 16:52:28,940 reid_baseline.train INFO: normal accuracy 0.7867222578576011 0.7539136409759521 
2022-05-13 16:52:28,944 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-13 16:52:28,944 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 75.4%
2022-05-13 16:52:42,119 reid_baseline.train INFO: Epoch[15] Iteration[100/780] Loss: 0.797, Acc: 0.773, Base Lr: 1.19e-03
2022-05-13 16:52:54,053 reid_baseline.train INFO: Epoch[15] Iteration[200/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 16:53:05,983 reid_baseline.train INFO: Epoch[15] Iteration[300/780] Loss: 0.800, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 16:53:17,874 reid_baseline.train INFO: Epoch[15] Iteration[400/780] Loss: 0.800, Acc: 0.765, Base Lr: 1.19e-03
2022-05-13 16:53:29,702 reid_baseline.train INFO: Epoch[15] Iteration[500/780] Loss: 0.799, Acc: 0.769, Base Lr: 1.19e-03
2022-05-13 16:53:42,413 reid_baseline.train INFO: Epoch[15] Iteration[600/780] Loss: 0.803, Acc: 0.766, Base Lr: 1.19e-03
2022-05-13 16:53:54,314 reid_baseline.train INFO: Epoch[15] Iteration[700/780] Loss: 0.805, Acc: 0.763, Base Lr: 1.19e-03
2022-05-13 16:54:03,887 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.122[s] Speed: 131.5[samples/s]
2022-05-13 16:54:44,988 reid_baseline.train INFO: normal accuracy 0.7886465683130212 0.7610619068145752 
2022-05-13 16:54:44,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-13 16:54:44,993 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.1%
2022-05-13 16:54:57,941 reid_baseline.train INFO: Epoch[16] Iteration[100/780] Loss: 0.807, Acc: 0.759, Base Lr: 7.78e-04
2022-05-13 16:55:09,874 reid_baseline.train INFO: Epoch[16] Iteration[200/780] Loss: 0.803, Acc: 0.767, Base Lr: 7.78e-04
2022-05-13 16:55:21,717 reid_baseline.train INFO: Epoch[16] Iteration[300/780] Loss: 0.800, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 16:55:33,560 reid_baseline.train INFO: Epoch[16] Iteration[400/780] Loss: 0.803, Acc: 0.773, Base Lr: 7.78e-04
2022-05-13 16:55:45,985 reid_baseline.train INFO: Epoch[16] Iteration[500/780] Loss: 0.809, Acc: 0.768, Base Lr: 7.78e-04
2022-05-13 16:55:58,546 reid_baseline.train INFO: Epoch[16] Iteration[600/780] Loss: 0.806, Acc: 0.770, Base Lr: 7.78e-04
2022-05-13 16:56:10,635 reid_baseline.train INFO: Epoch[16] Iteration[700/780] Loss: 0.804, Acc: 0.769, Base Lr: 7.78e-04
2022-05-13 16:56:20,393 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-05-13 16:57:01,629 reid_baseline.train INFO: normal accuracy 0.7912123155869147 0.7672516107559204 
2022-05-13 16:57:01,633 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-13 16:57:01,634 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 76.7%
2022-05-13 16:57:14,792 reid_baseline.train INFO: Epoch[17] Iteration[100/780] Loss: 0.790, Acc: 0.779, Base Lr: 4.51e-04
2022-05-13 16:57:26,811 reid_baseline.train INFO: Epoch[17] Iteration[200/780] Loss: 0.800, Acc: 0.767, Base Lr: 4.51e-04
2022-05-13 16:57:37,497 reid_baseline.train INFO: Epoch[17] Iteration[300/780] Loss: 0.802, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 16:57:49,446 reid_baseline.train INFO: Epoch[17] Iteration[400/780] Loss: 0.806, Acc: 0.766, Base Lr: 4.51e-04
2022-05-13 16:58:01,307 reid_baseline.train INFO: Epoch[17] Iteration[500/780] Loss: 0.802, Acc: 0.768, Base Lr: 4.51e-04
2022-05-13 16:58:13,139 reid_baseline.train INFO: Epoch[17] Iteration[600/780] Loss: 0.799, Acc: 0.770, Base Lr: 4.51e-04
2022-05-13 16:58:24,982 reid_baseline.train INFO: Epoch[17] Iteration[700/780] Loss: 0.801, Acc: 0.769, Base Lr: 4.51e-04
2022-05-13 16:58:34,541 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.119[s] Speed: 134.3[samples/s]
2022-05-13 16:59:15,861 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7549644112586975 
2022-05-13 16:59:15,865 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-13 16:59:15,865 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 75.5%
2022-05-13 16:59:28,464 reid_baseline.train INFO: Epoch[18] Iteration[100/780] Loss: 0.808, Acc: 0.779, Base Lr: 2.11e-04
2022-05-13 16:59:40,734 reid_baseline.train INFO: Epoch[18] Iteration[200/780] Loss: 0.812, Acc: 0.768, Base Lr: 2.11e-04
2022-05-13 16:59:52,550 reid_baseline.train INFO: Epoch[18] Iteration[300/780] Loss: 0.801, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 17:00:05,498 reid_baseline.train INFO: Epoch[18] Iteration[400/780] Loss: 0.803, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 17:00:17,317 reid_baseline.train INFO: Epoch[18] Iteration[500/780] Loss: 0.802, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 17:00:29,575 reid_baseline.train INFO: Epoch[18] Iteration[600/780] Loss: 0.804, Acc: 0.774, Base Lr: 2.11e-04
2022-05-13 17:00:41,408 reid_baseline.train INFO: Epoch[18] Iteration[700/780] Loss: 0.801, Acc: 0.775, Base Lr: 2.11e-04
2022-05-13 17:00:50,429 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-05-13 17:01:28,288 reid_baseline.train INFO: normal accuracy 0.7864015394483643 0.769210696220398 
2022-05-13 17:01:28,293 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-13 17:01:28,293 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 76.9%
2022-05-13 17:01:39,784 reid_baseline.train INFO: Epoch[19] Iteration[100/780] Loss: 0.754, Acc: 0.794, Base Lr: 6.51e-05
2022-05-13 17:01:51,392 reid_baseline.train INFO: Epoch[19] Iteration[200/780] Loss: 0.788, Acc: 0.781, Base Lr: 6.51e-05
2022-05-13 17:02:01,812 reid_baseline.train INFO: Epoch[19] Iteration[300/780] Loss: 0.785, Acc: 0.784, Base Lr: 6.51e-05
2022-05-13 17:02:12,196 reid_baseline.train INFO: Epoch[19] Iteration[400/780] Loss: 0.787, Acc: 0.783, Base Lr: 6.51e-05
2022-05-13 17:02:23,837 reid_baseline.train INFO: Epoch[19] Iteration[500/780] Loss: 0.792, Acc: 0.779, Base Lr: 6.51e-05
2022-05-13 17:02:34,181 reid_baseline.train INFO: Epoch[19] Iteration[600/780] Loss: 0.795, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 17:02:45,341 reid_baseline.train INFO: Epoch[19] Iteration[700/780] Loss: 0.797, Acc: 0.778, Base Lr: 6.51e-05
2022-05-13 17:02:53,640 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.109[s] Speed: 146.2[samples/s]
2022-05-13 17:03:30,045 reid_baseline.train INFO: normal accuracy 0.7892880051314946 0.7686514854431152 
2022-05-13 17:03:30,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-13 17:03:30,047 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 76.9%
2022-05-13 17:03:40,944 reid_baseline.train INFO: Epoch[20] Iteration[100/780] Loss: 0.814, Acc: 0.762, Base Lr: 1.60e-05
2022-05-13 17:03:49,354 reid_baseline.train INFO: Epoch[20] Iteration[200/780] Loss: 0.809, Acc: 0.764, Base Lr: 1.60e-05
2022-05-13 17:04:00,373 reid_baseline.train INFO: Epoch[20] Iteration[300/780] Loss: 0.808, Acc: 0.765, Base Lr: 1.60e-05
2022-05-13 17:04:10,528 reid_baseline.train INFO: Epoch[20] Iteration[400/780] Loss: 0.802, Acc: 0.768, Base Lr: 1.60e-05
2022-05-13 17:04:20,668 reid_baseline.train INFO: Epoch[20] Iteration[500/780] Loss: 0.798, Acc: 0.769, Base Lr: 1.60e-05
2022-05-13 17:04:32,152 reid_baseline.train INFO: Epoch[20] Iteration[600/780] Loss: 0.799, Acc: 0.771, Base Lr: 1.60e-05
2022-05-13 17:04:42,682 reid_baseline.train INFO: Epoch[20] Iteration[700/780] Loss: 0.801, Acc: 0.772, Base Lr: 1.60e-05
2022-05-13 17:04:51,744 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.105[s] Speed: 152.8[samples/s]
2022-05-13 17:05:28,754 reid_baseline.train INFO: normal accuracy 0.7896087235407312 0.7794554829597473 
2022-05-13 17:05:28,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-13 17:05:28,759 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 77.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_WorldSO_Dom_Cls/transformer_best_model.pth
2022-05-13 17:06:10,309 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 17:06:10,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 17:06:10,309 reid_baseline.train INFO: Accuracy: 78.5%
2022-05-13 17:06:52,163 reid_baseline.train INFO: normal accuracy 0.7847979474021809 0.746770441532135 
2022-05-13 17:06:52,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 17:06:52,164 reid_baseline.train INFO: Shuffled Accuracy: 78.5%
2022-05-13 17:09:30,761 reid_baseline.train INFO: normal accuracy 0.8098636728147555 0.7326639890670776 
2022-05-13 17:09:30,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-13 17:09:30,762 reid_baseline.train INFO: Source Clean Accuracy: 81.0%
