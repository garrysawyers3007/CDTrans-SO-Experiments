2022-05-17 16:29:59,900 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls_LEP
2022-05-17 16:29:59,900 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Art/transformer_best_model.pth')
2022-05-17 16:29:59,901 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 16:29:59,901 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 16:29:59,901 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 16:30:11,314 reid_baseline.train INFO: start training
2022-05-17 16:31:32,499 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.574, Acc: 0.404, Base Lr: 8.72e-04
2022-05-17 16:32:43,803 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.328, Acc: 0.558, Base Lr: 8.72e-04
2022-05-17 16:33:33,700 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.737[s] Speed: 21.7[samples/s]
2022-05-17 16:36:04,515 reid_baseline.train INFO: normal accuracy 0.3197362999587969 1.3545368909835815 
2022-05-17 16:36:05,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 16:36:05,869 reid_baseline.train INFO: Accuracy: 32.0% Mean Entropy: 135.5%
2022-05-17 16:37:18,981 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.806, Acc: 0.845, Base Lr: 1.66e-03
2022-05-17 16:38:27,029 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.775, Acc: 0.862, Base Lr: 1.66e-03
2022-05-17 16:39:17,938 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.704[s] Speed: 22.7[samples/s]
2022-05-17 16:41:54,061 reid_baseline.train INFO: normal accuracy 0.38936959208899874 1.2725268602371216 
2022-05-17 16:41:55,118 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 16:41:55,119 reid_baseline.train INFO: Accuracy: 38.9% Mean Entropy: 127.3%
2022-05-17 16:43:09,262 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.692, Acc: 0.901, Base Lr: 2.46e-03
2022-05-17 16:44:19,939 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.688, Acc: 0.901, Base Lr: 2.46e-03
2022-05-17 16:45:10,513 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-17 16:47:41,965 reid_baseline.train INFO: normal accuracy 0.48372476308199425 1.2861816883087158 
2022-05-17 16:47:42,989 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 16:47:42,989 reid_baseline.train INFO: Accuracy: 48.4% Mean Entropy: 128.6%
2022-05-17 16:48:55,630 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.655, Acc: 0.925, Base Lr: 3.25e-03
2022-05-17 16:50:04,518 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.654, Acc: 0.922, Base Lr: 3.25e-03
2022-05-17 16:50:55,275 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.704[s] Speed: 22.7[samples/s]
2022-05-17 16:53:21,073 reid_baseline.train INFO: normal accuracy 0.4783683559950556 1.227872371673584 
2022-05-17 16:53:21,074 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 16:53:21,074 reid_baseline.train INFO: Accuracy: 47.8% Mean Entropy: 122.8%
2022-05-17 16:54:38,715 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.624, Acc: 0.934, Base Lr: 4.04e-03
2022-05-17 16:55:48,530 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.634, Acc: 0.927, Base Lr: 4.04e-03
2022-05-17 16:56:36,315 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-17 16:59:27,978 reid_baseline.train INFO: normal accuracy 0.5677791512154924 1.2363309860229492 
2022-05-17 16:59:29,019 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 16:59:29,019 reid_baseline.train INFO: Accuracy: 56.8% Mean Entropy: 123.6%
2022-05-17 17:00:39,545 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.622, Acc: 0.931, Base Lr: 4.83e-03
2022-05-17 17:01:51,069 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.632, Acc: 0.926, Base Lr: 4.83e-03
2022-05-17 17:02:36,805 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.688[s] Speed: 23.3[samples/s]
2022-05-17 17:05:06,997 reid_baseline.train INFO: normal accuracy 0.5879686856201072 1.2196192741394043 
2022-05-17 17:05:08,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 17:05:08,398 reid_baseline.train INFO: Accuracy: 58.8% Mean Entropy: 122.0%
2022-05-17 17:06:24,165 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.625, Acc: 0.922, Base Lr: 5.62e-03
2022-05-17 17:07:33,959 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.625, Acc: 0.927, Base Lr: 5.62e-03
2022-05-17 17:08:28,200 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.732[s] Speed: 21.9[samples/s]
2022-05-17 17:10:57,001 reid_baseline.train INFO: normal accuracy 0.5739596209311908 1.1778019666671753 
2022-05-17 17:10:57,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 17:10:57,018 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 117.8%
2022-05-17 17:12:16,288 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.615, Acc: 0.935, Base Lr: 6.42e-03
2022-05-17 17:13:30,685 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.616, Acc: 0.935, Base Lr: 6.42e-03
2022-05-17 17:14:35,277 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.799[s] Speed: 20.0[samples/s]
2022-05-17 17:17:38,481 reid_baseline.train INFO: normal accuracy 0.6044499381953028 1.1677637100219727 
2022-05-17 17:17:39,995 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 17:17:39,996 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 116.8%
2022-05-17 17:19:10,147 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.620, Acc: 0.935, Base Lr: 7.21e-03
2022-05-17 17:20:41,612 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.628, Acc: 0.932, Base Lr: 7.21e-03
2022-05-17 17:21:43,048 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.890[s] Speed: 18.0[samples/s]
2022-05-17 17:24:51,434 reid_baseline.train INFO: normal accuracy 0.5854964977338277 1.1392017602920532 
2022-05-17 17:24:51,435 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-17 17:24:51,436 reid_baseline.train INFO: Accuracy: 58.5% Mean Entropy: 113.9%
2022-05-17 17:26:21,141 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.611, Acc: 0.941, Base Lr: 4.01e-03
2022-05-17 17:27:52,781 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.613, Acc: 0.939, Base Lr: 4.01e-03
2022-05-17 17:29:06,420 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.934[s] Speed: 17.1[samples/s]
2022-05-17 17:32:38,164 reid_baseline.train INFO: normal accuracy 0.6060980634528225 1.1335711479187012 
2022-05-17 17:32:39,621 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-17 17:32:39,622 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 113.4%
2022-05-17 17:34:21,366 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.609, Acc: 0.938, Base Lr: 3.38e-03
2022-05-17 17:36:17,577 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.610, Acc: 0.939, Base Lr: 3.38e-03
2022-05-17 17:37:36,245 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.087[s] Speed: 14.7[samples/s]
2022-05-17 17:41:21,069 reid_baseline.train INFO: normal accuracy 0.5970333745364648 1.15122652053833 
2022-05-17 17:41:21,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-17 17:41:21,080 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 115.1%
2022-05-17 17:43:35,566 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.607, Acc: 0.944, Base Lr: 2.77e-03
2022-05-17 17:45:30,712 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.603, Acc: 0.945, Base Lr: 2.77e-03
2022-05-17 17:46:57,021 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.230[s] Speed: 13.0[samples/s]
2022-05-17 17:51:09,405 reid_baseline.train INFO: normal accuracy 0.6184590028842192 1.1479532718658447 
2022-05-17 17:51:11,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-17 17:51:11,892 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 114.8%
2022-05-17 17:53:35,661 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.599, Acc: 0.946, Base Lr: 2.20e-03
2022-05-17 17:55:28,463 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.602, Acc: 0.945, Base Lr: 2.20e-03
2022-05-17 17:56:46,491 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.225[s] Speed: 13.1[samples/s]
2022-05-17 18:01:07,726 reid_baseline.train INFO: normal accuracy 0.6168108776266996 1.1491551399230957 
2022-05-17 18:01:07,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-17 18:01:07,729 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 114.9%
2022-05-17 18:03:21,302 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.593, Acc: 0.945, Base Lr: 1.66e-03
2022-05-17 18:05:13,071 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.590, Acc: 0.948, Base Lr: 1.66e-03
2022-05-17 18:06:38,233 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.211[s] Speed: 13.2[samples/s]
2022-05-17 18:10:47,556 reid_baseline.train INFO: normal accuracy 0.6242274412855378 1.1615891456604004 
2022-05-17 18:10:49,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-17 18:10:49,185 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 116.2%
2022-05-17 18:13:01,283 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.585, Acc: 0.951, Base Lr: 1.19e-03
2022-05-17 18:14:44,755 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.595, Acc: 0.947, Base Lr: 1.19e-03
2022-05-17 18:16:08,807 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.171[s] Speed: 13.7[samples/s]
2022-05-17 18:20:12,988 reid_baseline.train INFO: normal accuracy 0.6407086938607334 1.1301660537719727 
2022-05-17 18:20:14,463 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-17 18:20:14,463 reid_baseline.train INFO: Accuracy: 64.1% Mean Entropy: 113.0%
2022-05-17 18:22:27,143 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.600, Acc: 0.942, Base Lr: 7.78e-04
2022-05-17 18:24:18,071 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.597, Acc: 0.944, Base Lr: 7.78e-04
2022-05-17 18:25:41,961 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.200[s] Speed: 13.3[samples/s]
2022-05-17 18:29:37,689 reid_baseline.train INFO: normal accuracy 0.6328800988875154 1.1609984636306763 
2022-05-17 18:29:37,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-17 18:29:37,692 reid_baseline.train INFO: Accuracy: 63.3% Mean Entropy: 116.1%
2022-05-17 18:31:35,417 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.593, Acc: 0.950, Base Lr: 4.51e-04
2022-05-17 18:33:24,410 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.587, Acc: 0.951, Base Lr: 4.51e-04
2022-05-17 18:34:43,519 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.120[s] Speed: 14.3[samples/s]
2022-05-17 18:38:30,906 reid_baseline.train INFO: normal accuracy 0.6361763494025546 1.1529240608215332 
2022-05-17 18:38:30,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-17 18:38:30,908 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 115.3%
2022-05-17 18:40:48,298 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.581, Acc: 0.959, Base Lr: 2.11e-04
2022-05-17 18:42:38,909 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.592, Acc: 0.951, Base Lr: 2.11e-04
2022-05-17 18:44:01,894 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.212[s] Speed: 13.2[samples/s]
2022-05-17 18:47:56,937 reid_baseline.train INFO: normal accuracy 0.6201071281417387 1.1277834177017212 
2022-05-17 18:47:56,940 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-17 18:47:56,940 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 112.8%
2022-05-17 18:50:16,302 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.598, Acc: 0.944, Base Lr: 6.51e-05
2022-05-17 18:52:20,842 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.590, Acc: 0.953, Base Lr: 6.51e-05
2022-05-17 18:53:55,170 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.311[s] Speed: 12.2[samples/s]
2022-05-17 18:58:13,428 reid_baseline.train INFO: normal accuracy 0.6238154099711578 1.1545953750610352 
2022-05-17 18:58:13,430 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-17 18:58:13,431 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 115.5%
2022-05-17 19:00:30,763 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.599, Acc: 0.943, Base Lr: 1.60e-05
2022-05-17 19:02:24,660 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.594, Acc: 0.946, Base Lr: 1.60e-05
2022-05-17 19:03:58,012 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.262[s] Speed: 12.7[samples/s]
2022-05-17 19:07:50,499 reid_baseline.train INFO: normal accuracy 0.6143386897404203 1.152484655380249 
2022-05-17 19:07:50,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-17 19:07:50,500 reid_baseline.train INFO: Accuracy: 61.4% Mean Entropy: 115.2%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ArtSO_Dom_Cls_LEP/transformer_best_model.pth
2022-05-17 19:11:49,315 reid_baseline.train INFO: normal accuracy 0.6007604562737643 1.1345632076263428 
2022-05-17 19:11:49,316 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 19:11:49,320 reid_baseline.train INFO: Accuracy: 60.1%
2022-05-17 19:16:35,420 reid_baseline.train INFO: normal accuracy 0.6387170675830469 0.9950478672981262 
2022-05-17 19:16:35,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 19:16:35,421 reid_baseline.train INFO: Source Clean Accuracy: 63.9%
2022-05-17 19:16:46,756 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls_LEP
2022-05-17 19:16:46,756 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Product/transformer_best_model.pth')
2022-05-17 19:16:46,756 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 19:16:46,757 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 19:16:46,757 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 19:17:12,961 reid_baseline.train INFO: start training
2022-05-17 19:19:39,171 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.574, Acc: 0.402, Base Lr: 8.72e-04
2022-05-17 19:21:15,105 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.328, Acc: 0.557, Base Lr: 8.72e-04
2022-05-17 19:22:32,568 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.163[s] Speed: 13.8[samples/s]
2022-05-17 19:26:57,079 reid_baseline.train INFO: normal accuracy 0.3325073214687993 1.4005635976791382 
2022-05-17 19:26:58,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 19:26:58,387 reid_baseline.train INFO: Accuracy: 33.3% Mean Entropy: 140.1%
2022-05-17 19:29:03,653 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.805, Acc: 0.849, Base Lr: 1.66e-03
2022-05-17 19:30:50,475 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.772, Acc: 0.865, Base Lr: 1.66e-03
2022-05-17 19:31:56,117 reid_baseline.train INFO: Epoch 2 done. Time per batch: 1.091[s] Speed: 14.7[samples/s]
2022-05-17 19:35:47,747 reid_baseline.train INFO: normal accuracy 0.4381617481414733 1.3161437511444092 
2022-05-17 19:35:48,772 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 19:35:48,772 reid_baseline.train INFO: Accuracy: 43.8% Mean Entropy: 131.6%
2022-05-17 19:37:34,054 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.690, Acc: 0.902, Base Lr: 2.46e-03
2022-05-17 19:39:07,453 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.685, Acc: 0.903, Base Lr: 2.46e-03
2022-05-17 19:40:16,800 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.981[s] Speed: 16.3[samples/s]
2022-05-17 19:44:05,908 reid_baseline.train INFO: normal accuracy 0.510925884208155 1.258543848991394 
2022-05-17 19:44:06,846 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 19:44:06,846 reid_baseline.train INFO: Accuracy: 51.1% Mean Entropy: 125.9%
2022-05-17 19:45:50,085 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.653, Acc: 0.918, Base Lr: 3.25e-03
2022-05-17 19:47:31,525 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.645, Acc: 0.922, Base Lr: 3.25e-03
2022-05-17 19:48:39,681 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.999[s] Speed: 16.0[samples/s]
2022-05-17 19:52:42,008 reid_baseline.train INFO: normal accuracy 0.5429150709619284 1.247191309928894 
2022-05-17 19:52:43,303 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 19:52:43,304 reid_baseline.train INFO: Accuracy: 54.3% Mean Entropy: 124.7%
2022-05-17 19:54:42,421 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.637, Acc: 0.923, Base Lr: 4.04e-03
2022-05-17 19:56:28,945 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.641, Acc: 0.922, Base Lr: 4.04e-03
2022-05-17 19:57:39,882 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.086[s] Speed: 14.7[samples/s]
2022-05-17 20:01:43,593 reid_baseline.train INFO: normal accuracy 0.6152286551025006 1.237011432647705 
2022-05-17 20:01:44,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 20:01:44,994 reid_baseline.train INFO: Accuracy: 61.5% Mean Entropy: 123.7%
2022-05-17 20:03:43,735 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.625, Acc: 0.929, Base Lr: 4.83e-03
2022-05-17 20:05:26,610 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.626, Acc: 0.931, Base Lr: 4.83e-03
2022-05-17 20:06:27,986 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.036[s] Speed: 15.4[samples/s]
2022-05-17 20:10:32,269 reid_baseline.train INFO: normal accuracy 0.6190583464744311 1.1989672183990479 
2022-05-17 20:10:33,693 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 20:10:33,694 reid_baseline.train INFO: Accuracy: 61.9% Mean Entropy: 119.9%
2022-05-17 20:12:28,558 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.634, Acc: 0.928, Base Lr: 5.62e-03
2022-05-17 20:14:06,413 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.628, Acc: 0.933, Base Lr: 5.62e-03
2022-05-17 20:15:18,415 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.043[s] Speed: 15.3[samples/s]
2022-05-17 20:19:29,335 reid_baseline.train INFO: normal accuracy 0.5967560261320117 1.181326150894165 
2022-05-17 20:19:29,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 20:19:29,338 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 118.1%
2022-05-17 20:21:20,157 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.627, Acc: 0.924, Base Lr: 6.42e-03
2022-05-17 20:23:14,040 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.627, Acc: 0.927, Base Lr: 6.42e-03
2022-05-17 20:24:23,625 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.078[s] Speed: 14.8[samples/s]
2022-05-17 20:28:29,673 reid_baseline.train INFO: normal accuracy 0.6627618833070511 1.1535840034484863 
2022-05-17 20:28:31,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 20:28:31,096 reid_baseline.train INFO: Accuracy: 66.3% Mean Entropy: 115.4%
2022-05-17 20:30:29,199 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.629, Acc: 0.936, Base Lr: 7.21e-03
2022-05-17 20:32:15,918 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.631, Acc: 0.931, Base Lr: 7.21e-03
2022-05-17 20:33:31,114 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.099[s] Speed: 14.6[samples/s]
2022-05-17 20:37:23,450 reid_baseline.train INFO: normal accuracy 0.6674926785312008 1.1512633562088013 
2022-05-17 20:37:24,381 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-17 20:37:24,382 reid_baseline.train INFO: Accuracy: 66.7% Mean Entropy: 115.1%
2022-05-17 20:38:53,963 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.630, Acc: 0.928, Base Lr: 4.01e-03
2022-05-17 20:40:16,230 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.622, Acc: 0.933, Base Lr: 4.01e-03
2022-05-17 20:41:05,882 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.811[s] Speed: 19.7[samples/s]
2022-05-17 20:44:33,505 reid_baseline.train INFO: normal accuracy 0.6701959900878576 1.1602733135223389 
2022-05-17 20:44:34,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-17 20:44:34,859 reid_baseline.train INFO: Accuracy: 67.0% Mean Entropy: 116.0%
2022-05-17 20:46:04,668 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.606, Acc: 0.944, Base Lr: 3.38e-03
2022-05-17 20:47:26,275 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.607, Acc: 0.943, Base Lr: 3.38e-03
2022-05-17 20:48:10,631 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.790[s] Speed: 20.2[samples/s]
2022-05-17 20:51:39,365 reid_baseline.train INFO: normal accuracy 0.6747015093489525 1.1437376737594604 
2022-05-17 20:51:40,313 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-17 20:51:40,314 reid_baseline.train INFO: Accuracy: 67.5% Mean Entropy: 114.4%
2022-05-17 20:52:58,435 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.602, Acc: 0.943, Base Lr: 2.77e-03
2022-05-17 20:54:19,062 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.606, Acc: 0.941, Base Lr: 2.77e-03
2022-05-17 20:55:05,804 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.753[s] Speed: 21.3[samples/s]
2022-05-17 20:58:40,739 reid_baseline.train INFO: normal accuracy 0.6814597882405947 1.1543375253677368 
2022-05-17 20:58:42,148 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-17 20:58:42,149 reid_baseline.train INFO: Accuracy: 68.1% Mean Entropy: 115.4%
2022-05-17 21:00:08,872 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.613, Acc: 0.931, Base Lr: 2.20e-03
2022-05-17 21:01:21,396 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.604, Acc: 0.940, Base Lr: 2.20e-03
2022-05-17 21:02:05,952 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.746[s] Speed: 21.4[samples/s]
2022-05-17 21:05:32,747 reid_baseline.train INFO: normal accuracy 0.6900202748366749 1.1646257638931274 
2022-05-17 21:05:33,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-17 21:05:33,982 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 116.5%
2022-05-17 21:06:46,590 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.592, Acc: 0.950, Base Lr: 1.66e-03
2022-05-17 21:08:04,752 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.597, Acc: 0.946, Base Lr: 1.66e-03
2022-05-17 21:09:00,103 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.755[s] Speed: 21.2[samples/s]
2022-05-17 21:12:23,703 reid_baseline.train INFO: normal accuracy 0.6735751295336787 1.1571383476257324 
2022-05-17 21:12:23,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-17 21:12:23,704 reid_baseline.train INFO: Accuracy: 67.4% Mean Entropy: 115.7%
2022-05-17 21:13:44,465 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.586, Acc: 0.952, Base Lr: 1.19e-03
2022-05-17 21:15:02,496 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.595, Acc: 0.947, Base Lr: 1.19e-03
2022-05-17 21:15:45,007 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.737[s] Speed: 21.7[samples/s]
2022-05-17 21:18:56,570 reid_baseline.train INFO: normal accuracy 0.7033115566569047 1.1502292156219482 
2022-05-17 21:18:57,477 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-17 21:18:57,478 reid_baseline.train INFO: Accuracy: 70.3% Mean Entropy: 115.0%
2022-05-17 21:20:24,432 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.590, Acc: 0.950, Base Lr: 7.78e-04
2022-05-17 21:21:41,973 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.590, Acc: 0.950, Base Lr: 7.78e-04
2022-05-17 21:22:33,770 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.792[s] Speed: 20.2[samples/s]
2022-05-17 21:26:00,240 reid_baseline.train INFO: normal accuracy 0.6979049335435908 1.1670095920562744 
2022-05-17 21:26:00,240 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-17 21:26:00,240 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 116.7%
2022-05-17 21:27:23,204 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.578, Acc: 0.961, Base Lr: 4.51e-04
2022-05-17 21:28:36,750 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.583, Acc: 0.955, Base Lr: 4.51e-04
2022-05-17 21:29:26,383 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.755[s] Speed: 21.2[samples/s]
2022-05-17 21:32:43,672 reid_baseline.train INFO: normal accuracy 0.675152061275062 1.1343826055526733 
2022-05-17 21:32:43,672 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-17 21:32:43,673 reid_baseline.train INFO: Accuracy: 67.5% Mean Entropy: 113.4%
2022-05-17 21:34:10,142 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.592, Acc: 0.948, Base Lr: 2.11e-04
2022-05-17 21:35:22,005 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.599, Acc: 0.945, Base Lr: 2.11e-04
2022-05-17 21:36:12,915 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.766[s] Speed: 20.9[samples/s]
2022-05-17 21:39:43,577 reid_baseline.train INFO: normal accuracy 0.6999324172110836 1.158432126045227 
2022-05-17 21:39:43,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-17 21:39:43,578 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 115.8%
2022-05-17 21:41:00,855 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.597, Acc: 0.948, Base Lr: 6.51e-05
2022-05-17 21:42:16,066 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.594, Acc: 0.947, Base Lr: 6.51e-05
2022-05-17 21:42:58,111 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.712[s] Speed: 22.5[samples/s]
2022-05-17 21:46:21,922 reid_baseline.train INFO: normal accuracy 0.6870916873169632 1.1589893102645874 
2022-05-17 21:46:21,923 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-17 21:46:21,923 reid_baseline.train INFO: Accuracy: 68.7% Mean Entropy: 115.9%
2022-05-17 21:47:41,997 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.592, Acc: 0.950, Base Lr: 1.60e-05
2022-05-17 21:48:58,304 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.589, Acc: 0.950, Base Lr: 1.60e-05
2022-05-17 21:49:44,866 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.743[s] Speed: 21.5[samples/s]
2022-05-17 21:53:10,162 reid_baseline.train INFO: normal accuracy 0.6931741383194413 1.1579169034957886 
2022-05-17 21:53:10,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-17 21:53:10,163 reid_baseline.train INFO: Accuracy: 69.3% Mean Entropy: 115.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_ProductSO_Dom_Cls_LEP/transformer_best_model.pth
2022-05-17 21:56:24,843 reid_baseline.train INFO: normal accuracy 0.7058690233401315 1.149884581565857 
2022-05-17 21:56:24,844 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 21:56:24,844 reid_baseline.train INFO: Accuracy: 70.6%
2022-05-17 21:59:43,828 reid_baseline.train INFO: normal accuracy 0.6927835051546392 1.0500266551971436 
2022-05-17 21:59:43,828 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 21:59:43,828 reid_baseline.train INFO: Source Clean Accuracy: 69.3%
2022-05-17 21:59:51,891 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls_LEP
2022-05-17 21:59:51,891 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Clipart_2Real_World/transformer_best_model.pth')
2022-05-17 21:59:51,891 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 21:59:51,891 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 21:59:51,892 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_WorldSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 22:00:06,478 reid_baseline.train INFO: start training
2022-05-17 22:01:34,157 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 1.574, Acc: 0.403, Base Lr: 8.72e-04
2022-05-17 22:02:45,655 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 1.328, Acc: 0.558, Base Lr: 8.72e-04
2022-05-17 22:03:27,539 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.732[s] Speed: 21.9[samples/s]
2022-05-17 22:12:12,050 reid_baseline.train INFO: normal accuracy 0.3112233187973376 1.3856335878372192 
2022-05-17 22:12:13,447 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 22:12:13,448 reid_baseline.train INFO: Accuracy: 31.1% Mean Entropy: 138.6%
2022-05-17 22:13:26,082 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 0.811, Acc: 0.850, Base Lr: 1.66e-03
2022-05-17 22:14:36,315 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 0.774, Acc: 0.869, Base Lr: 1.66e-03
2022-05-17 22:15:19,087 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.680[s] Speed: 23.5[samples/s]
2022-05-17 22:23:56,519 reid_baseline.train INFO: normal accuracy 0.38719302272205647 1.3158634901046753 
2022-05-17 22:23:57,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 22:23:57,938 reid_baseline.train INFO: Accuracy: 38.7% Mean Entropy: 131.6%
2022-05-17 22:25:18,878 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 0.709, Acc: 0.891, Base Lr: 2.46e-03
2022-05-17 22:26:29,226 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 0.695, Acc: 0.900, Base Lr: 2.46e-03
2022-05-17 22:27:16,991 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.729[s] Speed: 21.9[samples/s]
2022-05-17 22:35:56,306 reid_baseline.train INFO: normal accuracy 0.49563820018365473 1.3322646617889404 
2022-05-17 22:35:57,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 22:35:57,714 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 133.2%
2022-05-17 22:37:11,790 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 0.663, Acc: 0.910, Base Lr: 3.25e-03
2022-05-17 22:38:23,895 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 0.653, Acc: 0.914, Base Lr: 3.25e-03
2022-05-17 22:39:14,373 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.720[s] Speed: 22.2[samples/s]
2022-05-17 22:47:49,220 reid_baseline.train INFO: normal accuracy 0.4916226761533165 1.2796021699905396 
2022-05-17 22:47:49,221 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 22:47:49,221 reid_baseline.train INFO: Accuracy: 49.2% Mean Entropy: 128.0%
2022-05-17 22:49:08,532 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 0.637, Acc: 0.924, Base Lr: 4.04e-03
2022-05-17 22:50:21,937 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 0.626, Acc: 0.932, Base Lr: 4.04e-03
2022-05-17 22:51:08,171 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.729[s] Speed: 22.0[samples/s]
2022-05-17 22:59:51,352 reid_baseline.train INFO: normal accuracy 0.5239843929309158 1.2252678871154785 
2022-05-17 22:59:52,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 22:59:52,886 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 122.5%
2022-05-17 23:01:40,786 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 0.622, Acc: 0.935, Base Lr: 4.83e-03
2022-05-17 23:03:12,715 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 0.629, Acc: 0.930, Base Lr: 4.83e-03
2022-05-17 23:04:01,660 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.911[s] Speed: 17.6[samples/s]
2022-05-17 23:14:34,492 reid_baseline.train INFO: normal accuracy 0.5453293550608217 1.2380354404449463 
2022-05-17 23:14:36,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 23:14:36,001 reid_baseline.train INFO: Accuracy: 54.5% Mean Entropy: 123.8%
2022-05-17 23:16:25,054 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 0.622, Acc: 0.938, Base Lr: 5.62e-03
2022-05-17 23:17:46,098 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 0.618, Acc: 0.938, Base Lr: 5.62e-03
2022-05-17 23:18:56,870 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.956[s] Speed: 16.7[samples/s]
2022-05-17 23:29:43,627 reid_baseline.train INFO: normal accuracy 0.5763139775074593 1.2084864377975464 
2022-05-17 23:29:45,066 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 23:29:45,066 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 120.8%
2022-05-17 23:31:18,081 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 0.623, Acc: 0.934, Base Lr: 6.42e-03
2022-05-17 23:32:48,280 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 0.616, Acc: 0.938, Base Lr: 6.42e-03
2022-05-17 23:33:59,125 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.930[s] Speed: 17.2[samples/s]
2022-05-17 23:44:21,064 reid_baseline.train INFO: normal accuracy 0.5763139775074593 1.1674550771713257 
2022-05-17 23:44:21,065 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 23:44:21,065 reid_baseline.train INFO: Accuracy: 57.6% Mean Entropy: 116.7%
2022-05-17 23:45:56,338 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 0.618, Acc: 0.938, Base Lr: 7.21e-03
2022-05-17 23:47:39,851 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 0.623, Acc: 0.935, Base Lr: 7.21e-03
2022-05-17 23:48:44,669 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.965[s] Speed: 16.6[samples/s]
2022-05-17 23:59:11,581 reid_baseline.train INFO: normal accuracy 0.6336929079641955 1.20317542552948 
2022-05-17 23:59:12,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-17 23:59:12,964 reid_baseline.train INFO: Accuracy: 63.4% Mean Entropy: 120.3%
2022-05-18 00:01:03,233 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 0.632, Acc: 0.924, Base Lr: 4.01e-03
2022-05-18 00:02:40,710 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 0.614, Acc: 0.933, Base Lr: 4.01e-03
2022-05-18 00:03:53,120 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.026[s] Speed: 15.6[samples/s]
2022-05-18 00:14:20,443 reid_baseline.train INFO: normal accuracy 0.6313977507459261 1.1843817234039307 
2022-05-18 00:14:20,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-18 00:14:20,447 reid_baseline.train INFO: Accuracy: 63.1% Mean Entropy: 118.4%
2022-05-18 00:16:09,518 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 0.630, Acc: 0.926, Base Lr: 3.38e-03
2022-05-18 00:17:48,361 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 0.618, Acc: 0.935, Base Lr: 3.38e-03
2022-05-18 00:18:55,939 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.009[s] Speed: 15.9[samples/s]
2022-05-18 00:28:51,484 reid_baseline.train INFO: normal accuracy 0.6345270890725436 1.206173300743103 
2022-05-18 00:28:52,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-18 00:28:52,892 reid_baseline.train INFO: Accuracy: 63.5% Mean Entropy: 120.6%
2022-05-18 00:30:46,190 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.613, Acc: 0.944, Base Lr: 2.77e-03
2022-05-18 00:32:23,642 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 0.613, Acc: 0.943, Base Lr: 2.77e-03
2022-05-18 00:33:33,759 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.029[s] Speed: 15.6[samples/s]
2022-05-18 00:43:37,457 reid_baseline.train INFO: normal accuracy 0.6171677759926555 1.1920148134231567 
2022-05-18 00:43:37,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-18 00:43:37,460 reid_baseline.train INFO: Accuracy: 61.7% Mean Entropy: 119.2%
2022-05-18 00:45:23,146 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.596, Acc: 0.943, Base Lr: 2.20e-03
2022-05-18 00:47:01,792 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.592, Acc: 0.950, Base Lr: 2.20e-03
2022-05-18 00:48:08,733 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.994[s] Speed: 16.1[samples/s]
2022-05-18 00:58:20,466 reid_baseline.train INFO: normal accuracy 0.6242827633692908 1.1873703002929688 
2022-05-18 00:58:20,468 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-18 00:58:20,468 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 118.7%
2022-05-18 01:00:13,153 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.595, Acc: 0.950, Base Lr: 1.66e-03
2022-05-18 01:01:55,695 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.597, Acc: 0.946, Base Lr: 1.66e-03
2022-05-18 01:03:04,719 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.041[s] Speed: 15.4[samples/s]
2022-05-18 01:13:03,474 reid_baseline.train INFO: normal accuracy 0.6196600826825908 1.1832176446914673 
2022-05-18 01:13:03,477 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-18 01:13:03,477 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 118.3%
2022-05-18 01:14:52,661 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.593, Acc: 0.951, Base Lr: 1.19e-03
2022-05-18 01:16:38,247 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.596, Acc: 0.950, Base Lr: 1.19e-03
2022-05-18 01:17:38,794 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.008[s] Speed: 15.9[samples/s]
2022-05-18 01:26:52,057 reid_baseline.train INFO: normal accuracy 0.6229056690383291 1.1894029378890991 
2022-05-18 01:26:52,058 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-18 01:26:52,058 reid_baseline.train INFO: Accuracy: 62.3% Mean Entropy: 118.9%
2022-05-18 01:28:19,466 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.594, Acc: 0.951, Base Lr: 7.78e-04
2022-05-18 01:29:31,940 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.589, Acc: 0.950, Base Lr: 7.78e-04
2022-05-18 01:30:16,481 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.749[s] Speed: 21.4[samples/s]
2022-05-18 01:39:00,136 reid_baseline.train INFO: normal accuracy 0.6268074363093872 1.1884684562683105 
2022-05-18 01:39:00,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-18 01:39:00,137 reid_baseline.train INFO: Accuracy: 62.7% Mean Entropy: 118.8%
2022-05-18 01:40:37,193 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.591, Acc: 0.955, Base Lr: 4.51e-04
2022-05-18 01:41:58,629 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.595, Acc: 0.950, Base Lr: 4.51e-04
2022-05-18 01:43:10,583 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.917[s] Speed: 17.5[samples/s]
2022-05-18 01:53:46,892 reid_baseline.train INFO: normal accuracy 0.651435132032147 1.195535659790039 
2022-05-18 01:53:48,661 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-18 01:53:48,661 reid_baseline.train INFO: Accuracy: 65.1% Mean Entropy: 119.6%
2022-05-18 01:55:39,499 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.583, Acc: 0.957, Base Lr: 2.11e-04
2022-05-18 01:57:01,999 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.588, Acc: 0.955, Base Lr: 2.11e-04
2022-05-18 01:57:52,506 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.893[s] Speed: 17.9[samples/s]
