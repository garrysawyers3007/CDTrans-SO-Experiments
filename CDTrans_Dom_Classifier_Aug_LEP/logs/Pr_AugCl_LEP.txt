2022-05-17 16:30:09,653 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_ArtSO_Dom_Cls_LEP
2022-05-17 16:30:09,654 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_ArtSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2Art/transformer_best_model.pth')
2022-05-17 16:30:09,654 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 16:30:09,654 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 16:30:09,654 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_ArtSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 16:30:23,298 reid_baseline.train INFO: start training
2022-05-17 16:31:55,134 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 1.606, Acc: 0.370, Base Lr: 8.72e-04
2022-05-17 16:33:05,801 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 1.347, Acc: 0.549, Base Lr: 8.72e-04
2022-05-17 16:34:01,997 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.780[s] Speed: 20.5[samples/s]
2022-05-17 16:36:45,652 reid_baseline.train INFO: normal accuracy 0.3757725587144623 1.4652210474014282 
2022-05-17 16:36:46,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 16:36:46,949 reid_baseline.train INFO: Accuracy: 37.6% Mean Entropy: 146.5%
2022-05-17 16:38:09,849 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 0.794, Acc: 0.846, Base Lr: 1.66e-03
2022-05-17 16:39:15,064 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 0.757, Acc: 0.868, Base Lr: 1.66e-03
2022-05-17 16:40:04,089 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.709[s] Speed: 22.6[samples/s]
2022-05-17 16:42:24,669 reid_baseline.train INFO: normal accuracy 0.4684796044499382 1.322563648223877 
2022-05-17 16:42:25,972 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 16:42:25,972 reid_baseline.train INFO: Accuracy: 46.8% Mean Entropy: 132.3%
2022-05-17 16:43:46,923 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 0.649, Acc: 0.934, Base Lr: 2.46e-03
2022-05-17 16:44:58,716 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 0.652, Acc: 0.928, Base Lr: 2.46e-03
2022-05-17 16:45:54,118 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.749[s] Speed: 21.4[samples/s]
2022-05-17 16:48:24,765 reid_baseline.train INFO: normal accuracy 0.5521219612690564 1.298883080482483 
2022-05-17 16:48:26,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 16:48:26,060 reid_baseline.train INFO: Accuracy: 55.2% Mean Entropy: 129.9%
2022-05-17 16:49:39,843 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 0.630, Acc: 0.930, Base Lr: 3.25e-03
2022-05-17 16:50:51,734 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 0.633, Acc: 0.928, Base Lr: 3.25e-03
2022-05-17 16:51:39,945 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.697[s] Speed: 23.0[samples/s]
2022-05-17 16:54:12,593 reid_baseline.train INFO: normal accuracy 0.5739596209311908 1.2191283702850342 
2022-05-17 16:54:13,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 16:54:13,982 reid_baseline.train INFO: Accuracy: 57.4% Mean Entropy: 121.9%
2022-05-17 16:55:34,192 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.614, Acc: 0.938, Base Lr: 4.04e-03
2022-05-17 16:56:47,337 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.607, Acc: 0.942, Base Lr: 4.04e-03
2022-05-17 16:57:38,995 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.737[s] Speed: 21.7[samples/s]
2022-05-17 17:00:08,306 reid_baseline.train INFO: normal accuracy 0.5896168108776267 1.1880733966827393 
2022-05-17 17:00:09,645 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 17:00:09,646 reid_baseline.train INFO: Accuracy: 59.0% Mean Entropy: 118.8%
2022-05-17 17:01:27,026 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.599, Acc: 0.950, Base Lr: 4.83e-03
2022-05-17 17:02:36,157 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.597, Acc: 0.948, Base Lr: 4.83e-03
2022-05-17 17:03:24,569 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.701[s] Speed: 22.8[samples/s]
2022-05-17 17:05:55,887 reid_baseline.train INFO: normal accuracy 0.6176349402554594 1.156295895576477 
2022-05-17 17:05:56,998 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 17:05:56,999 reid_baseline.train INFO: Accuracy: 61.8% Mean Entropy: 115.6%
2022-05-17 17:07:17,928 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.604, Acc: 0.941, Base Lr: 5.62e-03
2022-05-17 17:08:28,777 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.606, Acc: 0.940, Base Lr: 5.62e-03
2022-05-17 17:09:18,697 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.725[s] Speed: 22.1[samples/s]
2022-05-17 17:11:59,641 reid_baseline.train INFO: normal accuracy 0.5986814997939843 1.134164810180664 
2022-05-17 17:11:59,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 17:11:59,642 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 113.4%
2022-05-17 17:13:26,547 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.600, Acc: 0.950, Base Lr: 6.42e-03
2022-05-17 17:14:47,279 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.598, Acc: 0.948, Base Lr: 6.42e-03
2022-05-17 17:15:47,931 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.820[s] Speed: 19.5[samples/s]
2022-05-17 17:19:02,749 reid_baseline.train INFO: normal accuracy 0.5896168108776267 1.0816644430160522 
2022-05-17 17:19:02,749 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 17:19:02,750 reid_baseline.train INFO: Accuracy: 59.0% Mean Entropy: 108.2%
2022-05-17 17:20:41,707 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.613, Acc: 0.937, Base Lr: 7.21e-03
2022-05-17 17:22:07,436 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.601, Acc: 0.945, Base Lr: 7.21e-03
2022-05-17 17:23:07,151 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.879[s] Speed: 18.2[samples/s]
2022-05-17 17:26:25,911 reid_baseline.train INFO: normal accuracy 0.5789039967037495 1.0822829008102417 
2022-05-17 17:26:25,911 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-17 17:26:25,912 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 108.2%
2022-05-17 17:28:11,744 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.609, Acc: 0.945, Base Lr: 4.01e-03
2022-05-17 17:29:42,973 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.592, Acc: 0.954, Base Lr: 4.01e-03
2022-05-17 17:30:54,586 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.966[s] Speed: 16.6[samples/s]
2022-05-17 17:34:30,412 reid_baseline.train INFO: normal accuracy 0.5937371240214256 1.0973577499389648 
2022-05-17 17:34:30,415 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-17 17:34:30,416 reid_baseline.train INFO: Accuracy: 59.4% Mean Entropy: 109.7%
2022-05-17 17:36:42,483 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.591, Acc: 0.954, Base Lr: 3.38e-03
2022-05-17 17:38:29,056 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.582, Acc: 0.960, Base Lr: 3.38e-03
2022-05-17 17:40:08,841 reid_baseline.train INFO: Epoch 11 done. Time per batch: 1.217[s] Speed: 13.1[samples/s]
2022-05-17 17:44:01,679 reid_baseline.train INFO: normal accuracy 0.6357643180881747 1.094499111175537 
2022-05-17 17:44:05,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-17 17:44:05,799 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 109.4%
2022-05-17 17:46:20,502 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.584, Acc: 0.958, Base Lr: 2.77e-03
2022-05-17 17:48:24,108 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.583, Acc: 0.957, Base Lr: 2.77e-03
2022-05-17 17:50:02,398 reid_baseline.train INFO: Epoch 12 done. Time per batch: 1.282[s] Speed: 12.5[samples/s]
2022-05-17 17:54:21,044 reid_baseline.train INFO: normal accuracy 0.6044499381953028 1.0825022459030151 
2022-05-17 17:54:21,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-17 17:54:21,047 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 108.3%
2022-05-17 17:56:27,786 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.578, Acc: 0.962, Base Lr: 2.20e-03
2022-05-17 17:58:34,336 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.581, Acc: 0.961, Base Lr: 2.20e-03
2022-05-17 18:00:08,076 reid_baseline.train INFO: Epoch 13 done. Time per batch: 1.248[s] Speed: 12.8[samples/s]
2022-05-17 18:04:22,384 reid_baseline.train INFO: normal accuracy 0.6196950968273589 1.0955705642700195 
2022-05-17 18:04:22,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-17 18:04:22,386 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 109.6%
2022-05-17 18:06:37,570 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.587, Acc: 0.954, Base Lr: 1.66e-03
2022-05-17 18:08:41,618 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.585, Acc: 0.955, Base Lr: 1.66e-03
2022-05-17 18:10:11,798 reid_baseline.train INFO: Epoch 14 done. Time per batch: 1.257[s] Speed: 12.7[samples/s]
2022-05-17 18:14:13,493 reid_baseline.train INFO: normal accuracy 0.6357643180881747 1.0948678255081177 
2022-05-17 18:14:13,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-17 18:14:13,494 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 109.5%
2022-05-17 18:16:23,035 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.569, Acc: 0.965, Base Lr: 1.19e-03
2022-05-17 18:18:24,123 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.571, Acc: 0.963, Base Lr: 1.19e-03
2022-05-17 18:19:51,715 reid_baseline.train INFO: Epoch 15 done. Time per batch: 1.216[s] Speed: 13.2[samples/s]
2022-05-17 18:23:38,719 reid_baseline.train INFO: normal accuracy 0.6242274412855378 1.1350818872451782 
2022-05-17 18:23:38,719 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-17 18:23:38,720 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 113.5%
2022-05-17 18:25:49,028 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.571, Acc: 0.964, Base Lr: 7.78e-04
2022-05-17 18:27:43,836 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.570, Acc: 0.963, Base Lr: 7.78e-04
2022-05-17 18:29:07,407 reid_baseline.train INFO: Epoch 16 done. Time per batch: 1.182[s] Speed: 13.5[samples/s]
2022-05-17 18:32:43,566 reid_baseline.train INFO: normal accuracy 0.6497733827770911 1.093571424484253 
2022-05-17 18:32:47,786 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-17 18:32:47,786 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 109.4%
2022-05-17 18:34:50,381 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.581, Acc: 0.952, Base Lr: 4.51e-04
2022-05-17 18:36:51,613 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.572, Acc: 0.960, Base Lr: 4.51e-04
2022-05-17 18:38:16,898 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.183[s] Speed: 13.5[samples/s]
2022-05-17 18:42:26,710 reid_baseline.train INFO: normal accuracy 0.6341161928306551 1.0958106517791748 
2022-05-17 18:42:26,715 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-17 18:42:26,715 reid_baseline.train INFO: Accuracy: 63.4% Mean Entropy: 109.6%
2022-05-17 18:44:37,344 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.583, Acc: 0.956, Base Lr: 2.11e-04
2022-05-17 18:46:41,441 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.581, Acc: 0.955, Base Lr: 2.11e-04
2022-05-17 18:48:01,281 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.203[s] Speed: 13.3[samples/s]
2022-05-17 18:52:31,991 reid_baseline.train INFO: normal accuracy 0.6608982282653482 1.0963619947433472 
2022-05-17 18:52:35,429 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-17 18:52:35,430 reid_baseline.train INFO: Accuracy: 66.1% Mean Entropy: 109.6%
2022-05-17 18:54:57,031 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.571, Acc: 0.961, Base Lr: 6.51e-05
2022-05-17 18:57:00,849 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.573, Acc: 0.960, Base Lr: 6.51e-05
2022-05-17 18:58:33,266 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.287[s] Speed: 12.4[samples/s]
2022-05-17 19:02:46,561 reid_baseline.train INFO: normal accuracy 0.6291718170580964 1.1128034591674805 
2022-05-17 19:02:46,565 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-17 19:02:46,566 reid_baseline.train INFO: Accuracy: 62.9% Mean Entropy: 111.3%
2022-05-17 19:04:59,485 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.578, Acc: 0.958, Base Lr: 1.60e-05
2022-05-17 19:06:44,858 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.577, Acc: 0.959, Base Lr: 1.60e-05
2022-05-17 19:08:13,462 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.175[s] Speed: 13.6[samples/s]
2022-05-17 19:12:16,064 reid_baseline.train INFO: normal accuracy 0.6374124433456942 1.0852084159851074 
2022-05-17 19:12:16,078 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-17 19:12:16,082 reid_baseline.train INFO: Accuracy: 63.7% Mean Entropy: 108.5%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_ArtSO_Dom_Cls_LEP/transformer_best_model.pth
2022-05-17 19:16:15,407 reid_baseline.train INFO: normal accuracy 0.6488740617180984 1.0976905822753906 
2022-05-17 19:16:15,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 19:16:15,409 reid_baseline.train INFO: Accuracy: 64.9%
2022-05-17 19:20:22,628 reid_baseline.train INFO: normal accuracy 0.750168956972291 1.1412094831466675 
2022-05-17 19:20:22,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 19:20:22,630 reid_baseline.train INFO: Source Clean Accuracy: 75.0%
2022-05-17 19:20:37,054 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_Dom_Cls_LEP
2022-05-17 19:20:37,054 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2Clipart/transformer_best_model.pth')
2022-05-17 19:20:37,054 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 19:20:37,055 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 19:20:37,055 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Clipart
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4365 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 19:21:04,893 reid_baseline.train INFO: start training
2022-05-17 19:23:23,061 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 1.606, Acc: 0.370, Base Lr: 8.72e-04
2022-05-17 19:25:20,207 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 1.347, Acc: 0.549, Base Lr: 8.72e-04
2022-05-17 19:26:40,645 reid_baseline.train INFO: Epoch 1 done. Time per batch: 1.191[s] Speed: 13.4[samples/s]
2022-05-17 19:30:57,068 reid_baseline.train INFO: normal accuracy 0.3979381443298969 1.4537992477416992 
2022-05-17 19:30:58,276 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 19:30:58,276 reid_baseline.train INFO: Accuracy: 39.8% Mean Entropy: 145.4%
2022-05-17 19:32:40,118 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 0.799, Acc: 0.848, Base Lr: 1.66e-03
2022-05-17 19:34:22,139 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 0.751, Acc: 0.870, Base Lr: 1.66e-03
2022-05-17 19:35:33,571 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.990[s] Speed: 16.2[samples/s]
2022-05-17 19:39:11,359 reid_baseline.train INFO: normal accuracy 0.47101947308132874 1.2895499467849731 
2022-05-17 19:39:12,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 19:39:12,806 reid_baseline.train INFO: Accuracy: 47.1% Mean Entropy: 129.0%
2022-05-17 19:40:56,748 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 0.659, Acc: 0.921, Base Lr: 2.46e-03
2022-05-17 19:42:42,664 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 0.654, Acc: 0.923, Base Lr: 2.46e-03
2022-05-17 19:44:01,856 reid_baseline.train INFO: Epoch 3 done. Time per batch: 1.040[s] Speed: 15.4[samples/s]
2022-05-17 19:47:48,656 reid_baseline.train INFO: normal accuracy 0.5633447880870561 1.2272372245788574 
2022-05-17 19:47:50,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 19:47:50,071 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 122.7%
2022-05-17 19:49:42,285 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 0.636, Acc: 0.930, Base Lr: 3.25e-03
2022-05-17 19:51:26,707 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 0.633, Acc: 0.930, Base Lr: 3.25e-03
2022-05-17 19:52:40,065 reid_baseline.train INFO: Epoch 4 done. Time per batch: 1.043[s] Speed: 15.3[samples/s]
2022-05-17 19:56:36,319 reid_baseline.train INFO: normal accuracy 0.5642611683848797 1.1701065301895142 
2022-05-17 19:56:37,783 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 19:56:37,784 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 117.0%
2022-05-17 19:58:28,256 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.602, Acc: 0.952, Base Lr: 4.04e-03
2022-05-17 20:00:12,223 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.601, Acc: 0.948, Base Lr: 4.04e-03
2022-05-17 20:01:28,033 reid_baseline.train INFO: Epoch 5 done. Time per batch: 1.044[s] Speed: 15.3[samples/s]
2022-05-17 20:05:42,672 reid_baseline.train INFO: normal accuracy 0.6059564719358533 1.1206997632980347 
2022-05-17 20:05:44,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 20:05:44,484 reid_baseline.train INFO: Accuracy: 60.6% Mean Entropy: 112.1%
2022-05-17 20:07:42,198 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.597, Acc: 0.943, Base Lr: 4.83e-03
2022-05-17 20:09:27,627 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.600, Acc: 0.944, Base Lr: 4.83e-03
2022-05-17 20:10:41,734 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.069[s] Speed: 15.0[samples/s]
2022-05-17 20:14:43,235 reid_baseline.train INFO: normal accuracy 0.6847651775486827 1.1128065586090088 
2022-05-17 20:14:44,410 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 20:14:44,410 reid_baseline.train INFO: Accuracy: 68.5% Mean Entropy: 111.3%
2022-05-17 20:16:37,249 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.615, Acc: 0.938, Base Lr: 5.62e-03
2022-05-17 20:18:25,542 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.608, Acc: 0.945, Base Lr: 5.62e-03
2022-05-17 20:19:45,355 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.082[s] Speed: 14.8[samples/s]
2022-05-17 20:23:44,911 reid_baseline.train INFO: normal accuracy 0.5986254295532646 1.0593186616897583 
2022-05-17 20:23:44,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 20:23:44,916 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 105.9%
2022-05-17 20:25:41,571 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.607, Acc: 0.948, Base Lr: 6.42e-03
2022-05-17 20:27:30,519 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.594, Acc: 0.953, Base Lr: 6.42e-03
2022-05-17 20:28:40,387 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.063[s] Speed: 15.1[samples/s]
2022-05-17 20:32:49,282 reid_baseline.train INFO: normal accuracy 0.6533791523482245 1.062348484992981 
2022-05-17 20:32:49,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 20:32:49,285 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 106.2%
2022-05-17 20:34:47,739 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.596, Acc: 0.951, Base Lr: 7.21e-03
2022-05-17 20:36:04,463 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.604, Acc: 0.942, Base Lr: 7.21e-03
2022-05-17 20:37:08,068 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.931[s] Speed: 17.2[samples/s]
2022-05-17 20:40:36,050 reid_baseline.train INFO: normal accuracy 0.6623138602520046 1.0607788562774658 
2022-05-17 20:40:36,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-17 20:40:36,051 reid_baseline.train INFO: Accuracy: 66.2% Mean Entropy: 106.1%
2022-05-17 20:42:02,411 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.598, Acc: 0.951, Base Lr: 4.01e-03
2022-05-17 20:43:28,421 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.593, Acc: 0.952, Base Lr: 4.01e-03
2022-05-17 20:44:27,966 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.834[s] Speed: 19.2[samples/s]
2022-05-17 20:47:57,091 reid_baseline.train INFO: normal accuracy 0.656815578465063 1.0405247211456299 
2022-05-17 20:47:57,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-17 20:47:57,094 reid_baseline.train INFO: Accuracy: 65.7% Mean Entropy: 104.1%
2022-05-17 20:49:21,318 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.586, Acc: 0.954, Base Lr: 3.38e-03
2022-05-17 20:50:34,190 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.589, Acc: 0.955, Base Lr: 3.38e-03
2022-05-17 20:51:27,701 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.758[s] Speed: 21.1[samples/s]
2022-05-17 20:54:44,242 reid_baseline.train INFO: normal accuracy 0.6733104238258878 1.0515984296798706 
2022-05-17 20:54:44,243 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-17 20:54:44,243 reid_baseline.train INFO: Accuracy: 67.3% Mean Entropy: 105.2%
2022-05-17 20:56:09,972 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.580, Acc: 0.959, Base Lr: 2.77e-03
2022-05-17 20:57:27,534 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.577, Acc: 0.958, Base Lr: 2.77e-03
2022-05-17 20:58:20,622 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.778[s] Speed: 20.6[samples/s]
2022-05-17 21:01:46,822 reid_baseline.train INFO: normal accuracy 0.7177548682703322 1.0668107271194458 
2022-05-17 21:01:47,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-17 21:01:47,820 reid_baseline.train INFO: Accuracy: 71.8% Mean Entropy: 106.7%
2022-05-17 21:03:15,700 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.583, Acc: 0.960, Base Lr: 2.20e-03
2022-05-17 21:04:23,624 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.583, Acc: 0.956, Base Lr: 2.20e-03
2022-05-17 21:05:18,325 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.757[s] Speed: 21.1[samples/s]
2022-05-17 21:08:35,065 reid_baseline.train INFO: normal accuracy 0.6813287514318442 1.0643788576126099 
2022-05-17 21:08:35,066 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-17 21:08:35,066 reid_baseline.train INFO: Accuracy: 68.1% Mean Entropy: 106.4%
2022-05-17 21:09:58,212 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.570, Acc: 0.963, Base Lr: 1.66e-03
2022-05-17 21:11:17,162 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.572, Acc: 0.960, Base Lr: 1.66e-03
2022-05-17 21:12:13,849 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.787[s] Speed: 20.3[samples/s]
2022-05-17 21:15:35,949 reid_baseline.train INFO: normal accuracy 0.6939289805269186 1.0746365785598755 
2022-05-17 21:15:35,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-17 21:15:35,950 reid_baseline.train INFO: Accuracy: 69.4% Mean Entropy: 107.5%
2022-05-17 21:16:40,637 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.577, Acc: 0.955, Base Lr: 1.19e-03
2022-05-17 21:18:02,668 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.578, Acc: 0.954, Base Lr: 1.19e-03
2022-05-17 21:18:57,051 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.723[s] Speed: 22.1[samples/s]
2022-05-17 21:22:25,431 reid_baseline.train INFO: normal accuracy 0.6877434135166094 1.056796669960022 
2022-05-17 21:22:25,433 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-17 21:22:25,433 reid_baseline.train INFO: Accuracy: 68.8% Mean Entropy: 105.7%
2022-05-17 21:23:53,507 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.579, Acc: 0.955, Base Lr: 7.78e-04
2022-05-17 21:25:10,185 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.576, Acc: 0.959, Base Lr: 7.78e-04
2022-05-17 21:25:59,940 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.772[s] Speed: 20.7[samples/s]
2022-05-17 21:29:13,273 reid_baseline.train INFO: normal accuracy 0.6964490263459335 1.0636438131332397 
2022-05-17 21:29:13,274 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-17 21:29:13,274 reid_baseline.train INFO: Accuracy: 69.6% Mean Entropy: 106.4%
2022-05-17 21:30:36,436 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.576, Acc: 0.960, Base Lr: 4.51e-04
2022-05-17 21:31:45,161 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.577, Acc: 0.955, Base Lr: 4.51e-04
2022-05-17 21:32:42,976 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.754[s] Speed: 21.2[samples/s]
2022-05-17 21:36:12,728 reid_baseline.train INFO: normal accuracy 0.7097365406643757 1.0643835067749023 
2022-05-17 21:36:12,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-17 21:36:12,731 reid_baseline.train INFO: Accuracy: 71.0% Mean Entropy: 106.4%
2022-05-17 21:37:34,270 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.573, Acc: 0.961, Base Lr: 2.11e-04
2022-05-17 21:38:54,850 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.575, Acc: 0.959, Base Lr: 2.11e-04
2022-05-17 21:39:45,761 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.766[s] Speed: 20.9[samples/s]
2022-05-17 21:43:00,095 reid_baseline.train INFO: normal accuracy 0.7116662846665138 1.0598007440567017 
2022-05-17 21:43:00,096 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-17 21:43:00,096 reid_baseline.train INFO: Accuracy: 71.2% Mean Entropy: 106.0%
2022-05-17 21:44:19,463 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.570, Acc: 0.963, Base Lr: 6.51e-05
2022-05-17 21:45:39,750 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.571, Acc: 0.963, Base Lr: 6.51e-05
2022-05-17 21:46:26,217 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.741[s] Speed: 21.6[samples/s]
2022-05-17 21:49:44,854 reid_baseline.train INFO: normal accuracy 0.7017182130584192 1.0654480457305908 
2022-05-17 21:49:44,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-17 21:49:44,855 reid_baseline.train INFO: Accuracy: 70.2% Mean Entropy: 106.5%
2022-05-17 21:51:10,938 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.571, Acc: 0.969, Base Lr: 1.60e-05
2022-05-17 21:52:25,964 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.567, Acc: 0.968, Base Lr: 1.60e-05
2022-05-17 21:53:11,677 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.744[s] Speed: 21.5[samples/s]
2022-05-17 21:56:22,308 reid_baseline.train INFO: normal accuracy 0.7037800687285224 1.0397851467132568 
2022-05-17 21:56:22,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-17 21:56:22,311 reid_baseline.train INFO: Accuracy: 70.4% Mean Entropy: 104.0%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_ClipartSO_Dom_Cls_LEP/transformer_best_model.pth
2022-05-17 21:59:31,857 reid_baseline.train INFO: normal accuracy 0.7124856815578465 1.073726773262024 
2022-05-17 21:59:31,858 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 21:59:31,858 reid_baseline.train INFO: Accuracy: 71.2%
2022-05-17 22:02:50,211 reid_baseline.train INFO: normal accuracy 0.7316963280018022 1.121641993522644 
2022-05-17 22:02:50,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-17 22:02:50,212 reid_baseline.train INFO: Source Clean Accuracy: 73.2%
2022-05-17 22:02:58,797 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_Dom_Cls_LEP
2022-05-17 22:02:58,798 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_Dom_Cls_LEP', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Product.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=True, layer_num=1, pretrain_path='../logs/pretrain/deit_base/office-home/Product_2Real_World/transformer_best_model.pth')
2022-05-17 22:02:58,798 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-17 22:02:58,798 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-17 22:02:58,799 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_Dom_Cls_LEP
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Product and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4439 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 6
pretrain train
2022-05-17 22:03:14,188 reid_baseline.train INFO: start training
2022-05-17 22:04:32,440 reid_baseline.train INFO: Epoch[1] Iteration[100/278] Loss: 1.606, Acc: 0.371, Base Lr: 8.72e-04
2022-05-17 22:05:42,070 reid_baseline.train INFO: Epoch[1] Iteration[200/278] Loss: 1.347, Acc: 0.549, Base Lr: 8.72e-04
2022-05-17 22:06:34,520 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-17 22:15:18,987 reid_baseline.train INFO: normal accuracy 0.3770943309616709 1.4977130889892578 
2022-05-17 22:15:20,074 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-17 22:15:20,074 reid_baseline.train INFO: Accuracy: 37.7% Mean Entropy: 149.8%
2022-05-17 22:16:35,157 reid_baseline.train INFO: Epoch[2] Iteration[100/278] Loss: 0.821, Acc: 0.846, Base Lr: 1.66e-03
2022-05-17 22:17:38,594 reid_baseline.train INFO: Epoch[2] Iteration[200/278] Loss: 0.774, Acc: 0.866, Base Lr: 1.66e-03
2022-05-17 22:18:32,700 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.693[s] Speed: 23.1[samples/s]
2022-05-17 22:27:45,650 reid_baseline.train INFO: normal accuracy 0.4544202066590126 1.3603501319885254 
2022-05-17 22:27:46,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-17 22:27:46,620 reid_baseline.train INFO: Accuracy: 45.4% Mean Entropy: 136.0%
2022-05-17 22:28:58,177 reid_baseline.train INFO: Epoch[3] Iteration[100/278] Loss: 0.655, Acc: 0.924, Base Lr: 2.46e-03
2022-05-17 22:30:12,783 reid_baseline.train INFO: Epoch[3] Iteration[200/278] Loss: 0.647, Acc: 0.929, Base Lr: 2.46e-03
2022-05-17 22:31:07,362 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.722[s] Speed: 22.2[samples/s]
2022-05-17 22:39:50,206 reid_baseline.train INFO: normal accuracy 0.5223777828781272 1.3279783725738525 
2022-05-17 22:39:51,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-17 22:39:51,435 reid_baseline.train INFO: Accuracy: 52.2% Mean Entropy: 132.8%
2022-05-17 22:41:11,811 reid_baseline.train INFO: Epoch[4] Iteration[100/278] Loss: 0.626, Acc: 0.934, Base Lr: 3.25e-03
2022-05-17 22:42:27,904 reid_baseline.train INFO: Epoch[4] Iteration[200/278] Loss: 0.618, Acc: 0.935, Base Lr: 3.25e-03
2022-05-17 22:43:25,175 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.769[s] Speed: 20.8[samples/s]
2022-05-17 22:52:21,792 reid_baseline.train INFO: normal accuracy 0.5555555555555556 1.2854067087173462 
2022-05-17 22:52:23,054 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-17 22:52:23,055 reid_baseline.train INFO: Accuracy: 55.6% Mean Entropy: 128.5%
2022-05-17 22:53:50,785 reid_baseline.train INFO: Epoch[5] Iteration[100/278] Loss: 0.633, Acc: 0.932, Base Lr: 4.04e-03
2022-05-17 22:55:05,232 reid_baseline.train INFO: Epoch[5] Iteration[200/278] Loss: 0.619, Acc: 0.935, Base Lr: 4.04e-03
2022-05-17 22:55:59,023 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.777[s] Speed: 20.6[samples/s]
2022-05-17 23:05:21,234 reid_baseline.train INFO: normal accuracy 0.5281156759238008 1.216110110282898 
2022-05-17 23:05:21,234 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-17 23:05:21,235 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 121.6%
2022-05-17 23:07:07,350 reid_baseline.train INFO: Epoch[6] Iteration[100/278] Loss: 0.613, Acc: 0.945, Base Lr: 4.83e-03
2022-05-17 23:08:46,703 reid_baseline.train INFO: Epoch[6] Iteration[200/278] Loss: 0.607, Acc: 0.944, Base Lr: 4.83e-03
2022-05-17 23:10:05,475 reid_baseline.train INFO: Epoch 6 done. Time per batch: 1.022[s] Speed: 15.7[samples/s]
2022-05-17 23:20:32,854 reid_baseline.train INFO: normal accuracy 0.5820518705531329 1.2197141647338867 
2022-05-17 23:20:34,417 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-17 23:20:34,418 reid_baseline.train INFO: Accuracy: 58.2% Mean Entropy: 122.0%
2022-05-17 23:22:20,507 reid_baseline.train INFO: Epoch[7] Iteration[100/278] Loss: 0.597, Acc: 0.953, Base Lr: 5.62e-03
2022-05-17 23:24:01,547 reid_baseline.train INFO: Epoch[7] Iteration[200/278] Loss: 0.607, Acc: 0.948, Base Lr: 5.62e-03
2022-05-17 23:25:19,247 reid_baseline.train INFO: Epoch 7 done. Time per batch: 1.024[s] Speed: 15.6[samples/s]
2022-05-17 23:35:40,945 reid_baseline.train INFO: normal accuracy 0.5976589396373652 1.1850296258926392 
2022-05-17 23:35:42,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-17 23:35:42,571 reid_baseline.train INFO: Accuracy: 59.8% Mean Entropy: 118.5%
2022-05-17 23:37:36,003 reid_baseline.train INFO: Epoch[8] Iteration[100/278] Loss: 0.597, Acc: 0.952, Base Lr: 6.42e-03
2022-05-17 23:39:15,963 reid_baseline.train INFO: Epoch[8] Iteration[200/278] Loss: 0.596, Acc: 0.949, Base Lr: 6.42e-03
2022-05-17 23:40:29,680 reid_baseline.train INFO: Epoch 8 done. Time per batch: 1.033[s] Speed: 15.5[samples/s]
2022-05-17 23:50:40,006 reid_baseline.train INFO: normal accuracy 0.5586412669267845 1.1506019830703735 
2022-05-17 23:50:40,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-17 23:50:40,007 reid_baseline.train INFO: Accuracy: 55.9% Mean Entropy: 115.1%
2022-05-17 23:52:29,007 reid_baseline.train INFO: Epoch[9] Iteration[100/278] Loss: 0.601, Acc: 0.943, Base Lr: 7.21e-03
2022-05-17 23:54:09,629 reid_baseline.train INFO: Epoch[9] Iteration[200/278] Loss: 0.599, Acc: 0.942, Base Lr: 7.21e-03
2022-05-17 23:55:26,767 reid_baseline.train INFO: Epoch 9 done. Time per batch: 1.031[s] Speed: 15.5[samples/s]
2022-05-18 00:05:33,508 reid_baseline.train INFO: normal accuracy 0.5882487950424604 1.1566003561019897 
2022-05-18 00:05:33,508 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-18 00:05:33,509 reid_baseline.train INFO: Accuracy: 58.8% Mean Entropy: 115.7%
2022-05-18 00:07:22,423 reid_baseline.train INFO: Epoch[10] Iteration[100/278] Loss: 0.593, Acc: 0.955, Base Lr: 4.01e-03
2022-05-18 00:09:03,912 reid_baseline.train INFO: Epoch[10] Iteration[200/278] Loss: 0.593, Acc: 0.951, Base Lr: 4.01e-03
2022-05-18 00:10:12,957 reid_baseline.train INFO: Epoch 10 done. Time per batch: 1.004[s] Speed: 15.9[samples/s]
2022-05-18 00:20:29,461 reid_baseline.train INFO: normal accuracy 0.6286435620840027 1.1694424152374268 
2022-05-18 00:20:30,761 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-18 00:20:30,763 reid_baseline.train INFO: Accuracy: 62.9% Mean Entropy: 116.9%
2022-05-18 00:22:20,114 reid_baseline.train INFO: Epoch[11] Iteration[100/278] Loss: 0.587, Acc: 0.951, Base Lr: 3.38e-03
2022-05-18 00:23:49,539 reid_baseline.train INFO: Epoch[11] Iteration[200/278] Loss: 0.582, Acc: 0.953, Base Lr: 3.38e-03
2022-05-18 00:24:49,867 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.931[s] Speed: 17.2[samples/s]
2022-05-18 00:35:04,924 reid_baseline.train INFO: normal accuracy 0.5990360339683268 1.1585087776184082 
2022-05-18 00:35:04,927 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-18 00:35:04,927 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 115.9%
2022-05-18 00:36:49,176 reid_baseline.train INFO: Epoch[12] Iteration[100/278] Loss: 0.596, Acc: 0.949, Base Lr: 2.77e-03
2022-05-18 00:38:08,860 reid_baseline.train INFO: Epoch[12] Iteration[200/278] Loss: 0.581, Acc: 0.956, Base Lr: 2.77e-03
2022-05-18 00:39:25,493 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.936[s] Speed: 17.1[samples/s]
2022-05-18 00:49:38,679 reid_baseline.train INFO: normal accuracy 0.6214416896235078 1.1716636419296265 
2022-05-18 00:49:38,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-18 00:49:38,683 reid_baseline.train INFO: Accuracy: 62.1% Mean Entropy: 117.2%
2022-05-18 00:51:16,399 reid_baseline.train INFO: Epoch[13] Iteration[100/278] Loss: 0.579, Acc: 0.956, Base Lr: 2.20e-03
2022-05-18 00:52:55,286 reid_baseline.train INFO: Epoch[13] Iteration[200/278] Loss: 0.577, Acc: 0.958, Base Lr: 2.20e-03
2022-05-18 00:54:06,859 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.964[s] Speed: 16.6[samples/s]
2022-05-18 01:04:23,734 reid_baseline.train INFO: normal accuracy 0.6497590084920817 1.175571322441101 
2022-05-18 01:04:25,053 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-18 01:04:25,053 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 117.6%
2022-05-18 01:06:13,129 reid_baseline.train INFO: Epoch[14] Iteration[100/278] Loss: 0.574, Acc: 0.956, Base Lr: 1.66e-03
2022-05-18 01:07:48,680 reid_baseline.train INFO: Epoch[14] Iteration[200/278] Loss: 0.570, Acc: 0.961, Base Lr: 1.66e-03
2022-05-18 01:08:58,883 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.985[s] Speed: 16.2[samples/s]
2022-05-18 01:19:16,422 reid_baseline.train INFO: normal accuracy 0.6043148955703466 1.164118766784668 
2022-05-18 01:19:16,424 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-18 01:19:16,424 reid_baseline.train INFO: Accuracy: 60.4% Mean Entropy: 116.4%
2022-05-18 01:20:53,473 reid_baseline.train INFO: Epoch[15] Iteration[100/278] Loss: 0.575, Acc: 0.961, Base Lr: 1.19e-03
2022-05-18 01:22:09,996 reid_baseline.train INFO: Epoch[15] Iteration[200/278] Loss: 0.578, Acc: 0.959, Base Lr: 1.19e-03
2022-05-18 01:23:09,103 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.837[s] Speed: 19.1[samples/s]
2022-05-18 01:32:10,470 reid_baseline.train INFO: normal accuracy 0.6295616249713105 1.1707712411880493 
2022-05-18 01:32:10,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-18 01:32:10,472 reid_baseline.train INFO: Accuracy: 63.0% Mean Entropy: 117.1%
2022-05-18 01:33:26,726 reid_baseline.train INFO: Epoch[16] Iteration[100/278] Loss: 0.574, Acc: 0.955, Base Lr: 7.78e-04
2022-05-18 01:34:46,111 reid_baseline.train INFO: Epoch[16] Iteration[200/278] Loss: 0.576, Acc: 0.959, Base Lr: 7.78e-04
2022-05-18 01:35:43,307 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.766[s] Speed: 20.9[samples/s]
2022-05-18 01:45:31,640 reid_baseline.train INFO: normal accuracy 0.6049127640036731 1.1581288576126099 
2022-05-18 01:45:31,641 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-18 01:45:31,641 reid_baseline.train INFO: Accuracy: 60.5% Mean Entropy: 115.8%
2022-05-18 01:47:11,576 reid_baseline.train INFO: Epoch[17] Iteration[100/278] Loss: 0.579, Acc: 0.958, Base Lr: 4.51e-04
2022-05-18 01:48:47,963 reid_baseline.train INFO: Epoch[17] Iteration[200/278] Loss: 0.567, Acc: 0.967, Base Lr: 4.51e-04
2022-05-18 01:50:08,823 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.997[s] Speed: 16.1[samples/s]
2022-05-18 01:59:36,843 reid_baseline.train INFO: normal accuracy 0.5974294239155382 1.1628170013427734 
2022-05-18 01:59:36,844 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-18 01:59:36,844 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 116.3%
2022-05-18 02:01:05,338 reid_baseline.train INFO: Epoch[18] Iteration[100/278] Loss: 0.572, Acc: 0.961, Base Lr: 2.11e-04
2022-05-18 02:02:24,744 reid_baseline.train INFO: Epoch[18] Iteration[200/278] Loss: 0.573, Acc: 0.960, Base Lr: 2.11e-04
2022-05-18 02:03:21,272 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.807[s] Speed: 19.8[samples/s]
2022-05-18 02:11:18,634 reid_baseline.train INFO: normal accuracy 0.6100527886160202 1.1562520265579224 
2022-05-18 02:11:18,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-18 02:11:18,635 reid_baseline.train INFO: Accuracy: 61.0% Mean Entropy: 115.6%
2022-05-18 02:12:22,193 reid_baseline.train INFO: Epoch[19] Iteration[100/278] Loss: 0.574, Acc: 0.961, Base Lr: 6.51e-05
2022-05-18 02:13:20,435 reid_baseline.train INFO: Epoch[19] Iteration[200/278] Loss: 0.576, Acc: 0.960, Base Lr: 6.51e-05
2022-05-18 02:14:02,929 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.591[s] Speed: 27.1[samples/s]
2022-05-18 02:21:18,176 reid_baseline.train INFO: normal accuracy 0.6144135873307321 1.1436631679534912 
2022-05-18 02:21:18,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-18 02:21:18,177 reid_baseline.train INFO: Accuracy: 61.4% Mean Entropy: 114.4%
2022-05-18 02:22:22,342 reid_baseline.train INFO: Epoch[20] Iteration[100/278] Loss: 0.576, Acc: 0.959, Base Lr: 1.60e-05
2022-05-18 02:23:17,287 reid_baseline.train INFO: Epoch[20] Iteration[200/278] Loss: 0.580, Acc: 0.958, Base Lr: 1.60e-05
2022-05-18 02:24:07,653 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.610[s] Speed: 26.2[samples/s]
2022-05-18 02:31:28,582 reid_baseline.train INFO: normal accuracy 0.6410374110626578 1.157379388809204 
2022-05-18 02:31:28,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-18 02:31:28,583 reid_baseline.train INFO: Accuracy: 64.1% Mean Entropy: 115.7%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Product_2_Real_WorldSO_Dom_Cls_LEP/transformer_best_model.pth
2022-05-18 02:39:03,081 reid_baseline.train INFO: normal accuracy 0.6453982097773697 1.1790560483932495 
2022-05-18 02:39:03,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 02:39:03,082 reid_baseline.train INFO: Accuracy: 64.5%
2022-05-18 02:41:45,999 reid_baseline.train INFO: normal accuracy 0.7391304347826086 1.143984079360962 
2022-05-18 02:41:46,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-18 02:41:46,000 reid_baseline.train INFO: Source Clean Accuracy: 73.9%
