2022-04-14 03:25:41,367 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2
2022-04-14 03:25:41,368 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-14 03:25:41,368 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 03:25:41,368 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 03:25:41,368 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 03:25:48,839 reid_baseline.train INFO: start training
2022-04-14 03:26:01,646 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.128, Acc: 0.266, Base Lr: 4.76e-04
2022-04-14 03:26:13,483 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.074, Acc: 0.396, Base Lr: 4.76e-04
2022-04-14 03:26:22,698 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.124[s] Speed: 129.3[samples/s]
2022-04-14 03:26:43,392 reid_baseline.train INFO: normal accuracy 0.562514079747691 4.169760227203369 
2022-04-14 03:26:44,363 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 03:26:44,363 reid_baseline.train INFO: Accuracy: 56.3% Mean Entropy: 417.0%
2022-04-14 03:26:57,026 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.768, Acc: 0.623, Base Lr: 8.72e-04
2022-04-14 03:27:08,559 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.664, Acc: 0.621, Base Lr: 8.72e-04
2022-04-14 03:27:17,344 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.120[s] Speed: 133.2[samples/s]
2022-04-14 03:27:38,071 reid_baseline.train INFO: normal accuracy 0.5769317413831944 4.128147125244141 
2022-04-14 03:27:38,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 03:27:38,903 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 412.8%
2022-04-14 03:27:52,157 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.118, Acc: 0.636, Base Lr: 1.27e-03
2022-04-14 03:28:04,595 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.990, Acc: 0.632, Base Lr: 1.27e-03
2022-04-14 03:28:13,642 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.127[s] Speed: 125.8[samples/s]
2022-04-14 03:28:34,677 reid_baseline.train INFO: normal accuracy 0.6222122099571976 3.8807215690612793 
2022-04-14 03:28:35,490 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 03:28:35,490 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 388.1%
2022-04-14 03:28:48,220 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.391, Acc: 0.668, Base Lr: 1.66e-03
2022-04-14 03:28:59,820 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.296, Acc: 0.675, Base Lr: 1.66e-03
2022-04-14 03:29:08,596 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.121[s] Speed: 132.7[samples/s]
2022-04-14 03:29:29,511 reid_baseline.train INFO: normal accuracy 0.6632124352331606 3.3855140209198 
2022-04-14 03:29:30,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 03:29:30,351 reid_baseline.train INFO: Accuracy: 66.3% Mean Entropy: 338.6%
2022-04-14 03:29:43,137 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.864, Acc: 0.742, Base Lr: 2.06e-03
2022-04-14 03:29:54,680 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.823, Acc: 0.749, Base Lr: 2.06e-03
2022-04-14 03:30:03,149 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.120[s] Speed: 133.2[samples/s]
2022-04-14 03:30:23,990 reid_baseline.train INFO: normal accuracy 0.7186303221446272 2.8691041469573975 
2022-04-14 03:30:24,862 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 03:30:24,863 reid_baseline.train INFO: Accuracy: 71.9% Mean Entropy: 286.9%
2022-04-14 03:30:37,472 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.549, Acc: 0.803, Base Lr: 2.46e-03
2022-04-14 03:30:49,309 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.528, Acc: 0.809, Base Lr: 2.46e-03
2022-04-14 03:30:57,720 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.120[s] Speed: 133.1[samples/s]
2022-04-14 03:31:18,485 reid_baseline.train INFO: normal accuracy 0.7463392656003605 2.4614577293395996 
2022-04-14 03:31:21,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 03:31:21,017 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 246.1%
2022-04-14 03:31:33,800 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.387, Acc: 0.837, Base Lr: 2.85e-03
2022-04-14 03:31:45,660 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.358, Acc: 0.842, Base Lr: 2.85e-03
2022-04-14 03:31:54,456 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.122[s] Speed: 131.1[samples/s]
2022-04-14 03:32:15,326 reid_baseline.train INFO: normal accuracy 0.7555755800856049 2.185401201248169 
2022-04-14 03:32:16,173 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 03:32:16,173 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 218.5%
2022-04-14 03:32:28,636 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.249, Acc: 0.876, Base Lr: 3.25e-03
2022-04-14 03:32:39,955 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.248, Acc: 0.870, Base Lr: 3.25e-03
2022-04-14 03:32:48,337 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 03:33:09,214 reid_baseline.train INFO: normal accuracy 0.7596305474205902 2.060056686401367 
2022-04-14 03:33:10,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 03:33:10,050 reid_baseline.train INFO: Accuracy: 76.0% Mean Entropy: 206.0%
2022-04-14 03:33:23,107 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.170, Acc: 0.888, Base Lr: 3.64e-03
2022-04-14 03:33:34,834 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.887, Base Lr: 3.64e-03
2022-04-14 03:33:43,450 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.122[s] Speed: 130.9[samples/s]
2022-04-14 03:34:04,236 reid_baseline.train INFO: normal accuracy 0.773822933093039 1.9882334470748901 
2022-04-14 03:34:05,077 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 03:34:05,077 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 198.8%
2022-04-14 03:34:18,229 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.904, Base Lr: 4.04e-03
2022-04-14 03:34:29,976 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.111, Acc: 0.903, Base Lr: 4.04e-03
2022-04-14 03:34:38,905 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.124[s] Speed: 129.3[samples/s]
2022-04-14 03:35:00,539 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.928728699684143 
2022-04-14 03:35:01,333 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 03:35:01,333 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 192.9%
2022-04-14 03:35:14,053 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.077, Acc: 0.915, Base Lr: 4.44e-03
2022-04-14 03:35:25,725 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.060, Acc: 0.922, Base Lr: 4.44e-03
2022-04-14 03:35:34,451 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 03:35:55,384 reid_baseline.train INFO: normal accuracy 0.7846361793196666 1.8446639776229858 
2022-04-14 03:35:56,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 03:35:56,212 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 184.5%
2022-04-14 03:36:09,272 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.016, Acc: 0.936, Base Lr: 4.83e-03
2022-04-14 03:36:21,215 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.026, Acc: 0.930, Base Lr: 4.83e-03
2022-04-14 03:36:29,959 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.124[s] Speed: 129.5[samples/s]
2022-04-14 03:36:50,956 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.7975245714187622 
2022-04-14 03:36:51,802 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 03:36:51,802 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 179.8%
2022-04-14 03:37:04,420 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.975, Acc: 0.946, Base Lr: 5.23e-03
2022-04-14 03:37:16,364 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.986, Acc: 0.941, Base Lr: 5.23e-03
2022-04-14 03:37:25,256 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.122[s] Speed: 130.9[samples/s]
2022-04-14 03:37:46,110 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.783020257949829 
2022-04-14 03:37:46,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 03:37:46,943 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 178.3%
2022-04-14 03:37:59,381 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.959, Acc: 0.952, Base Lr: 5.62e-03
2022-04-14 03:38:11,399 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.959, Acc: 0.953, Base Lr: 5.62e-03
2022-04-14 03:38:20,092 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.121[s] Speed: 131.8[samples/s]
2022-04-14 03:38:40,951 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.7741039991378784 
2022-04-14 03:38:41,737 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 03:38:41,738 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 177.4%
2022-04-14 03:38:54,549 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.926, Acc: 0.957, Base Lr: 6.02e-03
2022-04-14 03:39:06,134 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.938, Acc: 0.956, Base Lr: 6.02e-03
2022-04-14 03:39:14,560 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.120[s] Speed: 133.4[samples/s]
2022-04-14 03:39:35,385 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.7244285345077515 
2022-04-14 03:39:36,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 03:39:36,212 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 172.4%
2022-04-14 03:39:48,912 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.916, Acc: 0.966, Base Lr: 6.42e-03
2022-04-14 03:40:00,369 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.922, Acc: 0.960, Base Lr: 6.42e-03
2022-04-14 03:40:08,877 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.120[s] Speed: 133.8[samples/s]
2022-04-14 03:40:29,795 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6219652891159058 
2022-04-14 03:40:30,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 03:40:30,630 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 162.2%
2022-04-14 03:40:43,214 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.908, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 03:40:55,364 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.907, Acc: 0.962, Base Lr: 6.81e-03
2022-04-14 03:41:04,231 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.123[s] Speed: 130.1[samples/s]
2022-04-14 03:41:25,206 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.6557343006134033 
2022-04-14 03:41:25,207 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 03:41:25,207 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 165.6%
2022-04-14 03:41:38,066 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.892, Acc: 0.969, Base Lr: 7.21e-03
2022-04-14 03:41:49,613 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.889, Acc: 0.967, Base Lr: 7.21e-03
2022-04-14 03:41:58,021 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.120[s] Speed: 133.3[samples/s]
2022-04-14 03:42:18,845 reid_baseline.train INFO: normal accuracy 0.7801306600585718 1.74118173122406 
2022-04-14 03:42:18,845 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 03:42:18,845 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 174.1%
2022-04-14 03:42:31,940 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.874, Acc: 0.974, Base Lr: 7.60e-03
2022-04-14 03:42:43,564 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.881, Acc: 0.972, Base Lr: 7.60e-03
2022-04-14 03:42:52,265 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 03:43:13,296 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.7360273599624634 
2022-04-14 03:43:13,297 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 03:43:13,297 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 173.6%
2022-04-14 03:43:26,270 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.867, Acc: 0.971, Base Lr: 4.01e-03
2022-04-14 03:43:38,001 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.864, Acc: 0.971, Base Lr: 4.01e-03
2022-04-14 03:43:46,723 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 03:44:08,341 reid_baseline.train INFO: normal accuracy 0.7864383870241045 1.7207180261611938 
2022-04-14 03:44:08,341 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 03:44:08,341 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 172.1%
2022-04-14 03:44:21,356 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.861, Acc: 0.974, Base Lr: 3.69e-03
2022-04-14 03:44:33,047 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.863, Acc: 0.971, Base Lr: 3.69e-03
2022-04-14 03:44:41,916 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.123[s] Speed: 130.2[samples/s]
2022-04-14 03:45:02,958 reid_baseline.train INFO: normal accuracy 0.7871142149132687 1.714687466621399 
2022-04-14 03:45:02,959 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 03:45:02,959 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 171.5%
2022-04-14 03:45:15,589 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.853, Acc: 0.971, Base Lr: 3.38e-03
2022-04-14 03:45:27,417 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.852, Acc: 0.974, Base Lr: 3.38e-03
2022-04-14 03:45:35,880 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.120[s] Speed: 133.0[samples/s]
2022-04-14 03:45:56,863 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.8021349906921387 
2022-04-14 03:45:56,864 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 03:45:56,864 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 180.2%
2022-04-14 03:46:09,952 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.841, Acc: 0.976, Base Lr: 3.08e-03
2022-04-14 03:46:21,712 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.849, Acc: 0.974, Base Lr: 3.08e-03
2022-04-14 03:46:30,389 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.123[s] Speed: 130.4[samples/s]
2022-04-14 03:46:51,288 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.6886200904846191 
2022-04-14 03:46:51,289 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 03:46:51,289 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 168.9%
2022-04-14 03:47:03,808 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.833, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 03:47:15,348 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.841, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 03:47:24,049 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.120[s] Speed: 133.4[samples/s]
2022-04-14 03:47:45,217 reid_baseline.train INFO: normal accuracy 0.7763009686866411 1.7131295204162598 
2022-04-14 03:47:45,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 03:47:45,218 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 171.3%
2022-04-14 03:47:58,047 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.828, Acc: 0.982, Base Lr: 2.48e-03
2022-04-14 03:48:10,032 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.834, Acc: 0.979, Base Lr: 2.48e-03
2022-04-14 03:48:18,852 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.123[s] Speed: 130.0[samples/s]
2022-04-14 03:48:39,642 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.6777701377868652 
2022-04-14 03:48:39,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 03:48:39,643 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 167.8%
2022-04-14 03:48:52,162 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.824, Acc: 0.981, Base Lr: 2.20e-03
2022-04-14 03:49:03,614 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.825, Acc: 0.981, Base Lr: 2.20e-03
2022-04-14 03:49:12,017 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.118[s] Speed: 135.1[samples/s]
2022-04-14 03:49:32,966 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7376564741134644 
2022-04-14 03:49:32,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 03:49:32,966 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 173.8%
2022-04-14 03:49:45,737 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.822, Acc: 0.984, Base Lr: 1.92e-03
2022-04-14 03:49:57,205 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.828, Acc: 0.982, Base Lr: 1.92e-03
2022-04-14 03:50:06,142 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 03:50:27,050 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.7393031120300293 
2022-04-14 03:50:27,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 03:50:27,050 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 173.9%
2022-04-14 03:50:40,052 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.815, Acc: 0.986, Base Lr: 1.66e-03
2022-04-14 03:50:51,389 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.822, Acc: 0.982, Base Lr: 1.66e-03
2022-04-14 03:50:59,783 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.120[s] Speed: 133.6[samples/s]
2022-04-14 03:51:20,698 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.7764856815338135 
2022-04-14 03:51:20,699 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 03:51:20,699 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 177.6%
2022-04-14 03:51:33,635 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.820, Acc: 0.982, Base Lr: 1.42e-03
2022-04-14 03:51:45,502 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.826, Acc: 0.979, Base Lr: 1.42e-03
2022-04-14 03:51:53,967 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.122[s] Speed: 131.5[samples/s]
2022-04-14 03:52:15,003 reid_baseline.train INFO: normal accuracy 0.781707591799955 1.8444980382919312 
2022-04-14 03:52:15,004 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 03:52:15,004 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 184.4%
2022-04-14 03:52:27,724 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 1.19e-03
2022-04-14 03:52:39,389 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.822, Acc: 0.980, Base Lr: 1.19e-03
2022-04-14 03:52:48,053 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.121[s] Speed: 132.3[samples/s]
2022-04-14 03:53:09,818 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7611271142959595 
2022-04-14 03:53:09,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 03:53:09,818 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 176.1%
2022-04-14 03:53:22,534 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 9.72e-04
2022-04-14 03:53:33,947 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.818, Acc: 0.980, Base Lr: 9.72e-04
2022-04-14 03:53:42,717 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.120[s] Speed: 133.7[samples/s]
2022-04-14 03:54:03,549 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.8106499910354614 
2022-04-14 03:54:03,549 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 03:54:03,549 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 181.1%
2022-04-14 03:54:16,278 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 7.78e-04
2022-04-14 03:54:27,910 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.820, Acc: 0.981, Base Lr: 7.78e-04
2022-04-14 03:54:36,355 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.120[s] Speed: 133.7[samples/s]
2022-04-14 03:54:57,264 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.8083609342575073 
2022-04-14 03:54:57,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 03:54:57,264 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 180.8%
2022-04-14 03:55:09,862 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.811, Acc: 0.987, Base Lr: 6.04e-04
2022-04-14 03:55:21,258 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 6.04e-04
2022-04-14 03:55:29,622 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.118[s] Speed: 135.2[samples/s]
2022-04-14 03:55:50,453 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.7231453657150269 
2022-04-14 03:55:50,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 03:55:50,454 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 172.3%
2022-04-14 03:56:03,129 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.816, Acc: 0.982, Base Lr: 4.51e-04
2022-04-14 03:56:14,645 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.818, Acc: 0.981, Base Lr: 4.51e-04
2022-04-14 03:56:23,404 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.120[s] Speed: 132.8[samples/s]
2022-04-14 03:56:44,469 reid_baseline.train INFO: normal accuracy 0.7855372831718855 1.79721200466156 
2022-04-14 03:56:44,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 03:56:44,469 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 179.7%
2022-04-14 03:56:57,214 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.821, Acc: 0.981, Base Lr: 3.20e-04
2022-04-14 03:57:08,650 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.819, Acc: 0.985, Base Lr: 3.20e-04
2022-04-14 03:57:17,154 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.119[s] Speed: 134.2[samples/s]
2022-04-14 03:57:38,032 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.763017177581787 
2022-04-14 03:57:38,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 03:57:38,033 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 176.3%
2022-04-14 03:57:50,855 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.812, Acc: 0.985, Base Lr: 2.11e-04
2022-04-14 03:58:02,546 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.813, Acc: 0.983, Base Lr: 2.11e-04
2022-04-14 03:58:10,965 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.121[s] Speed: 132.8[samples/s]
2022-04-14 03:58:32,000 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.7668697834014893 
2022-04-14 03:58:32,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 03:58:32,001 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 176.7%
2022-04-14 03:58:44,591 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.814, Acc: 0.986, Base Lr: 1.26e-04
2022-04-14 03:58:55,898 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.818, Acc: 0.983, Base Lr: 1.26e-04
2022-04-14 03:59:04,187 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.118[s] Speed: 135.8[samples/s]
2022-04-14 03:59:25,058 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.7436871528625488 
2022-04-14 03:59:25,059 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 03:59:25,059 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 174.4%
2022-04-14 03:59:37,782 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.819, Acc: 0.981, Base Lr: 6.51e-05
2022-04-14 03:59:49,386 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.819, Acc: 0.981, Base Lr: 6.51e-05
2022-04-14 03:59:57,836 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.120[s] Speed: 133.4[samples/s]
2022-04-14 04:00:18,654 reid_baseline.train INFO: normal accuracy 0.7864383870241045 1.8553547859191895 
2022-04-14 04:00:18,655 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 04:00:18,655 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 185.5%
2022-04-14 04:00:31,080 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.821, Acc: 0.982, Base Lr: 2.83e-05
2022-04-14 04:00:42,566 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.822, Acc: 0.983, Base Lr: 2.83e-05
2022-04-14 04:00:51,177 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.119[s] Speed: 134.6[samples/s]
2022-04-14 04:01:12,082 reid_baseline.train INFO: normal accuracy 0.7855372831718855 1.8213293552398682 
2022-04-14 04:01:12,083 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 04:01:12,083 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 182.1%
2022-04-14 04:01:24,477 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.823, Acc: 0.979, Base Lr: 1.60e-05
2022-04-14 04:01:35,979 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.816, Acc: 0.983, Base Lr: 1.60e-05
2022-04-14 04:01:44,381 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 04:02:06,067 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.7544217109680176 
2022-04-14 04:02:06,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 04:02:06,068 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 175.4%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_2/transformer_best_model.pth
2022-04-14 04:02:27,437 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6219652891159058 
2022-04-14 04:02:27,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:02:27,437 reid_baseline.train INFO: Accuracy: 78.8%
2022-04-14 04:02:47,886 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6219652891159058 
2022-04-14 04:02:47,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:02:47,887 reid_baseline.train INFO: Shuffled Accuracy: 78.8%
2022-04-14 04:03:08,570 reid_baseline.train INFO: normal accuracy 0.9722794959908362 0.6473649740219116 
2022-04-14 04:03:08,571 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:03:08,571 reid_baseline.train INFO: Source Clean Accuracy: 97.2%
2022-04-14 04:03:13,122 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_3
2022-04-14 04:03:13,122 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-14 04:03:13,122 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 04:03:13,122 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 04:03:13,123 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 04:03:21,394 reid_baseline.train INFO: start training
2022-04-14 04:03:34,147 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.128, Acc: 0.261, Base Lr: 4.76e-04
2022-04-14 04:03:45,674 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.075, Acc: 0.392, Base Lr: 4.76e-04
2022-04-14 04:03:54,363 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.120[s] Speed: 132.8[samples/s]
2022-04-14 04:04:15,264 reid_baseline.train INFO: normal accuracy 0.5708492903807164 4.169801712036133 
2022-04-14 04:04:16,190 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 04:04:16,190 reid_baseline.train INFO: Accuracy: 57.1% Mean Entropy: 417.0%
2022-04-14 04:04:28,346 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.768, Acc: 0.619, Base Lr: 8.72e-04
2022-04-14 04:04:40,030 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.664, Acc: 0.614, Base Lr: 8.72e-04
2022-04-14 04:04:48,139 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.117[s] Speed: 136.7[samples/s]
2022-04-14 04:05:09,056 reid_baseline.train INFO: normal accuracy 0.5773822933093039 4.127513408660889 
2022-04-14 04:05:09,882 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 04:05:09,883 reid_baseline.train INFO: Accuracy: 57.7% Mean Entropy: 412.8%
2022-04-14 04:05:22,480 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.118, Acc: 0.642, Base Lr: 1.27e-03
2022-04-14 04:05:33,852 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.993, Acc: 0.633, Base Lr: 1.27e-03
2022-04-14 04:05:42,171 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 04:06:03,119 reid_baseline.train INFO: normal accuracy 0.6222122099571976 3.877453327178955 
2022-04-14 04:06:03,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 04:06:03,918 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 387.7%
2022-04-14 04:06:16,295 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.391, Acc: 0.673, Base Lr: 1.66e-03
2022-04-14 04:06:27,890 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.298, Acc: 0.673, Base Lr: 1.66e-03
2022-04-14 04:06:36,354 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.119[s] Speed: 134.7[samples/s]
2022-04-14 04:06:57,237 reid_baseline.train INFO: normal accuracy 0.6683937823834197 3.3858182430267334 
2022-04-14 04:06:58,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 04:06:58,072 reid_baseline.train INFO: Accuracy: 66.8% Mean Entropy: 338.6%
2022-04-14 04:07:10,299 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.862, Acc: 0.744, Base Lr: 2.06e-03
2022-04-14 04:07:21,630 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.824, Acc: 0.751, Base Lr: 2.06e-03
2022-04-14 04:07:29,864 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.116[s] Speed: 137.9[samples/s]
2022-04-14 04:07:50,745 reid_baseline.train INFO: normal accuracy 0.7213336337012841 2.8645787239074707 
2022-04-14 04:07:51,607 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 04:07:51,607 reid_baseline.train INFO: Accuracy: 72.1% Mean Entropy: 286.5%
2022-04-14 04:08:04,084 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.549, Acc: 0.809, Base Lr: 2.46e-03
2022-04-14 04:08:15,786 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.527, Acc: 0.812, Base Lr: 2.46e-03
2022-04-14 04:08:24,222 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.119[s] Speed: 134.6[samples/s]
2022-04-14 04:08:45,122 reid_baseline.train INFO: normal accuracy 0.7445370578959225 2.4714744091033936 
2022-04-14 04:08:45,951 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 04:08:45,952 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 247.1%
2022-04-14 04:08:58,100 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.397, Acc: 0.837, Base Lr: 2.85e-03
2022-04-14 04:09:09,265 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.369, Acc: 0.842, Base Lr: 2.85e-03
2022-04-14 04:09:17,522 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.116[s] Speed: 138.5[samples/s]
2022-04-14 04:09:38,546 reid_baseline.train INFO: normal accuracy 0.7535480964181122 2.208087205886841 
2022-04-14 04:09:39,356 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 04:09:39,357 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 220.8%
2022-04-14 04:09:51,780 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.252, Acc: 0.878, Base Lr: 3.25e-03
2022-04-14 04:10:03,177 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.249, Acc: 0.868, Base Lr: 3.25e-03
2022-04-14 04:10:11,419 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.117[s] Speed: 136.3[samples/s]
2022-04-14 04:10:32,344 reid_baseline.train INFO: normal accuracy 0.7632349628294661 2.080734968185425 
2022-04-14 04:10:33,182 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 04:10:33,182 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 208.1%
2022-04-14 04:10:45,371 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.169, Acc: 0.894, Base Lr: 3.64e-03
2022-04-14 04:10:56,527 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.168, Acc: 0.893, Base Lr: 3.64e-03
2022-04-14 04:11:04,903 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.116[s] Speed: 137.8[samples/s]
2022-04-14 04:11:25,746 reid_baseline.train INFO: normal accuracy 0.7713448974994368 1.9899921417236328 
2022-04-14 04:11:26,600 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 04:11:26,600 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 199.0%
2022-04-14 04:11:39,024 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.110, Acc: 0.900, Base Lr: 4.04e-03
2022-04-14 04:11:50,229 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.106, Acc: 0.902, Base Lr: 4.04e-03
2022-04-14 04:11:58,355 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.116[s] Speed: 137.6[samples/s]
2022-04-14 04:12:20,049 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.9200507402420044 
2022-04-14 04:12:22,518 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 04:12:22,519 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 192.0%
2022-04-14 04:12:34,711 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.070, Acc: 0.917, Base Lr: 4.44e-03
2022-04-14 04:12:45,774 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.059, Acc: 0.925, Base Lr: 4.44e-03
2022-04-14 04:12:54,079 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.116[s] Speed: 138.5[samples/s]
2022-04-14 04:13:15,003 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.8376340866088867 
2022-04-14 04:13:15,819 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 04:13:15,819 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 183.8%
2022-04-14 04:13:27,897 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.017, Acc: 0.938, Base Lr: 4.83e-03
2022-04-14 04:13:38,895 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.028, Acc: 0.931, Base Lr: 4.83e-03
2022-04-14 04:13:47,286 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.115[s] Speed: 138.9[samples/s]
2022-04-14 04:14:08,237 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.8074449300765991 
2022-04-14 04:14:09,082 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 04:14:09,082 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 180.7%
2022-04-14 04:14:21,095 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.978, Acc: 0.944, Base Lr: 5.23e-03
2022-04-14 04:14:32,794 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.990, Acc: 0.939, Base Lr: 5.23e-03
2022-04-14 04:14:41,131 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.117[s] Speed: 136.7[samples/s]
2022-04-14 04:15:02,145 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.7930829524993896 
2022-04-14 04:15:02,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 04:15:02,988 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 179.3%
2022-04-14 04:15:15,247 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.958, Acc: 0.956, Base Lr: 5.62e-03
2022-04-14 04:15:26,543 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.958, Acc: 0.953, Base Lr: 5.62e-03
2022-04-14 04:15:34,761 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.116[s] Speed: 138.3[samples/s]
2022-04-14 04:15:55,761 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.8033089637756348 
2022-04-14 04:15:55,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 04:15:55,762 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 180.3%
2022-04-14 04:16:08,336 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.929, Acc: 0.957, Base Lr: 6.02e-03
2022-04-14 04:16:19,890 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.939, Acc: 0.953, Base Lr: 6.02e-03
2022-04-14 04:16:28,139 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.119[s] Speed: 135.0[samples/s]
2022-04-14 04:16:48,933 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.7363582849502563 
2022-04-14 04:16:49,769 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 04:16:49,769 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 173.6%
2022-04-14 04:17:01,846 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.925, Acc: 0.962, Base Lr: 6.42e-03
2022-04-14 04:17:13,467 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.927, Acc: 0.958, Base Lr: 6.42e-03
2022-04-14 04:17:21,975 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.118[s] Speed: 135.7[samples/s]
2022-04-14 04:17:42,957 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.6688576936721802 
2022-04-14 04:17:43,802 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 04:17:43,802 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 166.9%
2022-04-14 04:17:55,925 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.910, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 04:18:07,177 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.911, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 04:18:15,353 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.115[s] Speed: 138.6[samples/s]
2022-04-14 04:18:36,310 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.6532710790634155 
2022-04-14 04:18:37,149 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 04:18:37,150 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 165.3%
2022-04-14 04:18:49,374 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.895, Acc: 0.962, Base Lr: 7.21e-03
2022-04-14 04:19:00,456 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.889, Acc: 0.967, Base Lr: 7.21e-03
2022-04-14 04:19:08,808 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.116[s] Speed: 138.1[samples/s]
2022-04-14 04:19:29,697 reid_baseline.train INFO: normal accuracy 0.7763009686866411 1.722831130027771 
2022-04-14 04:19:29,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 04:19:29,697 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 172.3%
2022-04-14 04:19:42,240 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.873, Acc: 0.972, Base Lr: 7.60e-03
2022-04-14 04:19:53,729 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.880, Acc: 0.970, Base Lr: 7.60e-03
2022-04-14 04:20:02,147 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.119[s] Speed: 134.7[samples/s]
2022-04-14 04:20:23,026 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.740465760231018 
2022-04-14 04:20:23,026 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 04:20:23,027 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 174.0%
2022-04-14 04:20:35,222 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.861, Acc: 0.975, Base Lr: 4.01e-03
2022-04-14 04:20:46,402 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.863, Acc: 0.974, Base Lr: 4.01e-03
2022-04-14 04:20:54,826 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.116[s] Speed: 137.5[samples/s]
2022-04-14 04:21:16,467 reid_baseline.train INFO: normal accuracy 0.779004280243298 1.6987107992172241 
2022-04-14 04:21:16,467 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 04:21:16,468 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 169.9%
2022-04-14 04:21:28,560 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.855, Acc: 0.974, Base Lr: 3.69e-03
2022-04-14 04:21:39,609 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.862, Acc: 0.972, Base Lr: 3.69e-03
2022-04-14 04:21:47,723 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.114[s] Speed: 139.9[samples/s]
2022-04-14 04:22:08,491 reid_baseline.train INFO: normal accuracy 0.7785537283171886 1.7424355745315552 
2022-04-14 04:22:08,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 04:22:08,492 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 174.2%
2022-04-14 04:22:21,115 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.860, Acc: 0.971, Base Lr: 3.38e-03
2022-04-14 04:22:32,517 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.854, Acc: 0.973, Base Lr: 3.38e-03
2022-04-14 04:22:40,661 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 04:23:01,556 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.8004069328308105 
2022-04-14 04:23:01,557 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 04:23:01,557 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 180.0%
2022-04-14 04:23:14,182 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.842, Acc: 0.978, Base Lr: 3.08e-03
2022-04-14 04:23:25,386 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.848, Acc: 0.977, Base Lr: 3.08e-03
2022-04-14 04:23:33,896 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.118[s] Speed: 135.3[samples/s]
2022-04-14 04:23:54,981 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.697398066520691 
2022-04-14 04:23:54,981 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 04:23:54,981 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 169.7%
2022-04-14 04:24:07,403 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.838, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 04:24:18,940 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.843, Acc: 0.977, Base Lr: 2.77e-03
2022-04-14 04:24:27,275 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 04:24:48,267 reid_baseline.train INFO: normal accuracy 0.7763009686866411 1.7007628679275513 
2022-04-14 04:24:48,267 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 04:24:48,267 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 170.1%
2022-04-14 04:25:00,765 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.832, Acc: 0.983, Base Lr: 2.48e-03
2022-04-14 04:25:12,177 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.837, Acc: 0.978, Base Lr: 2.48e-03
2022-04-14 04:25:20,586 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 04:25:41,379 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.7094950675964355 
2022-04-14 04:25:41,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 04:25:41,380 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 170.9%
2022-04-14 04:25:53,804 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 2.20e-03
2022-04-14 04:26:04,905 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.828, Acc: 0.980, Base Lr: 2.20e-03
2022-04-14 04:26:13,301 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.117[s] Speed: 137.0[samples/s]
2022-04-14 04:26:34,194 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.7303285598754883 
2022-04-14 04:26:34,194 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 04:26:34,195 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 173.0%
2022-04-14 04:26:46,248 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.823, Acc: 0.985, Base Lr: 1.92e-03
2022-04-14 04:26:57,887 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.828, Acc: 0.981, Base Lr: 1.92e-03
2022-04-14 04:27:06,083 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.116[s] Speed: 137.5[samples/s]
2022-04-14 04:27:26,964 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.738629937171936 
2022-04-14 04:27:26,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 04:27:26,965 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 173.9%
2022-04-14 04:27:39,722 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.821, Acc: 0.986, Base Lr: 1.66e-03
2022-04-14 04:27:51,197 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.828, Acc: 0.981, Base Lr: 1.66e-03
2022-04-14 04:27:59,714 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.120[s] Speed: 133.6[samples/s]
2022-04-14 04:28:20,625 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.8127005100250244 
2022-04-14 04:28:20,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 04:28:20,625 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 181.3%
2022-04-14 04:28:33,108 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.821, Acc: 0.984, Base Lr: 1.42e-03
2022-04-14 04:28:44,163 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.825, Acc: 0.980, Base Lr: 1.42e-03
2022-04-14 04:28:52,398 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.116[s] Speed: 137.7[samples/s]
2022-04-14 04:29:13,261 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.8641709089279175 
2022-04-14 04:29:13,262 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 04:29:13,262 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 186.4%
2022-04-14 04:29:25,278 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.818, Acc: 0.982, Base Lr: 1.19e-03
2022-04-14 04:29:36,735 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 1.19e-03
2022-04-14 04:29:45,179 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.117[s] Speed: 137.0[samples/s]
2022-04-14 04:30:06,799 reid_baseline.train INFO: normal accuracy 0.7821581437260644 1.7556686401367188 
2022-04-14 04:30:06,799 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 04:30:06,799 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 175.6%
2022-04-14 04:30:19,117 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.817, Acc: 0.981, Base Lr: 9.72e-04
2022-04-14 04:30:30,600 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 9.72e-04
2022-04-14 04:30:39,096 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.118[s] Speed: 135.4[samples/s]
2022-04-14 04:31:00,033 reid_baseline.train INFO: normal accuracy 0.781707591799955 1.8171840906143188 
2022-04-14 04:31:00,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 04:31:00,033 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 181.7%
2022-04-14 04:31:12,426 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.811, Acc: 0.983, Base Lr: 7.78e-04
2022-04-14 04:31:23,891 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 7.78e-04
2022-04-14 04:31:32,321 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.118[s] Speed: 136.0[samples/s]
2022-04-14 04:31:53,288 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.8235549926757812 
2022-04-14 04:31:53,288 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 04:31:53,288 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 182.4%
2022-04-14 04:32:05,570 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.811, Acc: 0.990, Base Lr: 6.04e-04
2022-04-14 04:32:16,739 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.819, Acc: 0.984, Base Lr: 6.04e-04
2022-04-14 04:32:24,774 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.115[s] Speed: 139.0[samples/s]
2022-04-14 04:32:45,557 reid_baseline.train INFO: normal accuracy 0.7812570398738454 1.741331934928894 
2022-04-14 04:32:45,558 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 04:32:45,558 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 174.1%
2022-04-14 04:32:57,576 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.816, Acc: 0.984, Base Lr: 4.51e-04
2022-04-14 04:33:08,709 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.819, Acc: 0.981, Base Lr: 4.51e-04
2022-04-14 04:33:17,034 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.115[s] Speed: 139.0[samples/s]
2022-04-14 04:33:37,971 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.813346028327942 
2022-04-14 04:33:37,971 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 04:33:37,971 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 181.3%
2022-04-14 04:33:50,065 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.817, Acc: 0.978, Base Lr: 3.20e-04
2022-04-14 04:34:01,167 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.817, Acc: 0.981, Base Lr: 3.20e-04
2022-04-14 04:34:09,447 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.115[s] Speed: 138.9[samples/s]
2022-04-14 04:34:30,285 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.7722201347351074 
2022-04-14 04:34:30,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 04:34:30,286 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 177.2%
2022-04-14 04:34:42,698 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.808, Acc: 0.984, Base Lr: 2.11e-04
2022-04-14 04:34:54,133 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.811, Acc: 0.982, Base Lr: 2.11e-04
2022-04-14 04:35:02,561 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 04:35:23,584 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.7723026275634766 
2022-04-14 04:35:23,584 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 04:35:23,584 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 177.2%
2022-04-14 04:35:35,725 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.816, Acc: 0.984, Base Lr: 1.26e-04
2022-04-14 04:35:46,745 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.816, Acc: 0.984, Base Lr: 1.26e-04
2022-04-14 04:35:54,818 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.114[s] Speed: 140.0[samples/s]
2022-04-14 04:36:15,649 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.7486331462860107 
2022-04-14 04:36:15,649 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 04:36:15,649 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 174.9%
2022-04-14 04:36:27,898 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.821, Acc: 0.978, Base Lr: 6.51e-05
2022-04-14 04:36:39,058 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.820, Acc: 0.980, Base Lr: 6.51e-05
2022-04-14 04:36:47,376 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.116[s] Speed: 137.8[samples/s]
2022-04-14 04:37:08,315 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.8747354745864868 
2022-04-14 04:37:08,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 04:37:08,315 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 187.5%
2022-04-14 04:37:20,595 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.819, Acc: 0.977, Base Lr: 2.83e-05
2022-04-14 04:37:31,828 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.820, Acc: 0.979, Base Lr: 2.83e-05
2022-04-14 04:37:39,937 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.115[s] Speed: 138.5[samples/s]
2022-04-14 04:38:00,771 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.8333120346069336 
2022-04-14 04:38:00,771 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 04:38:00,772 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 183.3%
2022-04-14 04:38:13,660 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.818, Acc: 0.981, Base Lr: 1.60e-05
2022-04-14 04:38:25,034 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.815, Acc: 0.984, Base Lr: 1.60e-05
2022-04-14 04:38:33,506 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.119[s] Speed: 134.2[samples/s]
2022-04-14 04:38:55,147 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.7777975797653198 
2022-04-14 04:38:55,148 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 04:38:55,148 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 177.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_3/transformer_best_model.pth
2022-04-14 04:39:16,377 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.6532710790634155 
2022-04-14 04:39:16,378 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:39:16,378 reid_baseline.train INFO: Accuracy: 77.8%
2022-04-14 04:39:36,559 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.6532710790634155 
2022-04-14 04:39:36,559 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:39:36,559 reid_baseline.train INFO: Shuffled Accuracy: 77.8%
2022-04-14 04:39:57,147 reid_baseline.train INFO: normal accuracy 0.975028636884307 0.6349119544029236 
2022-04-14 04:39:57,147 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 04:39:57,147 reid_baseline.train INFO: Source Clean Accuracy: 97.5%
2022-04-14 04:40:01,379 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_4
2022-04-14 04:40:01,379 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-14 04:40:01,379 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-14 04:40:01,379 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-14 04:40:01,379 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-14 04:40:08,986 reid_baseline.train INFO: start training
2022-04-14 04:40:22,542 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.127, Acc: 0.269, Base Lr: 4.76e-04
2022-04-14 04:40:34,350 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.074, Acc: 0.403, Base Lr: 4.76e-04
2022-04-14 04:40:43,059 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.124[s] Speed: 129.3[samples/s]
2022-04-14 04:41:03,994 reid_baseline.train INFO: normal accuracy 0.5643162874521288 4.169785976409912 
2022-04-14 04:41:04,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-14 04:41:04,785 reid_baseline.train INFO: Accuracy: 56.4% Mean Entropy: 417.0%
2022-04-14 04:41:17,566 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.768, Acc: 0.621, Base Lr: 8.72e-04
2022-04-14 04:41:29,309 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.664, Acc: 0.616, Base Lr: 8.72e-04
2022-04-14 04:41:37,886 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.121[s] Speed: 132.0[samples/s]
2022-04-14 04:41:58,767 reid_baseline.train INFO: normal accuracy 0.5778328452354133 4.127154350280762 
2022-04-14 04:41:59,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-14 04:41:59,664 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 412.7%
2022-04-14 04:42:12,508 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.120, Acc: 0.636, Base Lr: 1.27e-03
2022-04-14 04:42:24,135 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.989, Acc: 0.634, Base Lr: 1.27e-03
2022-04-14 04:42:32,684 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.120[s] Speed: 132.8[samples/s]
2022-04-14 04:42:53,568 reid_baseline.train INFO: normal accuracy 0.6197341743635955 3.8775320053100586 
2022-04-14 04:42:54,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-14 04:42:54,352 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 387.8%
2022-04-14 04:43:07,554 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.390, Acc: 0.675, Base Lr: 1.66e-03
2022-04-14 04:43:19,596 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.299, Acc: 0.678, Base Lr: 1.66e-03
2022-04-14 04:43:28,430 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.125[s] Speed: 128.4[samples/s]
2022-04-14 04:43:49,235 reid_baseline.train INFO: normal accuracy 0.6683937823834197 3.381577491760254 
2022-04-14 04:43:50,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-14 04:43:50,073 reid_baseline.train INFO: Accuracy: 66.8% Mean Entropy: 338.2%
2022-04-14 04:44:03,256 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.860, Acc: 0.746, Base Lr: 2.06e-03
2022-04-14 04:44:15,155 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.822, Acc: 0.751, Base Lr: 2.06e-03
2022-04-14 04:44:24,289 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.125[s] Speed: 127.9[samples/s]
2022-04-14 04:44:45,075 reid_baseline.train INFO: normal accuracy 0.717053390403244 2.859821081161499 
2022-04-14 04:44:45,916 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-14 04:44:45,917 reid_baseline.train INFO: Accuracy: 71.7% Mean Entropy: 286.0%
2022-04-14 04:44:58,710 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.542, Acc: 0.808, Base Lr: 2.46e-03
2022-04-14 04:45:10,263 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.525, Acc: 0.807, Base Lr: 2.46e-03
2022-04-14 04:45:18,945 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.121[s] Speed: 132.3[samples/s]
2022-04-14 04:45:39,751 reid_baseline.train INFO: normal accuracy 0.7461139896373057 2.4686529636383057 
2022-04-14 04:45:40,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-14 04:45:40,594 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 246.9%
2022-04-14 04:45:53,370 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.390, Acc: 0.839, Base Lr: 2.85e-03
2022-04-14 04:46:05,321 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.362, Acc: 0.842, Base Lr: 2.85e-03
2022-04-14 04:46:14,220 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.123[s] Speed: 130.1[samples/s]
2022-04-14 04:46:35,136 reid_baseline.train INFO: normal accuracy 0.7560261320117143 2.19041109085083 
2022-04-14 04:46:35,972 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-14 04:46:35,972 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 219.0%
2022-04-14 04:46:48,724 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.253, Acc: 0.866, Base Lr: 3.25e-03
2022-04-14 04:47:00,836 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.245, Acc: 0.868, Base Lr: 3.25e-03
2022-04-14 04:47:09,829 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.123[s] Speed: 129.8[samples/s]
2022-04-14 04:47:30,714 reid_baseline.train INFO: normal accuracy 0.7605316512728092 2.056344747543335 
2022-04-14 04:47:31,565 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-14 04:47:31,566 reid_baseline.train INFO: Accuracy: 76.1% Mean Entropy: 205.6%
2022-04-14 04:47:44,194 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.160, Acc: 0.892, Base Lr: 3.64e-03
2022-04-14 04:47:55,547 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.164, Acc: 0.891, Base Lr: 3.64e-03
2022-04-14 04:48:03,902 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.118[s] Speed: 135.1[samples/s]
2022-04-14 04:48:24,724 reid_baseline.train INFO: normal accuracy 0.7699932417211084 2.0205841064453125 
2022-04-14 04:48:25,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-14 04:48:25,527 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 202.1%
2022-04-14 04:48:38,463 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.113, Acc: 0.904, Base Lr: 4.04e-03
2022-04-14 04:48:50,624 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.108, Acc: 0.906, Base Lr: 4.04e-03
2022-04-14 04:48:59,703 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.125[s] Speed: 128.0[samples/s]
2022-04-14 04:49:21,364 reid_baseline.train INFO: normal accuracy 0.7772020725388601 1.9049078226089478 
2022-04-14 04:49:22,151 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-14 04:49:22,152 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 190.5%
2022-04-14 04:49:35,133 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.068, Acc: 0.920, Base Lr: 4.44e-03
2022-04-14 04:49:47,216 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.055, Acc: 0.925, Base Lr: 4.44e-03
2022-04-14 04:49:55,982 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.124[s] Speed: 129.2[samples/s]
2022-04-14 04:50:16,819 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.854988694190979 
2022-04-14 04:50:17,654 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-14 04:50:17,654 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 185.5%
2022-04-14 04:50:30,624 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.017, Acc: 0.936, Base Lr: 4.83e-03
2022-04-14 04:50:42,791 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.020, Acc: 0.932, Base Lr: 4.83e-03
2022-04-14 04:50:51,849 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.125[s] Speed: 127.8[samples/s]
2022-04-14 04:51:12,734 reid_baseline.train INFO: normal accuracy 0.779004280243298 1.8189339637756348 
2022-04-14 04:51:13,514 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-14 04:51:13,514 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 181.9%
2022-04-14 04:51:26,574 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.971, Acc: 0.952, Base Lr: 5.23e-03
2022-04-14 04:51:38,339 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.984, Acc: 0.941, Base Lr: 5.23e-03
2022-04-14 04:51:46,691 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.121[s] Speed: 132.1[samples/s]
2022-04-14 04:52:07,501 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.8016083240509033 
2022-04-14 04:52:08,287 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-14 04:52:08,287 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 180.2%
2022-04-14 04:52:20,667 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.959, Acc: 0.952, Base Lr: 5.62e-03
2022-04-14 04:52:32,128 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.957, Acc: 0.954, Base Lr: 5.62e-03
2022-04-14 04:52:40,547 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.118[s] Speed: 135.5[samples/s]
2022-04-14 04:53:01,308 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.7643437385559082 
2022-04-14 04:53:02,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-14 04:53:02,108 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 176.4%
2022-04-14 04:53:15,298 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.932, Acc: 0.954, Base Lr: 6.02e-03
2022-04-14 04:53:27,546 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.939, Acc: 0.953, Base Lr: 6.02e-03
2022-04-14 04:53:36,612 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.126[s] Speed: 126.7[samples/s]
2022-04-14 04:53:57,392 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.746514081954956 
2022-04-14 04:53:58,172 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-14 04:53:58,172 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 174.7%
2022-04-14 04:54:10,554 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.910, Acc: 0.966, Base Lr: 6.42e-03
2022-04-14 04:54:21,923 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.923, Acc: 0.959, Base Lr: 6.42e-03
2022-04-14 04:54:30,405 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.118[s] Speed: 135.6[samples/s]
2022-04-14 04:54:51,161 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.6173478364944458 
2022-04-14 04:54:51,980 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-14 04:54:51,980 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 161.7%
2022-04-14 04:55:04,761 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.911, Acc: 0.967, Base Lr: 6.81e-03
2022-04-14 04:55:16,238 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.911, Acc: 0.964, Base Lr: 6.81e-03
2022-04-14 04:55:24,649 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.120[s] Speed: 133.8[samples/s]
2022-04-14 04:55:45,348 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.659531831741333 
2022-04-14 04:55:45,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-14 04:55:45,348 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 166.0%
2022-04-14 04:55:58,331 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.896, Acc: 0.963, Base Lr: 7.21e-03
2022-04-14 04:56:10,384 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.891, Acc: 0.968, Base Lr: 7.21e-03
2022-04-14 04:56:19,339 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.124[s] Speed: 128.7[samples/s]
2022-04-14 04:56:40,082 reid_baseline.train INFO: normal accuracy 0.7747240369452579 1.775489091873169 
2022-04-14 04:56:40,083 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-14 04:56:40,083 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 177.5%
2022-04-14 04:56:52,759 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.876, Acc: 0.969, Base Lr: 7.60e-03
2022-04-14 04:57:04,372 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.881, Acc: 0.971, Base Lr: 7.60e-03
2022-04-14 04:57:12,866 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.120[s] Speed: 133.3[samples/s]
2022-04-14 04:57:33,592 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.69742751121521 
2022-04-14 04:57:33,593 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-14 04:57:33,593 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 169.7%
2022-04-14 04:57:46,595 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.866, Acc: 0.972, Base Lr: 4.01e-03
2022-04-14 04:57:58,551 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.864, Acc: 0.972, Base Lr: 4.01e-03
2022-04-14 04:58:07,421 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.124[s] Speed: 129.4[samples/s]
2022-04-14 04:58:28,964 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.695931077003479 
2022-04-14 04:58:28,965 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-14 04:58:28,965 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 169.6%
2022-04-14 04:58:41,190 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.854, Acc: 0.974, Base Lr: 3.69e-03
2022-04-14 04:58:52,535 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.858, Acc: 0.973, Base Lr: 3.69e-03
2022-04-14 04:59:00,878 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.117[s] Speed: 137.0[samples/s]
2022-04-14 04:59:21,509 reid_baseline.train INFO: normal accuracy 0.7758504167605317 1.724050760269165 
2022-04-14 04:59:21,510 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-14 04:59:21,510 reid_baseline.train INFO: Accuracy: 77.6% Mean Entropy: 172.4%
2022-04-14 04:59:33,871 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.857, Acc: 0.973, Base Lr: 3.38e-03
2022-04-14 04:59:45,225 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.854, Acc: 0.976, Base Lr: 3.38e-03
2022-04-14 04:59:53,644 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.118[s] Speed: 136.0[samples/s]
2022-04-14 05:00:14,336 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.787102460861206 
2022-04-14 05:00:14,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-14 05:00:14,337 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 178.7%
2022-04-14 05:00:27,141 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.838, Acc: 0.981, Base Lr: 3.08e-03
2022-04-14 05:00:39,051 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.847, Acc: 0.977, Base Lr: 3.08e-03
2022-04-14 05:00:47,824 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.123[s] Speed: 130.5[samples/s]
2022-04-14 05:01:08,533 reid_baseline.train INFO: normal accuracy 0.7781031763910791 1.7100647687911987 
2022-04-14 05:01:08,533 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-14 05:01:08,534 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 171.0%
2022-04-14 05:01:20,760 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.834, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 05:01:32,889 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.842, Acc: 0.978, Base Lr: 2.77e-03
2022-04-14 05:01:41,771 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.121[s] Speed: 131.8[samples/s]
2022-04-14 05:02:02,482 reid_baseline.train INFO: normal accuracy 0.7753998648344221 1.7133108377456665 
2022-04-14 05:02:02,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-14 05:02:02,483 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 171.3%
2022-04-14 05:02:15,297 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.835, Acc: 0.981, Base Lr: 2.48e-03
2022-04-14 05:02:27,363 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.48e-03
2022-04-14 05:02:36,296 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.124[s] Speed: 129.3[samples/s]
2022-04-14 05:02:57,097 reid_baseline.train INFO: normal accuracy 0.7785537283171886 1.696176290512085 
2022-04-14 05:02:57,097 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-14 05:02:57,098 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 169.6%
2022-04-14 05:03:09,245 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 2.20e-03
2022-04-14 05:03:20,541 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.829, Acc: 0.979, Base Lr: 2.20e-03
2022-04-14 05:03:28,865 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.116[s] Speed: 137.6[samples/s]
2022-04-14 05:03:49,732 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.7359319925308228 
2022-04-14 05:03:49,733 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-14 05:03:49,733 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 173.6%
2022-04-14 05:04:02,154 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.819, Acc: 0.984, Base Lr: 1.92e-03
2022-04-14 05:04:13,539 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.826, Acc: 0.982, Base Lr: 1.92e-03
2022-04-14 05:04:21,918 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.118[s] Speed: 135.9[samples/s]
2022-04-14 05:04:42,656 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.7424136400222778 
2022-04-14 05:04:42,656 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-14 05:04:42,657 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 174.2%
2022-04-14 05:04:55,624 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.817, Acc: 0.984, Base Lr: 1.66e-03
2022-04-14 05:05:07,753 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.825, Acc: 0.980, Base Lr: 1.66e-03
2022-04-14 05:05:16,575 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.124[s] Speed: 128.9[samples/s]
2022-04-14 05:05:37,382 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.7764226198196411 
2022-04-14 05:05:37,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-14 05:05:37,383 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 177.6%
2022-04-14 05:05:49,754 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.822, Acc: 0.978, Base Lr: 1.42e-03
2022-04-14 05:06:01,027 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.824, Acc: 0.978, Base Lr: 1.42e-03
2022-04-14 05:06:09,365 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.117[s] Speed: 137.3[samples/s]
2022-04-14 05:06:30,015 reid_baseline.train INFO: normal accuracy 0.780806487947736 1.8475706577301025 
2022-04-14 05:06:30,016 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-14 05:06:30,016 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 184.8%
2022-04-14 05:06:42,919 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.820, Acc: 0.979, Base Lr: 1.19e-03
2022-04-14 05:06:54,872 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.823, Acc: 0.979, Base Lr: 1.19e-03
2022-04-14 05:07:03,653 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.123[s] Speed: 129.9[samples/s]
2022-04-14 05:07:25,151 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.7818540334701538 
2022-04-14 05:07:25,152 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-14 05:07:25,152 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 178.2%
2022-04-14 05:07:38,113 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.815, Acc: 0.982, Base Lr: 9.72e-04
2022-04-14 05:07:50,090 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 9.72e-04
2022-04-14 05:07:58,942 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.124[s] Speed: 129.4[samples/s]
2022-04-14 05:08:19,636 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.8069452047348022 
2022-04-14 05:08:19,636 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-14 05:08:19,637 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 180.7%
2022-04-14 05:08:31,896 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.817, Acc: 0.984, Base Lr: 7.78e-04
2022-04-14 05:08:43,231 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.818, Acc: 0.983, Base Lr: 7.78e-04
2022-04-14 05:08:51,575 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.117[s] Speed: 137.0[samples/s]
2022-04-14 05:09:12,303 reid_baseline.train INFO: normal accuracy 0.7819328677630096 1.7922372817993164 
2022-04-14 05:09:12,303 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-14 05:09:12,303 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 179.2%
2022-04-14 05:09:25,373 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.811, Acc: 0.987, Base Lr: 6.04e-04
2022-04-14 05:09:37,517 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.820, Acc: 0.983, Base Lr: 6.04e-04
2022-04-14 05:09:46,267 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.124[s] Speed: 128.7[samples/s]
2022-04-14 05:10:06,937 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.7340216636657715 
2022-04-14 05:10:06,937 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-14 05:10:06,937 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 173.4%
2022-04-14 05:10:19,171 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.820, Acc: 0.984, Base Lr: 4.51e-04
2022-04-14 05:10:30,477 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.821, Acc: 0.981, Base Lr: 4.51e-04
2022-04-14 05:10:38,804 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.116[s] Speed: 137.5[samples/s]
2022-04-14 05:10:59,655 reid_baseline.train INFO: normal accuracy 0.7814823158369002 1.8046057224273682 
2022-04-14 05:10:59,655 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-14 05:10:59,655 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 180.5%
2022-04-14 05:11:13,086 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.817, Acc: 0.979, Base Lr: 3.20e-04
2022-04-14 05:11:25,297 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.816, Acc: 0.982, Base Lr: 3.20e-04
2022-04-14 05:11:34,057 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.126[s] Speed: 127.1[samples/s]
2022-04-14 05:11:54,835 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.7699307203292847 
2022-04-14 05:11:54,836 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-14 05:11:54,836 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 177.0%
2022-04-14 05:12:07,026 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.811, Acc: 0.986, Base Lr: 2.11e-04
2022-04-14 05:12:18,367 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.812, Acc: 0.984, Base Lr: 2.11e-04
2022-04-14 05:12:26,784 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.117[s] Speed: 136.8[samples/s]
2022-04-14 05:12:47,506 reid_baseline.train INFO: normal accuracy 0.781707591799955 1.757012963294983 
2022-04-14 05:12:47,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-14 05:12:47,507 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 175.7%
2022-04-14 05:13:00,214 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.814, Acc: 0.986, Base Lr: 1.26e-04
2022-04-14 05:13:12,186 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 1.26e-04
2022-04-14 05:13:20,917 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 05:13:41,683 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.7512462139129639 
2022-04-14 05:13:41,684 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-14 05:13:41,684 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 175.1%
2022-04-14 05:13:54,519 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.824, Acc: 0.980, Base Lr: 6.51e-05
2022-04-14 05:14:06,418 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.822, Acc: 0.982, Base Lr: 6.51e-05
2022-04-14 05:14:15,150 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.122[s] Speed: 130.8[samples/s]
2022-04-14 05:14:35,898 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.8598158359527588 
2022-04-14 05:14:35,899 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-14 05:14:35,899 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 186.0%
2022-04-14 05:14:48,378 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.815, Acc: 0.982, Base Lr: 2.83e-05
2022-04-14 05:15:00,482 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 2.83e-05
2022-04-14 05:15:09,421 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.123[s] Speed: 130.4[samples/s]
2022-04-14 05:15:30,175 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.8194578886032104 
2022-04-14 05:15:30,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-14 05:15:30,176 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 181.9%
2022-04-14 05:15:43,038 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 1.60e-05
2022-04-14 05:15:54,995 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.814, Acc: 0.985, Base Lr: 1.60e-05
2022-04-14 05:16:03,779 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.123[s] Speed: 130.2[samples/s]
2022-04-14 05:16:25,383 reid_baseline.train INFO: normal accuracy 0.7812570398738454 1.7713671922683716 
2022-04-14 05:16:25,383 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-14 05:16:25,383 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 177.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Product_shuffled_key_4/transformer_best_model.pth
2022-04-14 05:16:46,618 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.6173478364944458 
2022-04-14 05:16:46,619 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 05:16:46,619 reid_baseline.train INFO: Accuracy: 78.6%
2022-04-14 05:17:06,578 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.6173478364944458 
2022-04-14 05:17:06,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 05:17:06,578 reid_baseline.train INFO: Shuffled Accuracy: 78.6%
2022-04-14 05:17:27,011 reid_baseline.train INFO: normal accuracy 0.9747995418098511 0.6421921253204346 
2022-04-14 05:17:27,012 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-14 05:17:27,012 reid_baseline.train INFO: Source Clean Accuracy: 97.5%
