2022-04-15 20:45:10,775 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_6
2022-04-15 20:45:10,775 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-15 20:45:10,775 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 20:45:10,775 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 20:45:10,775 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 20:45:16,229 reid_baseline.train INFO: start training
2022-04-15 20:45:33,855 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.255, Base Lr: 4.76e-04
2022-04-15 20:45:50,392 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.387, Base Lr: 4.76e-04
2022-04-15 20:46:02,631 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.170[s] Speed: 94.3[samples/s]
2022-04-15 20:46:13,348 reid_baseline.train INFO: normal accuracy 0.4787803873094355 4.170614242553711 
2022-04-15 20:46:16,454 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 20:46:16,454 reid_baseline.train INFO: Accuracy: 47.9% Mean Entropy: 417.1%
2022-04-15 20:46:33,795 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.614, Base Lr: 8.72e-04
2022-04-15 20:46:50,343 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.665, Acc: 0.614, Base Lr: 8.72e-04
2022-04-15 20:47:02,531 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.169[s] Speed: 94.8[samples/s]
2022-04-15 20:47:12,873 reid_baseline.train INFO: normal accuracy 0.5212196126905645 4.142153263092041 
2022-04-15 20:47:15,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 20:47:15,964 reid_baseline.train INFO: Accuracy: 52.1% Mean Entropy: 414.2%
2022-04-15 20:47:32,733 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.142, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 20:47:49,342 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.005, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 20:48:01,521 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.167[s] Speed: 95.9[samples/s]
2022-04-15 20:48:11,646 reid_baseline.train INFO: normal accuracy 0.5504738360115369 3.980600595474243 
2022-04-15 20:48:14,735 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 20:48:14,735 reid_baseline.train INFO: Accuracy: 55.0% Mean Entropy: 398.1%
2022-04-15 20:48:31,670 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.385, Acc: 0.687, Base Lr: 1.66e-03
2022-04-15 20:48:48,258 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.312, Acc: 0.678, Base Lr: 1.66e-03
2022-04-15 20:49:00,445 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.167[s] Speed: 95.6[samples/s]
2022-04-15 20:49:11,579 reid_baseline.train INFO: normal accuracy 0.6419447878038731 3.6272060871124268 
2022-04-15 20:49:14,992 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 20:49:14,992 reid_baseline.train INFO: Accuracy: 64.2% Mean Entropy: 362.7%
2022-04-15 20:49:31,611 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.904, Acc: 0.732, Base Lr: 2.06e-03
2022-04-15 20:49:48,200 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.825, Acc: 0.752, Base Lr: 2.06e-03
2022-04-15 20:50:00,410 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 20:50:12,933 reid_baseline.train INFO: normal accuracy 0.6868562010712814 3.2188427448272705 
2022-04-15 20:50:16,348 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 20:50:16,348 reid_baseline.train INFO: Accuracy: 68.7% Mean Entropy: 321.9%
2022-04-15 20:50:33,650 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.609, Acc: 0.784, Base Lr: 2.46e-03
2022-04-15 20:50:50,212 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.550, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 20:51:01,298 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.165[s] Speed: 97.2[samples/s]
2022-04-15 20:51:14,682 reid_baseline.train INFO: normal accuracy 0.7062216728471363 2.9254727363586426 
2022-04-15 20:51:18,092 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 20:51:18,092 reid_baseline.train INFO: Accuracy: 70.6% Mean Entropy: 292.5%
2022-04-15 20:51:31,934 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.365, Acc: 0.844, Base Lr: 2.85e-03
2022-04-15 20:51:46,501 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.354, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 20:51:59,380 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.151[s] Speed: 105.8[samples/s]
2022-04-15 20:52:07,769 reid_baseline.train INFO: normal accuracy 0.7288833951380305 2.679490804672241 
2022-04-15 20:52:11,225 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 20:52:11,225 reid_baseline.train INFO: Accuracy: 72.9% Mean Entropy: 267.9%
2022-04-15 20:52:28,493 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.230, Acc: 0.880, Base Lr: 3.25e-03
2022-04-15 20:52:45,101 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.871, Base Lr: 3.25e-03
2022-04-15 20:52:57,307 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.169[s] Speed: 94.8[samples/s]
2022-04-15 20:53:07,288 reid_baseline.train INFO: normal accuracy 0.734651833539349 2.474578857421875 
2022-04-15 20:53:10,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 20:53:10,384 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 247.5%
2022-04-15 20:53:23,216 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.184, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 20:53:35,536 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.887, Base Lr: 3.64e-03
2022-04-15 20:53:49,277 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.142[s] Speed: 112.3[samples/s]
2022-04-15 20:54:01,379 reid_baseline.train INFO: normal accuracy 0.7404202719406675 2.3352913856506348 
2022-04-15 20:54:06,497 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 20:54:06,497 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 233.5%
2022-04-15 20:54:23,341 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.100, Acc: 0.917, Base Lr: 4.04e-03
2022-04-15 20:54:34,271 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.105, Acc: 0.911, Base Lr: 4.04e-03
2022-04-15 20:54:44,001 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.137[s] Speed: 116.5[samples/s]
2022-04-15 20:54:57,470 reid_baseline.train INFO: normal accuracy 0.7416563658838071 2.1770880222320557 
2022-04-15 20:55:05,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 20:55:05,041 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 217.7%
2022-04-15 20:55:22,326 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.090, Acc: 0.905, Base Lr: 4.44e-03
2022-04-15 20:55:38,875 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.079, Acc: 0.911, Base Lr: 4.44e-03
2022-04-15 20:55:50,655 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.167[s] Speed: 95.8[samples/s]
2022-04-15 20:56:00,760 reid_baseline.train INFO: normal accuracy 0.7453646477132262 2.141345977783203 
2022-04-15 20:56:03,849 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 20:56:03,849 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 214.1%
2022-04-15 20:56:17,828 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.997, Acc: 0.942, Base Lr: 4.83e-03
2022-04-15 20:56:30,696 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.015, Acc: 0.933, Base Lr: 4.83e-03
2022-04-15 20:56:42,826 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.143[s] Speed: 112.1[samples/s]
2022-04-15 20:56:54,910 reid_baseline.train INFO: normal accuracy 0.7445405850844664 2.1073222160339355 
2022-04-15 20:56:59,416 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 20:56:59,416 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 210.7%
2022-04-15 20:57:14,752 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.992, Acc: 0.944, Base Lr: 5.23e-03
2022-04-15 20:57:26,785 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.988, Acc: 0.945, Base Lr: 5.23e-03
2022-04-15 20:57:36,536 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.136[s] Speed: 117.7[samples/s]
2022-04-15 20:57:46,207 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9665240049362183 
2022-04-15 20:57:53,201 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 20:57:53,201 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 196.7%
2022-04-15 20:58:10,534 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.966, Acc: 0.946, Base Lr: 5.62e-03
2022-04-15 20:58:27,112 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.960, Acc: 0.950, Base Lr: 5.62e-03
2022-04-15 20:58:38,660 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.166[s] Speed: 96.1[samples/s]
2022-04-15 20:58:49,045 reid_baseline.train INFO: normal accuracy 0.7544293366295839 1.9800515174865723 
2022-04-15 20:58:49,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 20:58:49,048 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 198.0%
2022-04-15 20:59:02,961 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.930, Acc: 0.954, Base Lr: 6.02e-03
2022-04-15 20:59:14,625 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.938, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 20:59:26,277 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.136[s] Speed: 117.4[samples/s]
2022-04-15 20:59:38,320 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8828765153884888 
2022-04-15 20:59:41,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 20:59:41,765 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 188.3%
2022-04-15 20:59:59,105 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.921, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 21:00:09,440 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.925, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 21:00:19,506 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.138[s] Speed: 115.8[samples/s]
2022-04-15 21:00:30,574 reid_baseline.train INFO: normal accuracy 0.7573135558302431 1.948150396347046 
2022-04-15 21:00:30,576 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 21:00:30,576 reid_baseline.train INFO: Accuracy: 75.7% Mean Entropy: 194.8%
2022-04-15 21:00:46,396 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.904, Acc: 0.963, Base Lr: 6.81e-03
2022-04-15 21:01:02,954 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.910, Acc: 0.963, Base Lr: 6.81e-03
2022-04-15 21:01:15,112 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.163[s] Speed: 98.1[samples/s]
2022-04-15 21:01:24,478 reid_baseline.train INFO: normal accuracy 0.7511330861145447 1.9534416198730469 
2022-04-15 21:01:24,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 21:01:24,478 reid_baseline.train INFO: Accuracy: 75.1% Mean Entropy: 195.3%
2022-04-15 21:01:37,582 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.887, Acc: 0.969, Base Lr: 7.21e-03
2022-04-15 21:01:51,279 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.896, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 21:02:00,477 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.132[s] Speed: 121.4[samples/s]
2022-04-15 21:02:12,695 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.9064197540283203 
2022-04-15 21:02:12,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 21:02:12,697 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 190.6%
2022-04-15 21:02:29,976 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.967, Base Lr: 7.60e-03
2022-04-15 21:02:43,670 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.886, Acc: 0.967, Base Lr: 7.60e-03
2022-04-15 21:02:52,440 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.146[s] Speed: 109.9[samples/s]
2022-04-15 21:03:03,161 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8803658485412598 
2022-04-15 21:03:07,594 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 21:03:07,595 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 188.0%
2022-04-15 21:03:19,996 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.882, Acc: 0.969, Base Lr: 4.01e-03
2022-04-15 21:03:36,826 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.868, Acc: 0.974, Base Lr: 4.01e-03
2022-04-15 21:03:48,997 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.152[s] Speed: 105.5[samples/s]
2022-04-15 21:04:06,438 reid_baseline.train INFO: normal accuracy 0.7515451174289246 1.9289028644561768 
2022-04-15 21:04:06,440 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 21:04:06,440 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 192.9%
2022-04-15 21:04:17,807 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 21:04:30,900 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.853, Acc: 0.972, Base Lr: 3.69e-03
2022-04-15 21:04:40,103 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.123[s] Speed: 129.8[samples/s]
2022-04-15 21:04:54,127 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.9552206993103027 
2022-04-15 21:04:54,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 21:04:54,128 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 195.5%
2022-04-15 21:05:11,391 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.848, Acc: 0.978, Base Lr: 3.38e-03
2022-04-15 21:05:27,982 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.846, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 21:05:35,611 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.152[s] Speed: 105.3[samples/s]
2022-04-15 21:05:46,491 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.942536473274231 
2022-04-15 21:05:46,493 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 21:05:46,493 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 194.3%
2022-04-15 21:05:59,746 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.975, Base Lr: 3.08e-03
2022-04-15 21:06:12,231 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.844, Acc: 0.977, Base Lr: 3.08e-03
2022-04-15 21:06:24,384 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.139[s] Speed: 115.3[samples/s]
2022-04-15 21:06:36,500 reid_baseline.train INFO: normal accuracy 0.7466007416563659 1.9408249855041504 
2022-04-15 21:06:36,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 21:06:36,502 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 194.1%
2022-04-15 21:06:53,488 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.835, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 21:07:04,406 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 21:07:13,684 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.136[s] Speed: 117.5[samples/s]
2022-04-15 21:07:24,587 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.9648566246032715 
2022-04-15 21:07:24,590 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 21:07:24,590 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 196.5%
2022-04-15 21:07:39,052 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.838, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 21:07:55,638 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 21:08:07,831 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.158[s] Speed: 101.0[samples/s]
2022-04-15 21:08:17,898 reid_baseline.train INFO: normal accuracy 0.7404202719406675 1.922216534614563 
2022-04-15 21:08:17,899 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 21:08:17,899 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 192.2%
2022-04-15 21:08:31,401 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 2.20e-03
2022-04-15 21:08:43,853 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 21:08:53,325 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.130[s] Speed: 123.3[samples/s]
2022-04-15 21:09:05,518 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.937691330909729 
2022-04-15 21:09:05,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 21:09:05,520 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 193.8%
2022-04-15 21:09:22,817 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.834, Acc: 0.977, Base Lr: 1.92e-03
2022-04-15 21:09:37,535 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.835, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 21:09:45,330 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.146[s] Speed: 109.7[samples/s]
2022-04-15 21:09:56,719 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.9758920669555664 
2022-04-15 21:09:56,721 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 21:09:56,721 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 197.6%
2022-04-15 21:10:09,875 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.833, Acc: 0.976, Base Lr: 1.66e-03
2022-04-15 21:10:25,410 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.832, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 21:10:37,595 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.150[s] Speed: 106.9[samples/s]
2022-04-15 21:10:49,704 reid_baseline.train INFO: normal accuracy 0.7486608982282653 1.9723505973815918 
2022-04-15 21:10:49,704 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 21:10:49,704 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 197.2%
2022-04-15 21:11:02,893 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 1.42e-03
2022-04-15 21:11:15,329 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.822, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 21:11:24,909 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.129[s] Speed: 124.1[samples/s]
2022-04-15 21:11:36,417 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9765715599060059 
2022-04-15 21:11:36,419 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 21:11:36,419 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 197.7%
2022-04-15 21:11:53,632 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.830, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 21:12:10,170 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.826, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 21:12:20,637 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.162[s] Speed: 98.8[samples/s]
2022-04-15 21:12:34,892 reid_baseline.train INFO: normal accuracy 0.7466007416563659 1.950183629989624 
2022-04-15 21:12:34,894 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 21:12:34,895 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 195.0%
2022-04-15 21:12:48,773 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.828, Acc: 0.978, Base Lr: 9.72e-04
2022-04-15 21:13:00,885 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.822, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 21:13:13,082 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.140[s] Speed: 114.4[samples/s]
2022-04-15 21:13:25,194 reid_baseline.train INFO: normal accuracy 0.7457766790276061 2.0228970050811768 
2022-04-15 21:13:25,195 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 21:13:25,195 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 202.3%
2022-04-15 21:13:42,013 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.817, Acc: 0.986, Base Lr: 7.78e-04
2022-04-15 21:13:53,079 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.821, Acc: 0.982, Base Lr: 7.78e-04
2022-04-15 21:14:03,096 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.139[s] Speed: 115.3[samples/s]
2022-04-15 21:14:13,697 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.9916936159133911 
2022-04-15 21:14:13,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 21:14:13,697 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 199.2%
2022-04-15 21:14:30,749 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.816, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 21:14:47,333 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.820, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 21:14:59,525 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.168[s] Speed: 95.3[samples/s]
2022-04-15 21:15:09,424 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.016890048980713 
2022-04-15 21:15:09,424 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 21:15:09,425 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 201.7%
2022-04-15 21:15:23,102 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.823, Acc: 0.978, Base Lr: 4.51e-04
2022-04-15 21:15:36,729 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.819, Acc: 0.979, Base Lr: 4.51e-04
2022-04-15 21:15:48,916 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.145[s] Speed: 110.6[samples/s]
2022-04-15 21:16:00,999 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.9718698263168335 
2022-04-15 21:16:01,002 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 21:16:01,002 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 197.2%
2022-04-15 21:16:17,962 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.813, Acc: 0.983, Base Lr: 3.20e-04
2022-04-15 21:16:28,899 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 21:16:38,616 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.138[s] Speed: 116.2[samples/s]
2022-04-15 21:16:48,929 reid_baseline.train INFO: normal accuracy 0.7466007416563659 2.0098018646240234 
2022-04-15 21:16:48,931 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 21:16:48,931 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 201.0%
2022-04-15 21:17:04,308 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.811, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 21:17:20,915 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.814, Acc: 0.982, Base Lr: 2.11e-04
2022-04-15 21:17:33,109 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.162[s] Speed: 98.9[samples/s]
2022-04-15 21:17:42,520 reid_baseline.train INFO: normal accuracy 0.7523691800576844 1.9644526243209839 
2022-04-15 21:17:42,522 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 21:17:42,522 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 196.4%
2022-04-15 21:17:56,052 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 21:18:08,404 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 1.26e-04
2022-04-15 21:18:17,884 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.130[s] Speed: 123.6[samples/s]
2022-04-15 21:18:29,993 reid_baseline.train INFO: normal accuracy 0.746188710341986 1.984954833984375 
2022-04-15 21:18:29,994 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 21:18:29,994 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 198.5%
2022-04-15 21:18:47,208 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.814, Acc: 0.983, Base Lr: 6.51e-05
2022-04-15 21:19:02,425 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.817, Acc: 0.984, Base Lr: 6.51e-05
2022-04-15 21:19:10,125 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.147[s] Speed: 108.9[samples/s]
2022-04-15 21:19:20,838 reid_baseline.train INFO: normal accuracy 0.7503090234857849 2.002349853515625 
2022-04-15 21:19:20,840 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 21:19:20,840 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 200.2%
2022-04-15 21:19:34,287 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.817, Acc: 0.984, Base Lr: 2.83e-05
2022-04-15 21:19:50,349 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 21:20:02,513 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.153[s] Speed: 104.8[samples/s]
2022-04-15 21:20:14,780 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.9873512983322144 
2022-04-15 21:20:14,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 21:20:14,780 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 198.7%
2022-04-15 21:20:26,633 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.824, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 21:20:39,685 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 21:20:49,670 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.128[s] Speed: 125.2[samples/s]
2022-04-15 21:21:04,732 reid_baseline.train INFO: normal accuracy 0.7490729295426453 2.0083773136138916 
2022-04-15 21:21:04,734 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 21:21:04,734 reid_baseline.train INFO: Accuracy: 74.9% Mean Entropy: 200.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_6/transformer_best_model.pth
2022-04-15 21:21:20,109 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8803658485412598 
2022-04-15 21:21:20,109 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:21:20,109 reid_baseline.train INFO: Accuracy: 74.6%
2022-04-15 21:21:31,202 reid_baseline.train INFO: normal accuracy 0.7457766790276061 1.8803658485412598 
2022-04-15 21:21:31,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:21:31,203 reid_baseline.train INFO: Shuffled Accuracy: 74.6%
2022-04-15 21:21:46,504 reid_baseline.train INFO: normal accuracy 0.9782359679266895 0.6469060182571411 
2022-04-15 21:21:46,504 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 21:21:46,504 reid_baseline.train INFO: Source Clean Accuracy: 97.8%
2022-04-15 21:21:49,939 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_6
2022-04-15 21:21:49,939 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-15 21:21:49,939 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 21:21:49,940 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 21:21:49,940 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 21:21:55,199 reid_baseline.train INFO: start training
2022-04-15 21:22:10,424 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.255, Base Lr: 4.76e-04
2022-04-15 21:22:26,968 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.387, Base Lr: 4.76e-04
2022-04-15 21:22:39,239 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.161[s] Speed: 99.3[samples/s]
2022-04-15 21:23:16,796 reid_baseline.train INFO: normal accuracy 0.5604773927014001 4.170370101928711 
2022-04-15 21:23:19,812 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 21:23:19,812 reid_baseline.train INFO: Accuracy: 56.0% Mean Entropy: 417.0%
2022-04-15 21:23:35,197 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.776, Acc: 0.614, Base Lr: 8.72e-04
2022-04-15 21:23:51,792 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.665, Acc: 0.614, Base Lr: 8.72e-04
2022-04-15 21:24:03,989 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.162[s] Speed: 98.9[samples/s]
2022-04-15 21:24:40,309 reid_baseline.train INFO: normal accuracy 0.5871012164333257 4.135311126708984 
2022-04-15 21:24:43,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 21:24:43,722 reid_baseline.train INFO: Accuracy: 58.7% Mean Entropy: 413.5%
2022-04-15 21:24:58,557 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.142, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 21:25:15,104 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.005, Acc: 0.631, Base Lr: 1.27e-03
2022-04-15 21:25:27,285 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.159[s] Speed: 100.4[samples/s]
2022-04-15 21:26:03,190 reid_baseline.train INFO: normal accuracy 0.6215285747073674 3.9226486682891846 
2022-04-15 21:26:06,623 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 21:26:06,623 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 392.3%
2022-04-15 21:26:22,009 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.385, Acc: 0.687, Base Lr: 1.66e-03
2022-04-15 21:26:38,579 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.312, Acc: 0.678, Base Lr: 1.66e-03
2022-04-15 21:26:50,755 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.161[s] Speed: 99.1[samples/s]
2022-04-15 21:27:27,111 reid_baseline.train INFO: normal accuracy 0.7023181087904522 3.4643681049346924 
2022-04-15 21:27:30,520 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 21:27:30,521 reid_baseline.train INFO: Accuracy: 70.2% Mean Entropy: 346.4%
2022-04-15 21:27:45,284 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.904, Acc: 0.732, Base Lr: 2.06e-03
2022-04-15 21:28:01,868 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.825, Acc: 0.752, Base Lr: 2.06e-03
2022-04-15 21:28:14,067 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.159[s] Speed: 100.5[samples/s]
2022-04-15 21:28:52,906 reid_baseline.train INFO: normal accuracy 0.7479917374340143 2.989814281463623 
2022-04-15 21:28:55,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 21:28:55,998 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 299.0%
2022-04-15 21:29:13,371 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.609, Acc: 0.784, Base Lr: 2.46e-03
2022-04-15 21:29:29,966 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.550, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 21:29:41,465 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 21:30:18,307 reid_baseline.train INFO: normal accuracy 0.773927014000459 2.6633493900299072 
2022-04-15 21:30:21,391 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 21:30:21,391 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 266.3%
2022-04-15 21:30:38,708 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.365, Acc: 0.844, Base Lr: 2.85e-03
2022-04-15 21:30:55,249 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.354, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 21:31:06,107 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.164[s] Speed: 97.8[samples/s]
2022-04-15 21:31:44,124 reid_baseline.train INFO: normal accuracy 0.7897635988065183 2.4149186611175537 
2022-04-15 21:31:47,218 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 21:31:47,219 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 241.5%
2022-04-15 21:32:04,542 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.230, Acc: 0.880, Base Lr: 3.25e-03
2022-04-15 21:32:21,087 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.871, Base Lr: 3.25e-03
2022-04-15 21:32:30,321 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.158[s] Speed: 101.5[samples/s]
2022-04-15 21:33:08,684 reid_baseline.train INFO: normal accuracy 0.7987147119577691 2.2021431922912598 
2022-04-15 21:33:12,113 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 21:33:12,113 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 220.2%
2022-04-15 21:33:29,412 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.184, Acc: 0.884, Base Lr: 3.64e-03
2022-04-15 21:33:45,934 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.173, Acc: 0.887, Base Lr: 3.64e-03
2022-04-15 21:33:56,074 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.161[s] Speed: 99.5[samples/s]
2022-04-15 21:34:33,453 reid_baseline.train INFO: normal accuracy 0.8037640578379619 2.075282096862793 
2022-04-15 21:34:36,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 21:34:36,867 reid_baseline.train INFO: Accuracy: 80.4% Mean Entropy: 207.5%
2022-04-15 21:34:54,192 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.100, Acc: 0.917, Base Lr: 4.04e-03
2022-04-15 21:35:10,723 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.105, Acc: 0.911, Base Lr: 4.04e-03
2022-04-15 21:35:18,927 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.154[s] Speed: 104.0[samples/s]
2022-04-15 21:35:58,138 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.935120940208435 
2022-04-15 21:36:01,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 21:36:01,543 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 193.5%
2022-04-15 21:36:18,831 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.090, Acc: 0.905, Base Lr: 4.44e-03
2022-04-15 21:36:35,370 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.079, Acc: 0.911, Base Lr: 4.44e-03
2022-04-15 21:36:42,986 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.152[s] Speed: 105.6[samples/s]
2022-04-15 21:37:22,017 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.920868158340454 
2022-04-15 21:37:25,111 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 21:37:25,112 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 192.1%
2022-04-15 21:37:42,453 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.997, Acc: 0.942, Base Lr: 4.83e-03
2022-04-15 21:37:57,721 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.015, Acc: 0.933, Base Lr: 4.83e-03
2022-04-15 21:38:05,460 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.148[s] Speed: 108.5[samples/s]
2022-04-15 21:38:41,375 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.8921297788619995 
2022-04-15 21:38:44,483 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 21:38:44,483 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 189.2%
2022-04-15 21:39:01,835 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.992, Acc: 0.944, Base Lr: 5.23e-03
2022-04-15 21:39:16,674 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.988, Acc: 0.945, Base Lr: 5.23e-03
2022-04-15 21:39:24,563 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.147[s] Speed: 109.2[samples/s]
2022-04-15 21:40:00,667 reid_baseline.train INFO: normal accuracy 0.8056001836125775 1.7581524848937988 
2022-04-15 21:40:03,761 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 21:40:03,762 reid_baseline.train INFO: Accuracy: 80.6% Mean Entropy: 175.8%
2022-04-15 21:40:21,084 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.966, Acc: 0.946, Base Lr: 5.62e-03
2022-04-15 21:40:35,756 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.960, Acc: 0.950, Base Lr: 5.62e-03
2022-04-15 21:40:44,128 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.148[s] Speed: 108.4[samples/s]
2022-04-15 21:41:20,313 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7830208539962769 
2022-04-15 21:41:20,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 21:41:20,315 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 178.3%
2022-04-15 21:41:37,584 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.930, Acc: 0.954, Base Lr: 6.02e-03
2022-04-15 21:41:53,896 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.938, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 21:42:01,515 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.151[s] Speed: 106.2[samples/s]
2022-04-15 21:42:36,713 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.6872665882110596 
2022-04-15 21:42:39,796 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 21:42:39,797 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 168.7%
2022-04-15 21:42:57,127 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.921, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 21:43:12,609 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.925, Acc: 0.960, Base Lr: 6.42e-03
2022-04-15 21:43:20,274 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.148[s] Speed: 108.1[samples/s]
2022-04-15 21:43:55,508 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.756516456604004 
2022-04-15 21:43:55,510 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 21:43:55,511 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 175.7%
2022-04-15 21:44:12,838 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.904, Acc: 0.963, Base Lr: 6.81e-03
2022-04-15 21:44:29,438 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.910, Acc: 0.963, Base Lr: 6.81e-03
2022-04-15 21:44:36,951 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.152[s] Speed: 105.6[samples/s]
2022-04-15 21:45:13,586 reid_baseline.train INFO: normal accuracy 0.8067477622217122 1.7680622339248657 
2022-04-15 21:45:13,588 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 21:45:13,588 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 176.8%
2022-04-15 21:45:30,857 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.887, Acc: 0.969, Base Lr: 7.21e-03
2022-04-15 21:45:47,416 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.896, Acc: 0.964, Base Lr: 7.21e-03
2022-04-15 21:45:56,721 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.158[s] Speed: 101.5[samples/s]
2022-04-15 21:46:35,071 reid_baseline.train INFO: normal accuracy 0.8046821207252697 1.7011829614639282 
2022-04-15 21:46:35,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 21:46:35,072 reid_baseline.train INFO: Accuracy: 80.5% Mean Entropy: 170.1%
2022-04-15 21:46:46,640 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.967, Base Lr: 7.60e-03
2022-04-15 21:46:58,650 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.886, Acc: 0.967, Base Lr: 7.60e-03
2022-04-15 21:47:08,283 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.121[s] Speed: 131.8[samples/s]
2022-04-15 21:47:46,469 reid_baseline.train INFO: normal accuracy 0.80766582510902 1.6843223571777344 
2022-04-15 21:47:49,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 21:47:49,883 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 168.4%
2022-04-15 21:48:08,595 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.882, Acc: 0.969, Base Lr: 4.01e-03
2022-04-15 21:48:17,205 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.868, Acc: 0.974, Base Lr: 4.01e-03
2022-04-15 21:48:27,629 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.138[s] Speed: 116.0[samples/s]
2022-04-15 21:49:03,032 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.7346408367156982 
2022-04-15 21:49:03,034 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 21:49:03,034 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 173.5%
2022-04-15 21:49:18,969 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 21:49:35,519 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.853, Acc: 0.972, Base Lr: 3.69e-03
2022-04-15 21:49:47,679 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.163[s] Speed: 98.0[samples/s]
2022-04-15 21:50:22,827 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7346808910369873 
2022-04-15 21:50:22,829 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 21:50:22,829 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 173.5%
2022-04-15 21:50:40,145 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.848, Acc: 0.978, Base Lr: 3.38e-03
2022-04-15 21:50:55,552 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.846, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 21:51:05,427 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.156[s] Speed: 102.7[samples/s]
2022-04-15 21:51:36,780 reid_baseline.train INFO: normal accuracy 0.8092724351618086 1.6991510391235352 
2022-04-15 21:51:36,780 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 21:51:36,780 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 169.9%
2022-04-15 21:51:53,229 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.975, Base Lr: 3.08e-03
2022-04-15 21:52:09,787 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.844, Acc: 0.977, Base Lr: 3.08e-03
2022-04-15 21:52:21,964 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.165[s] Speed: 96.8[samples/s]
2022-04-15 21:52:58,227 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.7161363363265991 
2022-04-15 21:52:58,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 21:52:58,228 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 171.6%
2022-04-15 21:53:15,512 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.835, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 21:53:30,311 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 21:53:41,518 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.158[s] Speed: 101.1[samples/s]
2022-04-15 21:54:13,138 reid_baseline.train INFO: normal accuracy 0.8072067936653661 1.7526264190673828 
2022-04-15 21:54:13,138 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 21:54:13,138 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 175.3%
2022-04-15 21:54:28,809 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.838, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 21:54:43,834 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 21:54:56,009 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.157[s] Speed: 102.1[samples/s]
2022-04-15 21:55:32,306 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.692704200744629 
2022-04-15 21:55:32,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 21:55:32,309 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 169.3%
2022-04-15 21:55:49,646 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 2.20e-03
2022-04-15 21:56:06,263 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.836, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 21:56:16,992 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.163[s] Speed: 97.9[samples/s]
2022-04-15 21:56:52,163 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.7040241956710815 
2022-04-15 21:56:52,165 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 21:56:52,165 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 170.4%
2022-04-15 21:57:05,327 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.834, Acc: 0.977, Base Lr: 1.92e-03
2022-04-15 21:57:20,744 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.835, Acc: 0.975, Base Lr: 1.92e-03
2022-04-15 21:57:32,951 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.149[s] Speed: 107.3[samples/s]
2022-04-15 21:58:04,991 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.7500100135803223 
2022-04-15 21:58:04,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 21:58:04,993 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 175.0%
2022-04-15 21:58:20,513 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.833, Acc: 0.976, Base Lr: 1.66e-03
2022-04-15 21:58:37,059 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.832, Acc: 0.977, Base Lr: 1.66e-03
2022-04-15 21:58:49,203 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.162[s] Speed: 99.0[samples/s]
2022-04-15 21:59:23,675 reid_baseline.train INFO: normal accuracy 0.811567592380078 1.736480712890625 
2022-04-15 21:59:23,678 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 21:59:23,678 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 173.6%
2022-04-15 21:59:40,976 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.825, Acc: 0.981, Base Lr: 1.42e-03
2022-04-15 21:59:55,966 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.822, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 22:00:07,430 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.160[s] Speed: 100.0[samples/s]
2022-04-15 22:00:40,503 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.7413487434387207 
2022-04-15 22:00:40,503 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 22:00:40,503 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 174.1%
2022-04-15 22:00:56,665 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.830, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 22:01:13,295 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.826, Acc: 0.979, Base Lr: 1.19e-03
2022-04-15 22:01:25,486 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.164[s] Speed: 97.3[samples/s]
2022-04-15 22:02:05,916 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.7175976037979126 
2022-04-15 22:02:05,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 22:02:05,918 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 171.8%
2022-04-15 22:02:23,299 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.828, Acc: 0.978, Base Lr: 9.72e-04
2022-04-15 22:02:38,377 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.822, Acc: 0.980, Base Lr: 9.72e-04
2022-04-15 22:02:50,234 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 22:03:23,691 reid_baseline.train INFO: normal accuracy 0.8088134037181547 1.7978489398956299 
2022-04-15 22:03:23,694 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 22:03:23,694 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 179.8%
2022-04-15 22:03:40,346 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.817, Acc: 0.986, Base Lr: 7.78e-04
2022-04-15 22:03:56,972 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.821, Acc: 0.982, Base Lr: 7.78e-04
2022-04-15 22:04:09,174 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 22:04:46,068 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.769304633140564 
2022-04-15 22:04:46,070 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 22:04:46,070 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 176.9%
2022-04-15 22:05:03,409 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.816, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 22:05:17,403 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.820, Acc: 0.979, Base Lr: 6.04e-04
2022-04-15 22:05:28,807 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.156[s] Speed: 102.4[samples/s]
2022-04-15 22:06:03,761 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7908358573913574 
2022-04-15 22:06:03,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 22:06:03,763 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 179.1%
2022-04-15 22:06:20,854 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.823, Acc: 0.978, Base Lr: 4.51e-04
2022-04-15 22:06:37,450 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.819, Acc: 0.979, Base Lr: 4.51e-04
2022-04-15 22:06:49,614 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.168[s] Speed: 95.4[samples/s]
2022-04-15 22:07:23,225 reid_baseline.train INFO: normal accuracy 0.8090429194399816 1.7355353832244873 
2022-04-15 22:07:23,226 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 22:07:23,226 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 173.6%
2022-04-15 22:07:40,553 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.813, Acc: 0.983, Base Lr: 3.20e-04
2022-04-15 22:07:55,556 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 3.20e-04
2022-04-15 22:08:07,403 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.162[s] Speed: 99.0[samples/s]
2022-04-15 22:08:41,156 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.7825326919555664 
2022-04-15 22:08:41,158 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 22:08:41,158 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 178.3%
2022-04-15 22:08:58,009 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.811, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 22:09:14,595 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.814, Acc: 0.982, Base Lr: 2.11e-04
2022-04-15 22:09:26,779 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.167[s] Speed: 95.9[samples/s]
2022-04-15 22:10:00,289 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.728094458580017 
2022-04-15 22:10:00,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 22:10:00,292 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 172.8%
2022-04-15 22:10:17,644 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 1.26e-04
2022-04-15 22:10:32,566 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 1.26e-04
2022-04-15 22:10:44,752 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.163[s] Speed: 98.4[samples/s]
2022-04-15 22:11:17,246 reid_baseline.train INFO: normal accuracy 0.8090429194399816 1.7462435960769653 
2022-04-15 22:11:17,248 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 22:11:17,248 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 174.6%
2022-04-15 22:11:33,998 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.814, Acc: 0.983, Base Lr: 6.51e-05
2022-04-15 22:11:50,596 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.817, Acc: 0.984, Base Lr: 6.51e-05
2022-04-15 22:12:02,797 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.167[s] Speed: 96.1[samples/s]
2022-04-15 22:12:36,106 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.7676619291305542 
2022-04-15 22:12:36,109 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 22:12:36,109 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 176.8%
2022-04-15 22:12:53,044 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.817, Acc: 0.984, Base Lr: 2.83e-05
2022-04-15 22:13:08,249 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.818, Acc: 0.982, Base Lr: 2.83e-05
2022-04-15 22:13:20,423 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.162[s] Speed: 98.7[samples/s]
2022-04-15 22:13:55,093 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.7525689601898193 
2022-04-15 22:13:55,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 22:13:55,095 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 175.3%
2022-04-15 22:14:12,437 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.824, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 22:14:29,046 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.977, Base Lr: 1.60e-05
2022-04-15 22:14:39,639 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.163[s] Speed: 98.2[samples/s]
2022-04-15 22:15:17,272 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.7755930423736572 
2022-04-15 22:15:17,274 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 22:15:17,274 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 177.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_6/transformer_best_model.pth
2022-04-15 22:15:55,421 reid_baseline.train INFO: normal accuracy 0.80766582510902 1.6843223571777344 
2022-04-15 22:15:55,421 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:15:55,421 reid_baseline.train INFO: Accuracy: 80.8%
2022-04-15 22:16:27,941 reid_baseline.train INFO: normal accuracy 0.80766582510902 1.6843223571777344 
2022-04-15 22:16:27,941 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:16:27,941 reid_baseline.train INFO: Shuffled Accuracy: 80.8%
2022-04-15 22:16:47,734 reid_baseline.train INFO: normal accuracy 0.9782359679266895 0.6469060182571411 
2022-04-15 22:16:47,735 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:16:47,735 reid_baseline.train INFO: Source Clean Accuracy: 97.8%
2022-04-15 22:16:51,961 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_8
2022-04-15 22:16:51,961 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-15 22:16:51,961 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 22:16:51,962 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 22:16:51,962 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 22:16:58,220 reid_baseline.train INFO: start training
2022-04-15 22:17:14,737 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.260, Base Lr: 4.76e-04
2022-04-15 22:17:31,350 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.390, Base Lr: 4.76e-04
2022-04-15 22:17:43,635 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.166[s] Speed: 96.3[samples/s]
2022-04-15 22:17:55,546 reid_baseline.train INFO: normal accuracy 0.48331273176761436 4.170620441436768 
2022-04-15 22:17:58,880 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 22:17:58,881 reid_baseline.train INFO: Accuracy: 48.3% Mean Entropy: 417.1%
2022-04-15 22:18:16,432 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.778, Acc: 0.599, Base Lr: 8.72e-04
2022-04-15 22:18:32,991 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.668, Acc: 0.608, Base Lr: 8.72e-04
2022-04-15 22:18:45,181 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.170[s] Speed: 94.4[samples/s]
2022-04-15 22:18:55,576 reid_baseline.train INFO: normal accuracy 0.5175113308611454 4.142198085784912 
2022-04-15 22:18:58,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 22:18:58,983 reid_baseline.train INFO: Accuracy: 51.8% Mean Entropy: 414.2%
2022-04-15 22:19:16,287 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.143, Acc: 0.626, Base Lr: 1.27e-03
2022-04-15 22:19:32,854 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.004, Acc: 0.632, Base Lr: 1.27e-03
2022-04-15 22:19:45,007 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.169[s] Speed: 94.9[samples/s]
2022-04-15 22:19:55,153 reid_baseline.train INFO: normal accuracy 0.5517099299546766 3.979362964630127 
2022-04-15 22:19:58,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 22:19:58,242 reid_baseline.train INFO: Accuracy: 55.2% Mean Entropy: 397.9%
2022-04-15 22:20:15,180 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.382, Acc: 0.684, Base Lr: 1.66e-03
2022-04-15 22:20:31,754 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.309, Acc: 0.681, Base Lr: 1.66e-03
2022-04-15 22:20:43,942 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.167[s] Speed: 95.6[samples/s]
2022-04-15 22:20:54,715 reid_baseline.train INFO: normal accuracy 0.6440049443757726 3.6328437328338623 
2022-04-15 22:20:57,836 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 22:20:57,837 reid_baseline.train INFO: Accuracy: 64.4% Mean Entropy: 363.3%
2022-04-15 22:21:14,393 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.907, Acc: 0.730, Base Lr: 2.06e-03
2022-04-15 22:21:31,009 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.827, Acc: 0.749, Base Lr: 2.06e-03
2022-04-15 22:21:43,229 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.166[s] Speed: 96.2[samples/s]
2022-04-15 22:21:55,516 reid_baseline.train INFO: normal accuracy 0.6897404202719407 3.1998403072357178 
2022-04-15 22:21:59,519 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 22:21:59,519 reid_baseline.train INFO: Accuracy: 69.0% Mean Entropy: 320.0%
2022-04-15 22:22:16,842 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.611, Acc: 0.785, Base Lr: 2.46e-03
2022-04-15 22:22:33,400 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.798, Base Lr: 2.46e-03
2022-04-15 22:22:44,704 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.165[s] Speed: 96.7[samples/s]
2022-04-15 22:22:56,984 reid_baseline.train INFO: normal accuracy 0.7049855789039967 2.9142367839813232 
2022-04-15 22:23:00,388 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 22:23:00,389 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 291.4%
2022-04-15 22:23:17,733 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.356, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 22:23:34,326 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.357, Acc: 0.843, Base Lr: 2.85e-03
2022-04-15 22:23:44,856 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.163[s] Speed: 98.2[samples/s]
2022-04-15 22:23:58,499 reid_baseline.train INFO: normal accuracy 0.7272352698805109 2.6822168827056885 
2022-04-15 22:24:01,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 22:24:01,908 reid_baseline.train INFO: Accuracy: 72.7% Mean Entropy: 268.2%
2022-04-15 22:24:15,841 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.228, Acc: 0.884, Base Lr: 3.25e-03
2022-04-15 22:24:30,393 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.873, Base Lr: 3.25e-03
2022-04-15 22:24:43,318 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.152[s] Speed: 105.5[samples/s]
2022-04-15 22:24:51,645 reid_baseline.train INFO: normal accuracy 0.7379480840543882 2.4782803058624268 
2022-04-15 22:24:54,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 22:24:54,731 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 247.8%
2022-04-15 22:25:11,418 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.181, Acc: 0.881, Base Lr: 3.64e-03
2022-04-15 22:25:28,014 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.169, Acc: 0.882, Base Lr: 3.64e-03
2022-04-15 22:25:40,220 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.167[s] Speed: 96.0[samples/s]
2022-04-15 22:25:50,198 reid_baseline.train INFO: normal accuracy 0.7404202719406675 2.3522207736968994 
2022-04-15 22:25:53,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 22:25:53,285 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 235.2%
2022-04-15 22:26:06,185 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.104, Acc: 0.912, Base Lr: 4.04e-03
2022-04-15 22:26:18,612 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.110, Acc: 0.907, Base Lr: 4.04e-03
2022-04-15 22:26:30,516 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.136[s] Speed: 117.4[samples/s]
2022-04-15 22:26:46,029 reid_baseline.train INFO: normal accuracy 0.7474248042851257 2.1804261207580566 
2022-04-15 22:26:50,460 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 22:26:50,460 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 218.0%
2022-04-15 22:27:05,018 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.080, Acc: 0.916, Base Lr: 4.44e-03
2022-04-15 22:27:17,242 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.073, Acc: 0.917, Base Lr: 4.44e-03
2022-04-15 22:27:27,475 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.136[s] Speed: 118.0[samples/s]
2022-04-15 22:27:38,513 reid_baseline.train INFO: normal accuracy 0.7503090234857849 2.13556170463562 
2022-04-15 22:27:44,140 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 22:27:44,141 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 213.6%
2022-04-15 22:28:01,441 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.996, Acc: 0.945, Base Lr: 4.83e-03
2022-04-15 22:28:17,998 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.008, Acc: 0.938, Base Lr: 4.83e-03
2022-04-15 22:28:27,609 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.159[s] Speed: 100.5[samples/s]
2022-04-15 22:28:38,186 reid_baseline.train INFO: normal accuracy 0.7404202719406675 2.0648105144500732 
2022-04-15 22:28:41,303 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 22:28:41,304 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 206.5%
2022-04-15 22:28:55,294 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.993, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 22:29:10,481 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.993, Acc: 0.940, Base Lr: 5.23e-03
2022-04-15 22:29:22,683 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.152[s] Speed: 105.6[samples/s]
2022-04-15 22:29:34,901 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.9767225980758667 
2022-04-15 22:29:38,852 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 22:29:38,852 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 197.7%
2022-04-15 22:29:52,180 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.972, Acc: 0.942, Base Lr: 5.62e-03
2022-04-15 22:30:05,515 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.961, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 22:30:15,319 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.134[s] Speed: 119.8[samples/s]
2022-04-15 22:30:28,823 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.977429986000061 
2022-04-15 22:30:28,824 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 22:30:28,824 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 197.7%
2022-04-15 22:30:46,090 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.932, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 22:31:02,661 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.937, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 22:31:11,486 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.156[s] Speed: 102.4[samples/s]
2022-04-15 22:31:21,742 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.9160183668136597 
2022-04-15 22:31:25,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 22:31:25,164 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 191.6%
2022-04-15 22:31:38,839 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.918, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 22:31:51,282 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.920, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 22:32:03,456 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.140[s] Speed: 114.1[samples/s]
2022-04-15 22:32:15,666 reid_baseline.train INFO: normal accuracy 0.7482488669138855 1.9642449617385864 
2022-04-15 22:32:15,669 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 22:32:15,669 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 196.4%
2022-04-15 22:32:32,952 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.899, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 22:32:43,076 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.909, Acc: 0.960, Base Lr: 6.81e-03
2022-04-15 22:32:53,168 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.137[s] Speed: 116.5[samples/s]
2022-04-15 22:33:04,192 reid_baseline.train INFO: normal accuracy 0.7412443345694273 1.9096431732177734 
2022-04-15 22:33:07,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 22:33:07,278 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 191.0%
2022-04-15 22:33:22,587 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.886, Acc: 0.966, Base Lr: 7.21e-03
2022-04-15 22:33:39,172 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.895, Acc: 0.965, Base Lr: 7.21e-03
2022-04-15 22:33:51,361 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.161[s] Speed: 99.1[samples/s]
2022-04-15 22:34:00,246 reid_baseline.train INFO: normal accuracy 0.7350638648537289 1.942417025566101 
2022-04-15 22:34:00,246 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 22:34:00,246 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 194.2%
2022-04-15 22:34:13,754 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 22:34:27,291 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.968, Base Lr: 7.60e-03
2022-04-15 22:34:37,481 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.136[s] Speed: 117.3[samples/s]
2022-04-15 22:34:49,494 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8932185173034668 
2022-04-15 22:34:53,428 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 22:34:53,428 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 189.3%
2022-04-15 22:35:10,790 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.875, Acc: 0.967, Base Lr: 4.01e-03
2022-04-15 22:35:23,024 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.865, Acc: 0.974, Base Lr: 4.01e-03
2022-04-15 22:35:32,368 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.143[s] Speed: 112.2[samples/s]
2022-04-15 22:35:45,872 reid_baseline.train INFO: normal accuracy 0.7367119901112484 2.0179402828216553 
2022-04-15 22:35:45,874 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 22:35:45,874 reid_baseline.train INFO: Accuracy: 73.7% Mean Entropy: 201.8%
2022-04-15 22:36:00,421 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 22:36:16,967 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.852, Acc: 0.973, Base Lr: 3.69e-03
2022-04-15 22:36:29,144 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.158[s] Speed: 101.0[samples/s]
2022-04-15 22:36:41,235 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.9612207412719727 
2022-04-15 22:36:41,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 22:36:41,237 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 196.1%
2022-04-15 22:36:52,845 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 22:37:05,933 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.846, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 22:37:14,858 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.123[s] Speed: 129.9[samples/s]
2022-04-15 22:37:28,335 reid_baseline.train INFO: normal accuracy 0.7408323032550473 1.9850142002105713 
2022-04-15 22:37:28,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 22:37:28,337 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 198.5%
2022-04-15 22:37:45,569 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.976, Base Lr: 3.08e-03
2022-04-15 22:38:02,145 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.842, Acc: 0.979, Base Lr: 3.08e-03
2022-04-15 22:38:08,995 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.149[s] Speed: 107.5[samples/s]
2022-04-15 22:38:20,527 reid_baseline.train INFO: normal accuracy 0.7358879274824887 1.9317713975906372 
2022-04-15 22:38:20,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 22:38:20,528 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 193.2%
2022-04-15 22:38:34,012 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.838, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 22:38:48,161 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 22:39:00,335 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.146[s] Speed: 109.7[samples/s]
2022-04-15 22:39:12,358 reid_baseline.train INFO: normal accuracy 0.738772146683148 1.9834461212158203 
2022-04-15 22:39:12,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 22:39:12,361 reid_baseline.train INFO: Accuracy: 73.9% Mean Entropy: 198.3%
2022-04-15 22:39:28,514 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.841, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 22:39:39,619 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.840, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 22:39:49,245 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.135[s] Speed: 118.5[samples/s]
2022-04-15 22:39:59,541 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.9454635381698608 
2022-04-15 22:39:59,544 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 22:39:59,544 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 194.5%
2022-04-15 22:40:14,018 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.826, Acc: 0.984, Base Lr: 2.20e-03
2022-04-15 22:40:30,628 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.837, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 22:40:42,839 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.159[s] Speed: 100.9[samples/s]
2022-04-15 22:40:52,790 reid_baseline.train INFO: normal accuracy 0.7437165224557066 1.996532678604126 
2022-04-15 22:40:52,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 22:40:52,790 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 199.7%
2022-04-15 22:41:06,309 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.839, Acc: 0.973, Base Lr: 1.92e-03
2022-04-15 22:41:18,639 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.838, Acc: 0.972, Base Lr: 1.92e-03
2022-04-15 22:41:28,192 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.130[s] Speed: 123.4[samples/s]
2022-04-15 22:41:40,330 reid_baseline.train INFO: normal accuracy 0.7375360527400082 1.9984339475631714 
2022-04-15 22:41:40,332 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 22:41:40,332 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 199.8%
2022-04-15 22:41:57,632 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 1.66e-03
2022-04-15 22:42:12,290 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.982, Base Lr: 1.66e-03
2022-04-15 22:42:20,489 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.147[s] Speed: 108.8[samples/s]
2022-04-15 22:42:32,018 reid_baseline.train INFO: normal accuracy 0.7441285537700866 1.9764373302459717 
2022-04-15 22:42:32,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 22:42:32,018 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 197.6%
2022-04-15 22:42:45,511 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.829, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 22:43:02,071 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.823, Acc: 0.983, Base Lr: 1.42e-03
2022-04-15 22:43:14,309 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.155[s] Speed: 103.3[samples/s]
2022-04-15 22:43:26,552 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.988434076309204 
2022-04-15 22:43:26,554 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 22:43:26,554 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 198.8%
2022-04-15 22:43:38,721 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.830, Acc: 0.977, Base Lr: 1.19e-03
2022-04-15 22:43:51,834 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.827, Acc: 0.978, Base Lr: 1.19e-03
2022-04-15 22:44:00,979 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.126[s] Speed: 126.9[samples/s]
2022-04-15 22:44:20,496 reid_baseline.train INFO: normal accuracy 0.7441285537700866 1.9627686738967896 
2022-04-15 22:44:20,498 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 22:44:20,498 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 196.3%
2022-04-15 22:44:37,828 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.823, Acc: 0.981, Base Lr: 9.72e-04
2022-04-15 22:44:54,412 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 9.72e-04
2022-04-15 22:45:01,998 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.152[s] Speed: 105.3[samples/s]
2022-04-15 22:45:12,532 reid_baseline.train INFO: normal accuracy 0.7441285537700866 2.0470504760742188 
2022-04-15 22:45:12,532 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 22:45:12,532 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 204.7%
2022-04-15 22:45:26,087 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.815, Acc: 0.983, Base Lr: 7.78e-04
2022-04-15 22:45:39,216 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.818, Acc: 0.981, Base Lr: 7.78e-04
2022-04-15 22:45:51,377 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.142[s] Speed: 112.5[samples/s]
2022-04-15 22:46:03,429 reid_baseline.train INFO: normal accuracy 0.7453646477132262 2.0223019123077393 
2022-04-15 22:46:03,431 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 22:46:03,431 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 202.2%
2022-04-15 22:46:18,933 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 6.04e-04
2022-04-15 22:46:31,136 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 6.04e-04
2022-04-15 22:46:40,738 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.137[s] Speed: 117.1[samples/s]
2022-04-15 22:46:51,042 reid_baseline.train INFO: normal accuracy 0.7404202719406675 2.025468587875366 
2022-04-15 22:46:51,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 22:46:51,045 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 202.5%
2022-04-15 22:47:08,294 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.819, Acc: 0.983, Base Lr: 4.51e-04
2022-04-15 22:47:24,867 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.818, Acc: 0.984, Base Lr: 4.51e-04
2022-04-15 22:47:35,673 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.163[s] Speed: 97.9[samples/s]
2022-04-15 22:47:46,214 reid_baseline.train INFO: normal accuracy 0.7445405850844664 2.0102593898773193 
2022-04-15 22:47:46,214 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 22:47:46,215 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 201.0%
2022-04-15 22:48:00,105 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.814, Acc: 0.981, Base Lr: 3.20e-04
2022-04-15 22:48:13,774 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.821, Acc: 0.980, Base Lr: 3.20e-04
2022-04-15 22:48:25,939 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.145[s] Speed: 110.0[samples/s]
2022-04-15 22:48:37,902 reid_baseline.train INFO: normal accuracy 0.7433044911413268 2.0280938148498535 
2022-04-15 22:48:37,904 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 22:48:37,904 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 202.8%
2022-04-15 22:48:53,840 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.812, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 22:49:05,515 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.814, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 22:49:14,578 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.134[s] Speed: 119.1[samples/s]
2022-04-15 22:49:24,876 reid_baseline.train INFO: normal accuracy 0.7478368355995055 1.992971658706665 
2022-04-15 22:49:24,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 22:49:24,877 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 199.3%
2022-04-15 22:49:41,233 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.832, Acc: 0.976, Base Lr: 1.26e-04
2022-04-15 22:49:57,857 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.822, Acc: 0.980, Base Lr: 1.26e-04
2022-04-15 22:50:10,080 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.166[s] Speed: 96.6[samples/s]
2022-04-15 22:50:20,162 reid_baseline.train INFO: normal accuracy 0.7474248042851257 1.9908794164657593 
2022-04-15 22:50:20,162 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 22:50:20,162 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 199.1%
2022-04-15 22:50:34,004 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.819, Acc: 0.979, Base Lr: 6.51e-05
2022-04-15 22:50:46,276 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 6.51e-05
2022-04-15 22:50:57,552 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.137[s] Speed: 116.9[samples/s]
2022-04-15 22:51:09,602 reid_baseline.train INFO: normal accuracy 0.7466007416563659 2.0073840618133545 
2022-04-15 22:51:09,603 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 22:51:09,603 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 200.7%
2022-04-15 22:51:26,867 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.815, Acc: 0.986, Base Lr: 2.83e-05
2022-04-15 22:51:38,456 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 2.83e-05
2022-04-15 22:51:47,305 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.138[s] Speed: 115.9[samples/s]
2022-04-15 22:51:58,045 reid_baseline.train INFO: normal accuracy 0.7445405850844664 1.9896785020828247 
2022-04-15 22:51:58,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 22:51:58,046 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 199.0%
2022-04-15 22:52:11,942 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.825, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 22:52:28,522 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 1.60e-05
2022-04-15 22:52:40,699 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.156[s] Speed: 102.4[samples/s]
2022-04-15 22:52:53,368 reid_baseline.train INFO: normal accuracy 0.7470127729707458 2.0292367935180664 
2022-04-15 22:52:53,369 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 22:52:53,369 reid_baseline.train INFO: Accuracy: 74.7% Mean Entropy: 202.9%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Art_shuffled_key_8/transformer_best_model.pth
2022-04-15 22:53:07,632 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8932185173034668 
2022-04-15 22:53:07,633 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:53:07,633 reid_baseline.train INFO: Accuracy: 74.0%
2022-04-15 22:53:18,124 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8932185173034668 
2022-04-15 22:53:18,125 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:53:18,125 reid_baseline.train INFO: Shuffled Accuracy: 74.0%
2022-04-15 22:53:35,888 reid_baseline.train INFO: normal accuracy 0.9798396334478808 0.6052840948104858 
2022-04-15 22:53:35,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 22:53:35,888 reid_baseline.train INFO: Source Clean Accuracy: 98.0%
2022-04-15 22:53:39,945 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_8
2022-04-15 22:53:39,945 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('0')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-15 22:53:39,945 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 22:53:39,946 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 22:53:39,946 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 22:53:46,487 reid_baseline.train INFO: start training
2022-04-15 22:54:03,290 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.131, Acc: 0.260, Base Lr: 4.76e-04
2022-04-15 22:54:14,278 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.078, Acc: 0.390, Base Lr: 4.76e-04
2022-04-15 22:54:24,143 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.137[s] Speed: 116.6[samples/s]
2022-04-15 22:54:57,989 reid_baseline.train INFO: normal accuracy 0.5554280468212073 4.17037296295166 
2022-04-15 22:55:01,327 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 22:55:01,327 reid_baseline.train INFO: Accuracy: 55.5% Mean Entropy: 417.0%
2022-04-15 22:55:16,611 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.778, Acc: 0.599, Base Lr: 8.72e-04
2022-04-15 22:55:28,632 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.668, Acc: 0.608, Base Lr: 8.72e-04
2022-04-15 22:55:37,333 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.132[s] Speed: 121.4[samples/s]
2022-04-15 22:56:09,682 reid_baseline.train INFO: normal accuracy 0.5864126692678449 4.135551929473877 
2022-04-15 22:56:13,124 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 22:56:13,124 reid_baseline.train INFO: Accuracy: 58.6% Mean Entropy: 413.6%
2022-04-15 22:56:29,785 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.143, Acc: 0.626, Base Lr: 1.27e-03
2022-04-15 22:56:40,960 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 3.004, Acc: 0.632, Base Lr: 1.27e-03
2022-04-15 22:56:50,502 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.137[s] Speed: 117.0[samples/s]
2022-04-15 22:57:22,613 reid_baseline.train INFO: normal accuracy 0.6201514803764058 3.9206507205963135 
2022-04-15 22:57:26,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 22:57:26,029 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 392.1%
2022-04-15 22:57:42,813 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.382, Acc: 0.684, Base Lr: 1.66e-03
2022-04-15 22:57:54,264 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.309, Acc: 0.681, Base Lr: 1.66e-03
2022-04-15 22:58:03,531 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.137[s] Speed: 116.7[samples/s]
2022-04-15 22:58:35,790 reid_baseline.train INFO: normal accuracy 0.7004819830158366 3.4714105129241943 
2022-04-15 22:58:39,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 22:58:39,204 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 347.1%
2022-04-15 22:58:56,138 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.907, Acc: 0.730, Base Lr: 2.06e-03
2022-04-15 22:59:07,102 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.827, Acc: 0.749, Base Lr: 2.06e-03
2022-04-15 22:59:16,146 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.135[s] Speed: 118.5[samples/s]
2022-04-15 22:59:51,917 reid_baseline.train INFO: normal accuracy 0.7482212531558412 2.968963861465454 
2022-04-15 22:59:55,324 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 22:59:55,324 reid_baseline.train INFO: Accuracy: 74.8% Mean Entropy: 296.9%
2022-04-15 23:00:10,955 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.611, Acc: 0.785, Base Lr: 2.46e-03
2022-04-15 23:00:23,030 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.552, Acc: 0.798, Base Lr: 2.46e-03
2022-04-15 23:00:32,776 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.137[s] Speed: 116.9[samples/s]
2022-04-15 23:01:05,921 reid_baseline.train INFO: normal accuracy 0.7709433096167088 2.6554150581359863 
2022-04-15 23:01:09,381 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 23:01:09,381 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 265.5%
2022-04-15 23:01:23,435 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.356, Acc: 0.845, Base Lr: 2.85e-03
2022-04-15 23:01:36,517 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.357, Acc: 0.843, Base Lr: 2.85e-03
2022-04-15 23:01:46,217 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.135[s] Speed: 118.8[samples/s]
2022-04-15 23:02:18,262 reid_baseline.train INFO: normal accuracy 0.7899931145283452 2.4134719371795654 
2022-04-15 23:02:21,983 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 23:02:21,983 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 241.3%
2022-04-15 23:02:34,586 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.228, Acc: 0.884, Base Lr: 3.25e-03
2022-04-15 23:02:47,886 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.242, Acc: 0.873, Base Lr: 3.25e-03
2022-04-15 23:02:57,473 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.130[s] Speed: 123.4[samples/s]
2022-04-15 23:03:30,556 reid_baseline.train INFO: normal accuracy 0.7980261647922883 2.217655658721924 
2022-04-15 23:03:33,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 23:03:33,975 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 221.8%
2022-04-15 23:03:47,380 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.181, Acc: 0.881, Base Lr: 3.64e-03
2022-04-15 23:04:00,050 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.169, Acc: 0.882, Base Lr: 3.64e-03
2022-04-15 23:04:09,169 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.129[s] Speed: 124.4[samples/s]
2022-04-15 23:04:40,903 reid_baseline.train INFO: normal accuracy 0.8037640578379619 2.0907201766967773 
2022-04-15 23:04:44,336 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 23:04:44,336 reid_baseline.train INFO: Accuracy: 80.4% Mean Entropy: 209.1%
2022-04-15 23:04:57,153 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.104, Acc: 0.912, Base Lr: 4.04e-03
2022-04-15 23:05:10,224 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.110, Acc: 0.907, Base Lr: 4.04e-03
2022-04-15 23:05:19,856 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.130[s] Speed: 123.2[samples/s]
2022-04-15 23:05:54,854 reid_baseline.train INFO: normal accuracy 0.8069772779435391 1.9475558996200562 
2022-04-15 23:05:58,281 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 23:05:58,282 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 194.8%
2022-04-15 23:06:11,286 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.080, Acc: 0.916, Base Lr: 4.44e-03
2022-04-15 23:06:24,336 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.073, Acc: 0.917, Base Lr: 4.44e-03
2022-04-15 23:06:34,715 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.133[s] Speed: 120.2[samples/s]
2022-04-15 23:07:07,643 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.9118255376815796 
2022-04-15 23:07:11,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 23:07:11,076 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 191.2%
2022-04-15 23:07:25,200 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 0.996, Acc: 0.945, Base Lr: 4.83e-03
2022-04-15 23:07:37,089 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.008, Acc: 0.938, Base Lr: 4.83e-03
2022-04-15 23:07:48,492 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.137[s] Speed: 117.0[samples/s]
2022-04-15 23:08:20,592 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.8450309038162231 
2022-04-15 23:08:24,010 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 23:08:24,011 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 184.5%
2022-04-15 23:08:38,118 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 0.993, Acc: 0.939, Base Lr: 5.23e-03
2022-04-15 23:08:51,261 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 0.993, Acc: 0.940, Base Lr: 5.23e-03
2022-04-15 23:09:03,421 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.144[s] Speed: 111.1[samples/s]
2022-04-15 23:09:35,587 reid_baseline.train INFO: normal accuracy 0.8092724351618086 1.7785909175872803 
2022-04-15 23:09:38,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 23:09:38,993 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 177.9%
2022-04-15 23:09:52,339 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 0.972, Acc: 0.942, Base Lr: 5.62e-03
2022-04-15 23:10:05,255 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 0.961, Acc: 0.947, Base Lr: 5.62e-03
2022-04-15 23:10:17,466 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.141[s] Speed: 113.8[samples/s]
2022-04-15 23:10:51,205 reid_baseline.train INFO: normal accuracy 0.8136332338765205 1.7761424779891968 
2022-04-15 23:10:55,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 23:10:55,321 reid_baseline.train INFO: Accuracy: 81.4% Mean Entropy: 177.6%
2022-04-15 23:11:08,260 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 0.932, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 23:11:22,909 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 0.937, Acc: 0.952, Base Lr: 6.02e-03
2022-04-15 23:11:35,109 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.145[s] Speed: 110.0[samples/s]
2022-04-15 23:12:08,283 reid_baseline.train INFO: normal accuracy 0.8104200137709433 1.7138601541519165 
2022-04-15 23:12:11,725 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 23:12:11,725 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 171.4%
2022-04-15 23:12:24,578 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 0.918, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 23:12:39,760 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 0.920, Acc: 0.959, Base Lr: 6.42e-03
2022-04-15 23:12:51,915 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.147[s] Speed: 108.9[samples/s]
2022-04-15 23:13:24,597 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.7639257907867432 
2022-04-15 23:13:24,598 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 23:13:24,598 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 176.4%
2022-04-15 23:13:39,314 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 0.899, Acc: 0.966, Base Lr: 6.81e-03
2022-04-15 23:13:53,988 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 0.909, Acc: 0.960, Base Lr: 6.81e-03
2022-04-15 23:14:06,187 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.152[s] Speed: 105.2[samples/s]
2022-04-15 23:14:41,007 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.7030556201934814 
2022-04-15 23:14:44,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 23:14:44,101 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 170.3%
2022-04-15 23:14:56,891 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 0.886, Acc: 0.966, Base Lr: 7.21e-03
2022-04-15 23:15:11,840 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 0.895, Acc: 0.965, Base Lr: 7.21e-03
2022-04-15 23:15:24,019 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.146[s] Speed: 109.7[samples/s]
2022-04-15 23:16:01,194 reid_baseline.train INFO: normal accuracy 0.8095019508836355 1.7063789367675781 
2022-04-15 23:16:01,197 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 23:16:01,197 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 170.6%
2022-04-15 23:16:14,767 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 0.881, Acc: 0.970, Base Lr: 7.60e-03
2022-04-15 23:16:23,498 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 0.883, Acc: 0.968, Base Lr: 7.60e-03
2022-04-15 23:16:33,104 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.117[s] Speed: 137.2[samples/s]
2022-04-15 23:17:10,572 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.6712359189987183 
2022-04-15 23:17:13,678 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 23:17:13,678 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 167.1%
2022-04-15 23:17:27,652 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 0.875, Acc: 0.967, Base Lr: 4.01e-03
2022-04-15 23:17:43,880 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 0.865, Acc: 0.974, Base Lr: 4.01e-03
2022-04-15 23:17:52,396 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.142[s] Speed: 113.0[samples/s]
2022-04-15 23:18:25,219 reid_baseline.train INFO: normal accuracy 0.8092724351618086 1.7895931005477905 
2022-04-15 23:18:25,219 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 23:18:25,219 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 179.0%
2022-04-15 23:18:34,118 reid_baseline.train INFO: Epoch[21] Iteration[100/273] Loss: 0.852, Acc: 0.974, Base Lr: 3.69e-03
2022-04-15 23:18:42,352 reid_baseline.train INFO: Epoch[21] Iteration[200/273] Loss: 0.852, Acc: 0.973, Base Lr: 3.69e-03
2022-04-15 23:18:48,428 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.085[s] Speed: 188.8[samples/s]
2022-04-15 23:19:18,501 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.7397880554199219 
2022-04-15 23:19:18,501 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 23:19:18,501 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 174.0%
2022-04-15 23:19:27,400 reid_baseline.train INFO: Epoch[22] Iteration[100/273] Loss: 0.845, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 23:19:35,595 reid_baseline.train INFO: Epoch[22] Iteration[200/273] Loss: 0.846, Acc: 0.979, Base Lr: 3.38e-03
2022-04-15 23:19:41,689 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.085[s] Speed: 189.0[samples/s]
2022-04-15 23:20:12,661 reid_baseline.train INFO: normal accuracy 0.8099609823272894 1.7400940656661987 
2022-04-15 23:20:12,662 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 23:20:12,662 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 174.0%
2022-04-15 23:20:21,572 reid_baseline.train INFO: Epoch[23] Iteration[100/273] Loss: 0.847, Acc: 0.976, Base Lr: 3.08e-03
2022-04-15 23:20:29,797 reid_baseline.train INFO: Epoch[23] Iteration[200/273] Loss: 0.842, Acc: 0.979, Base Lr: 3.08e-03
2022-04-15 23:20:35,870 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.085[s] Speed: 188.8[samples/s]
2022-04-15 23:21:07,362 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.7050412893295288 
2022-04-15 23:21:07,362 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 23:21:07,362 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 170.5%
2022-04-15 23:21:16,254 reid_baseline.train INFO: Epoch[24] Iteration[100/273] Loss: 0.838, Acc: 0.979, Base Lr: 2.77e-03
2022-04-15 23:21:24,472 reid_baseline.train INFO: Epoch[24] Iteration[200/273] Loss: 0.836, Acc: 0.981, Base Lr: 2.77e-03
2022-04-15 23:21:30,580 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.085[s] Speed: 188.7[samples/s]
2022-04-15 23:22:00,583 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.7600997686386108 
2022-04-15 23:22:00,583 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 23:22:00,583 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 176.0%
2022-04-15 23:22:09,466 reid_baseline.train INFO: Epoch[25] Iteration[100/273] Loss: 0.841, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 23:22:17,693 reid_baseline.train INFO: Epoch[25] Iteration[200/273] Loss: 0.840, Acc: 0.979, Base Lr: 2.48e-03
2022-04-15 23:22:23,788 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.085[s] Speed: 188.8[samples/s]
2022-04-15 23:22:54,747 reid_baseline.train INFO: normal accuracy 0.8108790452145972 1.712369680404663 
2022-04-15 23:22:54,748 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 23:22:54,748 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 171.2%
2022-04-15 23:23:03,653 reid_baseline.train INFO: Epoch[26] Iteration[100/273] Loss: 0.826, Acc: 0.984, Base Lr: 2.20e-03
2022-04-15 23:23:11,881 reid_baseline.train INFO: Epoch[26] Iteration[200/273] Loss: 0.837, Acc: 0.979, Base Lr: 2.20e-03
2022-04-15 23:23:18,003 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.085[s] Speed: 188.4[samples/s]
2022-04-15 23:23:49,681 reid_baseline.train INFO: normal accuracy 0.8122561395455589 1.7548620700836182 
2022-04-15 23:23:49,681 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 23:23:49,681 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 175.5%
2022-04-15 23:23:58,580 reid_baseline.train INFO: Epoch[27] Iteration[100/273] Loss: 0.839, Acc: 0.973, Base Lr: 1.92e-03
2022-04-15 23:24:06,817 reid_baseline.train INFO: Epoch[27] Iteration[200/273] Loss: 0.838, Acc: 0.972, Base Lr: 1.92e-03
2022-04-15 23:24:12,922 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.085[s] Speed: 188.5[samples/s]
2022-04-15 23:24:43,117 reid_baseline.train INFO: normal accuracy 0.8129446867110397 1.7659794092178345 
2022-04-15 23:24:43,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 23:24:43,117 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 176.6%
2022-04-15 23:24:52,038 reid_baseline.train INFO: Epoch[28] Iteration[100/273] Loss: 0.829, Acc: 0.981, Base Lr: 1.66e-03
2022-04-15 23:25:00,266 reid_baseline.train INFO: Epoch[28] Iteration[200/273] Loss: 0.831, Acc: 0.982, Base Lr: 1.66e-03
2022-04-15 23:25:06,376 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.085[s] Speed: 188.4[samples/s]
2022-04-15 23:25:36,241 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.7323894500732422 
2022-04-15 23:25:36,241 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 23:25:36,241 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 173.2%
2022-04-15 23:25:45,132 reid_baseline.train INFO: Epoch[29] Iteration[100/273] Loss: 0.829, Acc: 0.982, Base Lr: 1.42e-03
2022-04-15 23:25:53,356 reid_baseline.train INFO: Epoch[29] Iteration[200/273] Loss: 0.823, Acc: 0.983, Base Lr: 1.42e-03
2022-04-15 23:25:59,469 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.085[s] Speed: 188.6[samples/s]
2022-04-15 23:26:29,570 reid_baseline.train INFO: normal accuracy 0.8106495294927702 1.7458206415176392 
2022-04-15 23:26:29,570 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 23:26:29,570 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 174.6%
2022-04-15 23:26:38,497 reid_baseline.train INFO: Epoch[30] Iteration[100/273] Loss: 0.830, Acc: 0.977, Base Lr: 1.19e-03
2022-04-15 23:26:46,768 reid_baseline.train INFO: Epoch[30] Iteration[200/273] Loss: 0.827, Acc: 0.978, Base Lr: 1.19e-03
2022-04-15 23:26:52,865 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.085[s] Speed: 188.1[samples/s]
2022-04-15 23:27:26,324 reid_baseline.train INFO: normal accuracy 0.8113380766582511 1.7215163707733154 
2022-04-15 23:27:26,324 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 23:27:26,324 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 172.2%
2022-04-15 23:27:35,231 reid_baseline.train INFO: Epoch[31] Iteration[100/273] Loss: 0.823, Acc: 0.981, Base Lr: 9.72e-04
2022-04-15 23:27:43,425 reid_baseline.train INFO: Epoch[31] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 9.72e-04
2022-04-15 23:27:49,552 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.085[s] Speed: 188.7[samples/s]
2022-04-15 23:28:18,805 reid_baseline.train INFO: normal accuracy 0.8113380766582511 1.8060743808746338 
2022-04-15 23:28:18,805 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 23:28:18,806 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 180.6%
2022-04-15 23:28:27,722 reid_baseline.train INFO: Epoch[32] Iteration[100/273] Loss: 0.815, Acc: 0.983, Base Lr: 7.78e-04
2022-04-15 23:28:35,965 reid_baseline.train INFO: Epoch[32] Iteration[200/273] Loss: 0.818, Acc: 0.981, Base Lr: 7.78e-04
2022-04-15 23:28:42,042 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.085[s] Speed: 188.6[samples/s]
2022-04-15 23:29:12,487 reid_baseline.train INFO: normal accuracy 0.8095019508836355 1.7821675539016724 
2022-04-15 23:29:12,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 23:29:12,488 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 178.2%
2022-04-15 23:29:21,417 reid_baseline.train INFO: Epoch[33] Iteration[100/273] Loss: 0.817, Acc: 0.982, Base Lr: 6.04e-04
2022-04-15 23:29:29,612 reid_baseline.train INFO: Epoch[33] Iteration[200/273] Loss: 0.820, Acc: 0.982, Base Lr: 6.04e-04
2022-04-15 23:29:35,679 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.085[s] Speed: 188.9[samples/s]
2022-04-15 23:30:06,689 reid_baseline.train INFO: normal accuracy 0.807436309387193 1.7851974964141846 
2022-04-15 23:30:06,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 23:30:06,689 reid_baseline.train INFO: Accuracy: 80.7% Mean Entropy: 178.5%
2022-04-15 23:30:15,551 reid_baseline.train INFO: Epoch[34] Iteration[100/273] Loss: 0.819, Acc: 0.983, Base Lr: 4.51e-04
2022-04-15 23:30:23,739 reid_baseline.train INFO: Epoch[34] Iteration[200/273] Loss: 0.818, Acc: 0.984, Base Lr: 4.51e-04
2022-04-15 23:30:29,798 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.084[s] Speed: 189.6[samples/s]
2022-04-15 23:31:00,229 reid_baseline.train INFO: normal accuracy 0.8083543722745008 1.7626293897628784 
2022-04-15 23:31:00,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 23:31:00,229 reid_baseline.train INFO: Accuracy: 80.8% Mean Entropy: 176.3%
2022-04-15 23:31:09,155 reid_baseline.train INFO: Epoch[35] Iteration[100/273] Loss: 0.814, Acc: 0.981, Base Lr: 3.20e-04
2022-04-15 23:31:17,393 reid_baseline.train INFO: Epoch[35] Iteration[200/273] Loss: 0.821, Acc: 0.980, Base Lr: 3.20e-04
2022-04-15 23:31:23,486 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.085[s] Speed: 188.4[samples/s]
2022-04-15 23:31:54,311 reid_baseline.train INFO: normal accuracy 0.811797108101905 1.7898091077804565 
2022-04-15 23:31:54,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 23:31:54,311 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 179.0%
2022-04-15 23:32:03,247 reid_baseline.train INFO: Epoch[36] Iteration[100/273] Loss: 0.812, Acc: 0.984, Base Lr: 2.11e-04
2022-04-15 23:32:11,495 reid_baseline.train INFO: Epoch[36] Iteration[200/273] Loss: 0.814, Acc: 0.983, Base Lr: 2.11e-04
2022-04-15 23:32:17,583 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.085[s] Speed: 188.3[samples/s]
2022-04-15 23:32:47,635 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7465109825134277 
2022-04-15 23:32:47,635 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 23:32:47,635 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 174.7%
2022-04-15 23:32:56,568 reid_baseline.train INFO: Epoch[37] Iteration[100/273] Loss: 0.832, Acc: 0.976, Base Lr: 1.26e-04
2022-04-15 23:33:04,827 reid_baseline.train INFO: Epoch[37] Iteration[200/273] Loss: 0.822, Acc: 0.980, Base Lr: 1.26e-04
2022-04-15 23:33:10,942 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.085[s] Speed: 188.0[samples/s]
2022-04-15 23:33:40,714 reid_baseline.train INFO: normal accuracy 0.811567592380078 1.740283727645874 
2022-04-15 23:33:40,714 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 23:33:40,714 reid_baseline.train INFO: Accuracy: 81.2% Mean Entropy: 174.0%
2022-04-15 23:33:49,546 reid_baseline.train INFO: Epoch[38] Iteration[100/273] Loss: 0.819, Acc: 0.979, Base Lr: 6.51e-05
2022-04-15 23:33:57,719 reid_baseline.train INFO: Epoch[38] Iteration[200/273] Loss: 0.817, Acc: 0.983, Base Lr: 6.51e-05
2022-04-15 23:34:03,792 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.084[s] Speed: 189.9[samples/s]
2022-04-15 23:34:34,807 reid_baseline.train INFO: normal accuracy 0.8111085609364241 1.7586110830307007 
2022-04-15 23:34:34,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 23:34:34,807 reid_baseline.train INFO: Accuracy: 81.1% Mean Entropy: 175.9%
2022-04-15 23:34:43,697 reid_baseline.train INFO: Epoch[39] Iteration[100/273] Loss: 0.815, Acc: 0.986, Base Lr: 2.83e-05
2022-04-15 23:34:51,871 reid_baseline.train INFO: Epoch[39] Iteration[200/273] Loss: 0.819, Acc: 0.983, Base Lr: 2.83e-05
2022-04-15 23:34:57,979 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.085[s] Speed: 189.1[samples/s]
2022-04-15 23:35:29,625 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.7430752515792847 
2022-04-15 23:35:29,625 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 23:35:29,625 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 174.3%
2022-04-15 23:35:38,563 reid_baseline.train INFO: Epoch[40] Iteration[100/273] Loss: 0.825, Acc: 0.979, Base Lr: 1.60e-05
2022-04-15 23:35:46,816 reid_baseline.train INFO: Epoch[40] Iteration[200/273] Loss: 0.819, Acc: 0.980, Base Lr: 1.60e-05
2022-04-15 23:35:52,912 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.085[s] Speed: 188.2[samples/s]
2022-04-15 23:36:24,704 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.7860208749771118 
2022-04-15 23:36:24,705 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 23:36:24,705 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 178.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Clipart_2_Real_World_shuffled_key_8/transformer_best_model.pth
2022-04-15 23:36:59,515 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.6712359189987183 
2022-04-15 23:36:59,515 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:36:59,515 reid_baseline.train INFO: Accuracy: 80.8%
2022-04-15 23:37:28,961 reid_baseline.train INFO: normal accuracy 0.8081248565526739 1.6712359189987183 
2022-04-15 23:37:28,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:37:28,962 reid_baseline.train INFO: Shuffled Accuracy: 80.8%
2022-04-15 23:37:39,765 reid_baseline.train INFO: normal accuracy 0.9798396334478808 0.6052840948104858 
2022-04-15 23:37:39,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 23:37:39,765 reid_baseline.train INFO: Source Clean Accuracy: 98.0%
