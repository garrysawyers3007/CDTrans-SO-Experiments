2022-04-16 15:31:21,872 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_4
2022-04-16 15:31:21,873 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-16 15:31:21,873 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 15:31:21,873 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 15:31:21,873 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 15:31:26,230 reid_baseline.train INFO: start training
2022-04-16 15:32:00,398 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.203, Base Lr: 4.76e-04
2022-04-16 15:32:21,788 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.364[s] Speed: 44.0[samples/s]
2022-04-16 15:32:48,890 reid_baseline.train INFO: normal accuracy 0.43681009236314483 4.173007488250732 
2022-04-16 15:32:52,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 15:32:52,038 reid_baseline.train INFO: Accuracy: 43.7% Mean Entropy: 417.3%
2022-04-16 15:33:31,287 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.986, Acc: 0.573, Base Lr: 8.72e-04
2022-04-16 15:33:46,894 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.361[s] Speed: 44.3[samples/s]
2022-04-16 15:34:18,175 reid_baseline.train INFO: normal accuracy 0.503041225501239 4.168972492218018 
2022-04-16 15:34:22,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 15:34:22,164 reid_baseline.train INFO: Accuracy: 50.3% Mean Entropy: 416.9%
2022-04-16 15:35:02,396 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.700, Acc: 0.604, Base Lr: 1.27e-03
2022-04-16 15:35:21,988 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.394[s] Speed: 40.7[samples/s]
2022-04-16 15:35:51,987 reid_baseline.train INFO: normal accuracy 0.5158819553953593 4.147563457489014 
2022-04-16 15:35:55,136 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 15:35:55,137 reid_baseline.train INFO: Accuracy: 51.6% Mean Entropy: 414.8%
2022-04-16 15:36:30,021 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.616, Base Lr: 1.66e-03
2022-04-16 15:36:50,749 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.366[s] Speed: 43.8[samples/s]
2022-04-16 15:37:17,634 reid_baseline.train INFO: normal accuracy 0.5280468574003154 4.044851303100586 
2022-04-16 15:37:20,763 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 15:37:20,764 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 404.5%
2022-04-16 15:37:58,810 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.732, Acc: 0.629, Base Lr: 2.06e-03
2022-04-16 15:38:14,490 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.353[s] Speed: 45.3[samples/s]
2022-04-16 15:38:49,431 reid_baseline.train INFO: normal accuracy 0.5654426672674026 3.7709171772003174 
2022-04-16 15:38:53,321 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 15:38:53,329 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 377.1%
2022-04-16 15:39:35,377 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.269, Acc: 0.670, Base Lr: 2.46e-03
2022-04-16 15:39:55,536 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-16 15:40:29,021 reid_baseline.train INFO: normal accuracy 0.5967560261320117 3.33941912651062 
2022-04-16 15:40:34,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 15:40:34,482 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 333.9%
2022-04-16 15:41:13,108 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.927, Acc: 0.717, Base Lr: 2.85e-03
2022-04-16 15:41:33,151 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.386[s] Speed: 41.5[samples/s]
2022-04-16 15:42:00,370 reid_baseline.train INFO: normal accuracy 0.6618607794548321 2.9559056758880615 
2022-04-16 15:42:03,475 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 15:42:03,476 reid_baseline.train INFO: Accuracy: 66.2% Mean Entropy: 295.6%
2022-04-16 15:42:41,402 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.710, Acc: 0.756, Base Lr: 3.25e-03
2022-04-16 15:42:56,612 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-16 15:43:28,272 reid_baseline.train INFO: normal accuracy 0.7071412480288354 2.637052297592163 
2022-04-16 15:43:31,384 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 15:43:31,386 reid_baseline.train INFO: Accuracy: 70.7% Mean Entropy: 263.7%
2022-04-16 15:44:11,643 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.549, Acc: 0.787, Base Lr: 3.64e-03
2022-04-16 15:44:31,340 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 15:45:43,801 reid_baseline.train INFO: normal accuracy 0.7364271232259518 2.4024734497070312 
2022-04-16 15:45:48,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 15:45:48,690 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 240.2%
2022-04-16 15:46:30,597 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.408, Acc: 0.833, Base Lr: 4.04e-03
2022-04-16 15:46:50,706 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.408[s] Speed: 39.2[samples/s]
2022-04-16 15:47:26,501 reid_baseline.train INFO: normal accuracy 0.7558008560486597 2.1438403129577637 
2022-04-16 15:47:31,713 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 15:47:31,714 reid_baseline.train INFO: Accuracy: 75.6% Mean Entropy: 214.4%
2022-04-16 15:48:09,703 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.354, Acc: 0.834, Base Lr: 4.44e-03
2022-04-16 15:48:30,731 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.388[s] Speed: 41.2[samples/s]
2022-04-16 15:48:58,034 reid_baseline.train INFO: normal accuracy 0.7623338589772471 2.007253646850586 
2022-04-16 15:49:01,126 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 15:49:01,127 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 200.7%
2022-04-16 15:49:36,730 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.285, Acc: 0.866, Base Lr: 4.83e-03
2022-04-16 15:49:50,494 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 15:50:21,158 reid_baseline.train INFO: normal accuracy 0.7661635503491777 1.8268591165542603 
2022-04-16 15:50:24,286 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 15:50:24,287 reid_baseline.train INFO: Accuracy: 76.6% Mean Entropy: 182.7%
2022-04-16 15:51:03,454 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.221, Acc: 0.873, Base Lr: 5.23e-03
2022-04-16 15:51:23,606 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-16 15:51:51,854 reid_baseline.train INFO: normal accuracy 0.7695426897949988 1.767317771911621 
2022-04-16 15:51:54,990 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 15:51:54,991 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 176.7%
2022-04-16 15:52:29,048 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.171, Acc: 0.890, Base Lr: 5.62e-03
2022-04-16 15:52:47,599 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-16 15:53:13,562 reid_baseline.train INFO: normal accuracy 0.7747240369452579 1.7789279222488403 
2022-04-16 15:53:13,562 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 15:53:13,562 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 177.9%
2022-04-16 15:53:54,252 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.126, Acc: 0.905, Base Lr: 6.02e-03
2022-04-16 15:54:10,633 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.375[s] Speed: 42.6[samples/s]
2022-04-16 15:54:48,913 reid_baseline.train INFO: normal accuracy 0.7713448974994368 1.7180981636047363 
2022-04-16 15:54:53,458 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 15:54:53,458 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 171.8%
2022-04-16 15:55:35,051 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.090, Acc: 0.909, Base Lr: 6.42e-03
2022-04-16 15:55:56,556 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.415[s] Speed: 38.5[samples/s]
2022-04-16 15:56:22,566 reid_baseline.train INFO: normal accuracy 0.7735976571299842 1.6607264280319214 
2022-04-16 15:56:25,674 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 15:56:25,674 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 166.1%
2022-04-16 15:56:57,543 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.070, Acc: 0.918, Base Lr: 6.81e-03
2022-04-16 15:57:16,168 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-16 15:57:43,668 reid_baseline.train INFO: normal accuracy 0.7787790042802433 1.6792752742767334 
2022-04-16 15:57:43,672 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 15:57:43,673 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 167.9%
2022-04-16 15:58:23,914 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.065, Acc: 0.924, Base Lr: 7.21e-03
2022-04-16 15:58:42,387 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-16 15:59:17,402 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6312674283981323 
2022-04-16 15:59:22,814 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 15:59:22,815 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 163.1%
2022-04-16 16:00:03,892 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.023, Acc: 0.936, Base Lr: 7.60e-03
2022-04-16 16:00:23,776 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-16 16:00:50,378 reid_baseline.train INFO: normal accuracy 0.7801306600585718 1.6796067953109741 
2022-04-16 16:00:50,382 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 16:00:50,383 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 168.0%
2022-04-16 16:01:24,969 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.981, Acc: 0.945, Base Lr: 4.01e-03
2022-04-16 16:01:43,623 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 16:02:14,719 reid_baseline.train INFO: normal accuracy 0.7774273485019149 1.6539835929870605 
2022-04-16 16:02:14,724 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 16:02:14,724 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 165.4%
2022-04-16 16:02:55,775 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.963, Acc: 0.952, Base Lr: 3.69e-03
2022-04-16 16:03:14,367 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 16:03:48,441 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.6483474969863892 
2022-04-16 16:03:48,444 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 16:03:48,445 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 164.8%
2022-04-16 16:04:30,204 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.952, Acc: 0.952, Base Lr: 3.38e-03
2022-04-16 16:04:49,413 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-16 16:05:16,313 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.662675380706787 
2022-04-16 16:05:16,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 16:05:16,315 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 166.3%
2022-04-16 16:05:49,328 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.951, Acc: 0.958, Base Lr: 3.08e-03
2022-04-16 16:06:04,789 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-16 16:06:33,228 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.7064887285232544 
2022-04-16 16:06:33,231 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 16:06:33,231 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 170.6%
2022-04-16 16:07:14,865 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.946, Acc: 0.962, Base Lr: 2.77e-03
2022-04-16 16:07:34,037 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-16 16:08:07,602 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7359334230422974 
2022-04-16 16:08:07,603 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 16:08:07,603 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 173.6%
2022-04-16 16:08:47,362 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.925, Acc: 0.964, Base Lr: 2.48e-03
2022-04-16 16:09:07,669 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-16 16:09:34,941 reid_baseline.train INFO: normal accuracy 0.7839603514305024 1.6579530239105225 
2022-04-16 16:09:34,943 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 16:09:34,944 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 165.8%
2022-04-16 16:10:10,432 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.926, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 16:10:26,327 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-16 16:10:59,514 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.6955499649047852 
2022-04-16 16:10:59,517 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 16:10:59,517 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 169.6%
2022-04-16 16:11:41,071 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.909, Acc: 0.973, Base Lr: 1.92e-03
2022-04-16 16:12:02,107 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.412[s] Speed: 38.9[samples/s]
2022-04-16 16:12:32,935 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.6624714136123657 
2022-04-16 16:12:32,935 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 16:12:32,935 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 166.2%
2022-04-16 16:13:05,284 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.908, Acc: 0.969, Base Lr: 1.66e-03
2022-04-16 16:13:25,425 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-16 16:13:52,686 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.7308374643325806 
2022-04-16 16:13:52,690 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 16:13:52,690 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 173.1%
2022-04-16 16:14:32,574 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.921, Acc: 0.967, Base Lr: 1.42e-03
2022-04-16 16:14:48,240 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.365[s] Speed: 43.8[samples/s]
2022-04-16 16:15:22,412 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.6709855794906616 
2022-04-16 16:15:22,412 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 16:15:22,412 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 167.1%
2022-04-16 16:16:05,265 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.900, Acc: 0.974, Base Lr: 1.19e-03
2022-04-16 16:16:26,658 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.423[s] Speed: 37.9[samples/s]
2022-04-16 16:17:07,206 reid_baseline.train INFO: normal accuracy 0.7873394908763235 1.682641625404358 
2022-04-16 16:17:07,208 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 16:17:07,208 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 168.3%
2022-04-16 16:17:42,752 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.907, Acc: 0.969, Base Lr: 9.72e-04
2022-04-16 16:18:02,584 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.364[s] Speed: 43.9[samples/s]
2022-04-16 16:18:29,477 reid_baseline.train INFO: normal accuracy 0.787790042802433 1.6470305919647217 
2022-04-16 16:18:29,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 16:18:29,482 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 164.7%
2022-04-16 16:19:09,331 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.906, Acc: 0.968, Base Lr: 7.78e-04
2022-04-16 16:19:25,964 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.372[s] Speed: 43.1[samples/s]
2022-04-16 16:19:56,304 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6560808420181274 
2022-04-16 16:19:56,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 16:19:56,309 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 165.6%
2022-04-16 16:20:36,493 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.892, Acc: 0.978, Base Lr: 6.04e-04
2022-04-16 16:20:56,372 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-16 16:21:23,885 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.7376465797424316 
2022-04-16 16:21:23,888 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 16:21:23,888 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 173.8%
2022-04-16 16:21:55,406 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.884, Acc: 0.977, Base Lr: 4.51e-04
2022-04-16 16:22:14,596 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-16 16:23:22,173 reid_baseline.train INFO: normal accuracy 0.7866636629871593 1.7252061367034912 
2022-04-16 16:23:22,175 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 16:23:22,176 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 172.5%
2022-04-16 16:23:54,771 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.908, Acc: 0.971, Base Lr: 3.20e-04
2022-04-16 16:24:11,203 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-16 16:24:38,514 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.6820687055587769 
2022-04-16 16:24:38,516 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 16:24:38,516 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 168.2%
2022-04-16 16:25:19,913 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.889, Acc: 0.979, Base Lr: 2.11e-04
2022-04-16 16:25:41,624 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.415[s] Speed: 38.5[samples/s]
2022-04-16 16:26:16,563 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.701282024383545 
2022-04-16 16:26:16,568 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 16:26:16,568 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 170.1%
2022-04-16 16:26:55,828 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.885, Acc: 0.974, Base Lr: 1.26e-04
2022-04-16 16:27:14,673 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 16:27:41,685 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6833759546279907 
2022-04-16 16:27:41,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 16:27:41,690 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 168.3%
2022-04-16 16:28:17,435 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.893, Acc: 0.974, Base Lr: 6.51e-05
2022-04-16 16:28:33,367 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 16:29:01,090 reid_baseline.train INFO: normal accuracy 0.787790042802433 1.640333890914917 
2022-04-16 16:29:01,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 16:29:01,093 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 164.0%
2022-04-16 16:29:43,597 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.887, Acc: 0.978, Base Lr: 2.83e-05
2022-04-16 16:30:03,875 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.413[s] Speed: 38.7[samples/s]
2022-04-16 16:30:35,740 reid_baseline.train INFO: normal accuracy 0.787790042802433 1.73662531375885 
2022-04-16 16:30:35,744 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 16:30:35,745 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 173.7%
2022-04-16 16:31:14,379 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.883, Acc: 0.979, Base Lr: 1.60e-05
2022-04-16 16:31:33,790 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 16:32:04,226 reid_baseline.train INFO: normal accuracy 0.7884658706915972 1.7008366584777832 
2022-04-16 16:32:04,230 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 16:32:04,231 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 170.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_4/transformer_best_model.pth
2022-04-16 16:32:35,465 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6312674283981323 
2022-04-16 16:32:35,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:32:35,466 reid_baseline.train INFO: Accuracy: 77.9%
2022-04-16 16:33:07,408 reid_baseline.train INFO: normal accuracy 0.7794548321694075 1.6312674283981323 
2022-04-16 16:33:07,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:33:07,408 reid_baseline.train INFO: Shuffled Accuracy: 77.9%
2022-04-16 16:33:31,068 reid_baseline.train INFO: normal accuracy 0.9822826534816647 0.7822054624557495 
2022-04-16 16:33:31,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 16:33:31,068 reid_baseline.train INFO: Source Clean Accuracy: 98.2%
2022-04-16 16:33:36,022 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_4
2022-04-16 16:33:36,022 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_4', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=4, dom_cls=False)
2022-04-16 16:33:36,022 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 16:33:36,023 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 16:33:36,023 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_4
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 16:33:45,788 reid_baseline.train INFO: start training
2022-04-16 16:34:33,488 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.202, Base Lr: 4.76e-04
2022-04-16 16:34:50,647 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.419[s] Speed: 38.2[samples/s]
2022-04-16 16:36:28,021 reid_baseline.train INFO: normal accuracy 0.5079182924030297 4.172943592071533 
2022-04-16 16:36:31,050 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 16:36:31,051 reid_baseline.train INFO: Accuracy: 50.8% Mean Entropy: 417.3%
2022-04-16 16:37:09,580 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.986, Acc: 0.572, Base Lr: 8.72e-04
2022-04-16 16:37:27,649 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 16:39:11,506 reid_baseline.train INFO: normal accuracy 0.5967408767500574 4.167945384979248 
2022-04-16 16:39:14,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 16:39:14,620 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 416.8%
2022-04-16 16:39:55,875 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.700, Acc: 0.605, Base Lr: 1.27e-03
2022-04-16 16:40:16,216 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-16 16:41:57,826 reid_baseline.train INFO: normal accuracy 0.6118889143906358 4.137287139892578 
2022-04-16 16:42:00,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 16:42:00,918 reid_baseline.train INFO: Accuracy: 61.2% Mean Entropy: 413.7%
2022-04-16 16:42:34,661 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.616, Base Lr: 1.66e-03
2022-04-16 16:42:51,567 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-16 16:44:25,807 reid_baseline.train INFO: normal accuracy 0.6217580904291944 3.981332540512085 
2022-04-16 16:44:28,926 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 16:44:28,926 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 398.1%
2022-04-16 16:45:07,432 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.732, Acc: 0.630, Base Lr: 2.06e-03
2022-04-16 16:45:27,114 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.383[s] Speed: 41.8[samples/s]
2022-04-16 16:47:07,910 reid_baseline.train INFO: normal accuracy 0.652742712875832 3.5791921615600586 
2022-04-16 16:47:11,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 16:47:11,007 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 357.9%
2022-04-16 16:47:52,980 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.269, Acc: 0.670, Base Lr: 2.46e-03
2022-04-16 16:48:10,906 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 16:49:49,960 reid_baseline.train INFO: normal accuracy 0.6851044296534312 3.0804383754730225 
2022-04-16 16:49:53,095 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 16:49:53,095 reid_baseline.train INFO: Accuracy: 68.5% Mean Entropy: 308.0%
2022-04-16 16:50:27,683 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.927, Acc: 0.717, Base Lr: 2.85e-03
2022-04-16 16:50:47,509 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.358[s] Speed: 44.7[samples/s]
2022-04-16 16:52:26,269 reid_baseline.train INFO: normal accuracy 0.7316961211843012 2.6587419509887695 
2022-04-16 16:52:29,408 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 16:52:29,408 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 265.9%
2022-04-16 16:53:10,002 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.710, Acc: 0.756, Base Lr: 3.25e-03
2022-04-16 16:53:29,538 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-16 16:55:07,770 reid_baseline.train INFO: normal accuracy 0.7688776681202663 2.351752519607544 
2022-04-16 16:55:10,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 16:55:10,939 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 235.2%
2022-04-16 16:55:50,758 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.549, Acc: 0.787, Base Lr: 3.64e-03
2022-04-16 16:56:09,848 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.388[s] Speed: 41.3[samples/s]
2022-04-16 16:57:53,040 reid_baseline.train INFO: normal accuracy 0.7932063346339224 2.1174821853637695 
2022-04-16 16:57:56,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 16:57:56,256 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 211.7%
2022-04-16 16:58:29,944 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.408, Acc: 0.834, Base Lr: 4.04e-03
2022-04-16 16:58:45,588 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-16 17:00:56,138 reid_baseline.train INFO: normal accuracy 0.8097314666054625 1.8816859722137451 
2022-04-16 17:00:59,306 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 17:00:59,307 reid_baseline.train INFO: Accuracy: 81.0% Mean Entropy: 188.2%
2022-04-16 17:01:38,628 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.354, Acc: 0.836, Base Lr: 4.44e-03
2022-04-16 17:01:58,891 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 17:03:53,418 reid_baseline.train INFO: normal accuracy 0.8177645168694055 1.7360526323318481 
2022-04-16 17:03:56,602 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 17:03:56,603 reid_baseline.train INFO: Accuracy: 81.8% Mean Entropy: 173.6%
2022-04-16 17:04:23,482 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.285, Acc: 0.864, Base Lr: 4.83e-03
2022-04-16 17:04:38,989 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-16 17:06:06,852 reid_baseline.train INFO: normal accuracy 0.8230433784714253 1.5792572498321533 
2022-04-16 17:06:09,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 17:06:09,986 reid_baseline.train INFO: Accuracy: 82.3% Mean Entropy: 157.9%
2022-04-16 17:06:44,234 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.221, Acc: 0.874, Base Lr: 5.23e-03
2022-04-16 17:07:00,923 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-16 17:08:43,738 reid_baseline.train INFO: normal accuracy 0.8251090199678678 1.527199387550354 
2022-04-16 17:08:46,863 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 17:08:46,864 reid_baseline.train INFO: Accuracy: 82.5% Mean Entropy: 152.7%
2022-04-16 17:09:26,321 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.171, Acc: 0.890, Base Lr: 5.62e-03
2022-04-16 17:09:40,363 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 17:11:39,223 reid_baseline.train INFO: normal accuracy 0.8292403029607528 1.5303617715835571 
2022-04-16 17:11:39,225 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 17:11:39,225 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 153.0%
2022-04-16 17:12:19,298 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.125, Acc: 0.904, Base Lr: 6.02e-03
2022-04-16 17:12:38,808 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 17:14:33,623 reid_baseline.train INFO: normal accuracy 0.832683038788157 1.486286997795105 
2022-04-16 17:14:36,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 17:14:36,744 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 148.6%
2022-04-16 17:15:05,231 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.089, Acc: 0.912, Base Lr: 6.42e-03
2022-04-16 17:15:25,671 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-16 17:16:58,408 reid_baseline.train INFO: normal accuracy 0.8333715859536378 1.426674246788025 
2022-04-16 17:17:01,542 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 17:17:01,542 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 142.7%
2022-04-16 17:17:35,481 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.070, Acc: 0.915, Base Lr: 6.81e-03
2022-04-16 17:17:50,060 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.319[s] Speed: 50.1[samples/s]
2022-04-16 17:19:32,065 reid_baseline.train INFO: normal accuracy 0.832683038788157 1.4368641376495361 
2022-04-16 17:19:32,068 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 17:19:32,068 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 143.7%
2022-04-16 17:20:11,862 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.063, Acc: 0.925, Base Lr: 7.21e-03
2022-04-16 17:20:26,627 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.359[s] Speed: 44.6[samples/s]
2022-04-16 17:22:27,621 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4151179790496826 
2022-04-16 17:22:32,311 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 17:22:32,312 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 141.5%
2022-04-16 17:23:11,647 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.023, Acc: 0.934, Base Lr: 7.60e-03
2022-04-16 17:23:31,669 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-16 17:25:27,709 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.4232233762741089 
2022-04-16 17:25:27,709 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 17:25:27,709 reid_baseline.train INFO: Accuracy: 82.8% Mean Entropy: 142.3%
2022-04-16 17:25:55,291 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.981, Acc: 0.945, Base Lr: 4.01e-03
2022-04-16 17:26:13,111 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.299[s] Speed: 53.6[samples/s]
2022-04-16 17:27:48,484 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.392575740814209 
2022-04-16 17:27:51,605 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 17:27:51,606 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 139.3%
2022-04-16 17:28:25,389 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.962, Acc: 0.950, Base Lr: 3.69e-03
2022-04-16 17:28:40,246 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 17:30:26,172 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.4072870016098022 
2022-04-16 17:30:26,177 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 17:30:26,177 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 140.7%
2022-04-16 17:31:06,129 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.953, Acc: 0.951, Base Lr: 3.38e-03
2022-04-16 17:31:21,428 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.363[s] Speed: 44.0[samples/s]
2022-04-16 17:33:26,026 reid_baseline.train INFO: normal accuracy 0.8352077117282534 1.4185868501663208 
2022-04-16 17:33:26,029 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 17:33:26,029 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 141.9%
2022-04-16 17:34:05,553 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.950, Acc: 0.956, Base Lr: 3.08e-03
2022-04-16 17:34:25,006 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.388[s] Speed: 41.3[samples/s]
2022-04-16 17:36:32,773 reid_baseline.train INFO: normal accuracy 0.8349781960064264 1.4748941659927368 
2022-04-16 17:36:32,773 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 17:36:32,773 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 147.5%
2022-04-16 17:37:12,436 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.945, Acc: 0.965, Base Lr: 2.77e-03
2022-04-16 17:37:28,114 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.364[s] Speed: 44.0[samples/s]
2022-04-16 17:38:56,461 reid_baseline.train INFO: normal accuracy 0.8356667431719073 1.4872188568115234 
2022-04-16 17:38:56,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 17:38:56,464 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 148.7%
2022-04-16 17:39:26,727 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.925, Acc: 0.963, Base Lr: 2.48e-03
2022-04-16 17:39:40,998 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.293[s] Speed: 54.6[samples/s]
2022-04-16 17:41:37,332 reid_baseline.train INFO: normal accuracy 0.8340601331191186 1.4201639890670776 
2022-04-16 17:41:37,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 17:41:37,337 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 142.0%
2022-04-16 17:42:17,190 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.926, Acc: 0.965, Base Lr: 2.20e-03
2022-04-16 17:42:37,446 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-04-16 17:44:41,225 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.4674574136734009 
2022-04-16 17:44:41,225 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 17:44:41,225 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 146.7%
2022-04-16 17:45:13,236 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.908, Acc: 0.973, Base Lr: 1.92e-03
2022-04-16 17:45:32,544 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.337[s] Speed: 47.4[samples/s]
2022-04-16 17:47:14,231 reid_baseline.train INFO: normal accuracy 0.8372733532246959 1.4240679740905762 
2022-04-16 17:47:14,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 17:47:14,232 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 142.4%
2022-04-16 17:47:47,525 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.908, Acc: 0.971, Base Lr: 1.66e-03
2022-04-16 17:48:01,547 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.311[s] Speed: 51.4[samples/s]
2022-04-16 17:49:34,936 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.4955195188522339 
2022-04-16 17:49:34,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 17:49:34,938 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 149.6%
2022-04-16 17:50:08,740 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.922, Acc: 0.969, Base Lr: 1.42e-03
2022-04-16 17:50:23,628 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 17:52:19,208 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4278054237365723 
2022-04-16 17:52:19,213 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 17:52:19,213 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 142.8%
2022-04-16 17:52:59,430 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.900, Acc: 0.974, Base Lr: 1.19e-03
2022-04-16 17:53:19,603 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-16 17:55:26,379 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.4476754665374756 
2022-04-16 17:55:26,380 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 17:55:26,380 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 144.8%
2022-04-16 17:56:03,932 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.907, Acc: 0.969, Base Lr: 9.72e-04
2022-04-16 17:56:24,083 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.379[s] Speed: 42.2[samples/s]
2022-04-16 17:58:10,043 reid_baseline.train INFO: normal accuracy 0.8391094789993114 1.4134044647216797 
2022-04-16 17:58:10,043 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 17:58:10,043 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 141.3%
2022-04-16 17:58:41,350 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.906, Acc: 0.967, Base Lr: 7.78e-04
2022-04-16 17:58:53,939 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.289[s] Speed: 55.4[samples/s]
2022-04-16 18:00:26,314 reid_baseline.train INFO: normal accuracy 0.8363552903373881 1.4217963218688965 
2022-04-16 18:00:26,317 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 18:00:26,317 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 142.2%
2022-04-16 18:00:56,446 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.891, Acc: 0.979, Base Lr: 6.04e-04
2022-04-16 18:01:12,998 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.307[s] Speed: 52.1[samples/s]
2022-04-16 18:03:03,614 reid_baseline.train INFO: normal accuracy 0.8372733532246959 1.5030012130737305 
2022-04-16 18:03:03,617 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 18:03:03,617 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 150.3%
2022-04-16 18:03:42,345 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.885, Acc: 0.978, Base Lr: 4.51e-04
2022-04-16 18:04:02,781 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-04-16 18:06:01,740 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.479514479637146 
2022-04-16 18:06:01,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 18:06:01,743 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 148.0%
2022-04-16 18:06:34,844 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.910, Acc: 0.970, Base Lr: 3.20e-04
2022-04-16 18:06:55,197 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-16 18:08:41,700 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.4453747272491455 
2022-04-16 18:08:41,702 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 18:08:41,702 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 144.5%
2022-04-16 18:09:15,058 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.888, Acc: 0.979, Base Lr: 2.11e-04
2022-04-16 18:09:29,124 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.312[s] Speed: 51.3[samples/s]
2022-04-16 18:10:58,652 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.4635703563690186 
2022-04-16 18:10:58,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 18:10:58,657 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 146.4%
2022-04-16 18:11:31,688 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.886, Acc: 0.974, Base Lr: 1.26e-04
2022-04-16 18:11:46,856 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-16 18:14:04,001 reid_baseline.train INFO: normal accuracy 0.8370438375028689 1.4409348964691162 
2022-04-16 18:14:04,002 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 18:14:04,002 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 144.1%
2022-04-16 18:14:44,677 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.893, Acc: 0.973, Base Lr: 6.51e-05
2022-04-16 18:15:04,870 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-04-16 18:17:08,164 reid_baseline.train INFO: normal accuracy 0.8370438375028689 1.401940107345581 
2022-04-16 18:17:08,164 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 18:17:08,164 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 140.2%
2022-04-16 18:17:43,425 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.887, Acc: 0.979, Base Lr: 2.83e-05
2022-04-16 18:18:04,192 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.368[s] Speed: 43.4[samples/s]
2022-04-16 18:19:50,948 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.4975024461746216 
2022-04-16 18:19:50,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 18:19:50,949 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 149.8%
2022-04-16 18:20:23,253 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.884, Acc: 0.980, Base Lr: 1.60e-05
2022-04-16 18:20:35,973 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.296[s] Speed: 54.0[samples/s]
2022-04-16 18:22:13,639 reid_baseline.train INFO: normal accuracy 0.8381914161120037 1.4581310749053955 
2022-04-16 18:22:13,642 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 18:22:13,642 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 145.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_4/transformer_best_model.pth
2022-04-16 18:24:24,865 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.392575740814209 
2022-04-16 18:24:24,865 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 18:24:24,865 reid_baseline.train INFO: Accuracy: 83.4%
2022-04-16 18:25:59,094 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.392575740814209 
2022-04-16 18:25:59,094 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 18:25:59,094 reid_baseline.train INFO: Shuffled Accuracy: 83.4%
2022-04-16 18:26:32,436 reid_baseline.train INFO: normal accuracy 0.9892871858261227 0.7176956534385681 
2022-04-16 18:26:32,437 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 18:26:32,438 reid_baseline.train INFO: Source Clean Accuracy: 98.9%
2022-04-16 18:26:40,191 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_6
2022-04-16 18:26:40,191 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-16 18:26:40,191 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 18:26:40,192 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 18:26:40,192 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 18:26:48,688 reid_baseline.train INFO: start training
2022-04-16 18:27:22,141 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.200, Base Lr: 4.76e-04
2022-04-16 18:27:36,129 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.309[s] Speed: 51.7[samples/s]
2022-04-16 18:28:03,508 reid_baseline.train INFO: normal accuracy 0.43681009236314483 4.173015117645264 
2022-04-16 18:28:06,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 18:28:06,528 reid_baseline.train INFO: Accuracy: 43.7% Mean Entropy: 417.3%
2022-04-16 18:28:49,004 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.987, Acc: 0.570, Base Lr: 8.72e-04
2022-04-16 18:29:08,762 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-16 18:29:41,585 reid_baseline.train INFO: normal accuracy 0.5050687091687317 4.169018268585205 
2022-04-16 18:29:45,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 18:29:45,039 reid_baseline.train INFO: Accuracy: 50.5% Mean Entropy: 416.9%
2022-04-16 18:30:19,397 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.701, Acc: 0.598, Base Lr: 1.27e-03
2022-04-16 18:30:34,398 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 18:31:07,090 reid_baseline.train INFO: normal accuracy 0.5192610948411804 4.147423267364502 
2022-04-16 18:31:10,195 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 18:31:10,196 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 414.7%
2022-04-16 18:31:44,936 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.617, Base Lr: 1.66e-03
2022-04-16 18:32:04,825 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.359[s] Speed: 44.5[samples/s]
2022-04-16 18:32:30,805 reid_baseline.train INFO: normal accuracy 0.5246677179544943 4.044989585876465 
2022-04-16 18:32:33,912 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 18:32:33,913 reid_baseline.train INFO: Accuracy: 52.5% Mean Entropy: 404.5%
2022-04-16 18:33:08,636 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.725, Acc: 0.620, Base Lr: 2.06e-03
2022-04-16 18:33:23,832 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.328[s] Speed: 48.7[samples/s]
2022-04-16 18:34:01,851 reid_baseline.train INFO: normal accuracy 0.5647668393782384 3.7541353702545166 
2022-04-16 18:34:05,035 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 18:34:05,036 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 375.4%
2022-04-16 18:34:39,008 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.261, Acc: 0.669, Base Lr: 2.46e-03
2022-04-16 18:34:50,952 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.302[s] Speed: 53.0[samples/s]
2022-04-16 18:35:17,914 reid_baseline.train INFO: normal accuracy 0.602613201171435 3.319157838821411 
2022-04-16 18:35:21,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 18:35:21,046 reid_baseline.train INFO: Accuracy: 60.3% Mean Entropy: 331.9%
2022-04-16 18:36:01,869 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.933, Acc: 0.704, Base Lr: 2.85e-03
2022-04-16 18:36:21,590 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-16 18:36:46,534 reid_baseline.train INFO: normal accuracy 0.6652399189006533 2.971620559692383 
2022-04-16 18:36:49,664 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 18:36:49,665 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 297.2%
2022-04-16 18:37:23,081 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.707, Acc: 0.759, Base Lr: 3.25e-03
2022-04-16 18:37:38,722 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-16 18:38:15,158 reid_baseline.train INFO: normal accuracy 0.7098445595854922 2.6234090328216553 
2022-04-16 18:38:18,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 18:38:18,319 reid_baseline.train INFO: Accuracy: 71.0% Mean Entropy: 262.3%
2022-04-16 18:38:46,478 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.542, Acc: 0.790, Base Lr: 3.64e-03
2022-04-16 18:39:06,209 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.315[s] Speed: 50.8[samples/s]
2022-04-16 18:39:33,103 reid_baseline.train INFO: normal accuracy 0.7382293309303898 2.4061355590820312 
2022-04-16 18:39:36,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 18:39:36,231 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 240.6%
2022-04-16 18:40:17,014 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.416, Acc: 0.831, Base Lr: 4.04e-03
2022-04-16 18:40:31,244 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.362[s] Speed: 44.2[samples/s]
2022-04-16 18:41:11,548 reid_baseline.train INFO: normal accuracy 0.7524217166028385 2.145277976989746 
2022-04-16 18:41:14,736 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 18:41:14,738 reid_baseline.train INFO: Accuracy: 75.2% Mean Entropy: 214.5%
2022-04-16 18:41:48,557 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.360, Acc: 0.830, Base Lr: 4.44e-03
2022-04-16 18:42:04,105 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 18:42:30,767 reid_baseline.train INFO: normal accuracy 0.758954719531426 2.0098843574523926 
2022-04-16 18:42:33,896 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 18:42:33,897 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 201.0%
2022-04-16 18:43:14,413 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.282, Acc: 0.864, Base Lr: 4.83e-03
2022-04-16 18:43:34,075 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-16 18:44:01,516 reid_baseline.train INFO: normal accuracy 0.7636855147555756 1.846171259880066 
2022-04-16 18:44:04,618 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 18:44:04,619 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 184.6%
2022-04-16 18:44:36,986 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.226, Acc: 0.873, Base Lr: 5.23e-03
2022-04-16 18:44:55,411 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-16 18:45:31,326 reid_baseline.train INFO: normal accuracy 0.7679657580536157 1.7725220918655396 
2022-04-16 18:45:34,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 18:45:34,455 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 177.3%
2022-04-16 18:46:03,620 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.171, Acc: 0.882, Base Lr: 5.62e-03
2022-04-16 18:46:22,168 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.314[s] Speed: 51.0[samples/s]
2022-04-16 18:46:48,248 reid_baseline.train INFO: normal accuracy 0.7697679657580536 1.778764009475708 
2022-04-16 18:46:48,252 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 18:46:48,252 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 177.9%
2022-04-16 18:47:28,379 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.117, Acc: 0.907, Base Lr: 6.02e-03
2022-04-16 18:47:48,199 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 18:48:28,318 reid_baseline.train INFO: normal accuracy 0.7722460013516558 1.6968885660171509 
2022-04-16 18:48:31,439 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 18:48:31,440 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 169.7%
2022-04-16 18:49:06,481 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.098, Acc: 0.901, Base Lr: 6.42e-03
2022-04-16 18:49:20,816 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 18:49:52,260 reid_baseline.train INFO: normal accuracy 0.7717954494255463 1.6657936573028564 
2022-04-16 18:49:55,343 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 18:49:55,344 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 166.6%
2022-04-16 18:50:33,353 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.066, Acc: 0.922, Base Lr: 6.81e-03
2022-04-16 18:50:53,355 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.381[s] Speed: 41.9[samples/s]
2022-04-16 18:51:43,858 reid_baseline.train INFO: normal accuracy 0.7735976571299842 1.7052526473999023 
2022-04-16 18:51:43,859 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 18:51:43,859 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 170.5%
2022-04-16 18:52:19,409 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.056, Acc: 0.929, Base Lr: 7.21e-03
2022-04-16 18:52:34,999 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-16 18:53:09,472 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.6717886924743652 
2022-04-16 18:53:09,474 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 18:53:09,475 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 167.2%
2022-04-16 18:53:35,261 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.025, Acc: 0.932, Base Lr: 7.60e-03
2022-04-16 18:53:55,778 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.305[s] Speed: 52.5[samples/s]
2022-04-16 18:54:22,899 reid_baseline.train INFO: normal accuracy 0.7772020725388601 1.6931065320968628 
2022-04-16 18:54:22,902 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 18:54:22,902 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 169.3%
2022-04-16 18:55:03,444 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.976, Acc: 0.949, Base Lr: 4.01e-03
2022-04-16 18:55:19,849 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.375[s] Speed: 42.7[samples/s]
2022-04-16 18:55:57,969 reid_baseline.train INFO: normal accuracy 0.779004280243298 1.6563299894332886 
2022-04-16 18:56:01,075 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 18:56:01,077 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 165.6%
2022-04-16 18:56:35,353 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.960, Acc: 0.951, Base Lr: 3.69e-03
2022-04-16 18:56:50,549 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-16 18:57:19,472 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6233489513397217 
2022-04-16 18:57:22,578 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 18:57:22,579 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 162.3%
2022-04-16 18:58:03,391 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.949, Acc: 0.954, Base Lr: 3.38e-03
2022-04-16 18:58:23,592 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-16 18:58:50,634 reid_baseline.train INFO: normal accuracy 0.7821581437260644 1.6750707626342773 
2022-04-16 18:58:50,637 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 18:58:50,637 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 167.5%
2022-04-16 18:59:21,862 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.938, Acc: 0.959, Base Lr: 3.08e-03
2022-04-16 18:59:36,549 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.302[s] Speed: 53.0[samples/s]
2022-04-16 19:00:12,883 reid_baseline.train INFO: normal accuracy 0.7828339716152286 1.733588695526123 
2022-04-16 19:00:12,883 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 19:00:12,883 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 173.4%
2022-04-16 19:00:43,666 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.946, Acc: 0.962, Base Lr: 2.77e-03
2022-04-16 19:00:54,840 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.276[s] Speed: 58.0[samples/s]
2022-04-16 19:01:21,085 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.718481183052063 
2022-04-16 19:01:21,089 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 19:01:21,089 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 171.8%
2022-04-16 19:02:01,351 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.924, Acc: 0.963, Base Lr: 2.48e-03
2022-04-16 19:02:22,176 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-16 19:02:48,092 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.6726491451263428 
2022-04-16 19:02:48,093 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 19:02:48,093 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 167.3%
2022-04-16 19:03:21,867 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.931, Acc: 0.963, Base Lr: 2.20e-03
2022-04-16 19:03:38,543 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-16 19:04:14,640 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.7219867706298828 
2022-04-16 19:04:14,640 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 19:04:14,640 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 172.2%
2022-04-16 19:04:45,237 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.910, Acc: 0.974, Base Lr: 1.92e-03
2022-04-16 19:05:04,894 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-16 19:05:32,974 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.6970306634902954 
2022-04-16 19:05:32,975 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 19:05:32,975 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 169.7%
2022-04-16 19:06:12,917 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.910, Acc: 0.967, Base Lr: 1.66e-03
2022-04-16 19:06:26,950 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.355[s] Speed: 45.1[samples/s]
2022-04-16 19:07:04,121 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.7556908130645752 
2022-04-16 19:07:04,122 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 19:07:04,122 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 175.6%
2022-04-16 19:07:36,954 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.921, Acc: 0.968, Base Lr: 1.42e-03
2022-04-16 19:07:52,286 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-16 19:08:22,556 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.6924729347229004 
2022-04-16 19:08:22,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 19:08:22,561 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 169.2%
2022-04-16 19:09:03,940 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.895, Acc: 0.977, Base Lr: 1.19e-03
2022-04-16 19:09:24,668 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.409[s] Speed: 39.2[samples/s]
2022-04-16 19:09:54,527 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.68932044506073 
2022-04-16 19:09:54,530 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 19:09:54,530 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 168.9%
2022-04-16 19:10:26,730 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.907, Acc: 0.967, Base Lr: 9.72e-04
2022-04-16 19:10:41,901 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.312[s] Speed: 51.3[samples/s]
2022-04-16 19:11:16,839 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.6657978296279907 
2022-04-16 19:11:16,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 19:11:16,840 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 166.6%
2022-04-16 19:11:46,862 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.911, Acc: 0.961, Base Lr: 7.78e-04
2022-04-16 19:12:03,935 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.310[s] Speed: 51.6[samples/s]
2022-04-16 19:12:30,800 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.6497631072998047 
2022-04-16 19:12:30,804 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 19:12:30,804 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 165.0%
2022-04-16 19:13:10,470 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.895, Acc: 0.974, Base Lr: 6.04e-04
2022-04-16 19:13:30,011 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.390[s] Speed: 41.1[samples/s]
2022-04-16 19:14:02,966 reid_baseline.train INFO: normal accuracy 0.7859878350979951 1.7409642934799194 
2022-04-16 19:14:02,967 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 19:14:02,967 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 174.1%
2022-04-16 19:14:36,199 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.888, Acc: 0.979, Base Lr: 4.51e-04
2022-04-16 19:14:51,152 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-16 19:15:25,166 reid_baseline.train INFO: normal accuracy 0.7848614552827213 1.741034984588623 
2022-04-16 19:15:25,169 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 19:15:25,169 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 174.1%
2022-04-16 19:16:01,436 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.905, Acc: 0.976, Base Lr: 3.20e-04
2022-04-16 19:16:21,404 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.370[s] Speed: 43.3[samples/s]
2022-04-16 19:16:48,097 reid_baseline.train INFO: normal accuracy 0.7866636629871593 1.7051092386245728 
2022-04-16 19:16:48,102 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 19:16:48,102 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 170.5%
2022-04-16 19:17:24,176 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.889, Acc: 0.977, Base Lr: 2.11e-04
2022-04-16 19:17:39,755 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 19:18:15,938 reid_baseline.train INFO: normal accuracy 0.7862131110610497 1.701277494430542 
2022-04-16 19:18:15,939 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 19:18:15,939 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 170.1%
2022-04-16 19:18:48,558 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.883, Acc: 0.977, Base Lr: 1.26e-04
2022-04-16 19:19:01,894 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.302[s] Speed: 52.9[samples/s]
2022-04-16 19:19:28,267 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.7243390083312988 
2022-04-16 19:19:28,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 19:19:28,272 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 172.4%
2022-04-16 19:20:09,743 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.892, Acc: 0.974, Base Lr: 6.51e-05
2022-04-16 19:20:30,513 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-16 19:20:57,230 reid_baseline.train INFO: normal accuracy 0.7868889389502141 1.6376303434371948 
2022-04-16 19:20:57,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 19:20:57,232 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 163.8%
2022-04-16 19:21:28,632 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.888, Acc: 0.977, Base Lr: 2.83e-05
2022-04-16 19:21:43,808 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.306[s] Speed: 52.2[samples/s]
2022-04-16 19:22:21,452 reid_baseline.train INFO: normal accuracy 0.7857625591349403 1.7402479648590088 
2022-04-16 19:22:21,454 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 19:22:21,454 reid_baseline.train INFO: Accuracy: 78.6% Mean Entropy: 174.0%
2022-04-16 19:22:49,822 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.888, Acc: 0.979, Base Lr: 1.60e-05
2022-04-16 19:23:00,449 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.256[s] Speed: 62.4[samples/s]
2022-04-16 19:23:30,738 reid_baseline.train INFO: normal accuracy 0.7873394908763235 1.708112359046936 
2022-04-16 19:23:30,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 19:23:30,743 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 170.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_6/transformer_best_model.pth
2022-04-16 19:24:02,045 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6233489513397217 
2022-04-16 19:24:02,045 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:24:02,045 reid_baseline.train INFO: Accuracy: 78.1%
2022-04-16 19:24:29,000 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6233489513397217 
2022-04-16 19:24:29,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:24:29,000 reid_baseline.train INFO: Shuffled Accuracy: 78.1%
2022-04-16 19:25:00,184 reid_baseline.train INFO: normal accuracy 0.9905232797692625 0.697310209274292 
2022-04-16 19:25:00,184 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 19:25:00,184 reid_baseline.train INFO: Source Clean Accuracy: 99.1%
2022-04-16 19:25:07,716 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_6
2022-04-16 19:25:07,717 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_6', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=6, dom_cls=False)
2022-04-16 19:25:07,717 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 19:25:07,717 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 19:25:07,718 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_6
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 19:25:16,259 reid_baseline.train INFO: start training
2022-04-16 19:25:53,375 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.201, Base Lr: 4.76e-04
2022-04-16 19:26:10,040 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 19:28:21,996 reid_baseline.train INFO: normal accuracy 0.5051641037411063 4.17294979095459 
2022-04-16 19:28:25,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 19:28:25,021 reid_baseline.train INFO: Accuracy: 50.5% Mean Entropy: 417.3%
2022-04-16 19:28:54,850 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.987, Acc: 0.570, Base Lr: 8.72e-04
2022-04-16 19:29:07,491 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.279[s] Speed: 57.3[samples/s]
2022-04-16 19:31:10,069 reid_baseline.train INFO: normal accuracy 0.5992655496901538 4.1680073738098145 
2022-04-16 19:31:13,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 19:31:13,193 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 416.8%
2022-04-16 19:31:44,463 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.701, Acc: 0.597, Base Lr: 1.27e-03
2022-04-16 19:31:58,371 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.297[s] Speed: 53.8[samples/s]
2022-04-16 19:33:25,544 reid_baseline.train INFO: normal accuracy 0.6125774615561166 4.136801242828369 
2022-04-16 19:33:28,689 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 19:33:28,690 reid_baseline.train INFO: Accuracy: 61.3% Mean Entropy: 413.7%
2022-04-16 19:34:03,591 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.617, Base Lr: 1.66e-03
2022-04-16 19:34:21,416 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-16 19:35:48,101 reid_baseline.train INFO: normal accuracy 0.6238237319256369 3.980931282043457 
2022-04-16 19:35:51,228 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 19:35:51,229 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 398.1%
2022-04-16 19:36:24,773 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.725, Acc: 0.620, Base Lr: 2.06e-03
2022-04-16 19:36:44,567 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-16 19:38:20,536 reid_baseline.train INFO: normal accuracy 0.6536607757631397 3.5602803230285645 
2022-04-16 19:38:30,615 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 19:38:30,615 reid_baseline.train INFO: Accuracy: 65.4% Mean Entropy: 356.0%
2022-04-16 19:39:11,265 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.261, Acc: 0.669, Base Lr: 2.46e-03
2022-04-16 19:39:30,874 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-04-16 19:41:15,905 reid_baseline.train INFO: normal accuracy 0.6844158824879504 3.0508713722229004 
2022-04-16 19:41:19,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 19:41:19,013 reid_baseline.train INFO: Accuracy: 68.4% Mean Entropy: 305.1%
2022-04-16 19:42:00,441 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.933, Acc: 0.704, Base Lr: 2.85e-03
2022-04-16 19:42:18,640 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 19:44:05,388 reid_baseline.train INFO: normal accuracy 0.7330732155152628 2.6763689517974854 
2022-04-16 19:44:08,488 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 19:44:08,489 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 267.6%
2022-04-16 19:44:43,463 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.706, Acc: 0.758, Base Lr: 3.25e-03
2022-04-16 19:44:59,516 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-16 19:46:27,397 reid_baseline.train INFO: normal accuracy 0.7695662152857471 2.336505889892578 
2022-04-16 19:46:30,511 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 19:46:30,511 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 233.7%
2022-04-16 19:47:00,623 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.543, Acc: 0.790, Base Lr: 3.64e-03
2022-04-16 19:47:20,073 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-16 19:48:57,344 reid_baseline.train INFO: normal accuracy 0.7968785861831535 2.1196842193603516 
2022-04-16 19:49:01,327 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 19:49:01,328 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 212.0%
2022-04-16 19:49:44,421 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.416, Acc: 0.831, Base Lr: 4.04e-03
2022-04-16 19:50:04,443 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.415[s] Speed: 38.5[samples/s]
2022-04-16 19:51:53,791 reid_baseline.train INFO: normal accuracy 0.8090429194399816 1.8827954530715942 
2022-04-16 19:51:56,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 19:51:56,885 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 188.3%
2022-04-16 19:52:38,887 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.360, Acc: 0.831, Base Lr: 4.44e-03
2022-04-16 19:52:57,937 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-16 19:54:36,196 reid_baseline.train INFO: normal accuracy 0.8193711269221942 1.7433894872665405 
2022-04-16 19:54:39,314 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 19:54:39,314 reid_baseline.train INFO: Accuracy: 81.9% Mean Entropy: 174.3%
2022-04-16 19:55:16,055 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.282, Acc: 0.864, Base Lr: 4.83e-03
2022-04-16 19:55:33,431 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.356[s] Speed: 45.0[samples/s]
2022-04-16 19:57:02,256 reid_baseline.train INFO: normal accuracy 0.8228138627495983 1.606931209564209 
2022-04-16 19:57:05,369 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 19:57:05,369 reid_baseline.train INFO: Accuracy: 82.3% Mean Entropy: 160.7%
2022-04-16 19:57:37,892 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.226, Acc: 0.872, Base Lr: 5.23e-03
2022-04-16 19:57:54,722 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.325[s] Speed: 49.3[samples/s]
2022-04-16 19:59:26,933 reid_baseline.train INFO: normal accuracy 0.8267156300206564 1.5241049528121948 
2022-04-16 19:59:30,072 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 19:59:30,073 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 152.4%
2022-04-16 20:00:04,779 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.171, Acc: 0.884, Base Lr: 5.62e-03
2022-04-16 20:00:24,585 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.358[s] Speed: 44.6[samples/s]
2022-04-16 20:02:03,418 reid_baseline.train INFO: normal accuracy 0.8280927243516181 1.5356637239456177 
2022-04-16 20:02:03,422 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 20:02:03,422 reid_baseline.train INFO: Accuracy: 82.8% Mean Entropy: 153.6%
2022-04-16 20:02:42,793 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.117, Acc: 0.906, Base Lr: 6.02e-03
2022-04-16 20:03:02,968 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-04-16 20:05:15,032 reid_baseline.train INFO: normal accuracy 0.8290107872389259 1.468756914138794 
2022-04-16 20:05:18,453 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 20:05:18,454 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 146.9%
2022-04-16 20:05:58,196 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.097, Acc: 0.902, Base Lr: 6.42e-03
2022-04-16 20:06:17,677 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-04-16 20:08:00,629 reid_baseline.train INFO: normal accuracy 0.8333715859536378 1.4195033311843872 
2022-04-16 20:08:03,762 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 20:08:03,763 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 142.0%
2022-04-16 20:08:44,592 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.066, Acc: 0.924, Base Lr: 6.81e-03
2022-04-16 20:08:59,796 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.368[s] Speed: 43.4[samples/s]
2022-04-16 20:10:36,350 reid_baseline.train INFO: normal accuracy 0.8317649759008492 1.4734238386154175 
2022-04-16 20:10:36,352 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 20:10:36,352 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 147.3%
2022-04-16 20:11:11,229 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.057, Acc: 0.929, Base Lr: 7.21e-03
2022-04-16 20:11:28,561 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-16 20:12:55,629 reid_baseline.train INFO: normal accuracy 0.8370438375028689 1.4360793828964233 
2022-04-16 20:12:55,634 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 20:12:55,634 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 143.6%
2022-04-16 20:13:31,650 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.024, Acc: 0.937, Base Lr: 7.60e-03
2022-04-16 20:13:51,114 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.365[s] Speed: 43.9[samples/s]
2022-04-16 20:15:30,403 reid_baseline.train INFO: normal accuracy 0.828322240073445 1.4314467906951904 
2022-04-16 20:15:30,407 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 20:15:30,407 reid_baseline.train INFO: Accuracy: 82.8% Mean Entropy: 143.1%
2022-04-16 20:16:12,418 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.975, Acc: 0.952, Base Lr: 4.01e-03
2022-04-16 20:16:31,712 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-16 20:18:14,823 reid_baseline.train INFO: normal accuracy 0.8331420702318109 1.4035758972167969 
2022-04-16 20:18:17,928 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 20:18:17,929 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 140.4%
2022-04-16 20:18:59,446 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.960, Acc: 0.951, Base Lr: 3.69e-03
2022-04-16 20:19:17,866 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 20:20:55,857 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.3750030994415283 
2022-04-16 20:20:58,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 20:20:58,974 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 137.5%
2022-04-16 20:21:31,686 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.949, Acc: 0.955, Base Lr: 3.38e-03
2022-04-16 20:21:50,496 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-16 20:23:25,197 reid_baseline.train INFO: normal accuracy 0.8349781960064264 1.4398677349090576 
2022-04-16 20:23:25,199 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 20:23:25,199 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 144.0%
2022-04-16 20:24:06,694 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.938, Acc: 0.960, Base Lr: 3.08e-03
2022-04-16 20:24:26,100 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.401[s] Speed: 39.9[samples/s]
2022-04-16 20:26:09,051 reid_baseline.train INFO: normal accuracy 0.832683038788157 1.4786427021026611 
2022-04-16 20:26:09,056 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 20:26:09,056 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 147.9%
2022-04-16 20:26:50,214 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.946, Acc: 0.964, Base Lr: 2.77e-03
2022-04-16 20:27:08,281 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.390[s] Speed: 41.1[samples/s]
2022-04-16 20:28:44,430 reid_baseline.train INFO: normal accuracy 0.8345191645627725 1.4646087884902954 
2022-04-16 20:28:44,435 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 20:28:44,435 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 146.5%
2022-04-16 20:29:22,933 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.924, Acc: 0.964, Base Lr: 2.48e-03
2022-04-16 20:29:40,698 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.370[s] Speed: 43.2[samples/s]
2022-04-16 20:31:19,134 reid_baseline.train INFO: normal accuracy 0.8345191645627725 1.4180501699447632 
2022-04-16 20:31:19,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 20:31:19,134 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 141.8%
2022-04-16 20:31:59,109 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.932, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 20:32:20,836 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.406[s] Speed: 39.4[samples/s]
2022-04-16 20:34:01,847 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4748117923736572 
2022-04-16 20:34:01,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 20:34:01,851 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 147.5%
2022-04-16 20:34:44,889 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.909, Acc: 0.974, Base Lr: 1.92e-03
2022-04-16 20:35:03,436 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-16 20:36:41,846 reid_baseline.train INFO: normal accuracy 0.8363552903373881 1.438409447669983 
2022-04-16 20:36:41,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 20:36:41,848 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 143.8%
2022-04-16 20:37:20,298 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.910, Acc: 0.967, Base Lr: 1.66e-03
2022-04-16 20:37:36,139 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.357[s] Speed: 44.8[samples/s]
2022-04-16 20:39:10,450 reid_baseline.train INFO: normal accuracy 0.8338306173972917 1.5134819746017456 
2022-04-16 20:39:10,451 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 20:39:10,451 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 151.3%
2022-04-16 20:39:45,444 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.921, Acc: 0.968, Base Lr: 1.42e-03
2022-04-16 20:40:05,784 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.364[s] Speed: 44.0[samples/s]
2022-04-16 20:42:10,679 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.4402087926864624 
2022-04-16 20:42:10,682 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 20:42:10,682 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 144.0%
2022-04-16 20:42:51,471 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.894, Acc: 0.977, Base Lr: 1.19e-03
2022-04-16 20:43:11,902 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.403[s] Speed: 39.7[samples/s]
2022-04-16 20:44:54,652 reid_baseline.train INFO: normal accuracy 0.8354372274500803 1.4402613639831543 
2022-04-16 20:44:54,654 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 20:44:54,654 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 144.0%
2022-04-16 20:45:29,682 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.906, Acc: 0.966, Base Lr: 9.72e-04
2022-04-16 20:45:46,504 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-16 20:47:14,036 reid_baseline.train INFO: normal accuracy 0.8381914161120037 1.4185460805892944 
2022-04-16 20:47:14,038 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 20:47:14,038 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 141.9%
2022-04-16 20:47:47,672 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.910, Acc: 0.962, Base Lr: 7.78e-04
2022-04-16 20:48:08,213 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.356[s] Speed: 44.9[samples/s]
2022-04-16 20:49:39,959 reid_baseline.train INFO: normal accuracy 0.8354372274500803 1.403528094291687 
2022-04-16 20:49:39,961 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 20:49:39,962 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 140.4%
2022-04-16 20:50:19,045 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.895, Acc: 0.974, Base Lr: 6.04e-04
2022-04-16 20:50:38,696 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.386[s] Speed: 41.4[samples/s]
2022-04-16 20:52:15,370 reid_baseline.train INFO: normal accuracy 0.8384209318338306 1.4981610774993896 
2022-04-16 20:52:15,374 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 20:52:15,375 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 149.8%
2022-04-16 20:52:54,578 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.889, Acc: 0.978, Base Lr: 4.51e-04
2022-04-16 20:53:14,719 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-04-16 20:54:53,690 reid_baseline.train INFO: normal accuracy 0.8363552903373881 1.4875684976577759 
2022-04-16 20:54:53,694 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 20:54:53,694 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 148.8%
2022-04-16 20:55:31,990 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.905, Acc: 0.976, Base Lr: 3.20e-04
2022-04-16 20:55:49,473 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.367[s] Speed: 43.6[samples/s]
2022-04-16 20:57:47,249 reid_baseline.train INFO: normal accuracy 0.836814321781042 1.457994818687439 
2022-04-16 20:57:47,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 20:57:47,250 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 145.8%
2022-04-16 20:58:12,789 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.889, Acc: 0.977, Base Lr: 2.11e-04
2022-04-16 20:58:30,732 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.286[s] Speed: 56.0[samples/s]
2022-04-16 21:00:02,256 reid_baseline.train INFO: normal accuracy 0.8356667431719073 1.4515137672424316 
2022-04-16 21:00:02,256 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 21:00:02,256 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 145.2%
2022-04-16 21:00:36,578 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.884, Acc: 0.977, Base Lr: 1.26e-04
2022-04-16 21:00:51,766 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-16 21:02:29,882 reid_baseline.train INFO: normal accuracy 0.8377323846683498 1.4693187475204468 
2022-04-16 21:02:29,887 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 21:02:29,887 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 146.9%
2022-04-16 21:03:08,215 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.892, Acc: 0.973, Base Lr: 6.51e-05
2022-04-16 21:03:27,958 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.382[s] Speed: 41.9[samples/s]
2022-04-16 21:05:36,238 reid_baseline.train INFO: normal accuracy 0.8375028689465228 1.3898791074752808 
2022-04-16 21:05:36,239 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 21:05:36,239 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 139.0%
2022-04-16 21:06:16,559 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.888, Acc: 0.979, Base Lr: 2.83e-05
2022-04-16 21:06:36,783 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-04-16 21:08:26,392 reid_baseline.train INFO: normal accuracy 0.8379619003901767 1.4914946556091309 
2022-04-16 21:08:26,392 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 21:08:26,392 reid_baseline.train INFO: Accuracy: 83.8% Mean Entropy: 149.1%
2022-04-16 21:08:58,442 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.888, Acc: 0.979, Base Lr: 1.60e-05
2022-04-16 21:09:09,309 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.282[s] Speed: 56.7[samples/s]
2022-04-16 21:10:53,577 reid_baseline.train INFO: normal accuracy 0.8356667431719073 1.455550193786621 
2022-04-16 21:10:53,577 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 21:10:53,577 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 145.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_6/transformer_best_model.pth
2022-04-16 21:13:04,220 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.3750030994415283 
2022-04-16 21:13:04,220 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:13:04,220 reid_baseline.train INFO: Accuracy: 83.7%
2022-04-16 21:14:40,492 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.3750030994415283 
2022-04-16 21:14:40,492 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:14:40,493 reid_baseline.train INFO: Shuffled Accuracy: 83.7%
2022-04-16 21:15:13,320 reid_baseline.train INFO: normal accuracy 0.9913473423980222 0.6938410997390747 
2022-04-16 21:15:13,320 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 21:15:13,320 reid_baseline.train INFO: Source Clean Accuracy: 99.1%
2022-04-16 21:15:21,039 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_8
2022-04-16 21:15:21,039 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-16 21:15:21,039 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 21:15:21,040 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 21:15:21,040 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 21:15:29,332 reid_baseline.train INFO: start training
2022-04-16 21:16:01,483 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.201, Base Lr: 4.76e-04
2022-04-16 21:16:17,115 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.309[s] Speed: 51.8[samples/s]
2022-04-16 21:16:43,475 reid_baseline.train INFO: normal accuracy 0.4284748817301194 4.173006057739258 
2022-04-16 21:16:46,487 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 21:16:46,489 reid_baseline.train INFO: Accuracy: 42.8% Mean Entropy: 417.3%
2022-04-16 21:17:30,048 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.987, Acc: 0.573, Base Lr: 8.72e-04
2022-04-16 21:17:49,860 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.417[s] Speed: 38.4[samples/s]
2022-04-16 21:18:38,540 reid_baseline.train INFO: normal accuracy 0.5003379139445822 4.1689839363098145 
2022-04-16 21:18:41,717 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 21:18:41,718 reid_baseline.train INFO: Accuracy: 50.0% Mean Entropy: 416.9%
2022-04-16 21:19:13,940 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.701, Acc: 0.604, Base Lr: 1.27e-03
2022-04-16 21:19:28,691 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.309[s] Speed: 51.8[samples/s]
2022-04-16 21:20:05,336 reid_baseline.train INFO: normal accuracy 0.518810542915071 4.147496700286865 
2022-04-16 21:20:11,221 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 21:20:11,221 reid_baseline.train INFO: Accuracy: 51.9% Mean Entropy: 414.7%
2022-04-16 21:20:51,394 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.606, Base Lr: 1.66e-03
2022-04-16 21:21:11,145 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.394[s] Speed: 40.6[samples/s]
2022-04-16 21:21:37,980 reid_baseline.train INFO: normal accuracy 0.5275963054742059 4.042294502258301 
2022-04-16 21:21:41,142 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 21:21:41,143 reid_baseline.train INFO: Accuracy: 52.8% Mean Entropy: 404.2%
2022-04-16 21:22:13,171 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.726, Acc: 0.632, Base Lr: 2.06e-03
2022-04-16 21:22:27,894 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.308[s] Speed: 52.0[samples/s]
2022-04-16 21:23:05,224 reid_baseline.train INFO: normal accuracy 0.5645415634151836 3.7613472938537598 
2022-04-16 21:23:08,414 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 21:23:08,416 reid_baseline.train INFO: Accuracy: 56.5% Mean Entropy: 376.1%
2022-04-16 21:23:39,067 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.261, Acc: 0.666, Base Lr: 2.46e-03
2022-04-16 21:23:52,669 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.291[s] Speed: 55.0[samples/s]
2022-04-16 21:24:20,613 reid_baseline.train INFO: normal accuracy 0.5987835097995043 3.3173837661743164 
2022-04-16 21:24:23,725 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 21:24:23,726 reid_baseline.train INFO: Accuracy: 59.9% Mean Entropy: 331.7%
2022-04-16 21:25:03,662 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.924, Acc: 0.712, Base Lr: 2.85e-03
2022-04-16 21:25:23,411 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-16 21:25:51,208 reid_baseline.train INFO: normal accuracy 0.6620860554178869 2.957066059112549 
2022-04-16 21:25:54,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 21:25:54,410 reid_baseline.train INFO: Accuracy: 66.2% Mean Entropy: 295.7%
2022-04-16 21:26:28,759 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.710, Acc: 0.754, Base Lr: 3.25e-03
2022-04-16 21:26:43,156 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.321[s] Speed: 49.9[samples/s]
2022-04-16 21:27:19,350 reid_baseline.train INFO: normal accuracy 0.7051137643613427 2.6211421489715576 
2022-04-16 21:27:22,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 21:27:22,477 reid_baseline.train INFO: Accuracy: 70.5% Mean Entropy: 262.1%
2022-04-16 21:27:49,257 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.549, Acc: 0.789, Base Lr: 3.64e-03
2022-04-16 21:28:08,019 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.300[s] Speed: 53.4[samples/s]
2022-04-16 21:28:34,335 reid_baseline.train INFO: normal accuracy 0.7294435683712548 2.4190330505371094 
2022-04-16 21:28:37,494 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 21:28:37,494 reid_baseline.train INFO: Accuracy: 72.9% Mean Entropy: 241.9%
2022-04-16 21:29:15,255 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.414, Acc: 0.834, Base Lr: 4.04e-03
2022-04-16 21:29:34,715 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.376[s] Speed: 42.5[samples/s]
2022-04-16 21:30:14,903 reid_baseline.train INFO: normal accuracy 0.7533228204550575 2.1629016399383545 
2022-04-16 21:30:18,052 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 21:30:18,053 reid_baseline.train INFO: Accuracy: 75.3% Mean Entropy: 216.3%
2022-04-16 21:30:51,916 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.361, Acc: 0.832, Base Lr: 4.44e-03
2022-04-16 21:31:08,489 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-16 21:31:43,922 reid_baseline.train INFO: normal accuracy 0.7618833070511376 2.008593797683716 
2022-04-16 21:31:48,973 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 21:31:48,975 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 200.9%
2022-04-16 21:32:30,126 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.274, Acc: 0.862, Base Lr: 4.83e-03
2022-04-16 21:32:50,520 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-16 21:33:18,485 reid_baseline.train INFO: normal accuracy 0.7623338589772471 1.8432705402374268 
2022-04-16 21:33:21,574 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 21:33:21,574 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 184.3%
2022-04-16 21:33:58,407 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.226, Acc: 0.878, Base Lr: 5.23e-03
2022-04-16 21:34:14,825 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.350[s] Speed: 45.7[samples/s]
2022-04-16 21:34:50,853 reid_baseline.train INFO: normal accuracy 0.7681910340166704 1.7742785215377808 
2022-04-16 21:34:54,086 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 21:34:54,087 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 177.4%
2022-04-16 21:35:24,528 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.164, Acc: 0.887, Base Lr: 5.62e-03
2022-04-16 21:35:36,480 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.279[s] Speed: 57.4[samples/s]
2022-04-16 21:36:04,648 reid_baseline.train INFO: normal accuracy 0.773822933093039 1.7756561040878296 
2022-04-16 21:36:04,650 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 21:36:04,651 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 177.6%
2022-04-16 21:36:44,780 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.120, Acc: 0.902, Base Lr: 6.02e-03
2022-04-16 21:37:04,458 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-16 21:37:30,087 reid_baseline.train INFO: normal accuracy 0.772020725388601 1.6966603994369507 
2022-04-16 21:37:33,231 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 21:37:33,232 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 169.7%
2022-04-16 21:38:07,326 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.086, Acc: 0.909, Base Lr: 6.42e-03
2022-04-16 21:38:23,123 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-16 21:38:59,413 reid_baseline.train INFO: normal accuracy 0.7749493129083127 1.667550802230835 
2022-04-16 21:39:02,543 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 21:39:02,544 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 166.8%
2022-04-16 21:39:26,807 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.070, Acc: 0.926, Base Lr: 6.81e-03
2022-04-16 21:39:47,335 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.294[s] Speed: 54.3[samples/s]
2022-04-16 21:40:15,004 reid_baseline.train INFO: normal accuracy 0.7747240369452579 1.717454433441162 
2022-04-16 21:40:15,007 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 21:40:15,007 reid_baseline.train INFO: Accuracy: 77.5% Mean Entropy: 171.7%
2022-04-16 21:40:54,482 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.060, Acc: 0.928, Base Lr: 7.21e-03
2022-04-16 21:41:14,013 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.388[s] Speed: 41.2[samples/s]
2022-04-16 21:41:48,843 reid_baseline.train INFO: normal accuracy 0.7731471052038748 1.645903468132019 
2022-04-16 21:41:52,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 21:41:52,049 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 164.6%
2022-04-16 21:42:25,871 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.029, Acc: 0.931, Base Lr: 7.60e-03
2022-04-16 21:42:40,892 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-16 21:43:10,956 reid_baseline.train INFO: normal accuracy 0.7769767965758053 1.6899006366729736 
2022-04-16 21:43:10,957 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 21:43:10,957 reid_baseline.train INFO: Accuracy: 77.7% Mean Entropy: 169.0%
2022-04-16 21:43:48,383 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.970, Acc: 0.948, Base Lr: 4.01e-03
2022-04-16 21:44:08,269 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.377[s] Speed: 42.4[samples/s]
2022-04-16 21:44:37,357 reid_baseline.train INFO: normal accuracy 0.7792295562063528 1.6644737720489502 
2022-04-16 21:44:37,361 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 21:44:37,362 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 166.4%
2022-04-16 21:45:15,656 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.962, Acc: 0.951, Base Lr: 3.69e-03
2022-04-16 21:45:30,378 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-16 21:46:08,026 reid_baseline.train INFO: normal accuracy 0.7819328677630096 1.6400147676467896 
2022-04-16 21:46:11,223 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 21:46:11,224 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 164.0%
2022-04-16 21:46:44,701 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.946, Acc: 0.959, Base Lr: 3.38e-03
2022-04-16 21:46:59,382 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.317[s] Speed: 50.5[samples/s]
2022-04-16 21:47:30,281 reid_baseline.train INFO: normal accuracy 0.7776526244649696 1.661242961883545 
2022-04-16 21:47:30,285 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 21:47:30,285 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 166.1%
2022-04-16 21:48:11,757 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.943, Acc: 0.959, Base Lr: 3.08e-03
2022-04-16 21:48:31,846 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.405[s] Speed: 39.5[samples/s]
2022-04-16 21:48:58,299 reid_baseline.train INFO: normal accuracy 0.7796801081324622 1.7195144891738892 
2022-04-16 21:48:58,302 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 21:48:58,302 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 172.0%
2022-04-16 21:49:30,262 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.942, Acc: 0.963, Base Lr: 2.77e-03
2022-04-16 21:49:45,351 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.309[s] Speed: 51.7[samples/s]
2022-04-16 21:50:21,128 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.7167352437973022 
2022-04-16 21:50:21,128 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 21:50:21,129 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 171.7%
2022-04-16 21:50:49,402 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.922, Acc: 0.965, Base Lr: 2.48e-03
2022-04-16 21:51:03,764 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.280[s] Speed: 57.1[samples/s]
2022-04-16 21:51:29,784 reid_baseline.train INFO: normal accuracy 0.7810317639107908 1.6468900442123413 
2022-04-16 21:51:29,788 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 21:51:29,788 reid_baseline.train INFO: Accuracy: 78.1% Mean Entropy: 164.7%
2022-04-16 21:52:09,538 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.927, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 21:52:28,974 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-04-16 21:52:56,261 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.718916416168213 
2022-04-16 21:52:56,262 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 21:52:56,262 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 171.9%
2022-04-16 21:53:30,600 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.905, Acc: 0.967, Base Lr: 1.92e-03
2022-04-16 21:53:44,927 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 21:54:22,145 reid_baseline.train INFO: normal accuracy 0.7844109033566119 1.673191785812378 
2022-04-16 21:54:22,145 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 21:54:22,145 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 167.3%
2022-04-16 21:54:47,718 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.915, Acc: 0.972, Base Lr: 1.66e-03
2022-04-16 21:55:06,886 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.294[s] Speed: 54.4[samples/s]
2022-04-16 21:56:06,260 reid_baseline.train INFO: normal accuracy 0.7846361793196666 1.7488672733306885 
2022-04-16 21:56:06,262 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 21:56:06,262 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 174.9%
2022-04-16 21:56:44,847 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.916, Acc: 0.968, Base Lr: 1.42e-03
2022-04-16 21:57:00,682 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.358[s] Speed: 44.7[samples/s]
2022-04-16 21:57:38,157 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.682674527168274 
2022-04-16 21:57:38,157 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 21:57:38,157 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 168.3%
2022-04-16 21:58:08,339 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.894, Acc: 0.973, Base Lr: 1.19e-03
2022-04-16 21:58:18,887 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.268[s] Speed: 59.7[samples/s]
2022-04-16 21:58:56,437 reid_baseline.train INFO: normal accuracy 0.782608695652174 1.6714040040969849 
2022-04-16 21:58:56,441 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-16 21:58:56,441 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 167.1%
2022-04-16 21:59:38,824 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.903, Acc: 0.970, Base Lr: 9.72e-04
2022-04-16 21:59:58,659 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.409[s] Speed: 39.1[samples/s]
2022-04-16 22:00:23,515 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.630047082901001 
2022-04-16 22:00:26,710 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-16 22:00:26,711 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 163.0%
2022-04-16 22:01:02,056 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.909, Acc: 0.967, Base Lr: 7.78e-04
2022-04-16 22:01:17,249 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-16 22:01:52,837 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.6510679721832275 
2022-04-16 22:01:52,837 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-16 22:01:52,837 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 165.1%
2022-04-16 22:02:17,168 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.893, Acc: 0.972, Base Lr: 6.04e-04
2022-04-16 22:02:34,356 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.273[s] Speed: 58.6[samples/s]
2022-04-16 22:03:01,729 reid_baseline.train INFO: normal accuracy 0.7866636629871593 1.736892580986023 
2022-04-16 22:03:01,732 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-16 22:03:01,732 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 173.7%
2022-04-16 22:03:41,204 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.886, Acc: 0.976, Base Lr: 4.51e-04
2022-04-16 22:04:00,842 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-04-16 22:04:34,975 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.697961449623108 
2022-04-16 22:04:34,976 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-16 22:04:34,976 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 169.8%
2022-04-16 22:05:08,951 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.910, Acc: 0.970, Base Lr: 3.20e-04
2022-04-16 22:05:24,061 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.323[s] Speed: 49.6[samples/s]
2022-04-16 22:05:57,067 reid_baseline.train INFO: normal accuracy 0.7837350754674476 1.6826273202896118 
2022-04-16 22:05:57,069 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-16 22:05:57,069 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 168.3%
2022-04-16 22:06:33,826 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.886, Acc: 0.978, Base Lr: 2.11e-04
2022-04-16 22:06:54,358 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.377[s] Speed: 42.5[samples/s]
2022-04-16 22:07:21,665 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.6736704111099243 
2022-04-16 22:07:21,665 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-16 22:07:21,665 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 167.4%
2022-04-16 22:07:55,891 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.890, Acc: 0.973, Base Lr: 1.26e-04
2022-04-16 22:08:10,609 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.322[s] Speed: 49.7[samples/s]
2022-04-16 22:08:46,242 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.7060953378677368 
2022-04-16 22:08:46,242 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-16 22:08:46,243 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 170.6%
2022-04-16 22:09:16,669 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.892, Acc: 0.974, Base Lr: 6.51e-05
2022-04-16 22:09:32,739 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.306[s] Speed: 52.3[samples/s]
2022-04-16 22:10:04,169 reid_baseline.train INFO: normal accuracy 0.7835097995043929 1.6399519443511963 
2022-04-16 22:10:04,171 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-16 22:10:04,172 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 164.0%
2022-04-16 22:10:43,506 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.889, Acc: 0.978, Base Lr: 2.83e-05
2022-04-16 22:11:03,610 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.391[s] Speed: 40.9[samples/s]
2022-04-16 22:11:30,885 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.725614070892334 
2022-04-16 22:11:30,887 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-16 22:11:30,887 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 172.6%
2022-04-16 22:12:03,001 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.881, Acc: 0.982, Base Lr: 1.60e-05
2022-04-16 22:12:17,605 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.307[s] Speed: 52.1[samples/s]
2022-04-16 22:12:56,727 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.6927449703216553 
2022-04-16 22:12:56,727 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-16 22:12:56,727 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 169.3%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_aug_key_8/transformer_best_model.pth
2022-04-16 22:13:33,456 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.630047082901001 
2022-04-16 22:13:33,456 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 22:13:33,456 reid_baseline.train INFO: Accuracy: 78.4%
2022-04-16 22:14:02,304 reid_baseline.train INFO: normal accuracy 0.7841856273935571 1.630047082901001 
2022-04-16 22:14:02,309 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 22:14:02,310 reid_baseline.train INFO: Shuffled Accuracy: 78.4%
2022-04-16 22:14:25,433 reid_baseline.train INFO: normal accuracy 0.9929954676555418 0.6487375497817993 
2022-04-16 22:14:25,434 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-16 22:14:25,434 reid_baseline.train INFO: Source Clean Accuracy: 99.3%
2022-04-16 22:14:29,322 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_8
2022-04-16 22:14:29,322 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_8', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False)
2022-04-16 22:14:29,322 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-16 22:14:29,322 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-16 22:14:29,323 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_aug_key_8
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-16 22:14:38,331 reid_baseline.train INFO: start training
2022-04-16 22:15:23,812 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.144, Acc: 0.201, Base Lr: 4.76e-04
2022-04-16 22:15:40,310 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-16 22:17:37,963 reid_baseline.train INFO: normal accuracy 0.5037870094101446 4.172942638397217 
2022-04-16 22:17:41,001 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-16 22:17:41,002 reid_baseline.train INFO: Accuracy: 50.4% Mean Entropy: 417.3%
2022-04-16 22:18:22,656 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.987, Acc: 0.574, Base Lr: 8.72e-04
2022-04-16 22:18:41,309 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-16 22:20:42,938 reid_baseline.train INFO: normal accuracy 0.593986688088134 4.167958736419678 
2022-04-16 22:20:46,142 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-16 22:20:46,143 reid_baseline.train INFO: Accuracy: 59.4% Mean Entropy: 416.8%
2022-04-16 22:21:18,886 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.701, Acc: 0.604, Base Lr: 1.27e-03
2022-04-16 22:21:37,823 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.340[s] Speed: 47.1[samples/s]
2022-04-16 22:23:19,112 reid_baseline.train INFO: normal accuracy 0.6089052100068855 4.136926651000977 
2022-04-16 22:23:22,250 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-16 22:23:22,251 reid_baseline.train INFO: Accuracy: 60.9% Mean Entropy: 413.7%
2022-04-16 22:23:56,610 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 3.259, Acc: 0.606, Base Lr: 1.66e-03
2022-04-16 22:24:11,064 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-16 22:25:46,486 reid_baseline.train INFO: normal accuracy 0.6215285747073674 3.9776625633239746 
2022-04-16 22:25:49,606 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-16 22:25:49,609 reid_baseline.train INFO: Accuracy: 62.2% Mean Entropy: 397.8%
2022-04-16 22:26:23,275 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.726, Acc: 0.632, Base Lr: 2.06e-03
2022-04-16 22:26:37,982 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-16 22:28:31,799 reid_baseline.train INFO: normal accuracy 0.652742712875832 3.5661914348602295 
2022-04-16 22:28:34,912 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-16 22:28:34,913 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 356.6%
2022-04-16 22:29:15,458 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 2.261, Acc: 0.666, Base Lr: 2.46e-03
2022-04-16 22:29:34,667 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.393[s] Speed: 40.7[samples/s]
2022-04-16 22:31:37,504 reid_baseline.train INFO: normal accuracy 0.6851044296534312 3.0557045936584473 
2022-04-16 22:31:41,470 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-16 22:31:41,471 reid_baseline.train INFO: Accuracy: 68.5% Mean Entropy: 305.6%
2022-04-16 22:32:26,426 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.924, Acc: 0.712, Base Lr: 2.85e-03
2022-04-16 22:32:46,125 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.425[s] Speed: 37.6[samples/s]
2022-04-16 22:34:53,949 reid_baseline.train INFO: normal accuracy 0.7300895111315125 2.6613900661468506 
2022-04-16 22:35:07,851 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-16 22:35:07,851 reid_baseline.train INFO: Accuracy: 73.0% Mean Entropy: 266.1%
2022-04-16 22:35:39,959 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.710, Acc: 0.754, Base Lr: 3.25e-03
2022-04-16 22:35:53,323 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.299[s] Speed: 53.5[samples/s]
2022-04-16 22:37:19,053 reid_baseline.train INFO: normal accuracy 0.7679596052329585 2.3389298915863037 
2022-04-16 22:37:22,163 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-16 22:37:22,164 reid_baseline.train INFO: Accuracy: 76.8% Mean Entropy: 233.9%
2022-04-16 22:37:56,089 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.549, Acc: 0.787, Base Lr: 3.64e-03
2022-04-16 22:38:11,297 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-16 22:39:58,899 reid_baseline.train INFO: normal accuracy 0.7925177874684416 2.1414642333984375 
2022-04-16 22:40:02,033 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-16 22:40:02,035 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 214.1%
2022-04-16 22:40:43,555 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.414, Acc: 0.832, Base Lr: 4.04e-03
2022-04-16 22:40:59,789 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.380[s] Speed: 42.1[samples/s]
2022-04-16 22:43:07,384 reid_baseline.train INFO: normal accuracy 0.8085838879963277 1.9004179239273071 
2022-04-16 22:43:10,507 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-16 22:43:10,508 reid_baseline.train INFO: Accuracy: 80.9% Mean Entropy: 190.0%
2022-04-16 22:43:51,031 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.361, Acc: 0.831, Base Lr: 4.44e-03
2022-04-16 22:44:09,743 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.390[s] Speed: 41.1[samples/s]
2022-04-16 22:46:02,201 reid_baseline.train INFO: normal accuracy 0.8207482212531558 1.7324540615081787 
2022-04-16 22:46:05,360 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-16 22:46:05,362 reid_baseline.train INFO: Accuracy: 82.1% Mean Entropy: 173.2%
2022-04-16 22:46:33,532 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 1.274, Acc: 0.861, Base Lr: 4.83e-03
2022-04-16 22:46:51,209 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.301[s] Speed: 53.1[samples/s]
2022-04-16 22:48:24,867 reid_baseline.train INFO: normal accuracy 0.8257975671333486 1.5989631414413452 
2022-04-16 22:48:29,586 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-16 22:48:29,587 reid_baseline.train INFO: Accuracy: 82.6% Mean Entropy: 159.9%
2022-04-16 22:49:04,185 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 1.226, Acc: 0.878, Base Lr: 5.23e-03
2022-04-16 22:49:21,711 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-16 22:51:00,693 reid_baseline.train INFO: normal accuracy 0.8257975671333486 1.5251315832138062 
2022-04-16 22:51:03,784 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-16 22:51:03,784 reid_baseline.train INFO: Accuracy: 82.6% Mean Entropy: 152.5%
2022-04-16 22:51:41,989 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 1.164, Acc: 0.888, Base Lr: 5.62e-03
2022-04-16 22:51:56,383 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.346[s] Speed: 46.3[samples/s]
2022-04-16 22:53:50,848 reid_baseline.train INFO: normal accuracy 0.828551755795272 1.5384348630905151 
2022-04-16 22:53:50,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-16 22:53:50,849 reid_baseline.train INFO: Accuracy: 82.9% Mean Entropy: 153.8%
2022-04-16 22:54:31,875 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 1.119, Acc: 0.905, Base Lr: 6.02e-03
2022-04-16 22:54:52,024 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.402[s] Speed: 39.8[samples/s]
2022-04-16 22:56:46,187 reid_baseline.train INFO: normal accuracy 0.8340601331191186 1.4694520235061646 
2022-04-16 22:56:49,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-16 22:56:49,312 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 146.9%
2022-04-16 22:57:17,263 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 1.086, Acc: 0.909, Base Lr: 6.42e-03
2022-04-16 22:57:33,894 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.293[s] Speed: 54.6[samples/s]
2022-04-16 22:59:08,287 reid_baseline.train INFO: normal accuracy 0.8319944916226761 1.4125869274139404 
2022-04-16 22:59:11,440 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-16 22:59:11,441 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 141.3%
2022-04-16 22:59:46,292 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 1.070, Acc: 0.925, Base Lr: 6.81e-03
2022-04-16 23:00:02,039 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-16 23:01:38,886 reid_baseline.train INFO: normal accuracy 0.8313059444571953 1.4820300340652466 
2022-04-16 23:01:38,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-16 23:01:38,891 reid_baseline.train INFO: Accuracy: 83.1% Mean Entropy: 148.2%
2022-04-16 23:02:18,549 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 1.060, Acc: 0.927, Base Lr: 7.21e-03
2022-04-16 23:02:31,737 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-16 23:04:28,245 reid_baseline.train INFO: normal accuracy 0.8338306173972917 1.4089566469192505 
2022-04-16 23:04:31,351 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-16 23:04:31,352 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 140.9%
2022-04-16 23:05:08,922 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 1.029, Acc: 0.934, Base Lr: 7.60e-03
2022-04-16 23:05:27,964 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-16 23:07:25,175 reid_baseline.train INFO: normal accuracy 0.8315354601790222 1.4322004318237305 
2022-04-16 23:07:25,176 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-16 23:07:25,176 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 143.2%
2022-04-16 23:07:54,359 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.969, Acc: 0.949, Base Lr: 4.01e-03
2022-04-16 23:08:13,667 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-16 23:09:54,948 reid_baseline.train INFO: normal accuracy 0.8331420702318109 1.4186820983886719 
2022-04-16 23:09:54,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-16 23:09:54,949 reid_baseline.train INFO: Accuracy: 83.3% Mean Entropy: 141.9%
2022-04-16 23:10:28,567 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.961, Acc: 0.952, Base Lr: 3.69e-03
2022-04-16 23:10:43,304 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.318[s] Speed: 50.3[samples/s]
2022-04-16 23:12:19,580 reid_baseline.train INFO: normal accuracy 0.8336011016754648 1.412859320640564 
2022-04-16 23:12:19,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-16 23:12:19,582 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 141.3%
2022-04-16 23:12:53,296 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.945, Acc: 0.961, Base Lr: 3.38e-03
2022-04-16 23:13:08,150 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.319[s] Speed: 50.1[samples/s]
2022-04-16 23:15:00,878 reid_baseline.train INFO: normal accuracy 0.8349781960064264 1.4412453174591064 
2022-04-16 23:15:00,880 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-16 23:15:00,880 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 144.1%
2022-04-16 23:15:41,288 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.944, Acc: 0.959, Base Lr: 3.08e-03
2022-04-16 23:16:01,188 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-04-16 23:18:02,367 reid_baseline.train INFO: normal accuracy 0.8322240073445031 1.491377830505371 
2022-04-16 23:18:02,367 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-16 23:18:02,368 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 149.1%
2022-04-16 23:18:36,168 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.943, Acc: 0.964, Base Lr: 2.77e-03
2022-04-16 23:18:56,423 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.355[s] Speed: 45.0[samples/s]
2022-04-16 23:20:40,167 reid_baseline.train INFO: normal accuracy 0.8336011016754648 1.4831732511520386 
2022-04-16 23:20:40,168 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-16 23:20:40,168 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 148.3%
2022-04-16 23:21:13,259 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.922, Acc: 0.964, Base Lr: 2.48e-03
2022-04-16 23:21:27,288 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.310[s] Speed: 51.6[samples/s]
2022-04-16 23:23:01,015 reid_baseline.train INFO: normal accuracy 0.8342896488409456 1.413933277130127 
2022-04-16 23:23:01,020 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-16 23:23:01,020 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 141.4%
2022-04-16 23:23:33,040 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.927, Acc: 0.964, Base Lr: 2.20e-03
2022-04-16 23:23:49,709 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.320[s] Speed: 50.0[samples/s]
2022-04-16 23:25:47,371 reid_baseline.train INFO: normal accuracy 0.836584806059215 1.4859007596969604 
2022-04-16 23:25:47,372 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-16 23:25:47,372 reid_baseline.train INFO: Accuracy: 83.7% Mean Entropy: 148.6%
2022-04-16 23:26:21,457 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.904, Acc: 0.970, Base Lr: 1.92e-03
2022-04-16 23:26:35,369 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.316[s] Speed: 50.7[samples/s]
2022-04-16 23:28:32,903 reid_baseline.train INFO: normal accuracy 0.8354372274500803 1.4381409883499146 
2022-04-16 23:28:32,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-16 23:28:32,903 reid_baseline.train INFO: Accuracy: 83.5% Mean Entropy: 143.8%
2022-04-16 23:29:03,588 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.915, Acc: 0.972, Base Lr: 1.66e-03
2022-04-16 23:29:14,733 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.275[s] Speed: 58.2[samples/s]
2022-04-16 23:30:51,496 reid_baseline.train INFO: normal accuracy 0.8338306173972917 1.519240140914917 
2022-04-16 23:30:51,500 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-16 23:30:51,500 reid_baseline.train INFO: Accuracy: 83.4% Mean Entropy: 151.9%
2022-04-16 23:31:30,581 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.916, Acc: 0.968, Base Lr: 1.42e-03
2022-04-16 23:31:46,693 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.363[s] Speed: 44.1[samples/s]
2022-04-16 23:33:18,875 reid_baseline.train INFO: normal accuracy 0.8358962588937342 1.4543731212615967 
2022-04-16 23:33:18,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-16 23:33:18,878 reid_baseline.train INFO: Accuracy: 83.6% Mean Entropy: 145.4%
2022-04-16 23:33:45,320 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.894, Acc: 0.972, Base Lr: 1.19e-03
2022-04-16 23:33:59,594 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.268[s] Speed: 59.8[samples/s]
