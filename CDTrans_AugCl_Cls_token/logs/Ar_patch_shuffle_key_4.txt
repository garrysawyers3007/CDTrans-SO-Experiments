2022-04-15 12:56:10,784 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_1
2022-04-15 12:56:10,784 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-15 12:56:10,784 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 12:56:10,785 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 12:56:10,785 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 12:56:26,209 reid_baseline.train INFO: start training
2022-04-15 12:57:01,028 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.289, Base Lr: 4.76e-04
2022-04-15 12:57:18,076 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 12:58:18,420 reid_baseline.train INFO: normal accuracy 0.52399189006533 4.17275333404541 
2022-04-15 12:58:19,302 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 12:58:19,302 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 417.3%
2022-04-15 12:58:54,905 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.892, Acc: 0.706, Base Lr: 8.72e-04
2022-04-15 12:59:12,124 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.347[s] Speed: 46.0[samples/s]
2022-04-15 13:00:12,466 reid_baseline.train INFO: normal accuracy 0.5791845010137419 4.166325092315674 
2022-04-15 13:00:13,381 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 13:00:13,381 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 416.6%
2022-04-15 13:00:46,563 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.470, Acc: 0.736, Base Lr: 1.27e-03
2022-04-15 13:01:04,465 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 13:02:06,751 reid_baseline.train INFO: normal accuracy 0.5902230232034242 4.127297401428223 
2022-04-15 13:02:07,679 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 13:02:07,679 reid_baseline.train INFO: Accuracy: 59.0% Mean Entropy: 412.7%
2022-04-15 13:02:41,623 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.927, Acc: 0.730, Base Lr: 1.66e-03
2022-04-15 13:02:58,594 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-15 13:04:00,764 reid_baseline.train INFO: normal accuracy 0.5936021626492454 3.9603967666625977 
2022-04-15 13:04:01,657 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 13:04:01,657 reid_baseline.train INFO: Accuracy: 59.4% Mean Entropy: 396.0%
2022-04-15 13:04:34,962 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.297, Acc: 0.754, Base Lr: 2.06e-03
2022-04-15 13:04:51,952 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.331[s] Speed: 48.4[samples/s]
2022-04-15 13:05:52,269 reid_baseline.train INFO: normal accuracy 0.6197341743635955 3.5569896697998047 
2022-04-15 13:05:53,088 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 13:05:53,088 reid_baseline.train INFO: Accuracy: 62.0% Mean Entropy: 355.7%
2022-04-15 13:06:28,395 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 13:06:45,558 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-15 13:07:46,457 reid_baseline.train INFO: normal accuracy 0.6787564766839378 3.0816636085510254 
2022-04-15 13:07:47,386 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 13:07:47,386 reid_baseline.train INFO: Accuracy: 67.9% Mean Entropy: 308.2%
2022-04-15 13:08:19,875 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.515, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 13:08:37,853 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.331[s] Speed: 48.3[samples/s]
2022-04-15 13:09:39,932 reid_baseline.train INFO: normal accuracy 0.7355260193737329 2.6298508644104004 
2022-04-15 13:09:40,841 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 13:09:40,841 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 263.0%
2022-04-15 13:10:14,771 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.303, Acc: 0.889, Base Lr: 3.25e-03
2022-04-15 13:10:32,025 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 13:11:34,356 reid_baseline.train INFO: normal accuracy 0.7594052714575354 2.228116512298584 
2022-04-15 13:11:35,171 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 13:11:35,172 reid_baseline.train INFO: Accuracy: 75.9% Mean Entropy: 222.8%
2022-04-15 13:12:10,712 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.180, Acc: 0.912, Base Lr: 3.64e-03
2022-04-15 13:12:31,766 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.372[s] Speed: 43.0[samples/s]
2022-04-15 13:13:39,237 reid_baseline.train INFO: normal accuracy 0.779905384095517 1.9574835300445557 
2022-04-15 13:13:40,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 13:13:40,292 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 195.7%
2022-04-15 13:14:16,851 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.933, Base Lr: 4.04e-03
2022-04-15 13:14:34,326 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.355[s] Speed: 45.0[samples/s]
2022-04-15 13:15:43,466 reid_baseline.train INFO: normal accuracy 0.7853120072088308 1.8739904165267944 
2022-04-15 13:15:44,402 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 13:15:44,402 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 187.4%
2022-04-15 13:16:23,743 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.024, Acc: 0.942, Base Lr: 4.44e-03
2022-04-15 13:16:41,299 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.373[s] Speed: 42.9[samples/s]
2022-04-15 13:17:44,275 reid_baseline.train INFO: normal accuracy 0.7871142149132687 1.6812019348144531 
2022-04-15 13:17:45,292 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 13:17:45,292 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 168.1%
2022-04-15 13:18:19,924 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.980, Acc: 0.954, Base Lr: 4.83e-03
2022-04-15 13:18:36,940 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.339[s] Speed: 47.1[samples/s]
2022-04-15 13:19:38,983 reid_baseline.train INFO: normal accuracy 0.7893669745438162 1.70114266872406 
2022-04-15 13:19:38,988 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 13:19:38,990 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 170.1%
2022-04-15 13:20:12,986 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.937, Acc: 0.967, Base Lr: 5.23e-03
2022-04-15 13:20:29,979 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.335[s] Speed: 47.7[samples/s]
2022-04-15 13:21:29,707 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.6710270643234253 
2022-04-15 13:21:30,627 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 13:21:30,627 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 167.1%
2022-04-15 13:22:06,218 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.907, Acc: 0.979, Base Lr: 5.62e-03
2022-04-15 13:22:23,092 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-15 13:23:26,428 reid_baseline.train INFO: normal accuracy 0.7922955620635278 1.6677370071411133 
2022-04-15 13:23:27,396 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 13:23:27,396 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 166.8%
2022-04-15 13:24:03,129 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.976, Base Lr: 6.02e-03
2022-04-15 13:24:21,030 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.353[s] Speed: 45.4[samples/s]
2022-04-15 13:25:23,177 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.5977932214736938 
2022-04-15 13:25:24,011 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 13:25:24,011 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 159.8%
2022-04-15 13:25:48,786 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.857, Acc: 0.986, Base Lr: 6.42e-03
2022-04-15 13:26:00,810 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.241[s] Speed: 66.3[samples/s]
2022-04-15 13:26:43,911 reid_baseline.train INFO: normal accuracy 0.7898175264699256 1.6205369234085083 
2022-04-15 13:26:43,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 13:26:43,914 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 162.1%
2022-04-15 13:27:08,367 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.843, Acc: 0.987, Base Lr: 6.81e-03
2022-04-15 13:27:20,455 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.240[s] Speed: 66.6[samples/s]
2022-04-15 13:28:01,936 reid_baseline.train INFO: normal accuracy 0.7884658706915972 1.6942660808563232 
2022-04-15 13:28:01,938 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 13:28:01,939 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 169.4%
2022-04-15 13:28:26,175 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.839, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 13:28:38,304 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.239[s] Speed: 66.9[samples/s]
2022-04-15 13:29:21,608 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.5333043336868286 
2022-04-15 13:29:22,529 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 13:29:22,529 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 153.3%
2022-04-15 13:29:46,960 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.823, Acc: 0.989, Base Lr: 7.60e-03
2022-04-15 13:29:59,137 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.241[s] Speed: 66.5[samples/s]
2022-04-15 13:30:42,085 reid_baseline.train INFO: normal accuracy 0.7873394908763235 1.5725711584091187 
2022-04-15 13:30:42,087 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 13:30:42,087 reid_baseline.train INFO: Accuracy: 78.7% Mean Entropy: 157.3%
2022-04-15 13:31:06,417 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.808, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 13:31:18,293 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.238[s] Speed: 67.3[samples/s]
2022-04-15 13:32:02,122 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.67744779586792 
2022-04-15 13:32:02,124 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 13:32:02,124 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 167.7%
2022-04-15 13:32:26,508 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.805, Acc: 0.994, Base Lr: 3.69e-03
2022-04-15 13:32:38,555 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.240[s] Speed: 66.8[samples/s]
2022-04-15 13:33:21,766 reid_baseline.train INFO: normal accuracy 0.7907186303221446 1.7225764989852905 
2022-04-15 13:33:21,768 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 13:33:21,769 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 172.3%
2022-04-15 13:33:46,287 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.805, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 13:33:58,270 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.240[s] Speed: 66.7[samples/s]
2022-04-15 13:34:52,756 reid_baseline.train INFO: normal accuracy 0.7907186303221446 1.6720699071884155 
2022-04-15 13:34:52,758 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 13:34:52,759 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 167.2%
2022-04-15 13:35:17,550 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.08e-03
2022-04-15 13:35:34,373 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.274[s] Speed: 58.5[samples/s]
2022-04-15 13:36:35,116 reid_baseline.train INFO: normal accuracy 0.7918450101374184 1.701181173324585 
2022-04-15 13:36:35,121 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 13:36:35,121 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 170.1%
2022-04-15 13:37:09,741 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.798, Acc: 0.994, Base Lr: 2.77e-03
2022-04-15 13:37:26,678 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 13:38:27,484 reid_baseline.train INFO: normal accuracy 0.7965758053615679 1.6741122007369995 
2022-04-15 13:38:27,486 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 13:38:27,486 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 167.4%
2022-04-15 13:39:02,583 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.793, Acc: 0.995, Base Lr: 2.48e-03
2022-04-15 13:39:18,958 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.339[s] Speed: 47.3[samples/s]
2022-04-15 13:40:19,162 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.6890888214111328 
2022-04-15 13:40:19,166 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 13:40:19,166 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 168.9%
2022-04-15 13:40:54,789 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.792, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 13:41:10,933 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-15 13:42:11,626 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.7286286354064941 
2022-04-15 13:42:11,629 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 13:42:11,629 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 172.9%
2022-04-15 13:42:46,761 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.994, Base Lr: 1.92e-03
2022-04-15 13:43:02,887 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 13:44:02,561 reid_baseline.train INFO: normal accuracy 0.7902680783960352 1.675840139389038 
2022-04-15 13:44:02,566 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 13:44:02,566 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 167.6%
2022-04-15 13:44:38,242 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.789, Acc: 0.994, Base Lr: 1.66e-03
2022-04-15 13:44:54,405 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 13:45:54,895 reid_baseline.train INFO: normal accuracy 0.7925208380265826 1.7520687580108643 
2022-04-15 13:45:54,900 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 13:45:54,900 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 175.2%
2022-04-15 13:46:30,464 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.788, Acc: 0.997, Base Lr: 1.42e-03
2022-04-15 13:46:46,684 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.341[s] Speed: 47.0[samples/s]
2022-04-15 13:47:46,529 reid_baseline.train INFO: normal accuracy 0.7940977697679658 1.71598482131958 
2022-04-15 13:47:46,533 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 13:47:46,533 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 171.6%
2022-04-15 13:48:21,965 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 1.19e-03
2022-04-15 13:48:38,524 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 13:49:39,793 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.6880065202713013 
2022-04-15 13:49:39,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 13:49:39,798 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 168.8%
2022-04-15 13:50:15,325 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.785, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 13:50:31,737 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.340[s] Speed: 47.0[samples/s]
2022-04-15 13:51:32,444 reid_baseline.train INFO: normal accuracy 0.7922955620635278 1.7097694873809814 
2022-04-15 13:51:32,449 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 13:51:32,449 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 171.0%
2022-04-15 13:52:07,456 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 7.78e-04
2022-04-15 13:52:23,896 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 13:53:24,018 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.781235933303833 
2022-04-15 13:53:24,022 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 13:53:24,022 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 178.1%
2022-04-15 13:53:59,599 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.04e-04
2022-04-15 13:54:16,106 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 13:55:16,269 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.7091751098632812 
2022-04-15 13:55:16,272 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 13:55:16,272 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 170.9%
2022-04-15 13:55:51,141 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.783, Acc: 0.997, Base Lr: 4.51e-04
2022-04-15 13:56:07,804 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 13:57:08,122 reid_baseline.train INFO: normal accuracy 0.7900428024329804 1.8027576208114624 
2022-04-15 13:57:08,127 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 13:57:08,127 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 180.3%
2022-04-15 13:57:43,702 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.995, Base Lr: 3.20e-04
2022-04-15 13:58:00,364 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.342[s] Speed: 46.7[samples/s]
2022-04-15 13:59:00,562 reid_baseline.train INFO: normal accuracy 0.7916197341743636 1.760852336883545 
2022-04-15 13:59:00,567 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 13:59:00,567 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 176.1%
2022-04-15 13:59:35,805 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 13:59:52,590 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 14:00:52,795 reid_baseline.train INFO: normal accuracy 0.7900428024329804 1.7081745862960815 
2022-04-15 14:00:52,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 14:00:52,798 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 170.8%
2022-04-15 14:01:28,404 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 14:01:45,487 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.346[s] Speed: 46.2[samples/s]
2022-04-15 14:02:45,765 reid_baseline.train INFO: normal accuracy 0.7918450101374184 1.7196266651153564 
2022-04-15 14:02:45,770 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 14:02:45,770 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 172.0%
2022-04-15 14:03:21,444 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 6.51e-05
2022-04-15 14:03:37,206 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 14:04:37,234 reid_baseline.train INFO: normal accuracy 0.792971389952692 1.7912428379058838 
2022-04-15 14:04:37,238 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 14:04:37,239 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 179.1%
2022-04-15 14:05:12,722 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 2.83e-05
2022-04-15 14:05:29,494 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.344[s] Speed: 46.6[samples/s]
2022-04-15 14:06:29,413 reid_baseline.train INFO: normal accuracy 0.7918450101374184 1.7849680185317993 
2022-04-15 14:06:29,418 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 14:06:29,418 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 178.5%
2022-04-15 14:07:04,833 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.791, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 14:07:22,235 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 14:08:22,650 reid_baseline.train INFO: normal accuracy 0.7927461139896373 1.725587010383606 
2022-04-15 14:08:22,655 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 14:08:22,657 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 172.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_1/transformer_best_model.pth
2022-04-15 14:09:26,074 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.5333043336868286 
2022-04-15 14:09:26,075 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:09:26,075 reid_baseline.train INFO: Accuracy: 78.5%
2022-04-15 14:10:26,728 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.5333043336868286 
2022-04-15 14:10:26,729 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:10:26,729 reid_baseline.train INFO: Shuffled Accuracy: 78.5%
2022-04-15 14:11:03,685 reid_baseline.train INFO: normal accuracy 0.9950556242274413 0.5780174732208252 
2022-04-15 14:11:03,685 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 14:11:03,685 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 14:11:08,248 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_1
2022-04-15 14:11:08,248 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_1', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=1, dom_cls=False)
2022-04-15 14:11:08,248 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 14:11:08,248 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 14:11:08,249 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_1
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 14:11:22,819 reid_baseline.train INFO: start training
2022-04-15 14:11:55,631 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.289, Base Lr: 4.76e-04
2022-04-15 14:12:13,948 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 14:13:17,940 reid_baseline.train INFO: normal accuracy 0.5997245811338077 4.172653675079346 
2022-04-15 14:13:18,886 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 14:13:18,886 reid_baseline.train INFO: Accuracy: 60.0% Mean Entropy: 417.3%
2022-04-15 14:13:52,056 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.892, Acc: 0.706, Base Lr: 8.72e-04
2022-04-15 14:14:09,957 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 14:15:14,110 reid_baseline.train INFO: normal accuracy 0.6520541657103511 4.164093494415283 
2022-04-15 14:15:15,028 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 14:15:15,029 reid_baseline.train INFO: Accuracy: 65.2% Mean Entropy: 416.4%
2022-04-15 14:15:39,671 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.470, Acc: 0.736, Base Lr: 1.27e-03
2022-04-15 14:15:51,842 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.242[s] Speed: 66.1[samples/s]
2022-04-15 14:16:36,964 reid_baseline.train INFO: normal accuracy 0.6639889832453523 4.104119300842285 
2022-04-15 14:16:37,897 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 14:16:37,897 reid_baseline.train INFO: Accuracy: 66.4% Mean Entropy: 410.4%
2022-04-15 14:17:00,350 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.927, Acc: 0.730, Base Lr: 1.66e-03
2022-04-15 14:17:12,505 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.227[s] Speed: 70.3[samples/s]
2022-04-15 14:17:57,560 reid_baseline.train INFO: normal accuracy 0.6766123479458342 3.8607780933380127 
2022-04-15 14:17:58,476 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 14:17:58,477 reid_baseline.train INFO: Accuracy: 67.7% Mean Entropy: 386.1%
2022-04-15 14:18:23,230 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.297, Acc: 0.754, Base Lr: 2.06e-03
2022-04-15 14:18:33,688 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.231[s] Speed: 69.1[samples/s]
2022-04-15 14:19:22,083 reid_baseline.train INFO: normal accuracy 0.7002524672940097 3.334214925765991 
2022-04-15 14:19:22,957 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 14:19:22,957 reid_baseline.train INFO: Accuracy: 70.0% Mean Entropy: 333.4%
2022-04-15 14:19:45,427 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.797, Base Lr: 2.46e-03
2022-04-15 14:19:56,241 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.218[s] Speed: 73.5[samples/s]
2022-04-15 14:20:42,472 reid_baseline.train INFO: normal accuracy 0.7438604544411292 2.8216190338134766 
2022-04-15 14:20:43,264 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 14:20:43,265 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 282.2%
2022-04-15 14:21:05,347 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.515, Acc: 0.840, Base Lr: 2.85e-03
2022-04-15 14:21:16,035 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.215[s] Speed: 74.5[samples/s]
2022-04-15 14:22:00,873 reid_baseline.train INFO: normal accuracy 0.7929768189120955 2.3640987873077393 
2022-04-15 14:22:01,790 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 14:22:01,790 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 236.4%
2022-04-15 14:22:24,242 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.303, Acc: 0.889, Base Lr: 3.25e-03
2022-04-15 14:22:33,867 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.210[s] Speed: 76.3[samples/s]
2022-04-15 14:23:18,934 reid_baseline.train INFO: normal accuracy 0.8127151709892128 1.9864298105239868 
2022-04-15 14:23:19,984 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 14:23:19,985 reid_baseline.train INFO: Accuracy: 81.3% Mean Entropy: 198.6%
2022-04-15 14:23:41,261 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.180, Acc: 0.912, Base Lr: 3.64e-03
2022-04-15 14:23:53,385 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.220[s] Speed: 72.9[samples/s]
2022-04-15 14:24:39,514 reid_baseline.train INFO: normal accuracy 0.8267156300206564 1.731915831565857 
2022-04-15 14:24:40,409 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 14:24:40,409 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 173.2%
2022-04-15 14:25:03,428 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.933, Base Lr: 4.04e-03
2022-04-15 14:25:15,634 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.232[s] Speed: 69.1[samples/s]
2022-04-15 14:26:01,985 reid_baseline.train INFO: normal accuracy 0.83245352306633 1.663949966430664 
2022-04-15 14:26:02,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 14:26:02,915 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 166.4%
2022-04-15 14:26:27,539 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.024, Acc: 0.942, Base Lr: 4.44e-03
2022-04-15 14:26:37,788 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.228[s] Speed: 70.0[samples/s]
2022-04-15 14:27:24,003 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.4686132669448853 
2022-04-15 14:27:24,901 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 14:27:24,901 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 146.9%
2022-04-15 14:27:47,238 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.980, Acc: 0.954, Base Lr: 4.83e-03
2022-04-15 14:27:58,108 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.218[s] Speed: 73.3[samples/s]
2022-04-15 14:28:49,834 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.5127909183502197 
2022-04-15 14:28:49,839 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 14:28:49,839 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 151.3%
2022-04-15 14:29:23,376 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.937, Acc: 0.967, Base Lr: 5.23e-03
2022-04-15 14:29:40,434 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 14:30:45,820 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.467692255973816 
2022-04-15 14:30:46,826 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 14:30:46,827 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 146.8%
2022-04-15 14:31:20,895 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.907, Acc: 0.979, Base Lr: 5.62e-03
2022-04-15 14:31:37,041 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 14:32:42,071 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.4488788843154907 
2022-04-15 14:32:43,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 14:32:43,015 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 144.9%
2022-04-15 14:33:17,184 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.976, Base Lr: 6.02e-03
2022-04-15 14:33:33,325 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 14:34:38,055 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.3781154155731201 
2022-04-15 14:34:38,928 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 14:34:38,928 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 137.8%
2022-04-15 14:35:12,986 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.857, Acc: 0.986, Base Lr: 6.42e-03
2022-04-15 14:35:29,380 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 14:36:33,227 reid_baseline.train INFO: normal accuracy 0.8430112462703695 1.3892865180969238 
2022-04-15 14:36:33,229 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 14:36:33,229 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 138.9%
2022-04-15 14:37:07,497 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.843, Acc: 0.987, Base Lr: 6.81e-03
2022-04-15 14:37:23,991 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 14:38:28,268 reid_baseline.train INFO: normal accuracy 0.845076887766812 1.4767980575561523 
2022-04-15 14:38:28,273 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 14:38:28,275 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 147.7%
2022-04-15 14:39:01,391 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.839, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 14:39:18,992 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 14:40:23,055 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3145685195922852 
2022-04-15 14:40:23,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 14:40:23,966 reid_baseline.train INFO: Accuracy: 84.6% Mean Entropy: 131.5%
2022-04-15 14:40:55,493 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.823, Acc: 0.989, Base Lr: 7.60e-03
2022-04-15 14:41:13,438 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-15 14:42:18,139 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.3653955459594727 
2022-04-15 14:42:18,144 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 14:42:18,144 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 136.5%
2022-04-15 14:42:53,940 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.808, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 14:43:11,016 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-15 14:44:16,523 reid_baseline.train INFO: normal accuracy 0.840945604773927 1.430892825126648 
2022-04-15 14:44:16,528 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 14:44:16,528 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 143.1%
2022-04-15 14:44:43,995 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.805, Acc: 0.994, Base Lr: 3.69e-03
2022-04-15 14:44:59,259 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.281[s] Speed: 57.0[samples/s]
2022-04-15 14:46:00,841 reid_baseline.train INFO: normal accuracy 0.8404865733302731 1.5024538040161133 
2022-04-15 14:46:00,844 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 14:46:00,844 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 150.2%
2022-04-15 14:46:36,697 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.805, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 14:46:53,043 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 14:47:54,309 reid_baseline.train INFO: normal accuracy 0.8441588248795042 1.4339655637741089 
2022-04-15 14:47:54,314 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 14:47:54,314 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 143.4%
2022-04-15 14:48:29,291 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.803, Acc: 0.993, Base Lr: 3.08e-03
2022-04-15 14:48:45,672 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-15 14:49:46,915 reid_baseline.train INFO: normal accuracy 0.8432407619921964 1.453277587890625 
2022-04-15 14:49:46,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 14:49:46,917 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 145.3%
2022-04-15 14:50:22,685 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.798, Acc: 0.994, Base Lr: 2.77e-03
2022-04-15 14:50:39,173 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.344[s] Speed: 46.6[samples/s]
2022-04-15 14:51:40,026 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.4358222484588623 
2022-04-15 14:51:40,030 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 14:51:40,031 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 143.6%
2022-04-15 14:52:14,985 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.793, Acc: 0.995, Base Lr: 2.48e-03
2022-04-15 14:52:31,456 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 14:53:31,864 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.4485164880752563 
2022-04-15 14:53:31,869 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 14:53:31,869 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 144.9%
2022-04-15 14:54:07,832 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.792, Acc: 0.994, Base Lr: 2.20e-03
2022-04-15 14:54:24,624 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 14:55:26,702 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4932312965393066 
2022-04-15 14:55:26,707 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 14:55:26,707 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 149.3%
2022-04-15 14:56:02,208 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.994, Base Lr: 1.92e-03
2022-04-15 14:56:18,771 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 14:57:20,133 reid_baseline.train INFO: normal accuracy 0.8439293091576773 1.4403812885284424 
2022-04-15 14:57:20,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 14:57:20,138 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 144.0%
2022-04-15 14:57:55,456 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.789, Acc: 0.994, Base Lr: 1.66e-03
2022-04-15 14:58:12,072 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 14:59:12,206 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.5067789554595947 
2022-04-15 14:59:12,210 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 14:59:12,210 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 150.7%
2022-04-15 14:59:47,887 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.788, Acc: 0.997, Base Lr: 1.42e-03
2022-04-15 15:00:04,161 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 15:01:05,384 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.475786566734314 
2022-04-15 15:01:05,389 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 15:01:05,390 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 147.6%
2022-04-15 15:01:41,063 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 1.19e-03
2022-04-15 15:01:58,325 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-15 15:03:00,388 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.4420989751815796 
2022-04-15 15:03:00,393 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 15:03:00,393 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 144.2%
2022-04-15 15:03:36,567 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.785, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 15:03:52,988 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-15 15:04:54,095 reid_baseline.train INFO: normal accuracy 0.8416341519394078 1.4552632570266724 
2022-04-15 15:04:54,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 15:04:54,100 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 145.5%
2022-04-15 15:05:30,523 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 7.78e-04
2022-04-15 15:05:47,391 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-15 15:06:48,173 reid_baseline.train INFO: normal accuracy 0.8446178563231581 1.5271599292755127 
2022-04-15 15:06:48,178 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 15:06:48,178 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 152.7%
2022-04-15 15:07:24,005 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.994, Base Lr: 6.04e-04
2022-04-15 15:07:41,323 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-15 15:08:42,793 reid_baseline.train INFO: normal accuracy 0.8446178563231581 1.456050157546997 
2022-04-15 15:08:42,798 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 15:08:42,798 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 145.6%
2022-04-15 15:09:18,716 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.783, Acc: 0.997, Base Lr: 4.51e-04
2022-04-15 15:09:36,047 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-15 15:10:36,648 reid_baseline.train INFO: normal accuracy 0.8443883406013312 1.5435551404953003 
2022-04-15 15:10:36,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 15:10:36,653 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 154.4%
2022-04-15 15:11:12,404 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.995, Base Lr: 3.20e-04
2022-04-15 15:11:30,107 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.351[s] Speed: 45.5[samples/s]
2022-04-15 15:12:30,848 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.506367802619934 
2022-04-15 15:12:30,853 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 15:12:30,853 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 150.6%
2022-04-15 15:13:06,529 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.787, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 15:13:24,257 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-15 15:14:25,008 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.4560190439224243 
2022-04-15 15:14:25,013 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 15:14:25,013 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 145.6%
2022-04-15 15:15:00,937 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 15:15:18,791 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.352[s] Speed: 45.4[samples/s]
2022-04-15 15:16:20,396 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4674923419952393 
2022-04-15 15:16:20,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 15:16:20,399 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 146.7%
2022-04-15 15:16:56,399 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 6.51e-05
2022-04-15 15:17:14,273 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.354[s] Speed: 45.2[samples/s]
2022-04-15 15:18:15,114 reid_baseline.train INFO: normal accuracy 0.8441588248795042 1.531408667564392 
2022-04-15 15:18:15,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 15:18:15,117 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 153.1%
2022-04-15 15:18:50,851 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.783, Acc: 0.996, Base Lr: 2.83e-05
2022-04-15 15:19:08,604 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.351[s] Speed: 45.6[samples/s]
2022-04-15 15:20:10,234 reid_baseline.train INFO: normal accuracy 0.8448473720449851 1.5296117067337036 
2022-04-15 15:20:10,237 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 15:20:10,237 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 153.0%
2022-04-15 15:20:45,612 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.791, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 15:21:03,484 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.349[s] Speed: 45.8[samples/s]
2022-04-15 15:22:05,372 reid_baseline.train INFO: normal accuracy 0.845306403488639 1.4758614301681519 
2022-04-15 15:22:05,374 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 15:22:05,374 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 147.6%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_1/transformer_best_model.pth
2022-04-15 15:23:09,807 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3145685195922852 
2022-04-15 15:23:09,807 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 15:23:09,807 reid_baseline.train INFO: Accuracy: 84.6%
2022-04-15 15:24:10,645 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.3145685195922852 
2022-04-15 15:24:10,646 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 15:24:10,646 reid_baseline.train INFO: Shuffled Accuracy: 84.6%
2022-04-15 15:24:47,891 reid_baseline.train INFO: normal accuracy 0.9950556242274413 0.5780174732208252 
2022-04-15 15:24:47,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 15:24:47,891 reid_baseline.train INFO: Source Clean Accuracy: 99.5%
2022-04-15 15:24:52,514 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_2
2022-04-15 15:24:52,514 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-15 15:24:52,514 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 15:24:52,514 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 15:24:52,514 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 15:25:06,427 reid_baseline.train INFO: start training
2022-04-15 15:25:41,064 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.295, Base Lr: 4.76e-04
2022-04-15 15:25:56,435 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.325[s] Speed: 49.2[samples/s]
2022-04-15 15:26:58,541 reid_baseline.train INFO: normal accuracy 0.5201621986933994 4.172754764556885 
2022-04-15 15:26:59,527 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 15:26:59,527 reid_baseline.train INFO: Accuracy: 52.0% Mean Entropy: 417.3%
2022-04-15 15:27:33,533 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.894, Acc: 0.696, Base Lr: 8.72e-04
2022-04-15 15:27:48,732 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.324[s] Speed: 49.4[samples/s]
2022-04-15 15:28:52,198 reid_baseline.train INFO: normal accuracy 0.5789592250506871 4.166289329528809 
2022-04-15 15:28:53,134 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 15:28:53,134 reid_baseline.train INFO: Accuracy: 57.9% Mean Entropy: 416.6%
2022-04-15 15:29:26,966 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.476, Acc: 0.733, Base Lr: 1.27e-03
2022-04-15 15:29:41,944 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-15 15:30:45,247 reid_baseline.train INFO: normal accuracy 0.5913494030186979 4.128341197967529 
2022-04-15 15:30:46,212 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 15:30:46,213 reid_baseline.train INFO: Accuracy: 59.1% Mean Entropy: 412.8%
2022-04-15 15:31:19,524 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.924, Acc: 0.727, Base Lr: 1.66e-03
2022-04-15 15:31:34,464 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.317[s] Speed: 50.4[samples/s]
2022-04-15 15:32:37,696 reid_baseline.train INFO: normal accuracy 0.5958549222797928 3.961982011795044 
2022-04-15 15:32:38,611 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 15:32:38,611 reid_baseline.train INFO: Accuracy: 59.6% Mean Entropy: 396.2%
2022-04-15 15:33:12,686 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.301, Acc: 0.751, Base Lr: 2.06e-03
2022-04-15 15:33:27,205 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.319[s] Speed: 50.1[samples/s]
2022-04-15 15:34:30,594 reid_baseline.train INFO: normal accuracy 0.6237891416985808 3.561068534851074 
2022-04-15 15:34:31,418 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 15:34:31,418 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 356.1%
2022-04-15 15:35:04,411 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.784, Base Lr: 2.46e-03
2022-04-15 15:35:19,503 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.316[s] Speed: 50.7[samples/s]
2022-04-15 15:36:22,977 reid_baseline.train INFO: normal accuracy 0.6738004054967335 3.1032137870788574 
2022-04-15 15:36:23,942 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 15:36:23,942 reid_baseline.train INFO: Accuracy: 67.4% Mean Entropy: 310.3%
2022-04-15 15:36:57,853 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.514, Acc: 0.843, Base Lr: 2.85e-03
2022-04-15 15:37:13,827 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 15:38:17,558 reid_baseline.train INFO: normal accuracy 0.7355260193737329 2.627615213394165 
2022-04-15 15:38:18,469 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 15:38:18,470 reid_baseline.train INFO: Accuracy: 73.6% Mean Entropy: 262.8%
2022-04-15 15:38:50,813 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.309, Acc: 0.883, Base Lr: 3.25e-03
2022-04-15 15:39:07,286 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.321[s] Speed: 49.8[samples/s]
2022-04-15 15:40:10,597 reid_baseline.train INFO: normal accuracy 0.7627844109033566 2.245253324508667 
2022-04-15 15:40:11,487 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 15:40:11,487 reid_baseline.train INFO: Accuracy: 76.3% Mean Entropy: 224.5%
2022-04-15 15:40:45,676 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.182, Acc: 0.908, Base Lr: 3.64e-03
2022-04-15 15:41:02,636 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.336[s] Speed: 47.6[samples/s]
2022-04-15 15:42:04,984 reid_baseline.train INFO: normal accuracy 0.7792295562063528 1.9496046304702759 
2022-04-15 15:42:05,794 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 15:42:05,795 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 195.0%
2022-04-15 15:42:38,825 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.926, Base Lr: 4.04e-03
2022-04-15 15:42:55,858 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.328[s] Speed: 48.8[samples/s]
2022-04-15 15:43:58,901 reid_baseline.train INFO: normal accuracy 0.7850867312457761 1.853851556777954 
2022-04-15 15:43:59,722 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 15:43:59,722 reid_baseline.train INFO: Accuracy: 78.5% Mean Entropy: 185.4%
2022-04-15 15:44:33,196 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.028, Acc: 0.941, Base Lr: 4.44e-03
2022-04-15 15:44:50,232 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 15:45:51,769 reid_baseline.train INFO: normal accuracy 0.7830592475782834 1.6671741008758545 
2022-04-15 15:45:52,597 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 15:45:52,597 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 166.7%
2022-04-15 15:46:26,180 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.950, Base Lr: 4.83e-03
2022-04-15 15:46:42,584 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 15:47:43,438 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.6719664335250854 
2022-04-15 15:47:43,443 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 15:47:43,443 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 167.2%
2022-04-15 15:48:17,218 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.936, Acc: 0.965, Base Lr: 5.23e-03
2022-04-15 15:48:34,275 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 15:49:35,339 reid_baseline.train INFO: normal accuracy 0.7891416985807614 1.6886980533599854 
2022-04-15 15:49:35,344 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 15:49:35,344 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 168.9%
2022-04-15 15:50:09,079 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.903, Acc: 0.981, Base Lr: 5.62e-03
2022-04-15 15:50:26,048 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 15:51:26,706 reid_baseline.train INFO: normal accuracy 0.7911691822482542 1.639984369277954 
2022-04-15 15:51:27,630 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 15:51:27,630 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 164.0%
2022-04-15 15:52:01,403 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.980, Base Lr: 6.02e-03
2022-04-15 15:52:18,435 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 15:53:19,692 reid_baseline.train INFO: normal accuracy 0.7965758053615679 1.5861314535140991 
2022-04-15 15:53:20,667 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 15:53:20,668 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 158.6%
2022-04-15 15:53:54,708 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.857, Acc: 0.984, Base Lr: 6.42e-03
2022-04-15 15:54:11,718 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-15 15:55:09,648 reid_baseline.train INFO: normal accuracy 0.7936472178418563 1.6072509288787842 
2022-04-15 15:55:09,653 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 15:55:09,653 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 160.7%
2022-04-15 15:55:44,018 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.842, Acc: 0.991, Base Lr: 6.81e-03
2022-04-15 15:56:01,072 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 15:57:01,912 reid_baseline.train INFO: normal accuracy 0.7889164226177067 1.7105495929718018 
2022-04-15 15:57:01,914 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 15:57:01,915 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 171.1%
2022-04-15 15:57:36,369 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.840, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 15:57:53,443 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 15:58:53,045 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.5344291925430298 
2022-04-15 15:58:54,015 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 15:58:54,016 reid_baseline.train INFO: Accuracy: 78.2% Mean Entropy: 153.4%
2022-04-15 15:59:28,335 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.825, Acc: 0.991, Base Lr: 7.60e-03
2022-04-15 15:59:45,261 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 16:00:45,393 reid_baseline.train INFO: normal accuracy 0.7875647668393783 1.594372034072876 
2022-04-15 16:00:45,398 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 16:00:45,398 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 159.4%
2022-04-15 16:01:18,594 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.810, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 16:01:35,926 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 16:02:37,944 reid_baseline.train INFO: normal accuracy 0.7949988736201847 1.657145619392395 
2022-04-15 16:02:37,949 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 16:02:37,950 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 165.7%
2022-04-15 16:03:13,659 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.804, Acc: 0.994, Base Lr: 3.69e-03
2022-04-15 16:03:29,917 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 16:04:22,473 reid_baseline.train INFO: normal accuracy 0.7925208380265826 1.6796735525131226 
2022-04-15 16:04:22,478 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 16:04:22,478 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 168.0%
2022-04-15 16:04:56,289 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.800, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 16:05:12,322 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 16:06:15,118 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.6848561763763428 
2022-04-15 16:06:15,123 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 16:06:15,123 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 168.5%
2022-04-15 16:06:48,169 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.802, Acc: 0.994, Base Lr: 3.08e-03
2022-04-15 16:07:04,255 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 16:08:07,310 reid_baseline.train INFO: normal accuracy 0.7931966659157468 1.6660263538360596 
2022-04-15 16:08:07,315 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 16:08:07,315 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 166.6%
2022-04-15 16:08:41,103 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.800, Acc: 0.995, Base Lr: 2.77e-03
2022-04-15 16:08:57,061 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 16:10:00,190 reid_baseline.train INFO: normal accuracy 0.7925208380265826 1.6486057043075562 
2022-04-15 16:10:00,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 16:10:00,192 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 164.9%
2022-04-15 16:10:33,258 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.791, Acc: 0.995, Base Lr: 2.48e-03
2022-04-15 16:10:49,377 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 16:11:52,330 reid_baseline.train INFO: normal accuracy 0.7963505293985131 1.6635991334915161 
2022-04-15 16:11:52,334 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 16:11:52,335 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 166.4%
2022-04-15 16:12:26,449 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.993, Base Lr: 2.20e-03
2022-04-15 16:12:42,979 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.332[s] Speed: 48.3[samples/s]
2022-04-15 16:13:46,641 reid_baseline.train INFO: normal accuracy 0.7956747015093489 1.6900988817214966 
2022-04-15 16:13:46,643 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 16:13:46,644 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 169.0%
2022-04-15 16:14:19,508 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.995, Base Lr: 1.92e-03
2022-04-15 16:14:36,301 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.327[s] Speed: 49.0[samples/s]
2022-04-15 16:15:40,100 reid_baseline.train INFO: normal accuracy 0.7943230457310205 1.7025500535964966 
2022-04-15 16:15:40,104 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 16:15:40,104 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 170.3%
2022-04-15 16:16:13,196 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.790, Acc: 0.996, Base Lr: 1.66e-03
2022-04-15 16:16:30,285 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 16:17:33,211 reid_baseline.train INFO: normal accuracy 0.7952241495832395 1.7620753049850464 
2022-04-15 16:17:33,215 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 16:17:33,215 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 176.2%
2022-04-15 16:18:06,206 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.786, Acc: 0.995, Base Lr: 1.42e-03
2022-04-15 16:18:22,501 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.324[s] Speed: 49.4[samples/s]
2022-04-15 16:19:25,144 reid_baseline.train INFO: normal accuracy 0.7988285649921153 1.726593017578125 
2022-04-15 16:19:25,149 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 16:19:25,150 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 172.7%
2022-04-15 16:19:58,244 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.997, Base Lr: 1.19e-03
2022-04-15 16:20:15,224 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 16:21:18,616 reid_baseline.train INFO: normal accuracy 0.7963505293985131 1.691744327545166 
2022-04-15 16:21:18,620 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 16:21:18,620 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 169.2%
2022-04-15 16:21:51,188 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 16:22:08,201 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-15 16:23:04,036 reid_baseline.train INFO: normal accuracy 0.7981527371029511 1.70284104347229 
2022-04-15 16:23:04,041 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 16:23:04,041 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 170.3%
2022-04-15 16:23:37,547 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.784, Acc: 0.997, Base Lr: 7.78e-04
2022-04-15 16:23:54,524 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 16:24:56,456 reid_baseline.train INFO: normal accuracy 0.7970263572876775 1.7897424697875977 
2022-04-15 16:24:56,459 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 16:24:56,460 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 179.0%
2022-04-15 16:25:30,301 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.993, Base Lr: 6.04e-04
2022-04-15 16:25:47,339 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 16:26:48,587 reid_baseline.train INFO: normal accuracy 0.7983780130660059 1.7218248844146729 
2022-04-15 16:26:48,592 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 16:26:48,592 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 172.2%
2022-04-15 16:27:22,252 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 4.51e-04
2022-04-15 16:27:39,192 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 16:28:40,781 reid_baseline.train INFO: normal accuracy 0.7972516332507321 1.7815258502960205 
2022-04-15 16:28:40,785 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 16:28:40,786 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 178.2%
2022-04-15 16:29:15,350 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.993, Base Lr: 3.20e-04
2022-04-15 16:29:32,353 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 16:30:33,412 reid_baseline.train INFO: normal accuracy 0.7977021851768417 1.748969316482544 
2022-04-15 16:30:33,545 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 16:30:33,545 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 174.9%
2022-04-15 16:31:07,931 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.784, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 16:31:25,018 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.339[s] Speed: 47.3[samples/s]
2022-04-15 16:32:26,796 reid_baseline.train INFO: normal accuracy 0.7968010813246227 1.7062907218933105 
2022-04-15 16:32:26,797 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 16:32:26,797 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 170.6%
2022-04-15 16:33:00,579 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 16:33:17,561 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-15 16:34:19,313 reid_baseline.train INFO: normal accuracy 0.7958999774724037 1.7062095403671265 
2022-04-15 16:34:19,318 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 16:34:19,318 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 170.6%
2022-04-15 16:34:52,994 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.783, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 16:35:09,877 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.332[s] Speed: 48.1[samples/s]
2022-04-15 16:36:11,482 reid_baseline.train INFO: normal accuracy 0.7986032890290606 1.7721648216247559 
2022-04-15 16:36:11,487 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 16:36:11,487 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 177.2%
2022-04-15 16:36:45,759 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 2.83e-05
2022-04-15 16:37:02,729 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 16:38:04,476 reid_baseline.train INFO: normal accuracy 0.7965758053615679 1.7745985984802246 
2022-04-15 16:38:04,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 16:38:04,481 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 177.5%
2022-04-15 16:38:34,804 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.787, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 16:38:51,743 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.311[s] Speed: 51.5[samples/s]
2022-04-15 16:39:55,843 reid_baseline.train INFO: normal accuracy 0.7986032890290606 1.7313017845153809 
2022-04-15 16:39:55,847 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 16:39:55,847 reid_baseline.train INFO: Accuracy: 79.9% Mean Entropy: 173.1%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_2/transformer_best_model.pth
2022-04-15 16:40:58,278 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.5344291925430298 
2022-04-15 16:40:58,279 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:40:58,279 reid_baseline.train INFO: Accuracy: 78.2%
2022-04-15 16:41:59,159 reid_baseline.train INFO: normal accuracy 0.7823834196891192 1.5344291925430298 
2022-04-15 16:41:59,159 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:41:59,159 reid_baseline.train INFO: Shuffled Accuracy: 78.2%
2022-04-15 16:42:33,907 reid_baseline.train INFO: normal accuracy 0.9958796868562011 0.5656225681304932 
2022-04-15 16:42:33,907 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 16:42:33,907 reid_baseline.train INFO: Source Clean Accuracy: 99.6%
2022-04-15 16:42:38,252 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_2
2022-04-15 16:42:38,252 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_2', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=2, dom_cls=False)
2022-04-15 16:42:38,253 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 16:42:38,253 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 16:42:38,253 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_2
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 16:42:53,206 reid_baseline.train INFO: start training
2022-04-15 16:43:28,066 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.295, Base Lr: 4.76e-04
2022-04-15 16:43:46,162 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.345[s] Speed: 46.3[samples/s]
2022-04-15 16:44:48,517 reid_baseline.train INFO: normal accuracy 0.6020197383520771 4.172653675079346 
2022-04-15 16:44:49,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 16:44:49,365 reid_baseline.train INFO: Accuracy: 60.2% Mean Entropy: 417.3%
2022-04-15 16:45:23,776 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.894, Acc: 0.696, Base Lr: 8.72e-04
2022-04-15 16:45:41,703 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-15 16:46:43,423 reid_baseline.train INFO: normal accuracy 0.652742712875832 4.164033889770508 
2022-04-15 16:46:45,740 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 16:46:45,740 reid_baseline.train INFO: Accuracy: 65.3% Mean Entropy: 416.4%
2022-04-15 16:47:21,369 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.476, Acc: 0.733, Base Lr: 1.27e-03
2022-04-15 16:47:39,102 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.350[s] Speed: 45.8[samples/s]
2022-04-15 16:48:40,562 reid_baseline.train INFO: normal accuracy 0.665136561854487 4.1054887771606445 
2022-04-15 16:48:41,464 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 16:48:41,464 reid_baseline.train INFO: Accuracy: 66.5% Mean Entropy: 410.5%
2022-04-15 16:49:17,484 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.924, Acc: 0.727, Base Lr: 1.66e-03
2022-04-15 16:49:35,102 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-15 16:50:37,334 reid_baseline.train INFO: normal accuracy 0.6740876750057379 3.8641490936279297 
2022-04-15 16:50:39,552 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 16:50:39,552 reid_baseline.train INFO: Accuracy: 67.4% Mean Entropy: 386.4%
2022-04-15 16:51:15,371 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.301, Acc: 0.751, Base Lr: 2.06e-03
2022-04-15 16:51:32,457 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-15 16:52:35,785 reid_baseline.train INFO: normal accuracy 0.6963507000229515 3.350841522216797 
2022-04-15 16:52:38,076 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 16:52:38,076 reid_baseline.train INFO: Accuracy: 69.6% Mean Entropy: 335.1%
2022-04-15 16:53:13,815 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.838, Acc: 0.784, Base Lr: 2.46e-03
2022-04-15 16:53:30,566 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.345[s] Speed: 46.4[samples/s]
2022-04-15 16:54:32,626 reid_baseline.train INFO: normal accuracy 0.7463851273812256 2.8463728427886963 
2022-04-15 16:54:34,283 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 16:54:34,283 reid_baseline.train INFO: Accuracy: 74.6% Mean Entropy: 284.6%
2022-04-15 16:55:09,426 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.514, Acc: 0.843, Base Lr: 2.85e-03
2022-04-15 16:55:26,463 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.343[s] Speed: 46.6[samples/s]
2022-04-15 16:56:30,594 reid_baseline.train INFO: normal accuracy 0.7938948817994033 2.360643148422241 
2022-04-15 16:56:31,413 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 16:56:31,413 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 236.1%
2022-04-15 16:57:06,328 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.309, Acc: 0.883, Base Lr: 3.25e-03
2022-04-15 16:57:23,414 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 16:58:27,000 reid_baseline.train INFO: normal accuracy 0.81592839109479 1.9948331117630005 
2022-04-15 16:58:29,325 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 16:58:29,325 reid_baseline.train INFO: Accuracy: 81.6% Mean Entropy: 199.5%
2022-04-15 16:59:03,647 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.182, Acc: 0.908, Base Lr: 3.64e-03
2022-04-15 16:59:20,646 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.337[s] Speed: 47.4[samples/s]
2022-04-15 17:00:24,696 reid_baseline.train INFO: normal accuracy 0.8269451457424833 1.7263457775115967 
2022-04-15 17:00:25,626 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 17:00:25,626 reid_baseline.train INFO: Accuracy: 82.7% Mean Entropy: 172.6%
2022-04-15 17:01:00,058 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.926, Base Lr: 4.04e-03
2022-04-15 17:01:17,062 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 17:02:21,544 reid_baseline.train INFO: normal accuracy 0.8319944916226761 1.650579810142517 
2022-04-15 17:02:24,329 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 17:02:24,329 reid_baseline.train INFO: Accuracy: 83.2% Mean Entropy: 165.1%
2022-04-15 17:02:58,025 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.028, Acc: 0.941, Base Lr: 4.44e-03
2022-04-15 17:03:15,009 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.332[s] Speed: 48.2[samples/s]
2022-04-15 17:04:20,831 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.4656232595443726 
2022-04-15 17:04:22,947 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 17:04:22,947 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 146.6%
2022-04-15 17:04:56,880 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.976, Acc: 0.950, Base Lr: 4.83e-03
2022-04-15 17:05:13,818 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.334[s] Speed: 47.8[samples/s]
2022-04-15 17:06:18,912 reid_baseline.train INFO: normal accuracy 0.8400275418866192 1.4855780601501465 
2022-04-15 17:06:18,917 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 17:06:18,917 reid_baseline.train INFO: Accuracy: 84.0% Mean Entropy: 148.6%
2022-04-15 17:06:53,014 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.936, Acc: 0.965, Base Lr: 5.23e-03
2022-04-15 17:07:08,904 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 17:08:13,687 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.4896546602249146 
2022-04-15 17:08:13,692 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 17:08:13,692 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 149.0%
2022-04-15 17:08:47,721 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.903, Acc: 0.981, Base Lr: 5.62e-03
2022-04-15 17:09:03,917 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 17:10:05,959 reid_baseline.train INFO: normal accuracy 0.8425522148267156 1.4302189350128174 
2022-04-15 17:10:08,623 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 17:10:08,624 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 143.0%
2022-04-15 17:10:42,344 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.882, Acc: 0.980, Base Lr: 6.02e-03
2022-04-15 17:10:58,747 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.330[s] Speed: 48.5[samples/s]
2022-04-15 17:12:03,116 reid_baseline.train INFO: normal accuracy 0.8432407619921964 1.3659013509750366 
2022-04-15 17:12:04,047 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 17:12:04,047 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 136.6%
2022-04-15 17:12:38,140 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.857, Acc: 0.984, Base Lr: 6.42e-03
2022-04-15 17:12:54,840 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 17:13:58,560 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.375093936920166 
2022-04-15 17:13:58,565 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 17:13:58,565 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 137.5%
2022-04-15 17:14:31,770 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.842, Acc: 0.991, Base Lr: 6.81e-03
2022-04-15 17:14:49,311 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.334[s] Speed: 48.0[samples/s]
2022-04-15 17:15:53,802 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.4899451732635498 
2022-04-15 17:15:53,806 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 17:15:53,806 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 149.0%
2022-04-15 17:16:26,855 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.840, Acc: 0.989, Base Lr: 7.21e-03
2022-04-15 17:16:44,777 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.335[s] Speed: 47.7[samples/s]
2022-04-15 17:17:48,884 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.3186304569244385 
2022-04-15 17:17:49,860 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 17:17:49,861 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 131.9%
2022-04-15 17:18:21,098 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.825, Acc: 0.991, Base Lr: 7.60e-03
2022-04-15 17:18:39,022 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.323[s] Speed: 49.5[samples/s]
2022-04-15 17:19:43,760 reid_baseline.train INFO: normal accuracy 0.8448473720449851 1.396589994430542 
2022-04-15 17:19:43,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 17:19:43,765 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 139.7%
2022-04-15 17:20:18,838 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.810, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 17:20:36,463 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.345[s] Speed: 46.3[samples/s]
2022-04-15 17:21:42,097 reid_baseline.train INFO: normal accuracy 0.8393389947211384 1.4345691204071045 
2022-04-15 17:21:42,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 17:21:42,100 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 143.5%
2022-04-15 17:22:08,473 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.804, Acc: 0.994, Base Lr: 3.69e-03
2022-04-15 17:22:23,473 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.272[s] Speed: 58.9[samples/s]
2022-04-15 17:23:24,687 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.4656672477722168 
2022-04-15 17:23:24,691 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 17:23:24,692 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.6%
2022-04-15 17:24:00,375 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.800, Acc: 0.994, Base Lr: 3.38e-03
2022-04-15 17:24:16,678 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.341[s] Speed: 47.0[samples/s]
2022-04-15 17:25:18,013 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.4409005641937256 
2022-04-15 17:25:18,018 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 17:25:18,018 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 144.1%
2022-04-15 17:26:00,167 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.802, Acc: 0.994, Base Lr: 3.08e-03
2022-04-15 17:26:20,784 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.413[s] Speed: 38.8[samples/s]
2022-04-15 17:27:23,352 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.4366956949234009 
2022-04-15 17:27:23,357 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 17:27:23,357 reid_baseline.train INFO: Accuracy: 83.9% Mean Entropy: 143.7%
2022-04-15 17:27:58,887 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.800, Acc: 0.995, Base Lr: 2.77e-03
2022-04-15 17:28:15,496 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.343[s] Speed: 46.7[samples/s]
2022-04-15 17:29:16,395 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.416898488998413 
2022-04-15 17:29:16,399 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 24
2022-04-15 17:29:16,399 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 141.7%
2022-04-15 17:29:52,192 reid_baseline.train INFO: Epoch[25] Iteration[100/152] Loss: 0.791, Acc: 0.995, Base Lr: 2.48e-03
2022-04-15 17:30:08,269 reid_baseline.train INFO: Epoch 25 done. Time per batch: 0.341[s] Speed: 46.9[samples/s]
2022-04-15 17:31:08,842 reid_baseline.train INFO: normal accuracy 0.8436997934358503 1.4250507354736328 
2022-04-15 17:31:08,846 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 25
2022-04-15 17:31:08,847 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 142.5%
2022-04-15 17:31:44,657 reid_baseline.train INFO: Epoch[26] Iteration[100/152] Loss: 0.794, Acc: 0.993, Base Lr: 2.20e-03
2022-04-15 17:32:01,578 reid_baseline.train INFO: Epoch 26 done. Time per batch: 0.347[s] Speed: 46.2[samples/s]
2022-04-15 17:33:03,557 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4565800428390503 
2022-04-15 17:33:03,562 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 26
2022-04-15 17:33:03,562 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 145.7%
2022-04-15 17:33:39,447 reid_baseline.train INFO: Epoch[27] Iteration[100/152] Loss: 0.792, Acc: 0.995, Base Lr: 1.92e-03
2022-04-15 17:33:55,521 reid_baseline.train INFO: Epoch 27 done. Time per batch: 0.342[s] Speed: 46.8[samples/s]
2022-04-15 17:34:57,577 reid_baseline.train INFO: normal accuracy 0.8411751204957539 1.4656169414520264 
2022-04-15 17:34:57,581 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 27
2022-04-15 17:34:57,582 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 146.6%
2022-04-15 17:35:33,314 reid_baseline.train INFO: Epoch[28] Iteration[100/152] Loss: 0.790, Acc: 0.996, Base Lr: 1.66e-03
2022-04-15 17:35:49,885 reid_baseline.train INFO: Epoch 28 done. Time per batch: 0.344[s] Speed: 46.5[samples/s]
2022-04-15 17:36:50,762 reid_baseline.train INFO: normal accuracy 0.8443883406013312 1.5215346813201904 
2022-04-15 17:36:50,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 28
2022-04-15 17:36:50,767 reid_baseline.train INFO: Accuracy: 84.4% Mean Entropy: 152.2%
2022-04-15 17:37:26,342 reid_baseline.train INFO: Epoch[29] Iteration[100/152] Loss: 0.786, Acc: 0.995, Base Lr: 1.42e-03
2022-04-15 17:37:43,527 reid_baseline.train INFO: Epoch 29 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 17:38:44,400 reid_baseline.train INFO: normal accuracy 0.8457654349322928 1.481502890586853 
2022-04-15 17:38:44,405 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 29
2022-04-15 17:38:44,405 reid_baseline.train INFO: Accuracy: 84.6% Mean Entropy: 148.2%
2022-04-15 17:39:20,450 reid_baseline.train INFO: Epoch[30] Iteration[100/152] Loss: 0.786, Acc: 0.997, Base Lr: 1.19e-03
2022-04-15 17:39:38,310 reid_baseline.train INFO: Epoch 30 done. Time per batch: 0.354[s] Speed: 45.1[samples/s]
2022-04-15 17:40:39,998 reid_baseline.train INFO: normal accuracy 0.8448473720449851 1.4406167268753052 
2022-04-15 17:40:40,000 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 30
2022-04-15 17:40:40,000 reid_baseline.train INFO: Accuracy: 84.5% Mean Entropy: 144.1%
2022-04-15 17:41:15,745 reid_baseline.train INFO: Epoch[31] Iteration[100/152] Loss: 0.784, Acc: 0.998, Base Lr: 9.72e-04
2022-04-15 17:41:33,487 reid_baseline.train INFO: Epoch 31 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-15 17:42:34,509 reid_baseline.train INFO: normal accuracy 0.8407160890521 1.4441410303115845 
2022-04-15 17:42:34,512 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 31
2022-04-15 17:42:34,512 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 144.4%
2022-04-15 17:43:10,338 reid_baseline.train INFO: Epoch[32] Iteration[100/152] Loss: 0.784, Acc: 0.997, Base Lr: 7.78e-04
2022-04-15 17:43:28,269 reid_baseline.train INFO: Epoch 32 done. Time per batch: 0.352[s] Speed: 45.5[samples/s]
2022-04-15 17:44:30,098 reid_baseline.train INFO: normal accuracy 0.8418636676612348 1.5342520475387573 
2022-04-15 17:44:30,100 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 32
2022-04-15 17:44:30,101 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 153.4%
2022-04-15 17:45:05,397 reid_baseline.train INFO: Epoch[33] Iteration[100/152] Loss: 0.786, Acc: 0.993, Base Lr: 6.04e-04
2022-04-15 17:45:23,231 reid_baseline.train INFO: Epoch 33 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-15 17:46:25,018 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4732880592346191 
2022-04-15 17:46:25,021 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 33
2022-04-15 17:46:25,021 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 147.3%
2022-04-15 17:47:00,026 reid_baseline.train INFO: Epoch[34] Iteration[100/152] Loss: 0.786, Acc: 0.996, Base Lr: 4.51e-04
2022-04-15 17:47:17,816 reid_baseline.train INFO: Epoch 34 done. Time per batch: 0.347[s] Speed: 46.1[samples/s]
2022-04-15 17:48:19,562 reid_baseline.train INFO: normal accuracy 0.8411751204957539 1.5321861505508423 
2022-04-15 17:48:19,564 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 34
2022-04-15 17:48:19,565 reid_baseline.train INFO: Accuracy: 84.1% Mean Entropy: 153.2%
2022-04-15 17:48:54,618 reid_baseline.train INFO: Epoch[35] Iteration[100/152] Loss: 0.784, Acc: 0.993, Base Lr: 3.20e-04
2022-04-15 17:49:12,520 reid_baseline.train INFO: Epoch 35 done. Time per batch: 0.348[s] Speed: 46.0[samples/s]
2022-04-15 17:50:13,694 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.5020122528076172 
2022-04-15 17:50:13,696 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 35
2022-04-15 17:50:13,697 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 150.2%
2022-04-15 17:50:48,922 reid_baseline.train INFO: Epoch[36] Iteration[100/152] Loss: 0.784, Acc: 0.996, Base Lr: 2.11e-04
2022-04-15 17:51:06,768 reid_baseline.train INFO: Epoch 36 done. Time per batch: 0.349[s] Speed: 45.9[samples/s]
2022-04-15 17:52:08,320 reid_baseline.train INFO: normal accuracy 0.8423226991048887 1.46135413646698 
2022-04-15 17:52:08,323 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 36
2022-04-15 17:52:08,323 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.1%
2022-04-15 17:52:42,084 reid_baseline.train INFO: Epoch[37] Iteration[100/152] Loss: 0.783, Acc: 0.998, Base Lr: 1.26e-04
2022-04-15 17:52:59,952 reid_baseline.train INFO: Epoch 37 done. Time per batch: 0.339[s] Speed: 47.1[samples/s]
2022-04-15 17:54:01,852 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.461733102798462 
2022-04-15 17:54:01,855 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 37
2022-04-15 17:54:01,855 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 146.2%
2022-04-15 17:54:35,293 reid_baseline.train INFO: Epoch[38] Iteration[100/152] Loss: 0.783, Acc: 0.994, Base Lr: 6.51e-05
2022-04-15 17:54:53,236 reid_baseline.train INFO: Epoch 38 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-15 17:55:55,332 reid_baseline.train INFO: normal accuracy 0.8420931833830617 1.5196589231491089 
2022-04-15 17:55:55,337 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 38
2022-04-15 17:55:55,337 reid_baseline.train INFO: Accuracy: 84.2% Mean Entropy: 152.0%
2022-04-15 17:56:28,340 reid_baseline.train INFO: Epoch[39] Iteration[100/152] Loss: 0.785, Acc: 0.994, Base Lr: 2.83e-05
2022-04-15 17:56:46,111 reid_baseline.train INFO: Epoch 39 done. Time per batch: 0.334[s] Speed: 47.9[samples/s]
2022-04-15 17:57:47,962 reid_baseline.train INFO: normal accuracy 0.8434702777140234 1.523301362991333 
2022-04-15 17:57:47,966 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 39
2022-04-15 17:57:47,967 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 152.3%
2022-04-15 17:58:20,021 reid_baseline.train INFO: Epoch[40] Iteration[100/152] Loss: 0.787, Acc: 0.994, Base Lr: 1.60e-05
2022-04-15 17:58:37,942 reid_baseline.train INFO: Epoch 40 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 17:59:41,479 reid_baseline.train INFO: normal accuracy 0.8427817305485426 1.4879487752914429 
2022-04-15 17:59:41,481 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 40
2022-04-15 17:59:41,482 reid_baseline.train INFO: Accuracy: 84.3% Mean Entropy: 148.8%
Loading pretrained model for finetuning from ../logs/pretrain/deit_base/office-home/Art_2_Real_World_shuffled_key_2/transformer_best_model.pth
2022-04-15 18:00:47,502 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.3186304569244385 
2022-04-15 18:00:47,502 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:00:47,503 reid_baseline.train INFO: Accuracy: 83.9%
2022-04-15 18:01:47,149 reid_baseline.train INFO: normal accuracy 0.8388799632774845 1.3186304569244385 
2022-04-15 18:01:47,150 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:01:47,150 reid_baseline.train INFO: Shuffled Accuracy: 83.9%
2022-04-15 18:02:24,117 reid_baseline.train INFO: normal accuracy 0.9958796868562011 0.5656225681304932 
2022-04-15 18:02:24,117 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-04-15 18:02:24,117 reid_baseline.train INFO: Source Clean Accuracy: 99.6%
2022-04-15 18:02:28,564 reid_baseline INFO: Saving model in the path :../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_3
2022-04-15 18:02:28,564 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_3', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Art.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=3, dom_cls=False)
2022-04-15 18:02:28,564 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-04-15 18:02:28,564 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 40
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 20
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-04-15 18:02:28,564 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../logs/pretrain/deit_base/office-home/Art_2_Product_shuffled_key_3
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 40
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 20
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Art and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     2427 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
pretrain train
2022-04-15 18:02:42,509 reid_baseline.train INFO: start training
2022-04-15 18:03:17,401 reid_baseline.train INFO: Epoch[1] Iteration[100/152] Loss: 4.128, Acc: 0.289, Base Lr: 4.76e-04
2022-04-15 18:03:33,243 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 18:04:37,074 reid_baseline.train INFO: normal accuracy 0.5244424419914395 4.172751426696777 
2022-04-15 18:04:37,918 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-04-15 18:04:37,918 reid_baseline.train INFO: Accuracy: 52.4% Mean Entropy: 417.3%
2022-04-15 18:05:10,356 reid_baseline.train INFO: Epoch[2] Iteration[100/152] Loss: 3.895, Acc: 0.697, Base Lr: 8.72e-04
2022-04-15 18:05:26,401 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.319[s] Speed: 50.2[samples/s]
2022-04-15 18:06:30,157 reid_baseline.train INFO: normal accuracy 0.5812119846812345 4.166337013244629 
2022-04-15 18:06:31,964 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-04-15 18:06:31,965 reid_baseline.train INFO: Accuracy: 58.1% Mean Entropy: 416.6%
2022-04-15 18:07:05,764 reid_baseline.train INFO: Epoch[3] Iteration[100/152] Loss: 3.475, Acc: 0.739, Base Lr: 1.27e-03
2022-04-15 18:07:21,964 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 18:08:25,816 reid_baseline.train INFO: normal accuracy 0.5936021626492454 4.128256797790527 
2022-04-15 18:08:26,697 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-04-15 18:08:26,698 reid_baseline.train INFO: Accuracy: 59.4% Mean Entropy: 412.8%
2022-04-15 18:09:00,447 reid_baseline.train INFO: Epoch[4] Iteration[100/152] Loss: 2.924, Acc: 0.737, Base Lr: 1.66e-03
2022-04-15 18:09:16,999 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 18:10:20,430 reid_baseline.train INFO: normal accuracy 0.5967560261320117 3.963564157485962 
2022-04-15 18:10:21,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-04-15 18:10:21,365 reid_baseline.train INFO: Accuracy: 59.7% Mean Entropy: 396.4%
2022-04-15 18:10:54,954 reid_baseline.train INFO: Epoch[5] Iteration[100/152] Loss: 2.304, Acc: 0.748, Base Lr: 2.06e-03
2022-04-15 18:11:12,066 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 18:12:13,874 reid_baseline.train INFO: normal accuracy 0.6240144176616355 3.5600645542144775 
2022-04-15 18:12:14,743 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-04-15 18:12:14,743 reid_baseline.train INFO: Accuracy: 62.4% Mean Entropy: 356.0%
2022-04-15 18:12:47,524 reid_baseline.train INFO: Epoch[6] Iteration[100/152] Loss: 1.843, Acc: 0.793, Base Lr: 2.46e-03
2022-04-15 18:13:04,614 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.327[s] Speed: 48.9[samples/s]
2022-04-15 18:14:05,726 reid_baseline.train INFO: normal accuracy 0.680333408425321 3.099860191345215 
2022-04-15 18:14:06,598 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-04-15 18:14:06,598 reid_baseline.train INFO: Accuracy: 68.0% Mean Entropy: 310.0%
2022-04-15 18:14:40,332 reid_baseline.train INFO: Epoch[7] Iteration[100/152] Loss: 1.517, Acc: 0.847, Base Lr: 2.85e-03
2022-04-15 18:14:57,439 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.333[s] Speed: 48.0[samples/s]
2022-04-15 18:15:58,742 reid_baseline.train INFO: normal accuracy 0.7409326424870466 2.6385395526885986 
2022-04-15 18:15:59,659 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-04-15 18:15:59,659 reid_baseline.train INFO: Accuracy: 74.1% Mean Entropy: 263.9%
2022-04-15 18:16:32,230 reid_baseline.train INFO: Epoch[8] Iteration[100/152] Loss: 1.296, Acc: 0.892, Base Lr: 3.25e-03
2022-04-15 18:16:49,194 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.326[s] Speed: 49.1[samples/s]
2022-04-15 18:17:50,486 reid_baseline.train INFO: normal accuracy 0.7636855147555756 2.250964641571045 
2022-04-15 18:17:51,393 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-04-15 18:17:51,393 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 225.1%
2022-04-15 18:18:25,023 reid_baseline.train INFO: Epoch[9] Iteration[100/152] Loss: 1.186, Acc: 0.912, Base Lr: 3.64e-03
2022-04-15 18:18:42,101 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.333[s] Speed: 48.1[samples/s]
2022-04-15 18:19:41,896 reid_baseline.train INFO: normal accuracy 0.7803559360216265 1.9695916175842285 
2022-04-15 18:19:42,898 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-04-15 18:19:42,898 reid_baseline.train INFO: Accuracy: 78.0% Mean Entropy: 197.0%
2022-04-15 18:20:16,956 reid_baseline.train INFO: Epoch[10] Iteration[100/152] Loss: 1.078, Acc: 0.929, Base Lr: 4.04e-03
2022-04-15 18:20:32,929 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 18:21:36,856 reid_baseline.train INFO: normal accuracy 0.7832845235413382 1.888083577156067 
2022-04-15 18:21:39,310 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-04-15 18:21:39,310 reid_baseline.train INFO: Accuracy: 78.3% Mean Entropy: 188.8%
2022-04-15 18:22:13,219 reid_baseline.train INFO: Epoch[11] Iteration[100/152] Loss: 1.019, Acc: 0.943, Base Lr: 4.44e-03
2022-04-15 18:22:30,258 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.335[s] Speed: 47.8[samples/s]
2022-04-15 18:23:31,073 reid_baseline.train INFO: normal accuracy 0.7891416985807614 1.6984004974365234 
2022-04-15 18:23:31,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-04-15 18:23:31,993 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 169.8%
2022-04-15 18:24:05,936 reid_baseline.train INFO: Epoch[12] Iteration[100/152] Loss: 0.980, Acc: 0.952, Base Lr: 4.83e-03
2022-04-15 18:24:21,317 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.324[s] Speed: 49.3[samples/s]
2022-04-15 18:25:22,026 reid_baseline.train INFO: normal accuracy 0.7889164226177067 1.672292709350586 
2022-04-15 18:25:23,046 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-04-15 18:25:23,047 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 167.2%
2022-04-15 18:25:57,049 reid_baseline.train INFO: Epoch[13] Iteration[100/152] Loss: 0.937, Acc: 0.965, Base Lr: 5.23e-03
2022-04-15 18:26:14,092 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.336[s] Speed: 47.7[samples/s]
2022-04-15 18:27:14,872 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.7138441801071167 
2022-04-15 18:27:14,877 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-04-15 18:27:14,877 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 171.4%
2022-04-15 18:27:49,086 reid_baseline.train INFO: Epoch[14] Iteration[100/152] Loss: 0.904, Acc: 0.977, Base Lr: 5.62e-03
2022-04-15 18:28:06,116 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.337[s] Speed: 47.5[samples/s]
2022-04-15 18:29:05,992 reid_baseline.train INFO: normal accuracy 0.792070286100473 1.6899014711380005 
2022-04-15 18:29:05,997 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-04-15 18:29:05,997 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.0%
2022-04-15 18:29:40,304 reid_baseline.train INFO: Epoch[15] Iteration[100/152] Loss: 0.881, Acc: 0.982, Base Lr: 6.02e-03
2022-04-15 18:29:57,355 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-15 18:30:57,960 reid_baseline.train INFO: normal accuracy 0.7952241495832395 1.565873384475708 
2022-04-15 18:31:00,400 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-04-15 18:31:00,401 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 156.6%
2022-04-15 18:31:34,894 reid_baseline.train INFO: Epoch[16] Iteration[100/152] Loss: 0.859, Acc: 0.988, Base Lr: 6.42e-03
2022-04-15 18:31:51,880 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.338[s] Speed: 47.4[samples/s]
2022-04-15 18:32:49,131 reid_baseline.train INFO: normal accuracy 0.7904933543590899 1.5437803268432617 
2022-04-15 18:32:50,848 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-04-15 18:32:50,848 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 154.4%
2022-04-15 18:33:25,372 reid_baseline.train INFO: Epoch[17] Iteration[100/152] Loss: 0.842, Acc: 0.991, Base Lr: 6.81e-03
2022-04-15 18:33:42,402 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 18:34:42,975 reid_baseline.train INFO: normal accuracy 0.7918450101374184 1.6778301000595093 
2022-04-15 18:34:42,978 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-04-15 18:34:42,978 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 167.8%
2022-04-15 18:35:17,549 reid_baseline.train INFO: Epoch[18] Iteration[100/152] Loss: 0.840, Acc: 0.987, Base Lr: 7.21e-03
2022-04-15 18:35:34,491 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 18:36:33,707 reid_baseline.train INFO: normal accuracy 0.7882405947285425 1.5682651996612549 
2022-04-15 18:36:33,711 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-04-15 18:36:33,712 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 156.8%
2022-04-15 18:37:08,185 reid_baseline.train INFO: Epoch[19] Iteration[100/152] Loss: 0.824, Acc: 0.991, Base Lr: 7.60e-03
2022-04-15 18:37:25,261 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.339[s] Speed: 47.2[samples/s]
2022-04-15 18:38:25,156 reid_baseline.train INFO: normal accuracy 0.7893669745438162 1.6061651706695557 
2022-04-15 18:38:25,161 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-04-15 18:38:25,161 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 160.6%
2022-04-15 18:38:59,138 reid_baseline.train INFO: Epoch[20] Iteration[100/152] Loss: 0.809, Acc: 0.994, Base Lr: 4.01e-03
2022-04-15 18:39:15,283 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.329[s] Speed: 48.6[samples/s]
2022-04-15 18:40:17,915 reid_baseline.train INFO: normal accuracy 0.7909439062851994 1.642980933189392 
2022-04-15 18:40:17,919 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-04-15 18:40:17,920 reid_baseline.train INFO: Accuracy: 79.1% Mean Entropy: 164.3%
2022-04-15 18:40:53,124 reid_baseline.train INFO: Epoch[21] Iteration[100/152] Loss: 0.803, Acc: 0.994, Base Lr: 3.69e-03
2022-04-15 18:41:09,314 reid_baseline.train INFO: Epoch 21 done. Time per batch: 0.338[s] Speed: 47.3[samples/s]
2022-04-15 18:42:02,358 reid_baseline.train INFO: normal accuracy 0.793872493804911 1.7055530548095703 
2022-04-15 18:42:02,360 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 21
2022-04-15 18:42:02,360 reid_baseline.train INFO: Accuracy: 79.4% Mean Entropy: 170.6%
2022-04-15 18:42:36,397 reid_baseline.train INFO: Epoch[22] Iteration[100/152] Loss: 0.799, Acc: 0.995, Base Lr: 3.38e-03
2022-04-15 18:42:52,489 reid_baseline.train INFO: Epoch 22 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 18:43:55,439 reid_baseline.train INFO: normal accuracy 0.7949988736201847 1.6827892065048218 
2022-04-15 18:43:55,442 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 22
2022-04-15 18:43:55,442 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 168.3%
2022-04-15 18:44:28,546 reid_baseline.train INFO: Epoch[23] Iteration[100/152] Loss: 0.801, Acc: 0.993, Base Lr: 3.08e-03
2022-04-15 18:44:44,666 reid_baseline.train INFO: Epoch 23 done. Time per batch: 0.324[s] Speed: 49.5[samples/s]
2022-04-15 18:45:47,542 reid_baseline.train INFO: normal accuracy 0.7974769092137869 1.7002930641174316 
2022-04-15 18:45:47,545 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 23
2022-04-15 18:45:47,545 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 170.0%
2022-04-15 18:46:21,246 reid_baseline.train INFO: Epoch[24] Iteration[100/152] Loss: 0.796, Acc: 0.995, Base Lr: 2.77e-03
2022-04-15 18:46:37,496 reid_baseline.train INFO: Epoch 24 done. Time per batch: 0.329[s] Speed: 48.7[samples/s]
2022-04-15 18:47:39,450 reid_baseline.train INFO: normal accuracy 0.7961252534354585 1.6677848100662231 
2022-04-15 18:47:39,452 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Ep