2022-05-03 15:12:35,788 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_Cls_token
2022-05-03 15:12:35,788 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_Cls_token', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Art.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 15:12:35,788 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 15:12:35,788 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 15:12:35,789 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Art.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_Cls_token
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Art
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     2427 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 15:12:55,772 reid_baseline.train INFO: start training
2022-05-03 15:14:23,786 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.135, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 15:15:38,291 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.085, Acc: 0.190, Base Lr: 8.72e-04
2022-05-03 15:16:28,812 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.774[s] Speed: 20.7[samples/s]
2022-05-03 15:18:05,275 reid_baseline.train INFO: normal accuracy 0.45323444581788214 4.169195175170898 
2022-05-03 15:18:06,446 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 15:18:06,446 reid_baseline.train INFO: Accuracy: 45.3% Mean Entropy: 416.9%
2022-05-03 15:19:22,982 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.786, Acc: 0.463, Base Lr: 1.66e-03
2022-05-03 15:20:31,644 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.687, Acc: 0.461, Base Lr: 1.66e-03
2022-05-03 15:21:19,964 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.709[s] Speed: 22.6[samples/s]
2022-05-03 15:23:03,510 reid_baseline.train INFO: normal accuracy 0.5348166460651009 4.121193885803223 
2022-05-03 15:23:04,884 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 15:23:04,885 reid_baseline.train INFO: Accuracy: 53.5% Mean Entropy: 412.1%
2022-05-03 15:24:26,363 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.075, Acc: 0.549, Base Lr: 2.46e-03
2022-05-03 15:25:36,471 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.921, Acc: 0.558, Base Lr: 2.46e-03
2022-05-03 15:26:23,679 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.728[s] Speed: 22.0[samples/s]
2022-05-03 15:28:03,072 reid_baseline.train INFO: normal accuracy 0.5916769674495261 3.733510732650757 
2022-05-03 15:28:03,991 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 15:28:03,996 reid_baseline.train INFO: Accuracy: 59.2% Mean Entropy: 373.4%
2022-05-03 15:29:25,236 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.270, Acc: 0.649, Base Lr: 3.25e-03
2022-05-03 15:30:42,160 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.171, Acc: 0.656, Base Lr: 3.25e-03
2022-05-03 15:31:33,371 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.767[s] Speed: 20.9[samples/s]
2022-05-03 15:33:07,613 reid_baseline.train INFO: normal accuracy 0.6501854140914709 3.1285219192504883 
2022-05-03 15:33:08,818 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 15:33:08,818 reid_baseline.train INFO: Accuracy: 65.0% Mean Entropy: 312.9%
2022-05-03 15:34:21,885 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.791, Acc: 0.731, Base Lr: 4.04e-03
2022-05-03 15:35:31,640 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.737, Acc: 0.742, Base Lr: 4.04e-03
2022-05-03 15:36:27,279 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.726[s] Speed: 22.0[samples/s]
2022-05-03 15:38:12,037 reid_baseline.train INFO: normal accuracy 0.6975690152451587 2.6837780475616455 
2022-05-03 15:38:13,179 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 15:38:13,180 reid_baseline.train INFO: Accuracy: 69.8% Mean Entropy: 268.4%
2022-05-03 15:39:15,625 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.545, Acc: 0.770, Base Lr: 4.83e-03
2022-05-03 15:40:27,897 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.514, Acc: 0.781, Base Lr: 4.83e-03
2022-05-03 15:41:19,227 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.681[s] Speed: 23.5[samples/s]
2022-05-03 15:42:53,379 reid_baseline.train INFO: normal accuracy 0.7140502678203543 2.418840169906616 
2022-05-03 15:42:54,338 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 15:42:54,339 reid_baseline.train INFO: Accuracy: 71.4% Mean Entropy: 241.9%
2022-05-03 15:44:17,455 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.401, Acc: 0.818, Base Lr: 5.62e-03
2022-05-03 15:45:27,081 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.399, Acc: 0.812, Base Lr: 5.62e-03
2022-05-03 15:46:15,572 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.737[s] Speed: 21.7[samples/s]
2022-05-03 15:47:43,033 reid_baseline.train INFO: normal accuracy 0.7264112072517511 2.238590955734253 
2022-05-03 15:47:43,903 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 15:47:43,903 reid_baseline.train INFO: Accuracy: 72.6% Mean Entropy: 223.9%
2022-05-03 15:48:55,967 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.299, Acc: 0.849, Base Lr: 6.42e-03
2022-05-03 15:50:07,953 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.278, Acc: 0.852, Base Lr: 6.42e-03
2022-05-03 15:51:01,650 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.724[s] Speed: 22.1[samples/s]
2022-05-03 15:52:46,955 reid_baseline.train INFO: normal accuracy 0.7280593325092707 2.085941791534424 
2022-05-03 15:52:48,155 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 15:52:48,156 reid_baseline.train INFO: Accuracy: 72.8% Mean Entropy: 208.6%
2022-05-03 15:53:59,201 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.186, Acc: 0.884, Base Lr: 7.21e-03
2022-05-03 15:55:03,198 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.225, Acc: 0.866, Base Lr: 7.21e-03
2022-05-03 15:55:47,825 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.658[s] Speed: 24.3[samples/s]
2022-05-03 15:57:23,686 reid_baseline.train INFO: normal accuracy 0.7330037082818294 1.9353842735290527 
2022-05-03 15:57:24,766 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 15:57:24,766 reid_baseline.train INFO: Accuracy: 73.3% Mean Entropy: 193.5%
2022-05-03 15:58:49,490 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.154, Acc: 0.887, Base Lr: 4.01e-03
2022-05-03 16:00:00,325 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.161, Acc: 0.885, Base Lr: 4.01e-03
2022-05-03 16:00:43,939 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.730[s] Speed: 21.9[samples/s]
2022-05-03 16:02:21,822 reid_baseline.train INFO: normal accuracy 0.7317676143386898 1.972459316253662 
2022-05-03 16:02:21,823 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 16:02:21,823 reid_baseline.train INFO: Accuracy: 73.2% Mean Entropy: 197.2%
2022-05-03 16:03:33,742 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.109, Acc: 0.904, Base Lr: 3.38e-03
2022-05-03 16:04:40,896 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.112, Acc: 0.899, Base Lr: 3.38e-03
2022-05-03 16:05:30,080 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.689[s] Speed: 23.2[samples/s]
2022-05-03 16:07:11,872 reid_baseline.train INFO: normal accuracy 0.734651833539349 1.8954449892044067 
2022-05-03 16:07:12,898 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 16:07:12,898 reid_baseline.train INFO: Accuracy: 73.5% Mean Entropy: 189.5%
2022-05-03 16:08:25,881 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.090, Acc: 0.905, Base Lr: 2.77e-03
2022-05-03 16:09:29,819 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.105, Acc: 0.902, Base Lr: 2.77e-03
2022-05-03 16:10:17,549 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.676[s] Speed: 23.7[samples/s]
2022-05-03 16:12:04,898 reid_baseline.train INFO: normal accuracy 0.738360115368768 1.8530192375183105 
2022-05-03 16:12:05,999 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 16:12:05,999 reid_baseline.train INFO: Accuracy: 73.8% Mean Entropy: 185.3%
2022-05-03 16:13:19,758 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.090, Acc: 0.905, Base Lr: 2.20e-03
2022-05-03 16:14:25,106 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.072, Acc: 0.913, Base Lr: 2.20e-03
2022-05-03 16:15:16,445 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.697[s] Speed: 23.0[samples/s]
2022-05-03 16:16:44,788 reid_baseline.train INFO: normal accuracy 0.7424804285125669 1.8817698955535889 
2022-05-03 16:16:44,789 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 16:16:44,789 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 188.2%
2022-05-03 16:18:00,210 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.064, Acc: 0.915, Base Lr: 1.66e-03
2022-05-03 16:19:12,158 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.075, Acc: 0.913, Base Lr: 1.66e-03
2022-05-03 16:20:05,782 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.736[s] Speed: 21.8[samples/s]
2022-05-03 16:21:48,305 reid_baseline.train INFO: normal accuracy 0.7441285537700866 1.8540724515914917 
2022-05-03 16:21:48,306 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 16:21:48,306 reid_baseline.train INFO: Accuracy: 74.4% Mean Entropy: 185.4%
2022-05-03 16:22:55,713 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.047, Acc: 0.922, Base Lr: 1.19e-03
2022-05-03 16:24:07,208 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.042, Acc: 0.923, Base Lr: 1.19e-03
2022-05-03 16:25:01,513 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.707[s] Speed: 22.6[samples/s]
2022-05-03 16:26:47,359 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.9440816640853882 
2022-05-03 16:26:47,365 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 16:26:47,366 reid_baseline.train INFO: Accuracy: 74.3% Mean Entropy: 194.4%
2022-05-03 16:28:39,008 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.038, Acc: 0.925, Base Lr: 7.78e-04
2022-05-03 16:30:11,541 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.045, Acc: 0.918, Base Lr: 7.78e-04
2022-05-03 16:31:11,284 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.966[s] Speed: 16.6[samples/s]
2022-05-03 16:32:54,225 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8905127048492432 
2022-05-03 16:32:54,227 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 16:32:54,228 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 189.1%
2022-05-03 16:34:52,321 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.048, Acc: 0.921, Base Lr: 4.51e-04
2022-05-03 16:36:43,770 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.040, Acc: 0.923, Base Lr: 4.51e-04
2022-05-03 16:37:48,859 reid_baseline.train INFO: Epoch 17 done. Time per batch: 1.079[s] Speed: 14.8[samples/s]
2022-05-03 16:39:50,701 reid_baseline.train INFO: normal accuracy 0.7453646477132262 1.838099479675293 
2022-05-03 16:39:52,055 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 16:39:52,057 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 183.8%
2022-05-03 16:41:40,205 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.048, Acc: 0.923, Base Lr: 2.11e-04
2022-05-03 16:43:30,151 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.039, Acc: 0.925, Base Lr: 2.11e-04
2022-05-03 16:44:34,790 reid_baseline.train INFO: Epoch 18 done. Time per batch: 1.036[s] Speed: 15.4[samples/s]
2022-05-03 16:46:12,935 reid_baseline.train INFO: normal accuracy 0.7416563658838071 1.8614816665649414 
2022-05-03 16:46:12,936 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 16:46:12,936 reid_baseline.train INFO: Accuracy: 74.2% Mean Entropy: 186.1%
2022-05-03 16:48:06,671 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.051, Acc: 0.919, Base Lr: 6.51e-05
2022-05-03 16:50:00,930 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.046, Acc: 0.922, Base Lr: 6.51e-05
2022-05-03 16:51:00,709 reid_baseline.train INFO: Epoch 19 done. Time per batch: 1.054[s] Speed: 15.2[samples/s]
2022-05-03 16:52:42,073 reid_baseline.train INFO: normal accuracy 0.7400082406262876 1.8316545486450195 
2022-05-03 16:52:43,203 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 16:52:43,204 reid_baseline.train INFO: Accuracy: 74.0% Mean Entropy: 183.2%
2022-05-03 16:54:34,201 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.066, Acc: 0.911, Base Lr: 1.60e-05
2022-05-03 16:56:24,034 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.052, Acc: 0.919, Base Lr: 1.60e-05
2022-05-03 16:57:31,739 reid_baseline.train INFO: Epoch 20 done. Time per batch: 1.057[s] Speed: 15.1[samples/s]
2022-05-03 16:59:37,278 reid_baseline.train INFO: normal accuracy 0.7449526163988464 1.8675254583358765 
2022-05-03 16:59:37,278 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 16:59:37,278 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 186.8%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Art_Key_AugCl_Cls_token/transformer_best_model.pth
2022-05-03 17:01:54,065 reid_baseline.train INFO: normal accuracy 0.7395962093119077 1.8316723108291626 
2022-05-03 17:01:54,067 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 17:01:54,068 reid_baseline.train INFO: Accuracy: 74.0%
2022-05-03 17:03:52,201 reid_baseline.train INFO: normal accuracy 0.7433044911413268 1.8324412107467651 
2022-05-03 17:03:52,202 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 17:03:52,202 reid_baseline.train INFO: Shuffled Accuracy: 74.3%
2022-05-03 17:06:11,944 reid_baseline.train INFO: normal accuracy 0.9523482245131729 0.8261708617210388 
2022-05-03 17:06:11,945 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 17:06:11,945 reid_baseline.train INFO: Source Clean Accuracy: 95.2%
2022-05-03 17:06:20,789 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_Cls_token
2022-05-03 17:06:20,790 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_Cls_token', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Product.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 17:06:20,790 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 17:06:20,790 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 17:06:20,790 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Product.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_Cls_token
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Product
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4439 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 17:06:37,053 reid_baseline.train INFO: start training
2022-05-03 17:08:04,703 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.135, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 17:09:17,730 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.085, Acc: 0.190, Base Lr: 8.72e-04
2022-05-03 17:10:11,325 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.778[s] Speed: 20.6[samples/s]
2022-05-03 17:12:10,064 reid_baseline.train INFO: normal accuracy 0.49628294660959676 4.168323993682861 
2022-05-03 17:12:10,953 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 17:12:10,953 reid_baseline.train INFO: Accuracy: 49.6% Mean Entropy: 416.8%
2022-05-03 17:13:22,341 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.787, Acc: 0.457, Base Lr: 1.66e-03
2022-05-03 17:14:31,384 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.686, Acc: 0.461, Base Lr: 1.66e-03
2022-05-03 17:15:19,582 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.691[s] Speed: 23.2[samples/s]
2022-05-03 17:17:04,013 reid_baseline.train INFO: normal accuracy 0.5553052489299392 4.09879207611084 
2022-05-03 17:17:05,017 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 17:17:05,017 reid_baseline.train INFO: Accuracy: 55.5% Mean Entropy: 409.9%
2022-05-03 17:18:06,508 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.075, Acc: 0.553, Base Lr: 2.46e-03
2022-05-03 17:19:00,155 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.921, Acc: 0.562, Base Lr: 2.46e-03
2022-05-03 17:19:38,446 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.562[s] Speed: 28.5[samples/s]
2022-05-03 17:21:08,115 reid_baseline.train INFO: normal accuracy 0.6071187204325299 3.607755184173584 
2022-05-03 17:21:08,970 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 17:21:08,970 reid_baseline.train INFO: Accuracy: 60.7% Mean Entropy: 360.8%
2022-05-03 17:22:19,405 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.270, Acc: 0.648, Base Lr: 3.25e-03
2022-05-03 17:23:20,708 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.164, Acc: 0.656, Base Lr: 3.25e-03
2022-05-03 17:24:01,836 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.633[s] Speed: 25.3[samples/s]
2022-05-03 17:25:35,646 reid_baseline.train INFO: normal accuracy 0.6823608920928137 2.894512176513672 
2022-05-03 17:25:36,867 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 17:25:36,868 reid_baseline.train INFO: Accuracy: 68.2% Mean Entropy: 289.5%
2022-05-03 17:26:40,345 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.796, Acc: 0.728, Base Lr: 4.04e-03
2022-05-03 17:27:37,930 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.741, Acc: 0.738, Base Lr: 4.04e-03
2022-05-03 17:28:26,264 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.620[s] Speed: 25.8[samples/s]
2022-05-03 17:29:56,139 reid_baseline.train INFO: normal accuracy 0.7262897048884884 2.41056489944458 
2022-05-03 17:29:57,052 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 17:29:57,052 reid_baseline.train INFO: Accuracy: 72.6% Mean Entropy: 241.1%
2022-05-03 17:31:00,740 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.559, Acc: 0.763, Base Lr: 4.83e-03
2022-05-03 17:31:55,947 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.522, Acc: 0.777, Base Lr: 4.83e-03
2022-05-03 17:32:35,763 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.581[s] Speed: 27.5[samples/s]
2022-05-03 17:34:14,800 reid_baseline.train INFO: normal accuracy 0.7337238116692949 2.151296377182007 
2022-05-03 17:34:15,582 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 17:34:15,583 reid_baseline.train INFO: Accuracy: 73.4% Mean Entropy: 215.1%
2022-05-03 17:35:18,728 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.410, Acc: 0.813, Base Lr: 5.62e-03
2022-05-03 17:36:30,908 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.399, Acc: 0.809, Base Lr: 5.62e-03
2022-05-03 17:37:21,874 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.682[s] Speed: 23.5[samples/s]
2022-05-03 17:39:02,036 reid_baseline.train INFO: normal accuracy 0.7445370578959225 1.9820188283920288 
2022-05-03 17:39:03,142 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 17:39:03,143 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 198.2%
2022-05-03 17:40:01,026 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.306, Acc: 0.834, Base Lr: 6.42e-03
2022-05-03 17:40:54,990 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.289, Acc: 0.842, Base Lr: 6.42e-03
2022-05-03 17:41:32,568 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.547[s] Speed: 29.2[samples/s]
2022-05-03 17:43:02,691 reid_baseline.train INFO: normal accuracy 0.7499436810092364 1.8563454151153564 
2022-05-03 17:43:03,531 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 17:43:03,531 reid_baseline.train INFO: Accuracy: 75.0% Mean Entropy: 185.6%
2022-05-03 17:44:11,755 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.193, Acc: 0.882, Base Lr: 7.21e-03
2022-05-03 17:45:11,805 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.226, Acc: 0.866, Base Lr: 7.21e-03
2022-05-03 17:45:51,765 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.616[s] Speed: 26.0[samples/s]
2022-05-03 17:47:45,985 reid_baseline.train INFO: normal accuracy 0.7544492002703311 1.7073253393173218 
2022-05-03 17:47:46,955 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 17:47:46,955 reid_baseline.train INFO: Accuracy: 75.4% Mean Entropy: 170.7%
2022-05-03 17:48:50,049 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.157, Acc: 0.880, Base Lr: 4.01e-03
2022-05-03 17:49:52,042 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.167, Acc: 0.880, Base Lr: 4.01e-03
2022-05-03 17:50:44,948 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.652[s] Speed: 24.5[samples/s]
2022-05-03 17:52:20,558 reid_baseline.train INFO: normal accuracy 0.7686415859427799 1.7988003492355347 
2022-05-03 17:52:20,560 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 17:52:20,560 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 179.9%
2022-05-03 17:53:21,320 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.115, Acc: 0.905, Base Lr: 3.38e-03
2022-05-03 17:54:18,253 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.115, Acc: 0.899, Base Lr: 3.38e-03
2022-05-03 17:55:02,275 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.592[s] Speed: 27.0[samples/s]
2022-05-03 17:56:42,495 reid_baseline.train INFO: normal accuracy 0.7636855147555756 1.7531381845474243 
2022-05-03 17:56:42,495 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 17:56:42,496 reid_baseline.train INFO: Accuracy: 76.4% Mean Entropy: 175.3%
2022-05-03 17:57:48,773 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.087, Acc: 0.910, Base Lr: 2.77e-03
2022-05-03 17:58:55,338 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.109, Acc: 0.898, Base Lr: 2.77e-03
2022-05-03 17:59:44,103 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.665[s] Speed: 24.1[samples/s]
2022-05-03 18:01:28,603 reid_baseline.train INFO: normal accuracy 0.7690921378688894 1.6912912130355835 
2022-05-03 18:01:29,420 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 18:01:29,421 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 169.1%
2022-05-03 18:02:31,498 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.087, Acc: 0.913, Base Lr: 2.20e-03
2022-05-03 18:03:35,351 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.075, Acc: 0.915, Base Lr: 2.20e-03
2022-05-03 18:04:11,718 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.594[s] Speed: 26.9[samples/s]
2022-05-03 18:05:45,903 reid_baseline.train INFO: normal accuracy 0.770218517684163 1.7666763067245483 
2022-05-03 18:05:45,905 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 18:05:45,905 reid_baseline.train INFO: Accuracy: 77.0% Mean Entropy: 176.7%
2022-05-03 18:07:02,294 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.069, Acc: 0.906, Base Lr: 1.66e-03
2022-05-03 18:08:05,451 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.070, Acc: 0.908, Base Lr: 1.66e-03
2022-05-03 18:08:46,483 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.661[s] Speed: 24.2[samples/s]
2022-05-03 18:10:33,962 reid_baseline.train INFO: normal accuracy 0.7740482090560937 1.7276945114135742 
2022-05-03 18:10:33,963 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 18:10:33,963 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 172.8%
2022-05-03 18:11:36,528 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.052, Acc: 0.920, Base Lr: 1.19e-03
2022-05-03 18:12:36,577 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.045, Acc: 0.922, Base Lr: 1.19e-03
2022-05-03 18:13:24,948 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.626[s] Speed: 25.6[samples/s]
2022-05-03 18:15:02,134 reid_baseline.train INFO: normal accuracy 0.7708943455733274 1.7553421258926392 
2022-05-03 18:15:02,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 18:15:02,137 reid_baseline.train INFO: Accuracy: 77.1% Mean Entropy: 175.5%
2022-05-03 18:16:06,110 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.037, Acc: 0.929, Base Lr: 7.78e-04
2022-05-03 18:17:09,245 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.046, Acc: 0.917, Base Lr: 7.78e-04
2022-05-03 18:17:57,713 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.643[s] Speed: 24.9[samples/s]
2022-05-03 18:19:41,215 reid_baseline.train INFO: normal accuracy 0.7715701734624916 1.7552924156188965 
2022-05-03 18:19:41,216 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 18:19:41,216 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 175.5%
2022-05-03 18:20:53,134 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.057, Acc: 0.910, Base Lr: 4.51e-04
2022-05-03 18:22:04,511 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.051, Acc: 0.914, Base Lr: 4.51e-04
2022-05-03 18:22:56,604 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.715[s] Speed: 22.4[samples/s]
2022-05-03 18:24:51,079 reid_baseline.train INFO: normal accuracy 0.773822933093039 1.7103443145751953 
2022-05-03 18:24:51,079 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 18:24:51,080 reid_baseline.train INFO: Accuracy: 77.4% Mean Entropy: 171.0%
2022-05-03 18:25:58,984 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.042, Acc: 0.925, Base Lr: 2.11e-04
2022-05-03 18:27:01,229 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.038, Acc: 0.927, Base Lr: 2.11e-04
2022-05-03 18:27:41,197 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.623[s] Speed: 25.7[samples/s]
2022-05-03 18:29:47,048 reid_baseline.train INFO: normal accuracy 0.772020725388601 1.7303025722503662 
2022-05-03 18:29:47,048 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 18:29:47,048 reid_baseline.train INFO: Accuracy: 77.2% Mean Entropy: 173.0%
2022-05-03 18:30:59,157 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.049, Acc: 0.921, Base Lr: 6.51e-05
2022-05-03 18:32:00,310 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.043, Acc: 0.923, Base Lr: 6.51e-05
2022-05-03 18:32:43,441 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.646[s] Speed: 24.8[samples/s]
2022-05-03 18:34:55,935 reid_baseline.train INFO: normal accuracy 0.7686415859427799 1.6636154651641846 
2022-05-03 18:34:57,086 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 18:34:57,087 reid_baseline.train INFO: Accuracy: 76.9% Mean Entropy: 166.4%
2022-05-03 18:36:23,543 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.067, Acc: 0.908, Base Lr: 1.60e-05
2022-05-03 18:37:30,844 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.056, Acc: 0.912, Base Lr: 1.60e-05
2022-05-03 18:38:11,446 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.712[s] Speed: 22.5[samples/s]
2022-05-03 18:40:20,925 reid_baseline.train INFO: normal accuracy 0.7726965532777652 1.7255953550338745 
2022-05-03 18:40:20,926 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 18:40:20,926 reid_baseline.train INFO: Accuracy: 77.3% Mean Entropy: 172.6%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Product_Key_AugCl_Cls_token/transformer_best_model.pth
2022-05-03 18:41:47,231 reid_baseline.train INFO: normal accuracy 0.7726965532777652 1.6629345417022705 
2022-05-03 18:41:47,231 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:41:47,231 reid_baseline.train INFO: Accuracy: 77.3%
2022-05-03 18:43:40,623 reid_baseline.train INFO: normal accuracy 0.7704437936472178 1.66448175907135 
2022-05-03 18:43:40,623 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:43:40,624 reid_baseline.train INFO: Shuffled Accuracy: 77.0%
2022-05-03 18:45:09,136 reid_baseline.train INFO: normal accuracy 0.952119129438717 0.7965998649597168 
2022-05-03 18:45:09,137 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 18:45:09,137 reid_baseline.train INFO: Source Clean Accuracy: 95.2%
2022-05-03 18:45:15,182 reid_baseline INFO: Saving model in the path :../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_Cls_token
2022-05-03 18:45:15,182 reid_baseline INFO: Namespace(config_file='configs/pretrain.yml', opts=['MODEL.DEVICE_ID', "('3')", 'DATASETS.NAMES', 'OfficeHome', 'OUTPUT_DIR', '../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_Cls_token', 'DATASETS.ROOT_TRAIN_DIR', '../data/OfficeHomeDataset/Clipart.txt', 'DATASETS.ROOT_TEST_DIR', '../data/OfficeHomeDataset/Real_World.txt', 'MODEL.Transformer_TYPE', 'vit_base_patch16_224_TransReID', 'MODEL.PRETRAIN_PATH', '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'], local_rank=0, patch_size=8, dom_cls=False, augcl_path='../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth')
2022-05-03 18:45:15,182 reid_baseline INFO: Loaded configuration file configs/pretrain.yml
2022-05-03 18:45:15,182 reid_baseline INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: '../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  Transformer_TYPE: 'vit_base_patch16_224_TransReID' #vit_small_patch16_224_TransReID
  STRIDE_SIZE: [16, 16]
  FC_SETTING: 'TransReID'
  TASK_TYPE: 'classify_DA' 
  UDA_STAGE: 'pretrain'

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]
  SIZE_CROP: [224, 224]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.0 # random erasing
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]

DATASETS:
  NAMES: ('OURAPI')
  ROOT_TRAIN_DIR: ('./datasets/reid_datasets/Corrected_Market1501')
  NAMES2: ('OURAPI')
  ROOT_TRAIN_DIR2: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')
  ROOT_TEST_DIR: ('./datasets/reid_datasets/Refined_DukeMTMC_reID')

DATALOADER:
  SAMPLER: 'softmax'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 20
  BASE_LR: 0.008
  IMS_PER_BATCH: 16
  STEPS: [40, 80]
  GAMMA: 0.
  WARMUP_FACTOR: 0.01
  WARMUP_EPOCHS: 10
  WARMUP_METHOD: 'linear'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 10
  LOG_PERIOD: 100
  EVAL_PERIOD: 1
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 64
  RE_RANKING: False
  RE_RANKING_TRACK: False

  WEIGHT: '../logs/trans4DA/transformer_120.pth'
  NECK_FEAT: 'after'
  FEAT_NORM: 'yes'

OUTPUT_DIR: '../logs/trans4DA'



2022-05-03 18:45:15,183 reid_baseline INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  SAMPLER: softmax
DATASETS:
  NAMES: OfficeHome
  NAMES2: OURAPI
  PLUS_NUM_ID: 100
  QUERY_MINING: False
  ROOT_TEST_DIR: ../data/OfficeHomeDataset/Real_World.txt
  ROOT_TRAIN_DIR: ../data/OfficeHomeDataset/Clipart.txt
  ROOT_TRAIN_DIR2: ./datasets/reid_datasets/Refined_DukeMTMC_reID
INPUT:
  AA_PROB: 0.0
  PADDING: 0
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  PROB: 0.5
  RE_PROB: 0.0
  SIZE_CROP: [224, 224]
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
MODEL:
  AIE_COE: 1.5
  BLOCK_PATTERN: normal
  CAMERA_EMBEDDING: False
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 3
  DEVIDE_LENGTH: 4
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  FC_SETTING: TransReID
  FROZEN: -1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  LOCAL_F: False
  METRIC_LOSS_TYPE: triplet
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  NO_SHUFFLE: False
  PATCH_SHUFFLE: 2
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
  PROB: 0.0
  RECIP_LOSS: 
  STRIDE_SIZE: [16, 16]
  TASK_TYPE: classify_DA
  THRESH: 0.23
  TRIPLET_LOSS_WEIGHT: 1.0
  Transformer_TYPE: vit_base_patch16_224_TransReID
  UDA_STAGE: pretrain
  VIEWPOINT_EMBEDDING: False
  YIWEI_NUM: 5
  lameda: 0.5
OUTPUT_DIR: ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_Cls_token
SOLVER:
  BASE_LR: 0.008
  BIAS_LR_FACTOR: 2
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  CLUSTER_MARGIN: 0.3
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.0
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 20
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  RANGE_ALPHA: 0
  RANGE_BETA: 1
  RANGE_K: 2
  RANGE_LOSS_WEIGHT: 1
  RANGE_MARGIN: 0.3
  SEED: 1234
  STEPS: (40, 80)
  WARMUP_EPOCHS: 10
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WITH_PSEUDO_LABEL_FILTER: False
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  FLIP_FEATS: off
  IMS_PER_BATCH: 64
  NECK_FEAT: after
  RE_RANKING: False
  RE_RANKING_TRACK: False
  WEIGHT: ../logs/trans4DA/transformer_120.pth
=> Office-Home loaded
Dataset statistics:
train Clipart and valid is Real_World
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train   |    65 |     4365 |         1
  valid   |    65 |     4357 |         1
  ----------------------------------------
use shuffle sampler strategy
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
label smooth on, numclasses: 65
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and part number is num_y14 * num_x14
using drop_path_rate is : 0.1
using aie_xishu is : 1.5
embed_diim 768 mlp_ratio 4
distill need to choose right cls token in the pth
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding resize to height:14 width: 14
Loading pretrained ImageNet model......from ../data/pretrainModel/deit_base_distilled_patch16_224-df68dfff.pth
===========building transformer===========
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_AugCl_DRI/transformer_best_model.pth
pretrain train
2022-05-03 18:45:27,957 reid_baseline.train INFO: start training
2022-05-03 18:46:29,248 reid_baseline.train INFO: Epoch[1] Iteration[100/273] Loss: 4.135, Acc: 0.085, Base Lr: 8.72e-04
2022-05-03 18:47:36,131 reid_baseline.train INFO: Epoch[1] Iteration[200/273] Loss: 4.085, Acc: 0.190, Base Lr: 8.72e-04
2022-05-03 18:48:13,894 reid_baseline.train INFO: Epoch 1 done. Time per batch: 0.602[s] Speed: 26.6[samples/s]
2022-05-03 18:52:36,373 reid_baseline.train INFO: normal accuracy 0.5017213679137021 4.169071197509766 
2022-05-03 18:52:37,170 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 1
2022-05-03 18:52:37,171 reid_baseline.train INFO: Accuracy: 50.2% Mean Entropy: 416.9%
2022-05-03 18:53:47,835 reid_baseline.train INFO: Epoch[2] Iteration[100/273] Loss: 3.787, Acc: 0.457, Base Lr: 1.66e-03
2022-05-03 18:54:44,502 reid_baseline.train INFO: Epoch[2] Iteration[200/273] Loss: 3.686, Acc: 0.459, Base Lr: 1.66e-03
2022-05-03 18:55:32,899 reid_baseline.train INFO: Epoch 2 done. Time per batch: 0.644[s] Speed: 24.9[samples/s]
2022-05-03 19:00:02,436 reid_baseline.train INFO: normal accuracy 0.5783796190039018 4.1109161376953125 
2022-05-03 19:00:03,232 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 2
2022-05-03 19:00:03,232 reid_baseline.train INFO: Accuracy: 57.8% Mean Entropy: 411.1%
2022-05-03 19:00:50,873 reid_baseline.train INFO: Epoch[3] Iteration[100/273] Loss: 3.068, Acc: 0.556, Base Lr: 2.46e-03
2022-05-03 19:01:34,996 reid_baseline.train INFO: Epoch[3] Iteration[200/273] Loss: 2.914, Acc: 0.561, Base Lr: 2.46e-03
2022-05-03 19:02:05,404 reid_baseline.train INFO: Epoch 3 done. Time per batch: 0.447[s] Speed: 35.8[samples/s]
2022-05-03 19:05:50,652 reid_baseline.train INFO: normal accuracy 0.6355290337388111 3.6525652408599854 
2022-05-03 19:05:51,450 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 3
2022-05-03 19:05:51,451 reid_baseline.train INFO: Accuracy: 63.6% Mean Entropy: 365.3%
2022-05-03 19:06:37,932 reid_baseline.train INFO: Epoch[4] Iteration[100/273] Loss: 2.262, Acc: 0.654, Base Lr: 3.25e-03
2022-05-03 19:07:19,122 reid_baseline.train INFO: Epoch[4] Iteration[200/273] Loss: 2.159, Acc: 0.661, Base Lr: 3.25e-03
2022-05-03 19:07:50,282 reid_baseline.train INFO: Epoch 4 done. Time per batch: 0.435[s] Speed: 36.8[samples/s]
2022-05-03 19:11:21,895 reid_baseline.train INFO: normal accuracy 0.707137938948818 2.9530222415924072 
2022-05-03 19:11:22,718 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 4
2022-05-03 19:11:22,719 reid_baseline.train INFO: Accuracy: 70.7% Mean Entropy: 295.3%
2022-05-03 19:12:06,450 reid_baseline.train INFO: Epoch[5] Iteration[100/273] Loss: 1.786, Acc: 0.727, Base Lr: 4.04e-03
2022-05-03 19:12:48,473 reid_baseline.train INFO: Epoch[5] Iteration[200/273] Loss: 1.729, Acc: 0.742, Base Lr: 4.04e-03
2022-05-03 19:13:18,787 reid_baseline.train INFO: Epoch 5 done. Time per batch: 0.425[s] Speed: 37.7[samples/s]
2022-05-03 19:16:43,884 reid_baseline.train INFO: normal accuracy 0.7445490016066101 2.462306022644043 
2022-05-03 19:16:44,745 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 5
2022-05-03 19:16:44,746 reid_baseline.train INFO: Accuracy: 74.5% Mean Entropy: 246.2%
2022-05-03 19:17:30,917 reid_baseline.train INFO: Epoch[6] Iteration[100/273] Loss: 1.549, Acc: 0.772, Base Lr: 4.83e-03
2022-05-03 19:18:12,461 reid_baseline.train INFO: Epoch[6] Iteration[200/273] Loss: 1.518, Acc: 0.779, Base Lr: 4.83e-03
2022-05-03 19:18:42,635 reid_baseline.train INFO: Epoch 6 done. Time per batch: 0.432[s] Speed: 37.1[samples/s]
2022-05-03 19:22:04,815 reid_baseline.train INFO: normal accuracy 0.761762680743631 2.1857149600982666 
2022-05-03 19:22:05,632 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 6
2022-05-03 19:22:05,633 reid_baseline.train INFO: Accuracy: 76.2% Mean Entropy: 218.6%
2022-05-03 19:22:50,406 reid_baseline.train INFO: Epoch[7] Iteration[100/273] Loss: 1.405, Acc: 0.811, Base Lr: 5.62e-03
2022-05-03 19:23:31,926 reid_baseline.train INFO: Epoch[7] Iteration[200/273] Loss: 1.389, Acc: 0.806, Base Lr: 5.62e-03
2022-05-03 19:24:02,376 reid_baseline.train INFO: Epoch 7 done. Time per batch: 0.428[s] Speed: 37.4[samples/s]
2022-05-03 19:27:25,615 reid_baseline.train INFO: normal accuracy 0.778517328436998 2.0170207023620605 
2022-05-03 19:27:26,484 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 7
2022-05-03 19:27:26,484 reid_baseline.train INFO: Accuracy: 77.9% Mean Entropy: 201.7%
2022-05-03 19:28:10,255 reid_baseline.train INFO: Epoch[8] Iteration[100/273] Loss: 1.307, Acc: 0.839, Base Lr: 6.42e-03
2022-05-03 19:28:49,974 reid_baseline.train INFO: Epoch[8] Iteration[200/273] Loss: 1.287, Acc: 0.842, Base Lr: 6.42e-03
2022-05-03 19:29:19,605 reid_baseline.train INFO: Epoch 8 done. Time per batch: 0.414[s] Speed: 38.6[samples/s]
2022-05-03 19:32:39,890 reid_baseline.train INFO: normal accuracy 0.7780582969933441 1.887507677078247 
2022-05-03 19:32:40,709 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 8
2022-05-03 19:32:40,709 reid_baseline.train INFO: Accuracy: 77.8% Mean Entropy: 188.8%
2022-05-03 19:33:24,993 reid_baseline.train INFO: Epoch[9] Iteration[100/273] Loss: 1.197, Acc: 0.880, Base Lr: 7.21e-03
2022-05-03 19:34:05,526 reid_baseline.train INFO: Epoch[9] Iteration[200/273] Loss: 1.222, Acc: 0.867, Base Lr: 7.21e-03
2022-05-03 19:34:34,165 reid_baseline.train INFO: Epoch 9 done. Time per batch: 0.415[s] Speed: 38.5[samples/s]
2022-05-03 19:37:55,632 reid_baseline.train INFO: normal accuracy 0.7844847372044985 1.7580193281173706 
2022-05-03 19:37:56,432 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 9
2022-05-03 19:37:56,433 reid_baseline.train INFO: Accuracy: 78.4% Mean Entropy: 175.8%
2022-05-03 19:38:41,583 reid_baseline.train INFO: Epoch[10] Iteration[100/273] Loss: 1.170, Acc: 0.874, Base Lr: 4.01e-03
2022-05-03 19:39:22,965 reid_baseline.train INFO: Epoch[10] Iteration[200/273] Loss: 1.170, Acc: 0.878, Base Lr: 4.01e-03
2022-05-03 19:39:52,537 reid_baseline.train INFO: Epoch 10 done. Time per batch: 0.424[s] Speed: 37.7[samples/s]
2022-05-03 19:43:11,107 reid_baseline.train INFO: normal accuracy 0.7897635988065183 1.8136711120605469 
2022-05-03 19:43:11,108 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 10
2022-05-03 19:43:11,108 reid_baseline.train INFO: Accuracy: 79.0% Mean Entropy: 181.4%
2022-05-03 19:43:52,775 reid_baseline.train INFO: Epoch[11] Iteration[100/273] Loss: 1.117, Acc: 0.906, Base Lr: 3.38e-03
2022-05-03 19:44:31,542 reid_baseline.train INFO: Epoch[11] Iteration[200/273] Loss: 1.116, Acc: 0.899, Base Lr: 3.38e-03
2022-05-03 19:44:59,775 reid_baseline.train INFO: Epoch 11 done. Time per batch: 0.398[s] Speed: 40.2[samples/s]
2022-05-03 19:48:06,890 reid_baseline.train INFO: normal accuracy 0.7888455359192105 1.7690562009811401 
2022-05-03 19:48:06,891 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 11
2022-05-03 19:48:06,891 reid_baseline.train INFO: Accuracy: 78.9% Mean Entropy: 176.9%
2022-05-03 19:48:47,534 reid_baseline.train INFO: Epoch[12] Iteration[100/273] Loss: 1.088, Acc: 0.907, Base Lr: 2.77e-03
2022-05-03 19:49:25,231 reid_baseline.train INFO: Epoch[12] Iteration[200/273] Loss: 1.102, Acc: 0.903, Base Lr: 2.77e-03
2022-05-03 19:49:53,044 reid_baseline.train INFO: Epoch 12 done. Time per batch: 0.387[s] Speed: 41.3[samples/s]
2022-05-03 19:52:53,240 reid_baseline.train INFO: normal accuracy 0.7883865044755566 1.728478193283081 
2022-05-03 19:52:53,993 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 12
2022-05-03 19:52:53,994 reid_baseline.train INFO: Accuracy: 78.8% Mean Entropy: 172.8%
2022-05-03 19:53:35,407 reid_baseline.train INFO: Epoch[13] Iteration[100/273] Loss: 1.090, Acc: 0.900, Base Lr: 2.20e-03
2022-05-03 19:54:13,099 reid_baseline.train INFO: Epoch[13] Iteration[200/273] Loss: 1.080, Acc: 0.904, Base Lr: 2.20e-03
2022-05-03 19:54:40,195 reid_baseline.train INFO: Epoch 13 done. Time per batch: 0.389[s] Speed: 41.1[samples/s]
2022-05-03 19:57:40,355 reid_baseline.train INFO: normal accuracy 0.7934358503557494 1.7734010219573975 
2022-05-03 19:57:40,355 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 13
2022-05-03 19:57:40,355 reid_baseline.train INFO: Accuracy: 79.3% Mean Entropy: 177.3%
2022-05-03 19:58:21,705 reid_baseline.train INFO: Epoch[14] Iteration[100/273] Loss: 1.060, Acc: 0.917, Base Lr: 1.66e-03
2022-05-03 19:59:01,392 reid_baseline.train INFO: Epoch[14] Iteration[200/273] Loss: 1.066, Acc: 0.913, Base Lr: 1.66e-03
2022-05-03 19:59:29,565 reid_baseline.train INFO: Epoch 14 done. Time per batch: 0.400[s] Speed: 40.0[samples/s]
2022-05-03 20:02:32,076 reid_baseline.train INFO: normal accuracy 0.7915997245811338 1.6907291412353516 
2022-05-03 20:02:32,832 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 14
2022-05-03 20:02:32,832 reid_baseline.train INFO: Accuracy: 79.2% Mean Entropy: 169.1%
2022-05-03 20:03:13,236 reid_baseline.train INFO: Epoch[15] Iteration[100/273] Loss: 1.052, Acc: 0.918, Base Lr: 1.19e-03
2022-05-03 20:03:52,508 reid_baseline.train INFO: Epoch[15] Iteration[200/273] Loss: 1.048, Acc: 0.921, Base Lr: 1.19e-03
2022-05-03 20:04:21,027 reid_baseline.train INFO: Epoch 15 done. Time per batch: 0.396[s] Speed: 40.4[samples/s]
2022-05-03 20:07:20,764 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.7117183208465576 
2022-05-03 20:07:20,765 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 15
2022-05-03 20:07:20,765 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 171.2%
2022-05-03 20:08:01,464 reid_baseline.train INFO: Epoch[16] Iteration[100/273] Loss: 1.041, Acc: 0.925, Base Lr: 7.78e-04
2022-05-03 20:08:39,045 reid_baseline.train INFO: Epoch[16] Iteration[200/273] Loss: 1.044, Acc: 0.920, Base Lr: 7.78e-04
2022-05-03 20:09:07,304 reid_baseline.train INFO: Epoch 16 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-05-03 20:12:10,295 reid_baseline.train INFO: normal accuracy 0.794812944686711 1.754019021987915 
2022-05-03 20:12:10,296 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 16
2022-05-03 20:12:10,296 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 175.4%
2022-05-03 20:12:51,681 reid_baseline.train INFO: Epoch[17] Iteration[100/273] Loss: 1.053, Acc: 0.917, Base Lr: 4.51e-04
2022-05-03 20:13:29,082 reid_baseline.train INFO: Epoch[17] Iteration[200/273] Loss: 1.046, Acc: 0.921, Base Lr: 4.51e-04
2022-05-03 20:13:56,942 reid_baseline.train INFO: Epoch 17 done. Time per batch: 0.390[s] Speed: 41.0[samples/s]
2022-05-03 20:17:01,525 reid_baseline.train INFO: normal accuracy 0.7971081019049805 1.7146345376968384 
2022-05-03 20:17:01,526 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 17
2022-05-03 20:17:01,526 reid_baseline.train INFO: Accuracy: 79.7% Mean Entropy: 171.5%
2022-05-03 20:17:44,043 reid_baseline.train INFO: Epoch[18] Iteration[100/273] Loss: 1.048, Acc: 0.920, Base Lr: 2.11e-04
2022-05-03 20:18:21,946 reid_baseline.train INFO: Epoch[18] Iteration[200/273] Loss: 1.043, Acc: 0.923, Base Lr: 2.11e-04
2022-05-03 20:18:49,900 reid_baseline.train INFO: Epoch 18 done. Time per batch: 0.397[s] Speed: 40.3[samples/s]
2022-05-03 20:21:50,191 reid_baseline.train INFO: normal accuracy 0.7957310075740188 1.6986998319625854 
2022-05-03 20:21:50,192 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 18
2022-05-03 20:21:50,192 reid_baseline.train INFO: Accuracy: 79.6% Mean Entropy: 169.9%
2022-05-03 20:22:31,668 reid_baseline.train INFO: Epoch[19] Iteration[100/273] Loss: 1.051, Acc: 0.914, Base Lr: 6.51e-05
2022-05-03 20:23:10,224 reid_baseline.train INFO: Epoch[19] Iteration[200/273] Loss: 1.049, Acc: 0.915, Base Lr: 6.51e-05
2022-05-03 20:23:38,394 reid_baseline.train INFO: Epoch 19 done. Time per batch: 0.395[s] Speed: 40.5[samples/s]
2022-05-03 20:26:42,911 reid_baseline.train INFO: normal accuracy 0.7952719761303649 1.6617710590362549 
2022-05-03 20:26:43,730 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 19
2022-05-03 20:26:43,730 reid_baseline.train INFO: Accuracy: 79.5% Mean Entropy: 166.2%
2022-05-03 20:27:25,103 reid_baseline.train INFO: Epoch[20] Iteration[100/273] Loss: 1.063, Acc: 0.910, Base Lr: 1.60e-05
2022-05-03 20:28:03,166 reid_baseline.train INFO: Epoch[20] Iteration[200/273] Loss: 1.057, Acc: 0.915, Base Lr: 1.60e-05
2022-05-03 20:28:30,978 reid_baseline.train INFO: Epoch 20 done. Time per batch: 0.392[s] Speed: 40.8[samples/s]
2022-05-03 20:31:32,050 reid_baseline.train INFO: normal accuracy 0.7975671333486344 1.7170896530151367 
2022-05-03 20:31:32,051 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Epoch: 20
2022-05-03 20:31:32,051 reid_baseline.train INFO: Accuracy: 79.8% Mean Entropy: 171.7%
Loading pretrained model for finetuning from ../remote_logs/pretrain/deit_base/office-home/Clipart_2_Real_World_Key_AugCl_Cls_token/transformer_best_model.pth
2022-05-03 20:34:35,464 reid_baseline.train INFO: normal accuracy 0.7971081019049805 1.6624195575714111 
2022-05-03 20:34:35,465 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 20:34:35,465 reid_baseline.train INFO: Accuracy: 79.7%
2022-05-03 20:37:45,471 reid_baseline.train INFO: normal accuracy 0.7955014918521919 1.6618226766586304 
2022-05-03 20:37:45,471 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 20:37:45,472 reid_baseline.train INFO: Shuffled Accuracy: 79.6%
2022-05-03 20:38:49,726 reid_baseline.train INFO: normal accuracy 0.9532646048109966 0.7954676747322083 
2022-05-03 20:38:49,726 reid_baseline.train INFO: Classify Domain Adapatation Validation Results - Best Model
2022-05-03 20:38:49,726 reid_baseline.train INFO: Source Clean Accuracy: 95.3%
